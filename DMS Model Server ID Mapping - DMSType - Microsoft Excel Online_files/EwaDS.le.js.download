(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1232:function(C,F,b){function a(Pa,ib,pb,xb){var Ya=xa.call(this)||this;Ya.isMac=r.a.isMac;Ya.yVa=-1;Ya.N0b=null;Ya.xra=-1;Ya.cXb=!1;Ya.dZ=!1;Ya.eLd=!1;Ya.Ydc=!1;Ya.jM=!1;Ya.wS=null;var ab=b(1310).AutoDetectActionButton;Ya.$=Pa;Ya.Dlb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ib||n.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");
Ya.convertToLinkedEntityManager=xb;xb.hNa();Ya.og=new ab(Pa,ib,Object(w.a)(Ya,Ya.Rc,"onClick"),pb,"");Ya.fAg=new e(Ya.$,xb);Ya.gridView=N.g(Ya.$);Ya.gridView.ga.o1(Object(w.a)(Ya,Ya.Bh,"onSelectionEnded"));Ya.gridView.Gc.bVb(Object(w.a)(Ya,Ya.Bh,"onSelectionEnded"));Ya.gridView.uq(Object(w.a)(Ya,Ya.oQ,"onGridContentReady"));Pa.dn(Object(w.a)(Ya,Ya.Pd,"onWorkbookClosing"));Pa.hD(Object(w.a)(Ya,Ya.fk,"onContentAreaResized"));Ya.gridBlockManager=Object(t.a)(827,Ya.gridView.Ca);Ya.pt=Pa.frame.Uy;Ya.TV();
return Ya}function e(Pa,ib){var pb=V.call(this)||this;pb.$=Pa;pb.gridView=N.g(Pa);pb.convertToLinkedEntityManager=ib;pb.UWc=new Y.a;return pb}function d(Pa,ib){var pb=aa.call(this)||this;pb.Qke=Pa;pb.convertToLinkedEntityManager=ib;pb.CGa=document.createElement("div");pb.CGa.className="clip16x16";pb.tua=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',H.a.Xf("autodetectid"+pb.Qke.left),Q.a.d4c,L.a.ve(11));pb.CGa.innerHTML=pb.tua;
Pa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");S.a.instance.pa(v.a.click,Pa,Object(w.a)(pb,pb.Rc,"onClick"));return pb}function l(Pa,ib){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ib;this.parentElement=Pa}C=b(0);var n=b(15),r=b(23),h=b(86),v=b(13),w=b(37),t=b(83),B=b(403),z=b(74),x=b(10),y=b(67),J=b(451);l.prototype.xSg=function(){var Pa=this,ib=this.ySg();J.a(this.$,243,242,0,function(pb){Pa.cardViewManager=
pb;pb.TSf(Pa.parentElement,2,ib)},"Microsoft.Office.Excel.WebUI.Client.CardView.ICardViewManager")};l.prototype.UZe=function(){this.cardViewManager&&this.cardViewManager.eJa(-1,-1,this.parentElement)};l.prototype.ySg=function(){var Pa={layoutId:"AutoDetectTooltip"};Pa.description=this.longDescription;Pa.convertToDomainName=this.convertToDomainName;Pa.longDescription=this.longDescription;Pa.urlValue=this.urlValue;Pa.imageAltText=this.imageAltText;Pa.helpText=this.helpText;Pa.helpId=this.helpId;return Pa};
Object(C.a)(l,"AutoDetectCardManager",null,[]);var E=b(29),A=b(199),H=b(30),S=b(278),Q=b(18),L=b(52),aa=z.a;Em(d,aa);d.prototype.dispose=function(){if(this.CGa){var Pa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");S.a.instance.za(v.a.click,Pa,Object(w.a)(this,this.Rc,"onClick"))}aa.prototype.dispose.call(this)};d.prototype.Rc=function(Pa){if(Pa.Sb.id===this.CGa.firstChild.id){Pa=this.Qke;var ib={};ib.Id=Pa.Clb;this.convertToLinkedEntityManager.dYc(ib,!0,Pa);this.CGa.removeChild(this.CGa.firstChild);
return!0}return!1};Ll.Object.defineProperties(d.prototype,{domElement:{configurable:!0,enumerable:!0,get:function(){return this.CGa}}});Ll.Object.defineProperties(d,{BFg:{configurable:!0,enumerable:!0,get:function(){return"clip16x16"}}});Object(C.a)(d,"AutoDetectColumnHeaderButton",z.a,[]);var fa=b(1),W=b(1172),G=b(9),N=b(20),Y=b(122),V=z.a;Em(e,V);e.prototype.dispose=function(){V.prototype.dispose.call(this)};e.prototype.F3g=function(Pa){for(var ib=Ol(this.gridView.T1),pb=ib.next();!pb.done;pb=ib.next()){pb=
Ol(pb.value);for(var xb=pb.next();!xb.done;xb=pb.next()){xb=xb.value;var Ya=xb.Rn,ab=W.a(xb.w3);this.fog(Pa,ab,Ya);xb.BHd(ab)}}};e.prototype.fog=function(Pa,ib,pb){if(ib.length){var xb=pb.length;pb[xb-1]<Pa.left||(pb=G.HelperMethods.uw(new A.a(pb),0,xb,Pa.left,G.HelperMethods.eC),0>pb||!(ib=ib[pb]))||(this.gridView.rtl?ib.classList.add(E.a.xgh):ib.classList.add(E.a.wgh),this.UWc.qb(Pa.left)||this.UWc.add(Pa.left,new d(Pa,this.convertToLinkedEntityManager)),Pa=this.UWc.oa(Pa.left).domElement,!ib.getElementsByClassName(d.BFg).length&&
this.ekj(ib)&&ib.appendChild(Pa))}};e.prototype.ekj=function(Pa){var ib=parseInt(Pa.style.width),pb=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";pb=e.iUg(pb);Pa=gridRenderer.CanvasRendererGlobals.measureTextWidth(Pa.firstChild.innerHTML,pb,!0,fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<ib-(ib/2+Pa/2)?!0:!1};e.iUg=function(Pa){return String.format("{0} {1} {2} {3}/{4} {5}","normal","normal",Pa,"10pt","normal",'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif')};
Object(C.a)(e,"AutoDetectColumnHeaderManager",z.a,[]);var da=b(420),U=b(25),Z=b(60),ca=b(141),ra=b(11),La=b(16),na=b(174),ma=b(75);b.d(F,"a",function(){return a});var xa=z.a;Em(a,xa);a.prototype.dispose=function(){this.gridView&&this.gridView.ga.Nba(Object(w.a)(this,this.Bh,"onSelectionEnded"));if(this.$){var Pa=this.$;Pa.Lo(Object(w.a)(this,this.Pd,"onWorkbookClosing"));Pa.oH(Object(w.a)(this,this.fk,"onContentAreaResized"));N.g(Pa).Cs(Object(w.a)(this,this.oQ,"onGridContentReady"))}h.a.Fa(this.og);
this.pt=this.$=this.gridView=this.og=null;xa.prototype.dispose.call(this)};a.prototype.zv=function(){this.W4(null,!1);this.yVa=-1;this.og.hide();this.tuj();this.jM=!1};a.prototype.Tba=function(){this.og.getButton(a.Uca).v9a();this.jM=!1};a.prototype.AGb=function(){this.og.getButton(a.Uca).mCb();this.I1f(this.N0b);this.jM=!0;this.$.ea.$a(211,function(Pa){Pa.CNa(La.a.instance.da(1675))})};a.prototype.onAutoDetectUIShown=function(){if(this.Cua&&-1!==this.yVa)this.convertToLinkedEntityManager.onAutoDetectUIShown()};
a.prototype.gAg=function(Pa){var ib=new U.Range(1===Pa.top?1:Pa.top-1,Pa.left,Pa.bottom,Pa.right,!0,!1);ib=this.gridView.getRangeInformation(ib);ib=Ol(ib);for(var pb=ib.next();!pb.done;pb=ib.next())if(pb=pb.value,Object(B.a)(da.AutoDetectRange,pb)&&this.evb(Pa,!1,pb))return!0;return!1};a.prototype.K_b=function(){if(this.Cua&&-1!==this.yVa){this.og.getButton(a.Uca).mCb();var Pa={};Pa.Id=this.xra;Pa.StringId=null;this.convertToLinkedEntityManager.dYc(Pa,!0,this.N0b);n.ULS.sendTraceTag(594612633,0,50,
"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");Pa=[Object.assign(new ma.a,{name:"Domain",int64:this.xra})];na.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,Pa);this.xra=-1}};a.prototype.$uh=function(){var Pa=La.a.instance.da(1671);if(-1!==this.xra){Pa+=" ";try{Pa+=this.convertToLinkedEntityManager.$wb(this.xra.toString())}catch(ib){n.ULS.sendTraceTag(537166982,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.xra)}}Pa+=
" ";return Pa=this.Dlb?Pa+La.a.instance.da(1674):Pa+La.a.instance.da(this.isMac?1673:1672)};a.prototype.Bh=function(){this.Cua&&this.gridView&&this.TV()};a.prototype.Pd=function(){this.zv()};a.prototype.Rc=function(){this.K_b();N.g(this.$).Le(!0,!1)};a.prototype.W4=function(Pa,ib){ib?(this.I1f(this.N0b),this.lab()):(Pa=[29],this.gridView.Kb.mk(Pa),this.gridView.Kb.Ek(null,Pa),this.wS&&this.wS.UZe())};a.prototype.lab=function(){this.Dlb&&(this.wS||(this.wS=new l(this.Ib,this.$),this.wS.convertToDomainName=
La.a.instance.da(1676),this.wS.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.wS.imageAltText=La.a.instance.da(1678),this.wS.helpId="HID_DataTypes_Wolfram",this.wS.helpText=La.a.instance.da(1677)),this.wS.longDescription=this.convertToLinkedEntityManager.KOd(this.yVa.toString()),this.wS.xSg())};a.prototype.fk=function(){this.F3a()&&this.og.hide();1===this.gridView.ga.Qe&&this.TV()};a.prototype.oQ=function(){var Pa=this.gridView.ga.Qe;this.gridView.ga.wa.activeCell&&
1===Pa&&this.TV()};a.prototype.evb=function(Pa,ib,pb){if((new U.Range(pb.top,pb.left,pb.bottom===x.a.lh?pb.bottom:pb.bottom+1,pb.right,!0,!1)).$d(Pa)){if(ib){if(pb&&pb.Clb!==this.yVa){this.yVa=pb.Clb;Pa=pb.Clb.toString();ib=this.Dlb?"":this.convertToLinkedEntityManager.KOd(Pa);var xb=this.convertToLinkedEntityManager.ESh(Pa);this.og.fcb(this.convertToLinkedEntityManager.$wb(Pa),ib,xb,a.Uca)}this.xra=pb.Clb;this.N0b=pb}return!0}return!1};a.prototype.TV=function(){if(this.convertToLinkedEntityManager){var Pa=
!!this.gridBlockManager&&this.gridBlockManager.Dcd,ib=this.gridView.ga.wa.tU,pb=this.gridView.ga.Qe,xb=fa.EwaSettings.ka(496);if(Pa&&(ib||xb)){Pa=this.gridView.ga.wa.activeCell;ib=!this.gridBlockManager.qr(Pa);var Ya=this.gridView.getRangeInformation(this.gridView.Hh);Ya=Ol(Ya);for(var ab=Ya.next();!ab.done;ab=Ya.next())if(ab=ab.value,Object(B.a)(da.AutoDetectRange,ab))if(xb)switch(ab.JKg){case 3:if(this.evb(Pa,!0,ab)){if(1!==pb||ib){this.zv();return}n.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");
this.TAd();this.og.p_(Pa,Object(w.a)(this,this.W4,"onHover"));this.cXb||(this.cXb=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(fa.EwaSettings.ka(498)||fa.EwaSettings.ka(499))&&this.fAg.F3g(ab);break;default:n.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}else{if(1!==pb||ib){this.zv();return}if(this.evb(Pa,!0,ab)){n.ULS.sendTraceTag(594612634,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");
this.og.p_(Pa,Object(w.a)(this,this.W4,"onHover"));this.cXb||(this.cXb=!0,this.onAutoDetectUIShown());return}}}this.zv()}};a.prototype.I1f=function(Pa){var ib=[29];this.gridView.Kb.Ek(Pa,ib);this.gridView.Kb.Jr(ib)};a.prototype.F3a=function(){return this.$.fa.isNamedObjectViewMode&&Z.f(this.$.qa)};a.prototype.onKeyUp=function(Pa){return this.Cxb?this.dZ?!1:17===Pa.Ea.keyCode&&this.eLd?(this.jM?(this.lab(),this.Tba()):this.AGb(),!0):!1:this.dZ=!1};a.prototype.onKeyDown=function(Pa){if(!this.Cxb)return this.dZ=
!1;this.eLd=!1;this.dZ=Pa.ctrlKey;switch(Pa.Ea.keyCode){case 27:return this.jM?(this.W4(null,!1),this.Tba()):this.wS&&(this.wS.UZe(),this.AGb()),!0;case 13:if(this.jM)return this.jM=!1,this.K_b(),!0;break;case 17:return this.eLd=!0}return!1};a.prototype.TAd=function(){this.Dlb&&!this.Ydc&&this.pt&&(this.pt.Au(v.a.Qb,this.$.domElement,Object(w.a)(this,this.onKeyDown,"onKeyDown"),!0),this.pt.Au(v.a.Xd,this.$.domElement,Object(w.a)(this,this.onKeyUp,"onKeyUp"),!0),this.Ydc=!0)};a.prototype.tuj=function(){this.Dlb&&
this.Ydc&&this.pt&&(this.pt.Nu(v.a.Qb,this.$.domElement,Object(w.a)(this,this.onKeyDown,"onKeyDown"),!0),this.pt.Nu(v.a.Xd,this.$.domElement,Object(w.a)(this,this.onKeyUp,"onKeyUp"),!0),this.Ydc=!1)};a.axh=function(Pa){return La.a.instance.da(1732)+y.a.space+Pa};Ll.Object.defineProperties(a.prototype,{Ib:{configurable:!0,enumerable:!0,get:function(){return this.og.domElement(1)}},Cxb:{configurable:!0,enumerable:!0,get:function(){var Pa=this.og.domElement(a.Uca);return Pa?ra.DOMElementExtensions.isVisible(Pa):
!1}},Cua:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&fa.EwaSettings.ka(136)&&fa.EwaSettings.ka(139)&&(new ca.a(this.$.va)).Pi?!1:-1!==this.xra}}});Ll.Object.defineProperties(a,{Uca:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(C.a)(a,"AutoDetectManager",z.a,[])},1310:function(C,F,b){function a(h,v,w,t,B){var z=r.call(this)||this;z.$=h;z.Zj=t.iob(h,v,w,"",d.a.ve(11),B,"AutoDetectPointerDown",l.a.instance.da(1732)+"...");return z}b.r(F);b.d(F,"AutoDetectActionButton",
function(){return a});C=b(0);F=b(74);var e=b(1232),d=b(52),l=b(16),n=b(20),r=F.a;Em(a,r);a.prototype.dispose=function(){this.Zj.dispose();this.$=null;r.prototype.dispose.call(this)};a.prototype.domElement=function(h){return this.Zj.domElement(h)};a.prototype.getButton=function(h){return this.Zj.getButton(h,!1)};a.prototype.fcb=function(h,v,w,t){this.Zj.iRa(e.a.axh(h),v,t);this.Zj.LQd(w,v,t)};a.prototype.p_=function(h,v){var w=n.g(this.$),t=w.Wa.Bj(h);h=w.Eg(h,t);var B=w.Mf(t).Wm;if(h&&0<=h.x&&0<=
h.y&&B.width>h.width+160){var z=h.bottomRight.x+this.ps,x=h.topLeft.y+this.ps,y=!1;z+160>B.bottomRight.x&&(z=h.topLeft.x-this.ps,y=!0);if(x<B.topLeft.y+this.ps){if(w.Wa.uza){this.hide();return}x=B.topLeft.y+this.ps}this.Zj.Ppb(v,t);this.wn(z,x,w.rtl,t,y)}else this.hide()};a.prototype.wn=function(h,v,w,t,B){this.Zj.wn(h,v,w,t,!1,B)};a.prototype.hide=function(){this.Zj.hide()};Ll.Object.defineProperties(a.prototype,{ps:{configurable:!0,enumerable:!0,get:function(){return this.Zj.ps}}});Object(C.a)(a,
"AutoDetectActionButton",F.a,[])},1387:function(C,F,b){function a(ca){var ra=U.call(this)||this;ra.fi=null;ra.Ug=null;ra.$=ca;ra.Yb();return ra}function e(ca,ra,La){ca=da.call(this,ca)||this;ca.Qq=0;ca.Po=!1;ca.$=ra;ca.taskPaneManager=La;fa.a(ra).Og(ca);ca.$.dn(Object(L.a)(ca,ca.Pd,"onWorkbookClosing"));W.a.Jd(ca.$)&&(ca.isVisible=!1);return ca}function d(ca){var ra=Q.call(this)||this;ra.$=ca;ra.Yb();return ra}function l(ca){return E.call(this,ca)||this}function n(ca,ra){this.$=ra;this.convertToLinkedEntityManager=
ca}b.r(F);C=b(0);var r=b(800),h=b(15),v=b(4),w=b(79),t=b(35),B=b(1),z=b(173),x=b(20),y=b(174);n.prototype.Wc=function(ca,ra){switch(ra){case -1203788282:case 48568533:case -1662108744:return ca=x.g(this.$),ra=this.convertToLinkedEntityManager.phi||7E3,ca&&ca.ga&&ca.ga.wa.Nd.BO>ra?!0:!1;default:return!1}};n.prototype.executeCommand=function(ca,ra,La){ca=t.TaskExtensions.dm();ra=ra.command;switch(ra){case -1203788282:this.convertToLinkedEntityManager.WQg(La[w.a.Md].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();
break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(La[w.a.Md].toString());break;case 1266950951:this.convertToLinkedEntityManager.m$h();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:B.EwaSettings.ka(695)&&this.convertToLinkedEntityManager.LCe();
break;case 1702917262:B.EwaSettings.ka(695)&&this.convertToLinkedEntityManager.showHelpArticle(v.a.Jvj);break;case -90814711:B.EwaSettings.ka(695)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===ra||La[w.a.Faf]&&"ConvertToLinkedEntityGallery"===La[w.a.Faf].toString())h.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),y.a("ExpandDataTypeGallery");
break;default:ca=z.a(ra)}return ca};n.prototype.Ec=function(ca,ra){switch(ra.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return B.EwaSettings.ka(130);case -1081442996:case 1702917262:case -90814711:return B.EwaSettings.ka(695);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}};n.prototype.Yc=function(ca,ra,La){return"PopulateConvertToLinkedEntityMenu"===ra&&B.EwaSettings.ka(130)?this.convertToLinkedEntityManager.Yc(ca,
ra,La):!1};Object(C.a)(n,"ConvertToLinkedEntityCommandHandler",null,[160]);var J=b(451),E=r.a;Em(l,E);l.prototype.Gd=function(){var ca=this;J.a(this.$,271,272,this.rb,function(ra){ca.Ad([new n(ra,ca.$)])},"Microsoft.Office.Excel.WebUI.Client.ConvertToLinkedEntity.IConvertToLinkedEntityManager")};l.ja=function(ca){r.a.Yd(273,new l(ca))};Object(C.a)(l,"ConvertToLinkedEntityCommandHandlerFactory",r.a,[]);F=b(212);var A=b(870),H=b(58),S=b(404),Q=F.a;Em(d,Q);d.prototype.create=function(){var ca=this,ra=
H.GetServiceTaskFactory.create(this.$.ea,102,this.$.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),La=H.GetServiceTaskFactory.Va(this.$.ea,5,4,this.rb,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager"),na=H.GetServiceTaskFactory.Va(this.$.ea,388,387,this.rb,"Microsoft.Office.Excel.WebUI.Client.SvgIconProvider.ISvgIconProvider"),ma=H.GetServiceTaskFactory.Va(this.$.ea,35,106,this.rb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");
if(this.$.Pj)t.TaskExtensions.Aa(t.TaskExtensions.xe([ra,La,na,ma],this.la),function(){ca.Eb(ca.$.ea.Ba(271)||new A.ConvertToLinkedEntityManager(ca.$,ra.result,na.result,null,null,La.result,ma.result))},this.$.la,3);else{var xa=H.GetServiceTaskFactory.Va(this.$.ea,257,258,this.rb,"Microsoft.Office.Excel.WebUI.Client.IEnrichmentTaskPane"),Pa=S.a(this.$);t.TaskExtensions.Aa(t.TaskExtensions.xe([ra,xa,Pa,La,na,ma],this.la),function(){ca.Eb(ca.$.ea.Ba(271)||new A.ConvertToLinkedEntityManager(ca.$,ra.result,
na.result,xa.result,Pa.result,La.result,ma.result))},this.$.la,3)}};d.ja=function(ca){ca.ea.Ia(272,new d(ca))};Object(C.a)(d,"ConvertToLinkedEntityManagerFactory",F.a,[]);var L=b(37),aa=b(230),fa=b(257),W=b(44),G=b(245),N=b(11),Y=b(808),V=b(65),da=aa.a;Em(e,da);e.prototype.EF=function(ca){this.get_events().addHandler("EnrichmentTaskPaneRemoved",ca)};e.prototype.pH=function(ca){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",ca)};e.prototype.kB=function(ca){this.addHandler("EnrichmentTaskPaneVilibilityChanged",
ca)};e.prototype.AC=function(ca){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",ca)};e.prototype.vtg=function(ca){this.addHandler("EnrichmentTaskPaneOnFocus",ca)};e.prototype.ZUi=function(ca){this.removeHandler("EnrichmentTaskPaneOnFocus",ca)};e.prototype.Av=function(){};e.prototype.FB=function(){};e.prototype.Um=function(){return this.Po};e.prototype.np=function(){return this.Po};e.prototype.rE=function(){};e.prototype.dispose=function(){this.$&&this.$.Lo(Object(L.a)(this,this.Pd,"onWorkbookClosing"));
this.taskPaneManager=this.$=null;da.prototype.dispose.call(this)};e.prototype.Le=function(ca,ra){ra||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!ra};e.prototype.rh=function(ca){return N.DOMElementExtensions.Ue(this.Ib,ca)};e.prototype.Uh=function(){};e.prototype.Nh=function(){};e.prototype.Hf=function(ca){this.Po=ca;var ra=this.taskPaneManager;this.isVisible=ca;W.a.Jd(this.$)?ca?this.taskPaneManager.uQ("EnrichmentTaskPane",this.pK):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(ca&&
0<ra.Sy.length&&(!ra.wg||10!==ra.wg.taskPane.qg||ra.isCollapsed)&&ra.FC(this,!0),ra.No());ca||(x.g(this.$).Le(!0,!1),this.$.zf())};e.prototype.sG=function(){return!1};e.prototype.Pd=function(){this.Hf(!1)};e.ja=function(ca,ra){var La=ca.Jb,na=document.getElementById(La+v.a.jDe);na||(na=Y.a("div",ca.Jb+v.a.jDe,"cui-taskpane"),W.a.Jd(ca)||(La=document.getElementById(La+v.a.lQ),void 0!==La&&null!==La?La.appendChild(na):h.ULS.sendTraceTag(537166720,0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",
ca.cE)));La=ca.ea;return La.Ba(257)||La.Ia(257,new e(na,ca,ra))};Ll.Object.defineProperties(e.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(V.a)(e.prototype,this,"isVisible")},set:function(ca){Object(V.b)(e.prototype,this,"isVisible",ca);this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Vd:{configurable:!0,enumerable:!0,get:function(){return G.a.L8g}},qg:{configurable:!0,
enumerable:!0,get:function(){return 10}},Nj:{configurable:!0,enumerable:!0,get:function(){return"ewanov_linkedrecordPane"}},VB:{configurable:!0,enumerable:!0,get:function(){return this.titleText}},titleText:{configurable:!0,enumerable:!0,get:function(){return"Enrichment"}},vl:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Ib:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,
enumerable:!0,get:function(){return this.taskPaneManager.oK.offsetHeight}},pK:{configurable:!0,enumerable:!0,get:function(){var ca=this;return this.taskPaneManager.bta(this.Ib,this.titleText,this.vl,this.isResizable,function(){ca.isVisible=!0},function(){ca.isVisible=!1},function(){ca.isVisible=!0},function(){ca.isVisible=!1},this.vl)}}});Object(C.a)(e,"EnrichmentTaskPane",aa.a,[831,6,342,120]);var U=F.a;Em(a,U);a.prototype.create=function(){var ca=this,ra=H.GetServiceTaskFactory.create(this.$.ea,
203,this.la,this.rb,"System.IDisposable"),La=H.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary");t.TaskExtensions.Aa(t.TaskExtensions.ts(t.TaskExtensions.xe([ra,La],this.la),function(){return ca.lC},this.la),function(){ca.Eb(ca.Ug)},this.la,3)};a.prototype.dispose=function(){this.Ug=this.fi=this.$=null;U.prototype.dispose.call(this)};a.ja=function(ca){ca.ea.Ia(258,new a(ca))};Ll.Object.defineProperties(a.prototype,{lC:{configurable:!0,enumerable:!0,get:function(){var ca=
this;this.fi||(this.fi=t.TaskExtensions.Aa(S.a(this.$),function(ra){ca.Ug=e.ja(ca.$,ra.result)},this.la,3));return this.fi}}});Object(C.a)(a,"EnrichmentTaskPaneFactory",F.a,[]);var Z=b(12);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(function(){Z.a.Ga(function(ca){a.ja(ca);d.ja(ca);l.ja(ca)})})()},870:function(C,F,b){function a(sb,fb,Qa,cb,Ab,gc,Lc){var Nc=jc.call(this)||this;Nc.vrb=!1;Nc.pIb=!1;Nc.hgd=null;Nc.xKa=null;Nc.gjd=null;Nc.hjd=null;Nc.iaa=null;Nc.gcc=
null;Nc.odc=null;Nc.mkd=null;Nc.I1a=0;Nc.qzb=0;Nc.otb=0;Nc.uaa=null;Nc.ogd=!1;Nc.QEd=null;Nc.Mm=null;Nc.m7c=null;Nc.Gq=0;Nc.eL=null;Nc.ZEj=null;Nc.TIa=8;Nc.QMa=!1;Nc.S4e=!1;Nc.Zaf=!1;Nc.dUc=!1;Nc.D_a=null;Nc.k0a=null;Nc.fxa=null;Nc.YRc=0;Nc.uAg=5;Nc.fXb=3E4;Nc.$Zf=!1;Nc.H8=null;Nc.cYb=null;Nc.B9=Array(12);Nc.qQd=!1;Nc.y1f=!1;Nc.Qmd=0;Nc.bJf=0;Nc.g4d=null;Nc.lfg=!1;Nc.$=sb;Nc.businessBar=gc;Nc.svgIconProvider=Qa;Nc.sg=Lc;Nc.Eva=[];Nc.AJ=[];Nc.gridView=P.g(Nc.$);Nc.G9b=-1;Nc.pvb=oc.EwaSettings.ka(132);
Nc.hva=oc.EwaSettings.ka(464);Nc.v3h=oc.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");Nc.j3a=Nc.$.ka(461)&&Nc.$.ka(298);Nc.W3a=Nc.$.ka(719);Nc.Svb=oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);Nc.kva=Nc.$.ka(718)&&Nc.hva;Nc.ujd=Nc.kva&&oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);Nc.i6e=oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",
!1);Nc.aKa=oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CheckExtraPowerBILicenses",!1);Nc.sL=new Db.a;Nc.LLa=new d(sb,fb,Nc);cb&&(Nc.Mm=new l(sb,cb,Ab,Nc,Nc));oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityReduceGallerySize",!1)&&(Nc.B9=Array(5));Nc.pvb?(Nc.$.Jk(Object(G.a)(Nc,Nc.jd,"onWorkbookOpened")),U.a(Nc.$)&&U.a(Nc.$).Q6i(Nc),Nc.Ope()):sb.ea.Ia(271,Nc);(Nc.Svb||Nc.j3a||Nc.W3a)&&Nc.$.fa.Vs(Object(G.a)(Nc,Nc.Gf,"onWorkbookMetadataChanged"));oc.EwaSettings.ka(130)&&
oc.EwaSettings.ka(139)&&(Nc.n0f()||Nc.gridView.uq(Object(G.a)(Nc,Nc.onContentReady,"onContentReady")));Nc.hva&&Nc.$.hD(Object(G.a)(Nc,Nc.fk,"onContentAreaResized"));oc.EwaSettings.ka(695)&&(Nc.$.fa.Yj(Object(G.a)(Nc,Nc.Vc,"onSessionIdChanged")),Nc.showUntrustedImageBusinessBarIfNecessary());Nc.ujd&&(Nc.QEd=new e(Nc.$,Nc));return Nc}function e(sb,fb){this.Rcd=this.Tcd=!1;this.$=sb;this.dya=fb}function d(sb,fb,Qa){this.Smd=2;this.Rmd="Size64by48";this.$=sb;this.Sa=fb;this.convertToLinkedEntityManager=
Qa;this.kva=oc.EwaSettings.ka(718)&&oc.EwaSettings.ka(464)}function l(sb,fb,Qa,cb,Ab){var gc=this;this.Qra=this.Tze=!1;this.c$a=this.Oua=!0;this.zBb=this.kHb=!1;this.sab=null;this.akc=0;this.$=sb;this.gridView=P.g(this.$);this.gridView.ga.o1(Object(G.a)(this,this.Bh,"onSelectionEnded"));this.gridView.uq(Object(G.a)(this,this.oQ,"onGridContentReady"));this.LDe=cb;this.convertToLinkedEntityManager=Ab;Wa.a.Jd(this.$)||Qa.IP(fb);sb=new w(fb);this.B3b=new h(sb);fa.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Lc){Lc.isFeatureEnabled("mso_sendASmile",
!0).then(function(Nc){gc.Oua=Nc;return null})})}function n(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}function r(sb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=sb;
this.commentQuestion=eb.a.instance.Bb(188);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=eb.a.instance.Bb(184);this.ratingValuesAscending=[eb.a.instance.Bb(185),eb.a.instance.Bb(186),eb.a.instance.Bb(187)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=eb.a.instance.Bb(183)}function h(sb){return v.call(this,sb)||this}function v(sb){this.Hx=null;this.Lda=sb}function w(sb){var fb=t.call(this,H.AFrameworkApplication.xa.Ty,H.AFrameworkApplication.xa.Uy,
H.AFrameworkApplication.xa.Gca,H.AFrameworkApplication.xa.Me,H.AFrameworkApplication.Hb)||this;fb.taskPane=sb;fb.taskPane.vtg(Object(G.a)(fb,fb.hOf,"setFocusOnIFrame"));return fb}function t(sb,fb,Qa,cb,Ab){this.oq=this.oi=this.z0d=this.y0d=this.Xu=this.Pt=null;this.fw=!1;this.Pg=sb;this.de=fb;this.qF=Qa;this.dc=cb;this.La=Ab;this.Wna=ea.KeyInputManager.Rl(ab.a.Tza,0)}function B(sb,fb,Qa){sb=z.call(this,sb,fb)||this;sb.telemetryJson=null;sb.telemetryJson=Qa;return sb}function z(sb,fb){sb=x.call(this,
sb)||this;sb.messageContent=null;sb.messageContent=fb;return sb}function x(sb){this.messageType=0;this.messageType=sb}function y(){}function J(sb,fb,Qa,cb,Ab,gc,Lc,Nc,yd,Od,sa){sa=sb.Na(1,void 0===sa?null:sa);sa.selectedRanges=fb;sa.isChangeObject=Qa;sa.isFloodgateEnabled=cb;sa.isStarterData=Ab;sa.starterDataDomainId=gc;return ma.i(sb,"GetDataSelectorPaneData",sa,Lc,Nc,yd,Od,4)}b.r(F);C=b(0);var E=b(15),A=b(86),H=b(5),S=b(30),Q=b(931),L=b(143),aa=b(371),fa=b(88),W=b(935),G=b(37),N=b(83),Y=b(36),V=
b(18),da=b(4),U=b(162),Z=b(1232),ca=b(1246),ra=b(196),La=b(575),na=b(336),ma=b(81),xa=b(808),Pa=b(904);y.ASh="EnrichmentContentFrame";y.width=320;Object(C.a)(y,"EnrichmentConstants",null,[]);Object(C.a)(x,"EnrichmentResponseMessage",null,[]);Em(z,x);Object(C.a)(z,"EnrichmentResponseMessageWithContent",x,[]);Em(B,z);Object(C.a)(B,"EnrichmentResponseMessageWithContentAndTelemetryData",z,[]);var ib=b(277),pb=b(13),xb=b(100),Ya=b(40),ab=b(90),ea=b(117),ta=b(41),Ka=b(78),mb=b(23),Ha=b(108),Ga=b(801),Fa=
b(28);t.prototype.dispose=function(){this.dHb&&this.oq&&(this.Pg.za(pb.a.click,this.oq,Object(G.a)(this,this.Qj,"onClosePaneClick")),this.de.za(pb.a.Xd,this.oq,Object(G.a)(this,this.Aof,"onKeyHide")));this.oq=null;this.Xu&&(this.$uj(),this.Xu.parentNode.removeChild(this.Xu),this.Xu=null);this.dc.Th("EnrichmentPaneId").Hk(this.Wna)};t.prototype.show=function(sb,fb,Qa){this.Pt=sb;this.fw||(this.oi=this.EYa(),this.sOa.appendChild(this.oi),this.zQi(),this.La.Xb(Fa.a.ore,Ha.a.frame,Object(G.a)(this,this.xNh,
"handleEscapeKeyAction")),this.Qla(),this.fw=!0);this.Xu.src=this.TZa&&this.TZa.length?this.TZa+"?culture="+fb.market+"&appName="+fb.applicationName+"&themeId="+fb.themeId+"&featuresBitMask="+fb.featuresBitMask:t.vif;this.y0d=fb;this.z0d=Qa;this.gab()};t.prototype.Wvc=function(sb,fb){sb=new B(2,sb,fb);this.Qkc(sb)};t.prototype.Qla=function(){var sb=this.dc.Th("EnrichmentPaneId");sb.parent=ib.AFrame.Sva;this.Pg.FVa("EnrichmentPaneId",this.oi);sb.bindAction(this.Wna,Fa.a.ore)};t.prototype.hOf=function(){if(this.Xu){xb.FocusManager.Fma(this.Xu.contentWindow);
var sb=new B(4,null,null);this.Qkc(sb)}};t.prototype.Qj=function(){this.BZb();return!0};t.prototype.Aof=function(sb){sb=sb.Ea.keyCode;return sb===Sys.UI.Key.enter||sb===Sys.UI.Key.space?(this.BZb(),!0):!1};t.prototype.BZb=function(){this.hide();if(this.Pt)this.Pt.onPaneClosed()};t.prototype.EYa=function(){var sb=xa.a("div","EnrichmentPaneId","EnrichmentPane");this.dHb&&sb.appendChild(this.iZc());this.dWh(sb);return sb};t.prototype.iZc=function(){var sb=xa.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),
fb=xa.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");fb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;fb.title=CommonUIStrings.l_EnrichmentPaneTitle;var Qa=Pa.a.Ab("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Pg.pa(pb.a.click,Qa,Object(G.a)(this,this.Qj,"onClosePaneClick"));this.de.pa(pb.a.Xd,Qa,Object(G.a)(this,this.Aof,"onKeyHide"));sb.appendChild(fb);sb.appendChild(Qa);this.oq=Qa;return sb};t.prototype.dWh=
function(sb){this.Xu=xa.b("iframe","","EnrichmentFrame");sb.appendChild(this.Xu);this.Xu.id=y.ASh;this.Xu.setAttribute("role","presentation")};t.prototype.zQi=function(){Ya.a.addHandler(this.Xu,"load",Object(G.a)(this,this.eof,"onIFrameLoad"));Ya.a.addHandler(this.Xu,"error",Object(G.a)(this,this.nic,"onIFrameError"));$addHandler(window,"message",Object(G.a)(this,this.fof,"onIFrameMessage"))};t.prototype.$uj=function(){Ya.a.removeHandler(this.Xu,"load",Object(G.a)(this,this.eof,"onIFrameLoad"));Ya.a.removeHandler(this.Xu,
"error",Object(G.a)(this,this.nic,"onIFrameError"));$removeHandler(window,"message",Object(G.a)(this,this.fof,"onIFrameMessage"))};t.prototype.I_g=function(){this.Xu.src=t.vif};t.prototype.hide=function(){this.l$b();this.I_g()};t.prototype.xNh=function(sb,fb,Qa){if(1!==Qa&&(this.hide(),this.Pt))this.Pt.onPaneClosed();return 32};t.prototype.eof=function(){};t.prototype.nic=function(){};t.prototype.fof=function(sb){sb=sb.rawEvent;if(!this.Xu||-1!==this.Xu.src.indexOf(sb.origin)){try{var fb=ta.a(sb.data)}catch(Qa){return}if(!Ga.c(fb.messageType)){sb=
window.g_badCastCallback;window.g_badCastCallback=null;switch(fb.messageType){case 2:this.Qkc(new B(1,ta.c(this.y0d),this.z0d));break;case 1:this.Qkc(new z(0,this.Ith()));break;case 3:this.Pt&&this.Pt.selectEntity(fb.messageContent);break;case 5:this.Pt&&this.Pt.Syb(fb.messageContent);break;case 8:this.Pt&&(fb=ta.a(fb.messageContent),0<fb.DomainId?this.Pt.RFd(fb.Query,fb.TelemetryJson,fb.DomainId,fb.DomainIdString):this.Pt.searchEntity(fb.Query,fb.TelemetryJson));break;case 6:this.Pt&&this.Pt.cancelSearch();
break;case 11:fb=ta.a(fb.messageContent);fb=t.q0b("keydown","f6",ab.a.qyc,!0,!1,fb,!0,!1);this.Xu&&this.Xu.dispatchEvent(fb);break;case 12:if(ta.a(fb.messageContent).keyCode===ab.a.AN&&(fb=t.q0b("keydown","esc",ab.a.AN,!0,!1,!1,!1,!1),this.Xu&&(this.Xu.dispatchEvent(fb),this.hide(),this.Pt)))this.Pt.onPaneClosed();break;case 13:this.Pt&&this.Pt.selectDataType(fb.messageContent);break;case 14:this.Pt&&this.Pt.showHelpArticle(fb.messageContent);break;case 15:this.Pt&&this.Pt.showSurveyDialog(fb.messageContent);
break;case 16:this.Pt&&(fb=ta.a(fb.messageContent),this.Pt.insertTable(fb.DomainId,fb.DomainIdString))}window.g_badCastCallback=sb}}};t.prototype.Ith=function(){return ta.c([2,1,3,5,8,6])};t.prototype.Qkc=function(sb){sb=ta.c(sb);this.Xu.contentWindow.postMessage(sb,Ka.a.k$(this.TZa))};t.q0b=function(sb,fb,Qa,cb,Ab,gc,Lc,Nc){mb.a.pu?(gc=String.format("{0} {1} {2}",gc?"Shift":"",Lc?"Control":"",Nc?"Alt":""),gc.trim(),Qa=document.createEvent("KeyboardEvent"),Qa.initKeyboardEvent(sb,cb,Ab,window.self,
fb,0,gc,!1,"en-US")):(fb={},fb.keyCode=Qa,fb.ctrlKey=Lc,fb.shiftKey=gc,fb.altKey=Nc,fb.bubbles=cb,fb.cancelable=Ab,Qa=new KeyboardEvent(sb,fb));return Qa};Ll.Object.defineProperties(t.prototype,{dHb:{configurable:!0,enumerable:!0,get:function(){return!0}},TZa:{configurable:!0,enumerable:!0,get:function(){return H.AFrameworkApplication.ha.Ta("EnrichmentPaneUrl")}}});t.vif="about:blank";Object(C.a)(t,"EnrichmentPane",null,[872,6]);Em(w,t);w.prototype.gab=function(){this.taskPane.isVisible||this.taskPane.Hf(!0)};
w.prototype.l$b=function(){this.taskPane.Hf(!1)};w.prototype.dispose=function(){this.taskPane&&(this.taskPane.ZUi(Object(G.a)(this,this.hOf,"setFocusOnIFrame")),this.taskPane=null);t.prototype.dispose.call(this)};Ll.Object.defineProperties(w.prototype,{sOa:{configurable:!0,enumerable:!0,get:function(){return this.taskPane.Ib},set:function(sb){this.taskPane.Ib.innerHTML=sb.innerHTML}}});Object(C.a)(w,"EnrichmentTaskPaneWrapper",t,[]);v.prototype.p$h=function(sb,fb){this.Hx=sb;this.Lda&&this.Lda.show(this,
fb,null)};v.prototype.Wvc=function(sb,fb){this.Lda&&this.Lda.Wvc(sb,fb)};v.prototype.Xtb=function(){this.Lda&&this.Lda.hide()};v.prototype.dispose=function(){this.Lda&&(this.Lda.dispose(),this.Lda=null)};v.prototype.selectEntity=function(sb){return this.Hx?this.Hx.selectEntity(sb):!1};v.prototype.searchEntity=function(sb,fb){this.Hx&&this.Hx.searchEntity(sb,fb)};v.prototype.RFd=function(sb,fb,Qa,cb){this.Hx&&this.Hx.RFd(sb,fb,Qa,cb)};v.prototype.Syb=function(sb){return this.Hx?this.Hx.Syb(sb):!1};
v.prototype.onPaneClosed=function(){if(this.Hx)this.Hx.onPaneClosed()};v.prototype.cancelSearch=function(){this.Hx&&this.Hx.cancelSearch()};v.prototype.selectDataType=function(sb){this.Hx&&this.Hx.selectDataType(sb)};v.prototype.showHelpArticle=function(sb){this.Hx&&this.Hx.showHelpArticle(sb)};v.prototype.showSurveyDialog=function(sb){this.Hx&&this.Hx.showSurveyDialog(sb)};v.prototype.insertTable=function(sb,fb){this.Hx&&this.Hx.insertTable(sb,fb)};Object(C.a)(v,"EnrichmentManager",null,[870,6]);
Em(h,v);h.prototype.dispose=function(){v.prototype.dispose.call(this)};Object(C.a)(h,"ExcelEnrichmentManager",v,[]);var eb=b(16);Object(C.a)(r,"FloodgateSurvey",null,[]);var db=b(25),Na=b(79),kb=b(406),Tb=b(46),ha=b(364),lb=b(161),Wa=b(44),Ra=b(92),Yb=b(27),oc=b(1),zb=b(7),uc=b(275),P=b(20);Object(C.a)(n,"EnrichmentMessageContentAppProperties",null,[]);l.prototype.dispose=function(){this.$&&(this.gridView.ga.Nba(Object(G.a)(this,this.Bh,"onSelectionEnded")),this.gridView.Cs(Object(G.a)(this,this.oQ,
"onGridContentReady")))};l.prototype.selectEntity=function(sb){function fb(){return new kb.a}var Qa=this,cb=Tb.o(this.gridView.ga.wa.activeCell,this.$);ha.a(this.$.userOperationManager,function(Ab,gc,Lc){var Nc=Qa.$.ra.ua;Ab=uc.b(Ab,Object(G.a)(Qa,Qa.azi,"onSelectLinkedEntitySucceeded"));var yd=Nc.Na(9,null);yd.activeCell=cb;yd.selectionIndex=sb;return ma.i(Nc,"SelectLinkedEntityForDisambiguation",yd,Ab,gc,Lc,null,4)},function(Ab){return new lb.a(109,0,Ab,void 0,fb)},null);return!0};l.prototype.searchEntity=
function(sb,fb,Qa,cb,Ab){var gc=this;Qa=void 0===Qa?!1:Qa;cb=void 0===cb?0:cb;Ab=void 0===Ab?null:Ab;E.ULS.sendTraceTag(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",fb);var Lc=Tb.o(this.gridView.ga.wa.activeCell,this.$);ha.a(this.$.userOperationManager,function(Nc,yd,Od){var sa=gc.$.ra.ua,vb=gc.Oua,Lb=Qa,rc=cb,Oc=Ab;Nc=uc.b(Nc,Object(G.a)(gc,gc.Xrf,"onSearchLinkedEntitySucceeded"));var Bb=sa.Na(1,null);Bb.searchCell=Lc;Bb.searchQuery=sb;Bb.isFloodgateEnabled=
vb;Bb.isStarterData=Lb;Bb.starterDataDomainId=rc;Bb.starterDataDomainIdString=Oc;return ma.i(sa,"LinkedEntitySearch",Bb,Nc,yd,Od,null,4)},function(Nc){return new lb.a(110,0,Nc,16)},null)};l.prototype.Syb=function(sb){var fb=this,Qa=Tb.o(this.gridView.ga.wa.activeCell,this.$);this.c$a=!1;ha.a(this.$.userOperationManager,function(cb,Ab,gc){var Lc=fb.$.ra.ua;cb=uc.b(cb,Object(G.a)(fb,fb.lwi,"onMoveToAmbiguousItemSucceeded"));var Nc=Lc.Na(1,null);Nc.activeCell=Qa;Nc.isBackward=sb;return ma.i(Lc,"MoveToNextAmbiguousLinkedEntity",
Nc,cb,Ab,gc,null,4)},function(cb){return new lb.a(111,0,cb,16)},null);return!0};l.prototype.onPaneClosed=function(){this.Qra=!1;this.Tze=!0;this.akc=0;this.zBb=!1};l.prototype.cancelSearch=function(){var sb=this,fb=this.iGd();fb&&ha.a(this.$.userOperationManager,function(Qa,cb,Ab){var gc=sb.$.ra.ua;Qa=uc.b(Qa,Object(G.a)(sb,sb.Xrf,"onSearchLinkedEntitySucceeded"));var Lc=gc.Na(9,null);Lc.activeCell=fb;return ma.i(gc,"CancelSearchLinkedEntity",Lc,Qa,cb,Ab,null,4)},function(Qa){return new lb.a(112,
0,Qa,16)},null)};l.prototype.selectDataType=function(sb){E.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Uqa();if(sb&&sb.length)if(sb=JSON.parse(sb))if(null==sb.domainId)E.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var fb={};fb.Id=sb.domainId;fb.StringId=sb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(fb)}else E.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else E.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")};l.prototype.showHelpArticle=function(sb){var fb=new Ra.a(-859308420,Na.a.Tb,this.$.dd,9,null),Qa={};sb=(Qa.CommandValueId="HelpID="+sb,Qa.InputMethod=Na.a.Tb,Qa.ShouldCanvasTakeFocus=!0,Qa.MenuItemId=da.a.AY,Qa);this.$.Ka.Ub(fb,sb)};l.prototype.showSurveyDialog=function(sb){ca.a.OHb(new r(sb))};l.prototype.insertTable=
function(sb,fb){var Qa=this,cb=this.iGd();cb&&ha.a(this.$.userOperationManager,function(Ab,gc,Lc){var Nc=Qa.$.ra.ua;Ab=uc.b(Ab,Object(G.a)(Qa,Qa.Sui,"onInsertStarterDataTableSucceeded"));var yd=Nc.Na(1,null);yd.cell=cb;yd.starterDataDomainId=sb;yd.starterDataDomainIdString=fb;return ma.i(Nc,"InsertStarterDataTable",yd,Ab,gc,Lc,null,4)},function(Ab){return new lb.a(259,0,Ab,1)},null)};l.prototype.oQ=function(){(this.c$a||this.Qra)&&2!==this.akc&&(this.zBb||this.qmd(!1))};l.prototype.Vc=function(){E.ULS.sendTraceTag(537166944,
0,15,"Session ID changed while ambiguous linked entities are present")};l.prototype.qmd=function(sb){this.launchOrCloseDisambiguationPane(sb)};l.prototype.launchDisambiguationPaneForSearch=function(){var sb=this;E.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");var fb=this.H3i();fb&&ha.a(this.$.userOperationManager,function(Qa,cb,Ab){return J(sb.$.ra.ua,fb,!0,sb.Oua,!1,null,uc.b(Qa,Object(G.a)(sb,
sb.Psi,"onGetDisambiguationDataForSearchSucceeded")),cb,Ab,1)},function(Qa){return new lb.a(114,0,Qa,16)},null)};l.prototype.launchLinkedEntityDataTypeSelectorPane=function(sb,fb){var Qa=this;ha.a(this.$.userOperationManager,function(cb,Ab,gc){var Lc=Qa.$.ra.ua;cb=uc.b(cb,Object(G.a)(Qa,Qa.hic,"onGetDisambiguationDataSucceeded"));var Nc=Lc.Na(1,null);Nc.selectedRanges=sb;Nc.letyDomainId=fb;return ma.i(Lc,"GetDataTypeSelectorData",Nc,cb,Ab,gc,2,4)},function(cb){return new lb.a(233,0,cb,16)},null)};
l.prototype.j$h=function(sb,fb){var Qa=this;sb&&ha.a(this.$.userOperationManager,function(cb,Ab,gc){return J(Qa.$.ra.ua,sb,!1,!1,!0,fb,uc.b(cb,Object(G.a)(Qa,Qa.hic,"onGetDisambiguationDataSucceeded")),Ab,gc,2)},function(cb){return new lb.a(257,0,cb,16)},null)};l.prototype.vqi=function(sb){Yb.a.Zg(sb.Errors)?(sb=Yb.a.Uc(sb.Errors),zb.a.contains(sb,"OperationSucceededWithAlert",!1)?E.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):E.ULS.sendTraceTag(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",
sb)):sb.Result&&(this.$.fa.qk(Object(G.a)(this,this.Vc,"onSessionIdChanged")),this.$.fa.Yj(Object(G.a)(this,this.Vc,"onSessionIdChanged")),sb=sb.Result,this.sab=sb.SkydanceFeatureBitmask,this.jqd(sb),this.kHb=!0)};l.prototype.Bh=function(){(this.c$a||this.Qra)&&this.qmd(!1)};l.prototype.hic=function(sb,fb){Yb.a.Zg(sb.Errors)?E.ULS.sendTraceTag(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",Yb.a.Uc(sb.Errors)):sb.Result&&(sb=sb.Result,sb.DisambiguationJson?
(this.kHb=!1,this.dPf(fb),this.sab=sb.SkydanceFeatureBitmask,fb=sb.DisambiguationJson,E.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.zBb=!1,this.Daf(fb)):E.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};l.prototype.Psi=function(sb,fb){Yb.a.Zg(sb.Errors)?E.ULS.sendTraceTag(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",
Yb.a.Uc(sb.Errors)):sb.Result&&(sb=sb.Result,sb.DisambiguationJson?(this.dPf(fb),this.sab=sb.SkydanceFeatureBitmask,fb=sb.DisambiguationJson,E.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.zBb=!0,this.Daf(fb)):E.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};l.prototype.dPf=function(sb){sb&&(this.akc=
sb)};l.prototype.Daf=function(sb){if(oc.EwaSettings.ka(695)){var fb=new Ra.a(-90814711,Na.a.Tb,0,10,null);this.$.Ka.Ub(fb,null)}this.Qra?this.B3b.Wvc(sb,null):(fb=3,null!=this.sab?fb=this.sab:E.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(sb=this.bzh(sb,fb))||E.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.LDe||E.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.B3b.p$h(this.LDe,sb),
this.Qra=!0)};l.prototype.Uqa=function(){this.Qra&&(E.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.B3b.Xtb(),this.Qra=!1,this.akc=0,this.zBb=!1)};l.prototype.lwi=function(sb){Yb.a.Zg(sb.Errors)?(E.ULS.sendTraceTag(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",Yb.a.Uc(sb.Errors)),this.c$a=!0):sb.Result&&(sb=sb.Result,this.sab=sb.SkydanceFeatureBitmask,this.jqd(sb),this.kHb=!0)};l.prototype.jqd=function(sb){var fb=
sb.Row+1;sb=sb.Column+1;0>fb||0>sb?(E.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Uqa(),this.$.fa.qk(Object(G.a)(this,this.Vc,"onSessionIdChanged"))):(fb=new db.Range(fb,sb,fb,sb,!0,!1),this.gridView.ga.updateSelection(fb,fb,60),this.c$a=!0)};l.prototype.bzh=function(sb,fb){var Qa=new n;Qa.applicationVersion=H.AFrameworkApplication.buildVersion;Qa.applicationName="ExcelWac";Qa.anid="00000000-0000-0000-0000-000000000000";
Qa.sessionId=H.AFrameworkApplication.userSessionId;Qa.appCorrelationId=ra.a.create().toString();var cb=La.a.eJ(H.AFrameworkApplication.lcid);cb=cb?cb.name:null;Qa.uiLanguage=cb;Qa.market=this.l7b(cb);Qa.themeId=0;Qa.disambiguationJson=sb;fb<=na.a.kR?Qa.featuresBitMask=fb:E.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Qa};l.prototype.l7b=function(sb){sb=sb.split("-");return sb[sb.length-1]};l.prototype.launchOrCloseDisambiguationPane=
function(sb){var fb=this,Qa=this.gridView.ga.wa.activeCell;if(this.iGd()&&Qa)if(this.gridView.$b.Uac(Qa)){if((!this.Tze||sb||this.kHb)&&!this.gridView.isEditing){sb&&(this.c$a=!0);var cb=Tb.q(Qa,this.$);ha.a(this.$.userOperationManager,function(Ab,gc,Lc){return J(fb.$.ra.ua,cb,!1,fb.Oua,!1,null,uc.b(Ab,Object(G.a)(fb,fb.hic,"onGetDisambiguationDataSucceeded")),gc,Lc,1)},function(Ab){return new lb.a(114,0,Ab,16)},null)}}else this.Uqa();else this.Uqa()};l.prototype.uPi=function(){var sb=this;if(this.Qra){var fb=
this.gridView.ga.wa.activeCell;if(fb){var Qa=Tb.q(fb,this.$);ha.a(this.$.userOperationManager,function(cb,Ab,gc){return J(sb.$.ra.ua,Qa,!1,sb.Oua,!1,null,uc.b(cb,Object(G.a)(sb,sb.hic,"onGetDisambiguationDataSucceeded")),Ab,gc,1)},function(cb){return new lb.a(114,0,cb,16)},null)}else this.Uqa()}};l.prototype.azi=function(sb){Yb.a.Zg(sb.Errors)&&E.ULS.sendTraceTag(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",Yb.a.Uc(sb.Errors));sb.Result?(this.jqd(sb.Result),this.kHb=
!0):this.Uqa()};l.prototype.Xrf=function(sb){Yb.a.Zg(sb.Errors)?E.ULS.sendTraceTag(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",Yb.a.Uc(sb.Errors)):sb.Result?this.B3b.Wvc(sb.Result,null):(E.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Uqa())};l.prototype.Sui=function(sb){Yb.a.Zg(sb.Errors)?E.ULS.sendTraceTag(537166926,0,15,"Failed to insert starter data table. Error id names: {0}",
Yb.a.Uc(sb.Errors)):this.Uqa()};l.prototype.iGd=function(){var sb=this.gridView.ga.wa;return sb.lva()?Tb.o(sb.activeCell,this.$):null};l.prototype.H3i=function(){var sb=this.gridView.ga.wa;return sb.lva()?Tb.q(sb.activeCell,this.$):null};Object(C.a)(l,"ConvertToLinkedEntityDisambiguationPane",null,[6]);var lc=b(828),Ec=b(1349),tc=b(52),cc=b(818);d.prototype.Hrh=function(sb,fb){return this.Grh(sb,fb).pB()};d.prototype.Grh=function(sb,fb){fb=this.Sa.$o(fb);if(sb&&0<sb.length){var Qa=this.Sa.Oc();fb.Bc.push(Qa);
var cb=this.Sa.Lz("ConvertToLinkedEntitySeeMore",this.Smd,this.Rmd);sb=Ol(sb);for(var Ab=sb.next();!Ab.done;Ab=sb.next())if(Ab=Ab.value,!Ab.DomainId.StringId&&!Ab.DomainBlocked&&Ab.ShowInRibbon){var gc=Ab.DomainId.Id.toString();cb.Efd(0,"Data.ConvertToLinkedEntityMenuItem_"+gc,-1203788282,"QueryLinkedEntityGalleryIcon",Ab.Description,gc,this.GSh(Ab.Name))}Array.add(Qa.buttons,cb)}fb.Bc.length||E.ULS.sendTraceTag(537166722,0,15,"No domain data available");return fb};d.prototype.Irh=function(sb,fb){var Qa=
b(870).ConvertToLinkedEntityManager;this.oxj();fb=this.Sa.$o(fb).pB();for(var cb=0,Ab=0,gc=!1,Lc=Ol(sb.Categories),Nc=Lc.next();!Nc.done;Nc=Lc.next()){if(Nc=this.lsh(Nc.value,cb))this.kva&&Ab===Qa.X4a&&(gc=!0),Array.add(fb.MenuSectionList,Nc),++cb;++Ab}this.kva&&gc&&cb<=Qa.abf&&Array.removeAt(fb.MenuSectionList,Qa.X4a);Qa=this.Sa.Oc().NXb();cb=tc.a.ve(11);sb=Ol(sb.LongButtons);for(Ab=sb.next();!Ab.done;Ab=sb.next())Ab=Ab.value,this.convertToLinkedEntityManager.Dej(Ab)&&this.Zpg(Qa,Ab,cb);0<Qa.ControlList.length&&
Array.add(fb.MenuSectionList,Qa);return fb};d.prototype.Zpg=function(sb,fb,Qa){if(fb){var cb="Data.ConvertToLinkedEntityMenuItem_"+fb.Name,Ab=this.convertToLinkedEntityManager.fP(fb.DomainId);Ab&&(fb=Object.assign(new lc.a,{Id:cb,ExternalId:cb,Command:"-1662108744",LabelText:fb.Name,Alt:fb.SuperTip,Visible:!0,MenuItemId:b(870).ConvertToLinkedEntityManager.DZa(fb.DomainId),Image16by16:Qa,Image16by16Class:this.iTh(Ab.FontLocator)}),Array.add(sb.ControlList,fb))}};d.prototype.fsh=function(sb,fb){var Qa=
{};Qa=(Qa.width=24,Qa["min-width"]=24,Qa.height=24,Qa);var cb={};return Object.assign(new Ec.a,{Id:b(870).ConvertToLinkedEntityManager.IBe+sb.toString(),ExternalId:b(870).ConvertToLinkedEntityManager.IBe+sb.toString(),MenuItemId:b(870).ConvertToLinkedEntityManager.U1c+sb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.h0e(fb.FontLocator),LabelText:fb.Name,PreviewIconStyle:(cb.root=Qa,cb),Alt:this.X8c(fb)})};d.prototype.hAg=function(sb){switch(sb){case "Animal":return cc.a.Gwg;
case "Apple":return cc.a.Dxg;case "Atom":return cc.a.czg;case "Beaker":return cc.a.cBg;case "Bridge":return cc.a.yCg;case "Cat":return cc.a.AIg;case "City":return cc.a.GKg;case "Constellation":return cc.a.rPg;case "Dog":return cc.a.f5g;case "Finance":return cc.a.TAg;case "GradCap":return cc.a.jMh;case "HumanAnatomy":return cc.a.vSh;case "LocationPointer":return cc.a.Jbi;case "Map":return cc.a.wCi;case "MedicineNeedle":return cc.a.thi;case "Mountain":return cc.a.aji;case "Movie":return cc.a.qji;case "Music":return cc.a.Dji;
case "OuterSpace":return cc.a.cDi;case "Planet":return cc.a.ZFi;case "Satellite":return cc.a.e1i;case "WolframGeneric":return cc.a.f0i;default:return cc.a.VQg}};d.prototype.iTh=function(sb){if("PowerBIRibbon"!==sb)return V.a.d4c;switch(sb){case "AnimalRibbon":return V.a.lfh;case "AppleRibbon":return V.a.mfh;case "AtomRibbon":return V.a.nfh;case "BeakerRibbon":return V.a.ofh;case "BridgeRibbon":return V.a.pfh;case "CenterMapRibbon":return V.a.qfh;case "CityRibbon":return V.a.rfh;case "CurrencyRibbon":return V.a.sfh;
case "ExerciseRibbon":return V.a.tfh;case "FinanceRibbon":return V.a.DHe;case "FirstAidRibbon":return V.a.ufh;case "GlobeLightningRibbon":return V.a.vfh;case "GradCapRibbon":return V.a.wfh;case "HumanAnatomyRibbon":return V.a.xfh;case "LeafRibbon":return V.a.yfh;case "LocationPointerRibbon":return V.a.Afh;case "MapRibbon":return V.a.BHe;case "MountainRibbon":return V.a.Bfh;case "MovieRibbon":return V.a.Cfh;case "MusicRibbon":return V.a.Dfh;case "NotablePeopleRibbon":return V.a.Efh;case "OuterSpaceRibbon":return V.a.Ffh;
case "PartlySunnyWeatherRibbon":return V.a.Gfh;case "PowerBIRibbon":return V.a.CHe;case "SatelliteRibbon":return V.a.Hfh;case "WolframGenericRibbon":return V.a.zfh;case "YogaRibbon":return V.a.Jfh;default:return V.a.AHe}};d.prototype.h0e=function(sb){switch(sb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";
case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";
case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";
case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}};d.prototype.lsh=function(sb,fb){fb=this.Sa.Lz("ConvertToLinkedEntitySection_"+fb,this.Smd,this.Rmd);for(var Qa=!1,cb=Ol(sb.DomainIds),Ab=cb.next();!Ab.done;Ab=cb.next()){var gc=Ab.value;(Ab=this.convertToLinkedEntityManager.fP(gc))&&!Ab.DomainBlocked&&Ab.ShowInRibbon&&(Qa=Ab.Name,gc=b(870).ConvertToLinkedEntityManager.DZa(gc),
fb.Ts("Data.ConvertToLinkedEntityMenuItem_"+gc,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,gc,this.h0e(Ab.FontLocator),void 0,void 0,this.X8c(Ab),Qa),Qa=!0)}if(!Qa)return null;fb=fb.KXb(!0);cb=this.Sa.Oc();cb.title=sb.Name;sb=cb.NXb();Array.add(sb.ControlList,fb);return sb};d.prototype.GSh=function(sb){return"Stocks"===sb?"Bank_32":"Geography"===sb?"OpenMap_32":"ConvertToEntity_32"};d.prototype.oxj=function(){this.Smd=5;this.Rmd="Size112by64"};d.prototype.X8c=function(sb){return zb.a.ma(sb.RibbonTooltipHeader)?
sb.RibbonTooltip:sb.RibbonTooltipHeader+"\n\n"+sb.RibbonTooltip};Object(C.a)(d,"ConvertToLinkedEntityMenuRenderer",null,[848]);var Zb=b(55),Aa=b(126),Ia=b(174),qb=b(75);e.prototype.rGh=function(){this.Tcd||(E.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),ma.S(this.$.ra.ua,0,Object(G.a)(this,this.Lxi,"onReadRoamingStringSuccess"),Object(G.a)(this,this.Erf,"onRoamingOperationFailure"),null,null))};e.prototype.l6f=
function(sb){sb&&sb.length?this.Tcd?(sb=this.w5i(sb),zb.a.ma(sb)?E.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):(E.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),ma.nb(this.$.ra.ua,0,sb,Object(G.a)(this,this.YBi,"onWriteRoamingStringSuccess"),Object(G.a)(this,this.Erf,"onRoamingOperationFailure"),null,null))):this.Rcd=!0:E.ULS.sendTraceTag(537166690,
0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")};e.prototype.w5i=function(sb){if(!sb||!sb.length)return E.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var fb=[];sb=Ol(sb);for(var Qa=sb.next();!Qa.done;Qa=sb.next()){Qa=Qa.value;var cb={};cb.Id=Qa.Id;Qa.StringId&&(cb.StringId=Qa.StringId);fb.push(cb)}fb="<DataTypes>"+Zb.a.Hc(fb)+"</DataTypes>";return 1906<fb.length?(E.ULS.sendTraceTag(537166686,
0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):fb};e.prototype.tEi=function(sb){if(zb.a.ma(sb))return E.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!sb.startsWith("<DataTypes>")||!sb.endsWith("</DataTypes>"))return E.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;sb=sb.substring(11,sb.length-12);
if(zb.a.ma(sb))return E.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;var fb=[];try{fb=Zb.a.Xh(sb)}catch(Qa){return E.ULS.sendTraceTag(537166682,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",Qa.message),null}E.ULS.sendTraceTag(537166681,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",fb.length);return fb};e.prototype.Uhi=function(sb){var fb=this.dya.qDb,Qa=this.dya.zOi;if(fb.length!==Qa){for(var cb=
0;cb<sb.length&&fb.length<Qa;++cb){var Ab=sb[cb];this.dya.fP(Ab)&&!Array.contains(fb,Ab)&&fb.push(Ab)}this.dya.qDb=fb}};e.prototype.Lxi=function(sb){E.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Tcd=!0;if(Yb.a.Zg(sb.Errors))E.ULS.sendTraceTag(537166679,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",Yb.a.Uc(sb.Errors));else{var fb=0,Qa=[],cb=!1;try{if(!sb.Result)return;var Ab=sb.Result;if(zb.a.ma(Ab)){E.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");
return}Qa=this.tEi(Ab);if(!Qa||!Qa.length)return;fb=Qa.length;this.Uhi(Qa);this.dya.VHf();E.ULS.sendTraceTag(537166677,0,50,"OnReadRoamingStringSuccess MruCount:{0}",this.dya.qDb.length);if(oc.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var gc=Ol(this.dya.qDb),Lc=gc.next();!Lc.done;Lc=gc.next())if(1===(Lc.value.Id&1048320)>>8){cb=!0;break}E.ULS.sendTraceTag(537166676,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:{0}",cb)}}finally{E.ULS.sendTraceTag(537166675,
0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",fb),sb=[],sb.push(Object.assign(new qb.a,{name:"MruCount",int64:fb})),sb.push(Object.assign(new qb.a,{name:"MruWolframAvailable",bool:cb})),Ia.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,sb)}this.Rcd&&(this.l6f(this.dya.qDb),this.Rcd=!1)}};e.prototype.YBi=function(sb){E.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Yb.a.Zg(sb.Errors)?E.ULS.sendTraceTag(537166673,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",
Yb.a.Uc(sb.Errors)):sb.Result&&(sb.Result||E.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};e.prototype.Erf=function(sb,fb,Qa){sb=Aa.a.xg(sb.data);E.ULS.sendTraceTag(537166671,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",Qa,Yb.a.Uc(sb))};Object(C.a)(e,"LinkedDataTypeRoamingHandler",null,[]);var wb=b(514),ic=b(57),Jb=b(58),Ua=b(251),$a=b(35),ua=b(43),Ca=b(26),Sa=b(303),Qb=b(9),Hb=b(1070),Db=b(106);b.d(F,"ConvertToLinkedEntityManager",
function(){return a});var jc=Y.a;Em(a,jc);a.prototype.Vc=function(sb,fb){fb.lc&&!fb.idc&&this.showUntrustedImageBusinessBarIfNecessary()};a.prototype.dispose=function(){(this.Svb||this.j3a||this.W3a)&&this.$.fa.Qv(Object(G.a)(this,this.Gf,"onWorkbookMetadataChanged"));oc.EwaSettings.ka(695)&&this.$.fa.qk(Object(G.a)(this,this.Vc,"onSessionIdChanged"));!this.H8&&oc.EwaSettings.ka(130)&&oc.EwaSettings.ka(139)&&this.gridView.Cs(Object(G.a)(this,this.onContentReady,"onContentReady"));this.Mm&&this.Mm.dispose();
this.hva&&this.$.oH(Object(G.a)(this,this.fk,"onContentAreaResized"));this.pvb&&(this.$.dl(Object(G.a)(this,this.jd,"onWorkbookOpened")),this.j3a&&(this.hgd=null));this.sg=null;A.a.Fa(this.fxa)};a.prototype.Zsg=function(sb){this.addHandler("LinkedEntityConverted",sb)};a.prototype.GUi=function(sb){this.removeHandler("LinkedEntityConverted",sb)};a.prototype.selectEntity=function(sb){return this.Mm?this.Mm.selectEntity(sb):!1};a.prototype.searchEntity=function(sb,fb){this.Mm&&this.Mm.searchEntity(sb,
fb)};a.prototype.RFd=function(sb,fb,Qa,cb){this.Mm&&this.Mm.searchEntity(sb,fb,!0,Qa,cb)};a.prototype.Syb=function(sb){return this.Mm?this.Mm.Syb(sb):!1};a.prototype.onPaneClosed=function(){if(this.Mm)this.Mm.onPaneClosed()};a.prototype.cancelSearch=function(){this.Mm&&this.Mm.cancelSearch()};a.prototype.selectDataType=function(sb){this.Mm&&this.Mm.selectDataType(sb)};a.prototype.showHelpArticle=function(sb){this.Mm&&this.Mm.showHelpArticle(sb)};a.prototype.showSurveyDialog=function(sb){this.Mm&&
this.Mm.showSurveyDialog(sb)};a.prototype.insertTable=function(sb,fb){this.Mm&&this.Mm.insertTable(sb,fb)};a.prototype.bPh=function(sb){if(this.$.isEditMode&&this.bJf!==sb&&H.AFrameworkApplication.ha.sa("SupportsPolicies")){this.bJf=sb;E.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");sb=this.$.ra.ua;var fb=Object(G.a)(this,this.Iti,"onGetRichDataClassificationLabelsSuccess"),Qa=sb.Na(1,null);ma.i(sb,"GetRichDataClassificationLabels",
Qa,fb,null,null,null,4)}};a.prototype.Iti=function(sb){if(sb.Result){var fb=sb.Result;if(fb&&fb.length){E.ULS.sendTraceTag(537166922,0,50,"OnGetRichDataClassificationLabelsSuccess: Received {0} labels",fb.length);var Qa=Jb.GetServiceTaskFactory.Va(this.$.ea,274,275,0,"Microsoft.Office.Excel.WebUI.Client.Policy.IPolicyManagerWrapper");$a.TaskExtensions.Aa(Qa,function(){Qa.result.QRc(fb,2)||E.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},
this.$.la,3)}}else E.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};a.prototype.Gf=function(){this.Svb&&(this.Qsj(),this.hOh(this.$.fa.qn.LinkedEntityAsyncRefreshStateId));this.W3a?this.bPh(this.$.fa.qn.RichDataClassificationLabelStateId):this.j3a&&this.CPd(!0)};a.prototype.LCe=function(){function sb(Qa,cb,Ab){var gc=fb.$.ra.ua;Qa=uc.b(Qa,Object(G.a)(fb,fb.xri,"onEnableUntrustedImageUrlsFromServerSuccess"));var Lc=gc.Na(1,null);return ma.i(gc,"LinkedEntitiesEnableUntrustedImages",
Lc,Qa,cb,Ab,null,0)}var fb=this;oc.EwaSettings.pc()?this.$.userOperationManager.jc(new lb.a(589,0,sb,80),null):this.$.userOperationManager.jc(new wb.a(589,0,sb,16),null)};a.prototype.xri=function(){this.qQd=!0;this.Mm&&this.Mm.uPi()};a.prototype.showUntrustedImageBusinessBarIfNecessary=function(){this.qQd||this.y1f||!this.$.fa.lc||this.C4i()};a.prototype.C4i=function(){function sb(Qa,cb,Ab){var gc=fb.$.ra.ua;Qa=uc.b(Qa,Object(G.a)(fb,fb.fti,"onGetHasUntrustedImageUrlsFromServerSuccess"));var Lc=gc.Na(1,
null);return ma.i(gc,"GetHasUntrustedImageUrls",Lc,Qa,cb,Ab,null,4)}var fb=this;oc.EwaSettings.pc()?this.$.userOperationManager.jc(new lb.a(588,0,sb,80),null):this.$.userOperationManager.jc(new wb.a(588,0,sb,16),null)};a.prototype.fti=function(sb){if(sb&&!Sa.a(sb))try{sb.Result.HasUntrustedImageUrl&&(this.businessBar.eg(57,null),this.y1f=!0)}catch(fb){E.ULS.sendTraceTag(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",
fb)}};a.prototype.CPd=function(sb){var fb=this;if(this.j3a&&null==this.hgd&&!this.W3a&&H.AFrameworkApplication.ha.sa("SupportsPolicies")&&null!=this.xKa&&this.xKa&&(!sb||this.$.workbookContext.Options&262144)){var Qa=Jb.GetServiceTaskFactory.Va(this.$.ea,274,275,0,"Microsoft.Office.Excel.WebUI.Client.Policy.IPolicyManagerWrapper");$a.TaskExtensions.Aa(Qa,function(){fb.hgd=Qa.result.XCf(2)},this.$.la,3)}};a.prototype.WQg=function(sb){(sb=this.j5g(sb))?this.convertToLinkedEntity(sb):E.ULS.sendTraceTag(537166920,
0,10,"Could not convert key into domain ID")};a.prototype.convertToLinkedEntity=function(sb){E.ULS.sendTraceTag(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",sb.Id);if(this.gridView){var fb=this.gridView.ga.wa.Nd,Qa=fb.Ef(this.gridView.aJ);this.kva&&this.ogd&&this.Jqg(sb);if(Qa){Qa=this.gridView.$b.A7e(Qa);if(!this.NYe(sb)&&this.f7e(sb.Id)){E.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");
if(ic.a.Df.OG){fb=this.o8c();if(!fb){E.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qa=this.c0b();if(!Qa){E.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var cb={};cb=(cb.InputMethod=Na.a.Tb,cb);cb.CalloutName=3;cb.Target=fb;cb.RibbonButtonLabel=oc.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.SIf(sb):this.$wb(sb.Id.toString());cb.ExampleEntities=this.vIe(sb);this.$.Ka.Ub(Qa,
cb);return}E.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.f7e(sb.Id)&&!sb.StringId)this.launchLinkedEntityDataTypeSelectorPane(a.DZa(sb));else{if(Qa){E.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",
!1)&&this.mnj(sb)){fb=Tb.r(this.gridView.ga.wa.selectedRanges,this.$);this.Mm.j$h(fb,sb);return}if(ic.a.Df.OG){fb=this.o8c();if(!fb){E.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qa=this.c0b();if(!Qa){E.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}cb={};cb=(cb.InputMethod=Na.a.Tb,cb);cb.CalloutName=2;cb.Target=fb;cb.RibbonButtonLabel=this.SIf(sb);cb.ExampleEntities=this.vIe(sb);cb.BlankCellResourceId=this.HBg(sb);
cb.HasBlankCellWalkthrough=this.PPh(sb);cb.ServiceDomain=sb.Id;this.$.Ka.Ub(Qa,cb);return}E.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.dYc(sb,!1,fb)}}}else E.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")};a.prototype.Aaf=function(){if(!this.Zaf&&this.nvb()&&!this.ahd())if(Ia.a("DataTabActive"),ic.a.Df.OG)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var sb=
this.c0b();if(sb){var fb={};fb.InputMethod=Na.a.Tb;fb.CalloutName=8;fb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ka.Ub(sb,fb);this.Zaf=!0}else E.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else E.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else E.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};
a.prototype.convertToLinkedEntityFromAutoDetect=function(){this.H8&&this.H8.K_b()};a.prototype.onAutoDetectUIShown=function(){function sb(Qa,cb,Ab){var gc=fb.$.ra.ua,Lc=gc.Na(1,null);return ma.i(gc,"OnAutoDetectUIShown",Lc,Qa,cb,Ab,null,4)}var fb=this;oc.EwaSettings.pc()?ha.a(this.$.userOperationManager,sb,function(Qa){return new lb.a(230,0,Qa,80)},null):ha.a(this.$.userOperationManager,sb,function(Qa){return new wb.a(230,0,Qa,16)},null)};a.prototype.dYc=function(sb,fb,Qa){function cb(){return new kb.a}
var Ab=this,gc=Tb.q(Qa,this.$);ha.a(this.$.userOperationManager,function(Lc,Nc,yd){var Od=Ab.$.ra.ua;Lc=uc.b(Lc,Object(G.a)(Ab,Ab.wqi,"onConvertToLinkedEntitySuccess"),Object(G.a)(Ab,Ab.dAi,"onSuccessScreenReaderSaysConverted"),Object(G.a)(Ab.Mm,Ab.Mm.vqi,"onConvertToLinkedEntitySucceeded"));var sa=Od.Na(1,null);sa.selectedRanges=gc;sa.domainId=sb;sa.autodetect=fb;return ma.i(Od,"ConvertToLinkedEntity",sa,Lc,Nc,yd,null,4)},function(Lc){return new lb.a(115,0,Lc,void 0,cb)},null)};a.prototype.Jqg=function(sb){if(this.kva&&
this.ogd){var fb={};fb.Id=sb.Id;sb.StringId&&(fb.StringId=sb.StringId);if(!(0<this.AJ.length&&this.AJ[0].Id===fb.Id&&this.AJ[0].StringId===fb.StringId)){sb=!1;Array.insert(this.AJ,0,fb);for(var Qa=1;Qa<this.AJ.length;++Qa)if(this.AJ[Qa].Id===fb.Id&&this.AJ[Qa].StringId===fb.StringId){Array.removeAt(this.AJ,Qa);sb=!0;break}for(;5<this.AJ.length;)Array.removeAt(this.AJ,this.AJ.length-1);this.uaa.Categories[a.X4a].DomainIds=this.AJ;this.VHf();this.ujd&&!sb&&this.QEd.l6f(this.AJ)}}};a.prototype.wqi=function(sb){Yb.a.Zg(sb.Errors)||
(this.W3a||this.CPd(!1),this.raiseEvent("LinkedEntityConverted"))};a.prototype.dAi=function(){this.$.ea.$a(211,function(sb){sb.readText(eb.a.instance.da(1737))})};a.prototype.convertLinkedEntityToText=function(){var sb=this;E.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var fb=Tb.q(this.gridView.ga.wa.Nd,this.$);ha.a(this.$.userOperationManager,function(Qa,cb,Ab){var gc=sb.$.ra.ua,Lc=gc.Na(1,null);Lc.selectedRanges=
fb;return ma.i(gc,"ConvertLinkedEntityToText",Lc,Qa,cb,Ab,null,4)},function(Qa){return new lb.a(116,0,Qa)},null)}else E.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")};a.prototype.refreshLinkedEntitiesInRange=function(){var sb=this;E.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(P.g(this.$)){this.$.isEditMode||E.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");
this.NBd();var fb=Tb.r(this.gridView.ga.wa.selectedRanges,this.$);ha.a(this.$.userOperationManager,function(Qa,cb,Ab){var gc=sb.$.ra.ua,Lc=gc.Na(1,null);Lc.selectedRanges=fb;return ma.i(gc,"RefreshLinkedEntitiesInRange",Lc,Qa,cb,Ab,null,4)},function(Qa){return new lb.a(248,0,Qa)},null)}else E.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")};a.prototype.sdj=function(){return this.ERf(this.D_a)};a.prototype.rdj=function(){return this.ERf(this.k0a)};a.prototype.ERf=function(sb){try{if(2===
this.Gq&&sb){var fb=this.B1c(parseInt(sb));return!fb||!fb.ShowInRibbon}}catch(Qa){E.ULS.sendTraceTag(537166875,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+sb)}return!0};a.prototype.Dej=function(sb){sb=this.fP(sb.DomainId);if(!sb||sb.DomainBlocked||oc.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!sb.HasCuratedData)return!1;if(this.v3h){for(var fb=Ol(this.sL),Qa=fb.next();!Qa.done;Qa=fb.next())if(Qa=Qa.value,Qa.value.DomainId.Id===
sb.DomainId.Id&&Qa.value.ShowInRibbon)return!0;return!1}return sb.ShowInRibbon};a.prototype.odj=function(sb){return 2!==this.Gq||!this.B9[sb]};a.prototype.qdj=function(){if(this.hva)return E.ULS.sendTraceTag(537166874,0,10,"Unexpectedly calling ShouldHideFlyout for new gallery design"),!1;if(!this.sL)return!0;if(null!=this.cYb)return this.cYb;for(var sb=0,fb=Ol(this.sL),Qa=fb.next();!Qa.done;Qa=fb.next())Qa.value.value.DomainBlocked||++sb;return this.cYb=2>=sb};a.prototype.launchDisambiguationPaneForSearch=
function(){this.Mm&&this.Mm.launchDisambiguationPaneForSearch()};a.prototype.Yc=function(sb,fb,Qa){if("PopulateConvertToLinkedEntityMenu"!==fb)return!1;this.m7c=Qa.MenuId;if(!this.Gq||3===this.Gq)return this.yGi(),!0;if(this.hva)if(this.uaa){if(this.sL)return this.eL=this.eL||this.LLa.Irh(this.uaa,Qa.MenuId),Qa.MenuItems=this.eL,this.ogd=!0;E.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection")}else E.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info");
this.eL=this.eL||this.LLa.Hrh(this.Eva,Qa.MenuId);Qa.MenuItems=this.eL;return!0};a.prototype.yGi=function(){var sb=this;-1===this.G9b&&(this.hNa(),this.G9b=window.setInterval(function(){sb.hNa()},2E3))};a.prototype.hNa=function(){if(this.$.fa.lc&&2!==this.Gq)if(this.TIa--,E.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Gq=1,this.hva){var sb=this.$.ra.ua,fb=Object(G.a)(this,this.Anf,"onGetLinkedEntityServiceDomainsSuccess"),
Qa=Object(G.a)(this,this.znf,"onGetLinkedEntityServiceDomainsFailure"),cb=sb.Na(1,null);ma.i(sb,"GetLinkedEntityMetadata",cb,fb,Qa,null,null,4)}else sb=this.$.ra.ua,fb=Object(G.a)(this,this.Anf,"onGetLinkedEntityServiceDomainsSuccess"),Qa=Object(G.a)(this,this.znf,"onGetLinkedEntityServiceDomainsFailure"),cb=sb.Na(1,null),ma.i(sb,"GetLinkedEntityServiceDomains",cb,fb,Qa,null,null,4)};a.prototype.ahd=function(){return this.$.isEditMode&&2!==this.Gq&&(0<=this.TIa||!this.QMa)};a.prototype.ZQd=function(sb){H.AFrameworkApplication.Fg?
E.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):U.a(this.$)?(this.SQd(),sb&&this.$.zf()):E.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")};a.prototype.TDd=function(sb){this.otb=this.qzb=0;this.TIa=8;this.QMa=!1;this.Gq=this.G9b=0;this.Eva=this.uaa=null;this.kZb();for(var fb=0;fb<this.ILa;++fb)this.B9[fb]=null;sb&&Wa.a.Tvb()&&this.nvb()&&this.ZQd(!0)};a.prototype.jd=function(sb,fb){E.ULS.sendTraceTag(537166867,
0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");fb.SP?E.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.Ope():this.TDd(!0),oc.EwaSettings.ka(695)&&this.qQd&&this.LCe())};a.prototype.kZb=function(){this.eL=null};a.prototype.nvb=function(){var sb=da.a.hDb,fb=U.a(this.$);return!!fb&&fb.tn.eo===sb};a.prototype.Anf=function(sb){var fb=this;this.kZb();if(sb.Result){if(this.hva){sb=sb.Result;var Qa=
sb.DomainDataArray;this.uaa=sb.Ribbon;if(this.kva&&this.uaa){var cb={};cb.Name=eb.a.instance.da(1727);cb.DomainIds=this.AJ;Array.insert(this.uaa.Categories,a.X4a,cb)}0<sb.MaximumCellsToConvert&&(this.g4d=sb.MaximumCellsToConvert)}else Qa=sb.Result;this.Gq=2;sb=!1;if(Qa){E.ULS.sendTraceTag(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",Qa.length);this.Eva||(this.Eva=[]);cb=eb.a.instance.da(1724);var Ab=eb.a.instance.da(1726);Qa=Ol(Qa);for(var gc=Qa.next();!gc.done;gc=
Qa.next())if(gc=gc.value,gc.DomainId)if(this.Eva.push(gc),gc.DomainBlocked){var Lc=!!gc.DomainId.StringId;E.ULS.sendTraceTag(537166861,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",Lc?gc.DomainId.Id.toString():gc.Name,Lc)}else this.sL.ia(a.DZa(gc.DomainId),gc),gc.Name===cb||268435456===gc.DomainId.Id?this.D_a=gc.DomainId.Id.toString():gc.Name===Ab||536870912===gc.DomainId.Id?this.k0a=gc.DomainId.Id.toString():268435712===gc.DomainId.Id&&gc.ShowInRibbon&&(this.dUc=
!0),sb=!0;else E.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}sb||(this.Eva=null);this.k2f();this.ujd&&this.QEd.rGh();this.$Zf||(this.Nsj(),this.$Zf=!0)}else this.Eva=null,this.Gq=3,this.TIa>(this.pvb?-1:0)&&(sb=0,this.pvb&&(sb=100*(8-this.TIa)),window.setTimeout(function(){fb.hNa()},sb)),E.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.kmc();this.Jve();this.dUc&&this.i6e&&Ua.b(Object(G.a)(this,this.Aaf,
"launchLinkedEntityGalleryCallout"),this.$.la,500);this.j3a&&!this.W3a&&this.CPd(!0)};a.prototype.znf=function(sb){sb=Aa.a.xg(sb.data);E.ULS.sendTraceTag(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",Yb.a.Uc(sb));this.Eva=null;this.Gq=3;this.pvb&&(this.QMa=!0);this.kmc()};a.prototype.k2f=function(){if(this.uaa){var sb=0;if(this.kva){var fb=-1,Qa=-1,cb=0,Ab=0,gc=0,Lc=0,Nc=[null,null,null,null,null],yd=Ol(this.uaa.Categories);for(vb=yd.next();!vb.done;vb=yd.next()){var Od=!1;
vb=Ol(vb.value.DomainIds);for(Lb=vb.next();!Lb.done;Lb=vb.next()){Lb=Lb.value;var sa=this.fP(Lb);sa&&!sa.DomainBlocked&&sa.ShowInRibbon&&(sb<this.ILa?(this.B9[sb]=Lb,Ab===a.X4a&&(-1===fb&&(fb=sb),Qa=sb,Lc=Qa-fb+1),++sb):sb===this.ILa&&cb<Lc&&Ab!==a.X4a&&(Nc[cb]=Lb,++cb),Od=!0)}Od&&++gc;++Ab}if(-1<fb&&gc<=a.abf){for(;Qa>=fb;--Qa)Array.removeAt(this.B9,Qa);for(fb=0;fb<Lc;++fb)Array.insert(this.B9,sb+fb,Nc[fb])}}else{Lc=Ol(this.uaa.Categories);for(var vb=Lc.next();!vb.done;vb=Lc.next()){Nc=Ol(vb.value.DomainIds);
for(var Lb=Nc.next();!Lb.done&&!(fb=Lb.value,(Qa=this.fP(fb))&&!Qa.DomainBlocked&&Qa.ShowInRibbon&&(this.B9[sb]=fb,++sb,sb>=this.ILa));Lb=Nc.next());if(sb>=this.ILa)break}}for(;sb<this.ILa;)this.B9[sb]=null,++sb}};a.prototype.onContentReady=function(){this.n0f()&&this.gridView.Cs(Object(G.a)(this,this.onContentReady,"onContentReady"))};a.prototype.n0f=function(){var sb=Object(N.a)(827,P.g(this.$).Ca),fb=this.gridView.ga.Qe;return sb&&sb.Dcd&&1===fb&&this.gridView.ga.wa.activeCell?(sb=Jb.GetServiceTaskFactory.Va(this.$.ea,
12,477,1,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),this.H8=new Z.a(this.$,this.svgIconProvider,sb.result,this),!0):!1};a.prototype.m$h=function(){this.Mm&&this.Mm.qmd(!0)};a.prototype.launchLinkedEntityDataTypeSelectorPane=function(sb){if(this.Mm)if(sb=this.C1c(sb))if(sb.DomainId.StringId)E.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var fb=Tb.r(this.gridView.ga.wa.selectedRanges,this.$);
this.Mm.launchLinkedEntityDataTypeSelectorPane(fb,sb.DomainId.Id)}else E.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")};a.prototype.wPg=function(){return this.JXc(this.D_a)};a.prototype.vPg=function(){return this.JXc(this.k0a)};a.prototype.JXc=function(sb){var fb=this.hTh(sb),Qa=S.a.Xf(this.$wb(sb));sb=S.a.Xf(this.KOd(sb));return a.lrh(fb,tc.a.ve(11),Qa,sb)};a.prototype.KOd=function(sb){try{return this.B1c(parseInt(sb)).Description}catch(fb){}return eb.a.instance.da(1721)};
a.prototype.$wb=function(sb){try{return this.B1c(parseInt(sb)).Name}catch(fb){}return eb.a.instance.da(1707)};a.prototype.SIf=function(sb){try{return this.fP(sb).Name}catch(fb){}return this.$wb(sb.Id.toString())};a.prototype.HBg=function(sb){try{return this.fP(sb).BlankCellResourceId}catch(fb){}return null};a.prototype.PPh=function(sb){try{return this.fP(sb).HasBlankCellWalkthrough}catch(fb){}return!1};a.prototype.NYe=function(sb){try{var fb=a.DZa(sb);if(this.sL.qb(fb))return this.sL.oa(fb).HasCuratedData}catch(Qa){}return!1};
a.prototype.mnj=function(sb){try{return this.fP(sb).SupportsStarterData}catch(fb){}return!1};a.prototype.f7e=function(sb){return 268435968===sb};a.prototype.o8c=function(){return 2===U.a(this.$).IQ?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"};a.prototype.c0b=function(){return new Ra.a(-847286761,Na.a.Tb,this.$.dd,0,da.a.AQ)};a.prototype.Jve=function(){if(this.nvb()&&!this.ahd()&&!this.S4e&&oc.EwaSettings.ka(461)&&this.NYe({Id:268435968,StringId:null}))if(E.ULS.sendTraceTag(537166819,
0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),ic.a.Df.OG){var sb=this.o8c();if(sb){var fb=this.c0b();if(fb){var Qa={};Qa=(Qa.InputMethod=Na.a.Tb,Qa);Qa.CalloutName=6;Qa.Target=sb;Qa.ShouldCanvasTakeFocus=!0;this.$.Ka.Ub(fb,Qa);this.S4e=!0}else E.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else E.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else E.ULS.sendTraceTag(537166816,
0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")};a.prototype.ESh=function(sb){sb=this.C1c(sb);return sb?this.LLa.hAg(sb.SubdomainFontLocator):(E.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)};a.prototype.evb=function(sb){return this.H8?this.H8.gAg(sb):!1};a.prototype.nuh=function(){return this.H8?
this.H8.$uh():""};a.prototype.j_h=function(){return this.H8?this.H8.Cxb:!1};a.prototype.Myh=function(sb,fb){var Qa=this.S0e(sb);if(0>Qa)E.ULS.sendTraceTag(537166813,0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",sb);else if(sb=(sb=this.SAe(sb))?this.fP(sb):null)fb[Q.a.GalleryButtonProps]=this.LLa.fsh(Qa,sb),fb[Q.a.Alt]=this.LLa.X8c(sb)};a.prototype.VHf=function(){this.k2f();Wa.a.Tvb()&&this.nvb()&&this.ZQd(!0);this.kZb()};a.prototype.hTh=function(sb){return sb===this.D_a?V.a.DHe:
sb===this.k0a?V.a.BHe:V.a.AHe};a.prototype.vIe=function(sb){try{return this.fP(sb).ExampleEntities}catch(fb){}return eb.a.instance.da(1729)};a.prototype.kmc=function(){(0>this.TIa||this.QMa)&&E.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Gq||0>this.TIa||this.QMa)&&window.clearInterval(this.G9b);Wa.a.Tvb()&&!this.ahd()?this.ZQd(this.nvb()):this.m7c&&this.$.frame.Yv(this.m7c)};a.prototype.Zb=function(sb){return this.$.Jb+sb};a.prototype.SQd=
function(){if(this.hva){var sb=!0,fb=Array(this.ILa),Qa=U.a(this.$)?U.a(this.$).tn:null;if(Qa){for(var cb=0;cb<fb.length;++cb)this.odj(cb)?fb[cb]=!0:sb=fb[cb]=!1;Qa.VHd(["ConvertToLinkedEntityGallery"],sb);if(!sb)for(sb=0;sb<fb.length;++sb)fb[sb]&&Qa.VHd([this.Lyh(sb)],!0)}else E.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}else fb=this.sdj(),Qa=this.rdj(),sb=fb&&Qa,this.vrb||this.pIb||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToLinkedEntityGallery",
sb?!0:!1)),sb?this.vrb=this.pIb=!0:(fb?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToStockLinkedEntity",!0)),this.pIb=!0):Qa&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToGeographyLinkedEntity",!0)),this.vrb=!0),this.qdj()&&Qb.HelperMethods.hdd("ConvertToLinkedEntityGallery-previewExpandButton"))};a.prototype.fP=function(sb){var fb=a.DZa(sb);if(this.sL.qb(fb))return this.sL.oa(fb);E.ULS.sendTraceTag(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",
sb.Id,!!sb.StringId);return null};a.prototype.Lyh=function(sb){return"ConvertToLinkedEntityPreview"+sb.toString()};a.prototype.TQd=function(){var sb=this;L.a.get_instance().Om(10,function(){sb.Jve();sb.dUc&&sb.i6e&&Ua.b(Object(G.a)(sb,sb.Aaf,"launchLinkedEntityGalleryCallout"),sb.$.la,500)});Wa.a.Tvb()||L.a.get_instance().Om(10,function(){sb.SQd()})};a.prototype.v9b=function(sb,fb){switch(sb){case "QueryLinkedEntityGalleryButtons":if(!fb[Q.a.InnerHTML]){Wa.a.Tvb()||this.SQd();sb=fb[Na.a.Md].toString();
var Qa=zb.a.equals(sb,eb.a.instance.da(1724),!0)||zb.a.equals(sb,eb.a.instance.da(1725),!0),cb=zb.a.equals(sb,eb.a.instance.da(1726),!0);oc.EwaSettings.ka(464)?Qa||cb||this.Myh(sb,fb):!this.pIb&&Qa?(this.pIb=!0,fb[Q.a.InnerHTML]=this.wPg()):!this.vrb&&cb&&(this.vrb=!0,fb[Q.a.InnerHTML]=this.vPg())}break;case "QueryLinkedEntityMenuGalleryButtons":fb[Q.a.InnerHTML]||(fb[Q.a.InnerHTML]=this.JXc(fb[Na.a.Md]))}return fb};a.prototype.hhe=function(){oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",
!1)&&this.gcc&&null!=this.iaa&&!this.iaa&&(E.ULS.sendTraceTag(537166806,0,50,"AfterWolframAddinInstalled: User is entitled to the Wolfram add-in (by licensing) and has just installed it. Wolfram domains enabled and handshake refresh being done."),this.iaa=!0,this.lfg=!1,this.TDd(!1),this.hmc(),this.$.Es())};a.prototype.Xvg=function(){oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",!1)&&this.gcc&&(this.iaa=!1,this.TDd(!1),this.hmc(),this.$.Es())};a.prototype.j5g=function(sb){var fb;
if(oc.EwaSettings.ka(464)&&(fb=this.SAe(sb)))return fb;if(fb=this.C1c(sb))return fb.DomainId;if(oc.EwaSettings.ka(464))return E.ULS.sendTraceTag(537166805,0,10,"Could not convert key into domain: {0}",sb),null;fb=this.DCh(sb);return fb?fb={Id:fb,StringId:null}:(E.ULS.sendTraceTag(537166804,0,10,"Could not convert key into domain using fallback logic, Key: {0}",sb),null)};a.prototype.DCh=function(sb){var fb=parseInt(sb);if(0<fb)return fb;E.ULS.sendTraceTag(537166803,0,50,"Checking for specific domains, Key: {0}",
sb);var Qa=eb.a.instance.da(1725),cb=eb.a.instance.da(1726);return sb===this.k0a||sb===this.D_a?parseInt(sb):this.s6e(sb,Qa,"Stock")?parseInt(this.D_a):this.s6e(sb,cb,"Geography")?parseInt(this.k0a):fb};a.prototype.B1c=function(sb){var fb={};fb.Id=sb;return this.fP(fb)};a.prototype.C1c=function(sb){return this.sL.qb(sb)?this.sL.oa(sb):null};a.prototype.S0e=function(sb){if(!sb.startsWith(a.U1c))return-1;var fb=parseInt(sb.substr(a.U1c.length));return isNaN(fb)?(E.ULS.sendTraceTag(537166802,0,10,"Unexpected index in preview gallery button key: {0}",
sb),-1):fb};a.prototype.SAe=function(sb){sb=this.S0e(sb);return 0>sb?null:this.B9[sb]};a.prototype.fk=function(){this.kZb()};a.prototype.J2e=function(sb,fb,Qa){if(this.Svb&&this.sL&&this.sL.count){E.ULS.sendTraceTag(537166801,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",sb);var cb=this.$.ra.ua.Wb();this.$.fa.lc&&(sb=this.$.ra.ua,fb=uc.b(Object(G.a)(this,this.Fvi,"onLinkedEntityTryAutoRefreshSuccessCore"),fb),cb=sb.Na(1,void 0===cb?null:cb),ma.i(sb,"LinkedEntityTryAutoRefresh",
cb,fb,Qa,null,null,0))}};a.prototype.Fvi=function(sb){if(Sa.a(sb)){var fb=Jb.GetServiceTaskFactory.Va(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");$a.TaskExtensions.Aa(fb,function(){var cb=null;sb&&sb.Errors&&(cb=sb.Errors[0]);fb.result.MTf(cb,null)},this.$.la,3);E.ULS.sendTraceTag(537166800,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",Yb.a.Uc(sb.Errors));var Qa=
Yb.a.yE(sb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.fa.Jo(Qa)}};a.prototype.Nsj=function(){this.J2e("Auto-refresh on load",null,null)};a.prototype.Qsj=function(){this.Svb&&this.sL&&this.sL.count&&(this.fxa?E.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.fa.qn.HasAutoRefreshableLinkedEntityDomainsEver?
(E.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.fxa=ua.a.instance.create(Object(G.a)(this,this.STc,"callPeriodicAutoRefreshCheck"),this.fXb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):E.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))};
a.prototype.STc=function(){E.ULS.sendTraceTag(537166796,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",this.fXb);this.J2e("Periodic auto-refresh check",Object(G.a)(this,this.Poi,"onCallPeriodicAutoRefreshCheckSuccess"),Object(G.a)(this,this.Ooi,"onCallPeriodicAutoRefreshCheckFailure"))};a.prototype.Poi=function(sb){Sa.a(sb)?(E.ULS.sendTraceTag(537166795,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",
Yb.a.Uc(sb.Errors)),++this.YRc):this.YRc=0;A.a.Fa(this.fxa);this.YRc>=this.uAg?(E.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.fxa=null):(E.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.fxa=ua.a.instance.create(Object(G.a)(this,this.STc,"callPeriodicAutoRefreshCheck"),
this.fXb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};a.prototype.Ooi=function(sb){sb=Aa.a.xg(sb.data);aa.a.ma(sb)?E.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):E.ULS.sendTraceTag(537166792,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",Yb.a.Uc(sb));A.a.Fa(this.fxa);this.fxa=ua.a.instance.create(Object(G.a)(this,this.STc,"callPeriodicAutoRefreshCheck"),
this.fXb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};a.prototype.s6e=function(sb,fb,Qa){return zb.a.contains(sb,fb,!0)||zb.a.contains(sb,Qa,!0)};a.prototype.Mwi=function(sb){sb=!!sb.Result&&sb.Result;E.ULS.sendTraceTag(537166790,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",sb.toString());sb?(E.ULS.sendTraceTag(537166789,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",Ca.a.Qa.oe.m-this.I1a,this.qzb),
this.hNa()):this.jIb()};a.prototype.Lwi=function(){E.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.jIb()};a.prototype.jIb=function(){if((!this.aKa||null!=this.gjd&&null!=this.hjd)&&this.$.fa.lc&&null!=this.xKa&&null!=this.iaa&&null!=this.odc)if(++this.qzb,12>=this.qzb){1===this.qzb&&(this.I1a=Ca.a.Qa.oe.m,E.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var sb=this.$.ra.ua.Wb();ma.N(this.$.ra.ua,this.Oaf,this.Paf(),Object(G.a)(this,
this.Mwi,"onNotifyFeatureLicensingStatusSuccess"),Object(G.a)(this,this.Lwi,"onNotifyFeatureLicensingStatusFailed"),null,sb)}else E.ULS.sendTraceTag(537166751,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",Ca.a.Qa.oe.m-this.I1a),this.QMa=!0,this.kmc()};a.prototype.Ope=function(){if(this.$.isEditMode)if(null!=this.xKa)this.jIb();else{var sb=Ca.a.Qa.oe.m,fb=Array(6),Qa=this;fa.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(cb){cb.isFeatureEnabled("ExcelPowerBiPro",
!1).then(function(Ab){E.ULS.sendTraceTag(537166747,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",Ca.a.Qa.oe.m-sb);E.ULS.sendTraceTag(537166746,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",Ab);return Qa.xKa=Ab}).then(function(){oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",!1)&&(fb[0]=cb.isFeatureEnabled("ExcelWolframAddin",!1).then(function(Ab){E.ULS.sendTraceTag(537166745,
0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAddin",Ca.a.Qa.oe.m-sb);E.ULS.sendTraceTag(537166744,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAddin",Ab);return Qa.gcc=Ab}))}).then(function(){fb[1]=cb.isFeatureEnabled("ExcelWolframAlpha",!1).then(function(Ab){E.ULS.sendTraceTag(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",Ca.a.Qa.oe.m-sb);
E.ULS.sendTraceTag(537166743,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",Ab);Qa.iaa=Ab;var gc=Qa.gcc||!1;!Qa.iaa&&gc&&oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",!1)&&Qa.GQh()&&(E.ULS.sendTraceTag(537166742,0,50,"CheckE5LicensingAndStartDelayedHandshake: User is entitled to the Wolfram add-in (has it installed), and is eligible to use it to get Wolfram domains (by licensing). Wolfram domains enabled."),Ab=Qa.iaa=
!0);return Ab})}).then(function(){fb[2]=cb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(function(Ab){E.ULS.sendTraceTag(537166741,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelDisableStockGeographyDataTypes",Ca.a.Qa.oe.m-sb);E.ULS.sendTraceTag(537166740,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelDisableStockGeographyDataTypes",Ab);var gc,Lc=[(gc=new qb.a,gc.name="IsRestrictedByLicense",gc.bool=
Ab,gc)];Ia.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Lc);Qa.mkd=Ab&&oc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Ab})}).then(function(){fb[3]=cb.isFeatureEnabled("StockHistory",!1).then(function(Ab){E.ULS.sendTraceTag(537166739,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",Ca.a.Qa.oe.m-sb);E.ULS.sendTraceTag(537166738,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]",
"StockHistory",Ab);Qa.odc=Ab;Qa.aKa||Qa.jIb();return Ab})}).then(function(){Qa.aKa&&(fb[4]=cb.isFeatureEnabled("ExcelPowerBiFree",!1).then(function(Ab){E.ULS.sendTraceTag(537166736,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiFree",Ca.a.Qa.oe.m-sb);E.ULS.sendTraceTag(537166735,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiFree",Ab);return Qa.gjd=Ab}))}).then(function(){Qa.aKa&&(fb[5]=cb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",
!1).then(function(Ab){E.ULS.sendTraceTag(537166734,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPremiumPerUser",Ca.a.Qa.oe.m-sb);E.ULS.sendTraceTag(537166733,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPremiumPerUser",Ab);return Qa.hjd=Ab}))}).then(function(){Qa.aKa&&Promise.all(fb).then(function(){Qa.jIb()})})})}};a.prototype.Vxi=function(sb){sb=!!sb.Result&&sb.Result;E.ULS.sendTraceTag(537166731,0,
50,"OnRefreshHandshakeSuccess- operationSucceeded? = {0}",sb.toString());sb?(E.ULS.sendTraceTag(537166730,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = {0} ms, retry count = {1}",Ca.a.Qa.oe.m-this.I1a,this.otb),this.hNa()):this.hmc()};a.prototype.Uxi=function(){E.ULS.sendTraceTag(570769947,0,15,"OnRefreshHandshakeFailed");this.hmc()};a.prototype.hmc=function(){++this.otb;if(12>=this.otb){1===this.otb&&(this.I1a=Ca.a.Qa.oe.m,E.ULS.sendTraceTag(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh."));
var sb=this.$.ra.ua,fb=this.Oaf,Qa=this.Paf(),cb=Object(G.a)(this,this.Vxi,"onRefreshHandshakeSuccess"),Ab=Object(G.a)(this,this.Uxi,"onRefreshHandshakeFailed"),gc=sb.Na(1,null);gc.featureNames=fb;gc.isEnabledValues=Qa;ma.i(sb,"RefreshLinkedEntityWebServiceHandshake",gc,cb,Ab,null,null,4)}else E.ULS.sendTraceTag(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration {0} ms",Ca.a.Qa.oe.m-this.I1a),this.QMa=!0,this.kmc()};a.prototype.Paf=function(){return this.aKa?
[this.xKa,this.iaa,this.odc,this.gjd,this.hjd,this.mkd]:[this.xKa,this.iaa,this.odc,this.mkd]};a.prototype.NBd=function(){this.businessBar&&this.businessBar.bKa(56)&&this.businessBar.removeEntry(56)};a.prototype.hOh=function(sb){if(this.Qmd!==sb&&this.businessBar)if(this.Qmd=sb){sb=this.$.ra.ua;var fb=Object(G.a)(this,this.Ssi,"onGetErrorMessageForLinkedDataTypeRefreshSuccess"),Qa=sb.Na(1,null);ma.i(sb,"GetErrorMessageForLinkedDataTypeRefresh",Qa,fb,null,null,null,4)}else this.NBd()};a.prototype.Ssi=
function(sb){sb.Result?(sb=sb.Result,zb.a.ma(sb)?E.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):(this.NBd(),this.businessBar.MTf(null,sb))):E.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};a.prototype.GQh=function(){this.sg||E.ULS.sendTraceTag(537166724,0,10,"ConvertToLinkedEntityManager.HasWolframAddinEntitlement: IWebExtensionService still null after waiting for initialization tasks.");
var sb=new Hb.a(W.a.instance);return(this.sg?this.sg.sh.isAddinActivated("WA200002680")||this.sg.sh.isAddinActivated("a048b5e5-dc67-4812-b114-0969772a09ec"):!1)||sb.R2h()||sb.Q2h()};a.lrh=function(sb,fb,Qa,cb){sb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',sb,fb,cb);Qa=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Qa);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',
sb,Qa)};a.DZa=function(sb){return sb.StringId?sb.Id.toString()+"."+sb.StringId:sb.Id.toString()};Ll.Object.defineProperties(a.prototype,{zOi:{configurable:!0,enumerable:!0,get:function(){return 5}},qDb:{configurable:!0,enumerable:!0,get:function(){return this.AJ},set:function(sb){this.AJ=sb}},ILa:{configurable:!0,enumerable:!0,get:function(){return this.B9.length}},phi:{configurable:!0,enumerable:!0,get:function(){return this.g4d}},Oaf:{configurable:!0,enumerable:!0,get:function(){return this.aKa?
"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" "):["ExcelPowerBiPro","ExcelWolframAlpha","StockHistory","ExcelDisableStockGeographyDataTypes"]}}});a.IBe="ConvertToLinkedEntityPreview";a.U1c="PreviewGalleryButtonIndex.";a.X4a=0;a.abf=2;Object(C.a)(a,"ConvertToLinkedEntityManager",Y.a,[828,829,6,830])}}]);

//# sourceMappingURL=EwaDS.le.js.map