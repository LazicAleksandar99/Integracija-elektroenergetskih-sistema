(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[40],{1386:function(C,F,b){function a(ta){var Ka=ea.call(this)||this;Ka.$=ta;Ka.Yb();return Ka}function e(ta){var Ka=ab.call(this,ta)||this;Ka.txb=null;Ka.xva=null;Ka.zoomEventManager=null;Ka.zxb=-1;Ka.V4e=!1;t.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");Ka.Gcb=new d(ta);Ka.FFi()&&(t.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),Ka.szg());Ka.zRi();return Ka}function d(ta){var Ka=
Ya.call(this)||this;Ka.statusBarManager=null;Ka.uMe=!1;Ka.$=ta;Ka.$.ea.$a(29,function(mb){Ka.statusBarManager=mb;mb.sI(Ka)});return Ka}function l(){return pb.call(this)||this}function n(ta){this.C2a=this.pac=0;this.NYb=null;this.X4e=!1;this.$=ta;this.X4e=ta.Mdc}function r(ta){return H.call(this,ta)||this}function h(ta){this.$=ta}b.r(F);var v=b(12);C=b(0);var w=b(800),t=b(15),B=b(942),z=b(10),x=b(79),y=b(173),J=b(366),E=b(34),A=b(51);h.prototype.Wc=function(){return!1};h.prototype.executeCommand=function(ta,
Ka,mb){var Ha=!1;ta=Ka.command;var Ga=E.a(this.$);11!==Ka.Ze&&7!==Ka.Ze&&6!==Ka.Ze&&2!==Ka.Ze&&14!==Ka.Ze&&15!==Ka.Ze&&16!==Ka.Ze&&t.ULS.sendTraceTag(537149787,0,15,"ZoomCommandHandler.ExecuteCommand - unsupported zoom origin {0}",Ka.Ze);var Fa=6===Ka.Ze;switch(Ka.command){case -1365094462:case -1441674458:Ga.Lxc(Math.floor(10*Ga.zoom)/10+.1,Fa);Ha=!0;break;case 1056010365:case 1664364901:Ga.Lxc(Math.ceil(10*Ga.zoom)/10-.1,Fa);Ha=!0;break;case 346087880:Ga.Lxc(z.a.Haa,Fa);Ha=!0;break;case -1918142559:case 1517993347:x.a.Md in
mb?(mb=parseFloat(mb[x.a.Md]),mb!==Ga.zoom&&Ga.Kxc(mb,1517993347===Ka.command),Ha=!0):t.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:Ka=parseFloat(mb[B.a.Value]);isNaN(Ka)||Ga.Kxc(Ka/100,!0);Ha=!0;break;case 1409187195:Ga.zoomFitToScreen();Ha=!0;break;case -1836771825:Ga.zoomFitToScreenUndo(),Ha=!0}return Ha?A.Task.Ra(!0):y.a(ta)};h.prototype.Ec=function(ta,Ka){switch(Ka.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return E.a(this.$).sW();
case -1365094462:case 1056010365:case -2096586688:return J.a(this.$);default:return!1}};h.prototype.Yc=function(){return!1};Object(C.a)(h,"ZoomCommandHandler",null,[160]);var H=w.a;Em(r,H);r.prototype.Gd=function(){this.Ad([new h(this.$)])};r.ja=function(ta){w.a.Yd(370,new r(ta))};Object(C.a)(r,"ZoomCommandHandlerFactory",w.a,[]);F=b(212);var S=b(86),Q=b(23),L=b(88),aa=b(37),fa=b(564),W=b(45),G=b(4),N=b(162),Y=b(60),V=b(285),da=b(125),U=b(46),Z=b(44),ca=b(11),ra=b(9),La=b(102),na=b(105),ma=b(20),
xa=b(300),Pa=b(127);n.prototype.o2h=function(){return ma.g(this.$).isEditing?(t.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.zb.xJ?(t.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0};n.prototype.Asi=function(ta){this.NYb=new Sys.UI.Point(Math.round(ta.cta.center.x),Math.round(ta.cta.center.y));this.pac=E.a(this.$).zoom;this.C2a=ta.cta.scale;
var Ka={};Ka=(Ka.InitialZoom=this.pac,Ka.Location="canvas",Ka.InputMethod=ta.yb,Ka);Pa.b(this.$).ee(da.a.EFi,Ka);t.ULS.sendTraceTag(537149793,0,50,"PinchToZoomAdapter.OnGestureStart starting gesture. center ({0},{1}), initial zoom {2}, initial scale {3}",this.NYb.x,this.NYb.y,this.pac,this.C2a);this.v5a(ta,"onGestureStart");return!0};n.prototype.zsi=function(ta){if(!this.C2a)return t.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.v5a(ta,
"OnGestureEvent"),!0;if(!isFinite(this.C2a))return t.ULS.sendTraceTag(537149791,0,15,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale={0}",this.C2a),this.v5a(ta,"OnGestureEvent"),!0;var Ka=ta.cta.scale/this.C2a*this.pac;E.a(this.$).u6f(Ka,this.NYb);t.ULS.sendTraceTag(537149790,0,50,"PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom {0}. Current scale {1}",Ka,ta.cta.scale);this.v5a(ta,"OnGestureEvent");return!0};n.prototype.ysi=function(ta){E.a(this.$).v6f();
t.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.v5a(ta,"OnGestureEnd")};n.prototype.xsi=function(ta){t.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.v5a(ta,"OnGestureCancel")};n.prototype.v5a=function(ta,Ka){var mb,Ha,Ga;this.X4e&&(t.ULS.sendTraceTag(536990857,0,50,"PinchToZoomAdapter.markGestureEventAsHandled - Invoked from {0},        eventArgs non-null: {1}, gestureData non-null: {2},        srcEvent non-null: {3}",
Ka,isNullOrUndefined(ta),isNullOrUndefined(null===ta||void 0===ta?void 0:ta.cta),isNullOrUndefined(null===(mb=null===ta||void 0===ta?void 0:ta.cta)||void 0===mb?void 0:mb.srcEvent)),null===(Ga=null===(Ha=null===ta||void 0===ta?void 0:ta.cta)||void 0===Ha?void 0:Ha.srcEvent)||void 0===Ga?void 0:Ga.preventDefault())};Object(C.a)(n,"PinchToZoomAdapter",null,[313]);var ib=b(36),pb=ib.a;Em(l,pb);l.prototype.dvg=function(ta){this.addHandler("ZCIEK",ta)};l.prototype.oWi=function(ta){this.removeHandler("ZCIEK",
ta)};l.prototype.cvg=function(ta){this.addHandler("ZCUIK",ta)};l.prototype.nWi=function(ta){this.removeHandler("ZCUIK",ta)};l.prototype.wMi=function(){this.raiseEvent("ZCIEK")};l.prototype.vMi=function(){this.raiseEvent("ZCUIK")};l.prototype.xMi=function(){this.raiseEvent("ZCEK")};Object(C.a)(l,"ZoomEventManager",ib.a,[312]);var xb=b(7),Ya=ib.a;Em(d,Ya);d.prototype.Qp=function(ta){this.addHandler("Zoom",ta)};d.prototype.jq=function(ta){this.removeHandler("Zoom",ta)};d.prototype.jx=function(){this.Vm("QueryZoomStatus")&&
this.raiseEvent("Zoom")};d.prototype.mr=function(ta,Ka){return"QueryZoomStatus"!==ta?!1:this.NOh(Ka)};d.prototype.Vm=function(){return E.a(this.$).sW()};d.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.xE(this),this.statusBarManager=null);this.$=null;Ya.prototype.dispose.call(this)};d.prototype.fWe=function(ta){ta=this.rLh(ta);if(!ta)return null;ta=ta.getElementsByClassName("cui-ctl-mediumlabel");return 1!==ta.length?(t.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),
null):ta[0]};d.prototype.NOh=function(ta){if(!this.$)return!1;var Ka=E.a(this.$).fLb,mb=this.fWe("HandleQueryZoomStatusCommand");mb?xb.a.equals(ta.LabelText.toString(),Ka,!1)||(mb.innerText="",this.IOf(ta,Ka)):this.IOf(ta,Ka);return!0};d.prototype.IOf=function(ta,Ka){ta.LabelText=Ka};d.prototype.rLh=function(ta){var Ka=ca.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!Ka)return Ka=(Ka=this.$.fa.ic)?Ka.inEmbedView:!1,Q.a.tr||Ka||t.ULS.sendTraceTag(537149763,
0,15,"ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from {0}",ta),null;this.uMe||(this.uMe=!0,t.ULS.sendTraceTag(537149762,0,50,"ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from {0}",ta));return Ka};Object(C.a)(d,"ZoomStatusBarManager",ib.a,[6,156,157]);var ab=fa.a;Em(e,ab);e.prototype.dispose=function(){this.Gcb&&(S.a.Fa(this.Gcb),this.Gcb=null);this.zoomEventManager&&(this.$.ea.cP(419),this.zoomEventManager=null);this.V4e&&this.f2g();ab.prototype.dispose.call(this)};
e.prototype.sW=function(){return!0};e.prototype.u6f=function(ta,Ka){ta=this.Msa(ta);if(ma.g(this.$).rtl){var mb=Math.round(ca.DOMElementExtensions.getBounds(this.$.Re).width*E.a(this.$).zoom);this.txb=new Sys.UI.Point(mb-Ka.x,Ka.y)}else this.txb=Ka;this.Dya(ta,!1,"ZoomWithPinch")};e.prototype.Jxc=function(){return!0};e.prototype.Ixc=function(ta,Ka){var mb=Q.a.isMac?.07:.15;ta=this.zoom+(ta?mb:-mb);ta=this.Msa(ta);ma.g(this.$).rtl?(mb=Math.round(ca.DOMElementExtensions.getBounds(this.$.Re).width*E.a(this.$).zoom),
this.xva=new Sys.UI.Point(mb-Ka.x,Ka.y)):this.xva=Ka;Ka=this.zoom;this.Dya(ta,!0,"ZoomWithMouse");mb={};Ka=(mb.InitialZoom=Ka,mb.FinalZoom=ta,mb.Location="canvas",mb);Pa.b(this.$).ee(da.a.QDj,Ka)};e.prototype.v6f=function(){this.txb=null};e.prototype.Kxc=function(ta,Ka){this.Dya(this.Msa(ta),!1,Ka?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")};e.prototype.w6f=function(ta){isNaN(ta)?t.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):
this.Dya(this.Msa(ta),!1,"ZoomToLevelInExcelLive")};e.prototype.x6f=function(ta){this.Dya(this.Msa(ta),!1,"ZoomWithActionPen")};e.prototype.Lxc=function(ta,Ka){this.Dya(this.Msa(ta),!0,Ka?"ZoomWithShortcuts":"ZoomWithButtons")};e.prototype.gUe=function(ta,Ka){var mb=this.lPe(ma.g(this.$).rtl),Ha=this.eRe(mb,ma.g(this.$).rtl),Ga=Math.round((ca.DOMElementExtensions.getBounds(this.$.Re).width-Ha.x)*ta),Fa=Math.round((ca.DOMElementExtensions.getBounds(this.$.Re).height-Ha.y)*ta);return this.xva?(ta=this.w$c(this.xva,
ta,Ka,Ha,mb,"ZoomWithMouse"),this.xva=null,ta):this.txb?this.w$c(this.txb,ta,Ka,Ha,mb,"ZoomWithPinch"):ma.g(this.$).ga.Pa.R$?this.PDj(ta,Ka,Ha,mb,Ga,Fa,ma.g(this.$).rtl):this.RDj(ta,Ka,Ha,mb,Ga,Fa,ma.g(this.$).rtl)};e.prototype.qLf=function(ta,Ka,mb){ta?(t.ULS.sendTraceTag(537149782,0,50,"Zoom To: ({0} {1}) (new top-left) from zoom:{2} to zoom:{3}",ta.x,ta.y,Ka,mb),ta=new W.a(ta.x,ta.y),Ka=ma.g(this.$).view.visibleArea.width,mb=ma.g(this.$).view.visibleArea.height,ma.g(this.$).bhe(ta,Ka,mb,na.a.Gxg)):
t.ULS.sendTraceTag(537149781,0,50,"Zooming top-left: from zoom:{0} to zoom:{1}",Ka,mb)};e.prototype.zoomFitToScreen=function(){var ta=this.zoom,Ka=ma.g(this.$).rtl,mb=this.lPe(Ka),Ha=this.eRe(mb,Ka),Ga=Math.round((ca.DOMElementExtensions.getBounds(this.$.Re).width-Ha.x)*ta),Fa=Math.round((ca.DOMElementExtensions.getBounds(this.$.Re).height-Ha.y)*ta),eb=ma.g(this.$).ga.Pa.R$;(Ka=eb?this.GQe(this.CBb,Ga,Fa,!1):this.nUe(this.CBb,Ha,mb,Ga,Fa,Ka,!1))?(Ga=Math.min(Ga/(Ka.width+100),Fa/(Ka.height+100)),
Ga=this.Hnh(Ga),this.Dya(Ga,!0,"ZoomWithFitToScreen"),eb?ma.g(this.$).ga.Pa.NEa(ma.g(this.$).ga.Pa.kc,!1):(eb=U.v(ma.g(this.$).ga.wa.activeRange,this.$),ma.g(this.$).ki(eb,null,null,null,3,na.a.ODj)),this.zxb=ta,this.V4e||this.qzg()):t.ULS.sendTraceTag(537149780,0,15,"ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: {0}",eb)};e.prototype.zoomFitToScreenUndo=function(){this.Dya(this.zxb,!1,"ZoomWithFitToScreen")};e.prototype.dKd=function(){return-1!==this.zxb};e.prototype.qzg=
function(){var ta=ma.g(this.$);ta&&(ta.ga.HF(Object(aa.a)(this,this.$c,"onSelectionChanged")),ta.iD(Object(aa.a)(this,this.$c,"onSelectionChanged")))};e.prototype.f2g=function(){var ta=ma.g(this.$);ta&&(ta.ga.CE(Object(aa.a)(this,this.$c,"onSelectionChanged")),ta.AE(Object(aa.a)(this,this.$c,"onSelectionChanged")))};e.prototype.$c=function(){this.zxb=-1};e.prototype.Hnh=function(ta){ta=Math.min(ta,z.a.nhi);ta=Math.max(ta,z.a.qii);return Math.round(100*ta)/100};e.prototype.Dya=function(ta,Ka,mb){if(this.Gxc()){var Ha=
ma.g(this.$).view.visibleArea.toString();ta=this.Msa(ta);var Ga=Y.d(this.$.va.qa);Ga||(Ga=fa.a.Mhf);ma.g(this.$).vi.g6(5,xa.a.Fxc,mb);ma.g(this.$).vi.Kja(xa.a.Fxc,this.$.fa.vf);t.ULS.sendTraceTag(537149779,0,50,"ZoomManager.SetNewZoomLevel Setting zoom {0} to sheet {1} origin {2} prevZoom {3}",ta,Ga,mb,this.zoom);this.uaj(Ga,ta);this.zoomEventManager.xMi();this.hsj(mb);this.osj(Ka);this.zxb=-1;J.b(this.$,mb);t.ULS.sendTraceTag(537149778,0,50,"ZoomManager.SetNewZoomLevel OldGridVisibleArea: {0}, NewGridVisibleArea: {1}, IsShyRibbonActive: {2}",
Ha,ma.g(this.$).view.visibleArea.toString(),this.$.IKa)}};e.prototype.lPe=function(ta){return(ta=ra.HelperMethods.Uz(this.$.Re,this.$.domElement,ta))?ta:new Sys.UI.Point(0,0)};e.prototype.eRe=function(ta,Ka){Ka=ra.HelperMethods.Uz(ma.g(this.$).domElement,this.$.domElement,Ka);return Ka?(ta=new Sys.UI.Point(Math.round(Ka.x-ta.x),Math.round(Ka.y-ta.y)),ta):new Sys.UI.Point(0,0)};e.prototype.RDj=function(ta,Ka,mb,Ha,Ga,Fa,eb){return(eb=this.nUe(ta,mb,Ha,Ga,Fa,eb))?this.sTe(eb,ta,Ka,mb,Ha,Ga,Fa):null};
e.prototype.nUe=function(ta,Ka,mb,Ha,Ga,Fa,eb){eb=void 0===eb?!0:eb;var db=U.F(ma.g(this.$).ga.wa.selectedRanges);if(eb&&(db=db.Ef(U.F(ma.g(this.$).V8b())),!db))return t.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;var Na=ma.g(this.$).tc(db.topLeft);db=ma.g(this.$).tc(db.bottomRight);if(!Na||!db)return t.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),
null;ta=Na.cell.rJ===db.cell.rJ&&Na.cell.qJ===db.cell.qJ?this.Cvh(ta,db,Ka,mb,Ha,Fa):this.kKh(ta,Na,db,Ka,mb,Ha,Fa);return ta?eb?this.tLe(ta,Ha,Ga):ta:(t.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)};e.prototype.tLe=function(ta,Ka,mb){if(0>ta.x||ta.x>Ka)ta.x=0;if(0>ta.y||ta.y>mb)ta.y=0;ta.x+ta.width>Ka&&(ta.width=Ka-ta.x);ta.y+ta.height>mb&&(ta.height=mb-ta.y);return ta};e.prototype.kKh=function(ta,Ka,mb,Ha,Ga,Fa,eb){Ka=ma.g(this.$).getCellBounds(Ka.cell);
if(!Ka)return null;var db=ma.g(this.$).getCellBounds(mb.cell);if(!db)return null;var Na=Ga.x;eb&&(Na=0,Ka.x=Math.round(Fa/ta)-Ka.x-Math.round(Ka.width),db.x=Math.round(Fa/ta)-db.x-Math.round(db.width));ta=new Sys.UI.Bounds(Math.round((Ka.x-Ha.x)*ta)-Na,Math.round((Ka.y-Ha.y)*ta-Ga.y),Math.round((db.x+db.width-Ka.x)*ta),Math.round((db.y+db.height-Ka.y)*ta));t.ULS.sendTraceTag(537149774,0,50,"ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:{0}, b:{1}, r:{2}, l:{3}) in bounds ({4}, {5}, {6}, {7})",
mb.cell.getRange().top,mb.cell.getRange().bottom,mb.cell.getRange().right,mb.cell.getRange().left,ta.x,ta.y,ta.width,ta.height);return ta};e.prototype.Cvh=function(ta,Ka,mb,Ha,Ga,Fa){var eb=ma.g(this.$).getCellBounds(Ka.cell);if(!eb)return null;var db=Ha.x;Fa&&(db=0,eb.x=Math.round(Ga/ta)-eb.x-Math.round(eb.width));ta=new Sys.UI.Bounds(Math.round((eb.x-mb.x)*ta)-db,Math.round((eb.y-mb.y)*ta-Ha.y),Math.round(eb.width*ta),Math.round(eb.height*ta));t.ULS.sendTraceTag(537149773,0,50,"ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:{0}, l:{1}) in bounds ({2}, {3}, {4}, {5})",
Ka.cell.getRange().top,Ka.cell.getRange().left,ta.x,ta.y,ta.width,ta.height);return ta};e.prototype.PDj=function(ta,Ka,mb,Ha,Ga,Fa){var eb=this.GQe(ta,Ga,Fa);return eb?this.sTe(eb,ta,Ka,mb,Ha,Ga,Fa):null};e.prototype.sTe=function(ta,Ka,mb,Ha,Ga,Fa,eb){ta=new Sys.UI.Point(this.QTe(Fa,ta.x,ta.width),this.QTe(eb,ta.y,ta.height));return this.w$c(ta,Ka,mb,Ha,Ga)};e.prototype.QTe=function(ta,Ka,mb){return ta===mb?(t.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),
ta/2):ta*Ka/(ta-mb)};e.prototype.GQe=function(ta,Ka,mb,Ha){Ha=void 0===Ha?!0:Ha;var Ga=ma.g(this.$).ga.Pa.kc.domElement,Fa=ra.HelperMethods.Uz(Ga,ma.g(this.$).domElement,ma.g(this.$).rtl);if(!Fa)return t.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;Fa=new Sys.UI.Point(Math.round((Fa.x-ma.g(this.$).view.visibleArea.topLeft.x)*ta),Math.round((Fa.y-ma.g(this.$).view.visibleArea.topLeft.y)*ta));ta=new Sys.UI.Bounds(Fa.x,Fa.y,Math.round(Ga.offsetWidth*
ta),Math.round(Ga.offsetHeight*ta));return Ha?this.tLe(ta,Ka,mb):ta};e.prototype.jif=function(){this.Gcb.jx()};e.prototype.Yli=function(ta){"ZoomToLevelInExcelLive"===ta?this.zoomEventManager.wMi():this.zoomEventManager.vMi()};e.prototype.zRi=function(){this.zoomEventManager=this.$.ea.Ia(419,new l)};e.prototype.w$c=function(ta,Ka,mb,Ha,Ga,Fa){Fa=void 0===Fa?"":Fa;var eb=ma.g(this.$).rtl?0:Ga.x;Ga="ZoomWithPinch"===Fa||"ZoomWithMouse"===Fa?new Sys.UI.Point(ta.x-eb-Math.round(Ha.x*Ka),ta.y-Ga.y-Math.round(Ha.y*
Ka)):ta;Ga=new Sys.UI.Point(Math.round(Ga.x/Ka),Math.round(Ga.y/Ka));t.ULS.shipAssertTag(537149770,0,!!Ka,"Original zoom level must be different than 0");eb=mb/Ka;Ga=new Sys.UI.Point(Math.round(Ga.x*(1-1/eb)),Math.round(Ga.y*(1-1/eb)));"ZoomWithMouse"===Fa||"ZoomWithPinch"===Fa?(Ga.x+=Math.round((Ha.x-ma.g(this.$).wH)*(eb-1)),Ga.y+=Math.round((Ha.y-ma.g(this.$).JI)*(eb-1))):(eb=Math.round(Ha.x*(mb-Ka)),0<eb&&Ga.x>eb&&(Ga.x+=eb),Ka=Math.round(Ha.y*(mb-Ka)),0<Ka&&Ga.y>Ka&&(Ga.y+=Ka));"ZoomWithMouse"===
Fa&&(ta.x||(Ga.x=0),ta.y||(Ga.y=0));return new Sys.UI.Point(Ga.x+ma.g(this.$).view.visibleArea.topLeft.x,Ga.y+ma.g(this.$).view.visibleArea.topLeft.y)};e.prototype.szg=function(){var ta=this,Ka=[];L.a.instance.oc("Common.IGestureInputManager").execute(function(mb){mb.MAh()||mb.nQi(document.body,new n(ta.$),Ka)})};e.prototype.FFi=function(){return this.Gxc()&&(Q.a.Co&&Q.a.UJa(67)||this.$.Mdc)};e.prototype.uaj=function(ta,Ka){J.a(this.$)?this.setZoomLevel(ta,Ka,this.nTd,z.a.Nxf):this.setZoomLevel(ta,
Ka,this.zoomPerSheetId,this.CBb)};e.prototype.setZoomLevel=function(ta,Ka,mb,Ha){mb.remove(ta);Ka!==Ha&&mb.add(ta,Ka)};e.prototype.hsj=function(ta){this.wPf();this.$.wxa(V.a.uY("TriggerImmediateZoomOperations"));this.Gzj();this.Yli(ta)};e.prototype.Gzj=function(){this.F5h()?this.$.zf():this.Gcb.jx();var ta=this.Gcb.fWe("UpdateZoomStatusBar");ta&&(ta.innerText=this.fLb)};e.prototype.F5h=function(){var ta=N.a(this.$);return ta?ta.tn.eo===(Z.a.bva(this.$)?G.a.Slc:this.$.Jb+G.a.$If):!1};e.prototype.osj=
function(ta){ma.g(this.$).NDj(ta);this.Lvg()};e.prototype.Lvg=function(){var ta=La.a(this.$);if(ta)for(var Ka=Ol(ma.g(this.$).Ca.iG()),mb=Ka.next();!mb.done;mb=Ka.next())if(mb=mb.value,!mb)t.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");else{if(mb.jj&&(mb=mb.Ii))for(var Ha=0;Ha<mb.count;Ha++)if(2===mb.Lf(Ha).type){var Ga=ta.kp(mb.Lf(Ha).Dg());Ga?(Ga.P_(!1),t.ULS.sendTraceTag(537149766,0,50,"ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom {0}",
this.zoom)):t.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else t.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")};Object(C.a)(e,"ZoomManager",fa.a,[]);var ea=F.a;Em(a,ea);a.prototype.create=function(){var ta=new e(this.$);this.Izj(ta);this.Eb(ta)};a.prototype.Izj=function(ta){var Ka=E.a(this.$);if(Ka){var mb=Ka.Dbd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");
ta.sId(mb);ta.Voc(Ka.Avc)}else t.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")};a.ja=function(ta){ta.ea.Ia(369,new a(ta))};Object(C.a)(a,"ZoomManagerFactory",F.a,[]);b=b(509);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(function(){v.a.Ga(function(ta){a.ja(ta);r.ja(ta)})})();b.a.Li(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}}]);

//# sourceMappingURL=EwaDS.zoom.js.map