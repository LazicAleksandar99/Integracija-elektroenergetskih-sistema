(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[24],{1120:function(C,F,b){function a(n,r){n=l.call(this,n,r)||this;r!==d.a.x8&&n.CDa(r);n.ffa(a.iterateNext);n.ffa(a.qva);n.tOc(e.a.DRa);n.tOc(e.a.ERa);return n}b.d(F,"a",function(){return a});C=b(0);var e=b(178);F=b(1235);var d=b(872),l=F.a;Em(a,l);a.iterateNext="IterateNext";a.qva="IteratePrevious";a.mJb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.GMa=
"OnVHDiffReady";Object(C.a)(a,"VersionHistoryMessenger",F.a,[])},1238:function(C,F,b){function a(da,U,Z,ca){this.authorColor=this.U0=this.Tma=null;this.k4a=!1;this.JZf=0;this.aZa=-1;this.s_c=0;this.hGa=100;this.uja=-1;this.iSd=null;this.Ilb=w.a.ABj;this.$xe=w.a.BBj;d.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=da;this.ariaLiveNotifier=ca;this.gridView=fa.g(this.$);this.gridView.ga.HF(Object(r.a)(this,this.$c,"onSelectionChanged"));this.gridView.iD(Object(r.a)(this,
this.Ho,"onCurrentSelectionModeChanged"));this.gridView.Gc.Jm(Object(r.a)(this,this.Rj,"onEditStarted"));this.zxj();U&&(this.iSd=da.Vb.Dc("UserAction","VersionHistoryDiffManagerStopWatch"),this.vPd());if(this.rr=Z)da=l.a.k$(this.$.ya.VersionHistoryActionUrl)||Y.a.x8,da!==Y.a.x8&&this.rr.CDa(da),this.rr.En(G.a.iterateNext),this.rr.En(G.a.qva),this.rr.En(G.a.mJb),this.rr.xm(G.a.iterateNext,Object(r.a)(this,this.fld,"iterateMessageHandler")),this.rr.xm(G.a.qva,Object(r.a)(this,this.fld,"iterateMessageHandler")),
this.rr.xm(G.a.mJb,Object(r.a)(this,this.fld,"iterateMessageHandler"))}function e(da,U,Z){this.zDa=da;this.nm=U;this.Fwc=Z}C=b(0);var d=b(15),l=b(78),n=b(945),r=b(37),h=b(83),v=b(211),w=b(10),t=b(199),B=b(60),z=b(46),x=b(514),y=b(161),J=b(107),E=b(303),A=b(1),H=b(9),S=b(95),Q=b(7),L=b(16),aa=b(275);b(105);var fa=b(20),W=b(333);Object(C.a)(e,"UserActivityLocation",null,[]);var G=b(1120),N=b(81),Y=b(872),V=b(51);b.d(F,"a",function(){return a});a.prototype.dispose=function(){this.Kxa();this.Tma=this.U0=
null;this.gridView&&(this.gridView.ga&&this.gridView.ga.CE(Object(r.a)(this,this.$c,"onSelectionChanged")),this.gridView.AE(Object(r.a)(this,this.Ho,"onCurrentSelectionModeChanged")),this.gridView.Gc&&this.gridView.Gc.ym(Object(r.a)(this,this.Rj,"onEditStarted")),this.rr&&(this.rr.Kma(G.a.qva),this.rr.Kma(G.a.iterateNext),this.rr.Kma(G.a.mJb)))};a.prototype.initialize=function(da,U){da?(this.Kxa(),this.aZa=-1,this.Tma=[],this.k4a=!1,this.U0={},this.authorColor={},this.dgi(U),this.a_c(da)):d.ULS.shipAssertTag(537150410,
0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.vPd=function(){function da(Z,ca,ra){var La=U.$.ra.ua;Z=aa.b(Z,Object(r.a)(U,U.Oh,"onWebMethodSuccess"));ca=aa.a(ca,Object(r.a)(U,U.Swa,"onWebMethodFailure"));var na=La.Na(1,null);return N.i(La,"GetVersionHistoryHighlightActivitiesData",na,Z,ca,ra,null,4)}var U=this;d.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.s_c.toString(),
this.hGa.toString());this.s_c++;A.EwaSettings.pc()?this.$.userOperationManager.jc(new y.a(537,0,da,80),null):this.$.userOperationManager.jc(new x.a(537,0,da,16),null)};a.prototype.Oh=function(da){var U=this;(da=E.a(da)?null:da.Result)?da.OperationWaitingForFileDownload?20>this.s_c?(this.hGa*=2,V.Task.delay(this.hGa).continueWith(function(){U.vPd()})):(this.Yvc(),d.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):da.ActivityList?(this.initialize(da.ActivityList,
da.VersionAuthors),A.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?this.GMa():this.psc(!0),this.iSd.stop(),d.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",this.iSd.Cc.toString())):(this.Yvc(),d.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(this.hGa*=2,V.Task.delay(this.hGa).continueWith(function(){U.vPd()}),d.ULS.sendTraceTag(537150408,
0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};a.prototype.Swa=function(){this.Yvc();d.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};a.prototype.psc=function(da){var U=this.U0,Z;for(Z in U){var ca=Z,ra=U[Z];ra?ra.GHb(da):d.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+ca+"view was Null")}};a.prototype.Kxa=function(){var da=this.U0,U;for(U in da){var Z=
U,ca=da[U];ca?ca.wSi():d.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+Z+"view was Null")}this.Tma=this.U0=null};a.prototype.GLf=function(da){var U=this.WDh(da,this.aZa);var Z=U.U0e;da=U.f4f;U.returnValue&&(d.ULS.shipAssertTag(537150402,0,!!da,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.L1b(),da.zDa.toString()in this.U0?(this.U0[da.zDa.toString()].D3i(da.nm),U=z.D(da.nm),this.ariaLiveNotifier.setEnabled(!1),
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(L.a.instance.Bb(156),Z+1,this.VQ.length,U.nG(!1),da.Fwc.DisplayName)),this.aZa=Z):d.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",da.zDa.toString())))};a.prototype.fld=function(da){d.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",da.MessageId);switch(da.MessageId){case G.a.iterateNext:this.iterateNext();
this.uja=(this.uja+1)%this.VQ.length;this.TFb(G.a.setCurrentChangeCount,this.uja+1);break;case G.a.qva:this.qva();this.uja=0>this.uja?0:this.uja;this.uja=(this.uja+this.VQ.length-1)%this.VQ.length;this.TFb(G.a.setCurrentChangeCount,this.uja+1);break;case G.a.mJb:this.psc(da.Values.ToggleValue)}};a.prototype.TFb=function(da,U){if(A.EwaSettings.ka(331))if(this.rr){var Z={};Z.count=U;da=new n.a(da);da.Values=Z;this.rr.send(da)}else d.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");
else d.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.WDh=function(da,U){var Z=!1;var ca=null;for(var ra=0;!Z&&ra<this.VQ.length;){U=da?this.NDh(U):this.vFh(U);ca=this.VQ[U];var La=Object(h.a)(S.a,this.$.va.getItemByName(ca.nm.SheetName));if(!La)return d.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),
{returnValue:!1,U0e:U,f4f:ca};La.visible&&(Z=!0);ra++}return{returnValue:Z,U0e:U,f4f:ca}};a.prototype.NDh=function(da){return-1===da?this.uSe():(da+1)%this.VQ.length};a.prototype.vFh=function(da){-1===da&&(da=this.uSe());return da=(da+this.VQ.length-1)%this.VQ.length};a.prototype.a_c=function(da){this.JYg(da);this.HZc()};a.prototype.zKh=function(da,U){var Z=[];if(!da.RangeList)return d.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
Z;da=Ol(da.RangeList);for(var ca=da.next();!ca.done;ca=da.next())(ca=ca.value)&&this.$.va.Aj(ca.SheetName)?(ca=new e(0,ca,U),Z.push(ca)):d.ULS.shipAssertTag(537150367,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - "+ca?" Inavlid sheet name"+ca.SheetName:"Null Sheet Range");return Z};a.prototype.JYg=function(da){da=Ol(da);for(var U=da.next();!U.done;U=da.next())if(U=U.value,!U||J.e(U.LocationList))d.ULS.sendTraceTag(537150366,0,50,"VersionHistoryHighlightManager.CreateUserActivityLocationList - "+
U?"Empty Location list":"Null user activity");else for(var Z=Ol(U.LocationList),ca=Z.next();!ca.done;ca=Z.next())if(ca=ca.value)switch(ca.Type){case 0:var ra=void 0;(ra=this.Tma).push.apply(ra,this.zKh(ca,U.Person));break;default:d.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else d.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};a.prototype.HZc=function(){for(var da=
{},U=new v.a,Z=[],ca=Ol(this.Tma),ra=ca.next();!ra.done;ra=ca.next())if(ra=ra.value,U.contains(ra.Fwc)||U.add(ra.Fwc),!ra.zDa){var La=new W.a(z.D(ra.nm),B.d(this.$.va.getItemByName(ra.nm.SheetName))),na=a.lrc(La);na in da||Z.push(La);da[na]=this.kwh(ra.Fwc)}d.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.Tma.length,Z.length,U.count,
this.JZf);this.Yvc();0<Z.length&&(da=new (b(1329).RangeVersionHistoryHighlightView)(this.$,Z,da,this.Ilb),this.U0["0"]=da)};a.prototype.Yvc=function(){var da=this.Tma?this.VQ.length:0;this.TFb(G.a.setCurrentChangeCount,0);this.TFb(G.a.setTotalChangesCount,da)};a.prototype.GMa=function(){this.TFb(G.a.GMa,0)};a.prototype.dgi=function(da){if(da){this.JZf=da.length;for(var U=0;U<da.length;++U)if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&Q.a.ma(da[U].InitialsColor))d.ULS.sendTraceTag(537150362,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var Z=da[U].EmailAddress;var ca=da[U].UserName;var ra=null;if(da[U].LoginName){var La=da[U].LoginName.split("|");3===La.length&&(ra=La[2])}ra?this.authorColor[ra]=da[U].InitialsColor:Z?(d.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[Z]=da[U].InitialsColor):ca?(d.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),
this.authorColor[ca]=da[U].InitialsColor):d.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else d.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.zxj=function(){if(Q.a.ma(this.$.ya.VersionHistoryHighlightsSettings))d.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"));else for(var da=
Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,U=0;U<da.length;U++){var Z=da[U],ca=Z.key?Z.key:Z.Key?Z.Key:"";Z=Z.value?Z.value:Z.Value?Z.Value:"";"DefaultColor"===ca?this.$xe=Z:"InitialTint"===ca?this.Ilb=Z:d.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}};
a.prototype.kwh=function(da){if(da.Email in this.authorColor)return this.authorColor[da.Email];if(da.DisplayName in this.authorColor)return this.authorColor[da.DisplayName];d.ULS.sendTraceTag(537150356,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.$xe};a.prototype.sOg=function(da,U){return this.YZb(da.nm,U.nm)};a.prototype.rOg=function(da,U){return this.YZb(da.nm,U)};a.prototype.YZb=function(da,U){var Z=
Object(h.a)(S.a,this.$.va.getItemByName(da.SheetName)),ca=Object(h.a)(S.a,this.$.va.getItemByName(U.SheetName));return Z&&ca?(Z=(Z=H.HelperMethods.eC(Z.index,ca.index))?Z:H.HelperMethods.eC(da.FirstRow,U.FirstRow))?Z:H.HelperMethods.eC(da.FirstColumn,U.FirstColumn):(d.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.uSe=function(){var da=z.m(this.gridView.ga.wa.activeRange,this.$.va.qa);if(!da)return d.ULS.sendTraceTag(537150354,
0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;da=H.HelperMethods.uw(new t.a(this.VQ),0,this.VQ.length,da,Object(r.a)(this,this.rOg,"compareSelectedCellWithUserActivityLocation"));0>da&&(da=~da);return da%this.VQ.length};a.prototype.L1b=function(){if(this.OFb){if(!(this.OFb.zDa.toString()in this.U0)){d.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",
this.OFb.zDa.toString()));return}this.U0[this.OFb.zDa.toString()].q1g(this.OFb.nm)}this.aZa=-1};a.prototype.$c=function(){this.L1b()};a.prototype.Ho=function(){this.L1b()};a.prototype.Rj=function(){this.L1b()};a.prototype.iterateNext=function(){this.GLf(!0)};a.prototype.qva=function(){this.GLf(!1)};a.lrc=function(da){return String.format("{0}{1}",da.range,da.sheetId)};Ll.Object.defineProperties(a.prototype,{ycb:{configurable:!0,enumerable:!0,get:function(){return this.U0}},OFb:{configurable:!0,enumerable:!0,
get:function(){return-1===this.aZa?null:this.VQ[this.aZa]}},VQ:{configurable:!0,enumerable:!0,get:function(){this.k4a||(this.Tma.sort(Object(r.a)(this,this.sOg,"compareUserActivityLocation")),this.k4a=!0);return this.Tma}}});Object(C.a)(a,"VersionHistoryHighlightManager",null,[20,6])},1329:function(C,F,b){function a(z,x,y,J){this.Dfb=null;this.$=z;this.sjg=x;this.xPa=y;this.yPa={};this.Ilb=J;this.NWh()}function e(){}b.r(F);C=b(0);var d=b(15),l=b(10);e.qeh="ewa-vhr-rectinnerborder";Object(C.a)(e,"CssClassNames",
null,[]);var n=b(60),r=b(46),h=b(214),v=b(105),w=b(20),t=b(333),B=b(1238);b.d(F,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.GHb=function(z){z?this.Kb.Jr(this.wdd):this.Kb.mk(this.wdd)};a.prototype.wSi=function(){this.GHb(!1);this.Kb.BGb(new t.a(null,n.d(this.$.qa)),this.wdd)};a.prototype.D3i=function(z){if(this.xPa){var x=new t.a(r.D(z),n.d(this.$.va.getItemByName(z.SheetName))),y=B.a.lrc(x);if(y in this.xPa)if(y in this.yPa){x=h.a.jp(this.xPa[y]);y=this.yPa[y];for(var J in y)y[J].style.backgroundColor=
String.format("rgba({0},{1},{2},{3})",x.r,x.g,x.b,l.a.CBj);w.g(this.$).ga.Pa.VF(null);w.g(this.$).MWe(z,60,!0,v.a.NMi)}else d.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+y);else d.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+y)}else d.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};
a.prototype.q1g=function(z){z=new t.a(r.D(z),n.d(this.$.va.getItemByName(z.SheetName)));var x=B.a.lrc(z);if(x in this.yPa)if(x in this.xPa){z=h.a.jp(this.xPa[x]);x=this.yPa[x];for(var y in x)x[y].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",z.r,z.g,z.b,this.Ilb)}else d.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+x);else d.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+
x)};a.prototype.NWh=function(){var z=this;this.Kb.Hs(this.sjg,[a.B3],!1,function(x,y){if(x&&x.range&&x.sheetId&&y){var J=new t.a(x.range,x.sheetId);J=B.a.lrc(J);J in z.yPa||(z.yPa[J]={});z.yPa[J][x.paneType.toString()]=y;J in z.xPa?(x=z.xPa[J],J=h.a.jp(x),y.style.borderColor=x,y.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",J.r,J.g,J.b,z.Ilb),x=document.createElement("div"),x.className=e.qeh,y.appendChild(x)):d.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+
J)}else d.ULS.shipAssertTag(537150423,0,!!x,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),d.ULS.shipAssertTag(537150422,0,!x||!!x.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),d.ULS.shipAssertTag(537150421,0,!x||!!x.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),d.ULS.shipAssertTag(537150420,0,!!y,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Ll.Object.defineProperties(a.prototype,
{wdd:{configurable:!0,enumerable:!0,get:function(){return[a.B3]}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.Dfb||(this.Dfb=w.g(this.$).Kb)}}});a.B3=23;Object(C.a)(a,"RangeVersionHistoryHighlightView",null,[442])},1366:function(C,F,b){function a(Vb){var Qc=Bf.call(this)||this;Qc.$=Vb;Qc.Yb();return Qc}function e(Vb,Qc,md,Ce){var le=this;md=void 0===md?null:md;Ce=void 0===Ce?null:Ce;this.emptyCatchUpBehaviorManager=this.MEa=null;this.GYe=!1;this.$=Vb;this.IXa=new Q(this.$);this.oWd=
new da(Db.AFrameworkApplication.Hb,lf.EwaSettings.ka(475));Vb=Hd.a.zqj(Fc.a.instance.oc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.Vaf=Ce;this.Poe=new w(this.$,this,Vb,this.z3a());this.Ooe=new S(this.$,Db.AFrameworkApplication.Hb);lf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EmptyCatchUpExperience",!1)&&lf.EwaSettings.ka(507)&&this.$.fa&&this.$.fa.nLa&&(this.emptyCatchUpBehaviorManager=new v(this.$));this.Pai(function(Zd){le.Xoi(Zd)},Qc);this.Fci();Qc=null;md||(Qc=
Fc.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=md||new n(Qc);this.flyoutFocus=new r(this.$,this.flyoutRibbonButton)}function d(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function l(){this.useCompactSummaryString=this.disableDismissOnClick=
this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function n(Vb){this.buttonClickedCallback=null;this.cgb=this.Cvb=!1;this.toh=new Date;this.BLe=Vb}function r(Vb,Qc){this.$=Vb;this.flyoutRibbonButton=void 0===Qc?null:Qc;kd.a(this.$).Og(this);this.hasFocus=!1}function h(Vb){window.performance&&"function"===typeof window.performance.mark&&
window.performance.mark("CatchUpInit."+Vb)}function v(Vb){this.$=Vb}function w(Vb,Qc,md,Ce){Ce=void 0===Ce?!1:Ce;this.$=Vb;this.catchUpActivityManager=Qc;this.Qoe=md;this.cCb=Fc.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.tlc=Fc.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.z3a=Ce}function t(){var Vb=J.call(this)||this;Vb.relationship=0;return Vb}function B(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function z(){this.lowWaterline=
this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function x(){this.activityFeedItems=null}function y(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function J(){this.activityFeedItemId=this.activityId=null;this.type=0;this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}function E(Vb,Qc,md,Ce,le,Zd,fg){fg=Vb.Na(1,void 0===
fg?null:fg);fg.getRelevantActivitiesDataRequest=Qc;return bb.i(Vb,"GetRelevantActivitiesData",fg,md,Ce,le,Zd,0)}function A(Vb,Qc,md,Ce,le,Zd){Zd=Vb.Na(1,void 0===Zd?null:Zd);return bb.i(Vb,"GetLineageWywaAuthors",Zd,Qc,md,Ce,le,4)}function H(){}function S(Vb,Qc){this.$=Vb;this.pi=Qc}function Q(Vb){this.JOa=this.J_b=this.nda=null;this.z3={};this.tBa=null;this.Bdd=!1;this.$=Vb;this.gridView=za.g(this.$);this.ga=this.gridView.ga;this.pb=this.gridView.Gc;this.ga.dVb(Object(fb.a)(this,this.Uk,"onContextMenu"));
this.ga.HF(Object(fb.a)(this,this.$c,"onSelectionChanged"));this.gridView.iD(Object(fb.a)(this,this.Ho,"onCurrentSelectionModeChanged"));this.pb.Jm(Object(fb.a)(this,this.Rj,"onEditStarted"));this.Aia=this.t$b=null;this.Lbc=!1;this.t6c={}}function L(){this.target=null;this.isSticky=!1}function aa(){this.clearSticky=!1}function fa(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function W(){this.sXc=new Ea.a;this.$Gb={};this.Oce={}}function G(Vb,Qc,md,Ce,le){Vb=N.call(this,
Vb,Qc,md,Ce)||this;Vb.ranges=le;Vb.k4a=!1;return Vb}function N(Vb,Qc,md,Ce){var le=zf.call(this)||this;le.$=Vb;le.EUd=Qc;le.g9f=md;le.gB=Ce;le.state=0;return le}function Y(Vb,Qc,md){md=Hf.call(this,Vb,Qc,md)||this;md.gridView=za.g(Vb);md.Pka=Qc;return md}function V(Vb){this.Gdg=Vb;this.mu.$ee(Object(fb.a)(this,this.tAb,"onHighlightStateChanged"));this.y$=[]}function da(Vb){this.pi=Vb}function U(Vb){return Kd.call(this,Vb)||this}function Z(Vb,Qc){this.$=Vb;this.catchUpActivityManager=Qc}function ca(){this.Za=
null}function ra(Vb){this.oea=Vb}function La(Vb){this.phg=Vb}function na(Vb){this.UUa=Vb;this.J3d=new Cf.a}function ma(Vb,Qc,md){this.rgg=Vb;this.mSa=Qc;this.ASa=md}function xa(Vb,Qc,md){Vb=Qf.call(this,Vb,Qc)||this;Vb.DocumentId=null;Vb.DocumentId=md;return Vb}function Pa(Vb,Qc){this.Ng=Vb;this.oea=Qc}function ib(Vb,Qc,md,Ce,le,Zd,fg){this.H7=this.gIc=this.fIc=this.iea=this.Jhb=this.vCa=this.YMb=this.vF=null;this.i5d=0;this.pRb=null;this.jgb=!1;this.PIc=this.nVd=null;this.C_d=this.z_d=!1;this.UVd=
null;this.W_d=!1;this.Pg=Vb;this.dc=Qc;this.qF=md;this.Ce=Ce;this.La=void 0===le?null:le;this.OAa=void 0===Zd?null:Zd;this.eX=void 0===fg?null:fg;this.La.Xb(Jg.a.Pce,Ag.a.frame,Gg.ActionManager.Tf)}function pb(Vb){var Qc=Uf.call(this)||this;Qc.$=Vb;Qc.Yb();return Qc}function xb(Vb,Qc){this.xjd=!1;this.$=Vb;lf.EwaSettings.ka(648)&&this.$.fa.nLa&&!xb.Ctb&&(Qc&&!Qc.nab||this.sBj(),xb.JYe?sb.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):
Qc&&!Qc.nab||this.yBj());sb.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Ya(Vb){var Qc=xf.call(this)||this;Qc.fi=null;Qc.Ug=null;Qc.$=Vb;Qc.Yb();return Qc}function ab(Vb,Qc,md){Vb=Fg.call(this,Vb)||this;Vb.he=null;Vb.tre=null;Vb.yAb=null;Vb.Xid=!0;Vb.Qq=0;Vb.Po=!1;Vb.$=Qc;Vb.taskPaneManager=md;Vb.$.dn(Object(fb.a)(Vb,Vb.Pd,"onWorkbookClosing"));kd.a(Vb.$).Og(Vb);ac.a.Jd(Vb.$)&&(Vb.isVisible=!1);return Vb}function ea(Vb){var Qc=ad.call(this)||this;
Qc.lineageTaskPane=null;Qc.a6=null;Qc.$=Vb;Qc.Yb();return Qc}function ta(Vb,Qc,md,Ce){this.yqb=this.jE=null;this.eD=this.Omd=0;this.$=Vb;Qc.Ia(366,this);this.gridView=za.g(this.$);this.lineageTaskPane=md;this.Jmd=this.lineageTaskPane.pL();this.batchSize=50;this.a6=Ce;this.xHb=this.$.Vb.yi("UserAction","LineagePaneLoadingShimmerStopWatch");this.tlc=Fc.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.mWh();this.zog()}function Ka(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=
this.oldValue=this.newValue=null}function mb(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=0}function Ha(){this.sheetName=this.rangeList=null}function Ga(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function Fa(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=
0;this.lineageAppCallbacks=this.filterableSheetList=null}function eb(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function db(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function Na(){var Vb=kb.call(this)||this;Vb.hasNewActivities=
!1;Vb.filterSheetMultiRange=null;return Vb}function kb(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Tb(Vb,Qc,md,Ce,le,Zd){Zd=Vb.Na(1,void 0===Zd?null:Zd);return bb.i(Vb,"LineageClosePane",Zd,Qc,md,Ce,le,0)}function ha(Vb,Qc,md,Ce,
le,Zd){Zd=Vb.Na(1,void 0===Zd?null:Zd);return bb.i(Vb,"LineageUpdateView",Zd,Qc,md,Ce,le,0)}function lb(){}function Wa(){}function Ra(Vb){var Qc=Oe.call(this)||this;Qc.$=Vb;Qc.Yb();return Qc}function Yb(Vb){this.nab=!0;Yb.x3e()?Yb.E3e()?this.nab=Vb:this.nab=!1:this.nab=!0}function oc(Vb){return ng.call(this,Vb)||this}function zb(Vb,Qc){this.$=Vb;this.lineageManager=Qc;Vb=[new Fe.a(Lc.a.Lmd,1038647878,0,0,2137),new Fe.a(Lc.a.idle,1038647878,0,1)];xc.a(this.$).HAd(new me.a(Lc.a.Kmd,Lc.a.idle,Vb),new uc(Lc.a.Lmd,
Lc.a.idle,Qc))}function uc(Vb,Qc,md){Vb=Pf.call(this,Vb,Qc)||this;Vb.lineageManager=md;return Vb}function P(Vb){var Qc=ne.call(this)||this;Qc.$=Vb;Qc.Yb();return Qc}function lc(Vb){return Wd.call(this,Vb)||this}function Ec(Vb){this.baseVersionInfo=this.n2=this.Uma=this.am=this.ewaAccessibilityManager=this.KJb=null;this.cBd=this.Hhf=!1;this.qxe=!0;this.dialog=this.OA=this.rLe=this.GC=this.lSd=this.jSd=this.kSd=null;this.$=Vb;this.t4b=this.$.Jb+Ec.Rih;this.bBd=!1;lf.EwaSettings.ka(400)&&this.NYg();
this.vxb="";this.cmd=0;this.perfTelemetryInfos=[]}function tc(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function cc(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=
this.useXhr=this.isRtl=!1;this.wdEnableDownloadVersion=this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdEnableAppColorUpdate=null}function Zb(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function Aa(){this.rootDiv=this.appBootSettings=null}function Ia(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function qb(Vb){this.Nv=Vb}function wb(Vb){this.Nv=Vb}function ic(Vb){this.Nv=Vb}function Jb(){}
function Ua(Vb,Qc){this.$=Vb;this.FBj=Qc}function $a(Vb,Qc){var md=Od.call(this)||this;md.activityName=Vb;md.kT=Qc;md.Yb();return md}function ua(Vb,Qc){return yd.call(this,Vb,Qc)||this}function Ca(Vb,Qc,md){var Ce=Nc.call(this)||this;Ce.activityName=Vb;Ce.kT=Qc;Ce.SI=md;Ce.Yb();return Ce}function Sa(Vb,Qc,md,Ce,le){Vb=gc.call(this,Vb,Qc)||this;Vb.Sh=null;Vb.retryCount=0;Vb.SI=md;Vb.R1=Ce;Vb.baseUrl=le;return Vb}b.r(F);var Qb=b(12),Hb=b(0),Db=b(5),jc=b(212),sb=b(15),fb=b(37),Qa=b(111),cb=b(174),Ab=
b(41),gc=Qa.a;Em(Sa,gc);Sa.prototype.execute=function(Vb){this.Sh=Vb;this.retryCount=3;this.JIf();return 1};Sa.prototype.JIf=function(){var Vb=this.Sh.activityState[Sa.Clc],Qc=this.Sh.activityState[Sa.$4f],md=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");Vb=Ab.c({VersionId:Qc,QuerySignature:Vb});this.R1.Jl(md,2,Vb,{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(fb.a)(this,this.nyi,"onRestoreSuccessCallback"),Object(fb.a)(this,this.lyi,"onRestoreFailureCallback"),null)};
Sa.prototype.nyi=function(Vb){var Qc=this.$sj(Vb);Vb=Qc.qEd;Qc.returnValue?Vb.Success?(cb.c(2138207060,!0),sb.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(cb.c(2138207060,!1),sb.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",Vb.Output),this.fh(this.SI)):(cb.c(2138207060,!1),this.fh(this.SI));(Vb=this.Sh.activityState[Sa.Wnd])&&Vb();this.Go();this.Sh.GI()};
Sa.prototype.lyi=function(){if(0<this.retryCount)sb.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",this.retryCount),this.retryCount--,this.JIf();else{sb.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");cb.c(2138207060,!1);this.fh(this.SI);var Vb=this.Sh.activityState[Sa.Wnd];Vb&&Vb();this.Go();this.Sh.GI()}};Sa.prototype.$sj=function(Vb){var Qc=null;Vb=Vb?Vb.data?
Vb.data.ae:null:null;if(!Vb||!Vb.length)return sb.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,qEd:Qc};Vb=Ab.d(Vb);Qc=Vb.eu;return Vb.returnValue?{returnValue:!0,qEd:Qc}:(sb.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,qEd:Qc})};Sa.$4f="RVAvi";Sa.Clc="RVAqs";Sa.Wnd="RVlvrt";Object(Hb.a)(Sa,
"RestoreVersionActivity",Qa.a,[]);var Lc=b(6),Nc=jc.a;Em(Ca,Nc);Ca.prototype.create=function(){this.Eb(new Sa(this.activityName,this.kT,this.SI,Db.AFrameworkApplication.Cd,Db.AFrameworkApplication.xa.Xa.vZ))};Ca.ja=function(Vb){Vb.ea.Ia(320,new Ca(Lc.a.tEd,Lc.a.dj,Lc.a.uEd))};Object(Hb.a)(Ca,"RestoreVersionActivityFactory",jc.a,[]);var yd=Qa.a;Em(ua,yd);ua.prototype.execute=function(Vb){var Qc=this;(0,Vb.activityState[ua.STf])(function(){Qc.Go();Vb.GI()});return 1};ua.STf="RVEAssea";Object(Hb.a)(ua,
"RestoreVersionErrorActivity",Qa.a,[]);var Od=jc.a;Em($a,Od);$a.prototype.create=function(){this.Eb(new ua(this.activityName,this.kT))};$a.ja=function(Vb){Vb.ea.Ia(321,new $a(Lc.a.uEd,Lc.a.dj))};Object(Hb.a)($a,"RestoreVersionErrorActivityFactory",jc.a,[]);var sa=b(78),vb=b(800),Lb=b(58),rc=b(35),Oc=b(173),Bb=b(366),hc=b(51);Ua.prototype.Wc=function(){return Db.AFrameworkApplication.ha.sa("IsAnonymousUser")?(sb.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):
!1};Ua.prototype.executeCommand=function(Vb,Qc){sb.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");Vb=!1;switch(Qc.command){case -1112508866:Bb.a(this.$)&&this.$.ea.Ba(423).qsc(!1),Vb=this.FBj.rij()}sb.ULS.sendTraceTag(537150413,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",Vb);return Vb?hc.Task.Ra(Vb):Oc.a(Qc.command)};Ua.prototype.Ec=function(Vb,Qc){return-1112508866===Qc.command&&this.$.isVersionHistoryEnabled()};Ua.prototype.Yc=function(){return!1};
Object(Hb.a)(Ua,"VersionHistoryCommandHandler",null,[160]);var Pc=b(381),rd=b(23),Id=b(178),Vd=b(279);Jb.addAppPLTEventToLog=function(Vb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Vb)}catch(Qc){}};Jb.setIsPageLoadForFirstTime=function(Vb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Vb)}catch(Qc){}};Object(Hb.a)(Jb,"VersionHistoryLogConnector",null,[]);var He=b(945),Nd=b(1235),Vc=b(148),fe=b(92),Ee=b(27),lf=b(1),Da=b(7),fc=b(39),Ib=
b(246),Ta=b(1120),kd=b(257),ce=b(245),dc=b(11);ic.prototype.Og=function(){kd.a(this.Nv.$).OL(this.Vd)||kd.a(this.Nv.$).Og(this)};ic.prototype.z6=function(){kd.a(this.Nv.$).OL(this.Vd)&&kd.a(this.Nv.$).sA(this)};ic.prototype.rh=function(Vb){return dc.DOMElementExtensions.Ue(this.Ib,Vb)};ic.prototype.Uh=function(){this.Nv.$.frame.Me.Wj(this.Nv.$.frame.Me.BD)};ic.prototype.Nh=function(){};ic.prototype.Le=function(Vb,Qc){Qc||this.Nv.KJb.then(function(md){md.enterHeaderFocusTrapZone();return null});return!Qc};
Ll.Object.defineProperties(ic.prototype,{Vd:{configurable:!0,enumerable:!0,get:function(){return ce.a.X4f}},Ib:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Hb.a)(ic,"VersionHistoryHeader",null,[120]);wb.prototype.Og=function(){kd.a(this.Nv.$).OL(this.Vd)||kd.a(this.Nv.$).Og(this)};wb.prototype.z6=function(){kd.a(this.Nv.$).OL(this.Vd)&&kd.a(this.Nv.$).sA(this)};wb.prototype.rh=
function(Vb){return dc.DOMElementExtensions.Ue(this.Ib,Vb)};wb.prototype.Uh=function(){this.Nv.$.frame.Me.Wj(this.Nv.$.frame.Me.BD)};wb.prototype.Nh=function(){};wb.prototype.Le=function(Vb,Qc){Qc||this.Nv.KJb.then(function(md){md.enterFocusTrapZone();return null});return!Qc};Ll.Object.defineProperties(wb.prototype,{Vd:{configurable:!0,enumerable:!0,get:function(){return ce.a.Y4f}},Ib:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Hb.a)(wb,"VersionHistoryPane",null,[120]);qb.prototype.Og=function(){kd.a(this.Nv.$).OL(this.Vd)||kd.a(this.Nv.$).Og(this)};qb.prototype.z6=function(){kd.a(this.Nv.$).OL(this.Vd)&&kd.a(this.Nv.$).sA(this)};qb.prototype.rh=function(Vb){return dc.DOMElementExtensions.Ue(this.Ib,Vb)};qb.prototype.Uh=function(){this.Nv.$.frame.Me.Wj(this.Nv.$.frame.Me.BD)};qb.prototype.Nh=function(){};qb.prototype.Le=function(Vb,Qc){Qc||
this.Nv.KJb.then(function(md){md.enterViewerFocusTrapZone();return null});return!Qc};Ll.Object.defineProperties(qb.prototype,{Vd:{configurable:!0,enumerable:!0,get:function(){return ce.a.Z4f}},Ib:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Hb.a)(qb,"VersionHistoryViewer",null,[120]);var ub=b(133),pc=b(248),xc=b(64),hd=b(409),Rc=b(872);Object(Hb.a)(Ia,"AppBootSettings",
null,[]);Object(Hb.a)(Aa,"AppVersionControllerFactoryParameters",null,[]);Object(Hb.a)(Zb,"OnVersionSelectedParams",null,[]);Object(Hb.a)(cc,"AppSettings",null,[]);Object(Hb.a)(tc,"ControllerFactoryParameters",null,[]);Ec.prototype.dispose=function(){this.rqe()};Ec.prototype.VGi=function(){var Vb=this;this.$.ea.$a(15,function(Qc){Vb.ewaAccessibilityManager=Qc;Vb.ewaAccessibilityManager.mode=2})};Ec.prototype.NYg=function(){this.kSd=new wb(this);this.jSd=new ic(this);this.lSd=new qb(this)};Ec.prototype.rij=
function(){var Vb=this;sb.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");Db.AFrameworkApplication.lM("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");Db.AFrameworkApplication.lM("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");Db.AFrameworkApplication.lM("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");Db.AFrameworkApplication.$xb("gj946531;j6gcd431");
this.GC=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.GC.startTimer(Ec.VYf);if(!this.am&&(hd.a(function(){Vb.am=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new tc,{ulsLogger:new Pc.a,docId:Db.AFrameworkApplication.Xi,appSettings:Object.assign(new cc,{appName:120,userSessionId:Db.AFrameworkApplication.userSessionId,wdEnableSaveACopy:lf.EwaSettings.ka(368),wdEnableDownloadTokens:lf.EwaSettings.ka(363),wacCluster:Db.AFrameworkApplication.Cd.fR,
uiLocale:Db.AFrameworkApplication.uiCulture?Db.AFrameworkApplication.uiCulture:"en-us",wdEnableRestore:lf.EwaSettings.ka(333)&&Vb.$.isEditMode,wdEnableIterator:lf.EwaSettings.ka(330)&&lf.EwaSettings.ka(331),useXhr:rd.a.bM,wdEnableHiddenButtonsUntilVersionLoadComplete:lf.EwaSettings.ka(440),disableSaveACopy:Vb.tRf(),wdEnableShowVersionChanges:lf.EwaSettings.ka(330)&&lf.EwaSettings.ka(332),disabledChangeGates:Vb.$.ya.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:lf.EwaSettings.ka(574),isRtl:Db.AFrameworkApplication.isRtl,
wdEnableDownloadVersion:lf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.VersionHistoryDownloadVersionIsEnabled",!1)||Vb.$.Qf.get(51)}),perfTelemetryInfos:Vb.perfTelemetryInfos}))}),!this.am))return sb.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),cb.c(429638140,!1),!1;this.sij();this.GC.endTimer(Ec.VYf);this.GC.startTimer(Ec.YYf);sb.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");
cb.c(429638140,!0);return!0};Ec.prototype.sij=function(){this.Uj();if(!document.getElementById(this.t4b)){var Vb=document.createElement("div");Vb.id=this.t4b;Vb.style.width="100%";Vb.style.height="100%";Vb.style.zIndex="998";Vb.style.display="block";Vb.style.position="absolute";this.$.Yq.insertBefore(Vb,this.$.Yq.firstChild);this.KJb=this.am.createVersionHistoryDialog(Vb)}document.getElementById(this.t4b).style.display="block";this.UAd();this.GC.startTimer(Ec.gOd);this.am.getVersions("")};Ec.prototype.UAd=
function(){lf.EwaSettings.ka(400)&&(this.kSd.Og(),this.jSd.Og(),this.lSd.Og(),this.VGi())};Ec.prototype.dQd=function(){lf.EwaSettings.ka(400)&&(this.kSd.z6(),this.jSd.z6(),this.lSd.z6(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};Ec.prototype.Uj=function(){this.am.getVersionsReadyEvent().addListener(Object(fb.a)(this,this.Wtf,"onVersionsReady"));this.am.getVersionSelectedEvent().addListener(Object(fb.a)(this,this.onVersionSelected,"onVersionSelected"));this.am.getCloseSelectedEvent().addListener(Object(fb.a)(this,
this.blf,"onCloseVersionHistoryDialog"));this.am.getFullAppErrorEvent().addListener(Object(fb.a)(this,this.inf,"onFullAppError"));this.am.getIteratorSelectedEvent().addListener(Object(fb.a)(this,this.wof,"onIteratorSelected"));this.am.getShowVersionChangesToggledEvent().addListener(Object(fb.a)(this,this.Mud,"onShowChangesToggleSelected"));lf.EwaSettings.ka(363)&&(this.am.getDownloadTokenReadyEvent().addListener(Object(fb.a)(this,this.Zlf,"onDownloadTokenReady")),this.bBd=!0);lf.EwaSettings.ka(368)&&
(this.am.getSaveACopySelectedEvent().addListener(Object(fb.a)(this,this.Grf,"onSaveACopy")),this.am.getDownloadVersionSelectedEvent().addListener(Object(fb.a)(this,this.$lf,"onDownloadVersion")));lf.EwaSettings.ka(333)&&this.$.isEditMode&&(this.am.getRestoreVersionSelectedEvent().addListener(Object(fb.a)(this,this.prf,"onRestoreVersionSelected")),this.cBd=!0);this.Uma&&this.Uma.getAppErrorEvent().addListener(Object(fb.a)(this,this.Gjf,"onAppError"))};Ec.prototype.$l=function(){this.am.getVersionsReadyEvent().removeListener(Object(fb.a)(this,
this.Wtf,"onVersionsReady"));this.am.getVersionSelectedEvent().removeListener(Object(fb.a)(this,this.onVersionSelected,"onVersionSelected"));this.am.getCloseSelectedEvent().removeListener(Object(fb.a)(this,this.blf,"onCloseVersionHistoryDialog"));this.am.getFullAppErrorEvent().removeListener(Object(fb.a)(this,this.inf,"onFullAppError"));this.am.getIteratorSelectedEvent().removeListener(Object(fb.a)(this,this.wof,"onIteratorSelected"));this.am.getShowVersionChangesToggledEvent().removeListener(Object(fb.a)(this,
this.Mud,"onShowChangesToggleSelected"));lf.EwaSettings.ka(368)&&(this.am.getSaveACopySelectedEvent().removeListener(Object(fb.a)(this,this.Grf,"onSaveACopy")),this.am.getDownloadVersionSelectedEvent().removeListener(Object(fb.a)(this,this.$lf,"onDownloadVersion")));this.bBd&&(this.am.getDownloadTokenReadyEvent().removeListener(Object(fb.a)(this,this.Zlf,"onDownloadTokenReady")),this.bBd=!1);this.cBd&&(this.am.getRestoreVersionSelectedEvent().removeListener(Object(fb.a)(this,this.prf,"onRestoreVersionSelected")),
this.cBd=!1);this.Uma&&this.Uma.getAppErrorEvent().removeListener(Object(fb.a)(this,this.Gjf,"onAppError"))};Ec.prototype.Xej=function(){var Vb=!0;if(lf.EwaSettings.ka(642)&&!this.$.LP)return sb.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.fa.amIAlone.toString()),!0;if(!this.$.fa.amIAlone&&!lf.EwaSettings.ka(329)){this.dci();this.am.setCoauthRestoreError();Vb=!1;var Qc=new fe.a(-729359593,0,this.$.dd,0,null);this.$.Ka.Ub(Qc)}this.$.LP&&
(sb.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),Vb&&(Vb=!1,this.nij()));return Vb};Ec.prototype.prf=function(Vb){var Qc=this;sb.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(this.Xej()){var md=function(le){cb.c(2138207060,!1);Qc.am.setRestoreFailedAtServer(le)};this.GC&&this.GC.startTimer(Ec.WYf);var Ce=function(){Qc.GC.endTimer(Ec.WYf);Qc.Ioe(Qc.GC)};this.am.setRestoreInProgress();
fc.a(this.$).zs(new Ib.a(Lc.a.ly,5,function(){var le=xc.a(Qc.$).fd.activityState;le[pc.a.rq]=Lc.a.Dre;le[ub.a.mX]=!0;le[ub.a.iS]=0;le[Sa.$4f]=Vb;le[Sa.Clc]=Db.AFrameworkApplication.Xi;le[Sa.Wnd]=Ce;le[ua.STf]=md}))}else cb.c(2138207060,!1)};Ec.prototype.nij=function(){var Vb=Ee.a.gd(1,0,1820,1819,0,-1603358883,"RestoreVersionUnsavedChangesError");Vb=this.dialog||new Vc.ErrorDialog(this.$,Vb);Vb.initialize();Vb.mf()};Ec.prototype.Wtf=function(Vb){this.KJb.then(function(Qc){Qc.enterFocusTrapZone();
return null});sb.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");this.GC.endTimer(Ec.gOd);this.GC.incrementCounter(Ec.BRg);sb.ULS.sendTraceTag(537150348,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",this.GC.getTimerDuration(Ec.gOd));this.MYi(Vb.containerDiv);Vb.versions&&0<Vb.versions.length&&(this.rLe=Ec.VD(Vb.versions[Vb.versions.length-1]));this.n2&&this.Uma&&this.gGd(this.n2);sb.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};
Ec.prototype.onVersionSelected=function(Vb){sb.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",Ec.VD(Vb.currentVersion),Ec.VD(this.n2));this.GC.incrementCounter(Ec.ARg);this.n2=Vb.currentVersion;this.baseVersionInfo=Vb.baseVersion;this.Hhf=Vb.noBaseToCompareTo;this.Uma&&this.XAj()&&(this.gGd(Vb.currentVersion),sb.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};Ec.prototype.XAj=function(){sb.ULS.sendTraceTag(537150343,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?Ec.VD(this.baseVersionInfo):"");if(Ec.VD(this.n2)===this.rLe)return sb.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(lf.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.Hhf)return sb.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),
!0;if(!this.baseVersionInfo)return sb.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var Vb=Ec.Dyh(this.baseVersionInfo);sb.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",Vb?Vb.length:0);return Da.a.ma(Vb)?(sb.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1):!0};Ec.prototype.Zlf=function(Vb){sb.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",
Vb&&Vb.versionSelected?Ec.VD(Vb.versionSelected.currentVersion):null,Vb&&Vb.updatedVersions?Vb.updatedVersions.length:0,Ec.VD(this.n2));this.GC.incrementCounter(Ec.zRg);if(this.baseVersionInfo){if(Vb&&Vb.updatedVersions&&2<=Vb.updatedVersions.length){var Qc=null,md=null,Ce=Ec.VD(this.n2),le=Ec.VD(this.baseVersionInfo);Vb=Ol(Vb.updatedVersions);for(var Zd=Vb.next();!Zd.done;Zd=Vb.next()){Zd=Zd.value;var fg=Ec.VD(Zd);Ce===fg?Qc=Zd:le===fg&&(md=Zd);if(Qc&&md)break}Qc&&md?(this.n2=Qc,this.baseVersionInfo=
md,sb.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ec.VD(this.n2),Ec.VD(this.baseVersionInfo)),this.gGd(this.n2)):sb.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ce,le)}else sb.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
sb.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else sb.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};Ec.prototype.tRf=function(){return!this.$.Q$};Ec.prototype.blf=function(){sb.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");this.CMg();var Vb=new fe.a(1470556788,0,this.$.dd,0,null);this.$.Ka.Ub(Vb)};Ec.prototype.CMg=function(){document.getElementById(this.t4b).style.display=
"none";var Vb=new fe.a(-1423792966,0,this.$.dd,0,null);this.$.Ka.Ub(Vb);this.rqe()};Ec.prototype.rqe=function(){this.GC&&(this.GC.endTimer(Ec.YYf),this.Ioe(this.GC),this.GC=null);this.$l();this.dQd();this.perfTelemetryInfos&&(sb.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.OA&&(this.OA.Kma(Id.a.DRa),this.OA.Kma(Id.a.ERa),this.OA.Kma(Ta.a.setCurrentChangeCount),this.OA.Kma(Ta.a.setTotalChangesCount),lf.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.OA.Kma(Ta.a.GMa),this.OA.dispose(),this.OA=null)};Ec.prototype.Grf=function(Vb){sb.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var Qc=new fe.a(-1244760097,0,this.$.dd,0,null);this.$.Qf.get(51)&&(sb.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Qc=new fe.a(-309686558,0,this.$.dd,0,null));cb.c(1604651619,!0);var md={};this.$.Ka.Ub(Qc,(md.FileDownloadUrl=Vb,md))};Ec.prototype.$lf=function(Vb){sb.ULS.sendTraceTag(537150300,
0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");Vb=new Vd.QueryStringBuilder(Vb);Vb.Xj("fn",Db.AFrameworkApplication.fileName);sb.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+Vb.toString().length);8===this.$.frame.M5a(Vb.toString(),!0)?(sb.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),cb.c(1316171850,!1)):cb.c(1316171850,!0)};Ec.prototype.Gjf=function(Vb){this.am.setFullAppErrorCode(Vb)};Ec.prototype.MYi=
function(Vb){var Qc=this;try{this.Uma?Jb.setIsPageLoadForFirstTime(!1):(Jb.setIsPageLoadForFirstTime(!0),hd.a(function(){var md=new Ia;md.ulsLogger=new Pc.a;md.actionUrl=Qc.$.ya.VersionHistoryActionUrl;md.hideEmbedFooter=!0;md.useFetch=lf.EwaSettings.ka(432)&&!rd.a.pu;Qc.Uma=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object.assign(new Aa,{appBootSettings:md,rootDiv:Vb}))}))}catch(md){sb.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",
md)}};Ec.prototype.gGd=function(Vb){sb.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",Ec.VD(Vb),this.vxb);if(Vb)if(Ec.VD(Vb).length){var Qc=(new Date).getTime();if(Ec.VD(Vb)===this.vxb&&1E3>Qc-this.cmd)sb.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{Ec.VD(Vb)!==this.vxb&&(sb.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),
this.am.setTotalChangesCount(-1),this.am.setCurrentChangeCount(-1));var md=excelVersionHistory.FactoryGlobal.getTelemetryCollector();md.addEvent("SelectVersion",Ec.VD(Vb));try{this.uDj(md);this.cmd=Qc;this.vxb=Ec.VD(Vb);var Ce=new Zb;Ce.selectedVersionInfo=this.n2;Ce.baseVersionInfo=this.baseVersionInfo;Ce.telemetryCollector=md;this.Uma.onVersionSelectedWithParams(Ce);this.am&&lf.EwaSettings.ka(368)&&this.am.setDisableSaveACopy(this.tRf());var le=document.getElementById(Ec.Qih);le&&!this.OA&&(sb.ULS.sendTraceTag(537150293,
0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.OA=new Ta.a(le.contentWindow,sa.a.k$(this.$.ya.VersionHistoryActionUrl)||Rc.a.x8),this.OA.xm(Id.a.DRa,Object(fb.a)(this,this.nDb,"receivePostMessageFromVHSession")),this.OA.xm(Id.a.ERa,Object(fb.a)(this,this.nDb,"receivePostMessageFromVHSession")),this.OA.En(Ta.a.setCurrentChangeCount),this.OA.En(Ta.a.setTotalChangesCount),lf.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.OA.En(Ta.a.GMa),this.OA.xm(Ta.a.setCurrentChangeCount,Object(fb.a)(this,this.nDb,"receivePostMessageFromVHSession")),this.OA.xm(Ta.a.setTotalChangesCount,Object(fb.a)(this,this.nDb,"receivePostMessageFromVHSession")),lf.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.OA.xm(Ta.a.GMa,Object(fb.a)(this,this.nDb,"receivePostMessageFromVHSession")))}catch(Zd){this.cmd=0,this.vxb="",md.addEvent("Exception",Zd.toString()),sb.ULS.sendTraceTag(42016832,
0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",Zd)}finally{sb.ULS.sendTraceTag(537150292,0,50,md?md.getJsonForLogging():"")}}}else sb.ULS.sendTraceTag(537150296,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else sb.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};Ec.prototype.uDj=function(Vb){for(var Qc=Ol(this.perfTelemetryInfos),md=Qc.next();!md.done;md=Qc.next()){var Ce=md.value;
md=Ce.TelemetryEventKey?Ce.TelemetryEventKey:Ce.telemetryEventKey?Ce.telemetryEventKey:"";Ce=Ce.TelemetryEventData?Ce.TelemetryEventData:Ce.telemetryEventData?Ce.telemetryEventData:"";md&&Ce&&Vb.addEvent(md,Ce)}Array.clear(this.perfTelemetryInfos)};Ec.prototype.inf=function(Vb){switch(Vb){case 101:Vb="VHFailedToGetDownloadToken";break;case 100:Vb="VHFailedToLoadVersionList";break;case 104:Vb="VHVersioningNotEnabled";break;case 105:Vb="VHFileNotFound";break;case 106:Vb="VHVersionTooOld";break;default:Vb=
"None"}this.GC.addEvent("OnFullAppError",Vb);sb.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",Vb)};Ec.prototype.Ioe=function(Vb){sb.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",Vb?Vb.getJsonForLogging():"")};Ec.prototype.dci=function(){for(var Vb=this.$.fa.tm,Qc={},md=null,Ce=Ol(Vb),le=Ce.next();!le.done;le=Ce.next())le=le.value,le.UserEmail&&(Qc[le.UserEmail]=le.UserEmail in Qc?Qc[le.UserEmail]+1:1),le.User.UserID===this.$.fa.clientId&&(md=
le.UserEmail);sb.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",Vb.length,md?Qc[md]:-1)};Ec.prototype.Mud=function(Vb){this.qxe=Vb;sb.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",Vb.toString());var Qc={};this.AGd(Ta.a.mJb,(Qc.ToggleValue=Vb,Qc))};Ec.prototype.wof=function(Vb){sb.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",
Vb);cb.c(1488635506,!0);var Qc={};Vb?this.AGd(Ta.a.iterateNext,Qc):this.AGd(Ta.a.qva,Qc)};Ec.prototype.nDb=function(Vb){switch(Vb.MessageId){case Id.a.DRa:sb.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");lf.EwaSettings.ka(440)&&this.am.setVersionLoadComplete();break;case Id.a.ERa:sb.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case Ta.a.setCurrentChangeCount:Vb=Vb.Values.count;
sb.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",Vb);this.am.setCurrentChangeCount(Vb);break;case Ta.a.setTotalChangesCount:Vb=Vb.Values.count;sb.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",Vb);this.am.setTotalChangesCount(Vb);break;case Ta.a.GMa:this.Mud(this.qxe);break;default:sb.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",
Vb.MessageId)}};Ec.prototype.AGd=function(Vb,Qc){sb.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",Vb);if(this.OA){Vb=new He.a(Vb);Vb.Values[Nd.a.q_c]=this.$.ya.UserSessionId;if(Qc)for(var md in Qc)Vb.Values[md]=Qc[md];this.OA.send(Vb)}else sb.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};Ec.VD=function(Vb){return Vb?Vb.RevisionID?Vb.RevisionID:Vb.revisionID?
Vb.revisionID:"":""};Ec.Dyh=function(Vb){return Vb?Vb.DownloadUrl?Vb.DownloadUrl:Vb.downloadUrl?Vb.downloadUrl:"":""};Ec.Rih="_excelVersionHistoryOverlay";Ec.Qih="vhs_frame";Ec.VYf="TimeTakenShowVersionHistoryDialogAction";Ec.YYf="TimeTillVersionHistoryDialogWasOpenMs";Ec.gOd="TimeTakenGetVersionsToOnVersionsReady";Ec.ARg="CountOnVersionSelectedCalledinOneVHSession";Ec.BRg="CountOnVersionsReadyCalledinOneVHSession";Ec.zRg="CountOnDownloadTokenReadyCalledinOneVHSession";Ec.WYf="TimeTakenVersionRestore";
Object(Hb.a)(Ec,"VersionHistoryPaneActor",null,[6]);var ld=b(332),Wd=vb.a;Em(lc,Wd);lc.prototype.Gd=function(){var Vb=this,Qc=this.tbi(),md=Lb.GetServiceTaskFactory.Va(this.$.ea,21,137,this.rb,"Postmessage.IHostPostmessenger");rc.TaskExtensions.Aa(rc.TaskExtensions.xe([Qc,md],this.la,3),function(){var Ce=md.result,le=sa.a.k$(Vb.$.ya.VersionHistoryActionUrl);le!==Rc.a.x8&&Ce.CDa(le);Ce=new Ec(Vb.$);Vb.Ad([new Ua(Vb.$,Ce)])},this.la,3)};lc.prototype.tbi=function(){var Vb=Lb.GetServiceTaskFactory.J$c(this.$.ea,
this.rb).then(function(Qc){return Qc.Cp.loadScript("excelVersionHistory")},function(Qc){sb.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",Qc);return Promise.reject(Qc)});return ld.c(Vb)};lc.ja=function(Vb){vb.a.Yd(304,new lc(Vb))};Object(Hb.a)(lc,"VersionHistoryCommandHandlerFactory",vb.a,[]);var ee=b(1238),ne=jc.a;Em(P,ne);P.prototype.create=function(){var Vb=this,Qc=Lb.GetServiceTaskFactory.Va(this.$.ea,211,212,this.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),
md=Lb.GetServiceTaskFactory.Va(this.$.ea,21,137,this.rb,"Postmessage.IHostPostmessenger");rc.TaskExtensions.Aa(rc.TaskExtensions.xe([Qc,md],this.$.la),function(){Vb.Eb(Vb.$.ea.Ba(305)||new ee.a(Vb.$,!0,md.result,Qc.result))},this.$.la,3)};P.ja=function(Vb){Vb.ea.Ia(306,new P(Vb))};Object(Hb.a)(P,"VersionHistoryHighlightManagerFactory",jc.a,[]);var Ad=b(509),se=b(4),Ve=b(162),Zf=b(16),Pf=Qa.a;Em(uc,Pf);uc.prototype.execute=function(Vb){this.lineageManager.lineageHidePreviousHistory();return Pf.prototype.execute.call(this,
Vb)};Object(Hb.a)(uc,"LineageClearHistoryConfirmedActivity",Qa.a,[]);var Fe=b(17),me=b(130);zb.prototype.Wc=function(){return!1};zb.prototype.executeCommand=function(Vb,Qc,md){Vb=!1;switch(Qc.command){case 1834994092:9===Qc.Ze&&this.Cnj();this.Jfj(Qc,md);Vb=!0;break;case -409942531:this.Mfj(),Vb=!0}return Vb?hc.Task.Ra(!0):Oc.a(Qc.command)};zb.prototype.Ec=function(Vb,Qc){return 1834994092===Qc.command||-409942531===Qc.command};zb.prototype.Yc=function(){return!1};zb.prototype.Jfj=function(Vb,Qc){sb.ULS.sendTraceTag(537155483,
0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",Qc.MenuItemId||Vb.Ze);this.lineageManager.nTf(19===Vb.Ze&&!!Qc.MenuItemId,Qc.MenuItemId,Vb.Ze)};zb.prototype.Cnj=function(){var Vb=se.a.Plc;Vb!==Ve.a(this.$).tn.eo&&Ve.a(this.$).tn.activateRibbonTab(Vb)};zb.prototype.Mfj=function(){var Vb=this;fc.a(this.$).zs(new Ib.a(Lc.a.Kmd,5,function(){var Qc=xc.a(Vb.$).fd,md=Ee.a.gd(3,1,2134,2135,2136,1038647878,"LineageConfirmClearHistory");md.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";
md.HelpDescription=Zf.a.instance.da(1254);Qc.Ss([md])}))};Object(Hb.a)(zb,"LineageActivityCommandHandler",null,[160]);var ng=vb.a;Em(oc,ng);oc.prototype.Gd=function(){var Vb=this;rc.TaskExtensions.Aa(Lb.GetServiceTaskFactory.Va(this.$.ea,366,367,this.rb,"Microsoft.Office.Excel.WebUI.Client.ILineageManager"),function(Qc){Vb.Ad([new zb(Vb.$,Qc.result)])},this.la,3)};oc.ja=function(Vb){vb.a.Yd(363,new oc(Vb))};Object(Hb.a)(oc,"LineageActivityCommandHandlerFactory",vb.a,[]);Yb.prototype.z3a=function(){return!this.nab};
Yb.E3e=function(){return Yb.x3e()&&lf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",!1)};Yb.x3e=function(){return lf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(Hb.a)(Yb,"LineageCatchUpExperimentManager",null,[541]);var Oe=jc.a;Em(Ra,Oe);Ra.prototype.create=function(){var Vb=this;Yb.E3e()?rc.TaskExtensions.Aa(Lb.GetServiceTaskFactory.Va(this.$.ea,456,457,this.rb,
"Microsoft.Office.Excel.WebUI.Client.Callouts.ILineageDiscoverabilityCallout"),function(Qc){rc.TaskExtensions.Aa(Qc.result.oej(),function(md){Vb.sve(md.result)},Vb.$.la,3)},this.$.la,3):this.sve(!0)};Ra.prototype.sve=function(Vb){this.Eb(this.$.ea.Ba(458)||this.$.ea.Ia(458,new Yb(Vb)))};Ra.ja=function(Vb){Vb.ea.Ia(459,new Ra(Vb))};Object(Hb.a)(Ra,"LineageCatchUpExperimentManagerFactory",jc.a,[]);var bd=b(404),ac=b(44),Fc=b(88),Zc=b(144),pd=b(116);Object(Hb.a)(Wa,"LineageClientParams",null,[]);Object(Hb.a)(lb,
"LineageFilter",null,[]);var bf=b(60),Bd=b(79),Qe=b(125),Ob=b(46),yc=b(514),id=b(161),Tc=b(126),od=b(107),mc=b(303),Le=b(275),we=b(105),za=b(20),Nb=b(127),bb=b(81),Ub=b(49),kc=b(337);Object(Hb.a)(kb,"LineageActivitiesResponseDTO",null,[]);Em(Na,kb);Object(Hb.a)(Na,"LineageActivitiesUpdateResponseDTO",kb,[]);Object(Hb.a)(db,"LineageAppCallbacks",null,[]);Object(Hb.a)(eb,"LineageAuthorDTO",null,[]);Object(Hb.a)(Fa,"LineageControllerFactoryParams",null,[]);Object(Hb.a)(Ga,"LineageSharedRangeDTO",null,
[]);Object(Hb.a)(Ha,"LineageSheetMultiRangeDTO",null,[]);Object(Hb.a)(mb,"LineageUserActivityDTO",null,[]);Object(Hb.a)(Ka,"LineageValueChangeDTO",null,[]);ta.prototype.dispose=function(){this.mSi();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.UM(Object(fb.a)(this,this.onPaneClosed,"onPaneClosed")),this.lineageTaskPane.AC(Object(fb.a)(this,this.Dy,"onPaneVisibilityChanged")),this.lineageTaskPane=null);this.xHb=this.tlc=this.yqb=this.Jmd=this.jE=null};ta.prototype.nTf=function(Vb,Qc,md){if(this.lineageTaskPane.isVisible){if(9===
md){sb.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!Vb&&(!lf.EwaSettings.isChangeGateEnabled("OfficeVSO:5554950_interactiveElement")||16!==md&&18!==md)){this.lineageTaskPane.wWc();return}}ac.a.Jd(this.$)&&lf.EwaSettings.isChangeGateEnabled("OfficeVSO:5645904_LineageWacTaskPaneInfraOpenPaneFlow")||(this.xHb.start(),this.a6&&(Ub.b().iB(this.xHb.id,this.a6.id,"actions","actions"),this.a6.stop(),this.a6=null));this.lineageTaskPane.hcc||
sb.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",Vb?Qc:md);this.eD=this.$.fa.vf;this.yqb=null;Vb&&(Vb=Ob.r(this.gridView.ga.wa.selectedRanges,this.$),this.yqb=Object.assign(new Ha,{rangeList:Qc.toString()===se.a.KSf?this.Gsb(Vb.Ranges):null,sheetName:Vb.SheetName}));ac.a.Jd(this.$)&&lf.EwaSettings.isChangeGateEnabled("OfficeVSO:5645904_LineageWacTaskPaneInfraOpenPaneFlow")&&this.lineageTaskPane.hcc?this.lineageTaskPane.L8i(Object(fb.a)(this,this.yAb,
"onLineagePaneOpened")):this.jE.createLineagePane(this.Jmd,this.yqb);this.lineageTaskPane.Hf(!0);this.$.De(-71295319,-1,0,null)};ta.prototype.yAb=function(){this.a6&&(this.a6.stop(),this.a6=null);this.xHb.start();this.jE.createLineagePane(this.Jmd,this.yqb)};ta.prototype.lineageHidePreviousHistory=function(){function Vb(Ce,le,Zd){var fg=Qc.$.ra.ua,Kg=fg.Na(1,null);return bb.i(fg,"LineageHidePreviousHistory",Kg,Ce,le,Zd,null,0)}var Qc=this,md={};md=(md.paneVisible=this.lineageTaskPane.isVisible,md);
Zc.a.sendTelemetryEvent(Object.assign(new kc.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:pd.a.fy(md)}));lf.EwaSettings.pc()?this.$.userOperationManager.jc(new id.a(1018,0,Vb,64),null):this.$.userOperationManager.jc(new yc.a(1018,0,Vb,0),null);this.lineageTaskPane.isVisible||this.nTf(!1,null,4)};ta.prototype.mWh=function(){var Vb=this,Qc=Object.assign(new db,{tryParseRangeInfo:Object(fb.a)(this,this.tryParseRangeInfo,"tryParseRangeInfo"),isFeatureEnabled:Object(fb.a)(this,
this.isFeatureEnabled,"isFeatureEnabled"),onCardSelected:Object(fb.a)(this,this.onCardSelected,"onCardSelected"),onVersionHistoryButtonClicked:Object(fb.a)(this,this.onVersionHistoryButtonClicked,"onVersionHistoryButtonClicked"),onRangeFilterInputEnabled:Object(fb.a)(this,this.onRangeFilterInputEnabled,"onRangeFilterInputEnabled"),onLearnMoreLinkClicked:Object(fb.a)(this,this.onLearnMoreLinkClicked,"onLearnMoreLinkClicked"),lineageOpenPaneOrChangeFilterRequest:Object(fb.a)(this,this.lineageOpenPaneOrChangeFilterRequest,
"lineageOpenPaneOrChangeFilterRequest"),lineageLoadMoreRequest:Object(fb.a)(this,this.lineageLoadMoreRequest,"lineageLoadMoreRequest"),lineageRefreshViewRequest:Object(fb.a)(this,this.lineageRefreshViewRequest,"lineageRefreshViewRequest"),lineageUpdateViewRequest:Object(fb.a)(this,this.lineageUpdateViewRequest,"lineageUpdateViewRequest")});hd.a(function(){Vb.jE=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object.assign(new Fa,{clientBatchSize:Vb.batchSize,filterableSheetList:Vb.m1a(),
uiCulture:Vb.$.ya.UICultureTag,dataCulture:Vb.$.ya.DataCultureTag,logger:new Pc.a,lineageAppCallbacks:Qc}))})};ta.prototype.lineageOpenPaneOrChangeFilterRequest=function(Vb,Qc){function md(Kg,$g,pa){var tb=le.$.ra.ua,qc=fg;Kg=Le.b(Kg,le.m$c("LineageOpenPaneOrChangeFilter"));$g=Le.a($g,Ce);var jd=tb.Na(1,null);jd.clientParams=Zd;jd.lineageFilter=qc;return bb.i(tb,"LineageOpenPaneOrChangeFilter",jd,Kg,$g,pa,null,0)}function Ce(Kg){Kg=Tc.a.xg(Kg.data);sb.ULS.sendTraceTag(537155481,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",
Ee.a.Uc(Kg))}var le=this;this.xHb.stop();Nb.b(this.$).ee(Qe.a.Bvi,{});this.eij();var Zd=Object.assign(new Wa,{ClientViewCapacity:Vb.clientViewCapacity}),fg=null;Qc&&(fg=Object.assign(new lb,{FilterSheetMultiRange:this.Xrj(Qc.filterSheetMultiRange)}));lf.EwaSettings.pc()?this.$.userOperationManager.jc(new id.a(1010,0,md,80),null):this.$.userOperationManager.jc(new yc.a(1010,0,md,16),null)};ta.prototype.lineageLoadMoreRequest=function(Vb){function Qc(le,Zd,fg){var Kg=Ce.$.ra.ua;le=Le.b(le,Ce.m$c("LineageLoadMore"));
Zd=Le.a(Zd,md);var $g=Kg.Na(1,null);$g.fetchFromBelow=Vb;return bb.i(Kg,"LineageLoadMore",$g,le,Zd,fg,null,0)}function md(le){le=Tc.a.xg(le.data);sb.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Ee.a.Uc(le))}var Ce=this;Nb.b(this.$).ee(Qe.a.Avi,{});lf.EwaSettings.pc()?this.$.userOperationManager.jc(new id.a(1011,0,Qc,80),null):this.$.userOperationManager.jc(new yc.a(1011,0,Qc,16),null)};ta.prototype.lineageRefreshViewRequest=function(){function Vb(Ce,
le,Zd){var fg=md.$.ra.ua;Ce=Le.b(Ce,md.m$c("LineageRefreshView"));le=Le.a(le,Qc);var Kg=fg.Na(1,null);return bb.i(fg,"LineageRefreshView",Kg,Ce,le,Zd,null,0)}function Qc(Ce){Ce=Tc.a.xg(Ce.data);sb.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Ee.a.Uc(Ce))}var md=this;Nb.b(this.$).ee(Qe.a.Cvi,{});lf.EwaSettings.pc()?this.$.userOperationManager.jc(new id.a(1012,0,Vb,80),null):this.$.userOperationManager.jc(new yc.a(1012,0,Vb,16),null)};ta.prototype.m$c=
function(Vb){var Qc=this;return function(md){if(md=mc.a(md)?null:md.Result){var Ce={};Ce=(Ce.CountOfActivities=md.ActivityList.length,Ce);Ce.WebRequestName=Vb;Nb.b(Qc.$).ee(Qe.a.jti,Ce);md=Object.assign(new kb,{activityList:Qc.tyd(md.ActivityList),latestActivityId:md.LastSearchedActivityId,oldestActivityId:md.FirstSearchedActivityId,serverMessageCode:md.LineageResponseCode,lastSearchedActivityTimestamp:new Date(md.EcmaLastSearchedDate),serverFirstActivityId:md.ServerFirstActivityId,serverLastActivityId:md.ServerLastActivityId,
showLoadPrevious:md.ShowLoadPrevious,eolCorrelationId:md.EolCorrelationId,eolDateHideHistory:new Date(md.EolDateHideHistory),eolPersonHideHistory:Qc.Bsb(md.EolPersonHideHistory)});Qc.jE.onLineageActivitiesResponse(md)}else sb.ULS.shipAssertTag(537155477,0,!!md,"LineageManager."+Vb+" returned null response.")}};ta.prototype.lineageUpdateViewRequest=function(){var Vb=this;ha(this.$.ra.ua,function(Qc){if(Qc=mc.a(Qc)?null:Qc.Result){var md={};md=(md.CountOfUpdatedActivities=Qc.LineageActivitiesResponse.ActivityList.length,
md);Nb.b(Vb.$).ee(Qe.a.Dvi,md);Qc=Object.assign(new Na,{activityList:Vb.tyd(Qc.LineageActivitiesResponse.ActivityList),latestActivityId:Qc.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:Qc.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:Qc.LineageActivitiesResponse.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Qc.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:Qc.HasNewActivities,filterSheetMultiRange:Vb.Nrj(Qc.LineageActivitiesResponse.FilterSheetMultiRange),
serverFirstActivityId:Qc.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:Qc.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:Qc.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:Qc.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(Qc.LineageActivitiesResponse.EolDateHideHistory),eolPersonHideHistory:Vb.Bsb(Qc.LineageActivitiesResponse.EolPersonHideHistory)});Vb.jE.onLineageActivitiesUpdateResponse(Qc)}else sb.ULS.shipAssertTag(537155475,
0,!!Qc,"LineageManager.LineageUpdateView returned null response.")},function(Qc){Qc=Tc.a.xg(Qc.data);sb.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Ee.a.Uc(Qc))},null,null)};ta.prototype.Nrj=function(Vb){return od.e(Vb.Ranges)&&Da.a.ma(Vb.SheetName)?null:Object.assign(new Ha,{rangeList:this.Gsb(Vb.Ranges),sheetName:Vb.SheetName})};ta.prototype.Gsb=function(Vb){var Qc=[];Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next())md=md.value,md=Object.assign(new Ga,
{firstCol:md.FirstColumn,firstRow:md.FirstRow,lastRow:md.LastRow,lastCol:md.LastColumn}),Qc.push(md);return Qc};ta.prototype.Xrj=function(Vb){if(!Vb)return null;var Qc={};Qc.Ranges=this.iad(Vb.rangeList);Qc.SheetName=Vb.sheetName;return Qc};ta.prototype.iad=function(Vb){var Qc=[];if(od.e(Vb))return Qc;Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next()){md=md.value;var Ce={};Ce.FirstColumn=md.firstCol;Ce.FirstRow=md.firstRow;Ce.LastRow=md.lastRow;Ce.LastColumn=md.lastCol;Qc.push(Ce)}return Qc};ta.prototype.onCardSelected=
function(Vb,Qc){if(Vb=Vb.rangeHighlightLocation){if(Qc){var md=Ob.Y(Qc,null);var Ce=md.range;if(md.returnValue){this.r_e(Vb.sheetName,this.Gsb([Ob.j(Ce)]));return}sb.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+Qc+" is not valid.")}Vb.rangeList.length?this.r_e(Vb.sheetName,Vb.rangeList):this.TRh(Vb.sheetName)}};ta.prototype.TRh=function(Vb){(Vb=this.$.va.getItemByName(Vb))&&Vb.visible&&Vb.activate(!0)};ta.prototype.r_e=function(Vb,Qc){var md=[];Qc=Ol(Qc);for(var Ce=Qc.next();!Ce.done;Ce=
Qc.next()){Ce=Ce.value;var le={};le.FirstColumn=Ce.firstCol;le.FirstRow=Ce.firstRow;le.LastRow=Ce.lastRow;le.LastColumn=Ce.lastCol;md.push(Ob.D(le))}Qc=md.length-1;Ce=md[Qc].topLeft;za.g(this.$).YT(md,Qc,Vb,null,Ce,null,null,3,we.a.xai,void 0,void 0,void 0,!0)};ta.prototype.onLearnMoreLinkClicked=function(){if(lf.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var Vb=new fe.a(-859308420,Bd.a.Tb,this.$.dd,12,null),Qc={};Qc=(Qc.CommandValueId="HelpID=XLO_LineageTS",
Qc.InputMethod=Bd.a.Tb,Qc.MenuItemId=se.a.AY,Qc.ShouldCanvasTakeFocus=!0,Qc);this.$.Ka.Ub(Vb,Qc)}};ta.prototype.onVersionHistoryButtonClicked=function(Vb){this.$.Ka.Ub(new fe.a(-1112508866,Vb,this.$.dd,12,null))};ta.prototype.isFeatureEnabled=function(Vb){switch(Vb){case "LogAggregatedEventsToOtel":return lf.EwaSettings.isChangeGateEnabled("OfficeVSO:5842255_LogAggregatedEventsToOtel");default:return!1}};ta.prototype.CPi=function(){this.jE&&this.lineageTaskPane.isVisible&&(this.eD=this.$.fa.vf,this.jE.onRefreshRequired())};
ta.prototype.Gf=function(){var Vb=this.$.fa.qn.LineageVersion;Vb!==this.Omd&&(sb.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",Vb,this.Omd),this.Omd=Vb,this.CPi())};ta.prototype.zog=function(){this.lineageTaskPane.$K(Object(fb.a)(this,this.onPaneClosed,"onPaneClosed"));this.lineageTaskPane.kB(Object(fb.a)(this,this.Dy,"onPaneVisibilityChanged"));this.$.fa.Vs(Object(fb.a)(this,this.Gf,"onWorkbookMetadataChanged"));this.$.fa.Yj(Object(fb.a)(this,
this.Vc,"onSessionIdChanged"));this.$.fa.nO(Object(fb.a)(this,this.gq,"onLoadOnDemandOccurred"));var Vb=this.$.va;Vb.oX(Object(fb.a)(this,this.hC,"onSheetDeleted"));Vb.pfa(Object(fb.a)(this,this.njc,"onSheetAddedOrVisibilityChanged"));Vb.MDa(Object(fb.a)(this,this.Owa,"onSheetRenamed"));Vb.VVa(Object(fb.a)(this,this.njc,"onSheetAddedOrVisibilityChanged"))};ta.prototype.mSi=function(){this.$.fa.Qv(Object(fb.a)(this,this.Gf,"onWorkbookMetadataChanged"));this.gridView.ga.Nba(Object(fb.a)(this,this.$c,
"onSelectionChanged"));this.$.fa.qk(Object(fb.a)(this,this.Vc,"onSessionIdChanged"));this.$.fa.tV(Object(fb.a)(this,this.gq,"onLoadOnDemandOccurred"));var Vb=this.$.va;Vb.K5(Object(fb.a)(this,this.hC,"onSheetDeleted"));Vb.Yka(Object(fb.a)(this,this.njc,"onSheetAddedOrVisibilityChanged"));Vb.ZNa(Object(fb.a)(this,this.Owa,"onSheetRenamed"));Vb.hEb(Object(fb.a)(this,this.njc,"onSheetAddedOrVisibilityChanged"))};ta.prototype.onStaleActivitiesDetected=function(){this.jE.onStaleActivitiesDetected()};ta.prototype.Vc=
function(Vb,Qc){this.jE&&!this.lineageTaskPane.hcc&&Qc.AG&&(sb.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),this.onStaleActivitiesDetected())};ta.prototype.gq=function(){this.jE&&!this.lineageTaskPane.hcc&&(sb.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),this.onStaleActivitiesDetected())};ta.prototype.hC=function(){var Vb=this.m1a();this.jE.onFilterableSheetListChange(Vb)};ta.prototype.Owa=function(){var Vb=this.m1a();this.jE.onFilterableSheetListChange(Vb)};
ta.prototype.njc=function(){var Vb=this.m1a();this.jE.onFilterableSheetListChange(Vb)};ta.prototype.m1a=function(){for(var Vb=[],Qc=Ol(this.$.va.items),md=Qc.next();!md.done;md=Qc.next())md=md.value,md.visible&&!bf.e(md)&&Vb.push(md.sheetName);return Vb};ta.prototype.onPaneClosed=function(){this.jE.onPaneClosed();Tb(this.$.ra.ua,null,function(Vb){Vb=Tc.a.xg(Vb.data);sb.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",Ee.a.Uc(Vb))},null,
null)};ta.prototype.onRangeFilterInputEnabled=function(Vb){Vb?this.gridView.ga.o1(Object(fb.a)(this,this.$c,"onSelectionChanged")):this.gridView.ga.Nba(Object(fb.a)(this,this.$c,"onSelectionChanged"))};ta.prototype.$c=function(){var Vb=Ob.q(this.gridView.ga.wa.activeRange,this.$);Vb=Object.assign(new Ha,{rangeList:this.Gsb(Vb.Ranges),sheetName:Vb.SheetName});this.jE.onSelectedRangeUpdated(Vb)};ta.prototype.tryParseRangeInfo=function(Vb){var Qc=Ob.Y(Vb,this.$.va);var md=Qc.sheetName;Vb=Qc.range;return Qc.returnValue?
(md||(md=this.$.va.qa.sheetName),Qc=[],Qc.push(Vb),Vb=Ob.u(md,null,Qc),Object.assign(new Ha,{rangeList:this.Gsb(Vb.Ranges),sheetName:Vb.SheetName})):null};ta.prototype.Dy=function(){var Vb=this.eD!==this.$.fa.vf;this.jE&&this.lineageTaskPane.isVisible&&Vb&&(this.eD=this.$.fa.vf,this.jE.onRefreshRequired())};ta.prototype.eij=function(){if(lf.EwaSettings.ka(648)){var Vb=this.$.ea.Ba(403);Vb&&Vb.disable();Vb=new fe.a(-847286761,Bd.a.Tb,this.$.dd,0,se.a.AQ);var Qc={};Qc=(Qc.InputMethod=Bd.a.Tb,Qc);Qc.CalloutName=
5;this.$.Ka.Ub(Vb,Qc)}};ta.prototype.tyd=function(Vb){var Qc=[];Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next())md=md.value,md=Object.assign(new mb,{activityId:Number.parseLocale(md.UserActivity.Id),activityGuid:md.Uid,activityType:md.UserActivity.Type,author:this.Bsb(md.UserActivity.Person),sheetName:md.SheetName,displayTimestamp:new Date(md.UserActivity.DisplayTimestamp),gridLocation:md.DisplayLocation,valueChanges:this.XJi(md.LineageValueChangeList),isBulkEditOverflow:md.IsBulkEditOverFlow,
rangeHighlightLocation:this.LJi(md.UserActivity.LocationList,md.UserActivity.Type),nestedActivityList:this.EJi(md.NestedActivityList),degradedCardTypeBits:md.DegradedCardTypeBits}),Qc.push(md);return Qc};ta.prototype.LJi=function(Vb,Qc){if(!Vb)return sb.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!Vb.length)return sb.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var md=
[],Ce=[],le="";21===Qc?Ce.push(Vb[0]):Ce=Vb;Vb=Ol(Ce);for(Ce=Vb.next();!Ce.done;Ce=Vb.next())switch(Ce=Ce.value,Ce.Type){case 1:break;case 2:le=Ce.SheetName;break;case 0:if(!Ce.RangeList){sb.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}le=Ce.RangeList[0].SheetName;var Zd=[];21===Qc?Zd.push(Ce.RangeList[0]):Zd=Ce.RangeList;Ce=Ol(Zd);for(Zd=Ce.next();!Zd.done;Zd=Ce.next())Zd=Zd.value,Zd=Object.assign(new Ga,{firstCol:Zd.FirstColumn,firstRow:Zd.FirstRow,
lastRow:Zd.LastRow,lastCol:Zd.LastColumn}),md.push(Zd);break;default:sb.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Ce.Type)}return Object.assign(new Ha,{sheetName:le,rangeList:md})};ta.prototype.XJi=function(Vb){var Qc=[];Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next())md=md.value,md=Object.assign(new Ka,{hasNewValue:md.HasNewValue,hasOldValue:md.HasOldValue,newValue:md.HasNewValue?md.NewValue:null,oldValue:md.HasOldValue?md.OldValue:
null,cellLocation:md.CellLocation}),Qc.push(md);return Qc};ta.prototype.EJi=function(Vb){return Vb?this.tyd(Vb):null};ta.prototype.Bsb=function(Vb){if(!Vb)return null;var Qc=null;lf.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&Db.AFrameworkApplication.ha.sa("IsUserProfilePictureResolutionEnabled")&&(Qc=this.tlc.IFa(Vb.Email,Vb.Provider,Db.AFrameworkApplication.Xi,0));return Object.assign(new eb,{id:Vb.Id,provider:Vb.Provider,displayName:Vb.DisplayName,
email:Vb.Email,imageUrl:Qc})};Object(Hb.a)(ta,"LineageManager",null,[540,6]);var ad=jc.a;Em(ea,ad);ea.prototype.dbi=function(Vb){var Qc=this;rc.TaskExtensions.Aa(Vb,function(){Qc.Eb(Qc.$.ea.Ba(366)||new ta(Qc.$,Qc.$.ea,Qc.lineageTaskPane,Qc.a6))},this.$.la,3)};ea.prototype.create=function(){var Vb=this;this.a6=this.$.Vb.Dc("UserAction","LineagePaneSeenStopwatch");this.a6.start();var Qc=Lb.GetServiceTaskFactory.Va(this.$.ea,365,364,this.rb,"Microsoft.Office.Excel.WebUI.Client.ILineageTaskPane"),md=
bd.a(this.$),Ce=Lb.GetServiceTaskFactory.Va(this.$.ea,283,284,this.rb,"Common.IDynamicScriptLoaderProvider");rc.TaskExtensions.Aa(rc.TaskExtensions.xe([Qc,md,Ce],this.$.la),function(){Vb.lineageTaskPane=Qc.result;ac.a.Jd(Vb.$)||md.result.IP(Vb.lineageTaskPane);Vb.dbi(ld.c(Ce.result.Cp.loadScript("cellLineage")))},this.$.la,3)};ea.ja=function(Vb){Vb.ea.Ia(367,new ea(Vb))};Object(Hb.a)(ea,"LineageManagerFactory",jc.a,[]);var Qd=b(904),We=b(278),Ke=b(13),nf=b(117),Pe=b(277),hf=b(90),Vf=b(230),Sg=b(18),
wg=b(808),Ef=b(65),Fg=Vf.a;Em(ab,Fg);ab.prototype.EF=function(Vb){this.get_events().addHandler("LineageTaskPaneRemove",Vb)};ab.prototype.pH=function(Vb){this.get_events().removeHandler("LineageTaskPaneRemove",Vb)};ab.prototype.kB=function(Vb){this.addHandler("LineageTaskPaneVisibilityChanged",Vb)};ab.prototype.AC=function(Vb){this.removeHandler("LineageTaskPaneVisibilityChanged",Vb)};ab.prototype.$K=function(Vb){this.get_events().addHandler("LineageTaskPaneClose",Vb)};ab.prototype.UM=function(Vb){this.get_events().removeHandler("LineageTaskPaneClose",
Vb)};ab.prototype.Av=function(){};ab.prototype.FB=function(){};ab.prototype.Um=function(){return this.Po};ab.prototype.np=function(){return this.Po};ab.prototype.rE=function(){};ab.prototype.sG=function(){return!1};ab.prototype.Uh=function(){};ab.prototype.Nh=function(){};ab.prototype.dispose=function(){this.$&&(this.$.Lo(Object(fb.a)(this,this.Pd,"onWorkbookClosing")),kd.a(this.$).sA(this));this.he&&(We.a.instance.za(Ke.a.click,this.he,Object(fb.a)(this,this.Qj,"onClosePaneClick")),nf.KeyInputManager.instance.Mu(this.he,
this.tre));this.he=this.taskPaneManager=this.$=null;Fg.prototype.dispose.call(this)};ab.prototype.Le=function(Vb,Qc){if(!Qc){Vb=dc.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!Vb)return!1;dc.DOMElementExtensions.setFocus(Vb)}return!Qc};ab.prototype.rh=function(Vb){return dc.DOMElementExtensions.Ue(this.Ib,Vb)};ab.prototype.Hf=function(Vb){this.Po=Vb;var Qc=this.taskPaneManager;if(this.isVisible=Vb)this.$.frame.Me.Ej("LineagePane"),this.Xid=!1;if(ac.a.Jd(this.$))Vb?
Qc.uQ("LineageTaskPane",this.pK):Qc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.No();var md=!!this.taskPaneManager.wg&&15===this.taskPaneManager.wg.taskPane.qg;Vb&&0<Qc.Sy.length&&(!md||Qc.isCollapsed)&&Qc.FC(this,!0)}this.$.zf()};ab.prototype.pL=function(){var Vb=this.$.Jb;Vb=ac.a.Jd(this.$)?this.domElement:document.getElementById(Vb+se.a.Nmd);var Qc=this.RF();Vb.appendChild(Qc);Qc=wg.b("div","LineagePaneBodyId","LineageActivityBody");Vb.appendChild(Qc);this.M8i();return Qc};ab.prototype.wWc=
function(){this.$.frame.Me.Ej(this.$.frame.Me.BD||Pe.AFrame.uS);this.Xid=!0;this.Hf(!1);this.raiseEvent("LineageTaskPaneClose")};ab.prototype.L8i=function(Vb){this.yAb=Vb};ab.prototype.M8i=function(){this.$.frame.Me.Wj("LineagePane");var Vb=this.$.frame.Me.Th("LineagePane");Vb.parent=Pe.AFrame.uS;Vb.ZP=!0};ab.prototype.Pd=function(Vb,Qc){Qc.Rg||this.wWc()};ab.prototype.RF=function(){var Vb=wg.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),Qc=wg.b("h1","LineagePaneTitleId","cui-taskpane cui-taskPaneTitle LineageActivityPaneTitle");
Qc.innerText=this.titleText;this.he=Qd.a.Ab("LineagePaneCloseButtonId","StandardButton LineageActivityCloseButton",Zf.a.instance.da(10),"ClosePaneGlyph_16x16x32",!1);this.he.classList.add(Db.AFrameworkApplication.isRtl?se.a.W9:se.a.X9);We.a.instance.pa(Ke.a.click,this.he,Object(fb.a)(this,this.Qj,"onClosePaneClick"));this.tre=nf.KeyInputManager.instance.Cr(this.he,Object(fb.a)(this,this.Qj,"onClosePaneClick"),hf.a.Ph);Vb.appendChild(Qc);Vb.appendChild(this.he);return Vb};ab.prototype.Qj=function(){this.wWc();
return!0};ab.ja=function(Vb,Qc){var md=Vb.Jb,Ce=document.getElementById(md+se.a.Nmd);Ce||(Ce=document.createElement("div"),Ce.id=Vb.Jb+se.a.Nmd,Ce.classList.add("LineageActivityPane"),ac.a.Jd(Vb)||document.getElementById(md+se.a.lQ).appendChild(Ce));return Vb.ea.Ba(365)||Vb.ea.Ia(365,new ab(Ce,Vb,Qc))};Ll.Object.defineProperties(ab.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Ef.a)(ab.prototype,this,"isVisible")},set:function(Vb){Object(Ef.a)(ab.prototype,this,
"isVisible")!==Vb&&(Object(Ef.b)(ab.prototype,this,"isVisible",Vb),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},hcc:{configurable:!0,enumerable:!0,get:function(){return this.Xid}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},qg:{configurable:!0,enumerable:!0,get:function(){return 15}},Vd:{configurable:!0,enumerable:!0,get:function(){return ce.a.yai}},Nj:{configurable:!0,enumerable:!0,get:function(){return Sg.a.igh}},VB:{configurable:!0,enumerable:!0,
get:function(){return Zf.a.instance.da(1008)}},vl:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Ib:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.oK.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return Zf.a.instance.da(1229)}},pK:{configurable:!0,enumerable:!0,get:function(){var Vb=this;return this.taskPaneManager.bta(this.Ib,
this.titleText,this.vl,this.isResizable,function(){Vb.isVisible=!0;lf.EwaSettings.isChangeGateEnabled("OfficeVSO:5645904_LineageWacTaskPaneInfraOpenPaneFlow")&&(Vb.yAb?Vb.yAb():sb.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set."))},function(){Vb.isVisible=!1},function(){Vb.isVisible=!0},function(){Vb.isVisible=!1},this.vl)}}});Object(Hb.a)(ab,"LineageTaskPane",Vf.a,[539,6,342,120]);var xf=jc.a;Em(Ya,xf);Ya.prototype.create=function(){var Vb=this,Qc=Lb.GetServiceTaskFactory.create(this.$.ea,
203,this.la,this.rb,"System.IDisposable"),md=Lb.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary");rc.TaskExtensions.Aa(rc.TaskExtensions.ts(rc.TaskExtensions.xe([Qc,md],this.la),function(){return Vb.lC},this.la),function(){Vb.Eb(Vb.Ug)},this.la,3)};Ya.prototype.dispose=function(){this.Ug=this.fi=this.$=null;xf.prototype.dispose.call(this)};Ya.ja=function(Vb){Vb.ea.Ia(364,new Ya(Vb))};Ll.Object.defineProperties(Ya.prototype,{lC:{configurable:!0,enumerable:!0,get:function(){var Vb=
this;this.fi||(this.fi=rc.TaskExtensions.Aa(bd.a(this.$),function(Qc){Vb.Ug=ab.ja(Vb.$,Qc.result)},this.la,3));return this.fi}}});Object(Hb.a)(Ya,"LineageTaskPaneFactory",jc.a,[]);xb.prototype.dispose=function(){this.DBd();this.$=null;sb.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};xb.prototype.disable=function(){xb.Ctb||(xb.Ctb=!0,sb.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.DBd()};xb.prototype.yBj=
function(){var Vb=this;lf.EwaSettings.ka(644)&&!this.$.isAnonymousUser()&&bb.l(this.$.ra.ua,function(Qc){Vb.$?(Qc=Qc.Result,sb.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",Qc),xb.JYe=!0,Qc&&Vb.c_f(0)):sb.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){sb.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,
null)};xb.prototype.sBj=function(){lf.EwaSettings.ka(643)&&!this.p_f()&&(this.$.fa.Vs(Object(fb.a)(this,this.Gf,"onWorkbookMetadataChanged")),this.xjd=!0)};xb.prototype.p_f=function(){return this.$.fa&&this.$.fa.qn&&this.$.fa.qn.ShouldTriggerLineageCalloutOnMerge?(sb.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.c_f(1),!0):!1};xb.prototype.Gf=function(){this.p_f()};xb.prototype.c_f=function(Vb){if(xb.Ctb)sb.ULS.sendTraceTag(537155456,0,50,
"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(xb.Ctb=!0,sb.ULS.sendTraceTag(578557776,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",Vb),this.DBd(),lf.EwaSettings.ka(507)){Vb=new fe.a(-847286761,Bd.a.Tb,this.$.dd,0,se.a.AQ);var Qc={};Qc=(Qc.CalloutName=4,Qc);this.$.Ka.Ub(Vb,Qc)}};xb.prototype.DBd=function(){this.xjd&&(this.xjd=!1,this.$.fa.Qv(Object(fb.a)(this,this.Gf,"onWorkbookMetadataChanged")))};
xb.Ctb=!1;xb.JYe=!1;Object(Hb.a)(xb,"LineageTeachingCalloutTriggerManager",null,[538,6]);var Uf=jc.a;Em(pb,Uf);pb.prototype.create=function(){var Vb=this;rc.TaskExtensions.Aa(Lb.GetServiceTaskFactory.Va(this.$.ea,458,459,this.rb,"Microsoft.Office.Excel.WebUI.Client.ILineageCatchUpExperimentManager"),function(Qc){Qc=new xb(Vb.$,Qc.result);Vb.Eb(Qc)},this.$.la,3)};pb.ja=function(Vb){Vb.ea.Ia(402,new pb(Vb))};Object(Hb.a)(pb,"LineageTeachingCalloutTriggerManagerFactory",jc.a,[]);var Gg=b(169),Eg=b(365),
ig=b(589),sg=b(578),yg=b(184),Yd=b(87),Sc=b(85),Ag=b(108),Jg=b(28);ib.prototype.show=function(Vb,Qc,md,Ce,le,Zd,fg){var Kg=this;this.jgb||(this.nVd=void 0===Vb?null:Vb,this.PIc=void 0===Qc?null:Qc,this.z_d=void 0===Ce?!1:Ce,this.C_d=void 0===le?!1:le,this.UVd=void 0===Zd?null:Zd,this.Jhb=void 0===md?null:md,this.W_d=void 0===fg?!1:fg,Db.AFrameworkApplication.xa.Xa.OG?yg.UISurfaces.JL().then(function($g){var pa=Object.assign(new sg.a,{onShow:function(){Kg.bBb()},expirationOptions:Object.assign(new ig.a,
{onExpire:function(){Kg.dismiss()},displayTimeoutSeconds:10})}),tb=$g.externalNotification();Kg.pRb=$g.addNotification(tb,pa);return null},function($g){sb.ULS.sendTraceTag(593352347,383,15,"Failed to GetNotificationsAPIAsync: {0}",$g);return null}):this.OAa?this.OAa.E9g(this,Object(fb.a)(this,this.bBb,"onShowApproved")):this.bBb())};ib.prototype.bBb=function(){if(!this.jgb&&(this.vCa=this.PIc?this.PIc:document.getElementById("WACDocumentPanel"))){this.Ce.ACb();this.vF=document.createElement("Div");
this.vF.className="CatchUpActivityNotificationContainer CatchUpActivityNotificationContainerBorder";this.vF.id=Pe.AFrame.Emb;this.vCa.appendChild(this.vF);this.z_d&&this.Jhb&&(this.gIc=document.createElement("Div"),this.gIc.className="CatchUpActivityNotificationBeakBorder CatchUpActivityNotificationBeak",this.vF.appendChild(this.gIc),this.fIc=document.createElement("Div"),this.fIc.className="CatchUpActivityNotificationBeak",this.vF.appendChild(this.fIc));this.FYa(this.nVd,this.C_d,this.UVd,this.W_d);
this.Uj();if(this.Jhb){var Vb=Sys.UI.DomElement.getBounds(this.Jhb),Qc=Sys.UI.DomElement.getBounds(this.vCa);this.vF.style.top=Vb.y-Qc.y+this.Jhb.clientHeight+12+"px"}else this.vF.style.bottom="-"+(this.vF.clientHeight+10)+"px";this.Qla();this.jgb=!0;Db.AFrameworkApplication.xa.Xa.OG||(this.i5d=window.setTimeout(Object(fb.a)(this,this.dismiss,"dismiss"),1E4));this.Kwi()}};ib.prototype.Uj=function(){this.Pg.pa(Ke.a.click,this.vF,Object(fb.a)(this,this.wlf,"onContainerInput"));this.Pg.pa(Ke.a.click,
this.YMb,Object(fb.a)(this,this.Wkf,"onClickClose"));this.H7&&this.Pg.pa(Ke.a.click,this.H7,Object(fb.a)(this,this.Vkf,"onClickButton"))};ib.prototype.$l=function(){this.Pg.za(Ke.a.click,this.vF,Object(fb.a)(this,this.wlf,"onContainerInput"));this.Pg.za(Ke.a.click,this.YMb,Object(fb.a)(this,this.Wkf,"onClickClose"));this.H7&&this.Pg.za(Ke.a.click,this.H7,Object(fb.a)(this,this.Vkf,"onClickButton"))};ib.prototype.FYa=function(Vb,Qc,md,Ce){Vb=void 0===Vb?null:Vb;Qc=void 0===Qc?!1:Qc;md=void 0===md?
null:md;Ce=void 0===Ce?!1:Ce;this.YMb=this.OSg();this.vF.appendChild(this.YMb);this.iea=document.createElement("Div");this.iea.className="CatchUpActivityNotificationMessageContainer";this.iea.setAttribute(Yd.a.Bfa,Yd.a.DWa);this.iea.setAttribute(Yd.a.Mje,Yd.a.hj);this.iea.setAttribute(Yd.a.Od,Yd.a.Afa);this.vF.appendChild(this.iea);this.iea.appendChild(this.vVg());this.iea.appendChild(this.uVg(Vb,Ce));Qc&&(this.H7=document.createElement("button"),this.H7.className="CatchUpActvitiyNotificationButton",
this.H7.innerText=md?md:CommonUIStrings.l_CatchUpChangeNotificationButtonLabel,this.iea.appendChild(this.H7))};ib.prototype.vVg=function(){var Vb=document.createElement("Div");Vb.className="CatchUpActivityNotificationTitle";Vb.innerText=CommonUIStrings.l_CatchUpChangeNotificationMessage;return Vb};ib.prototype.uVg=function(Vb,Qc){Vb=void 0===Vb?null:Vb;Qc=void 0===Qc?!1:Qc;var md=document.createElement("Div");md.className="CatchUpActivityNotificationMessage";if(!Qc){Qc=document.createElement("Div");
Qc.className="CatchUpActivityNotificationDotContainer";var Ce=document.createElement("Div");Ce.className="CatchUpActivityNotificationDot";Qc.appendChild(Ce);md.appendChild(Qc);Qc=document.createElement("span");Qc.className="CatchUpActivityNotificationNewText";Qc.innerText=CommonUIStrings.l_CatchUpChangeNotificationNew;md.appendChild(Qc)}Qc=document.createElement("span");Qc.className="CatchUpActivityNotificationMessageText";if(!Vb||1>Vb.length)Qc.innerText=CommonUIStrings.l_CatchUpChangeNotificationText;
else{switch(Vb.length){case 1:Ce=CommonUIStrings.l_CatchUpChangeNotificationTextOneName;break;case 2:Ce=CommonUIStrings.l_CatchUpChangeNotificationTextTwoNames;break;case 3:Ce=CommonUIStrings.l_CatchUpChangeNotificationTextThreeNames;break;case 4:Ce=CommonUIStrings.l_CatchUpChangeNotificationTextFourNames;break;default:Ce=CommonUIStrings.l_CatchUpChangeNotificationTextMoreNames}Sc.a.lOf(Qc,Ce,Vb,function(le){var Zd=document.createElement("span");Zd.setAttribute("dir","auto");Zd.style.fontFamily="'Segoe UI Semibold', 'Segoe UI Web', Arial, Verdana, sans-serif";
Zd.setAttribute("unselectable","on");Zd.innerText=le;return Zd})}Qc.setAttribute("dir","auto");md.appendChild(Qc);return md};ib.prototype.OSg=function(){var Vb=document.createElement("a");Vb.className="CatchUpActivityNotificationCloseAnchor";Vb.href="#";var Qc=Eg.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","CatchUpActivityNotificationCloseIcon",!0,CommonUIStrings.l_DialogClose);Vb.appendChild(Qc);return Vb};ib.prototype.Wkf=function(){sb.ULS.sendTraceTag(50643481,207,50,"Close button was clicked on Catch-Up Activity Notification callout.");
this.La.processAction(Jg.a.Pce,2);this.dismiss();return!0};ib.prototype.dismiss=function(){var Vb=this;this.jgb&&(Db.AFrameworkApplication.xa.Xa.OG?this.pRb&&yg.UISurfaces.JL().then(function(Qc){Qc.removeNotification(Vb.pRb);Vb.pRb=null;Vb.JB(!0);return null},function(Qc){sb.ULS.sendTraceTag(593352346,383,15,"Failed to GetNotificationsAPIAsync: {0}",Qc);return null}):this.JB(!1))};ib.prototype.JB=function(Vb){this.vCa&&this.vF&&this.vCa.contains(this.vF)&&(this.$l(),this.vCa.removeChild(this.vF),
Vb||window.clearTimeout(this.i5d));this.jgb=!1;!Vb&&this.OAa&&this.OAa.qjh(this)};ib.prototype.wlf=function(){return!0};ib.prototype.Vkf=function(){sb.ULS.sendTraceTag(50643482,207,50,"Primary Button was clicked on Catch-Up Activity Notification callout.");cb.c(Jg.a.BIg);this.La.processAction(Jg.a.tng,2);this.dismiss();return!0};ib.prototype.Qla=function(){var Vb=this,Qc=this.dc.Th(Pe.AFrame.Emb);Qc.parent=Pe.AFrame.Sva;this.Pg.FVa(Pe.AFrame.Emb,this.vF);Qc.ROc(function(){Vb.aPa()});this.qF.EVa(Pe.AFrame.Emb);
this.qF.Bjb(Pe.AFrame.Emb)};ib.prototype.aPa=function(){this.H7&&(sb.ULS.sendTraceTag(50643483,207,50,"Focus was set to the Button on the Activity Notification Callout."),this.H7.focus())};ib.prototype.Kwi=function(){var Vb=this;sb.ULS.sendTraceTag(37552158,207,50,"The Catch-Up Activity Notification callout was shown in the UI.");this.eX?this.eX.continueWith(function(){window.setTimeout(function(){Vb.eX.result.logActivity("CatchUpChangesFeedback",null)},2E4)}):sb.ULS.sendTraceTag(50656925,207,15,
"CatchUpActivityNotification ISystemInitiatedFeedback was null")};Object(Hb.a)(ib,"CatchUpActivityNotification",null,[503]);var je=b(1008),dg=b(72);Pa.prototype.NV=function(Vb,Qc,md,Ce){var le=this;return this.O4g(Vb,void 0===Ce?null:Ce,function(Zd){return le.Ng.TUb(Zd,2,md,Qc,void 0,void 0,void 0,void 0,void 0,"2")})};Pa.prototype.O4g=function(Vb,Qc,md){var Ce=this,le=!!Qc&&""!==Qc,Zd=Vb;le&&(Zd=sa.a.mS(Vb,"perfTag",Qc));var fg=new Date;return je.a.then(md(Zd),function(Kg){var $g=+new Date-+fg;if(!Kg||
!Kg.Jg||!Kg.Jg.data)return Kg;le&&Kg.Jg.data.request&&Ce.Q4i(Kg.Jg.data.request.getResolvedUrl(),Qc,$g);return Kg})};Pa.prototype.Q4i=function(Vb,Qc,md){Vb=this.oea.QGh(Vb);if(Vb.count&&(Vb=dg.last(Vb))){var Ce={Message:"Request durations for activities calls."};Ce.PerfTag=Qc;Ce.CustomDuration=md;Ce.PerformanceDuration=Vb.duration;sb.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ce))}};Object(Hb.a)(Pa,"CatchUpNetworkingWrapper",null,[640]);var ke=b(241),Qf=ke.a;Em(xa,Qf);xa.prototype.Mha=function(){return 6};
Object(Hb.a)(xa,"GetActivityFeedRequest",ke.a,[]);var og=b(382);ma.prototype.lth=function(Vb){var Qc=this;return je.a.then(this.ASa.execute(new xa(this.mSa(),null,Vb),function(md,Ce,le){return Qc.rgg.NV(md,Ce,le,"ActivityFeed")}),function(md){if(!md)return sb.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeedEntries: Response is null"),null;if(!md.Jg)return sb.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeedEntries: Response.Args is null"),null;if(!md.Jg.data)return sb.ULS.sendTraceTag(572846939,
3012,10,"GetActivityFeedEntries: Response.Args.Data is null"),null;if(!md.Jg.data.ae)return sb.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeedEntries: Response.Args.Data.ResponseData is null"),null;md=og.a.iGa(md.Jg.data.ae);return md?md:(sb.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeedEntries: Deserialized response is null"),null)})};Object(Hb.a)(ma,"CatchUpRequestHandler",null,[641]);var Cf=b(467);na.prototype.bci=function(){this.Lci()};na.prototype.Lci=function(){var Vb=this;this.UUa?
this.UUa.execute(function(Qc){window.setTimeout(function(){Vb.J3d.contains("CatchUpChangesFeedback")||(Vb.J3d.add("CatchUpChangesFeedback"),Qc.logActivity("CatchUpChangesFeedback",null))},2E4)}):sb.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(Hb.a)(na,"FloodgateEventLogger",null,[]);var Ea=b(211);Ll.Object.defineProperties(La.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.phg.duration}}});Object(Hb.a)(La,
"PerformanceResourceTimingWrapper",null,[]);ra.prototype.QGh=function(Vb){var Qc=new Ea.a;if(!this.oea)return Qc;Vb=this.oea.getEntriesByName(Vb,"resource");if(!Vb)return Qc;Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next())Qc.add(new La(md.value));return Qc};Object(Hb.a)(ra,"PerformanceWrapper",null,[]);var ob=b(877),wc=b(100),zc=b(276),Hd=b(520);ca.prototype.Qh=function(Vb){var Qc=this;this.Za=Vb;this.Za.register(503,"Common.App.CatchUpActivity.ICatchUpActivityNotification").wc().Fc(function(){return new ib(We.a.instance,
wc.FocusManager.instance(),ob.a.instance,Db.AFrameworkApplication.xa,Db.AFrameworkApplication.Hb,Qc.Za.resolve("CommonUI.ICalloutManager"),Hd.a.mq(Qc.Za.oc("Common.ISystemInitiatedFeedback")))});this.Za.register(Pa,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").wc().Fc(function(){return new Pa(Db.AFrameworkApplication.Cd,new ra(window.performance))});this.Za.register(ma,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").wc().Fc(function(){return new ma(Qc.Za.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),
function(){return Db.AFrameworkApplication.Xi},new og.a)});this.Za.register(na,"Common.App.CatchUpActivity.FloodgateEventLogger").wc().Fc(function(){return new na(Qc.Za.oc("Common.ISystemInitiatedFeedback"))})};ca.prototype.init=function(){this.Za.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Za.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ca.prototype.dispose=function(){};ca.main=function(){zc.a.instance.ej(new ca)};Ll.Object.defineProperties(ca.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(Hb.a)(ca,"CatchUpActivityPackage",null,[8,9]);Z.prototype.Wc=function(Vb,Qc){return this.catchUpActivityManager?-876699925===Qc?!this.catchUpActivityManager.w3e:!1:!0};Z.prototype.executeCommand=function(Vb,Qc){Vb=!1;switch(Qc.command){case -876699925:Vb=this.catchUpActivityManager.OAi()}return Vb?hc.Task.Ra(!0):Oc.a(Qc.command)};Z.prototype.Ec=function(Vb,Qc){return lf.EwaSettings.ka(456)&&-876699925===
Qc.command?!0:!1};Z.prototype.Yc=function(){return!1};Object(Hb.a)(Z,"CatchUpActivityCommandHandler",null,[160]);var Kd=vb.a;Em(U,Kd);U.prototype.Gd=function(){var Vb=this;this.$.ea.$a(286,function(Qc){Vb.Ad([new Z(Vb.$,Qc)])})};U.ja=function(Vb){vb.a.Yd(285,new U(Vb))};Object(Hb.a)(U,"CatchUpActivityCommandHandlerFactory",vb.a,[]);var he=b(86),Se=b(371),Ue=b(83);da.prototype.doesContentExist=function(Vb){if(!Vb)return sb.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),
!1;switch(Vb.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Vb.navigationId)return sb.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var Qc={};Qc.NavigationId=atob(Vb.navigationId);return 32===this.pi.Ge(Jg.a.BGa,2,Qc);default:return!1}};Object(Hb.a)(da,"CatchUpActivityContentManager",null,[528]);var mf=b(946),Vg=b(1233);V.prototype.dispose=function(){this.mu.OEf(Object(fb.a)(this,this.tAb,"onHighlightStateChanged"));this.y$=
null};V.prototype.l8i=function(Vb){this.y$.push(Vb)};V.prototype.FLg=function(){Array.clear(this.y$)};V.prototype.tAb=function(){switch(this.mu.model.state){case 1:this.ATf(!0);break;case 0:this.GHb(!1);break;case 2:case 3:this.GHb(!0);break;default:sb.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+this.mu.model.state)}};V.prototype.ATf=function(Vb){for(var Qc=Ol(this.y$),md=Qc.next();!md.done;md=Qc.next())md=md.value,md.className=
mf.a.EIg,md=document.getElementById(String.format("{0}-{1}",md.id,se.a.Noe)),dc.DOMElementExtensions.setVisible(md,Vb)};V.prototype.GHb=function(Vb){for(var Qc=Ol(this.y$),md=Qc.next();!md.done;md=Qc.next())if(md=md.value)Vb?md.className=2===this.mu.model.state?mf.a.CMi:mf.a.DMi:this.ATf(!1)};Ll.Object.defineProperties(V.prototype,{mu:{configurable:!0,enumerable:!0,get:function(){return this.Gdg}}});Object(Hb.a)(V,"RangeCatchUpActivityView",null,[639,6]);var Hf=Vg.a;Em(Y,Hf);Y.prototype.dispose=function(){this.gridView=
null;Hf.prototype.dispose.call(this)};Y.prototype.Sqg=function(Vb){var Qc=this.ycb[0];Qc?Qc.l8i(Vb):sb.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Pka.activityId)};Y.prototype.sZi=function(){var Vb=this.ycb[0];Vb&&Vb.FLg()};Y.prototype.ipg=function(Vb){this.Pka.addRange(Vb)};Y.prototype.ywh=function(){if(3!==this.Pka.activityType)return null;sb.ULS.shipAssertTag(537168003,0,1===this.Pka.fIb.length,
"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return Ob.D(this.Pka.fIb[0])};Y.prototype.KFb=function(Vb){if(Vb){if(!this.Pka)return;this.Fqd(this.s_i())}Hf.prototype.KFb.call(this,Vb)};Y.prototype.a_c=function(){var Vb=this.HZc();Array.add(this.ycb,Vb)};Y.prototype.HZc=function(){return new V(this)};Y.prototype.Fqd=function(Vb){Vb?Vb.SheetName?(this.gridView.ga.Pa.VF(null),this.gridView.focus(),this.gridView.MWe(Vb,3,!1,we.a.BMi)):sb.ULS.shipAssertTag(537168E3,
0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):sb.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};Y.prototype.s_i=function(){if(od.e(this.Pka.fIb))return sb.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var Vb=this.$.va.qa;
sb.ULS.shipAssertTag(537167970,0,!!Vb,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");Vb=this.Msj(Vb.sheetName,this.Pka.fIb);if(!Vb&&(Vb=this.cLh(this.Pka.fIb),!Vb))return null;var Qc={};Qc.SheetName=Vb.SheetName;Qc.FirstColumn=Vb.FirstColumn;Qc.FirstRow=Vb.FirstRow;Qc.LastColumn=Vb.FirstColumn;Qc.LastRow=Vb.FirstRow;return Qc};Y.prototype.cLh=function(Vb){if(od.e(Vb))return null;for(var Qc=null,md=0;md<Vb.length;md++){var Ce=Vb[md].SheetName;
if(!Da.a.equals(Ce,Qc,!1)&&(Qc=Ce,(Ce=this.$.va.getItemByName(Ce))&&Ce.visible))return Vb[md]}return null};Y.prototype.Msj=function(Vb,Qc){if(Qc){Qc=Ol(Qc);for(var md=Qc.next();!md.done;md=Qc.next())if(md=md.value,Da.a.equals(md.SheetName,Vb,!1))return md}return null};Object(Hb.a)(Y,"RangeCatchUpActivityHighlightController",Vg.a,[]);var Rg=b(74),zf=Rg.a;Em(N,zf);N.prototype.dispose=function(){this.EUd=null;zf.prototype.dispose.call(this)};Ll.Object.defineProperties(N.prototype,{type:{configurable:!0,
enumerable:!0,get:function(){return this.gB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.EUd}},activityType:{configurable:!0,enumerable:!0,get:function(){return this.g9f}}});Object(Hb.a)(N,"CatchUpActivityHighlightModelBase",Rg.a,[]);Em(G,N);G.prototype.addRange=function(Vb){Vb=Ol(Vb);for(var Qc=Vb.next();!Qc.done;Qc=Vb.next())this.ranges.push(Qc.value)};G.prototype.dispose=function(){this.ranges=null;N.prototype.dispose.call(this)};G.YZb=function(Vb,Qc){if(!Vb.SheetName||
!Qc.SheetName)return sb.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0;var md=Vb.SheetName.localeCompare(Qc.SheetName);return md?md:Vb.FirstColumn<Qc.FirstColumn||Vb.FirstColumn===Qc.FirstColumn&&Vb.FirstRow<Qc.FirstRow?-1:Vb.FirstColumn===Qc.FirstColumn&&Vb.FirstRow===Qc.FirstRow?0:1};Ll.Object.defineProperties(G.prototype,{fIb:{configurable:!0,enumerable:!0,get:function(){this.k4a||(this.ranges.sort(G.YZb),this.k4a=!0);return this.ranges}}});
Object(Hb.a)(G,"RangeCatchUpActivityHighlightModel",N,[]);var gg=b(333);W.prototype.dispose=function(){this.Oce=this.$Gb=this.sXc=null};W.prototype.wWi=function(Vb){za.g(Vb).Kb.Jr([24])};W.prototype.kTg=function(Vb,Qc,md){var Ce={};Qc=Ol(Qc);for(var le=Qc.next();!le.done;le=Qc.next())if((le=le.value)&&!od.e(le.LocationList)){for(var Zd=[],fg={},Kg=[],$g=Ol(le.LocationList),pa=$g.next();!pa.done;pa=$g.next()){pa=pa.value;if(!pa){sb.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+
le.Id);break}switch(pa.Type){case 0:var tb=pa;"0"in fg?(pa=fg["0"],pa.ipg(tb.RangeList)):(pa=new Y(Vb,new G(Vb,le.Id,le.Type,0,tb.RangeList),md),Zd.push(pa),fg["0"]=pa);tb=Ol(tb.RangeList);for(var qc=tb.next();!qc.done;qc=tb.next()){qc=qc.value;qc=new gg.a(Ob.D(qc),bf.d(Vb.va.getItemByName(qc.SheetName)));if(this.krc(qc)in this.$Gb)this.$Gb[this.krc(qc)].push(pa);else{var jd=[];jd.push(pa);this.$Gb[this.krc(qc)]=jd}Kg.push(qc);this.sXc.add(qc)}break;default:sb.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}sb.ULS.shipAssertTag(537168011,
0,!(le.Id in Ce),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+le.Id);this.Oce[le.Id]=Kg;Ce[le.Id]=Zd}this.GUg(Vb,this.sXc.toArray(),this.$Gb);return Ce};W.prototype.yLg=function(Vb){for(var Qc in Vb)for(var md=Ol(Vb[Qc]),Ce=md.next();!Ce.done;Ce=md.next())Ce.value.sZi()};W.prototype.krc=function(Vb){return String.format("{0}-{1}",Vb.range,Vb.sheetId)};W.prototype.GUg=function(Vb,Qc,md){var Ce=this;this.yLg(md);za.g(Vb).Kb.Hs(Qc,[24],
!0,function(le,Zd){var fg=new gg.a(le.range,le.sheetId);fg=Ce.krc(fg);var Kg=md[fg];if(Kg)for(fg=Ol(Kg),Kg=fg.next();!Kg.done;Kg=fg.next())Kg=Kg.value,Kg.Sqg(Zd),le.metadata=Kg;else sb.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+fg)})};Object(Hb.a)(W,"CatchUpHighlightControllersCreator",null,[]);Object(Hb.a)(fa,"CreateIndicatorTooltipParameters",null,[]);Object(Hb.a)(aa,"DismissIndicatorTooltipParameters",
null,[]);Object(Hb.a)(L,"UpdateIndicatorTooltipParameters",null,[]);Q.prototype.dispose=function(){this.ga.Xmc(Object(fb.a)(this,this.Uk,"onContextMenu"));this.ga.CE(Object(fb.a)(this,this.$c,"onSelectionChanged"));this.gridView.AE(Object(fb.a)(this,this.Ho,"onCurrentSelectionModeChanged"));this.pb.ym(Object(fb.a)(this,this.Rj,"onEditStarted"));this.aze();this.t6c=this.Aia=this.t$b=this.JOa=this.pb=this.ga=this.gridView=null};Q.prototype.Z5i=function(){var Vb=[];this.aze();if(!od.e(Vb)){sb.ULS.sendTraceTag(537168035,
0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.z3=this.I_b.kTg(this.$,Vb,this)){Vb=this.z3;for(var Qc in Vb)for(var md=Ol(Vb[Qc]),Ce=md.next();!Ce.done;Ce=md.next())this.mzg(Ce.value)}this.I_b.wWi(this.$)}};Q.prototype.psc=function(Vb){if(Vb&&this.Bdd)sb.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(Vb||this.Vob(),this.z3){var Qc=this.z3,md;for(md in Qc)for(var Ce=
Ol(Qc[md]),le=Ce.next();!le.done;le=Ce.next())le.value.nhj(Vb)}};Q.prototype.SRh=function(Vb){this.Aia&&this.h2b(!0);this.G0c();if(Vb=this.z3[Vb.activityId]){Vb=Ol(Vb);for(var Qc=Vb.next();!Qc.done;Qc=Vb.next())Qc.value.KFb(!0)}else sb.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};Q.prototype.aze=function(){if(this.z3){var Vb=this.z3,Qc;for(Qc in Vb)for(var md=Ol(Vb[Qc]),Ce=md.next();!Ce.done;Ce=md.next())Ce=Ce.value,this.nSi(Ce),
Ce.dispose()}this.z3={};this.I_b.dispose();this.I_b=null};Q.prototype.tAb=function(Vb,Qc){switch(Qc.state){case 0:case 1:3===Qc.ayd&&(this.jRh(),this.JOa=null);break;case 2:break;case 3:this.G0c();this.JOa=Qc.activityId;this.Nfj();break;default:sb.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Qc.state)}};Q.prototype.Nfj=function(){if(this.excelCommentManager){var Vb=this.z3[this.JOa];Vb&&0<Vb.length&&3===Vb[0].model.activityType&&
((Vb=Vb[0])?this.excelCommentManager.pgj(Vb.ywh()):sb.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};Q.prototype.jRh=function(){this.excelCommentManager&&this.excelCommentManager.ZZa()};Q.prototype.G0c=function(){if(this.JOa){var Vb=this.z3[this.JOa];if(Vb){Vb=Ol(Vb);for(var Qc=Vb.next();!Qc.done;Qc=Vb.next())Qc.value.KFb(!1);this.JOa=null}else sb.ULS.sendTraceTag(537168028,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};
Q.prototype.Uk=function(){this.Vob()};Q.prototype.$c=function(){this.Vob()};Q.prototype.Ho=function(){this.Vob()};Q.prototype.Rj=function(){this.Vob()};Q.prototype.Vob=function(){this.G0c();this.h2b(!0)};Q.prototype.ASf=function(Vb,Qc){this.nda&&Qc.xG!==this.Aia&&(Qc.isSticky&&this.h2b(!0),(Vb=this.Ysj(Qc.xG))?(this.nda.createActivityIndicatorTooltip(Object.assign(new fa,{target:Qc.xG,container:Vb,activityIds:[Qc.activityId],isSticky:Qc.isSticky,dirHint:this.gridView.rtl?12:9})),Qc.isSticky?(this.Aia=
Qc.xG,sb.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(this.t$b=Qc.xG,sb.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),this.Lbc||(this.gridView.view.Us(Object(fb.a)(this,this.Cvc,"updateActivityFlyouts")),this.gridView.uq(Object(fb.a)(this,this.Cvc,"updateActivityFlyouts")),this.Lbc=!0)):sb.ULS.shipAssertTag(537168027,
0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};Q.prototype.Ysj=function(Vb){if(!Vb)return sb.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Vb=String.format("{0}-{1}",Vb.id,se.a.CIg);var Qc=this.t6c[Vb];if(!Qc){if(!this.gridView.domElement)return sb.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;Qc=document.createElement("Div");
Qc.className=mf.a.DIg;Qc.id=Vb;this.gridView.domElement.appendChild(Qc);this.t6c[Vb]=Qc}return Qc};Q.prototype.Wze=function(Vb,Qc){this.h2b(Qc.x3g)};Q.prototype.Cvc=function(){this.nda?(this.Aia&&this.nda.updateActivityIndicatorTooltip(Object.assign(new L,{target:this.Aia,isSticky:!0})),this.t$b&&this.nda.updateActivityIndicatorTooltip(Object.assign(new L,{target:this.Aia,isSticky:!1}))):sb.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};
Q.prototype.h2b=function(Vb){this.nda&&(this.nda.dismissActivityIndicatorTooltips(Object.assign(new aa,{clearSticky:Vb})),this.t$b=null,Vb&&(this.Aia=null),this.Lbc&&!this.Aia&&(this.gridView.view.Gr(Object(fb.a)(this,this.Cvc,"updateActivityFlyouts")),this.gridView.Cs(Object(fb.a)(this,this.Cvc,"updateActivityFlyouts")),this.Lbc=!1))};Q.prototype.mzg=function(Vb){Vb.$ee(Object(fb.a)(this,this.tAb,"onHighlightStateChanged"));Vb.wrg(Object(fb.a)(this,this.ASf,"showActivityFlyoutHandler"));Vb.vrg(Object(fb.a)(this,
this.Wze,"dismissActivityFlyoutHandler"))};Q.prototype.nSi=function(Vb){Vb.OEf(Object(fb.a)(this,this.tAb,"onHighlightStateChanged"));Vb.sTi(Object(fb.a)(this,this.ASf,"showActivityFlyoutHandler"));Vb.rTi(Object(fb.a)(this,this.Wze,"dismissActivityFlyoutHandler"))};Ll.Object.defineProperties(Q.prototype,{sng:{configurable:!0,enumerable:!0,get:function(){return this.nda},set:function(Vb){this.nda=Vb}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.tBa||(this.tBa=this.$.ea.Ba(65));
return this.tBa}},I_b:{configurable:!0,enumerable:!0,get:function(){this.J_b||(this.J_b=new W);return this.J_b},set:function(Vb){this.J_b=Vb}}});Object(Hb.a)(Q,"CatchUpActivityHighlightManager",null,[595,6]);S.prototype.navigateToActivity=function(Vb){if(Vb.fromSummaryString){var Qc=new fe.a(1834994092,Bd.a.Tb,this.$.dd,18,null);this.$.Ka.Ub(Qc);return this.LRa(1)}Vb=Vb.activity;if(!this.MZh(Vb))return this.LRa(4);if(!this.R6h(Vb))return this.LRa(7);var md={};try{Qc=window.self.atob(Vb.navigationId);
if(Da.a.ma(Qc))return this.LRa(5);md.NavigationId=Qc}catch(Ce){return sb.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Ce),this.LRa(5)}if(8===this.pi.Ge(Jg.a.BGa,2,md))return this.pi.processAction(Jg.a.X5a,2),this.LRa(2);Qc=32===this.pi.Ge(Jg.a.mYa,2,md)?1:6;return this.LRa(Qc)};S.prototype.MZh=function(Vb){return Vb&&Vb.navigationId?!0:!1};S.prototype.R6h=function(Vb){switch(Vb.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};
S.prototype.LRa=function(Vb){return Promise.resolve(Vb)};Object(Hb.a)(S,"CatchUpActivityNavigationManager",null,[529]);var Xe=b(435);Object(Hb.a)(H,"GetRelevantActivitiesDataRequest",null,[]);Object(Hb.a)(J,"Activity",null,[]);Object(Hb.a)(y,"ActivityFeedItem",null,[]);Object(Hb.a)(x,"ActivityFeedPayload",null,[]);Object(Hb.a)(z,"ActivityRequestPayload",null,[]);Object(Hb.a)(B,"Person",null,[]);Em(t,J);Object(Hb.a)(t,"TaskActivity",J,[]);w.prototype.requestWYWAActivities=function(){var Vb=this;return this.z3a?
new Promise(function(Qc,md){A(Vb.$.ra.ua,function(Ce){Ce=mc.a(Ce)?null:Ce.Result;Ce=Object.assign(new z,{activities:[],actors:Ce?Vb.V$c(Ce.WywaAuthors):null,hasMore:!1,highWaterline:w.jZa,lowWaterline:w.jZa,wywaWaterline:w.jZa});Qc(Ce)},function(){sb.ULS.sendTraceTag(537168022,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");md(null)},null,null)}):Promise.resolve(w.x1b)};w.prototype.requestActivities=function(){return Promise.resolve(w.x1b)};w.prototype.requestRelevantActivities=
function(){var Vb=this;if(!this.$.fa.lc||this.$.fa.T1a)return sb.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.fa.lc,this.$.fa.T1a),Promise.resolve(w.x1b);var Qc=Object.assign(new H,{SetDaysBack:Db.AFrameworkApplication.ha.xd("AppWaterlineOverrideDaysValue",0),SetTimestamp:Db.AFrameworkApplication.ha.xd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(md,
Ce){E(Vb.$.ra.ua,Qc,function(le){var Zd=w.x1b;le?mc.a(le)?sb.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Ee.a.Uc(le.Errors)):Zd=Vb.AGh(le.Result):sb.ULS.sendTraceTag(537168020,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");md(Zd)},function(le){le=Tc.a.xg(le.data);sb.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",
Ee.a.Uc(le));Ce(null)},null,null)})};w.prototype.requestActivityFeed=function(){var Vb=this;return ld.b(this.getActivityFeed()).then(function(Qc){return Object.assign(new x,{activityFeedItems:Vb.Lrj(Qc)})})};w.prototype.getActivityFeed=function(){var Vb=this;return this.Qoe?je.a.bOd(this.Qoe,function(Qc){return Qc.lth(Vb.Byh())}):hc.Task.Ra([])};w.prototype.Byh=function(){var Vb=RegExp("^(([^:/?#]+):)?(\\\\/\\\\/([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?").exec(decodeURIComponent(sa.a.Vz(window.location.href,
"WOPISrc",!0)))[5].split("/");return Vb[Vb.length-1]};w.prototype.AGh=function(Vb){if(!Vb)return sb.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object.assign(new z,{activities:[]});var Qc=this.YZf(Vb.NewActivities,2);Vb=this.YZf(Vb.OutstandingActivities,3);Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next())Qc.push(md.value);return Object.assign(new z,{activities:Qc})};w.prototype.YZf=function(Vb,Qc){Qc=void 0===Qc?1:Qc;
var md=[];if(!Vb||!Vb.length)return md;Vb=Ol(Vb);for(var Ce=Vb.next();!Ce.done;Ce=Vb.next())if(Ce=Ce.value){var le=w.Srj(Ce.Type);6===le||7===le||9===le||8===le?md.push(Object.assign(new t,{activityId:Ce.Id,type:le,displayTimestamp:new Date(Ce.DisplayTimestamp),navigationId:Ce.NavigationId,actors:this.V$c(Ce.People),relevancy:Qc,relationship:this.Rrj(Ce.Relationship)})):md.push(Object.assign(new J,{activityId:Ce.Id,type:le,displayTimestamp:new Date(Ce.DisplayTimestamp),navigationId:Ce.NavigationId,
actors:this.V$c(Ce.People),relevancy:Qc}))}else sb.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return md};w.prototype.Rrj=function(Vb){switch(Vb){case 1:return 1;case 2:return 2;case 3:return 3}sb.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};w.prototype.Lrj=function(Vb){var Qc=[];Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next())md=md.value,md=Object.assign(new y,{id:md.id,type:md.type,
collectionId:md.collectionId,activityState:md.activityState,activityFeedItemPayload:md.activityFeedItemPayload,timestamp:md.timestamp}),Qc.push(md);return Qc};w.prototype.V$c=function(Vb){var Qc=[];if(!Vb||!Vb.length)return Qc;Vb=Ol(Vb);for(var md=Vb.next();!md.done;md=Vb.next())(md=md.value)&&Qc.push(this.Bsb(md));return Qc};w.prototype.Bsb=function(Vb){return Object.assign(new B,{id:Vb.Id,provider:Vb.Provider,displayName:Vb.DisplayName,email:Vb.Email,imageUrl:this.tlc.IFa(Vb.Email,Vb.Provider,Db.AFrameworkApplication.Xi,
0),color:this.cCb.nbd(new Xe.a(null,void 0,Vb.DisplayName),6)})};w.Srj=function(Vb){switch(Vb){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return sb.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};w.x1b=Object.assign(new z,{activities:[],actors:[],hasMore:!1,highWaterline:w.jZa,lowWaterline:w.jZa,wywaWaterline:w.jZa});Object.assign(new z,
{activities:[Object.assign(new J,{activityId:"activityId1",type:3,actors:[Object.assign(new B,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new J,{activityId:"activityId2",type:4,actors:[Object.assign(new B,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});
w.jZa="<WywaWaterline>DefaultWaterline</WywaWaterline>";Object(Hb.a)(w,"CatchUpActivityRequestManager",null,[530]);v.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.fa.nLa)return!1;if(!lf.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var Vb=this.$.ea.Ba(365);return!Vb||!Vb.isVisible}return!0};v.prototype.onButtonClick=function(){var Vb={};Vb=(Vb.InputMethod=Bd.a.Tb,Vb);this.$.Ka.Ub(new fe.a(1834994092,Bd.a.Tb,this.$.dd,16,null),Vb)};v.prototype.getExplanationText=
function(){var Vb=this.$.ea.Ba(365);return Zf.a.instance.Ua(Vb&&Vb.isVisible?644:643)};v.prototype.getCommandName=function(){return Zf.a.instance.da(421)};Object(Hb.a)(v,"CatchUpEmptyExperienceBehaviorManager",null,[531]);r.prototype.dispose=function(){kd.a(this.$).sA(this)};r.prototype.Le=function(Vb,Qc){if(Qc)return!1;Vb=document.getElementById("flyoutItem0");if(!Vb)return sb.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;Vb.focus();this.C3g(Vb);
return!0};r.prototype.rh=function(Vb){return this.Ib?dc.DOMElementExtensions.Ue(this.Ib,Vb):!1};r.prototype.Uh=function(){this.hasFocus=!0};r.prototype.Nh=function(){this.hasFocus=!1};r.prototype.C3g=function(Vb){if(Sys.Browser.agent===Sys.Browser.Firefox){var Qc=document.createEvent("KeyboardEvent");Qc.initKeyEvent(Ke.a.Qb,!0,!0,window.self,!1,!1,!1,!1,hf.a.Nwc,0);Vb.dispatchEvent(Qc)}else Qc=document.createEvent("Events"),Qc.initEvent(Ke.a.Qb,!0,!0),Qc.keyCode=hf.a.Nwc,Qc.which=hf.a.Nwc,Vb.dispatchEvent(Qc)};
Ll.Object.defineProperties(r.prototype,{Ib:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.b5e&&!this.hasFocus}},Vd:{configurable:!0,enumerable:!0,get:function(){return ce.a.NUc}}});Object(Hb.a)(r,"FlyoutFocus",null,[120,6]);var If=b(370);n.prototype.dispose=function(){this.cgb=this.Cvb=!1};n.prototype.registerButtonClickedEvent=function(Vb){this.buttonClickedCallback&&
sb.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=Vb.buttonClickedCallback};n.prototype.onFlyoutInitialized=function(){this.Cvb&&sb.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var Vb=(new Date).getTime()-this.toh.getTime();sb.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",Vb);cb.c(Jg.a.GIg,!0,cb.e,
0,0,Vb);this.Cvb=!0;If.a.Nx&&If.a.Nx.updateCommandUI(!0)};n.prototype.logFlightTriggers=function(){};n.prototype.toggleCatchUpFlyout=function(){this.Cvb?this.buttonClickedCallback?this.buttonClickedCallback():sb.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):sb.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};n.prototype.onFlyoutVisibilityChanged=
function(Vb){this.cgb!==Vb.flyoutIsVisible&&(this.cgb=Vb.flyoutIsVisible,If.a.Nx&&If.a.Nx.updateCommandUI(!0),this.cgb||this.BLe&&this.BLe.bci())};Ll.Object.defineProperties(n.prototype,{b5e:{configurable:!0,enumerable:!0,get:function(){return this.cgb}}});Object(Hb.a)(n,"FlyoutRibbonButton",null,[594]);var yf=b(524);Object(Hb.a)(l,"CatchUpConfiguration",null,[]);Object(Hb.a)(d,"SharedControllerFactoryParameters",null,[]);e.prototype.dispose=function(){this.MEa&&this.MEa.getWywaEvent().removeListener(Object(fb.a)(this,
this.luf,"onWywaActivitiesReady"));this.MEa=this.$=null;he.a.Fa(this.IXa);this.flyoutRibbonButton=this.flyoutFocus=this.oWd=this.Ooe=this.Poe=this.IXa=null};e.prototype.OAi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};e.prototype.Fci=function(){sb.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");sb.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled")};e.prototype.luf=function(Vb){this.IXa.Z5i();this.IXa.psc(!0);Se.a.ma(Vb.wywaActivities)||
2===Vb.wywaActivities[0].type||this.IXa.SRh(Vb.wywaActivities[0])};e.prototype.Pai=function(Vb,Qc){h("ScriptDownload");rc.TaskExtensions.Aa(Lb.GetServiceTaskFactory.Va(this.$.ea,283,284,Qc,"Common.IDynamicScriptLoaderProvider"),function(md){Vb(ld.c(md.result.Cp.loadScript("catchUpActivity")))},this.$.ea.la,3)};e.prototype.z3a=function(){return!!this.Vaf&&this.Vaf.z3a()&&this.$.fa.nLa};e.prototype.Xoi=function(Vb){var Qc=this;rc.TaskExtensions.Aa(Vb,function(){hd.a(function(){Qc.MEa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object.assign(new d,
{activityContentManager:Object(Ue.a)(528,Qc.oWd),activityNavigationManager:Object(Ue.a)(529,Qc.Ooe),activityRequestManager:Object(Ue.a)(530,Qc.Poe),dataCulture:Qc.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Ue.a)(n,Qc.flyoutRibbonButton),uiCulture:Qc.$.ya.UICultureTag,ulsLogger:new Pc.a,emptyCatchUpBehaviorManager:Object(Ue.a)(531,Qc.emptyCatchUpBehaviorManager)}))});Qc.IXa.sng=Qc.MEa.getActivityIndicatorTooltipManager();yf.a(Qc.$);Qc.MEa.getWywaEvent().addListener(Object(fb.a)(Qc,
Qc.luf,"onWywaActivitiesReady"));h("InitializeCatchUpApp");Qc.MEa.initialize(Object.assign(new l,{featuredActivityGroupsEnabled:!1,flyoutEnabled:!0,summaryStringEnabled:Qc.z3a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:lf.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel")}))},this.$.la,3)};Ll.Object.defineProperties(e.prototype,{w3e:{configurable:!0,enumerable:!0,get:function(){var Vb=this.flyoutRibbonButton.Cvb;Vb&&!this.GYe&&(sb.ULS.sendTraceTag(588129368,
3012,50,"Catch Up Flyout is ready and button is enabled."),this.GYe=!0);return Vb}},N_h:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.b5e}}});Object(Hb.a)(e,"CatchUpActivityManager",null,[532,6]);var Bf=jc.a;Em(a,Bf);a.prototype.create=function(){var Vb=this;rc.TaskExtensions.Aa(Lb.GetServiceTaskFactory.Va(this.$.ea,458,459,this.rb,"Microsoft.Office.Excel.WebUI.Client.ILineageCatchUpExperimentManager"),function(Qc){Qc=Qc.result;Vb.Eb(Vb.$.ea.Ba(286)||new e(Vb.$,Vb.rb,
null,Qc))},this.$.la,3)};a.ja=function(Vb){Vb.ea.Ia(287,new a(Vb))};Object(Hb.a)(a,"CatchUpActivityManagerFactory",jc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");Qb.a.Ga(lc.ja);Qb.a.Ga(P.ja);Qb.a.Ga($a.ja);Qb.a.Ga(Ca.ja);Ad.a.Li('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){Qb.a.Ga(function(Vb){Ya.ja(Vb);ea.ja(Vb);Ra.ja(Vb);pb.ja(Vb);oc.ja(Vb)})})();Type.registerNamespace("Common.App.CatchUpActivity");ca.main();(function(){Qb.a.Ga(function(Vb){h("Begin");a.ja(Vb);U.ja(Vb)})})()}}]);

//# sourceMappingURL=EwaDS.catchup.js.map