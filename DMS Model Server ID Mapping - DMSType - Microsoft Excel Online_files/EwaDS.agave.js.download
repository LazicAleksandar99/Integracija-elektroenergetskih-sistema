(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1055:function(C,F,b){function a(){}function e(){}function d(N,Y,V,da,U,Z){N=l.call(this,N,Y,V,da,U,void 0===Z?null:Z)||this;N.uQb=null;return N}function l(N,Y,V,da,U,Z){N=n.call(this,N,V,U.bW,void 0===Z?null:Z)||this;N.C4d=0;N.b0=N.kDh(da);N.eVa=Y;N.Ce=U;N.nqj=7;N.Yk=N.eVa.ownerDocument.createElement("div");N.Yk.className="ModalCalloutControlOverlay";N.Yk.tabIndex=0;N.eVa.insertBefore(N.Yk,N.eVa.firstChild);return N}function n(N,
Y,V,da){var U=B.call(this,document.createElement("div"))||this;U.Soa=null;U.xna=null;U.tF=null;U.mF=null;U.aw=null;U.pR=null;U.rR=null;U.foa=!1;U.Gfb=!1;U.Uo=null;U.content=null;U.b0=0;U.lle=null;U.zS=0;U.Esf=null;U.jae=N;U.v6d=Y;U.$N=V;U.WEa=da;U.tg=Y.ownerDocument;U.$fb=!1;U.lu=!1;U.Ucd=!1;return U}C=b(0);var r=b(15),h=b(37),v=b(365),w=b(13),t=b(87),B=Sys.UI.Control;Em(n,B);n.prototype.show=function(){this.$fb||(this.JTg(),this.xj(),this.v6d.appendChild(this.WU),this.WU.style.display="Block",this.H$i(),
this.$fb=!0,this.Esf&&this.Esf())};n.prototype.dismiss=function(){this.$fb&&(this.mT(),this.v6d.removeChild(this.WU),this.$fb=!1,this.WEa&&this.WEa())};n.prototype.dispose=function(){this.dismiss();this.pR=this.aw=this.mF=this.xna=this.tF=this.Soa=null;Sys.Component.prototype.dispose.call(this)};n.prototype.Yh=function(N){return this.get_element().id+N};n.prototype.JTg=function(){this.tF=this.tg.createElement("div");this.tF.id=this.Yh("WACCalloutHeader");this.tF.className="WACCalloutHeader";this.lu&&
this.yde();this.Ucd&&this.Iee();this.mF=this.tg.createElement("div");this.mF.id=this.Yh("WACCalloutContent");this.mF.className="WACCalloutContent";this.mF.style.width=190<this.b0?this.b0-26+"px":"164px";this.mF.appendChild(this.content);this.WU.appendChild(this.mXb);this.WU.appendChild(this.tF);this.WU.appendChild(this.mF)};n.prototype.yde=function(){this.aw=this.tg.createElement("a");this.aw.className="WACCalloutCloseAnchor";this.aw.id=this.Yh("WACCalloutCloseAnchor");this.aw.href="#";this.tF.appendChild(this.aw);
var N=v.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.aw.appendChild(N)};n.prototype.Iee=function(){this.pR=this.tg.createElement("div");this.pR.className="WACCalloutTitle UIFontBold";this.pR.style.width=190<this.b0?this.b0-30+"px":"160px";this.pR.id=this.Yh("WACCalloutTitle");this.pR.innerText=this.title;this.tF.contains(this.aw)?this.tF.insertBefore(this.pR,this.aw):this.tF.appendChild(this.pR)};n.prototype.H$i=function(){var N=
this.jae;if(1===this.zS){var Y=this.lle.y+16;var V=-16}else 2!==this.zS&&3!==this.zS&&this.zS?(Y=N.y-this.WU.clientHeight-15-2,V=this.WU.clientHeight-1):(Y=N.y+N.height+15,V=-15);this.WU.style.top=Y+"px";this.mXb.style.top=V+"px";1===this.zS?(N=this.lle.x-16,this.WU.style.left="50%",this.WU.style.marginLeft=-this.b0/2+"px",Y=Sys.UI.DomElement.getBounds(this.WU),this.mXb.style.left=N-Y.x+"px"):(Y=N.x+this.jae.width/2,2===this.zS||5===this.zS?(N=20,Y-=36):this.zS&&4!==this.zS?(N=this.b0-20-32,Y=Y-this.b0+
36):(N=this.b0/2-16,Y-=this.b0/2),this.WU.style.left=Y+"px",this.mXb.style.left=N+"px")};n.prototype.xj=function(){this.lu&&!this.rR&&(this.rR=Object(h.a)(this,this.X8,"closeHandler"),this.$N.pa(w.a.click,this.aw,this.rR,null))};n.prototype.mT=function(){this.lu&&this.rR&&(this.$N.za(w.a.click,this.aw,this.rR),this.rR=null)};n.prototype.X8=function(){this.dismiss();return!0};Ll.Object.defineProperties(n.prototype,{WU:{configurable:!0,enumerable:!0,get:function(){this.Soa||(this.Soa=this.tg.createElement("div"),
this.Soa.id=this.Yh("WACCalloutOuter"),this.Soa.className="WACCalloutOuter",this.Soa.setAttribute(t.a.Od,t.a.AWa),this.Soa.style.width=this.b0+"px");return this.Soa}},mXb:{configurable:!0,enumerable:!0,get:function(){if(!this.xna){this.xna=this.tg.createElement("div");this.xna.id=this.Yh("WACCalloutBeakContainer");this.xna.className="WACCalloutBeakContainer";var N="CalloutBeakTopFilled_32x16x32";if(5===this.zS||6===this.zS||4===this.zS)N="CalloutBeakBottomFilled_32x16x32";N=v.createClusteredImage(32,
16,N,"WACCalloutBeak",!0,"");this.xna.appendChild(N)}return this.xna},set:function(N){this.xna=N}},ZJa:{configurable:!0,enumerable:!0,get:function(){return this.$fb}},title:{configurable:!0,enumerable:!0,get:function(){return this.Uo},set:function(N){this.Uo!==N&&(this.Uo=N,this.pR&&(this.pR.innerText=this.Uo))}},lu:{configurable:!0,enumerable:!0,get:function(){return this.foa},set:function(N){this.foa!==N&&(this.foa=N,this.tF&&(this.tF.contains(this.aw)&&!this.foa?this.tF.removeChild(this.aw):!this.tF.contains(this.aw)&&
this.foa&&this.yde()))}},Ucd:{configurable:!0,enumerable:!0,get:function(){return this.Gfb},set:function(N){this.Gfb!==N&&(this.Gfb=N,this.tF&&(this.tF.contains(this.pR)&&!this.Gfb?this.tF.removeChild(this.pR):!this.tF.contains(this.pR)&&this.Gfb&&this.Iee()))}}});Object(C.a)(n,"Callout",Sys.UI.Control,[441]);Em(l,n);l.prototype.show=function(){this.ZJa||(this.Ce.ACb(),this.Ce.vO(!1),this.Yk.style.zIndex=String(this.Ce.Z0),n.prototype.show.call(this),this.Uj(),this.C4d=window.setTimeout(Object(h.a)(this,
this.dismiss,"dismiss"),1E3*this.nqj))};l.prototype.dismiss=function(){this.ZJa&&(this.Ce.vL(!1),this.$l(),this.eVa&&this.eVa.contains(this.Yk)&&this.eVa.removeChild(this.Yk),n.prototype.dismiss.call(this),window.clearTimeout(this.C4d))};l.prototype.Uj=function(){this.Ce.Upa(Object(h.a)(this,this.dismiss,"dismiss"));this.Ce.Ty.pa(w.a.click,this.Yk,Object(h.a)(this,this.Rc,"onClick"))};l.prototype.$l=function(){this.Ce.$8a(Object(h.a)(this,this.dismiss,"dismiss"));this.Ce.Ty.za(w.a.click,this.Yk,Object(h.a)(this,
this.Rc,"onClick"))};l.prototype.Rc=function(){this.dismiss();return!0};l.prototype.kDh=function(N){var Y=0;switch(N){case 0:Y=190;break;case 1:Y=250;break;case 2:Y=300;break;case 3:Y=360}return Y};Object(C.a)(l,"ModalCallout",n,[]);var z=b(578),x=b(184);Em(d,l);d.prototype.show=function(){var N=this;if(!this.ZJa){var Y=Object.assign(new z.a,{onShow:function(){l.prototype.show.call(N)}});x.UISurfaces.JL().then(function(V){var da=V.externalNotification();N.uQb=V.addNotification(da,Y);return null},
function(V){r.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",V);return null})}};d.prototype.dismiss=function(){var N=this;this.ZJa&&this.uQb&&(x.UISurfaces.JL().then(function(Y){Y.removeNotification(N.uQb);return N.uQb=null},function(Y){r.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",Y);return null}),l.prototype.dismiss.call(this))};Object(C.a)(d,"ReactManagedModalCallout",l,[]);var y=b(5);e.yVg=function(N,Y,V,da){var U=void 0===U?null:U;
return y.AFrameworkApplication.xa.Xa.OG?new d(N,Y,V,da,y.AFrameworkApplication.xa,U):new l(N,Y,V,da,y.AFrameworkApplication.xa,U)};Object(C.a)(e,"ModalCalloutControlFactory",null,[]);var J=b(50),E=b(986),A=b(589),H=b(987),S=b(128),Q=b(85),L=b(48),aa=b(88),fa=b(925),W=b(811),G=b(801);b.d(F,"a",function(){return a});a.GYc=function(N,Y,V,da,U,Z){a.iI&&a.iI.ZJa&&a.iI.dismiss();a.iI=e.yVg(Y,N,N,U);a.iI.content=V;G.b(da)||(a.iI.title=da,a.iI.Ucd=!0);N=new Sys.UI.Bounds(0,0,Q.a.r1a(),Q.a.T8b());a.iI.zS=
a.svh(N,Y,a.iI.b0,Z);a.iI.show();a.IWb&&a.IWb.sendNotification(V.innerText,!0)};a.IYc=function(N,Y,V,da){da=void 0===da?null:da;x.UISurfaces.JL().then(function(U){var Z=null;a.Vhb&&(U.removeNotification(a.Vhb),a.Vhb=null);var ca=U.callout(Object.assign(new E.a,{target:N,title:Y,content:V,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new H.a,{onDismiss:function(){U.removeNotification(Z)},directionalHint:null!=da?da:null})})),ra=Object.assign(new z.a,
{expirationOptions:Object.assign(new A.a,{displayTimeoutSeconds:7,onExpire:function(){U.removeNotification(a.Vhb)}})});Z=a.Vhb=U.addNotification(ca,ra);return null},function(U){r.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",U);return null})};a.lKd=function(N,Y){Y=void 0===Y?null:Y;a.iI&&a.iI.ZJa&&a.iI.dismiss();var V=new S.StandardDialog;V.QPa=!1;V.hc=0;V.Qy(J.a.d$h,CommonUIStrings.l_DialogError,G.b(N)?a.OPe():N,Y)};a.nKd=function(N){a.iI&&a.iI.ZJa&&a.iI.dismiss();r.ULS.sendTraceTag(17425951,
220,10,String.format("AddinCommandsActivationError : error code {0}.",N.errorCode));var Y=G.b(N.description)?a.OPe():N.description,V=new S.StandardDialog,da=null;N.Wfa?(V.hc=1,V.yc(1,N.buttonText),V.Ela(1)):V.hc=0;da=function(U){1===U?N.Wfa():N.Sga&&N.Sga()};V.QPa=!1;0===N.vJa?V.Qy(N.errorCode,N.title?N.title:CommonUIStrings.l_DialogError,Y,da):1===N.vJa?V.WV(N.title?N.title:CommonUIStrings.l_DialogWarning,Y,da):V.Pya(N.title?N.title:CommonUIStrings.l_DialogInfo,Y,da)};a.svh=function(N,Y,V,da){var U=
da?4:0,Z=N.x+N.width-Y.x-Y.width;Y.x-N.x+Y.width/2<=V/2?U=da?5:2:Z+Y.width/2<=V/2&&(U=da?6:3);return U};a.Dfj=function(N,Y,V,da,U){if(a.FRd)(Y=fa.a.prb(da))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Y,function(ra){ra&&a.IYc(ra,U,V,5)});else if(N)if(da&&da.tabs.count){da=da.tabs.oa(0);var Z=da.tQa[W.a.id],ca=da.kJ.oa(0).Qta[W.a.id];N.fGd(Z)&&(N=da.isOfficeTab?N.XAh(Z,ca):N.jJh(Z))&&(N.x+N.width/2>Q.a.r1a()&&(N=new Sys.UI.Bounds(Q.a.r1a(),
N.y+N.height,0,0)),a.GYc(Y,N,a.Jme(V),U,2,0))}else r.ULS.sendTraceTag(17326355,220,50,"There is no tab or group added to ribbon !");else r.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.Efj=function(N,Y,V,da){a.Dfj(N,Y,da.startedNode?da.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,V),da,da.startedNode?da.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,V))};a.Cfj=
function(N,Y,V,da){if(a.FRd)N=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,V,da,CommonUIStrings.l_InsertionDialogRefresh)),a.IYc(Y,N,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{Y=L.a.kn(Y);var U=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Z=document.createElement("span");Z.innerText=U[0];var ca=document.createElement("span");ca.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
V,da,CommonUIStrings.l_InsertionDialogRefresh);ca.className="UIFontBold";V=document.createElement("span");V.innerText=U[1];da=document.createElement("div");Sys.UI.DomElement.addCssClass(da,"ModalCalloutControl");da.appendChild(Z);da.appendChild(ca);da.appendChild(V);a.GYc(N,Y,da,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.ahj=function(N,Y){var V=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,da=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.FRd?a.IYc(Y,V,da):(Y=
L.a.kn(Y),a.GYc(N,Y,a.Jme(da),V,3,1))};a.Jme=function(N){var Y=document.createElement("div");Sys.UI.DomElement.addCssClass(Y,"ModalCalloutControl");Y.innerText=N;return Y};a.OPe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};Ll.Object.defineProperties(a,{IWb:{configurable:!0,enumerable:!0,get:function(){return a.rda||(a.rda=aa.a.instance.Mh("Common.Utils.IAriaNotifier"))}},FRd:{configurable:!0,enumerable:!0,get:function(){return y.AFrameworkApplication.xa.Xa.mi&&
y.AFrameworkApplication.xa.Xa.OG}}});a.iI=null;a.Vhb=null;a.rda=null;Object(C.a)(a,"AddInCommandsNotificationFactory",null,[])},1063:function(C,F,b){function a(x,y,J,E,A){this.$u=x;this.bI=J;this.r0=E;this.ed=A;this.peb=this.bI.sh;this.Gx=this.peb.getOsfControl(y);this.Wfg=this.Gx.getManifest()}function e(x,y,J,E){this._id=x;this.$u=y;this.r0=J;this.ed=E}function d(x,y,J,E){this.iz=!1;this._id=x;this.$u=y;this.r0=J;this.ed=E}b.r(F);C=b(0);var l=b(15),n=b(1399),r=b(144),h=b(116),v=b(829),w=b(841),
t=b(337);d.prototype.setEnabled=function(){};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};d.prototype.invokePropertyGet=function(x){switch(x){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};d.prototype.invokePropertyGetAsync=function(x){x=this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};
d.prototype.invokePropertySet=function(x,y){switch(x){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};d.prototype.invokePropertySetAsync=function(x,y){this.invokePropertySet(x,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};d.prototype.invokeMethod=function(x,y){switch(x){case 5:return this.w7i(y);case 1:return this.wAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);
};d.prototype.invokeMethodAsync=function(x,y){x=this.invokeMethod(x,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};d.prototype.w7i=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");this.setEnabled(x);return null};d.prototype.wAa=function(){this._OnAccess();return null};Ll.Object.defineProperties(d.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.iz},set:function(x){var y=b(1063).DynamicRibbon,J=this.ed.OwnerAddinStoreType,
E=this.ed.PrimaryMarketplace.MarketplaceRef,A={};A=(A.addinAssetId=Telemetry.PrivacyRules.GetAssetId(J,E,this.$u),A.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(J,E,this.ed.OwnerAddinAssetId),A.ownerAddinStoreType=J,A.ribbonControlType="Button",A.toggle=x,A);r.a.sendTelemetryEvent(Object.assign(new t.a,{name:y.duc+"ControlUpdate",dataFields:h.a.fy(A)}));this.iz=x;x={};J=(x.DynamicAddinCommandsMethodDispatchId=1,x.SolutionId=this.$u,x.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(J,
E,this.$u),x.SourceControlId=this.id,x.MethodData=this.iz,x);this.r0.lJ(-1014260128,J)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(C.a)(d,"RibbonButton",null,[]);e.prototype.setVisibility=function(x){var y=b(1063).DynamicRibbon,J=this.ed.OwnerAddinStoreType,E=this.ed.PrimaryMarketplace.MarketplaceRef,A={};A=(A.addinAssetId=Telemetry.PrivacyRules.GetAssetId(J,E,this.$u),A.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(J,
E,this.ed.OwnerAddinAssetId),A.ownerAddinStoreType=J,A.ribbonControlType="Tab",A.toggle=x,A);r.a.sendTelemetryEvent(Object.assign(new t.a,{name:y.duc+"ControlUpdate",dataFields:h.a.fy(A)}));y={};x=(y.DynamicAddinCommandsMethodDispatchId=2,y.SolutionId=this.$u,y.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(J,E,this.$u),y.StoreType=J,y.SourceControlId=this.id,y.MethodData=x,y);this.r0.lJ(-1014260128,x)};e.prototype._OnAccess=function(){};e.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};
e.prototype.invokePropertyGet=function(x){switch(x){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};e.prototype.invokePropertyGetAsync=function(x){x=this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};e.prototype.invokePropertySet=function(x){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};e.prototype.invokePropertySetAsync=function(x,y){this.invokePropertySet(x,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
e.prototype.invokeMethod=function(x,y){switch(x){case 3:return this.kaj(y);case 1:return this.wAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};e.prototype.invokeMethodAsync=function(x,y){x=this.invokeMethod(x,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};e.prototype.kaj=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");this.setVisibility(x);return null};e.prototype.wAa=function(){this._OnAccess();return null};
Ll.Object.defineProperties(e.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(C.a)(e,"RibbonTab",null,[]);var B=b(1107),z=b(154);b.d(F,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(x){try{var y={},J=(y.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ed.OwnerAddinStoreType,this.ed.PrimaryMarketplace.MarketplaceRef,this.$u),y.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ed.OwnerAddinStoreType,this.ed.PrimaryMarketplace.MarketplaceRef,
this.ed.OwnerAddinAssetId),y.ownerAddinStoreType=this.ed.OwnerAddinStoreType,y.ribbonControlType="Ribbon",y);r.a.sendTelemetryEvent(Object.assign(new t.a,{name:a.duc+"ExecuteRequestCreate",dataFields:h.a.fy(J)}));var E=z.a.Xh(x);x={};y={};y[v.a.GGa]=this.Gx;y[v.a.HGa]=E;y[v.a.S1c]=this.ed;x[v.a.Dpb]=3;x[v.a.E2]=this.$u;x[v.a.c3b]=Telemetry.PrivacyRules.GetAssetId(this.ed.OwnerAddinStoreType,this.ed.PrimaryMarketplace.MarketplaceRef,this.$u);x[v.a.D2]=y;this.r0.lJ(-1014260128,x);var A=a.u6b("ExecuteRequestCreate",
!0,"");l.ULS.sendTraceTag(538572826,0,50,A)}catch(H){E=a.u6b("ExecuteRequestCreate",!1,H.toString()),l.ULS.sendTraceTag(538572825,0,50,E)}return null};a.prototype.executeRequestUpdate=function(x){try{var y=null,J=null;y=this.ed.OwnerAddinStoreType;J=this.ed.PrimaryMarketplace.MarketplaceRef;var E={},A=(E.addinAssetId=Telemetry.PrivacyRules.GetAssetId(y,J,this.$u),E.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(y,J,this.ed.OwnerAddinAssetId),E.ownerAddinStoreType=this.ed.OwnerAddinStoreType,
E.ribbonControlType="Ribbon",E);r.a.sendTelemetryEvent(Object.assign(new t.a,{name:a.duc+"ExecuteRequestUpdate",dataFields:h.a.fy(A)}));var H=z.a.Xh(x);x={};E={};E[v.a.GGa]=this.Gx;E[v.a.HGa]=H;E[v.a.S1c]=this.ed;x[v.a.Dpb]=3;x[v.a.E2]=this.$u;x[v.a.c3b]=Telemetry.PrivacyRules.GetAssetId(y,J,this.$u);x[v.a.D2]=E;this.r0.lJ(-1014260128,x);var S=a.u6b("ExecuteRequestUpdate",!0,"");l.ULS.sendTraceTag(538572824,0,50,S)}catch(Q){y=a.u6b("ExecuteRequestUpdate",!1,Q.toString()),l.ULS.sendTraceTag(538572823,
0,50,y)}return null};a.prototype.getButton=function(x){var y=null;if(!this.u4e())return this.Pue();if(x&&0<x.length){if(!this.Zpe(x))return this.hve(x);y=new d(x,this.$u,this.r0,this.ed)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)};a.prototype.getTab=function(x){var y=null;if(!this.u4e())return this.Pue();if(this.Gx.getOwnerAddinControlRecreated())return this.IUg();if(x&&0<x.length){if(!this.Zpe(x))return this.hve(x);y=new e(x,this.$u,this.r0,this.ed)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)};
a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(x){switch(x){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};a.prototype.invokePropertyGetAsync=function(x){x=this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};a.prototype.invokePropertySet=function(x){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);
};a.prototype.invokePropertySetAsync=function(x,y){this.invokePropertySet(x,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(x){switch(x){case 1:return this.wAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};a.prototype.invokeMethodAsync=function(x,y){switch(x){case 7:return this.ijh(y);case 6:return this.jjh(y);case 3:return this.avh(y);case 5:return this.iJh(y)}x=this.invokeMethod(x,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};
a.prototype.ijh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.executeRequestCreate(x)};a.prototype.jjh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.executeRequestUpdate(x)};a.prototype.avh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.getButton(x)};a.prototype.iJh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");
return this.getTab(x)};a.prototype.wAa=function(){this._OnAccess();return null};a.prototype.hve=function(x){return B.a(w.a.lQg,z.a.da(1695)+x)};a.prototype.Pue=function(){return B.a(w.a.F_i,z.a.da(1691))};a.prototype.IUg=function(){return B.a(w.a.hostRestartNeeded,z.a.da(1696))};a.prototype.u4e=function(){var x=this.Gx.getSharedRuntimeId();x=!!x&&0<x.length;l.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",x));return x};a.prototype.Zpe=function(x){var y=
this.Wfg.getRibbonExtensionControlMap();return x in y||this.UJg(x)};a.prototype.UJg=function(x){var y=this.Qmh();if(y){y=Ol(y.JBe.tabs);for(var J=y.next();!J.done;J=y.next()){J=J.value;if(J.id===x)return!0;J=Ol(J.groups);for(var E=J.next();!E.done;E=J.next()){E=Ol(E.value.controls);for(var A=E.next();!A.done;A=E.next()){A=A.value;if(A.id===x)return!0;if("Menu"===A.type){A=Ol(A.items);for(var H=A.next();!H.done;H=A.next())if(H.value.id===x)return!0}}}}}return!1};a.prototype.Qmh=function(){return n.a.getInstance().sP(this.ed.PrimaryMarketplace.MarketplaceType,
this.ed.PrimaryMarketplace.SolutionId,1)};a.u6b=function(x,y,J){var E={};E.methodName="DynamicRibbon."+x;E.result=y?"Succeeded":"Failed";E.message=J;return z.a.Hc(E)};Ll.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.duc="Office.Online.Extensibility.Ribbon.";Object(C.a)(a,"DynamicRibbon",null,[])},1085:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);a.F4b="extId";a.Wse="ComponentType";a.jFa="ComponentId";a.Rdd="HostProps";
a.Wwa="OptionalProps";Object(C.a)(a,"ActionPropertyNames",null,[])},1104:function(C,F,b){function a(e,d){var l=!1;e&&(e=d.osfControl,(d=e.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!e.getIsUpgrading()&&(l=!0));return l}b.d(F,"a",function(){return a})},1105:function(C,F,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.Hfa=this.LQa=this.X9c=this.dbd=this.Vsb=this.ONd=null}b.d(F,"a",function(){return a});C=b(0);Object(C.a)(a,"AppsForOfficeOauthResult",null,
[])},1107:function(C,F,b){function a(e,d){return OfficeExtension.WacRuntime.Utility.createPromise(function(l,n){n(OfficeExtension.WacRuntime.Utility.createRichApiException(e,d))})}b.d(F,"a",function(){return a})},1220:function(C,F,b){function a(ea,ta,Ka){this.Pua=!1;this.aE={};this.$=ea;this.sg=ta;this.Jfd().Yba();this.indexedDB=Ka;this.indexedDB.Yf()&&(this.Pua=!0,this.indexedDB.initialize(a.Led,a.Med))}function e(ea,ta){this.bLc=ea;this._message=ta}function d(){}function l(){}function n(ea){switch(ea){case 0:return"Medium";
case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function r(ea,ta){z(b(1220).CustomFunctionsInstaller.ORe("CustomFunctionsRuntimeLogging"),function(Ka){if(Ka.result&&window.console)switch(Ka=n(ea.severity)+" "+ea.message+ta,ea.severity){case 2:window.console.log&&window.console.log(Ka);break;case 0:window.console.info&&window.console.info(Ka);break;case 1:window.console.error&&window.console.error(Ka)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}
function h(ea,ta,Ka,mb,Ha){Ka=ea.CWCT(function(){ta(ea)},Ka,3,mb);Ka.continueWith(function(){S.ULS.sendTraceTag(537163459,0,10,Ha)},4);return Ka}function v(ea,ta,Ka){return h(ea,ta,ca.a.none,ra.a.current,Ka)}function w(ea,ta,Ka,mb,Ha){Ka=ea.CWRCT(function(){return ta(ea)},Ka,3,mb);Ka.continueWith(function(){S.ULS.sendTraceTag(537163460,0,10,Ha)},4);return V.TaskExtensions.Bvc(Ka)}function t(ea,ta,Ka){return w(ea,ta,ca.a.none,ra.a.current,Ka)}function B(ea,ta,Ka,mb,Ha){Ka=ea.CWRCT(function(){return ta(ea)},
Ka,3,mb);Ka.continueWith(function(){S.ULS.sendTraceTag(537163461,0,10,Ha)},4);return Ka}function z(ea,ta,Ka){return B(ea,ta,ca.a.none,ra.a.current,Ka)}function x(ea,ta,Ka,mb,Ha){Ka=ea.CWRCT(function(){return ta(ea)},Ka,3,mb);Ka.continueWith(function(){S.ULS.sendTraceTag(537163462,0,10,Ha)},4);return V.TaskExtensions.Bvc(Ka)}function y(ea,ta,Ka){return x(ea,ta,ca.a.none,ra.a.current,Ka)}function J(ea,ta,Ka,mb,Ha){Ka=ea.CWCT(function(){ta(ea)},Ka,3,mb);Ka.continueWith(function(){S.ULS.sendTraceTag(537163463,
0,10,Ha)},4);return Ka}function E(ea,ta,Ka){return J(ea,ta,ca.a.none,ra.a.current,Ka)}function A(){}function H(ea){ea=ea.split("|");this.$u=ea[1];this.HLc=ea[2];this.GMd=ea[3]}b.r(F);C=b(0);var S=b(15),Q=b(5),L=b(139),aa=b(211),fa=b(83),W=b(514),G=b(161),N=b(81),Y=b(58),V=b(35),da=b(220),U=b(126),Z=b(550);Ll.Object.defineProperties(H.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.$u}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.HLc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.GMd===OSF.StoreTypeEnum.Registry.toString()}}});Object(C.a)(H,"AddinStoreInfo",null,[]);Object(C.a)(A,"CustomFunctionRegistrationInfos",null,[]);var ca=b(194),ra=b(61),La=b(1104);Object(C.a)(l,"InstallationInfo",null,[]);Object(C.a)(d,"UninstallationInfo",null,[]);var na=b(26),ma=b(92),xa=b(32),Pa=b(27),ib=b(1),pb=b(7),xb=b(275),Ya=b(895),ab=b(51);Ll.Object.defineProperties(e.prototype,{severity:{configurable:!0,enumerable:!0,
get:function(){return this.bLc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(C.a)(e,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsInstaller",function(){return a});a.prototype.Ifd=function(ea,ta,Ka,mb){if(!pb.a.ma(mb.invariantNamespace))for(var Ha=0;Ha<mb.invariantNamespace.length;++Ha){var Ga=mb.invariantNamespace.charAt(Ha);if("."!==Ga&&"_"!==Ga&&"a">Ga&&"z"<Ga&&"A">Ga&&"Z"<Ga&&"0">Ga&&"9"<Ga)throw S.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
Ga,Ha),Error.create("InvariantNamespace validation failed");}var Fa=this;return y(this.qGg(Ka,mb.manifest),function(){return y(Fa.Jzd(ea),function(eb){var db=eb.result;return db&&db.isDynamicMetadata?Fa.PAd(ea,ta,db,!1,!1,!1):y(Fa.xDj(ea,ta,mb),function(Na){var kb;db=(kb=new l,kb.addinId=Ka,kb.locale=mb.locale,kb.addinInvariantNamespace=mb.invariantNamespace,kb.addinNamespace=mb.namespace,kb.addinTitle=mb.title,kb.isXllCompatible=mb.isXllCompatible,kb.metadataContent=JSON.stringify(JSON.parse(Na.result)),
kb);return Fa.PAd(ea,ta,db,!1,a.jkh(mb.osfControl.getStoreType()),La.a(Fa.$,mb))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.g2e=function(ea,ta,Ka,mb){var Ha=this;if(!a.Mkd(Ka))throw S.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),
Error.create("Invalid Metadata JSON");return y(this.Jzd(ea),function(Ga){Ga=Ga.result;if(!Ga&&(Ga=xa.a.zc(Ha.jU,ea),!Ga))throw S.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetAssetId(ta,null,ea))),Error.create("Customfunctions dynamic registration failed");Ga.metadataContent=JSON.stringify(JSON.parse(Ka));Ga.isDynamicMetadata=!0;return Ha.PAd(ea,
ta,Ga,!0,!0,mb)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};a.prototype.M0f=function(ea,ta){var Ka=this;this.sg.$ga();var mb=Object.assign(new d,{solutionId:ea}),Ha=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(ta,null,ea));return y(this.yBd(ea),function(){return y(Ka.FBd(ea),function(){return Ka.aQd(Ka.sg,ea,ta,mb)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},
Ha)};a.prototype.xDj=function(ea,ta,Ka){var mb=new L.a;OSF.OUtil.xhrGet(Ka.metadataUrl,function(Ha){Ha?mb.setResult(Ha):mb.setException(Error.create("Invalid manifest"))},function(Ha){S.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetAssetId(ta,null,ea),Ha);mb.setException(Error.create("Failed to download manifest"))});return mb.task};a.prototype.Jfd=function(){var ea=
this;return y(this.Tlc(),function(ta){var Ka=ta.result;if(!Ka.length)return ab.Task.Ra(!0);S.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");ta=new aa.a;for(var mb=[],Ha={},Ga=0;Ga<Ka.length;Ha={LLb:Ha.LLb},Ga++)Ha.LLb=Object(fa.a)(String,Ka[Ga]),ta.add(z(ea.Jzd(Ha.LLb),function(Fa){return function(eb){if(eb=eb.result){var db=xa.a.zc(ea.aE,eb.addinId);db&&db===eb.metadataContent||(ea.aE[eb.addinId]=eb.metadataContent,
ea.jU[Fa.LLb]=eb,Array.add(mb,eb))}return!0}}(Ha),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return t(ab.Task.WAE(ta),function(){if(mb.length){var Fa,eb=(Fa=new A,Fa.registrationInfos=mb,Fa);return ea.lXb(ea.sg,Ka,eb)}S.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ab.Task.Ra(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.h2e=function(){var ea=this,ta=new L.a;new aa.a;var Ka=[],mb=[];Object.keys(this.jU).forEach(function(Ha){Ha=Object(fa.a)(String,Ha);var Ga=xa.a.zc(ea.jU,Ha);Array.add(Ka,Ga);Array.add(mb,Ha)});if(!mb.length)return ta.setResult(!0),ta.task;ta=Object.assign(new A,{registrationInfos:Ka});return this.lXb(this.sg,mb,ta)};a.prototype.Tlc=function(){return z(this.o$c(Z.a.gWa),function(ea){ea=ea.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(pb.a.ma(ea)?
"[]":ea))?Sys.Serialization.JavaScriptSerializer.deserialize(pb.a.ma(ea)?"[]":ea):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.m6f=function(ea){return this.HHd(Z.a.gWa,Sys.Serialization.JavaScriptSerializer.serialize(ea))};a.prototype.Jzd=function(ea){return y(this.o$c(Z.a.S0a(ea)),function(ta){ta=pb.a.ma(ta.result)?"":ta.result;return 0<ta.length?ab.Task.Ra(Sys.Serialization.JavaScriptSerializer.deserialize(ta,!0)):
ab.Task.Ra(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.qDj=function(ea,ta){var Ka=this;return y(this.nDe(ea),function(){return y(Ka.HHd(Z.a.S0a(ea),Sys.Serialization.JavaScriptSerializer.serialize(ta)),function(){return a.IHd(Z.a.Jcd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};
a.prototype.yBd=function(ea){var ta=this;return y(this.RDf(ea),function(){return y(ta.jEf(Z.a.S0a(ea)),function(){return y(ta.Tlc(),function(Ka){return Ka.result.length?ab.Task.Ra(!0):a.IHd(Z.a.Jcd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};
a.prototype.BBf=function(ea){return this.o$c(Z.a.R0a(ea))};a.prototype.j6f=function(ea,ta){var Ka=this;return y(this.nDe(ea),function(){return Ka.HHd(Z.a.R0a(ea),ta)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.FBd=function(ea){var ta=this;return y(this.RDf(ea),function(){return ta.jEf(Z.a.R0a(ea))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.nDe=function(ea){var ta=
this;return y(this.Tlc(),function(Ka){Ka=Ka.result;var mb=ea.toLowerCase();if(Array.contains(Ka,mb))return ab.Task.Ra(!0);Ka.push(mb);return ta.m6f(Ka)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.RDf=function(ea){var ta=this;return y(this.Tlc(),function(Ka){Ka=Ka.result;var mb=ea.toLowerCase();return Array.contains(Ka,mb)?(Ka.splice(Array.indexOf(Ka,mb),1),ta.m6f(Ka)):ab.Task.Ra(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.qGg=function(ea,ta){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ea=new OSF.AddinIdInfo(ea),ea.needToRestoreManifest()?this.j6f(ea.getSolutionId(),ta):ab.Task.Ra(!0);ea=new H(ea);return ea.needToRestoreManifest?this.j6f(ea.solutionId,ta):ab.Task.Ra(!0)};a.prototype.e_i=function(ea){var ta=this;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var Ka=new OSF.AddinIdInfo(ea);return Ka.needToRestoreManifest()?
z(this.BBf(Ka.getSolutionId()),function(Ha){Ha=Ha.result;pb.a.ma(Ha)||OSF.OsfManifestManager.cacheManifestFromXml(Ka.getSolutionId(),Ka.getSolutionVersion(),Ha,ta.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ab.Task.Ra(!0)}var mb=new H(ea);return mb.needToRestoreManifest?z(this.BBf(mb.solutionId),function(Ha){Ha=Ha.result;pb.a.ma(Ha)||OSF.OsfManifestManager.cacheManifestFromXml(mb.solutionId,mb.solutionVersion,Ha,ta.$.ya.UICultureTag);
return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ab.Task.Ra(!0)};a.prototype.jEf=function(ea){return this.Pua?this.indexedDB.Kye(ea):a.CSi(ea)};a.prototype.HHd=function(ea,ta){return this.Pua?this.indexedDB.U9a(new Ya.a(ea,ta)):a.IHd(ea,ta)};a.prototype.o$c=function(ea){return this.Pua?this.indexedDB.iIa(ea):a.ORe(ea)};a.prototype.PAd=function(ea,ta,Ka,mb,Ha,Ga){var Fa=this,eb=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetAssetId(ta,null,ea));return V.TaskExtensions.Bvc(z(this.QAd(this.sg,ea,ta,Ka,!1,mb,Ga),function(){return Ha?Fa.qDj(ea,Ka):ab.Task.Ra(!0)},eb))};a.prototype.QAd=function(ea,ta,Ka,mb,Ha,Ga,Fa){var eb=this;if(!Ga&&(Ga=xa.a.zc(this.aE,mb.addinId))&&Ga===mb.metadataContent)return ab.Task.Ra(!0);this.aE[mb.addinId]=mb.metadataContent;this.jU[ta]=mb;Fa||ea.ODb(ta);ea.$ga();return y(this.lQi(ta,Ka,mb),function(){return eb.vyd(mb.addinId,Ha)},"Failed to register functions for customfunction addin")};
a.prototype.lQi=function(ea,ta,Ka){var mb=this,Ha=new L.a,Ga=this.cmb(Ka);return this.gha(function(Fa){ib.EwaSettings.ka(259)&&r(a.Fob,ea);(Fa=Fa.Result)&&204===Fa.ResponseStatusCode?Ha.setResult(!0):(delete mb.aE[Ka.addinId],delete mb.jU[ea],E(mb.yBd(ea),function(){E(mb.FBd(ea),function(){mb.SSf()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ea,Fa?Fa.ResponseStatusCode.toString():
"Unknown")),Ha.setResult(!1))},function(Fa){Fa=U.a.xg(Fa.data);S.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(ta,null,ea),Pa.a.Uc(Fa));ib.EwaSettings.ka(259)&&r(a.Eob,ea);delete mb.aE[Ka.addinId];delete mb.jU[ea];Ha.setResult(!1)},Ga,Ha,!0)};a.prototype.lXb=function(ea,ta,Ka){var mb=this,Ha=new L.a,Ga=na.a.Qa.oe.m;ta.forEach(function(eb){eb=Object(fa.a)(String,
eb);ea.Cpe(eb)});ea.$ga();var Fa=this.aTc(Ka);return this.gha(function(eb){ib.EwaSettings.ka(259)&&r(a.Fob,Sys.Serialization.JavaScriptSerializer.serialize(ta));eb=eb.Result;var db=!0,Na=Sys.Serialization.JavaScriptSerializer.deserialize(eb.ResponseBody.toString());Na=Array.isArray(Na.value)?Na.value:null;for(var kb=new aa.a,Tb={hda:0};Tb.hda<Na.length;Tb={hda:Tb.hda},Tb.hda++)if(!Na[Tb.hda]){db=!1;var ha=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
eb.ResponseStatusCode);kb.add(y(mb.yBd(ta[Tb.hda]),function(lb){return function(){delete mb.aE[Ka.registrationInfos[lb.hda].addinId];delete mb.jU[ta[lb.hda]];return mb.FBd(ta[lb.hda])}}(Tb),ha))}v(ab.Task.WAE(kb),function(){E(mb.vyd("",!1),function(){S.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",na.a.Qa.oe.m-Ga);db?Ha.setResult(db):v(mb.SSf(),function(){Ha.setResult(db)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(eb){eb=U.a.xg(eb.data);S.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Pa.a.Uc(eb));ib.EwaSettings.ka(259)&&r(a.Eob,Sys.Serialization.JavaScriptSerializer.serialize(ta));
for(eb=0;eb<Ka.registrationInfos.length;eb++)delete mb.aE[Ka.registrationInfos[eb].addinId],delete mb.jU[ta[eb]];Ha.setResult(!1)},Fa,Ha,!0)};a.prototype.aQd=function(ea,ta,Ka,mb){var Ha=this;return y(this.Wuj(ea,ta,Ka,mb),function(){return Ha.vyd(mb.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.Wuj=function(ea,ta,Ka,mb){var Ha=new L.a;ea.ODb(ta);(ea=xa.a.zc(this.jU,ta))&&delete this.aE[ea.addinId];delete this.jU[ta];mb=this.lTc(mb);return this.gha(function(){ib.EwaSettings.ka(259)&&
r(a.B_c,ta);Ha.setResult(!0)},function(Ga){Ga=U.a.xg(Ga.data);S.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(Ka,Ka,ta),Pa.a.Uc(Ga));ib.EwaSettings.ka(259)&&r(a.A_c,ta);Ha.setResult(!1)},mb,Ha,!1)};a.prototype.gha=function(ea,ta,Ka,mb,Ha){function Ga(){function Tb(Wa,Ra,Yb){ib.EwaSettings.ka(259)&&r(Ha?a.z_c:a.C_c,ha.RequestBody);return N.i(eb.ua,"ExecuteRichApiRequest",
Ka,xb.b(Wa,ea),xb.a(Ra,ta),Yb,null,0)}if(Fa.qFa()||0<eb.ua.T2||0<eb.xk.T2)return!1;db&&Fa.zC(db);Na&&eb.yt(Na);kb&&eb.BC(kb);var ha=Ka.request,lb=0;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ha.RequestFlags&1&&256!==(ha.RequestFlags&256)||(lb=16):lb=ha.RequestFlags&1?0:16;ib.EwaSettings.pc()?Fa.ft(new G.a(507,0,Tb,lb|64)):Fa.ft(new W.a(507,0,Tb,lb));return!0}var Fa=this.$.userOperationManager,eb=this.$.ra,db=null,Na=null,kb=null;Ga()||(db=function(){Ga()},
Na=function(){Ga()},kb=function(){Ga()},Fa.jB(db),eb.Yr(Na),eb.lB(kb));return mb.task};a.prototype.cmb=function(ea){var ta={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};ta.RequestBody=JSON.stringify(ea);ta.RequestFlags=1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ta.RequestFlags|=256);ea=this.$.ra.ua.Na(1);ea.request=ta;return ea};a.prototype.aTc=function(ea){var ta={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};ta.RequestBody=JSON.stringify(ea);ta.RequestFlags=1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ta.RequestFlags|=256);ea=this.$.ra.ua.Na(1);ea.request=ta;return ea};a.prototype.lTc=function(ea){var ta={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ta.RequestBody=JSON.stringify(ea);ta.RequestFlags=1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ta.RequestFlags|=
256);ea=this.$.ra.ua.Na(1);ea.request=ta;return ea};a.prototype.vyd=function(ea,ta){var Ka=this,mb=Y.GetServiceTaskFactory.create(this.$.ea,153,this.$.la,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager");return x(mb,function(){mb.result.HDd();return!pb.a.ma(ea)&&ta?Ka.e_i(ea):ab.Task.Ra(!0)},this.$.la,da.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.SSf=function(){var ea=new ma.a(1949669462,
0,this.$.dd,0,null);return this.$.Ka.Ub(ea)};a.ORe=function(ea){try{return ab.Task.Ra(localStorage.getItem(ea))}catch(ta){return S.ULS.sendTraceTag(537163537,0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",pb.a.ma(ta.message)?"Unknown":ta.message),ab.Task.Ra(null)}};a.IHd=function(ea,ta){try{return localStorage.setItem(ea,ta),ab.Task.Ra(!0)}catch(Ka){return S.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",
pb.a.ma(Ka.message)?"Unknown":Ka.message),ab.Task.Ra(!1)}};a.CSi=function(ea){try{return localStorage.removeItem(ea),ab.Task.Ra(!0)}catch(ta){return S.ULS.sendTraceTag(537163535,0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",pb.a.ma(ta.message)?"Unknown":ta.message),ab.Task.Ra(!1)}};a.jkh=function(ea){return pb.a.equals(ea,"registry",!0)||pb.a.equals(ea,"uploadfiledevcatalog",!0)||Q.AFrameworkApplication.userNameUnknown||Q.AFrameworkApplication.limitedEdit};
a.Mkd=function(ea){if(pb.a.ma(ea))return!1;try{JSON.parse(ea)}catch(ta){return!1}return!0};Ll.Object.defineProperties(a.prototype,{jU:{configurable:!0,enumerable:!0,get:function(){return this.sg.jU}}});a.Led="CustomFunctionCache";a.Med="CustomFunction";a.z_c=new e(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Fob=new e(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Eob=new e(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.C_c=new e(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");
a.B_c=new e(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.A_c=new e(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(C.a)(a,"CustomFunctionsInstaller",null,[437])},1222:function(C,F,b){function a(U){this.aE={};this.$=U;this.Jfd().Yba()}function e(U,Z){this.bLc=U;this._message=Z}function d(){}function l(){}function n(U){switch(U){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function r(U,Z){if(b(1222).CustomFunctionsLegacyInstaller.rsb("CustomFunctionsRuntimeLogging")&&
window.console)switch(Z=n(U.severity)+" "+U.message+Z,U.severity){case 2:window.console.log&&window.console.log(Z);break;case 0:window.console.info&&window.console.info(Z);break;case 1:window.console.error&&window.console.error(Z)}}function h(){}function v(U){U=U.split("|");this.$u=U[1];this.HLc=U[2];this.GMd=U[3]}b.r(F);C=b(0);var w=b(15),t=b(1055),B=b(139),z=b(83),x=b(514),y=b(161),J=b(81),E=b(58),A=b(35),H=b(126),S=b(550),Q=b(1104);Ll.Object.defineProperties(v.prototype,{solutionId:{configurable:!0,
enumerable:!0,get:function(){return this.$u}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.HLc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.GMd===OSF.StoreTypeEnum.Registry.toString()}}});Object(C.a)(v,"AddinStoreInfo",null,[]);Object(C.a)(h,"CustomFunctionRegistrationInfos",null,[]);Object(C.a)(l,"InstallationInfo",null,[]);Object(C.a)(d,"UninstallationInfo",null,[]);var L=b(147),aa=b(32),fa=b(27),W=b(1),G=b(7),N=b(16),Y=b(275),V=
b(998),da=b(51);Ll.Object.defineProperties(e.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.bLc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(C.a)(e,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.Ifd=function(U,Z,ca,ra){var La=this,na=new B.a;if(!G.a.ma(ra.invariantNamespace))for(Z=0;Z<ra.invariantNamespace.length;++Z){var ma=ra.invariantNamespace.charAt(Z);if("."!==ma&&
"_"!==ma&&"a">ma&&"z"<ma&&"A">ma&&"Z"<ma&&"0">ma&&"9"<ma)return w.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",ma,Z),na.setResult(!1),na.task}a.cacheManifest(ca,ra.manifest);var xa=a.Kzd(U);xa&&xa.isDynamicMetadata?this.OAd(U,xa,na,!1,!1):OSF.OUtil.xhrGet(ra.metadataUrl,function(Pa){xa=Object.assign(new l,{addinId:ca,locale:ra.locale,addinInvariantNamespace:ra.invariantNamespace,addinNamespace:ra.namespace,
addinTitle:ra.title,isXllCompatible:ra.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Pa))});La.OAd(U,xa,na,!1,Q.a(La.$,ra))},function(Pa){w.ULS.sendTraceTag(537163528,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",U,Pa);na.setResult(!1)});return na.task};a.prototype.g2e=function(U,Z,ca,ra){Z=new B.a;if(!a.Mkd(ca))return w.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),
Z.setResult(!1),Z.task;var La=a.Kzd(U);if(!La)return w.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),Z.setResult(!1),Z.task;La.metadataContent=JSON.stringify(JSON.parse(ca));La.isDynamicMetadata=!0;this.OAd(U,La,Z,!0,ra);return Z.task};a.prototype.M0f=function(U){var Z=this,ca=new B.a,ra=E.GetServiceTaskFactory.create(this.$.ea,106,this.$.la,1,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");
A.TaskExtensions.Aa(ra,function(){var La=ra.result;La.$ga();var na=Object.assign(new d,{solutionId:U});a.zBd(U);a.GBd(U);A.TaskExtensions.Aa(Z.aQd(La,U,na),function(ma){L.b(ma)?ca.setResult(ma.result):(ma.gg?w.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",U):ma.wh&&w.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",U),
ca.setResult(!1))},Z.$.la,0)},this.$.la,3);return ca.task};a.prototype.Jfd=function(){var U=this,Z=new B.a,ca=a.Ozd();0<ca.length&&w.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var ra=[];ca.forEach(function(na){na=Object(z.a)(String,na);if(na=a.Kzd(na)){var ma=aa.a.zc(U.aE,na.addinId);ma&&ma===na.metadataContent||(U.aE[na.addinId]=na.metadataContent,Array.add(ra,na))}});if(!ra.length)return Z.setResult(!0),
w.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),Z.task;var La=E.GetServiceTaskFactory.create(this.$.ea,106,this.$.la,1,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");A.TaskExtensions.Aa(La,function(){var na=La.result,ma=Object.assign(new h,{registrationInfos:ra});A.TaskExtensions.Aa(U.lXb(na,ca,ma),function(xa){L.b(xa)?Z.setResult(xa.result):(xa.gg?w.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):
xa.wh&&w.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),Z.setResult(!1))},U.$.la,0)},this.$.la,3);return Z.task};a.prototype.d_i=function(U){U=new v(U);if(U.needToRestoreManifest){var Z=a.PNi(U.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(U.solutionId,U.solutionVersion,Z,this.$.ya.UICultureTag)}};a.prototype.OAd=function(U,Z,ca,ra,La){var na=this,ma=E.GetServiceTaskFactory.create(this.$.ea,106,this.$.la,
1,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");A.TaskExtensions.Aa(ma,function(){A.TaskExtensions.Aa(na.QAd(ma.result,U,Z,!1,ra,La),function(xa){L.b(xa)?((xa=xa.result)&&a.rDj(U,Z),ca.setResult(xa)):(xa.gg?w.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",U):xa.wh&&w.ULS.sendTraceTag(537163487,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",
U),ca.setResult(!1))},na.$.la,0)},this.$.la,3)};a.prototype.QAd=function(U,Z,ca,ra,La,na){var ma=this;if(!La&&(La=aa.a.zc(this.aE,ca.addinId))&&La===ca.metadataContent)return da.Task.Ra(!0);this.aE[ca.addinId]=ca.metadataContent;var xa=new B.a;na||U.ODb(Z);U.$ga();U=this.cmb(ca);return this.gha(function(Pa){W.EwaSettings.ka(259)&&r(a.Fob,Z);var ib=Pa.Result;204===ib.ResponseStatusCode?A.TaskExtensions.Aa(ma.uyd(xa,ca.addinId,ra),function(pb){pb.gg?G.a.ma(Z)?w.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",
ca.addinId):w.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",Z):pb.wh&&(G.a.ma(Z)?w.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ca.addinId):w.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
Z));xa.setResult(!1)},ma.$.la,4):(Pa=function(){delete ma.aE[ca.addinId];a.zBd(Z);a.GBd(Z);w.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",Z,ib.ResponseStatusCode);xa.setResult(!1)},Pa=Object.assign(new V.a,{vJa:OSF.InfoType.Error,title:ca.addinTitle,description:String.format(N.a.instance.Bb(152),N.a.instance.da(1809)),buttonText:N.a.instance.da(4),Wfa:Pa,r$b:!1,Sga:Pa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
t.a.nKd(Pa))},function(Pa){Pa=H.a.xg(Pa.data);w.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Z,fa.a.Uc(Pa));W.EwaSettings.ka(259)&&r(a.Eob,Z);delete ma.aE[ca.addinId];xa.setResult(!1)},U,xa,!0)};a.prototype.lXb=function(U,Z,ca){var ra=this,La=new B.a;Z.forEach(function(ma){ma=Object(z.a)(String,ma);U.Cpe(ma)});U.$ga();var na=this.aTc(ca);return this.gha(function(ma){W.EwaSettings.ka(259)&&
r(a.Fob,Sys.Serialization.JavaScriptSerializer.serialize(Z));ma=ma.Result;var xa=!0,Pa=Sys.Serialization.JavaScriptSerializer.deserialize(ma.ResponseBody.toString());Pa=Array.isArray(Pa.value)?Pa.value:null;for(var ib=0;ib<Pa.length;ib++)Pa[ib]||(xa=!1,delete ra.aE[ca.registrationInfos[ib].addinId],a.zBd(Z[ib]),a.GBd(Z[ib]),w.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",Z[ib],ma.ResponseStatusCode));
A.TaskExtensions.Aa(ra.uyd(La,"",!1),function(pb){pb.gg?w.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):pb.wh&&w.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");La.setResult(!1)},ra.$.la,4);La.setResult(xa)},function(ma){ma=H.a.xg(ma.data);w.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",
Sys.Serialization.JavaScriptSerializer.serialize(Z),fa.a.Uc(ma));W.EwaSettings.ka(259)&&r(a.Eob,Sys.Serialization.JavaScriptSerializer.serialize(Z));ma=Ol(ca.registrationInfos);for(var xa=ma.next();!xa.done;xa=ma.next())delete ra.aE[xa.value.addinId];La.setResult(!1)},na,La,!0)};a.prototype.aQd=function(U,Z,ca){var ra=this,La=new B.a;U.ODb(Z);U=this.lTc(ca);return this.gha(function(){W.EwaSettings.ka(259)&&r(a.B_c,Z);A.TaskExtensions.Aa(ra.uyd(La,ca.solutionId,!1),function(na){na.gg?G.a.ma(Z)||w.ULS.sendTraceTag(537163473,
0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",Z):na.wh&&(G.a.ma(Z)||w.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",Z));La.setResult(!1)},ra.$.la,4)},function(na){na=H.a.xg(na.data);w.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",
Z,fa.a.Uc(na));W.EwaSettings.ka(259)&&r(a.A_c,Z);La.setResult(!1)},U,La,!1)};a.prototype.gha=function(U,Z,ca,ra,La){function na(){function xb(ea,ta,Ka){W.EwaSettings.ka(259)&&r(La?a.z_c:a.C_c,Ya.RequestBody);return J.i(xa.ua,"ExecuteRichApiRequest",ca,Y.b(ea,U),Y.a(ta,Z),Ka,null,0)}if(ma.qFa()||0<xa.ua.T2||0<xa.xk.T2)return!1;Pa&&ma.zC(Pa);ib&&xa.yt(ib);pb&&xa.BC(pb);var Ya=ca.request,ab=Ya.RequestFlags&1?0:16;W.EwaSettings.pc()?ma.ft(new y.a(507,0,xb,ab|64)):ma.ft(new x.a(507,0,xb,ab));return!0}
var ma=this.$.userOperationManager,xa=this.$.ra,Pa=null,ib=null,pb=null;na()||(Pa=function(){na()},ib=function(){na()},pb=function(){na()},ma.jB(Pa),xa.Yr(ib),xa.lB(pb));return ra.task};a.prototype.cmb=function(U){var Z={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Z.RequestBody=JSON.stringify(U);Z.RequestFlags=1;U=this.$.ra.ua.Na(1);U.request=Z;return U};a.prototype.aTc=function(U){var Z={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
Z.RequestBody=JSON.stringify(U);Z.RequestFlags=1;U=this.$.ra.ua.Na(1);U.request=Z;return U};a.prototype.lTc=function(U){var Z={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Z.RequestBody=JSON.stringify(U);Z.RequestFlags=1;U=this.$.ra.ua.Na(1);U.request=Z;return U};a.prototype.uyd=function(U,Z,ca){var ra=this,La=E.GetServiceTaskFactory.create(this.$.ea,153,this.$.la,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager");A.TaskExtensions.Aa(La,
function(){La.result.HDd();!G.a.ma(Z)&&ca&&ra.d_i(Z);U.setResult(!0)},this.$.la,3);return La};a.prototype.h2e=function(){return da.Task.Ra(!0)};a.Ozd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.rsb(S.a.gWa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.rsb(S.a.gWa)||"[]"):null)||[]};a.n6f=function(U){a.JHd(S.a.gWa,Sys.Serialization.JavaScriptSerializer.serialize(U))};a.Kzd=function(U){U=a.rsb(S.a.S0a(U))||"";return 0<U.length?Sys.Serialization.JavaScriptSerializer.deserialize(U,
!0):null};a.rDj=function(U,Z){a.mDe(U);a.JHd(S.a.S0a(U),Sys.Serialization.JavaScriptSerializer.serialize(Z))};a.zBd=function(U){a.QDf(U);a.kEf(S.a.S0a(U))};a.PNi=function(U){return a.rsb(S.a.R0a(U))};a.sDj=function(U,Z){a.mDe(U);a.JHd(S.a.R0a(U),Z)};a.GBd=function(U){a.QDf(U);a.kEf(S.a.R0a(U))};a.mDe=function(U){var Z=a.Ozd();U=U.toLowerCase();Array.contains(Z,U)||(Z.push(U),a.n6f(Z))};a.QDf=function(U){var Z=a.Ozd();U=U.toLowerCase();Array.contains(Z,U)&&(Z.splice(Array.indexOf(Z,U),1),a.n6f(Z))};
a.cacheManifest=function(U,Z){U=new v(U);U.needToRestoreManifest&&a.sDj(U.solutionId,Z)};a.rsb=function(U){try{return localStorage.getItem(U)}catch(Z){return w.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",Z.message||"Unknown"),null}};a.JHd=function(U,Z){try{localStorage.setItem(U,Z)}catch(ca){w.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",
ca.message||"Unknown")}};a.kEf=function(U){try{localStorage.removeItem(U)}catch(Z){w.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",Z.message||"Unknown")}};a.Mkd=function(U){if(G.a.ma(U))return!1;try{JSON.parse(U)}catch(Z){return!1}return!0};a.z_c=new e(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Fob=new e(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Eob=new e(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
a.C_c=new e(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.B_c=new e(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.A_c=new e(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(C.a)(a,"CustomFunctionsLegacyInstaller",null,[437])},1231:function(C,F,b){function a(L,aa,fa,W,G){this.$=L;this.se=aa;this.ownerAddinInfo=fa;this.Zd=void 0===G?null:G;this.oOa=(void 0===W?null:W)||S.Task.Ra(!0);return this}function e(L){var aa=H.call(this)||this;aa.fBa=
"AddInCommandsDialog";aa.Ie=aa.fBa;aa.hc=5;aa.dialogWidth=695;aa.dialogHeight=438;aa.IPg="100%";aa.FPg="408px";aa.GPg="15px";aa.HPg="0";aa.Ngg=L;return aa}function d(L,aa,fa,W,G,N){var Y=L.Na(9);Y.sharedInfo=aa;return t.i(L,"InsertAgaveTaskpane",Y,fa,W,G,N,0)}function l(){}C=b(0);var n=b(194),r=b(15);Object(C.a)(l,"AddinCommandsHost",null,[]);var h=b(1274),v=b(1350),w=b(933),t=b(81),B=b(514),z=b(364),x=b(161),y=b(35),J=b(1),E=b(275),A=b(140),H=A.a;Em(e,H);e.prototype.qC=function(){H.prototype.qC.call(this);
this.Qo.style.width=this.IPg;this.Qo.style.height=this.FPg;this.Qo.style.marginTop=this.GPg;this.Qo.style.padding=this.HPg};e.prototype.mN=function(){H.prototype.mN.call(this);this.Lb.style.width=String.format("{0}px",this.dialogWidth);this.Lb.style.height=String.format("{0}px",this.dialogHeight)};e.prototype.dispose=function(){H.prototype.dispose.call(this);this.Ngg()};Ll.Object.defineProperties(e.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.Qo}}});Object(C.a)(e,
"AddInCommandsDialog",A.a,[]);var S=b(51),Q=b(61);A=b(106);b.d(F,"a",function(){return a});Em(a,l);a.prototype.CPg=function(){var L=this.oOa;this.oOa=S.Task.Ra(!0);return L};a.prototype.disposeHost=function(L){this.se.WNa(L)};a.prototype.setOwnerAddinEToken=function(L){this.ownerAddinInfo.eToken=L};a.prototype.showTaskpane=function(L,aa,fa){var W=this;r.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var G=null,N=!1;if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)){var Y=(new h.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new w.a,!0)).H_c(L.solutionId.substr(this.ownerAddinInfo.solutionId.length));G=aa.getSharedRuntimeForTaskpane("Workbook",Y);N=!!G&&1===G.LifeTime;if(this.se.pVc(N?this.ownerAddinInfo.solutionId:L.solutionId,N?G:null,null))return}else if(Y=(new h.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.assetId,new w.a,!0)).H_c(L.assetId.substr(this.ownerAddinInfo.assetId.length)),G=aa.getSharedRuntimeForTaskpane("Workbook",Y),
N=!!G&&1===G.LifeTime,this.se.pVc(N?this.ownerAddinInfo.assetId:L.assetId,N?G:null,null))return;this.Ocf(N,!0);this.oOa=this.Gfd(L,G,function(V,da){V?(N&&(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?V.PrimaryMarketplace.SolutionId=W.ownerAddinInfo.solutionId:V.PrimaryMarketplace.SolutionId=W.ownerAddinInfo.assetId,V.SharedRuntime=G),V.WebExtensionOsfControlType=3,W.se.IYa(V),fa(V.InstanceId,da),W.Ocf(N,!1)):(r.ULS.sendTraceTag(17306640,220,
10,"ShowTaskpane: instance id is null."),fa(null,da))})};a.prototype.getSettings=function(L,aa){var fa=null;(fa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.se.W2(L.solutionId):this.se.W2(L.assetId))?aa(this.se.HT(fa).OsfPropertyBag):this.oOa=this.Gfd(L,null,function(W){W?aa(W.OsfPropertyBag):r.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(L,aa,fa){function W(da,U,Z){return d(Y,
V,E.b(da,G),U,Z,null)}function G(da){var U=da.Result,Z=U?U.AgaveData:null;Z?(N.se.xwe(Z,function(){var ca=new e(function(){N.disposeHost(Z.InstanceId)});ca.initializeAndShow("",null,null);return ca.containerDiv}),fa(Z.InstanceId,0)):(r.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),fa(null,da.Errors?da.Errors[0].ErrorCause:5001))}var N=this;r.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var Y=this.$.ra.ua,V=a.qob(L,this.ownerAddinInfo);J.EwaSettings.pc()?this.oOa=
z.a(this.$.userOperationManager,W,function(da){return new x.a(500,0,da,64)},this.Zd):this.oOa=z.a(this.$.userOperationManager,W,function(da){return new B.a(500,0,da)},this.Zd)};a.prototype.createUILessSandbox=function(L,aa,fa){var W=this;r.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var G=aa.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),N=!!G&&1===G.LifeTime;(aa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.se.QKe(N?
this.ownerAddinInfo.solutionId:L.solutionId,N?G:null):this.se.QKe(N?this.ownerAddinInfo.assetId:L.assetId,N?G:null))?fa(aa,0):this.oOa=this.Gfd(L,G,function(Y,V){Y?(N?(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Y.PrimaryMarketplace.SolutionId=W.ownerAddinInfo.solutionId:Y.PrimaryMarketplace.SolutionId=W.ownerAddinInfo.assetId,Y.SharedRuntime=G,Y.TaskpaneVisible=!1,Y.WebExtensionOsfControlType=3,W.se.IYa(Y)):(Y.WebExtensionOsfControlType=
4,W.se.xwe(Y,function(){a.Jbb.ia(Y.InstanceId,new v.a);return a.Jbb.oa(Y.InstanceId).kGa})),fa(Y.InstanceId,V)):(r.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),fa(null,V))})};a.prototype.Gfd=function(L,aa,fa){function W(ra,La,na){return d(V,da,E.b(ra,G),La,na,null)}function G(ra){var La=ra.Result;(Y=La?La.AgaveData:null)||fa(null,ra.Errors?ra.Errors[0].ErrorCause:5001)}var N=this,Y=null,V=this.$.ra.ua,da=a.qob(L,this.ownerAddinInfo);aa&&(r.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),
da.SharedRuntimeId=aa.Resid);var U=500,Z=0;void 0===da.IsToBePersisted||null===da.IsToBePersisted||da.IsToBePersisted||(U=538,W=function(ra,La,na){r.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",da.CurrentStoreType,da.StoreId,Telemetry.PrivacyRules.GetAssetId(da.CurrentStoreType,da.StoreId,da.AssetId));ra=E.b(ra,G);var ma=V.Na(9,null);ma.sharedInfo=da;return t.i(V,"ShowAgaveTaskpane",ma,ra,La,na,null,0)},Z=16);if(J.EwaSettings.pc()){Z|=
64;var ca=z.a(this.$.userOperationManager,W,function(ra){return new x.a(U,0,ra,Z)},this.Zd)}else ca=z.a(this.$.userOperationManager,W,function(ra){return new B.a(U,0,ra,Z)},this.Zd);return y.TaskExtensions.ts(ca,function(){return Y?N.fnd(V,Y.InstanceId,function(ra,La){if(ra){aa||(Y.PrimaryMarketplace.MarketplaceType=L.storeType);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)&&(Y.OwnerAddinSolutionId=N.ownerAddinInfo.solutionId);Y.OwnerAddinAssetId=
N.ownerAddinInfo.assetId;Y.OwnerAddinStoreType=N.ownerAddinInfo.storeType;Y.OsfPropertyBag=[];for(La=0;La<ra.Settings.length;La++){var na=[];na[0]=ra.Settings[La].Name;na[1]=ra.Settings[La].Value;Y.OsfPropertyBag[La]=na}fa(Y,0)}else fa(null,La.Errors?La.Errors[0].ErrorCause:5001)}):S.Task.Ra(!1)},n.a.none,3,Q.a.current)};a.prototype.fnd=function(L,aa,fa){function W(N,Y,V){N=E.b(N,G);var da=L.Na(1);da.controlId=aa;return t.i(L,"DdaLoadSettings",da,N,Y,V,null,0)}function G(N){fa(N.Result,N)}return J.EwaSettings.pc()?
z.a(this.$.userOperationManager,W,function(N){return new x.a(501,0,N,80)},this.Zd):z.a(this.$.userOperationManager,W,function(N){return new B.a(501,0,N,16)},this.Zd)};a.prototype.Ocf=function(L,aa){L&&window.performance&&window.performance.memory&&r.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",aa,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};
a.showUILessDialog=function(L){a.Jbb.qb(L)&&a.Jbb.oa(L).initializeAndShowWithTitle()};a.hideUILessDialog=function(L){a.Jbb.qb(L)&&a.Jbb.oa(L).hide()};a.qob=function(L,aa){var fa={};J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(fa.SolutionId=L.solutionId,fa.Version=L.version,fa.StoreType=aa.storeType,fa.StoreId=L.storeId,fa.AssetId=L.solutionId,fa.AssetStoreId="omex",fa.TargetType=1,fa.Width=350,fa.OwnerAddinSolutionId=aa.solutionId,fa.OwnerAddinStoreType=
aa.storeType,fa.SharedRuntimeId=null,fa.Preload=!1,fa.Id=L.solutionId,fa.AppVersion=L.version,fa.CurrentStoreType=aa.storeType,fa.OwnerAddinAssetId=aa.assetId):(fa.AppVersion=L.appVersion,fa.StoreId=L.storeId,fa.AssetId=L.assetId,fa.CurrentStoreType=aa.storeType,fa.TargetType=1,fa.AssetStoreId="omex",fa.Width=350,fa.OwnerAddinAssetId=aa.assetId,fa.Id=fa.AssetId,fa.SharedRuntimeId=null,fa.Preload=!1);return fa};a.Jbb=new A.a;Object(C.a)(a,"WACExcelAddinCommandsHost",l,[])},1267:function(C,F,b){function a(e,
d,l,n){this._id=e;this.rkg=d;this.N$d=l;this.iSa=n}b.d(F,"a",function(){return a});C=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.rkg};a.prototype.getStoreType=function(){return this.N$d};Object(C.a)(a,"ExtensionIdentity",null,[451])},1268:function(C,F,b){function a(e,d,l){this.C3d=l}b.d(F,"a",function(){return a});C=b(0);Object(C.a)(a,"HostProperties",null,[])},1269:function(C,F,b){function a(){this.Ri={};this.gr={}}b.d(F,"a",function(){return a});
C=b(0);Object(C.a)(a,"ExtensionLaunchProperties",null,[])},1270:function(C,F,b){function a(){this.La=h.AFrameworkApplication.Hb}b.d(F,"a",function(){return a});C=b(0);var e=b(1267),d=b(1269),l=b(1085),n=b(1272),r=b(1268),h=b(5),v=b(586),w=b(28);a.prototype.iLa=function(t,B,z,x,y){this.r$h(t,B,z,x,y)};a.prototype.r$h=function(t,B,z,x,y){var J=b(1271).ExtensionComponentInstance,E={};E[l.a.F4b]=t;E[l.a.Wse]=B;E[l.a.jFa]=z;E[l.a.Rdd]=x;E[l.a.Wwa]=y;32===(B===n.a.action?this.La.Ge(w.a.DIe,2,E):this.La.Ge(w.a.$Sf,
2,E))?(x=v.a.create().toString(),y.Ri.InstanceToken&&(x=y.Ri.InstanceToken),t=new J(t,B,z,x),a.Yu[x]=t):t=new J(t,B,z,null);t.Y5i(E)};a.prototype.q$h=function(t){var B=t.ExtId,z=t.ComponentType,x=t.ComponentId,y=t.HostProps;t=t.OptionalProps;B=new e.a(B.Id,B.StoreId,B.StoreType,B.AppVersion);y=new r.a(y.HostType,y.FormFactor,y.Locale);var J=new d.a;J.Ri=t.OptionalProperties;J.gr=t.DevProperties;a.instance.iLa(B,z,x,y,J)};a.prototype.getInstance=function(t){return a.Yu[t]};a.prototype.ySi=function(t){delete a.Yu[t]};
Ll.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.qCc||(a.qCc=new a);return a.qCc}}});a.qCc=null;a.Yu={};Object(C.a)(a,"ExtensionLifeCycleManager",null,[450])},1271:function(C,F,b){function a(n,r,h,v){this.iSa=this.hF=null;this._id=n;this.yag=h;this.jeg=v;this.La=d.AFrameworkApplication.Hb?d.AFrameworkApplication.Hb:null}b.r(F);b.d(F,"ExtensionComponentInstance",function(){return a});C=b(0);var e=b(1270),d=b(5),l=b(28);a.prototype.G8c=function(){return this.yag};
a.prototype.Y5i=function(n){this.hF=n};a.prototype.stop=function(){var n=this.La.Ge(l.a.qMg,2,this.hF);e.a.instance.ySi(this.jeg);return 32===n};a.prototype.joc=function(){this.La.Ge(l.a.CIf,2,this.hF)};Ll.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.iSa}}});Object(C.a)(a,"ExtensionComponentInstance",null,[463])},1272:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);a.taskpane="Taskpane";a.action="Action";Object(C.a)(a,
"ComponentTypeNames",null,[])},1274:function(C,F,b){function a(l,n,r,h){this.gMc=this.rhb=this.iMc=null;this.uCa=l;d.AFrameworkApplication.ha.sa("AddInCommandsMissingTabIsEnabled")?(this.iMc=r.fDh(),this.rhb=r.g7a,this.gMc=r.Dii):(this.iMc=r.Ptc,this.gMc=this.rhb=null);this.xMb=n;this.zjg=h}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(5);a.prototype.mta=function(l){l=this.ZLa+this.assetId+l;return this.MJd?(l in a.EVb||(a.EVb[l]="AddinControl"+a.hvg++),a.EVb[l]):l};a.prototype.H_c=function(l){if(this.MJd){var n=
a.EVb,r;for(r in n){var h=r;if(l===n[r])return h.substr(this.ZLa.length+this.assetId.length)}}return l};a.prototype.Sad=function(l){l=this.ZLa+this.assetId+l;return this.MJd?(l in a.jQc||(a.jQc[l]="AddinTab"+a.mvg++),a.jQc[l]):l};a.prototype.kEh=function(l){return l.toLowerCase()in this.Ptc?(e.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",l.toLowerCase()),this.ZLa+this.Ptc[l.toLowerCase()]):null};a.prototype.xEh=function(){if(!this.g7a)return null;for(var l=[],n=Ol(this.g7a),r=n.next();!r.done;r=
n.next())l.push(this.ZLa+r.value);return l};a.prototype.eCh=function(l){l=this.hOe(l);return null===l?null:l[1]};a.prototype.cCh=function(l){l=this.hOe(l);return null===l?null:l[2]};a.prototype.hOe=function(l){return this.rNd&&l.toLowerCase()in this.rNd?(e.ULS.sendTraceTag(21017039,220,50,"Get attributes for Tab id: {0}.",l.toLowerCase()),this.rNd[l.toLowerCase()]):null};Ll.Object.defineProperties(a.prototype,{ZLa:{configurable:!0,enumerable:!0,get:function(){return this.uCa}},Ptc:{configurable:!0,
enumerable:!0,get:function(){return this.iMc}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.xMb}},g7a:{configurable:!0,enumerable:!0,get:function(){return this.rhb}},rNd:{configurable:!0,enumerable:!0,get:function(){return this.gMc}},MJd:{configurable:!0,enumerable:!0,get:function(){return this.zjg}}});a.EVb={};a.jQc={};a.mvg=0;a.hvg=0;Object(C.a)(a,"DefaultRibbonNamingProvider",null,[170])},1328:function(C,F,b){function a(y){this.Mz=null;this.KZf={};this.LZf={};this.c6c={};this.xrd=
{};this.$=y;this.Ppc=Object(d.a)(this,this.vcd,"handleServerEvent")}b.r(F);C=b(0);var e=b(15),d=b(37),l=b(83),n;(function(y){y[y.none=0]="none";y[y.testEvent=1]="testEvent";y[y.test1Event=2]="test1Event";y[y.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";y[y.worksheetActivatedEvent=11]="worksheetActivatedEvent";y[y.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";y[y.worksheetAddedEvent=13]="worksheetAddedEvent";y[y.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";
y[y.worksheetDeletedEvent=15]="worksheetDeletedEvent";y[y.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";y[y.worksheetFilteredEvent=17]="worksheetFilteredEvent";y[y.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";y[y.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";y[y.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";y[y.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";y[y.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";y[y.worksheetFormulaChangedEvent=
23]="worksheetFormulaChangedEvent";y[y.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";y[y.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";y[y.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";y[y.worksheetMovedEvent=27]="worksheetMovedEvent";y[y.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";y[y.chartAddedEvent=50]="chartAddedEvent";y[y.chartActivatedEvent=51]="chartActivatedEvent";y[y.chartDeactivatedEvent=52]=
"chartDeactivatedEvent";y[y.chartDeletedEvent=53]="chartDeletedEvent";y[y.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";y[y.tableDataChangedEvent=101]="tableDataChangedEvent";y[y.tableAddedEvent=102]="tableAddedEvent";y[y.tableDeletedEvent=103]="tableDeletedEvent";y[y.tableFilteredEvent=104]="tableFilteredEvent";y[y.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";y[y.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";y[y.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";y[y.commentAddedEvent=250]="commentAddedEvent";y[y.commentDeletedEvent=251]="commentDeletedEvent";y[y.commentChangedEvent=252]="commentChangedEvent";y[y.invocationMessage=1E3]="invocationMessage";y[y.cancellationMessage=1001]="cancellationMessage";y[y.metadataMessage=1002]="metadataMessage";y[y.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";y[y.visualChangeEvent=2001]="visualChangeEvent";y[y.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
y[y.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";y[y.shapeActivatedEvent=2101]="shapeActivatedEvent";y[y.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";y[y.shapeAddedEvent=2103]="shapeAddedEvent";y[y.shapeDeletedEvent=2104]="shapeDeletedEvent";y[y.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";y[y.wacOperationEvent=2201]="wacOperationEvent";y[y.recordingStateChangedEvent=2202]="recordingStateChangedEvent";y[y.workbookActivatedEvent=2203]="workbookActivatedEvent";
y[y.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";y[y.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";y[y.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";y[y.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";y[y.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";y[y.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
y[y.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";y[y.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";y[y.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";y[y.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";y[y.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";y[y.pivotTableAddedEvent=2900]="pivotTableAddedEvent";y[y.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
y[y.namedItemAddedEvent=3E3]="namedItemAddedEvent";y[y.namedItemDeletedEvent=3001]="namedItemDeletedEvent";y[y.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";y[y.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(n||(n={}));Object(C.b)("MessageType",n);var r=b(878),h=b(232),v=b(843),w=b(55),t=b(35),B=b(147),z=b(1),x=b(7);b.d(F,"DdaEventDispatch",function(){return a});a.prototype.kVb=function(y){y&&(this.$ga(),Array.add(this.Mz,y))};a.prototype.hnc=
function(y){this.Mz&&(Array.remove(this.Mz,y),this.Mz.length||(this.$.wantServerEvents=!1,this.$.MVi(this.Ppc),this.Mz=null))};a.prototype.vcd=function(y,J){y=this.$.Vb.Dc("Task","DdaEventDispatch.HandleServerEvent");J=J.BMf;for(var E=0;E<J.length;E++)switch(J[E].EventType){case 2:var A=J[E],H={};H.Name=A.Name;H.BindingType=A.BindingType;H.ColCount=A.ColCount;H.RowCount=A.RowCount;this.Tta(A.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,H,null);break;case 4:this.Tta(J[E].InstanceId,
OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(A=J[E],x.a.ma(A.InstanceId)){this.c6c={};this.xrd={};for(H=0;H<A.Entries.length;H++)this.hAe(A.Entries[H],A.IsRemoteOverride);e.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",this.c6c,this.xrd,this.KZf,this.LZf)}else{H=Array(A.Entries.length);for(var S=0;S<A.Entries.length;S++)H[S]=a.x8b(A.Entries[S],A.IsRemoteOverride);
0<A.Entries.length&&1===A.Entries[0].Category?this.uJi(A.InstanceId,H):A.InstanceId&&this.Tta(A.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,H)}}y.stop()};a.prototype.uJi=function(y,J){var E=this,A=Object(l.a)(v.DdaFacade,h.a(this.$));t.TaskExtensions.Aa(A.uEh(y),function(H){if(B.b(H)){var S=H.result;H=A.Pm(S);if(S)if(H.Rid)E.Tta(S,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J);else if(H.y_c)for(S=0;S<J.length;S++)Array.add(H.y_c,J[S]);else H.y_c=J}else H.gg?e.ULS.sendTraceTag(537170591,
0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):H.wh&&e.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.PFb=function(y,J){this.Tta(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J)};a.prototype.QJi=function(y,J){var E=Object(l.a)(v.DdaFacade,h.a(this.$)),A=E.qth(y);A?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(A,J,
Object(d.a)(this,this.PFb,"sendActionToAddin")):E.LRg(y,J)};a.prototype.hAe=function(y,J){var E=!1,A=parseInt(y.Type),H=y.Target,S=Object(l.a)(v.DdaFacade,h.a(this.$));if((H=S.Ti.AEh(A,H))&&0<Object.keys(H).length){E=!0;for(var Q in H)if(H=Q,S.Ti.BWb(H)){var L=Array(1);L[0]=a.x8b(y,J);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var aa=L[0][3];if(void 0!==aa&&null!==aa&&(aa=Object(l.a)(Object,w.a.Xh(aa)))&&void 0!==aa.triggerControlId&&null!==aa.triggerControlId&&
void 0!==aa.triggerSource&&null!==aa.triggerSource){var fa=!1;J?(aa.triggerSource="Unknown",fa=!0):S.B4g(aa.triggerControlId,H)&&(aa.triggerSource="ThisLocalAddin",fa=!0);fa&&(L[0][3]=w.a.Hc(aa))}}this.Tta(H,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,L)}}E?(this.fac(n[A],this.c6c),this.fac(n[A],this.KZf)):(this.fac(n[A],this.xrd),this.fac(n[A],this.LZf))};a.prototype.$ga=function(){this.Mz||(this.Mz=[],this.$.tge(this.Ppc),this.$.wantServerEvents=!0)};a.prototype.fac=function(y,J){y in J||
(J[y]=0);J[y]+=1};a.prototype.AL=function(y,J,E){var A={};A.Target=J;A.Category=65536;A.Type=y;A.Message=E;A.Id=-1;this.hAe(A,!1)};a.prototype.hnh=function(y,J){var E={Target:"",Category:2,Type:1E3};E.Message=J;E.Id=0;J=Array(1);J[0]=a.x8b(E,!1);this.QJi(y,J)};a.prototype.u5b=function(y,J,E,A){var H={};H.Target=E;H.Category=65536;H.Type=J;H.Message=A;H.Id=-1;J=Array(1);J[0]=a.x8b(H,!1);this.Tta(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J)};a.prototype.gnh=function(y,J){this.Tta(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,J)};a.prototype.Tta=function(y,J,E,A){if(this.Mz){var H=Object(l.a)(v.DdaFacade,h.a(this.$));if(!H||J!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&J!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||H.Ti.BWb(y))for(y=new r.a(J,y,E,A),J=0,E=this.Mz.length;J<E;J++)(A=this.Mz[J])&&A(y)}};a.x8b=function(y,J){var E=Array(6);E[0]=y.Category;E[1]=y.Type;E[2]=y.Target;E[3]=y.Message;E[4]=y.Id;E[5]=J;return E};Object(C.a)(a,"DdaEventDispatch",null,[])},1350:function(C,F,b){function a(){var l=
d.call(this,void 0,void 0,void 0,!0)||this;l.fBa="AddinCommandsUILessDialog";l.IMc="WACDialogTitleText";l.DSa="0";l.iBa=380;l.Neb=190;l.Ie=l.fBa;l.hc=5;l.Fag=String.format("{0}px",l.iBa);l.CSa=String.format("{0}px",l.Neb);l.lu=!1;l.HYe=!1;l.qC();return l}b.d(F,"a",function(){return a});C=b(0);F=b(140);var e=b(87),d=F.a;Em(a,d);a.prototype.qC=function(){d.prototype.qC.call(this);this.Qo.style.width=this.Fag;this.Qo.style.height=this.CSa;this.Qo.style.padding=this.DSa};a.prototype.Eu=function(l){this.mN();
document.getElementById(this.Yh(this.IMc)).innerText=l};a.prototype.mN=function(){d.prototype.mN.call(this);this.Lb.style.width=String.format("{0}px",this.iBa);this.Lb.style.height=String.format("{0}px",this.Neb);this.Lb.removeAttribute(e.a.Od);this.Lb.removeAttribute(e.a.lD)};a.prototype.hide=function(){this.Ztb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Ll.Object.defineProperties(a.prototype,{kGa:{configurable:!0,
enumerable:!0,get:function(){return this.Qo}}});Object(C.a)(a,"AddinCommandsUILessDialog",F.a,[807])},1356:function(C,F,b){function a(I){return cl.call(this,I)||this}function e(I,la,Va){this.rangePicker=null;this.$=I;this.se=la;this.pe=new Y(I.fa);this.Zy=new Q(I,this.pe);this.shf=Va;this.f5c=new al.ScriptSharpLegacyMap}function d(I,la,Va,Kb,nc){this.nNc=null;this.uMb=I;this.oz=la;this.bI=Va;this.ub=Kb;this.kmg=nc}function l(){}function n(){this.Jea=null}function r(I){if(!I)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",
"wacApiDelegates parameter is null");this.Tod=I}function h(I,la,Va){return function(Kb){return function(nc,Mc){wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.create(la.ea,279,la.la,1,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),function(Yc){Yc=Yc.result;var Ed=!1,re=Va.sh.getOsfControl(I),pf=null;re&&(pf=re.getStoreType(),(re=re.getManifest())&&re.getSharedRuntimeForCustomFunctions("Workbook")&&(Ed=!0));wh.TaskExtensions.Aa(Yc.g2e(I,pf,Kb,Ed),function(Ze){sk.b(Ze)?
Ze.result?nc(null):Mc(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.invalidArgument,Gf.a.instance.da(1693))):Mc(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,Gf.a.instance.da(1689)))},la.la,3)},la.la,3)}}}function v(I,la){this.NN=oi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.oz=I;this.bI=la;this.Zgg=this.bI.sh.getOsfControl(this.oz)}function w(I,la,Va,Kb){this.bWd="";this.mOb=0;this.NN=I;this._id=la;this.oz=
Va;this.bI=Kb}function t(I,la,Va){this.peg=I;this.qeg=la;this.hig=Va}function B(){this.O$d=this.V4d=this.iz=!1}function z(I,la,Va,Kb){this.$u=I;this.r0=Va;this.Gx=Kb.sh.getOsfControl(la)}function x(I,la){this.bI=la;this.oz=I}function y(I){this.oz=I}function J(I){this.zGa={};this.Rgi=I}function E(I,la){this.addinId=I;this.$=la;return this}function A(){}function H(){}function S(I,la,Va,Kb){this.alh=I;this.fileSize=la;this.Yij=Kb}function Q(I,la){this.$=I;this.lP=la}function L(I,la,Va,Kb){Va=dj.call(this,
576,0,Va,Kb)||this;Va.PEd=new fa("576",I,la);return Va}function aa(I,la,Va,Kb,nc,Mc,Yc,Ed){la=qh.call(this,10,0,la,Ed)||this;la.Sib=Va;la.gfb=Kb;la.q2=nc;la.mDa=Mc;la.request=Yc;la.PEd=new fa("10",I,Yc);return la}function fa(I,la,Va){this.parentName=I;this.$=la;this.request=Va}function W(I,la){this.source=I;this.eventId=la}function G(I,la,Va,Kb,nc,Mc){var Yc=I.Na(1);Yc.request=la;return Yi.i(I,"ExecuteRichApiRequest",Yc,Va,Kb,nc,Mc,0)}function N(I,la,Va){this.$=I;this.lP=la;this.Zy=Va}function Y(I){this.fa=
I}function V(I,la,Va,Kb){I=Rd.call(this,I,"Select Data")||this;I.Mlb=null;I.Nxe=la;I.a0c=Va;I.callback=Kb;return I}function da(I){this.ub=I}function U(I){I.add("InternalTest","PreviewExecutionMethod",Z)}function Z(I,la){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof I+", objectId="+I+", value="+la);return null}function ca(I,la){this.Xfg=I;this.tgg=la}function ra(I){var la=I.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}",
"{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Va=la.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Va.addParameter("shortcuts","String[]",1,null,0);la.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Va=la.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Va.addParameter("shortcuts","Object",1,null,0);la=I.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Va=la.addMethod("GetSharedFilePickerResponse",
1,"Object",1,1,"SharedFilePickerResponse",0);Va.addParameter("pickerCustomizationJsonString","String",1,null,0);la=I.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Va=la.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Va.addParameter("base64File","String",1,null,0);la=I.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);la.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);Va=la.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Va.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);la=I.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);la.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Va=la.addMethod("Register",1,"Void",0,0,"Register",0);Va.addParameter("metadata",
"String",1,null,0);Va.addParameter("javascript","String",1,null,0);la=I.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);la.addProperty("Enabled",1,"Boolean",1,!1,null,0);la.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);la.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);la=I.addEnumType("Microsoft.Authentication.IdentityType");la.addEnumField("OrganizationAccount",0);la.addEnumField("MicrosoftAccount",1);la=I.addEnumType("Microsoft.Authentication.AuthorityType");
la.addEnumField("External",0);la.addEnumField("Msa",1);la.addEnumField("Aad",2);la=I.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);la.addProperty("DisplayName",4,"String",1,!1,null,0);la.addProperty("Email",3,"String",1,!1,null,0);la.addProperty("FederationProvider",2,"String",1,!1,null,0);la.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);la=I.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);la.addProperty("AppId",4,"String",1,!1,null,0);la.addProperty("Authority",2,"String",1,!1,null,0);la.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);la.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);la.addProperty("TenantId",6,"String",1,!1,null,0);la.addProperty("Upn",1,"String",1,!1,null,0);la=I.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);la.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Va=la.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Va.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);la.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);la.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);la=I.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);la.addProperty("AuthChallenge",3,"String",1,!1,null,0);la.addProperty("CorrelationId",7,"String",1,!1,null,0);la.addProperty("Policy",4,"String",1,!1,null,0);la.addProperty("Resource",2,"String",1,!1,null,0);la.addProperty("Scope",5,"String",1,!1,null,0);la.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);la=I.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);la.addProperty("AccessToken",2,"String",1,!1,null,0);la.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);la=I.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);la.addProperty("Id",1,"String",1,!0,null,0);la.addProperty("Value",2,"Object",1,!1,null,0);la=I.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);Va=la.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Va.addParameter("id","String",1,null,0);Va=la.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Va.addParameter("id","String",1,null,0);la=I.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);la.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);Va=la.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Va.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);la=I.addEnumType("Microsoft.AppRuntime.AppRuntimeState");la.addEnumField("Inactive",0);la.addEnumField("Background",1);la.addEnumField("Visible",2);la=I.addEnumType("Microsoft.AppRuntime.Visibility");la.addEnumField("Hidden",1);la.addEnumField("Visible",2);la=I.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);la.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Va=la.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Va.addParameter("jsonCreate","String",1,null,0);Va=la.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Va.addParameter("jsonUpdate","String",1,null,0);Va=la.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Va.addParameter("id","String",
1,null,0);Va=la.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Va.addParameter("id","String",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la=I.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);la.addProperty("Id",2,"String",1,!0,null,0);Va=la.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Va.addParameter("visibility","Boolean",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la=I.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);la.addProperty("Enabled",3,"Boolean",1,!1,null,0);la.addProperty("Id",2,"String",1,!0,null,0);la.addProperty("Label",4,"String",1,!0,null,0);Va=la.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Va.addParameter("enabled","Boolean",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la=I.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);la.addMethod("GetCount",3,"Int32",1,1,"Count",
0);Va=la.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Va.addParameter("key","String",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);la=I.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");la.addEnumField("Unknown",0);la.addEnumField("Basic",1);la.addEnumField("Premium",2);la=I.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);Va=la.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Va.addParameter("feature","String",1,null,0);Va.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Va=la.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Va.addParameter("feature","String",1,null,0);Va=la.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Va.addParameter("feature","String",
1,null,0);Va.addParameter("fallbackValue","Boolean",1,null,0);la.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Va=la.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Va.addParameter("experienceId","String",1,null,0);Va=la.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Va.addParameter("feature","String",1,null,0);la=I.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);la.addProperty("Id",5,"String",1,!0,null,0);la.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);la.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);la=I.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);la.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);la=I.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);la.addMethod("Disable",3,"Void",0,1,"Disable",0);la.addMethod("Enable",2,"Void",0,1,"Enable",0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function La(I,la,Va,Kb){this.menuItemId=I;this.EH=la;this.wmj=Va;this.klh=Kb}function na(I){this.ofi=I}function ma(I){this.Ova=I;this.Mbg=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function xa(){}function Pa(){}
function ib(){}function pb(I,la){this.peb=la;this.oz=I}function xb(){this.lVd=null;this.f9d=this.HRb=this.tR="";this.o$d=!0;this.options=null}function Ya(I,la){this.kdb=I;this.Rfb=la}function ab(){}function ea(){this.EZd=this.ZYd=this.Fda=null;this.Rfb=0}function ta(I){var la=$k.call(this)||this;la.$=I;la.Yb();return la}function Ka(I,la,Va){this.H9f=null;this.J9f=0;this.vb=I;this.Ng=la;this.IWd=Va}function mb(){}function Ha(I,la,Va,Kb,nc){var Mc=Wk.call(this)||this;Mc.H$a={};Mc.z5b={};Mc.uua=null;
Mc.N7a=null;Mc.$=I;Mc.viewBlockContainerHelpers=Va;Mc.se=la;Mc.n5c=Kb;Mc.pi=nc;Mc.pi.Xb(tf.a.$Sf,Hj.a.frame,Object(qf.a)(Mc,Mc.lPh,"handleShowExtensionTaskPane"));Mc.pi.Xb(tf.a.CIf,Hj.a.frame,Object(qf.a)(Mc,Mc.WOh,"handleRestartExtensionTaskPane"));Mc.pi.Xb(tf.a.DIe,Hj.a.frame,Object(qf.a)(Mc,Mc.ANh,"handleExecuteAddinAction"));return Mc}function Ga(){var I=Ck.call(this)||this;I.CSa="calc(100% - 46px)";I.gNb="15px";I.DSa="0";I.ybg="WACDialogPanel";I.iBa=695;I.zbg=462;I.Neb="80%";I.p$f=350;I.EVd=
"100%";I.hc=5;I.Ie="AppsForOfficeInsertionDialog";I.eCc=!!$f.AFrameworkApplication.ha&&$f.AFrameworkApplication.ha.sa("OfficeAddinEnableInsertDialogAccessibilityFix");return I}function Fa(){var I=eb.call(this)||this;I.isTable=!1;I.isPivotTable=!1;I.hasTableHeaders=!1;I.tableName=null;I.userSelectedPivotTable=!1;return I}function eb(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=
null}function db(){this.INd=this.buc=null;this.Qq=0;this.JNd=null}function Na(){this.se=null}function kb(I,la){this.Rhb=la}function Tb(I){return kj.call(this,I)||this}function ha(I){var la=Wi.call(this)||this;la.$=I;la.isFirstLaunch=!1;return la}function lb(I){Je.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.fef=$f.AFrameworkApplication.ha.sa("IsTellMeUpSellEnterpriseEnabled");this.Oei=$f.AFrameworkApplication.ha.Ta("SmartLookupApprovedOriginPattern");this.s5a=$f.AFrameworkApplication.ha.Ta("SmartLookupShredderServiceEndpoint");
this.mfi=pi.a.IL($f.AFrameworkApplication.ha.Ta("AppCatalogUrl")||"");this.r5a=new Yb;this.r5a.EnableAllTabV2=!0;this.r5a.EnableIntentService=!0;this.r5a.EnableInDocumentSearch=$f.AFrameworkApplication.ha.sa("SmartLookupEnableInDocumentSearch");this.r5a.EnableLocalSearch=$f.AFrameworkApplication.ha.sa("SmartLookupEnableLocalSearch");this.r5a.IntentServiceEndpoint=Wa.OHh();this.hfi=new Ra(I,this.s5a)}function Wa(){}function Ra(I,la,Va){this.Qqj=9E5;this.Tqj=3E5;this.zod=null;this.Hdf="";this.vod=0;
this.Kxe=Date.now;this.Ova=I;this.s5a=la;(void 0===Va||Va)&&this.$7c()}function Yb(){}function oc(){}function zb(){}function uc(){}function P(){}function lc(I,la,Va,Kb,nc,Mc){this.$=I;this.agaveCommandManager=Mc}function Ec(I){var la=zh.call(this)||this;la.ddaFacade=null;la.IBf=null;la.$=I;I.ea.Ia(106,la);la.Yb();return la}function tc(){}function cc(){}function Zb(I){this.rDa=I}function Aa(I,la,Va){this.iframe=I;this.onSuccess=la;this.onError=Va;$addHandler(window,"message",Object(qf.a)(this,this.eYe,
"handleResponse"))}function Ia(I,la){return Jf.a.dnd(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},$f.AFrameworkApplication.ha.xd("MaxRetriesForLoadingScript",0),I,la)}function qb(I){var la=Si.call(this)||this;la.$=I;la.Yb();return la}function wb(I,la){this.DNa=this.ENa=null;this.ariaLiveNotifier=I;this.$=la;this.MRc=!1;this.$.ea.Ia(224,this)}function ic(I){var la=Oi.call(this)||this;la.$=I;la.Yb();return la}function Jb(I){I=sh.call(this,I)||this;I.handler=null;return I}
function Ua(I,la,Va,Kb){this.pJd=void 0===I?null:I;this.QNc=void 0===la?null:la;this.b0c=void 0===Va?null:Va;this.Q4b=void 0===Kb?0:Kb}function $a(I,la,Va,Kb,nc,Mc,Yc){Yc=void 0===Yc?null:Yc;this.disposed=!1;this.$=I;Je.ULS.shipAssertTag(537170659,0,!(void 0===la||null===la),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",ai.a.e2());this.se=la;this.Fte=Va;this.BVb=Kb;this.tfa=nc;this.Hkb=Mc;this.Kl=new mh.a;this.sfa=new xc;this.$4c=Yc;Zj.a.A$b=Zj.a.zIe;this.l0c=
new lh.a;this.wZa=new lh.a}function ua(I){this.RDa=this.SDa=this.Oi=this.Kq=null;this.bEf=0;this.$=I.$;this.addinUICommandHandler=I;this.Kl=new mh.a}function Ca(I,la){this.uCa=I;this.jda=new Lc;this.uda=new gc(la)}function Sa(I,la,Va,Kb,nc,Mc){I=Hb.call(this,I,la)||this;I.e7=null;I.yda=null;I.Bda=null;I.uda=Va;I.rdg=Kb;I.xMb=nc;I.qna=Mc;return I}function Qb(I){this.c9d=null;if(Ii.c(I))throw Je.ULS.sendTraceTag(9041813,220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");
this.Yig=I}function Hb(I,la){this.dae=new lh.a;this.cw=this.Uu=null;this.dhb=I;this.jda=la}function Db(I){this.d9d=this.t_d=this.$$d=null;this.isOfficeTab=!1;this.cXe=this.PKf=null;this._id=I;this.tQa[Ng.a.id]=this._id}function jc(I){this.uXd=this.s_d=this.Yib=null;if(Ii.c(I))throw Je.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),Error.create("GroupDefinition id should not be null or undefined");this._id=I;this.Qta[Ng.a.id]=this._id}function sb(I,la,Va,Kb,
nc,Mc){this.gMb=new lh.a;this.e7=this.cw=this.Uu=null;this.dhb=I;this.jda=la;this.uda=Va;this.xMb=Kb;this.qna=nc;this.sZd=Mc}function fb(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Qa(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function cb(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function Ab(){this.iconLocation=
this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function gc(I){this.UAa=I}function Lc(){}function Nc(I,la){this.Yib=new yd(I,la)}function yd(I,la){this.clg=I;this.Pag=la}function Od(I){this.uCa=I}function sa(I,la,Va){this.aI=this.LSa=null;this.dhb=I;this.uda=la;this.jda=Va;this.bgg=new lh.a}function vb(I){this.d7=null;if(Ii.c(I))throw Je.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");
this._id=I}function Lb(I){this.FHc=null;if(Ii.c(I))throw Je.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=I;this.fQ[Ng.a.id]=this._id}function rc(I,la){this.eea=this.tXd=null;if(Ii.c(I)||Ii.c(la))throw Je.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.vXd=la;this._id=I;this.Iz[Ng.a.id]=this._id}function Oc(I,la,Va,Kb,nc,Mc,Yc,Ed){Ed=void 0===Ed?null:Ed;this.Ya=new jb.a;this.eSa=I;this.sXd=la;this.fm=Va;this.oTb=Kb;this.yea=nc;this.j9f=Mc;this.qna=Yc;this.I5d=Ed}function Bb(I,la,Va,Kb,nc,Mc,Yc){this.Zya=new xk.a;this.xr=I;this.sh=la;this.Kl=Va;this.ribbonManager=Kb;this.contextMenuManager=nc;this.Ky=Mc;this.sfa=Yc;this.IH=$f.AFrameworkApplication.xa.MC}function hc(I,la,Va){this.JUd=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=
this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=I;this.eventBuilder=la;this.contextMenuBuilder=Va}function Pc(I){this.Rbg=I.entitlement}function rd(I,la,Va,Kb,nc){la=void 0===la?null:la;Va=void 0===Va?null:Va;Kb=void 0===Kb?null:Kb;nc=void 0===nc?0:nc;if(Ii.c(I)&&Ii.c(la))throw Je.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");
this.fX=I;this.Rgg=la;this.jkg=Va;this.rhb=Kb;this.Tcg=nc}function Id(I){this.D5d=null;if(Ii.c(I))throw Je.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.r9f=I}function Vd(){}function He(){}function Nd(I){this.C2d=null;this.E0d=I}function Vc(I,la,Va){this.Ya=I;this.v7=la;this.KUd=Va}function fe(I,la,Va,Kb,nc,Mc,Yc){this.xr=I;this.Oi=la;this.aya=Va;this.wMe=Kb;this.Lph=nc;this.displayName=Mc;this.z$e=
Yc}function Ee(){var I=cd.call(this)||this;I.Oi=null;I.Kq=null;return I}function lf(){new Dc.a(Cc.a.instance)}function Da(){}function fc(I){this.Ygg=I}function Ib(I,la,Va){this.Oa=new jb.a;this.context=new pc;this.oRa=this.N9a=this.jMb=null;this.contextActivationMgr=I;this.ivg=la;this.evg=Va;this.appName=$f.AFrameworkApplication.ha.Ta("WebAppShortName")}function Ta(I,la,Va,Kb){this.YEb=$f.AFrameworkApplication.ha.Ta("WebServiceBase");this.appName=I;this.Bfb=la;this.xfb=Va;this.Lhb=void 0===Kb?null:
Kb}function kd(I){var la=Jc.call(this)||this;la.properties=I;return la}function ce(I){var la=-1;switch(I.toLowerCase()){case "omex":la=0;break;case "spcatalog":la=1;break;case "spapp":la=2;break;case "filesystem":la=3;break;case "exchange":la=4;break;case "registry":la=6;break;case "inmemory":la=7;break;case "uploadfiledevcatalog":la=8;break;case "hardcodedpreinstall":la=9;break;case "excatalog":la=10;break;case "wopicatalog":la=16}return la}function dc(I){var la=null;switch(I){case 0:la="omex";break;
case 1:la="spcatalog";break;case 2:la="spapp";break;case 3:la="filesystem";break;case 4:la="exchange";break;case 6:la="registry";break;case 7:la="inmemory";break;case 8:la="uploadfiledevcatalog";break;case 9:la="hardcodedpreinstall";break;case 10:la="excatalog";break;case 16:la="wopicatalog"}return la}function ub(I){var la={};$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(la.solutionId=I.solutionId,la.version=I.version,la.storeType=
I.storeType,la.storeId=I.storeId,la.assetId=I.assetId,la.assetStoreId=I.storeType,la.targetType=I.targetType,la.requireConsent=I.requireConsent||!1,la.isAddinCommands=!0,la.id=I.solutionId,la.appVersion=I.version,la.currentStoreType=I.storeType):(la.id=I.assetId,la.assetId=I.assetId,la.appVersion=I.appVersion,la.currentStoreType=I.storeType,la.storeId=I.storeId,la.assetStoreId=I.storeType,la.targetType=I.targetType,la.requireConsent=I.requireConsent||!1,la.isAddinCommands=!0);return la}function pc(){this.xr=
this.p5=0;this.fQc=null;this.slc=this.ROd=0;this.Xpa=null}function xc(){this.dWa=null}function hd(I,la){var Va=gk.call(this)||this;Va.statusBarManager=null;Va.agaveCommandManager=null;Va.Ky=la;Va.$=I;Va.Slj=I.Jb+"OfficeAddinLabel-Medium14";Va.$.ea.$a(29,function(Kb){Va.statusBarManager=Kb;Kb.sI(Va)});Va.$.fa.Yj(Object(qf.a)(Va,Va.Vc,"onSessionIdChanged"));Va.Ky.frg(Object(qf.a)(Va,Va.fXe,"handleAddinCommandsLoadingMessageChanged"));Va.$.ea.$a(206,function(Kb){Va.agaveCommandManager=Kb;Kb.Isg(Object(qf.a)(Va,
Va.Gqe,"clearLoadingAddinMessage"))});return Va}function Rc(){}function ld(){this.Qi=null;this.visible=!1}function Wd(I,la){this.Sa=I;this.VPg=la}function ee(){this.pVd=this.zyc=null}function ne(I){this.u8d=new Ad(I)}function Ad(I){this.U7=I;this.RRb=this.U7.ribbonBuilder}function se(){var I=Ak.call(this)||this;I.xfd=null;I.ffd=null;I.ribbon=null;return I}function Ve(){this.K$f=new lh.a}function Zf(I){return zk.call(this,I)||this}function Pf(I){var la=this;this.Iob=null;this.M_c=!1;this.XS=this.Zd=
null;this.$=I;wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.Va(this.$.ea,328,327,1,"Microsoft.Office.Excel.WebUI.Client.AugmentationLoop.IAugmentationLoopManager"),function(Va){(Va=Va.result)?(Je.ULS.sendTraceTag(537163346,0,50,"DataFromPicturePaneCommandManager::Initialize - AugmentationLoopManager instantiated."),la.Iob=new Fe(I,Va),la.M_c&&(la.Iob.JJf(la.Zd,la.XS),la.M_c=!1)):Je.ULS.sendTraceTag(537163347,0,10,"DataFromPicturePaneCommandManager::Initialize - Failed to instantiate AugmentationLoopManager.")},
this.$.la,3)}function Fe(I,la){var Va=qk.call(this)||this;Va.A0e=me.getTypeName();Va.lub=null;Va.imageWidth=0;Va.imageHeight=0;Va.tableData=null;Va.errorMessage=null;Va.oub=null;Va.JNc=!1;Va.$=I;Va.augmentationLoopManager=la;Va.initialize();return Va}function me(){var I=Ik.call(this)||this;I.errorCode=null;I.errorDescription=null;I.html=null;I.H_=Object.assign(new Sj.a,{T_:me.getTypeName(),B_:me.ke()});return I}function ng(I){var la=pk.call(this)||this;la.$=I;la.Yb();return la}function Oe(I,la){var Va=
we.call(this)||this;Va.$=I;Va.Wra=new DOMParser;Va.cache=new tj.a;Va.indexedDB=la;la.Yf()&&Va.indexedDB.initialize("Scripts","OfficeScriptingCache");Va.v3=!1;Va.vm=new We([],function(Kb){we.RUf(Kb)});Va.hg=new We([],function(Kb){we.Ssc(Kb)});Va.Ds=new We([],function(Kb){we.Ssc(Kb)});Va.Bk=new We([],function(){});return Va}function bd(I,la,Va){this.e4a=!1;this.$=I;this.tqa=la;this.gv=Va;this.nbj()}function ac(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.Cuc=this.w$=this.Nj=null}function Fc(I,
la,Va,Kb,nc,Mc,Yc,Ed,re,pf){var Ze=this;this.xz=null;this.cache=new tj.a;this.Pua=!1;this.pA=null;this.F_d=this.M7d=this.O7d=this.L7d=this.N7d=this.K7d=!1;this.V8d=this.T5d=this.u7d=null;this.WDa={};this.$=I;this.iKc=Va;this.indexedDB=Kb;this.Yke=nc;this.gv=Mc;this.tqa=Yc;this.Ne=Ed;this.uX=td.a.xp?re:new za(I,this);this.AAg=new Ke(this,I);this.beg=Gh.a.Qa.Gb;this.iWf="";this.businessBarManager=pf;this.v3=!1;this.Taj(new We([],function(cg){we.RUf(cg)}));this.Saj(new We([],function(cg){we.Ssc(cg)}));
this.Waj(new We([],function(cg){we.Ssc(cg)}));this.Uaj(new We([],function(){}));Kb.Yf()&&(this.Pua=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));I=!0;if(Li.a.lme){this.cache.Yf()&&(la=this.l8c(td.a.N6b(this.$)),la.isSuccess&&(I=Ph.getElapsedSeconds(la.timeStamp,Gh.a.Qa.Gb),this.gv.cx=new Ub(!0,!0),this.xz=new Ub(la.value,!0),I=this.xz.value?604800<I:86400<I,this.Btb=this.tHb(!0)));this.H7h=ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery");
this.zth();if("undefined"!==typeof makerstorage&&this.w9e)if(this.iWf=id(this.$),mc(this.$))Tc(this.$,"localstorageToken"),this.gv.cx=new Ub(!0,!0),this.xz=new Ub(!0,!0),this.Btb=this.tHb(!0);else if((la=td.a.VRe())&&makerstorage.setStorageEnvironmentOverride(la),I)try{this.Btb=this.gv.Wpe().then(function(){return Ze.tqa.Z7b()}).then(function(cg){return Ze.NPh(cg)}).then(function(){return Ze.tHb(!1)}).catch(function(){return Ze.tHb(!1)})}catch(cg){Je.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",
cg.message),this.Btb=Promise.resolve(!1)}ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.Btb?this.Btb.then(function(cg){return Ze.fDd(cg)}):this.fDd(!1)}else Je.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.fDd(!1)}function Zc(I,la,Va,Kb,nc){this.actionName=I;this.shapeId=la;this.y2i=Va;this.Wqe=Kb;this.eaa=nc}function pd(I,la,Va,Kb){this.Rdd=I;this.Gjh=
la;this.Wwa=Va;this.jFa=Kb}function bf(I){return new Promise(function(la){return window.setTimeout(la,I)})}function Bd(I){return Vi.a.Jd(I)?gf.a.DFe:gf.a.CFe}function Qe(I){return Vi.a.Jd(I)?I.isChromeRtl?gf.a.qdh:gf.a.pdh:gf.a.$Ga}function Ob(I){I=I.ra.ua.Na(1);I.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return I}function yc(I,
la,Va,Kb,nc){function Mc(){function cg(Ug,rh,Lh){return Yi.i(Ed.ua,"ExecuteRichApiRequest",Kb,di.b(Ug,la),di.a(rh,Va),Lh,null,0)}if(Yc.qFa()||0<Ed.ua.T2||0<Ed.xk.T2)return!1;re&&Yc.zC(re);pf&&Ed.yt(pf);Ze&&Ed.BC(Ze);ag.EwaSettings.pc()?Yc.ft(new Kj.a(507,0,cg,80)):Yc.ft(new Pj.a(507,0,cg,16));return!0}var Yc=I.userOperationManager,Ed=I.ra,re=null,pf=null,Ze=null;Mc()||(re=function(){Mc()},pf=function(){Mc()},Ze=function(){Mc()},Yc.jB(re),Ed.Yr(pf),Ed.lB(Ze));return nc.task}function id(I){if(mc(I))return ag.EwaSettings.getBooleanFeatureGate(td.a.vyb,
!1)?"makerservicelocal":"localstorage";I=td.a.VRe();return td.a.JIh(I)}function Tc(I,la){mc(I)&&(ag.EwaSettings.getBooleanFeatureGate(td.a.vyb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(I.ya.UserSessionId);makerstorage.setUserAccessInfo(new Le(la,null));ag.EwaSettings.getBooleanFeatureGate(td.a.b4f,!1)&&makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function od(I,la){la.OfficeScriptsRunFromButton=ag.EwaSettings.getBooleanFeatureGate(td.a.pwa,
!1);la.OfficeScriptsRunFromButtonPreAuth=ag.EwaSettings.getBooleanFeatureGate(td.a.vni,!1);la.WacTaskPaneInfra=Vi.a.Jd(I);la.PipeEnableExtractPermission=ag.EwaSettings.getBooleanFeatureGate(td.a.GFi,!1);la.UseV1ServiceURLs=ag.EwaSettings.getBooleanFeatureGate(td.a.b4f,!1);la.TaskpanelessRFB=ag.EwaSettings.getBooleanFeatureGate(td.a.aYf,!1)}function mc(I){return"TestHost"===I.ya.DocumentHostInfo.HostTier}function Le(I,la){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=
I;this.currentUserMlapiToken=la}function we(){this.Bk=null;this.v3=this.wba=this.As=this.z5=this.Cxa=this.u8a=this.Lzd=this.vba=this.XIa=!1;this.Ds=this.hg=this.vm=null}function za(I,la){this.pA=null;this.$=I;this.automateCommandManager=la;return this}function Nb(){}function bb(){this.cx=null;return this}function Ub(I,la,Va,Kb,nc){this.value=I;this.isSuccess=la;this.timeStamp=void 0===Va?null:Va;this.errorCode=void 0===Kb?"":Kb;this.errorMessage=void 0===nc?"":nc}function kc(){this.cx=null}function ad(I,
la){this.pA=null;this.$=I;this.Ne=la;return this}function Qd(I){this.l9=xh.b(I)||{};this.ME=this.ME||null}function We(I,la){this.scripts=I;this.QUf=la}function Ke(I,la){this.automateCommandManager=I;this.$=la}function nf(){this.pA=null}function Pe(I,la,Va){this.$=I;this.oAuthManager=la;this.gv=Va;this.Blb=new hf;this.Nke=this.oAuthManager&&null==this.oAuthManager.NJa()?!1:this.oAuthManager.NJa()}function hf(){this.token=null;this.timeStamp=0}function Vf(I){return sd.call(this,I)||this}function Sg(I,
la){this.automateCommandManager=I;this.$=la}function wg(I){var la=Yj.call(this)||this;la.$=I;la.Yb();return la}function Ef(I){this.Cb=null;this.$=I}function Fg(){return ud.call(this)||this}function xf(){return ud.call(this)||this}function Uf(){return ud.call(this)||this}function Gg(){return ud.call(this)||this}function Eg(){return ud.call(this)||this}function ig(){return ud.call(this)||this}function sg(){return ud.call(this)||this}function yg(){return ud.call(this)||this}function Yd(){return ud.call(this)||
this}function Sc(){return ud.call(this)||this}function Ag(){return ud.call(this)||this}function Jg(){return ud.call(this)||this}function je(){return ud.call(this)||this}function dg(){return ud.call(this)||this}function ke(){return ud.call(this)||this}function Qf(){return ud.call(this)||this}function og(){return ud.call(this)||this}function Cf(){return ud.call(this)||this}function Ea(){return ud.call(this)||this}function ob(){return ud.call(this)||this}function wc(){return ud.call(this)||this}function zc(){return ud.call(this)||
this}function Hd(){return ud.call(this)||this}function Kd(){return ud.call(this)||this}function he(){return ud.call(this)||this}function Se(){return ud.call(this)||this}function Ue(){return ud.call(this)||this}function mf(){return ud.call(this)||this}function Vg(){return ud.call(this)||this}function Hf(){return ud.call(this)||this}function Rg(){return ud.call(this)||this}function zf(){return ud.call(this)||this}function gg(){return ud.call(this)||this}function Xe(){return ud.call(this)||this}function If(){return ud.call(this)||
this}function yf(){return ud.call(this)||this}function Bf(){return ud.call(this)||this}function Vb(){return ud.call(this)||this}function Qc(){return ud.call(this)||this}function md(){return ud.call(this)||this}function Ce(){return ud.call(this)||this}function le(){return ud.call(this)||this}function Zd(){return ud.call(this)||this}function fg(){return ud.call(this)||this}function Kg(){return ud.call(this)||this}function $g(){return ud.call(this)||this}function pa(){return ud.call(this)||this}function tb(){return ud.call(this)||
this}function qc(){return ud.call(this)||this}function jd(){return ud.call(this)||this}function Sd(){return ud.call(this)||this}function ye(){return ud.call(this)||this}function Ye(){return ud.call(this)||this}function wf(){return ud.call(this)||this}function Ma(){return ud.call(this)||this}function gb(){return ue.call(this,195,16)||this}function Wb(){return ue.call(this,194,8)||this}function Kc(){return ud.call(this)||this}function Bc(){return ue.call(this,198,2)||this}function Fb(){return ue.call(this,
197,1)||this}function bc(){return ue.call(this,196,32)||this}function ge(){return ud.call(this)||this}function Jd(){return ue.call(this,193,4)||this}function ue(I,la){var Va=ud.call(this)||this;Va.Mda=I;Va.URd=la;return Va}function qd(){return ud.call(this)||this}function Ud(){return ud.call(this)||this}function ed(){return ud.call(this)||this}function xd(){return ud.call(this)||this}function Lg(){return ud.call(this)||this}function hg(){return ud.call(this)||this}function Dg(){return oa.call(this,
11,16)||this}function cf(){return oa.call(this,10,128)||this}function Hg(){return ud.call(this)||this}function uh(){return ud.call(this)||this}function te(){return ud.call(this)||this}function Wg(){return ud.call(this)||this}function Kf(){return ud.call(this)||this}function nd(){return ud.call(this)||this}function qe(){return ud.call(this)||this}function Qg(){return ud.call(this)||this}function ae(){return ud.call(this)||this}function Nh(){return oa.call(this,9,2)||this}function wd(){return oa.call(this,
8,1)||this}function ze(){return oa.call(this,7,8)||this}function Ah(){return oa.call(this,6,32)||this}function Xh(){return ud.call(this)||this}function pg(){return ud.call(this)||this}function vg(){return ud.call(this)||this}function Ih(){return ud.call(this)||this}function Eh(){return ud.call(this)||this}function Zh(){return ud.call(this)||this}function ih(){return ud.call(this)||this}function eg(){return ud.call(this)||this}function oh(){return ud.call(this)||this}function Hh(){return ud.call(this)||
this}function X(){return ud.call(this)||this}function Xa(){return ud.call(this)||this}function Pb(){return ud.call(this)||this}function Gc(){return ud.call(this)||this}function Hc(){return oa.call(this,4,64)||this}function Ld(){return ud.call(this)||this}function Ie(){return ud.call(this)||this}function Td(){return ud.call(this)||this}function Re(){return ud.call(this)||this}function ff(){return ud.call(this)||this}function Of(){return ud.call(this)||this}function kg(){return ud.call(this)||this}
function Rf(){}function Ig(){return ud.call(this)||this}function ya(){return oa.call(this,3,4)||this}function oa(I,la){var Va=ud.call(this)||this;Va.Mda=I;Va.URd=la;return Va}function yb(){return ud.call(this)||this}function Dd(){return ud.call(this)||this}function ie(){return ud.call(this)||this}function xe(){return ud.call(this)||this}function Lf(){return uf.call(this,185,18)||this}function ph(){return ud.call(this)||this}function Sf(){return uf.call(this,181,14)||this}function Zg(){return uf.call(this,
169,2)||this}function Bh(){return uf.call(this,168,1)||this}function ti(){return ud.call(this)||this}function ci(){return uf.call(this,182,15)||this}function fi(){return ud.call(this)||this}function $h(){return ud.call(this)||this}function Th(){return uf.call(this,180,13)||this}function mg(){return uf.call(this,186,19)||this}function rg(){return uf.call(this,175,8)||this}function af(){return uf.call(this,176,9)||this}function de(){return uf.call(this,187,20)||this}function Fi(){return uf.call(this,
174,7)||this}function f(){return uf.call(this,179,12)||this}function hb(){return uf.call(this,178,11)||this}function ec(){return uf.call(this,177,10)||this}function $c(){return ud.call(this)||this}function be(){return uf.call(this,170,3)||this}function ve(){return uf.call(this,172,5)||this}function De(){return uf.call(this,173,6)||this}function Me(){return uf.call(this,183,16)||this}function sf(){return uf.call(this,184,17)||this}function tg(){return uf.call(this,171,4)||this}function uf(I,la){var Va=
ud.call(this)||this;Va.Mda=I;Va.opType=la;return Va}function Og(){return ud.call(this)||this}function Tf(){return ud.call(this)||this}function Xf(){return ud.call(this)||this}function ia(){return ud.call(this)||this}function u(){return ud.call(this)||this}function m(){return ud.call(this)||this}function K(){return ud.call(this)||this}function ka(){return ud.call(this)||this}function ja(){return ud.call(this)||this}function Gb(){return ud.call(this)||this}function $b(){return ud.call(this)||this}function Ac(){return ud.call(this)||
this}function fd(){return ud.call(this)||this}function Pd(){return ud.call(this)||this}function Xd(){return ud.call(this)||this}function Te(){return ud.call(this)||this}function rf(){return ud.call(this)||this}function Ne(){return ud.call(this)||this}function Yf(){return ud.call(this)||this}function Af(){return ud.call(this)||this}function ch(){return ud.call(this)||this}function lg(){return $d.call(this)||this}function jh(){return ud.call(this)||this}function vh(){return ud.call(this)||this}function dh(){return ud.call(this)||
this}function xg(){return ud.call(this)||this}function Ff(){return ud.call(this)||this}function Ai(){return ud.call(this)||this}function Oh(){return ud.call(this)||this}function zg(){return ud.call(this)||this}function Bi(){return ud.call(this)||this}function mj(){return vf.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function T(){return vf.call(this,79,[0,1,2,-102])||
this}function Oa(){return vf.call(this,75,[-101])||this}function Eb(){return vf.call(this,81,[100,101,102,103,104,105,106])||this}function vc(){return ud.call(this)||this}function gd(){return vf.call(this,85,[328,329,330,331,332,333,334,335])||this}function Cd(){return $d.call(this)||this}function Fd(I,la,Va){this.response=this.request=this.eventId=this.source=null;I&&(this.source=I.source,this.eventId=I.eventId,this.request=la,this.response=Va)}function $d(){return ud.call(this)||this}function Ae(){return vf.call(this,
83,[500,501,502])||this}function $e(){return vf.call(this,76,[-100])||this}function qg(){return vf.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Tg(){return vf.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function jg(){return vf.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function vf(I,la){var Va=ud.call(this)||this;Va.Mda=I;Va.LAj=la;return Va}function Xg(){return ud.call(this)||this}function bh(){return ud.call(this)||
this}function Fh(){return ud.call(this)||this}function gh(){return ud.call(this)||this}function ud(){this.xCc=this.yCc=this.CIc=this.fNc=null}function Jh(I,la,Va){this.s5b=null;this.Eef=la;this.Def=Va;this.$=I;this.$.Z$&&this.$.ytg(Object(qf.a)(this,this.sfi,"macroRecorderEwaEventHandler"));I.ea.Ia(297,this)}function bg(){}function xj(){}function xi(){this.Cdb=null}function O(){this.Za=null}function qa(I){this._initialized=!1;this.i7a={};this.ptc={};this.IH=$f.AFrameworkApplication.xa.MC;this.Qdd=
I}function rb(I,la,Va){this.expiration=this.authority=this.accessToken=null;this.accessToken=I;this.authority=la;this.expiration=Va}function Sb(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function Uc(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}
function vd(){}function oe(I,la){this.requestCallback=this.requestParameters=null;this.requestParameters=I;this.requestCallback=la}function ef(){}b.r(F);var Nf=b(509),kh=b(1078),Md=b(0),Je=b(15),qf=b(37),ej;(function(I){I[I.generalException=0]="generalException";I[I.invalidArgument=1]="invalidArgument";I[I.notAllowed=2]="notAllowed";I[I.apiNotAvailable=3]="apiNotAvailable";I[I.unresolvedPendingRequest=4]="unresolvedPendingRequest";I[I.timeout=5]="timeout";I[I.adalTimeout=6]="adalTimeout";I[I.userNotSignedIn=
7]="userNotSignedIn";I[I.userAborted=8]="userAborted";I[I.silentSignInFailed=9]="silentSignInFailed";I[I.invalidResourceUrl=10]="invalidResourceUrl";I[I.invalidGrant=11]="invalidGrant";I[I.connectionLost=12]="connectionLost";I[I.clientError=13]="clientError";I[I.serverError=14]="serverError"})(ej||(ej={}));Object(Md.b)("ErrorCodes",ej);ef.nuf="OneDriveWOPI";Object(Md.a)(ef,"HostApplicationType",null,[]);Object(Md.a)(oe,"OutstandingRequest",null,[]);vd.gli="AADSTS50058";vd.invalidResourceUrl="AADSTS50001";
vd.ali="AADSTS65001";vd.rli="AADSTS70011";vd.userAborted="13002";vd.bHi="Popup Window is null";vd.aHi="Popup Window closed";vd.adalTimeout="Token renewal operation failed due to timeout";vd.Uqj="tokenRevoked";Object(Md.a)(vd,"WopiHostErrorType",null,[]);var $f=b(5),mi=b(839),qj=b(586),yh=b(41);Uc.muh=function(I){switch(I){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(Md.a)(Uc,"WopiAuthContext",null,[801]);Object(Md.a)(Sb,"WopiIdentityInfo",null,[800]);
Object(Md.a)(rb,"WopiIdentityToken",null,[182]);var Li=b(23),aj=b(144),gi=b(519),ii=b(178),of=b(75),Ui=b(337);qa.prototype.XZa=function(I){this._initialized||(I.En(ii.a.dxf),I.xm(ii.a.dxf,Object(qf.a)(this,this.Qxi,"onReceivedAccessToken")),this._initialized=!0)};qa.prototype.getAccessToken=function(I,la,Va){var Kb=this;Va=void 0===Va?null:Va;this.ALa(I,la);return new Promise(function(nc,Mc){if(Kb.egd(la))if(la in Kb.i7a)Mc("unresolvedPendingRequest");else{var Yc=window.setTimeout(function(){var re=
{};Je.ULS.sendTraceTag(37856032,344,10,yh.c((re.error="Request timeout.",re.callerId=la,re)));Mc("timeout")},12E4);Kb.N7c(I,la,Va,function(re,pf){window.clearTimeout(Yc);re?nc(re):(re={},Je.ULS.sendTraceTag(37856033,369,15,yh.c((re.error=ej[pf],re))),Mc(pf))})}else{var Ed={};Je.ULS.sendTraceTag(37856034,344,10,yh.c((Ed.error="Caller is not allowed.",Ed)));Mc("notAllowed")}})};qa.prototype.getPrimaryIdentityInfo=function(I){var la=this;return new Promise(function(Va,Kb){if(la.egd(I))la.yFh(function(Mc,
Yc){Mc?Va(Mc):(Mc={},Je.ULS.sendTraceTag(37856064,369,10,yh.c((Mc.error=Yc.toString(),Mc))),Kb(Yc))});else{var nc={};Je.ULS.sendTraceTag(37856065,344,10,yh.c((nc.error="Caller is not allowed.",nc)));Kb("notAllowed")}})};qa.prototype.getAuthContext=function(I){var la=this;return new Promise(function(Va,Kb){var nc=la.getAuthContextSync(I);nc?Va(nc):Kb("notAllowed")})};qa.prototype.getAuthContextSync=function(I){if(this.egd(I)){var la=new Uc;la.upn=$f.AFrameworkApplication.ha.Ta("UserPrincipalName");
la.userId=$f.AFrameworkApplication.ha.Ta("LoggableUserId");la.authority=$f.AFrameworkApplication.ha.Ta("HostAuthAuthority");la.tenantId=$f.AFrameworkApplication.ha.Ta("TenantId");la.isAnonymous=$f.AFrameworkApplication.ha.sa("IsAnonymousUser");la.supportsAuthToken=this.nSh(I);I=$f.AFrameworkApplication.ha.Ta("HostAuthType");la.authorityType="aad"===I.toLowerCase()?2:"msa"===I.toLowerCase()?1:0;return la}la={};Je.ULS.sendTraceTag(40751647,344,10,yh.c((la.error="Caller is not allowed.",la)));return null};
qa.prototype.nSh=function(I){var la=mi.a.aub;if(Li.a.nja){var Va=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HostSupportsTeamsElectronSSO",!1);return la&&Va&&mi.a.dYf?Array.contains(mi.a.dYf,I.toLowerCase()):!1}return la};qa.prototype.N7c=function(I,la,Va,Kb){var nc=this,Mc=[];Array.add(Mc,Object.assign(new of.a,{name:"CallerId",string:la}));Array.add(Mc,Object.assign(new of.a,{name:gi.a.WLd,string:I.correlationId}));aj.a.sendTelemetryEvent(Object.assign(new Ui.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Mc}));Mc=qj.a.create().toString();var Yc="getAccessToken_"+Mc,Ed=this.IH.Dc("ComponentAttach",Yc);this.ptc[Yc]=Ed;var re={};re[gi.a.XLd]=Mc;re[gi.a.Jkj]=I.resource;re[gi.a.Kkj]=I.scope;re[gi.a.hVf]=$f.AFrameworkApplication.ha.Ta("HostAuthType");re[gi.a.Nkj]=$f.AFrameworkApplication.ha.Ta("UserPrincipalName");re[gi.a.Lkj]=I.silentLogin;re[gi.a.Gkj]=I.options;re[gi.a.WLd]=I.correlationId;re[gi.a.Hkj]=la;Va&&(re[gi.a.addinName]=
Va.AddinName,re[gi.a.Fkj]=Va.AddinTrustId);this.Qdd.execute(function(pf){nc.XZa(pf);pf.Vj(ii.a.getAuthToken,re)});this.i7a[Mc]=new oe(I,Kb)};qa.prototype.yFh=function(I){var la=$f.AFrameworkApplication.ha.Ta("UserName"),Va=$f.AFrameworkApplication.ha.Ta("UserPrincipalName"),Kb=$f.AFrameworkApplication.ha.Ta("LoggableUserIdSpace"),nc=new Sb;nc.email=Va;nc.displayName=la;switch(Kb){case "OrgIdPuid":nc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":nc.authority="MicrosoftAccount";
break;default:nc.authority=Kb}I(nc,null)};qa.prototype.Qxi=function(I){var la=null;try{var Va=I.Values[gi.a.XLd],Kb=I.Values[gi.a.Ekj],nc=I.Values[gi.a.hVf],Mc=I.Values[gi.a.Mkj],Yc=null,Ed=null,re=this.i7a[Va];if("undefined"!==typeof re&&re){var pf=[];Array.add(pf,Object.assign(new of.a,{name:gi.a.WLd,string:re.requestParameters.correlationId}));aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:pf}));la=re.requestCallback;
delete this.i7a[Va];"undefined"!==typeof Kb&&Kb&&Kb.length?Ed=new rb(Kb,nc,Mc):Yc=ej[this.ggi(I)];Va="getAccessToken_"+Va;Va in this.ptc&&(this.ptc[Va].stop(),delete this.ptc[Va]);la(Ed,Yc)}else Yc={},Je.ULS.sendTraceTag(37856066,344,10,yh.c((Yc.error="No matching outstanding request for request ID.",Yc.requestId=Va,Yc)))}catch(Ze){I=I.Values[gi.a.XLd],I in this.i7a&&delete this.i7a[I],this.Yec(),I={},Je.ULS.sendTraceTag(37856067,344,10,yh.c((I.error=Ze.message,I.stack=Ze.stack,I))),la&&la(null,"generalException")}};
qa.prototype.egd=function(I){var la=$f.AFrameworkApplication.RLh();I=I.toLowerCase();la=Ol(la);for(var Va=la.next();!Va.done;Va=la.next())if(I===Va.value.toLowerCase())return!0;la=mi.a.OQc;for(var Kb in la)if(I===la[Kb].toLowerCase())return!0;return!1};qa.prototype.ggi=function(I){I=I.Values[gi.a.Ikj];this.Yec();var la={};Je.ULS.sendTraceTag(39068821,344,15,yh.c((la.error=I,la)));return I?-1<I.indexOf(vd.gli)?9:-1<I.indexOf(vd.bHi)||-1<I.indexOf(vd.aHi)?12:-1<I.indexOf(vd.invalidResourceUrl)?10:-1<
I.indexOf(vd.userAborted)?8:-1<I.indexOf(vd.rli)||-1<I.indexOf(vd.ali)||I===vd.Uqj?11:-1<I.indexOf(vd.adalTimeout)?6:0:13};qa.prototype.ALa=function(I,la){I=this.mPi(I.resource);var Va={};Je.ULS.sendTraceTag(39921882,344,50,yh.c((Va.callerId=la,Va.resource=I,Va)))};qa.prototype.Yec=function(){var I={};Je.ULS.sendTraceTag(39068822,344,50,yh.c((I.userAgent=window.navigator.userAgent,I)))};qa.prototype.mPi=function(I){return(I?I:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/",
"\\")};Object(Md.a)(qa,"WopiIdentityManager",null,[51]);var fj=b(276);O.prototype.Qh=function(I){this.Za=I;I.register(qa,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").wc().Fc(function(){return new qa(I.oc("Postmessage.IHostPostmessenger"))})};O.prototype.init=function(){$f.AFrameworkApplication.ha&&$f.AFrameworkApplication.ha.Dv(Object(qf.a)(this,this.mA,"onFullAppSettingsReady"))};O.prototype.mA=function(){try{this.Za.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(I){Je.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+I)}};O.prototype.dispose=function(){};O.main=function(){fj.a.instance.ej(new O)};Ll.Object.defineProperties(O.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});Object(Md.a)(O,"WopiIdentityPackage",null,[8,9]);var Ch=b(12),Ji=b(212),lh=b(211),nj=b(599);xi.prototype.n_h=function(I){return this.aBg.contains(I.operation)};xi.prototype.kuj=function(I){for(var la=[],Va=Ol(I.payload.batchedOperations),
Kb=Va.next();!Kb.done;Kb=Va.next())la.push(new nj.a(I.operation,Kb.value));return la};Ll.Object.defineProperties(xi.prototype,{aBg:{configurable:!0,enumerable:!0,get:function(){this.Cdb||(this.Cdb=new lh.a,this.Cdb.add(12),this.Cdb.add(11));return this.Cdb}}});Object(Md.a)(xi,"MacroRecorderBatchedEventList",null,[]);var Gi=b(55),Oj=b(120),Wj=b(787);xj.prototype.equals=function(I,la){return I===la};xj.prototype.getHashCode=function(I){return I};xj.prototype.e3=function(I){return I};Object(Md.a)(xj,
"UserOperationNameComparer",null,[28,29]);bg.PLh=function(){bg.Lc||(bg.Lc=new Wj.a(new xj),bg.Lc.add(507),bg.Lc.add(10),bg.Lc.add(576),bg.Lc.add(563),bg.Lc.add(564),bg.Lc.add(565),bg.Lc.add(566),bg.Lc.add(567),bg.Lc.add(568),bg.Lc.add(569),bg.Lc.add(570),bg.Lc.add(571),bg.Lc.add(572),bg.Lc.add(573),bg.Lc.add(574),bg.Lc.add(575),bg.Lc.add(501),bg.Lc.add(520),bg.Lc.add(1),bg.Lc.add(1002),bg.Lc.add(129),bg.Lc.add(198),bg.Lc.add(500),bg.Lc.add(519),bg.Lc.add(538),bg.Lc.add(1E3),bg.Lc.add(1003),bg.Lc.add(144),
bg.Lc.add(502),bg.Lc.add(505),bg.Lc.add(179),bg.Lc.add(205),bg.Lc.add(134),bg.Lc.add(230),bg.Lc.add(103),bg.Lc.add(110),bg.Lc.add(112),bg.Lc.add(113),bg.Lc.add(124),bg.Lc.add(133),bg.Lc.add(154),bg.Lc.add(162),bg.Lc.add(168),bg.Lc.add(172),bg.Lc.add(201),bg.Lc.add(222),bg.Lc.add(227),bg.Lc.add(513),bg.Lc.add(534),bg.Lc.add(539),bg.Lc.add(545),bg.Lc.add(547),bg.Lc.add(555),bg.Lc.add(558),bg.Lc.add(562),bg.Lc.add(585),bg.Lc.add(1001),bg.Lc.add(1005),bg.Lc.add(1008),bg.Lc.add(1010),bg.Lc.add(1011),bg.Lc.add(1012),
bg.Lc.add(1018),bg.Lc.add(252),bg.Lc.add(253),bg.Lc.add(258),bg.Lc.add(101),bg.Lc.add(102),bg.Lc.add(108),bg.Lc.add(118),bg.Lc.add(257),bg.Lc.add(119),bg.Lc.add(120),bg.Lc.add(123),bg.Lc.add(126),bg.Lc.add(127),bg.Lc.add(130),bg.Lc.add(140),bg.Lc.add(159),bg.Lc.add(160),bg.Lc.add(165),bg.Lc.add(166),bg.Lc.add(167),bg.Lc.add(169),bg.Lc.add(189),bg.Lc.add(223),bg.Lc.add(214),bg.Lc.add(228),bg.Lc.add(233),bg.Lc.add(247),bg.Lc.add(504),bg.Lc.add(511),bg.Lc.add(512),bg.Lc.add(525),bg.Lc.add(533),bg.Lc.add(537),
bg.Lc.add(542),bg.Lc.add(544),bg.Lc.add(548),bg.Lc.add(550),bg.Lc.add(551),bg.Lc.add(552),bg.Lc.add(554),bg.Lc.add(577),bg.Lc.add(584),bg.Lc.add(586),bg.Lc.add(587),bg.Lc.add(588),bg.Lc.add(592),bg.Lc.add(1009),bg.Lc.add(1016),bg.Lc.add(1017));return bg.Lc};bg.Lc=null;Object(Md.a)(bg,"MacroRecorderUnrecognizedEventList",null,[]);Jh.prototype.init=function(I){this.$.Z$&&(I?this.s5b=I:Je.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};
Jh.prototype.$5c=function(I){if(this.RRf())try{if(this.Def.n_h(I))for(var la=this.Def.kuj(I),Va=Ol(la),Kb=Va.next();!Kb.done;Kb=Va.next())this.bLe(Kb.value);else this.bLe(I)}catch(nc){I=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",Oj.a(I.operation),nc.stack),Je.ULS.sendTraceTag(537155423,0,10,I)}};Jh.prototype.bLe=function(I){var la=this.Eef.TRe(I,!0);la?(this.s5b(la.eventId,Gi.a.Hc(I.payload)),I=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",
la.eventId),Je.ULS.sendTraceTag(537155422,0,50,I)):(la=this.Eef.TRe(I,!1))?(I=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",la.eventId),Je.ULS.sendTraceTag(537155421,0,50,I)):bg.PLh().contains(I.operation)||(this.s5b(0,Gi.a.Hc(I.operation)),I=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",Oj.a(I.operation)),Je.ULS.sendTraceTag(537155420,0,50,I))};Jh.prototype.sfi=function(I,la){this.RRf()&&this.$5c(la)};
Jh.prototype.RRf=function(){return this.$.fja&&this.s5b&&this.$.U$?!0:!1};Object(Md.a)(Jh,"MacroRecorderEventHandler",null,[438]);var ag=b(1);ud.prototype.ng=function(){};ud.prototype.hU=function(){};ud.prototype.od=function(I){this.Rwc.add(I)};ud.prototype.Rb=function(I){this.operations.contains(I)||this.operations.add(I)};ud.prototype.Zjb=function(){this.featureGates.add(717)};ud.prototype.FDa=function(I){this.BJe.add(I)};Ll.Object.defineProperties(ud.prototype,{operations:{configurable:!0,enumerable:!0,
get:function(){this.CIc||(this.CIc=new lh.a,this.fc());return this.CIc}},Rwc:{configurable:!0,enumerable:!0,get:function(){this.fNc||(this.fNc=new lh.a,this.ng());return this.fNc}},BJe:{configurable:!0,enumerable:!0,get:function(){this.xCc||(this.xCc=new lh.a);return this.xCc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.yCc||(this.yCc=new lh.a,this.hU());return this.yCc}}});Object(Md.a)(ud,"MacroRecorderEventBase",null,[]);Em(gh,ud);gh.prototype.fc=function(){this.Rb(100)};Ll.Object.defineProperties(gh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(Md.a)(gh,"AccessibilityCheckRunEvent",ud,[]);Em(Fh,ud);Fh.prototype.fc=function(){this.Rb(241)};Fh.prototype.ng=function(){this.od(function(I){return I.addToPrintArea})};Ll.Object.defineProperties(Fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(Md.a)(Fh,"AddedToPrintAreaEvent",ud,[]);Em(bh,ud);bh.prototype.fc=function(){this.Rb(516)};Ll.Object.defineProperties(bh.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 65}}});Object(Md.a)(bh,"AutoFilterToggledEvent",ud,[]);Em(Xg,ud);Xg.prototype.fc=function(){this.Rb(502)};Xg.prototype.ng=function(){this.od(function(I){return!(I.j1a().FirstColumn===I.j1a().LastColumn&&I.j1a().FirstRow===I.j1a().LastRow)})};Ll.Object.defineProperties(Xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(Md.a)(Xg,"AutoSumEvent",ud,[]);Em(vf,ud);vf.prototype.fc=function(){this.Rb(529);this.Rb(594)};vf.prototype.ng=
function(){var I=this;this.od(function(la){return Array.contains(I.LAj,la.H$c())})};Ll.Object.defineProperties(vf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Mda}}});Object(Md.a)(vf,"ChartPropertyAppliedEventBase",ud,[]);Em(jg,vf);Object(Md.a)(jg,"ChartAxisChangedEvent",vf,[]);Em(Tg,vf);Object(Md.a)(Tg,"ChartAxisTitleChangedEvent",vf,[]);Em(qg,vf);Object(Md.a)(qg,"ChartDataLabelsChangedEvent",vf,[]);Em($e,vf);Object(Md.a)($e,"ChartDataSelectedEvent",vf,[]);Em(Ae,vf);
Object(Md.a)(Ae,"ChartDataTableChangedEvent",vf,[]);var Lj=b(786),Kh=b(403),qi=b(83);Em($d,ud);Object(Md.a)($d,"RichApiRequestExecutedEventBase",ud,[]);Ll.Object.defineProperties(Fd.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(Md.a)(Fd,"MacroRecorderRichApiRequestExecutedPayload",null,[115]);Em(Cd,$d);Cd.prototype.dE=function(I){Cd.I5||(Cd.I5=new Wj.a(Lj.a.rl()),Cd.I5.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
Cd.I5.add("fa000000014"));return!!I&&Cd.I5.contains(I.toLowerCase())};Cd.prototype.fc=function(){this.Rb(507);this.Rb(10);this.Rb(576)};Cd.prototype.ng=function(){var I=this;this.od(function(la){return Object(Kh.a)(Fd,la)&&(la=Object(qi.a)(Fd,la),la.isValid&&I.dE(la.source))?(Je.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",la.eventId),!0):!1})};Ll.Object.defineProperties(Cd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 117}}});Cd.I5=null;Object(Md.a)(Cd,"ChartFormatRichApiRequestExecutedEvent",$d,[]);Em(gd,vf);Object(Md.a)(gd,"ChartGridlinesChangedEvent",vf,[]);Em(vc,ud);vc.prototype.fc=function(){this.Rb(528)};Ll.Object.defineProperties(vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(Md.a)(vc,"ChartInsertedEvent",ud,[]);Em(Eb,vf);Object(Md.a)(Eb,"ChartLegendChangedEvent",vf,[]);Em(Oa,vf);Object(Md.a)(Oa,"ChartRowColumnSwitchedEvent",vf,[]);Em(T,vf);
Object(Md.a)(T,"ChartTitleChangedEvent",vf,[]);Em(mj,vf);Object(Md.a)(mj,"ChartTypeChangedEvent",vf,[]);Em(Bi,ud);Bi.prototype.fc=function(){this.Rb(521)};Ll.Object.defineProperties(Bi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(Md.a)(Bi,"ConnectorFloatingObjectResizedEvent",ud,[]);Em(zg,ud);zg.prototype.fc=function(){this.Rb(109)};Ll.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(Md.a)(zg,
"EntitySelectedEvent",ud,[]);Em(Oh,ud);Oh.prototype.fc=function(){this.Rb(149);this.Rb(147)};Ll.Object.defineProperties(Oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(Md.a)(Oh,"FindCellEvent",ud,[]);Em(Ai,ud);Ai.prototype.fc=function(){this.Rb(122)};Ll.Object.defineProperties(Ai.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(Md.a)(Ai,"FloatingObjectAltTextAppliedEvent",ud,[]);Em(Ff,ud);Ff.prototype.fc=function(){this.Rb(522)};
Ll.Object.defineProperties(Ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(Md.a)(Ff,"FloatingObjectDeletedEvent",ud,[]);Em(xg,ud);xg.prototype.fc=function(){this.Rb(524)};Ll.Object.defineProperties(xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(Md.a)(xg,"FloatingObjectMovedAndResizedEvent",ud,[]);Em(dh,ud);dh.prototype.fc=function(){this.Rb(523)};Ll.Object.defineProperties(dh.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 95}}});Object(Md.a)(dh,"FloatingObjectRotatedEvent",ud,[]);Em(vh,ud);vh.prototype.fc=function(){this.Rb(543)};Ll.Object.defineProperties(vh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(Md.a)(vh,"GroupDetailsShownOrHiddenEvent",ud,[]);Em(jh,ud);jh.prototype.fc=function(){this.Rb(125)};Ll.Object.defineProperties(jh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(Md.a)(jh,"HyperlinksRemovedFromRangeEvent",
ud,[]);Em(lg,$d);lg.prototype.dE=function(I){lg.I5||(lg.I5=new Wj.a(Lj.a.rl()),lg.I5.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),lg.I5.add("fa000000005"));return!!I&&lg.I5.contains(I.toLowerCase())};lg.prototype.fc=function(){this.Rb(507);this.Rb(10);this.Rb(576)};lg.prototype.ng=function(){var I=this;this.od(function(la){return Object(Kh.a)(Fd,la)?(la=Object(qi.a)(Fd,la),la.isValid&&I.dE(la.source)):!1})};Ll.Object.defineProperties(lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});
lg.I5=null;Object(Md.a)(lg,"IdeasRichApiRequestExecutedEvent",$d,[]);Em(ch,ud);ch.prototype.fc=function(){this.Rb(115)};Ll.Object.defineProperties(ch.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(Md.a)(ch,"LinkedEntityConvertedEvent",ud,[]);Em(Af,ud);Af.prototype.fc=function(){this.Rb(114)};Ll.Object.defineProperties(Af.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(Md.a)(Af,"LinkedEntityDisambiguationPaneToggledEvent",
ud,[]);Em(Yf,ud);Yf.prototype.fc=function(){this.Rb(119)};Ll.Object.defineProperties(Yf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(Md.a)(Yf,"MovedToEdgeEvent",ud,[]);Em(Ne,ud);Ne.prototype.fc=function(){this.Rb(191)};Ne.prototype.hU=function(){this.Zjb()};Ll.Object.defineProperties(Ne.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(Md.a)(Ne,"NamedSheetViewCreatedEvent",ud,[]);Em(rf,ud);rf.prototype.fc=function(){this.Rb(200)};
rf.prototype.hU=function(){this.Zjb()};Ll.Object.defineProperties(rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(Md.a)(rf,"NamedSheetViewDeletedEvent",ud,[]);Em(Te,ud);Te.prototype.fc=function(){this.Rb(192)};Te.prototype.hU=function(){this.Zjb()};Ll.Object.defineProperties(Te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(Md.a)(Te,"NamedSheetViewExitedEvent",ud,[]);Em(Xd,ud);Xd.prototype.fc=function(){this.Rb(199)};
Xd.prototype.hU=function(){this.Zjb()};Ll.Object.defineProperties(Xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(Md.a)(Xd,"NamedSheetViewRenamedEvent",ud,[]);Em(Pd,ud);Pd.prototype.fc=function(){this.Rb(195)};Pd.prototype.hU=function(){this.Zjb()};Ll.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(Md.a)(Pd,"NamedSheetViewSwitchedEvent",ud,[]);Em(fd,ud);fd.prototype.fc=function(){this.Rb(174)};
Ll.Object.defineProperties(fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(Md.a)(fd,"OutlineLevelSetEvent",ud,[]);Em(Ac,ud);Ac.prototype.fc=function(){this.Rb(244)};Ll.Object.defineProperties(Ac.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(Md.a)(Ac,"PageBreakInsertedEvent",ud,[]);Em($b,ud);$b.prototype.fc=function(){this.Rb(245)};Ll.Object.defineProperties($b.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});
Object(Md.a)($b,"PageBreakRemovedEvent",ud,[]);Em(Gb,ud);Gb.prototype.fc=function(){this.Rb(246)};Ll.Object.defineProperties(Gb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(Md.a)(Gb,"PageBreaksAllResetEvent",ud,[]);var th=b(7);Em(ja,ud);ja.prototype.fc=function(){this.Rb(503)};ja.prototype.ng=function(){this.od(function(I){return!th.a.ma(I.pasteParameters.ClientEstimationFloatingObjectId)&&2===I.pasteParameters.CopyPasteTargetType&&!I.isFromCurrentSession})};
Ll.Object.defineProperties(ja.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(Md.a)(ja,"PasteArtOtherWorkbookEvent",ud,[]);Em(ka,ud);ka.prototype.fc=function(){this.Rb(503)};ka.prototype.ng=function(){this.od(function(I){return!th.a.ma(I.pasteParameters.ClientEstimationFloatingObjectId)&&2===I.pasteParameters.CopyPasteTargetType&&I.isFromCurrentSession})};Ll.Object.defineProperties(ka.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});
Object(Md.a)(ka,"PasteArtSameWorkbookEvent",ud,[]);Em(K,ud);K.prototype.fc=function(){this.Rb(204)};Ll.Object.defineProperties(K.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(Md.a)(K,"PasteHtmlEvent",ud,[]);Em(m,ud);m.prototype.fc=function(){this.Rb(506)};Ll.Object.defineProperties(m.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(Md.a)(m,"PasteRangeEvent",ud,[]);Em(u,ud);u.prototype.fc=function(){this.Rb(503)};u.prototype.ng=
function(){this.od(function(I){return 1===I.pasteParameters.CopyPasteTargetType})};Ll.Object.defineProperties(u.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(Md.a)(u,"PasteShadowWorkbookRangeEvent",ud,[]);Em(ia,ud);ia.prototype.fc=function(){this.Rb(180)};Ll.Object.defineProperties(ia.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(Md.a)(ia,"PasteStringEvent",ud,[]);Em(Xf,ud);Xf.prototype.fc=function(){this.Rb(220)};Ll.Object.defineProperties(Xf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 134}}});Object(Md.a)(Xf,"PendingMergeEvent",ud,[]);Em(Tf,ud);Tf.prototype.fc=function(){this.Rb(510)};Ll.Object.defineProperties(Tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(Md.a)(Tf,"PictureInsertedEvent",ud,[]);Em(Og,ud);Og.prototype.fc=function(){this.Rb(161)};Ll.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(Md.a)(Og,"PivotDrillToggledEvent",
ud,[]);Em(uf,ud);uf.prototype.fc=function(){this.Rb(225)};uf.prototype.ng=function(){var I=this;this.od(function(la){return la.opType===I.opType})};Ll.Object.defineProperties(uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Mda}}});Object(Md.a)(uf,"PivotTableSettingsChangedEventBase",ud,[]);Em(tg,uf);Object(Md.a)(tg,"PivotTableAllItemLabelsRepeatedEvent",uf,[]);Em(sf,uf);Object(Md.a)(sf,"PivotTableAltTextDescriptionChangedEvent",uf,[]);Em(Me,uf);Object(Md.a)(Me,"PivotTableAltTextTitleChangedEvent",
uf,[]);Em(De,uf);Object(Md.a)(De,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",uf,[]);Em(ve,uf);Object(Md.a)(ve,"PivotTableBlankLineAfterEachItemToggledEvent",uf,[]);Em(be,uf);Object(Md.a)(be,"PivotTableColumnGrandTotalShownEvent",uf,[]);Em($c,ud);$c.prototype.fc=function(){this.Rb(132)};Ll.Object.defineProperties($c.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(Md.a)($c,"PivotTableCreatedEvent",ud,[]);Em(ec,uf);Object(Md.a)(ec,"PivotTableDisplayErrorStringToggledEvent",
uf,[]);Em(hb,uf);Object(Md.a)(hb,"PivotTableDisplayNullStringToggledEvent",uf,[]);Em(f,uf);Object(Md.a)(f,"PivotTableErrorStringChangedEvent",uf,[]);Em(Fi,uf);Object(Md.a)(Fi,"PivotTableExpandCollapseButtonsShownEvent",uf,[]);Em(de,uf);Object(Md.a)(de,"PivotTableIndentChangedEvent",uf,[]);Em(af,uf);Object(Md.a)(af,"PivotTableItemsWithNoDataOnColumnsShownEvent",uf,[]);Em(rg,uf);Object(Md.a)(rg,"PivotTableItemsWithNoDataOnRowsShownEvent",uf,[]);Em(mg,uf);Object(Md.a)(mg,"PivotTableLayoutTypeSetEvent",
uf,[]);Em(Th,uf);Object(Md.a)(Th,"PivotTableNullStringChangedEvent",uf,[]);Em($h,ud);$h.prototype.fc=function(){this.Rb(219)};Ll.Object.defineProperties($h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(Md.a)($h,"PivotTablePivotLocationChangedEvent",ud,[]);Em(fi,ud);fi.prototype.fc=function(){this.Rb(145)};Ll.Object.defineProperties(fi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(Md.a)(fi,"PivotTablePivotedEvent",ud,
[]);Em(ci,uf);Object(Md.a)(ci,"PivotTableRefreshDataOnLoadToggledEvent",uf,[]);Em(ti,ud);ti.prototype.fc=function(){this.Rb(50)};ti.prototype.ng=function(){this.od(function(I){return!!I.pivotTableId&&!!I.pivotTableName})};Ll.Object.defineProperties(ti.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(Md.a)(ti,"PivotTableRefreshedEvent",ud,[]);Em(Bh,uf);Object(Md.a)(Bh,"PivotTableRenamedEvent",uf,[]);Em(Zg,uf);Object(Md.a)(Zg,"PivotTableRowGrandTotalShownEvent",
uf,[]);Em(Sf,uf);Object(Md.a)(Sf,"PivotTableSaveSourceDataWithFileToggledEvent",uf,[]);var Aj=b(642);Em(ph,ud);ph.prototype.fc=function(){this.Rb(131)};ph.prototype.ng=function(){this.od(function(I){I=Object(qi.a)(Aj.a,I);return!!I&&!th.a.ma(I.fIa())&&!th.a.ma(I.hierarchyName)})};Ll.Object.defineProperties(ph.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(Md.a)(ph,"PivotTableSortedEvent",ud,[]);Em(Lf,uf);Object(Md.a)(Lf,"PivotTableSubTotalsVisibilitySettingSetEvent",
uf,[]);Em(xe,ud);xe.prototype.fc=function(){this.Rb(560)};Ll.Object.defineProperties(xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(Md.a)(xe,"PivotValueFieldSettingAppliedEvent",ud,[]);Em(ie,ud);ie.prototype.fc=function(){this.Rb(243)};Ll.Object.defineProperties(ie.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(Md.a)(ie,"PrintAreaClearedEvent",ud,[]);Em(Dd,ud);Dd.prototype.fc=function(){this.Rb(241)};Dd.prototype.ng=
function(){this.od(function(I){return!I.addToPrintArea})};Ll.Object.defineProperties(Dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(Md.a)(Dd,"PrintAreaSetEvent",ud,[]);Em(yb,ud);yb.prototype.fc=function(){this.Rb(517)};Ll.Object.defineProperties(yb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(Md.a)(yb,"RangeAutoFilterClearedEvent",ud,[]);Em(oa,ud);oa.prototype.fc=function(){this.Rb(11)};oa.prototype.ng=function(){var I=
this;this.od(function(la){return 16===la.cellFormat.ValidMembers});this.od(function(la){return la.cellFormat.Font.ValidMembers===I.URd})};Ll.Object.defineProperties(oa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Mda}}});Object(Md.a)(oa,"RangeFontFormattedEventBase",ud,[]);Em(ya,oa);Object(Md.a)(ya,"RangeBoldedEvent",oa,[]);Em(Ig,ud);Ig.prototype.fc=function(){this.Rb(11)};Ig.prototype.ng=function(){this.od(function(I){return 128===I.cellFormat.ValidMembers})};Ll.Object.defineProperties(Ig.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});Object(Md.a)(Ig,"RangeBorderedEvent",ud,[]);Rf.e7a="Table";Rf.Ijc="Sheet";Object(Md.a)(Rf,"MacroRecorderEventConstants",null,[]);Em(kg,ud);kg.prototype.fc=function(){this.Rb(208)};kg.prototype.ng=function(){this.od(function(I){return I.getParameters().FilterType===Rf.Ijc})};Ll.Object.defineProperties(kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(Md.a)(kg,"RangeCheckedItemsFilteredEvent",
ud,[]);Em(Of,ud);Of.prototype.fc=function(){this.Rb(106);this.Rb(105)};Ll.Object.defineProperties(Of.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(Md.a)(Of,"RangeConditionalFormattingChangedEvent",ud,[]);Em(ff,ud);ff.prototype.fc=function(){this.Rb(221)};Ll.Object.defineProperties(ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(Md.a)(ff,"RangeConditionalFormattingRuleDeletedEvent",ud,[]);Em(Re,ud);Re.prototype.fc=function(){this.Rb(508)};
Re.prototype.ng=function(){this.od(function(I){return 3===I.jt()||1===I.jt()||4===I.jt()})};Ll.Object.defineProperties(Re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(Md.a)(Re,"RangeContentClearedEvent",ud,[]);Em(Td,ud);Td.prototype.fc=function(){this.Rb(104)};Ll.Object.defineProperties(Td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(Md.a)(Td,"RangeCopiedCutCellsInsertedEvent",ud,[]);Em(Ie,ud);Ie.prototype.fc=function(){this.Rb(209)};
Ie.prototype.ng=function(){this.od(function(I){return I.getParameters().FilterType===Rf.Ijc})};Ll.Object.defineProperties(Ie.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(Md.a)(Ie,"RangeCustomFilteredEvent",ud,[]);Em(Ld,ud);Ld.prototype.fc=function(){this.Rb(121)};Ll.Object.defineProperties(Ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(Md.a)(Ld,"RangeDataValidationChangedEvent",ud,[]);Em(Hc,oa);Object(Md.a)(Hc,"RangeDoubleUnderlinedEvent",
oa,[]);Em(Gc,ud);Gc.prototype.fc=function(){this.Rb(190)};Ll.Object.defineProperties(Gc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(Md.a)(Gc,"RangeDuplicatesRemovedEvent",ud,[]);Em(Pb,ud);Pb.prototype.fc=function(){this.Rb(527);this.Rb(12)};Ll.Object.defineProperties(Pb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(Md.a)(Pb,"RangeEditedEvent",ud,[]);Em(Xa,ud);Xa.prototype.fc=function(){ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Rb(255):this.Rb(232)};Xa.prototype.ng=function(){this.od(function(I){return 4===I.actionType})};Xa.prototype.hU=function(){this.FDa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Ll.Object.defineProperties(Xa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(Md.a)(Xa,"RangeExternalLinksBrokeAllLinksEvent",ud,[]);Em(X,ud);X.prototype.fc=function(){ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Rb(255):this.Rb(232)};X.prototype.ng=function(){this.od(function(I){return 3===I.actionType})};X.prototype.hU=function(){this.FDa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Ll.Object.defineProperties(X.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(Md.a)(X,"RangeExternalLinksBrokeLinkEvent",ud,[]);Em(Hh,ud);Hh.prototype.fc=function(){ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Rb(256):
this.Rb(249)};Hh.prototype.hU=function(){this.FDa("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};Ll.Object.defineProperties(Hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(Md.a)(Hh,"RangeExternalLinksChangeSourceEvent",ud,[]);Em(oh,ud);oh.prototype.fc=function(){this.Rb(553)};oh.prototype.ng=function(){this.od(function(I){return 1===I.actionType})};oh.prototype.hU=function(){this.FDa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};
Ll.Object.defineProperties(oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(Md.a)(oh,"RangeExternalLinksRefreshedAllEvent",ud,[]);Em(eg,ud);eg.prototype.fc=function(){this.Rb(553)};eg.prototype.ng=function(){this.od(function(I){return!I.actionType})};eg.prototype.hU=function(){this.FDa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Ll.Object.defineProperties(eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});
Object(Md.a)(eg,"RangeExternalLinksRefreshedEvent",ud,[]);Em(ih,ud);ih.prototype.fc=function(){this.Rb(224)};ih.prototype.hU=function(){this.FDa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Ll.Object.defineProperties(ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(Md.a)(ih,"RangeExternalLinksSetAutoRefreshEvent",ud,[]);Em(Zh,ud);Zh.prototype.fc=function(){this.Rb(11)};Zh.prototype.ng=function(){this.od(function(I){return 64===I.cellFormat.ValidMembers})};
Ll.Object.defineProperties(Zh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(Md.a)(Zh,"RangeFillColoredEvent",ud,[]);Em(Eh,ud);Eh.prototype.fc=function(){this.Rb(155)};Ll.Object.defineProperties(Eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(Md.a)(Eh,"RangeFilledEvent",ud,[]);Em(Ih,ud);Ih.prototype.fc=function(){this.Rb(176)};Ih.prototype.ng=function(){this.od(function(I){return I.autoFilterOptions.AutoFilterType===Rf.Ijc&&
!!I.autoFilterOptions.CriteriaType})};Ll.Object.defineProperties(Ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(Md.a)(Ih,"RangeFilterAppliedEvent",ud,[]);Em(vg,ud);vg.prototype.fc=function(){this.Rb(176)};vg.prototype.ng=function(){this.od(function(I){return I.autoFilterOptions.AutoFilterType===Rf.Ijc&&!I.autoFilterOptions.CriteriaType})};Ll.Object.defineProperties(vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(Md.a)(vg,
"RangeFilterClearedEvent",ud,[]);Em(pg,ud);pg.prototype.fc=function(){this.Rb(518)};Ll.Object.defineProperties(pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(Md.a)(pg,"RangeFilterReappliedEvent",ud,[]);Em(Xh,ud);Xh.prototype.fc=function(){this.Rb(150)};Ll.Object.defineProperties(Xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(Md.a)(Xh,"RangeFlashFilledEvent",ud,[]);Em(Ah,oa);Object(Md.a)(Ah,"RangeFontColoredEvent",
oa,[]);Em(ze,oa);Object(Md.a)(ze,"RangeFontItalicizedEvent",oa,[]);Em(wd,oa);Object(Md.a)(wd,"RangeFontNamedEvent",oa,[]);Em(Nh,oa);Object(Md.a)(Nh,"RangeFontSizedEvent",oa,[]);Em(ae,ud);ae.prototype.fc=function(){this.Rb(215)};Ll.Object.defineProperties(ae.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(Md.a)(ae,"RangeFormattedAsTableEvent",ud,[]);Em(Qg,ud);Qg.prototype.fc=function(){this.Rb(188)};Ll.Object.defineProperties(Qg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 97}}});Object(Md.a)(Qg,"RangeGroupedOrUngroupedEvent",ud,[]);Em(qe,ud);qe.prototype.fc=function(){this.Rb(11)};qe.prototype.ng=function(){this.od(function(I){return 2===I.cellFormat.ValidMembers})};Ll.Object.defineProperties(qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(Md.a)(qe,"RangeHorizontallyAlignedEvent",ud,[]);Em(nd,ud);nd.prototype.fc=function(){this.Rb(526)};Ll.Object.defineProperties(nd.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 43}}});Object(Md.a)(nd,"RangeHyperlinkAppliedEvent",ud,[]);Em(Kf,ud);Kf.prototype.fc=function(){this.Rb(11)};Kf.prototype.ng=function(){this.od(function(I){return 256===I.cellFormat.ValidMembers})};Ll.Object.defineProperties(Kf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(Md.a)(Kf,"RangeIndentChangedEvent",ud,[]);Em(Wg,ud);Wg.prototype.fc=function(){this.Rb(156)};Wg.prototype.ng=function(){this.od(function(I){return 2===
I.jt()||5===I.jt()||6===I.jt()||7===I.jt()})};Ll.Object.defineProperties(Wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(Md.a)(Wg,"RangeMergedEvent",ud,[]);Em(te,ud);te.prototype.fc=function(){this.Rb(216)};Ll.Object.defineProperties(te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(Md.a)(te,"RangeNamedCellStyleAppliedEvent",ud,[]);Em(uh,ud);uh.prototype.fc=function(){this.Rb(11)};uh.prototype.ng=function(){this.od(function(I){return 32===
I.cellFormat.ValidMembers})};Ll.Object.defineProperties(uh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(Md.a)(uh,"RangeNumberFormattedEvent",ud,[]);var ok=b(1079);Em(Hg,ud);Hg.prototype.fc=function(){this.Rb(141)};Hg.prototype.ng=function(){this.od(function(I){return Object(Kh.a)(ok.a,I)})};Ll.Object.defineProperties(Hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(Md.a)(Hg,"RangeSortedEvent",ud,[]);Em(cf,oa);Object(Md.a)(cf,
"RangeStrikedThroughEvent",oa,[]);Em(Dg,oa);Object(Md.a)(Dg,"RangeUnderlinedEvent",oa,[]);Em(hg,ud);hg.prototype.fc=function(){this.Rb(11)};hg.prototype.ng=function(){this.od(function(I){return 1===I.cellFormat.ValidMembers})};Ll.Object.defineProperties(hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(Md.a)(hg,"RangeVerticallyAlignedEvent",ud,[]);Em(Lg,ud);Lg.prototype.fc=function(){this.Rb(11)};Lg.prototype.ng=function(){this.od(function(I){return 8===I.cellFormat.ValidMembers})};
Ll.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(Md.a)(Lg,"RangeWrapTextToggledEvent",ud,[]);Em(xd,ud);xd.prototype.fc=function(){this.Rb(51)};Ll.Object.defineProperties(xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(Md.a)(xd,"RefreshedAllEvent",ud,[]);Em(ed,ud);ed.prototype.fc=function(){this.Rb(148)};Ll.Object.defineProperties(ed.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});
Object(Md.a)(ed,"ReplaceAllEvent",ud,[]);Em(Ud,ud);Ud.prototype.fc=function(){this.Rb(532)};Ud.prototype.ng=function(){this.od(function(I){return 95!==I.getShapeType()&&96!==I.getShapeType()&&97!==I.getShapeType()&&98!==I.getShapeType()&&100!==I.getShapeType()&&102!==I.getShapeType()&&103!==I.getShapeType()})};Ll.Object.defineProperties(Ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(Md.a)(Ud,"ShapeInsertedEvent",ud,[]);Em(qd,ud);qd.prototype.fc=function(){this.Rb(531)};
Ll.Object.defineProperties(qd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(Md.a)(qd,"ShapeStyleSetEvent",ud,[]);var Mj=b(929);Em(ue,ud);ue.prototype.fc=function(){this.Rb(581)};ue.prototype.ng=function(){var I=this;this.od(function(la){return Object(Kh.a)(Mj.a,la)&&4===la.getShapeTextFormat().ValidMembers});this.od(function(la){return Object(Kh.a)(Mj.a,la)&&la.getShapeTextFormat().Font.ValidMembers===I.URd})};Ll.Object.defineProperties(ue.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return this.Mda}}});Object(Md.a)(ue,"ShapeTextFontFormattedEventBase",ud,[]);Em(Jd,ue);Object(Md.a)(Jd,"ShapeTextBoldedEvent",ue,[]);var Xj=b(1081);Em(ge,ud);ge.prototype.fc=function(){this.Rb(581)};ge.prototype.ng=function(){this.od(function(I){return Object(Kh.a)(Xj.a,I)})};Ll.Object.defineProperties(ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(Md.a)(ge,"ShapeTextChangedEvent",ud,[]);Em(bc,ue);Object(Md.a)(bc,"ShapeTextFontColorChangedEvent",
ue,[]);Em(Fb,ue);Object(Md.a)(Fb,"ShapeTextFontNameChangedEvent",ue,[]);Em(Bc,ue);Object(Md.a)(Bc,"ShapeTextFontSizeChangedEvent",ue,[]);Em(Kc,ud);Kc.prototype.fc=function(){this.Rb(581)};Kc.prototype.ng=function(){this.od(function(I){return Object(Kh.a)(Mj.a,I)&&2===I.getShapeTextFormat().ValidMembers})};Ll.Object.defineProperties(Kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(Md.a)(Kc,"ShapeTextHorizontallyAlignedEvent",ud,[]);Em(Wb,ue);Object(Md.a)(Wb,
"ShapeTextItalicizedEvent",ue,[]);Em(gb,ue);Object(Md.a)(gb,"ShapeTextUnderlinedEvent",ue,[]);Em(Ma,ud);Ma.prototype.fc=function(){this.Rb(581)};Ma.prototype.ng=function(){this.od(function(I){return Object(Kh.a)(Mj.a,I)&&1===I.getShapeTextFormat().ValidMembers})};Ll.Object.defineProperties(Ma.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(Md.a)(Ma,"ShapeTextVerticallyAlignedEvent",ud,[]);Em(wf,ud);wf.prototype.fc=function(){this.Rb(138)};Ll.Object.defineProperties(wf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 13}}});Object(Md.a)(wf,"SheetAddedEvent",ud,[]);var gj=b(10);Em(Ye,ud);Ye.prototype.fc=function(){this.Rb(237)};Ye.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return!I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){I=I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>I.DeltaColumn&&!I.DeltaRow&&(!!I.InsertDeleteRange.FirstRow||I.InsertDeleteRange.LastRow!==
gj.a.zy)||!I.DeltaColumn&&0>I.DeltaRow&&(!!I.InsertDeleteRange.FirstColumn||I.InsertDeleteRange.LastColumn!==gj.a.Iv)})};Ll.Object.defineProperties(Ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(Md.a)(Ye,"SheetCellsDeletedEvent",ud,[]);Em(ye,ud);ye.prototype.fc=function(){this.Rb(237)};ye.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return!I.insertDeleteMultiRangeParameters.IsTableCommand});
this.od(function(I){I=I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<I.DeltaColumn&&!I.DeltaRow&&(!!I.InsertDeleteRange.FirstRow||I.InsertDeleteRange.LastRow!==gj.a.zy)||!I.DeltaColumn&&0<I.DeltaRow&&(!!I.InsertDeleteRange.FirstColumn||I.InsertDeleteRange.LastColumn!==gj.a.Iv)})};Ll.Object.defineProperties(ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(Md.a)(ye,"SheetCellsInsertedEvent",ud,[]);Em(Sd,ud);Sd.prototype.fc=function(){this.Rb(237)};
Sd.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return!I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return 0>I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.od(function(I){return I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
gj.a.zy})};Ll.Object.defineProperties(Sd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(Md.a)(Sd,"SheetColumnDeletedEvent",ud,[]);Em(jd,ud);jd.prototype.fc=function(){this.Rb(237)};jd.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return!I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return 0<I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.od(function(I){return I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===gj.a.zy})};Ll.Object.defineProperties(jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(Md.a)(jd,"SheetColumnInsertedEvent",ud,[]);Em(qc,ud);qc.prototype.fc=function(){this.Rb(137)};Ll.Object.defineProperties(qc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(Md.a)(qc,"SheetDeletedEvent",ud,[]);Em(tb,ud);tb.prototype.fc=function(){this.Rb(185)};Ll.Object.defineProperties(tb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(Md.a)(tb,"SheetDirectionChangedEvent",ud,[]);Em(pa,ud);pa.prototype.fc=function(){this.Rb(139)};Ll.Object.defineProperties(pa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(Md.a)(pa,"SheetDuplicatedEvent",ud,
[]);Em($g,ud);$g.prototype.fc=function(){this.Rb(207)};Ll.Object.defineProperties($g.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(Md.a)($g,"SheetNameEditedEvent",ud,[]);Em(Kg,ud);Kg.prototype.fc=function(){this.Rb(151)};Ll.Object.defineProperties(Kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(Md.a)(Kg,"SheetPaneFrozenEvent",ud,[]);Em(fg,ud);fg.prototype.fc=function(){this.Rb(226)};Ll.Object.defineProperties(fg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(Md.a)(fg,"SheetPrintSettingsSavedEvent",ud,[]);var bj=b(981);Em(Zd,ud);Zd.prototype.fc=function(){this.Rb(507)};Zd.prototype.hU=function(){this.FDa("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Zd.prototype.ng=function(){this.od(function(I){return Object.getType(I)===bj.a})};Ll.Object.defineProperties(Zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Md.a)(Zd,"SheetProtectionPausedResumedEvent",
ud,[]);Em(le,ud);le.prototype.fc=function(){this.Rb(557)};Ll.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(Md.a)(le,"SheetReorderedEvent",ud,[]);Em(Ce,ud);Ce.prototype.fc=function(){this.Rb(237)};Ce.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return!I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.od(function(I){return 0>I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.od(function(I){return I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===gj.a.Iv})};Ll.Object.defineProperties(Ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(Md.a)(Ce,"SheetRowDeletedEvent",ud,
[]);Em(md,ud);md.prototype.fc=function(){this.Rb(237)};md.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return!I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.od(function(I){return 0<I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.od(function(I){return I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===gj.a.Iv})};Ll.Object.defineProperties(md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(Md.a)(md,"SheetRowInsertedEvent",ud,[]);Em(Qc,ud);Qc.prototype.fc=function(){this.Rb(135)};Ll.Object.defineProperties(Qc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(Md.a)(Qc,"SheetRowsColumnsAutoFitEvent",ud,[]);
Em(Vb,ud);Vb.prototype.fc=function(){this.Rb(136)};Ll.Object.defineProperties(Vb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(Md.a)(Vb,"SheetRowsColumnsResizedEvent",ud,[]);Em(Bf,ud);Bf.prototype.fc=function(){this.Rb(183)};Ll.Object.defineProperties(Bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(Md.a)(Bf,"SheetShowGridlinesToggledEvent",ud,[]);Em(yf,ud);yf.prototype.fc=function(){this.Rb(184)};Ll.Object.defineProperties(yf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(Md.a)(yf,"SheetShowHeadingsToggledEvent",ud,[]);Em(If,ud);If.prototype.fc=function(){this.Rb(213)};Ll.Object.defineProperties(If.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(Md.a)(If,"SheetSpellCheckedEvent",ud,[]);Em(Xe,ud);Xe.prototype.fc=function(){this.Rb(515)};Ll.Object.defineProperties(Xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(Md.a)(Xe,
"SheetTabColoredEvent",ud,[]);Em(gg,ud);gg.prototype.fc=function(){this.Rb(157)};Ll.Object.defineProperties(gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(Md.a)(gg,"SheetVisibilityChangedEvent",ud,[]);Em(zf,ud);zf.prototype.fc=function(){this.Rb(239)};Ll.Object.defineProperties(zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(Md.a)(zf,"SheetsVisibilityChangedEvent",ud,[]);Em(Rg,ud);Rg.prototype.fc=function(){this.Rb(203)};
Ll.Object.defineProperties(Rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(Md.a)(Rg,"SlicerInsertedEvent",ud,[]);Em(Hf,ud);Hf.prototype.fc=function(){this.Rb(173)};Hf.prototype.ng=function(){this.od(function(I){return!I.clearFilter})};Ll.Object.defineProperties(Hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(Md.a)(Hf,"SlicerSelectionAppliedEvent",ud,[]);Em(Vg,ud);Vg.prototype.fc=function(){this.Rb(173)};Vg.prototype.ng=
function(){this.od(function(I){return I.clearFilter})};Ll.Object.defineProperties(Vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(Md.a)(Vg,"SlicerSelectionClearedEvent",ud,[]);Em(mf,ud);mf.prototype.fc=function(){this.Rb(208)};mf.prototype.ng=function(){this.od(function(I){return I.getParameters().FilterType===Rf.e7a})};Ll.Object.defineProperties(mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(Md.a)(mf,"TableCheckedItemsFilteredEvent",
ud,[]);Em(Ue,ud);Ue.prototype.fc=function(){this.Rb(237)};Ue.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return 0>I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ll.Object.defineProperties(Ue.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(Md.a)(Ue,"TableColumnDeletedEvent",ud,[]);Em(Se,ud);Se.prototype.fc=function(){this.Rb(237)};Se.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return 0<I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Ll.Object.defineProperties(Se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(Md.a)(Se,"TableColumnInsertedEvent",ud,[]);var yj=b(1080);Em(he,ud);he.prototype.fc=function(){this.Rb(141)};he.prototype.ng=function(){this.od(function(I){return Object(Kh.a)(yj.a,I)})};Ll.Object.defineProperties(he.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(Md.a)(he,"TableColumnSortedEvent",ud,[]);Em(Kd,ud);Kd.prototype.fc=function(){this.Rb(193)};
Ll.Object.defineProperties(Kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(Md.a)(Kd,"TableConvertedToRangeEvent",ud,[]);Em(Hd,ud);Hd.prototype.fc=function(){this.Rb(206)};Ll.Object.defineProperties(Hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(Md.a)(Hd,"TableCreatedEvent",ud,[]);Em(zc,ud);zc.prototype.fc=function(){this.Rb(209)};zc.prototype.ng=function(){this.od(function(I){return I.getParameters().FilterType===
Rf.e7a})};Ll.Object.defineProperties(zc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(Md.a)(zc,"TableCustomFilteredEvent",ud,[]);Em(wc,ud);wc.prototype.fc=function(){this.Rb(187)};wc.prototype.ng=function(){this.od(function(I){return 1===I.options.OperationType})};Ll.Object.defineProperties(wc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(Md.a)(wc,"TableCustomSortedEvent",ud,[]);Em(ob,ud);ob.prototype.fc=function(){this.Rb(176)};
ob.prototype.ng=function(){this.od(function(I){return I.autoFilterOptions.AutoFilterType===Rf.e7a});this.od(function(I){return!I.autoFilterOptions.CriteriaType})};Ll.Object.defineProperties(ob.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(Md.a)(ob,"TableFilterClearedEvent",ud,[]);Em(Ea,ud);Ea.prototype.fc=function(){this.Rb(176)};Ea.prototype.ng=function(){this.od(function(I){return I.autoFilterOptions.AutoFilterType===Rf.e7a});this.od(function(I){var la=new lh.a;
la.add(1);la.add(2);la.add(8);la.add(9);la.add(10);la.add(11);la.add(12);la.add(13);la.add(14);la.add(15);la.add(16);la.add(17);la.add(18);la.add(19);la.add(20);la.add(21);la.add(22);la.add(23);la.add(24);la.add(25);la.add(26);la.add(27);la.add(28);la.add(29);la.add(30);la.add(31);la.add(32);la.add(33);la.add(34);la.add(35);la.add(36);la.add(37);la.add(38);la.add(39);return la.contains(I.autoFilterOptions.CriteriaType)})};Ll.Object.defineProperties(Ea.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 32}}});Object(Md.a)(Ea,"TableItemFilteredEvent",ud,[]);Em(Cf,ud);Cf.prototype.fc=function(){this.Rb(217)};Ll.Object.defineProperties(Cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(Md.a)(Cf,"TableRenamedEvent",ud,[]);Em(og,ud);og.prototype.fc=function(){this.Rb(211)};Ll.Object.defineProperties(og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(Md.a)(og,"TableResizedEvent",ud,[]);Em(Qf,ud);Qf.prototype.fc=
function(){this.Rb(514)};Ll.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(Md.a)(Qf,"TableRowColumnRearrangedEvent",ud,[]);Em(ke,ud);ke.prototype.fc=function(){this.Rb(237)};ke.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.od(function(I){return 0>I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ll.Object.defineProperties(ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(Md.a)(ke,"TableRowDeletedEvent",ud,[]);Em(dg,ud);dg.prototype.fc=function(){this.Rb(237)};dg.prototype.ng=function(){this.od(function(I){return!!I.insertDeleteMultiRangeParameters});this.od(function(I){return I.insertDeleteMultiRangeParameters.IsTableCommand});this.od(function(I){return!I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.od(function(I){return 0<I.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ll.Object.defineProperties(dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(Md.a)(dg,"TableRowInsertedEvent",ud,[]);Em(je,ud);je.prototype.fc=function(){this.Rb(177)};je.prototype.ng=function(){this.od(function(I){return I.autoFilterOptions.AutoFilterType===Rf.e7a})};Ll.Object.defineProperties(je.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});
Object(Md.a)(je,"TableSortedEvent",ud,[]);Em(Jg,ud);Jg.prototype.fc=function(){this.Rb(212)};Ll.Object.defineProperties(Jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(Md.a)(Jg,"TableStyleAppliedEvent",ud,[]);Em(Ag,ud);Ag.prototype.fc=function(){this.Rb(196)};Ll.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(Md.a)(Ag,"TableStyleOptionToggledEvent",ud,[]);Em(Sc,ud);Sc.prototype.fc=function(){this.Rb(210)};
Sc.prototype.ng=function(){this.od(function(I){return I.getParameters().FilterType===Rf.e7a})};Ll.Object.defineProperties(Sc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(Md.a)(Sc,"TableTop10FilteredEvent",ud,[]);Em(Yd,ud);Yd.prototype.fc=function(){this.Rb(238)};Ll.Object.defineProperties(Yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(Md.a)(Yd,"TextToColumnsEvent",ud,[]);Em(yg,ud);yg.prototype.fc=function(){this.Rb(559)};
Ll.Object.defineProperties(yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 128}}});Object(Md.a)(yg,"ValuesSortedEvent",ud,[]);Em(sg,ud);sg.prototype.fc=function(){this.Rb(197)};Ll.Object.defineProperties(sg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(Md.a)(sg,"WorkbookCalculationModeSetEvent",ud,[]);Em(ig,ud);ig.prototype.fc=function(){this.Rb(181)};ig.prototype.ng=function(){this.od(function(I){return!!I.parentCommentId})};Ll.Object.defineProperties(ig.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});Object(Md.a)(ig,"WorkbookCommentRepliedEvent",ud,[]);Em(Eg,ud);Eg.prototype.fc=function(){this.Rb(181)};Eg.prototype.ng=function(){this.od(function(I){return!I.parentCommentId})};Ll.Object.defineProperties(Eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(Md.a)(Eg,"WorkbookCommentedEvent",ud,[]);Em(Gg,ud);Gg.prototype.fc=function(){this.Rb(128)};Ll.Object.defineProperties(Gg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 56}}});Object(Md.a)(Gg,"WorkbookRecalculatedEvent",ud,[]);Em(Uf,ud);Uf.prototype.fc=function(){this.Rb(171)};Ll.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(Md.a)(Uf,"WorkbookRedoEvent",ud,[]);Em(xf,ud);xf.prototype.fc=function(){this.Rb(170)};Ll.Object.defineProperties(xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(Md.a)(xf,"WorkbookUndoEvent",ud,[]);Em(Fg,
ud);Fg.prototype.fc=function(){this.Rb(507);this.Rb(576);this.Rb(10)};Fg.prototype.ng=function(){this.od(function(I){if(Object(Kh.a)(Fd,I)&&(I=Object(qi.a)(Fd,I),void 0!==I.source&&null!==I.source&&void 0!==I.eventId&&null!==I.eventId))return Je.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",I.source,I.eventId),!0;Je.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Ll.Object.defineProperties(Fg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 116}}});Object(Md.a)(Fg,"DefaultRichApiRequestExecutedEvent",ud,[]);Ef.prototype.TRe=function(I,la){var Va=this.URe(I,this.macroRecorderEvents,la);Va||(Va=this.URe(I,Ef.KLh(),la),!Va&&this.o6e(I,Ef.pye,la)&&(Va=Ef.pye));return Va};Ef.prototype.URe=function(I,la,Va){var Kb=new lh.a;la=Ol(la);for(var nc=la.next();!nc.done;nc=la.next())nc=nc.value,this.o6e(I,nc,Va)&&Kb.add(nc);return 1===Kb.count?Kb.oa(0):1<Kb.count?Ef.Cuh(Kb):null};Ef.prototype.o6e=
function(I,la,Va){var Kb=Ef.JCi(I,la);return Va?Kb&&Ef.nBj(I,la):Kb};Ef.prototype.gSi=function(){for(var I=new lh.a,la=Ol(this.Cb),Va=la.next();!Va.done;Va=la.next()){Va=Va.value;for(var Kb=!1,nc=Ol(Va.featureGates),Mc=nc.next();!Mc.done;Mc=nc.next())if(!ag.EwaSettings.ka(Mc.value)){I.add(Va);Kb=!0;break}if(!Kb)for(Kb=Ol(Va.BJe),nc=Kb.next();!nc.done;nc=Kb.next())if(!ag.EwaSettings.getBooleanFeatureGate(nc.value,!1)){I.add(Va);break}}I=Ol(I);for(la=I.next();!la.done;la=I.next())this.Cb.remove(la.value)};
Ef.KLh=function(){Ef.syb||(Ef.syb=new lh.a,Ef.syb.add(new Cd),Ef.syb.add(new lg));return Ef.syb};Ef.JCi=function(I,la){return la.operations.contains(I.operation)};Ef.nBj=function(I,la){var Va=la.Rwc;if(!Va.count)return!0;la=!0;Va=Ol(Va);for(var Kb=Va.next();!Kb.done;Kb=Va.next())if(Kb=Kb.value,!Kb(I.payload)){la=!1;break}return la};Ef.Cuh=function(I){var la=I.oa(0);I=Ol(I);for(var Va=I.next();!Va.done;Va=I.next())Va=Va.value,Va.Rwc.count>la.Rwc.count&&(la=Va);return la};Ll.Object.defineProperties(Ef.prototype,
{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Cb||(this.Cb=new lh.a,this.Cb.add(new Pb),this.Cb.add(new Ig),this.Cb.add(new ya),this.Cb.add(new Hc),this.Cb.add(new Zh),this.Cb.add(new Ah),this.Cb.add(new ze),this.Cb.add(new wd),this.Cb.add(new Nh),this.Cb.add(new cf),this.Cb.add(new Dg),this.Cb.add(new uh),this.Cb.add(new wf),this.Cb.add(new qc),this.Cb.add(new $g),this.Cb.add(new Hd),this.Cb.add(new Ue),this.Cb.add(new Se),this.Cb.add(new ke),this.Cb.add(new dg),this.Cb.add(new jd),
this.Cb.add(new Sd),this.Cb.add(new md),this.Cb.add(new Ce),this.Cb.add(new wc),this.Cb.add(new je),this.Cb.add(new mf),this.Cb.add(new ob),this.Cb.add(new Re),this.Cb.add(new zc),this.Cb.add(new Sc),this.Cb.add(new Ea),this.Cb.add(new Eg),this.Cb.add(new ig),this.Cb.add(new m),this.Cb.add(new Vb),this.Cb.add(new Ye),this.Cb.add(new ye),this.Cb.add(new Qc),this.Cb.add(new Td),this.Cb.add(new pg),this.Cb.add(new nd),this.Cb.add(new ia),this.Cb.add(new Qf),this.Cb.add(new Uf),this.Cb.add(new xf),this.Cb.add(new ed),
this.Cb.add(new Oh),this.Cb.add(new ka),this.Cb.add(new Wg),this.Cb.add(new pa),this.Cb.add(new sg),this.Cb.add(new Gg),this.Cb.add(new yb),this.Cb.add(new vg),this.Cb.add(new Eh),this.Cb.add(new qe),this.Cb.add(new hg),this.Cb.add(new Lg),this.Cb.add(new Kf),this.Cb.add(new le),this.Cb.add(new bh),this.Cb.add(new vc),this.Cb.add(new yf),this.Cb.add(new Bf),this.Cb.add(new Gc),this.Cb.add(new gg),this.Cb.add(new Xe),this.Cb.add(new og),this.Cb.add(new ae),this.Cb.add(new Oa),this.Cb.add(new $e),this.Cb.add(new eg),
this.Cb.add(new mj),this.Cb.add(new T),this.Cb.add(new Tg),this.Cb.add(new Eb),this.Cb.add(new qg),this.Cb.add(new Ae),this.Cb.add(new jg),this.Cb.add(new gd),this.Cb.add(new Xh),this.Cb.add(new Jg),this.Cb.add(new Ag),this.Cb.add(new If),this.Cb.add(new Kg),this.Cb.add(new Ud),this.Cb.add(new qd),this.Cb.add(new Ff),this.Cb.add(new xg),this.Cb.add(new dh),this.Cb.add(new Ai),this.Cb.add(new Qg),this.Cb.add(new $c),this.Cb.add(new fd),this.Cb.add(new vh),this.Cb.add(new Cf),this.Cb.add(new fi),this.Cb.add(new xd),
this.Cb.add(new ti),this.Cb.add(new Kd),this.Cb.add(new Ld),this.Cb.add(new te),this.Cb.add(new Hg),this.Cb.add(new Of),this.Cb.add(new K),this.Cb.add(new u),this.Cb.add(new ja),this.Cb.add(new kg),this.Cb.add(new Ie),this.Cb.add(new Ih),this.Cb.add(new Xg),this.Cb.add(new Tf),this.Cb.add(new X),this.Cb.add(new fg),this.Cb.add(new he),this.Cb.add(new ff),this.Cb.add(new zf),this.Cb.add(new Yf),this.Cb.add(new yg),this.Cb.add(new zg),this.Cb.add(new gh),this.Cb.add(new Bi),this.Cb.add(new Te),this.Cb.add(new Xf),
this.Cb.add(new Ne),this.Cb.add(new ch),this.Cb.add(new tb),this.Cb.add(new Af),this.Cb.add(new $h),this.Cb.add(new Og),this.Cb.add(new jh),this.Cb.add(new ph),this.Cb.add(new Ac),this.Cb.add(new $b),this.Cb.add(new Gb),this.Cb.add(new Dd),this.Cb.add(new Fh),this.Cb.add(new ie),this.Cb.add(new Xd),this.Cb.add(new oh),this.Cb.add(new Xa),this.Cb.add(new ih),this.Cb.add(new rf),this.Cb.add(new Pd),this.Cb.add(new Bh),this.Cb.add(new Zg),this.Cb.add(new be),this.Cb.add(new tg),this.Cb.add(new ve),this.Cb.add(new De),
this.Cb.add(new Fi),this.Cb.add(new rg),this.Cb.add(new af),this.Cb.add(new ec),this.Cb.add(new hb),this.Cb.add(new f),this.Cb.add(new Th),this.Cb.add(new Sf),this.Cb.add(new ci),this.Cb.add(new Me),this.Cb.add(new sf),this.Cb.add(new Lf),this.Cb.add(new mg),this.Cb.add(new de),this.Cb.add(new Rg),this.Cb.add(new Hf),this.Cb.add(new Vg),this.Cb.add(new ge),this.Cb.add(new Jd),this.Cb.add(new Wb),this.Cb.add(new gb),this.Cb.add(new bc),this.Cb.add(new Fb),this.Cb.add(new Bc),this.Cb.add(new Kc),this.Cb.add(new Ma),
this.Cb.add(new Hh),this.Cb.add(new xe),this.Cb.add(new Yd),this.Cb.add(new Zd),ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.gSi());return this.Cb}}});Ef.syb=null;Ef.pye=new Fg;Object(Md.a)(Ef,"MacroRecorderEventList",null,[]);var Yj=Ji.a;Em(wg,Yj);wg.prototype.create=function(){this.Eb(this.$.ea.Ba(297)||new Jh(this.$,new Ef(this.$),new xi))};wg.ja=function(I){I.ea.Ia(298,new wg(I))};Object(Md.a)(wg,"MacroRecorderEventHandlerFactory",Ji.a,[]);var cj=b(800),wi=
b(79),wh=b(35);Sg.prototype.Wc=function(){return!1};Sg.prototype.executeCommand=function(I,la,Va){I=wh.TaskExtensions.dm();la=la.command;switch(la){case 1845457202:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.De(2045014907,-1,0,null),this.automateCommandManager.I$h(la,1904816141===la?Va[wi.a.Md].toString():null)}return I};Sg.prototype.Ec=function(I,la){I=!1;switch(la.command){case 1845457202:case -45542983:case 971811139:case 1904816141:case 1606046412:I=this.$.Z$}return I};
Sg.prototype.Yc=function(I,la,Va){return"PopulateAutomateGalleryMenu"===la&&this.$.Z$?(this.automateCommandManager.Yc(la,Va),!0):!1};Object(Md.a)(Sg,"AutomateCommandHandler",null,[160]);var Nj=b(451),sd=cj.a;Em(Vf,sd);Vf.prototype.Gd=function(){var I=this;Nj.a(this.$,374,375,this.rb,function(){var la=I.$.ea.Ba(352);la?I.Ad([new Sg(la,I.$)]):Je.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")},"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveCommandManager")};
Vf.ja=function(I){I.ea.Ia(308,new Vf(I))};Object(Md.a)(Vf,"AutomateCommandHandlerFactory",cj.a,[]);Object(Md.a)(hf,"AuthContext",null,[]);var td=b(573),ni=b(125),Ph=b(103),Gh=b(26),M=b(930),wa=b(174);Pe.prototype.getAuthContext=function(){return this.Blb};Pe.prototype.Z7b=function(){function I(Mc,Yc){return(new Promise(function(Ed){window.setTimeout(function(){Ed(Mc)},Yc)})).then(function(Ed){Kb.push(Object.assign(new of.a,{name:"Error"+nc,string:Ed.ErrorMessage}));Kb.push(Object.assign(new of.a,
{name:"ErrorCode"+nc,string:Ed.ErrorCode}));nc++;return la.Q_f()})}var la=this,Va=Gh.a.Qa.Gb,Kb=[];if(this.oAuthManager)Kb.push(Object.assign(new of.a,{name:"IsAuthSupported",bool:this.Nke}));else return this.M4b(Kb,Va,"need_OAuthManager","No OAuthManager");if(!this.gv.cx||!this.gv.cx.value)return this.M4b(Kb,Va,"need_license","No License");if($f.AFrameworkApplication.ha.sa("IsAnonymousUser"))return this.M4b(Kb,Va,"need_user","Anonymous User");if(33E5>Date.now()-this.Blb.timeStamp)return Kb.push(Object.assign(new of.a,
{name:"UsedCachedToken",bool:!0})),wa.a(ni.a.isd,!0,0,Kb),Promise.resolve(Object.assign(new M.a,{IsSuccess:!0,Token:this.Blb.token}));Kb.push(Object.assign(new of.a,{name:"UsedCachedToken",bool:!1}));var nc=1;return this.Q_f().catch(function(Mc){return I(Mc,200)}).catch(function(Mc){return I(Mc,400)}).then(function(Mc){Mc.IsSuccess?(la.Blb.token=Mc.Token,la.Blb.timeStamp=Date.now()):(Kb.push(Object.assign(new of.a,{name:"Error"+nc,string:Mc.ErrorMessage})),Kb.push(Object.assign(new of.a,{name:"ErrorCode"+
nc,string:Mc.ErrorCode})));Kb.push(Object.assign(new of.a,{name:"Attempts",int64:nc}));Kb.push(Object.assign(new of.a,{name:"Error",string:Mc.ErrorMessage}));Kb.push(Object.assign(new of.a,{name:"ErrorCode",string:Mc.ErrorCode}));wa.a(ni.a.isd,Mc.IsSuccess,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);return Promise.resolve(Mc)}).catch(function(Mc){Kb.push(Object.assign(new of.a,{name:"Error"+nc,string:Mc.ErrorMessage}));Kb.push(Object.assign(new of.a,{name:"ErrorCode"+nc,string:Mc.ErrorCode}));Kb.push(Object.assign(new of.a,
{name:"Attempts",int64:nc}));return la.M4b(Kb,Va,Mc.ErrorCode,Mc.ErrorMessage)})};Pe.prototype.M4b=function(I,la,Va,Kb){I.push(Object.assign(new of.a,{name:"Error",string:Kb}));I.push(Object.assign(new of.a,{name:"ErrorCode",string:Va}));wa.a(ni.a.isd,!1,Ph.getElapsedMilliseconds(la,Gh.a.Qa.Gb),I);return Promise.resolve(Object.assign(new M.a,{IsSuccess:!1,ErrorMessage:Kb,ErrorCode:Va}))};Pe.prototype.Q_f=function(){var I=this,la=td.a.QJh(),Va=0;la=this.oAuthManager.aR("Maker",la).then(function(Kb){if(Kb)return!Kb.IsSuccess&&
I.cej(Kb)?Promise.reject(Kb):Promise.resolve(Kb);Kb=Object.assign(new M.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Kb)}).catch(function(Kb){var nc=new M.a;Object.getType(Kb)===Object.getType(nc)?nc=Kb:(nc.ErrorMessage=Kb.toString(),nc.ErrorCode="exception");return Promise.reject(nc)});return Promise.race([la,new Promise(function(Kb,nc){Va=window.setTimeout(function(){nc(Object.assign(new M.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},
2E4)})]).then(function(Kb){window.clearTimeout(Va);return Kb})};Pe.prototype.cej=function(I){return"interaction_required"===I.ErrorCode||"InitFailed"===I.ErrorCode||"invalid_resource"===I.ErrorCode||"login_required"===I.ErrorCode&&I.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(Md.a)(Pe,"AutomateCommandAuth",null,[439]);var Mb=b(931);Object(Md.a)(nf,"AutomateCommandGalleryBase",null,[]);var sc=b(828),dd=b(30),Be=b(846),jf=b(1349),gf=b(18),Jf=b(52),Gf=b(16),eh=b(806),ug=b(983);Ke.prototype.nsh=
function(I){var la=this.automateCommandManager.Sa.$o().pB(),Va=Ke.bT(I,Gf.a.instance.da(2046));this.ZOc(Va,td.a.zAi,this.automateCommandManager.hg,td.a.Dmi,Gf.a.instance.da(2042),this.automateCommandManager.Sa);Array.add(la.MenuSectionList,Va);Va=Ke.bT(I,Gf.a.instance.da(2047));this.ZOc(Va,td.a.Fji,td.a.MU?this.automateCommandManager.Bk.TKe(this.automateCommandManager.hg):this.automateCommandManager.vm.TKe(this.automateCommandManager.hg),td.a.Bif,Gf.a.instance.da(2043),this.automateCommandManager.Sa);
Array.add(la.MenuSectionList,Va);Va=Ke.bT(I,Gf.a.instance.da(2048));this.ZOc(Va,td.a.b1i,this.automateCommandManager.Ds,td.a.Bif,"",this.automateCommandManager.Sa);Array.add(la.MenuSectionList,Va);Va=Object.assign(new sc.a,{Id:td.a.mhe,ExternalId:td.a.mhe,Command:"1606046412",LabelText:Gf.a.instance.da(2039),Alt:Gf.a.instance.da(2040),Image16by16:Jf.a.ve(16),Image16by16Class:gf.a.YFe,Visible:!0});I=Ke.bT(I,null);I.ControlsId="myScriptsSection.Controls";Array.add(I.ControlList,Va);Array.add(la.MenuSectionList,
I);return la};Ke.prototype.ZOc=function(I,la,Va,Kb,nc,Mc){if(Va&&0<Va.length){la=Mc.Lz(la,1,"Size150by20").KXb();nc={};Mc={};Mc.root=Ke.sra(320,30);Mc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};Mc.label={margin:"0px 3px"};nc.galleryButtonInExpanded=Mc;la.GalleryStyle=nc;for(nc=0;nc<Va.length&&nc<Kb;nc++)Mc=Va.jJ(nc),Array.add(la.GalleryItems,Ke.n0b(Mc.id,Mc,!1));Array.add(I.ControlList,la)}else Va=Object.assign(new ug.a,
{Id:la,ExternalId:la,LabelText:nc}),I.ControlsId=Va.Id+".Controls",Array.add(I.ControlList,Va)};Ke.hNe=function(I){if(I){var la=String.format(td.a.tXh,I.isShared?td.a.i_f:td.a.gLf,Jf.a.ve(16));I=String.format(td.a.uXh,dd.a.Xf(I.name));return String.format(td.a.sXh,la,I)}return""};Ke.bT=function(I,la){return Object.assign(new Be.a,{Id:I,Title:la,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};Ke.n0b=function(I,la,Va){var Kb=Va?td.a.fsj:td.a.esj,
nc=Va?td.a.v2i:td.a.u2i,Mc=Va?td.a.i_f:td.a.gsj,Yc=Va?td.a.gLf:td.a.w2i;return la?Ke.Dve(la.ME||la.id,la.name,Va,la.isShared?Kb:nc,I,I,la.isShared?Mc:Yc):Ke.Dve("","",Va,"",I,I)};Ke.Dve=function(I,la,Va,Kb,nc,Mc,Yc){nc=void 0===nc?null:nc;Mc=void 0===Mc?null:Mc;Yc=void 0===Yc?null:Yc;var Ed=void 0===Ed?null:Ed;var re={},pf={};Va?(re.root=Ke.sra(32,32),pf.root=Ke.sra(32,32)):(re.root=Ke.sra(20,20),pf.root=Ke.sra(20,20));return Object.assign(new jf.a,{Id:I,ExternalId:nc||I,MenuItemId:Mc||I,Command:"1904816141",
Icon:Kb,Image:Jf.a.ve(16),ImageClass:Yc,LabelText:la,FullIconStyle:re,PreviewIconStyle:pf,Alt:Ed||la})};Ke.sra=function(I,la){var Va={};Va.width=I;Va["min-width"]=I;Va.height=la;return Va};Object(Md.a)(Ke,"AutomateCommandRenderer",null,[]);We.prototype.DIa=function(I){for(var la=0;la<this.scripts.length;la++)if(this.scripts[la].id===I||this.scripts[la].ME===I)return la;return-1};We.prototype.sort=function(){this.QUf(this.scripts)};We.prototype.Lp=function(I){return-1===this.DIa(I.id)?(this.scripts.push(I),
!0):!1};We.prototype.MVa=function(I){return-1===this.DIa(I.id)?(I=[I],this.scripts=I.concat.apply(I,this.scripts),!0):!1};We.prototype.Bgf=function(I){I=this.DIa(I.id);if(-1!==I){for(var la=this.scripts[I].mga();0<I;)this.scripts[I]=this.scripts[I-1],I--;this.scripts[0]=la}};We.prototype.Tca=function(I){var la=this.DIa(I.id);if(-1!==la){var Va=this.scripts[la].ME;this.scripts[la]=I;this.scripts[la].ME=Va}};We.prototype.scc=function(I){var la=this.DIa(I.id);return-1!==la?I.name===this.scripts[la].name:
!1};We.prototype.Oga=function(I){I=this.DIa(I);return-1!==I?(this.scripts.splice(I,1),!0):!1};We.prototype.clear=function(){this.scripts=[]};We.prototype.py=function(I){I=this.DIa(I);return-1!==I?this.scripts[I]:null};We.prototype.jJ=function(I){return 0<=I&&this.length>I?this.scripts[I]:null};We.prototype.TKe=function(I){for(var la=new We([],this.QUf),Va=0;Va<this.scripts.length;Va++){var Kb=this.scripts[Va];I.py(Kb.id)||la.Lp(Kb)}return la};We.prototype.jbb=function(){for(var I=[],la=Ol(this.scripts),
Va=la.next();!Va.done;Va=la.next())I.push(Va.value.vOd());return I};Ll.Object.defineProperties(We.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(Md.a)(We,"ScriptCollection",null,[]);var xh=b(180);Qd.prototype.mga=function(){return new Qd(this.l9)};Qd.prototype.vOd=function(){return this.l9};Ll.Object.defineProperties(Qd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.l9.id}},ME:{configurable:!0,enumerable:!0,get:function(){return this.l9.shareId},
set:function(I){this.l9.shareId=I||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.l9.name}},Jxe:{configurable:!0,enumerable:!0,get:function(){return this.l9.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.l9.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.l9.description}},V3e:{configurable:!0,enumerable:!0,get:function(){return this.l9.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.ME&&
0<this.ME.length}}});Object(Md.a)(Qd,"ScriptCore",null,[]);var Qh=b(57),Vi=b(44);Em(ad,nf);ad.prototype.C8b=function(I){switch(I){case "1":case "2":case "3":return this.pA.jJ(parseInt(I)-1);default:return this.Ne.Bk.py(I)||this.Ne.vm.py(I)||this.Ne.hg.py(I)||this.Ne.Ds.py(I)}};ad.prototype.H7b=function(I,la,Va){var Kb=null;if(this.Ne.S1a)switch(I){case "1":case "2":case "3":Kb=this.pA.jJ(parseInt(I)-1);break;default:Kb=this.pA.py(I)}Vi.a.isReactRibbonEnabled()?(Va=ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Va:!Qh.a.Df.fA,la[Mb.a.GalleryButtonProps]=Ke.n0b(I,Kb,Va)):la[Mb.a.InnerHTML]=Ke.hNe(Kb);la[Mb.a.Alt]=Kb?Kb.name:""};ad.prototype.wC=function(I){this.pA=this.mDb();this.$.zf();var la=[];la.push(Object.assign(new of.a,{name:"Operation",string:I}));la.push(Object.assign(new of.a,{name:"HasReadRecentCachedScripts",bool:this.Ne.XIa}));la.push(Object.assign(new of.a,{name:"ReadScriptsDone",bool:this.Ne.U1a}));la.push(Object.assign(new of.a,{name:"ReadSamplesScriptsDone",bool:this.Ne.wba}));la.push(Object.assign(new of.a,
{name:"SamplesScriptCount",int64:this.Ne.Ds.length}));la.push(Object.assign(new of.a,{name:"ReadRecentScriptsDone",bool:this.Ne.vba}));la.push(Object.assign(new of.a,{name:"RecentScriptCount",int64:this.Ne.Bk.length}));la.push(Object.assign(new of.a,{name:"ReadWorkbookScriptsDone",bool:this.Ne.As}));la.push(Object.assign(new of.a,{name:"WorkbookScriptCount",int64:this.Ne.hg.length}));wa.a(ni.a.hsd,!0,0,la)};ad.prototype.A9b=function(I){var la=!1,Va="",Kb=new Qd(I.scriptMetadata),nc={Operation:"HandleRefreshRibbonGallery"};
nc.RefreshOperation=I.operationName;switch(I.operationName){case td.a.yAd:I=this.ktb(Kb);Va=I.message;la=I.returnValue;break;case td.a.wAd:I=this.itb(Kb);Va=I.message;la=I.returnValue;break;case td.a.vAd:I=this.htb(Kb);Va=I.message;la=I.returnValue;break;case td.a.xAd:I=this.jtb(Kb);Va=I.message;la=I.returnValue;break;case td.a.MCf:I=this.ucd(Kb),Va=I.message,la=I.returnValue}(nc.GalleryUpdated=la)?(Je.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",
Va),this.wC("RefreshGallery")):Je.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Va);nc.Message=Va;Je.ULS.sendTraceTag(537170320,0,50,yh.c(nc))};ad.prototype.mDb=function(){for(var I=new We([],function(){}),la=this.Ne.hg?this.Ne.hg.length:0,Va=this.Ne.Bk?this.Ne.Bk.length:0,Kb=this.Ne.Ds?this.Ne.Ds.length:0,nc=0,Mc=0;Mc<td.a.Hxd;Mc++)if(Mc<la)I.Lp(this.Ne.hg.jJ(Mc));else if(Mc-la+nc<Va){var Yc=this.Ne.Bk.jJ(Mc-la+
nc);this.Ne.hg.py(Yc.id)?(nc++,Mc--):I.Lp(Yc)}else Mc-la-Va+nc<Kb&&I.Lp(this.Ne.Ds.jJ(Mc-la+nc-Va));return I};ad.prototype.ktb=function(I){if(this.Ne.Bk.MVa(I))var la="";else{la="";var Va=I.mga();this.Ne.hg.Tca(Va);this.Ne.hg.sort();this.Ne.Bk.Tca(I)}return{returnValue:!0,message:la}};ad.prototype.itb=function(I){this.Ne.hg.Oga(I.id);return this.Ne.Bk.Oga(I.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};ad.prototype.htb=
function(I){var la=I.mga();la.ME=null;this.Ne.Bk.MVa(la);return this.Ne.hg.Lp(I)?(this.Ne.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};ad.prototype.jtb=function(I){return this.Ne.hg.Oga(I.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};ad.prototype.ucd=function(I){var la=I.mga(),Va=!1;this.Ne.hg.scc(la)&&(this.Ne.hg.Tca(la),this.Ne.hg.sort(),
Va=!0);this.Ne.Bk.MVa(I)?Va=!0:this.Ne.Bk.scc(I)&&(this.Ne.Bk.Tca(I),this.Ne.Bk.Bgf(I),Va=!0);return{returnValue:Va,message:""}};Object(Md.a)(ad,"AutomateCommandGallery",nf,[]);var oi=b(88);Object(Md.a)(kc,"AutomateCommandLicensingBase",null,[]);Object(Md.a)(Ub,"BoolResultWrapper",null,[]);Em(bb,kc);bb.prototype.Wpe=function(){var I=this,la=Gh.a.Qa.Gb,Va=[];return new Promise(function(Kb){oi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(nc){nc.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(Mc){Va.push(Object.assign(new of.a,{name:"IsLicensed",bool:Mc}));wa.a(ni.a.djf,!0,Ph.getElapsedMilliseconds(la,Gh.a.Qa.Gb),Va);I.cx=new Ub(Mc,!0);Kb(Mc)}).catch(function(Mc){Va.push(Object.assign(new of.a,{name:"IsLicensed",bool:!1}));Va.push(Object.assign(new of.a,{name:"Error",string:Mc.toString()}));Va.push(Object.assign(new of.a,{name:"ErrorCode",string:"exception"}));wa.a(ni.a.djf,!1,Ph.getElapsedMilliseconds(la,Gh.a.Qa.Gb),Va);I.cx=new Ub(!1,!1,void 0,"exception",Mc.toString());
Kb(!1)})})})};Object(Md.a)(bb,"AutomateCommandLicensing",kc,[]);var Yg=b(1270),rj=b(1268),ah=b(1267),Qi=b(1269);Nb.taskPaneWidth="TaskPaneWidth";Nb.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";Nb.el="TaskPaneTitle";Nb.Nj="IconCssClass";Nb.DNd="TaskPaneIconUrl";Nb.xQa="TaskPaneIconId";Nb.eH="NonPersistedSettings";Nb.onTaskPaneClose="OnTaskPaneClose";Nb.KNc="ActionArgs";Object(Md.a)(Nb,"PropertyNames",null,[]);var sj=b(139),Ci=b(196),tj=b(304),oj=b(4);Em(za,nf);za.prototype.C8b=
function(I){switch(I){case "1":case "2":case "3":return this.pA.jJ(parseInt(I)-1);default:return this.automateCommandManager.Bk.py(I)||this.automateCommandManager.hg.py(I)||this.automateCommandManager.Ds.py(I)}};za.prototype.H7b=function(I,la,Va){var Kb=null;if(this.automateCommandManager.S1a)switch(I){case "1":case "2":case "3":Kb=this.pA.jJ(parseInt(I)-1);break;default:Kb=this.pA.py(I)}Vi.a.isReactRibbonEnabled()?(Va=ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Va:!Qh.a.Df.fA,la[Mb.a.GalleryButtonProps]=Ke.n0b(I,Kb,Va)):la[Mb.a.InnerHTML]=Ke.hNe(Kb);la[Mb.a.Alt]=Kb?Kb.name:""};za.prototype.wC=function(I){this.pA=this.mDb();this.$.zf();var la=[];la.push(Object.assign(new of.a,{name:"Operation",string:I}));la.push(Object.assign(new of.a,{name:"HasReadRecentCachedScripts",bool:this.automateCommandManager.XIa}));la.push(Object.assign(new of.a,{name:"ReadScriptsDone",bool:this.automateCommandManager.U1a}));la.push(Object.assign(new of.a,{name:"ReadSamplesScriptsDone",
bool:this.automateCommandManager.wba}));la.push(Object.assign(new of.a,{name:"SamplesScriptCount",int64:this.automateCommandManager.Ds.length}));la.push(Object.assign(new of.a,{name:"ReadRecentScriptsDone",bool:this.automateCommandManager.vba}));la.push(Object.assign(new of.a,{name:"RecentScriptCount",int64:this.automateCommandManager.Bk.length}));la.push(Object.assign(new of.a,{name:"ReadWorkbookScriptsDone",bool:this.automateCommandManager.As}));la.push(Object.assign(new of.a,{name:"WorkbookScriptCount",
int64:this.automateCommandManager.hg.length}));wa.a(ni.a.hsd,!0,0,la)};za.prototype.A9b=function(I){var la=!1,Va="",Kb=new Qd(I.scriptMetadata),nc={Operation:"HandleRefreshRibbonGallery"};nc.RefreshOperation=I.operationName;switch(I.operationName){case td.a.yAd:I=this.ktb(Kb);Va=I.message;la=I.returnValue;break;case td.a.wAd:I=this.itb(Kb);Va=I.message;la=I.returnValue;break;case td.a.vAd:I=this.htb(Kb);Va=I.message;la=I.returnValue;break;case td.a.xAd:I=this.jtb(Kb);Va=I.message;la=I.returnValue;
break;case td.a.MCf:I=this.ucd(Kb),Va=I.message,la=I.returnValue}(nc.GalleryUpdated=la)?(Je.ULS.sendTraceTag(537170319,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Va),this.wC("RefreshGallery")):Je.ULS.sendTraceTag(537170318,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Va);nc.Message=Va;Je.ULS.sendTraceTag(537170317,0,50,yh.c(nc))};za.prototype.mDb=function(){for(var I=new We([],function(){}),la=this.automateCommandManager.hg?
this.automateCommandManager.hg.length:0,Va=this.automateCommandManager.Bk?this.automateCommandManager.Bk.length:0,Kb=this.automateCommandManager.Ds?this.automateCommandManager.Ds.length:0,nc=0,Mc=0;Mc<td.a.Hxd;Mc++)if(Mc<la)I.Lp(this.automateCommandManager.hg.jJ(Mc));else if(Mc-la+nc<Va){var Yc=this.automateCommandManager.Bk.jJ(Mc-la+nc);this.automateCommandManager.hg.py(Yc.id)?(nc++,Mc--):I.Lp(Yc)}else Mc-la-Va+nc<Kb&&I.Lp(this.automateCommandManager.Ds.jJ(Mc-la+nc-Va));return I};za.prototype.ktb=
function(I){if(this.automateCommandManager.Bk.MVa(I))var la="";else{la="";var Va=I.mga();this.automateCommandManager.hg.Tca(Va);this.automateCommandManager.hg.sort();this.automateCommandManager.Bk.Tca(I)}return{returnValue:!0,message:la}};za.prototype.itb=function(I){this.automateCommandManager.hg.Oga(I.id);return this.automateCommandManager.Bk.Oga(I.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};za.prototype.htb=
function(I){var la=I.mga();la.ME=null;this.automateCommandManager.Bk.MVa(la);return this.automateCommandManager.hg.Lp(I)?(this.automateCommandManager.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};za.prototype.jtb=function(I){return this.automateCommandManager.hg.Oga(I.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};za.prototype.ucd=function(I){var la=
I.mga(),Va=!1;this.automateCommandManager.hg.scc(la)&&(this.automateCommandManager.hg.Tca(la),this.automateCommandManager.hg.sort(),Va=!0);this.automateCommandManager.Bk.MVa(I)?Va=!0:this.automateCommandManager.Bk.scc(I)&&(this.automateCommandManager.Bk.Tca(I),this.automateCommandManager.Bk.Bgf(I),Va=!0);return{returnValue:Va,message:""}};Object(Md.a)(za,"AutomateCommandGalleryOld",nf,[]);we.RUf=function(I){I.sort(function(la,Va){return Va.Jxe-la.Jxe})};we.Ssc=function(I){I.sort(function(la,Va){return th.a.compare(la.name,
Va.name,!0)})};we.UUe=function(I){var la;var Va=la=null;if(I){var Kb=I.indexOf(":");if(-1!==Kb)return la=I.substr(0,Kb),Va=I.substr(Kb+1),{returnValue:!0,CMd:la,ME:Va}}return{returnValue:!1,CMd:la,ME:Va}};we.MHh=function(I,la){var Va={};Va[td.a.f6f]=encodeURIComponent(I.workbookContext.WorkbookFileName);Va[td.a.jLf]=la.jbb();return Gi.a.Hc(Va)};Ll.Object.defineProperties(we.prototype,{S1a:{configurable:!0,enumerable:!0,get:function(){return this.v3||this.U1a}},U1a:{configurable:!0,enumerable:!0,get:function(){return(td.a.MU?
this.vba:this.z5)&&this.As&&this.wba}}});Object(Md.a)(we,"AutomateCommandStorageBase",null,[]);Object(Md.a)(Le,"UserInfo",null,[]);var Pj=b(514),Kj=b(161),Yi=b(81),di=b(275);Object(Md.a)(pd,"LaunchSDXParams",null,[]);Object(Md.a)(Zc,"RunfromButtonParameters",null,[]);var Qj=b(162),bk=b(126),Nk=b(27),wk=b(895),vj=b(49),xk=b(106),Bj=b(47);Fc.prototype.Taj=function(I){td.a.xp?this.Ne.vm=I:this.u7d=I};Fc.prototype.Saj=function(I){td.a.xp?this.Ne.hg=I:this.T5d=I};Fc.prototype.Waj=function(I){td.a.xp?this.Ne.Ds=
I:this.V8d=I};Fc.prototype.Uaj=function(I){this.Ne.Bk=I};Fc.prototype.tHb=function(I){var la=$f.AFrameworkApplication.ha.sa("IsO365CommercialHost"),Va="",Kb="",nc=!1;var Mc=!(this.gv.cx&&this.gv.cx.isSuccess&&this.gv.cx.value&&(!this.xz||!this.xz.isSuccess));this.gv.cx&&!this.gv.cx.isSuccess?(Kb=this.gv.cx.errorCode,Va=this.gv.cx.errorMessage):this.xz&&!this.xz.isSuccess&&(Kb=this.xz.errorCode,Va=this.xz.errorMessage);var Yc=[];Yc.push(Object.assign(new of.a,{name:"IsScriptingEnabled",bool:this.eaa}));
Yc.push(Object.assign(new of.a,{name:"IsValidHost",bool:la}));Yc.push(Object.assign(new of.a,{name:"IsUserLicensed",bool:this.gv.cx?this.gv.cx.value:!1}));Yc.push(Object.assign(new of.a,{name:"IsAdminSwitchOn",bool:this.xz?this.xz.value:!1}));Yc.push(Object.assign(new of.a,{name:"ShowTab",bool:this.eaa}));Yc.push(Object.assign(new of.a,{name:"ServiceChecked",bool:!I}));this.eaa&&Vi.a.bva(this.$)&&((I=Qj.a(this.$))&&I.tn?(Yc.push(Object.assign(new of.a,{name:"RibbonType",string:"React"})),I.tn.Shj(oj.a.Ezd),
I.tn.VHd(["AutomateRecorder","AutomateNewScript","AutomateGallery","AutomateAllScripts"],!1),ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(nc=!0)):(Kb="ribbon_manager_error",Va="The RibbonManager or RibbonUser is null"));Yc.push(Object.assign(new of.a,{name:"Error",string:Va}));Yc.push(Object.assign(new of.a,{name:"ErrorCode",string:Kb}));wa.a(ni.a.tni,Mc,Ph.getElapsedMilliseconds(this.initTime,Gh.a.Qa.Gb),Yc);return Promise.resolve(nc)};Fc.prototype.Yc=function(I,
la){if(!la)return!1;la.MenuItems=this.AAg.nsh(la.MenuId);return!0};Fc.prototype.pGi=function(){var I=this;if(this.Pua)if(td.a.MU)this.Ne.CBf(this.uX).continueWith(function(Kb){Kb.result&&I.uX.wC(td.a.INa)});else if(td.a.xp)this.Ne.XNi(this.uX);else{var la=Gh.a.Qa.Gb,Va=[];wh.TaskExtensions.Aa(this.indexedDB.iIa(td.a.tNa),function(Kb){var nc=!I.z5||!I.vm.length;Kb=Kb.result;Va.push(Object.assign(new of.a,{name:"ExistingScriptCount",int64:I.vm.length}));if(""!==Kb)if(Kb=yh.b(Kb),Va.push(Object.assign(new of.a,
{name:"CachedScriptCount",int64:Kb.length})),nc){for(var Mc=Ol(Kb),Yc=Mc.next();!Yc.done;Yc=Mc.next())I.vm.Lp(new Qd(Yc.value));I.vm.sort();I.v3=!0;I.u8a=0<Kb.length;wa.a(ni.a.Fzb,nc,Ph.getElapsedMilliseconds(la,Gh.a.Qa.Gb),Va);I.wC("CachedScripts")}else wa.a(ni.a.Fzb,nc,Ph.getElapsedMilliseconds(la,Gh.a.Qa.Gb),Va);else wa.a(ni.a.Fzb,nc,Ph.getElapsedMilliseconds(la,Gh.a.Qa.Gb),Va)},this.$.la,3)}mc(this.$)?this.fUe(Object.assign(new M.a,{IsSuccess:!0,Token:"FakeToken"})):this.tqa.Z7b().then(function(Kb){I.fUe(Kb)})};
Fc.prototype.H7b=function(I,la,Va){if(td.a.MU||td.a.xp)this.uX.H7b(I,la,Va);else{var Kb=null;if(this.S1a)switch(I){case "1":case "2":case "3":Kb=this.pA.jJ(parseInt(I)-1);break;default:Kb=this.pA.py(I)}la[Mb.a.GalleryButtonProps]=Ke.n0b(I,Kb,this.H7h?2===Va:!Qh.a.Df.fA);la[Mb.a.Alt]=Kb?Kb.name:""}};Fc.prototype.A9b=function(I){if(td.a.MU||td.a.xp)this.uX.A9b(I);else{var la=!1,Va="",Kb=new Qd(I.scriptMetadata),nc={Operation:"HandleRefreshRibbonGallery"};nc.RefreshOperation=I.operationName;switch(I.operationName){case td.a.yAd:I=
this.ktb(Kb);Va=I.message;la=I.returnValue;break;case td.a.wAd:I=this.itb(Kb);Va=I.message;la=I.returnValue;break;case td.a.vAd:I=this.htb(Kb);Va=I.message;la=I.returnValue;break;case td.a.xAd:I=this.jtb(Kb),Va=I.message,la=I.returnValue}(nc.GalleryUpdated=la)?(Je.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Va),this.wC("RefreshGallery")):Je.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",
Va);nc.Message=Va;Je.ULS.sendTraceTag(537170311,0,50,yh.c(nc))}};Fc.prototype.hPh=function(I,la,Va){var Kb=this;this.$.Xs(null,!1,1023)&&(I=new Zc(td.a.P0i,I,la,Va,this.eaa),this.Yke.ltb(I),ag.EwaSettings.getBooleanFeatureGate(td.a.aYf,!1)&&(this.uHb(63),bf(5E3).then(function(){Kb.c$b(63)})))};Fc.prototype.iPh=function(I,la,Va){I=new Zc(td.a.SBj,I,la,Va,this.eaa);this.Yke.ltb(I)};Fc.prototype.I$h=function(I,la){var Va=vj.b().$h(I),Kb=[];Kb.push(Object.assign(new of.a,{name:"SessionId",string:this.$.ya.UserSessionId}));
Kb.push(Object.assign(new of.a,{name:"MenuItemId",string:la}));Kb.push(Object.assign(new of.a,{name:"WorkbookScriptCount",int64:this.hg.length}));Kb.push(Object.assign(new of.a,{name:"PublishedScriptCount",int64:this.vm.length}));Kb.push(Object.assign(new of.a,{name:"RecentScriptCount",int64:this.Bk.length}));Kb.push(Object.assign(new of.a,{name:"Command",string:Va}));la=la?this.C8b(la):null;if(Va=this.pCh(I,Va,la))Kb.push(Object.assign(new of.a,{name:td.a.jga,string:Va.Wwa.gr[td.a.jga]})),Yg.a.instance.iLa(Va.Gjh,
"Taskpane",Va.jFa,Va.Rdd,Va.Wwa),1904816141===I&&(Kb.push(Object.assign(new of.a,{name:"ScriptId",string:la.id})),Kb.push(Object.assign(new of.a,{name:"ShareId",string:la.ME})),Kb.push(Object.assign(new of.a,{name:"IsPreviewGallery",bool:td.a.MU||td.a.xp?!!this.uX.pA.py(la.id):!!this.pA.py(la.id)})),Kb.push(Object.assign(new of.a,{name:"IsOwner",bool:la.V3e||!!this.vm.py(la.id)})),this.$.zf());wa.a(ni.a.qni,void 0,void 0,Kb)};Fc.prototype.pCh=function(I,la,Va){var Kb=td.a.Qq,nc=new rj.a(td.a.G_e,
td.a.hMe,td.a.locale),Mc=new ah.a(td.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,td.a.DFb),Yc=new Qi.a;Yc.gr.AdminPolicyForFeedback=yh.c(this.WDa);Yc.gr.DocumentHostInfo=Gi.a.Hc(this.$.ya.DocumentHostInfo);Yc.gr.CodeEditorUrl=td.a.Vrb(this.$);Yc.gr.MakerTestService=ag.EwaSettings.getBooleanFeatureGate(td.a.vyb,!1);Yc.gr.StorageModePreference=this.iWf||"";Yc.gr.Source="Ribbon";Yc.gr.IsTeams=Li.a.nja;Yc.gr[td.a.$Xf]=Gi.a.Hc(Kb);Yc.gr[td.a.Dle]=this.$.cjf?"true":"false";Yc.gr[td.a.jga]=Ci.a.create().toString();
var Ed=Qe(this.$),re=Bd(this.$);Yc.Ri.HeaderCssClass=Ed;Yc.Ri.TitleCssClass=re;Yc.gr[td.a.FZe]=Ed;Yc.gr[td.a.eZf]=re;Ed={};Ed.ribbonCommand=la;Ed[td.a.hWf]=this.tqa.getAuthContext();Ed[td.a.tNa]=this.u8a?this.vm.jbb():null;Ed[td.a.cLb]=this.Cxa?this.hg.jbb():null;td.a.MU&&(Ed[td.a.INa]=this.Ne.Lzd?this.Bk.jbb():null);Yc.gr[td.a.B2e]=Gi.a.Hc(Ed);la={};od(this.$,la);Yc.gr[td.a.vLe]=Gi.a.Hc(la);switch(I){case -45542983:Yc.gr.Script="";Yc.gr.Destination="Editor";Yc.gr.IsOwner=!0;Yc.Ri[Nb.el]=Gf.a.instance.da(2036);
Yc.Ri[Nb.taskPaneWidth]=Kb;Yc.Ri[Nb.sourceLocationOverrideResourceId]=td.a.Vrb(this.$);I=td.a.FWc;break;case 971811139:case 1606046412:Yc.gr.Script="";Yc.gr.Destination="BackStage";Yc.gr.IsOwner=!0;Yc.Ri[Nb.el]=Gf.a.instance.da(2036);Yc.Ri[Nb.taskPaneWidth]=Kb;Yc.Ri[Nb.sourceLocationOverrideResourceId]=td.a.Vrb(this.$);I=td.a.FWc;break;case 1845457202:Yc.Ri[Nb.el]=Gf.a.instance.da(2037);Yc.Ri[Nb.taskPaneWidth]=Kb;Yc.Ri[Nb.sourceLocationOverrideResourceId]=td.a.MTe(this.$);I=td.a.B2i;break;case 1904816141:if(Va)Yc.gr.Script=
Gi.a.Hc(Va.vOd()),Yc.gr.Destination="Details",Yc.gr.IsOwner=Va.V3e||!!this.vm.py(Va.id),Yc.Ri[Nb.el]=Gf.a.instance.da(2036),Yc.Ri[Nb.taskPaneWidth]=Kb,Yc.Ri[Nb.sourceLocationOverrideResourceId]=td.a.Vrb(this.$),I=td.a.FWc;else return null;break;default:return null}return new pd(nc,Mc,Yc,I)};Fc.prototype.zth=function(){var I=this;oi.a.instance.oc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(la){I.WDa.FeedbackEnabled=!0;I.WDa.ScreenshotEnabled=!0;I.WDa.EmailEnabled=
!0;la.bJ("Enabled").then(function(Va){I.WDa.FeedbackEnabled=Va},function(){});la.bJ("IncludeScreenshot").then(function(Va){I.WDa.ScreenshotEnabled=Va},function(){});la.bJ("IncludeEmail").then(function(Va){I.WDa.EmailEnabled=Va},function(){})})};Fc.prototype.NPh=function(I){var la=this,Va=Gh.a.Qa.Gb,Kb=[];if(!I||!I.IsSuccess){var nc=I?I.ErrorCode:"need_token";I=I?I.ErrorMessage:"No Access Token";Kb.push(Object.assign(new of.a,{name:"ServiceChecked",bool:!1}));Kb.push(Object.assign(new of.a,{name:"Error",
string:I}));Kb.push(Object.assign(new of.a,{name:"ErrorCode",string:nc}));wa.a(ni.a.fsd,!1,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);this.xz=new Ub(!1,!1,void 0,nc,I);return Promise.resolve(!1)}Kb.push(Object.assign(new of.a,{name:"ServiceChecked",bool:!0}));Tc(this.$,I.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(Mc){la.xz=new Ub(Mc.OfficeScriptingEnabled,!0);la.CTc(td.a.N6b(la.$),Mc.OfficeScriptingEnabled);Kb.push(Object.assign(new of.a,{name:"IsEnabled",
bool:la.xz.value}));wa.a(ni.a.fsd,!0,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);return Promise.resolve(la.xz.value)}).catch(function(Mc){Object.getType(Mc)===makerstorage.StorageServiceError?(Kb.push(Object.assign(new of.a,{name:"Error",string:Mc.message})),Kb.push(Object.assign(new of.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Mc.errorCode.toString(),Mc.status.toString())}))):(Kb.push(Object.assign(new of.a,{name:"Error",string:Mc.toString()})),Kb.push(Object.assign(new of.a,
{name:"ErrorCode",string:"exception"})));wa.a(ni.a.fsd,!1,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);la.xz=new Ub(!1,!1,void 0,"exception",Mc.toString());return Promise.resolve(!1)})};Fc.prototype.Mzd=function(I){var la=this;if(td.a.xp)return this.Ne.Mzd(I,this.uX);var Va=new sj.a,Kb=Ob(this.$);return yc(this.$,function(nc){if((nc=nc.Result)&&200===nc.ResponseStatusCode)nc=JSON.parse(nc.ResponseBody.join("")),I(la.Yvd(nc.value)),Va.setResult(!0);else{nc=nc?"RichApi_"+nc.ResponseStatusCode:"RichApiError";
var Mc=[];Mc.push(Object.assign(new of.a,{name:"Error",string:"Failed to read shared script ids from document"}));Mc.push(Object.assign(new of.a,{name:"ErrorCode",string:nc}));la.As=!0;la.SS(Gh.a.Qa.Gb,0,Mc);Va.setResult(!1)}},function(nc){nc=bk.a.xg(nc.data);Je.ULS.sendTraceTag(537170310,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",Nk.a.Uc(nc));var Mc=[];Mc.push(Object.assign(new of.a,{name:"Error",string:"Failure using rich api: "+nc}));Mc.push(Object.assign(new of.a,
{name:"ErrorCode",string:"RichApiFailure"}));la.As=!0;la.SS(Gh.a.Qa.Gb,0,Mc);Va.setResult(!1)},Kb,Va)};Fc.prototype.fUe=function(I){var la=this;td.a.MU?this.Ne.qGh(I,this.uX,this.cache):this.PFh(I);this.oad();this.Mzd(function(Va){la.Bad(Va,I)})};Fc.prototype.oad=function(){if(td.a.xp)this.Ne.oad(this.uX);else{var I={id:"samples-2"};I.name=Gf.a.instance.da(2049);this.Ds.Lp(new Qd(I));I.id="samples-4";I.name=Gf.a.instance.da(2050);this.Ds.Lp(new Qd(I));I.id="samples-5";I.name=Gf.a.instance.da(2051);
this.Ds.Lp(new Qd(I));this.wba=!0;this.wC("SampleScripts")}};Fc.prototype.PFh=function(I){var la=this,Va=Gh.a.Qa.Gb,Kb=[];if(I&&I.IsSuccess){Tc(this.$,I.Token);var nc=qj.a.create().toString();Kb.push(Object.assign(new of.a,{name:"CorrelationId",string:nc}));makerstorage.getScripts(nc).then(function(Mc){Kb.push(Object.assign(new of.a,{name:"HasReadCachedScripts",bool:la.v3}));la.vm.clear();Mc=Ol(Mc);for(var Yc=Mc.next();!Yc.done;Yc=Mc.next())la.vm.Lp(new Qd(Yc.value));la.vm.sort();la.u8a=!0;la.z5=
!0;la.Pua&&(Mc=Gi.a.Hc(la.vm.jbb()),la.indexedDB.U9a(new wk.a(td.a.tNa,Mc)));Kb.push(Object.assign(new of.a,{name:"ScriptCount",int64:la.vm.length}));wa.a(ni.a.Gzb,!0,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);la.wC(td.a.tNa)}).catch(function(Mc){Object.getType(Mc)===makerstorage.StorageServiceError?(Kb.push(Object.assign(new of.a,{name:"Error",string:Mc.message})),Kb.push(Object.assign(new of.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Mc.errorCode.toString(),Mc.status.toString())})),
17===Mc.errorCode&&la.cache.ABd(td.a.N6b(la.$))):(Kb.push(Object.assign(new of.a,{name:"Error",string:Mc.toString()})),Kb.push(Object.assign(new of.a,{name:"ErrorCode",string:"exception"})));wa.a(ni.a.Gzb,!1,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);la.z5=!0;la.wC(td.a.tNa)})}else nc=I?I.ErrorCode:"need_token",I=I?I.ErrorMessage:"No Access Token",Kb.push(Object.assign(new of.a,{name:"ServiceChecked",bool:!1})),Kb.push(Object.assign(new of.a,{name:"Error",string:I})),Kb.push(Object.assign(new of.a,
{name:"ErrorCode",string:nc})),wa.a(ni.a.Gzb,!1,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb),this.z5=!0,this.wC(td.a.tNa)};Fc.prototype.Bad=function(I,la){var Va=this;if(td.a.xp)this.Ne.Bad(I,la,this.uX);else{var Kb=Gh.a.Qa.Gb,nc=0,Mc=0;this.As=nc===I.count;var Yc=[];Yc.push(Object.assign(new of.a,{name:"ScriptIds",int64:I.count}));if(I.count)if(la&&la.IsSuccess){Tc(this.$,la.Token);var Ed={};la=Ol(I);for(var re=la.next();!re.done;Ed={Qcb:Ed.Qcb},re=la.next())re=re.value,Ed.Qcb=qj.a.create().toString(),
makerstorage.getSharedScript(re.value,Ed.Qcb).then(function(pf){return function(Ze){var cg=[];cg.push(Object.assign(new of.a,{name:"BodySize",int64:Ze.body.length}));cg.push(Object.assign(new of.a,{name:"CorrelationId",string:pf.Qcb}));wa.a(ni.a.shc,!0,Ph.getElapsedMilliseconds(Kb,Gh.a.Qa.Gb),cg);nc++;Ze=new Qd(Ze);Ze.ME=I.oa(Ze.id);Va.hg.Lp(Ze);Va.As=nc===I.count;Va.Cxa=!0;Va.SS(Kb,Mc,Yc)}}(Ed)).catch(function(pf){return function(Ze){var cg=[];Object.getType(Ze)===makerstorage.StorageServiceError?
(Yc.push(Object.assign(new of.a,{name:"Error",string:Ze.message})),Yc.push(Object.assign(new of.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Ze.errorCode.toString(),Ze.status.toString())}))):(cg.push(Object.assign(new of.a,{name:"Error",string:Ze.toString()})),cg.push(Object.assign(new of.a,{name:"ErrorCode",string:"exception"})));cg.push(Object.assign(new of.a,{name:"CorrelationId",string:pf.Qcb}));wa.a(ni.a.shc,!1,Ph.getElapsedMilliseconds(Kb,Gh.a.Qa.Gb),cg);nc++;Mc++;Va.As=nc===
I.count;Va.SS(Kb,Mc,Yc)}}(Ed))}else Ed=la?la.ErrorCode:"need_token",la=la?la.ErrorMessage:"No Access Token",Yc.push(Object.assign(new of.a,{name:"Error",string:la})),Yc.push(Object.assign(new of.a,{name:"ErrorCode",string:Ed})),this.As=!0,this.SS(Kb,Mc,Yc);else this.As=this.Cxa=!0,this.SS(Kb,Mc,Yc)}};Fc.prototype.SS=function(I,la,Va){this.As&&(Va.push(Object.assign(new of.a,{name:"ScriptCount",int64:this.hg.length})),Va.push(Object.assign(new of.a,{name:"ScriptErrorCount",int64:la})),wa.a(ni.a.fjf,
!la,Ph.getElapsedMilliseconds(I,Gh.a.Qa.Gb),Va),this.hg.sort(),this.wC(td.a.cLb))};Fc.prototype.Yvd=function(I){var la=new xk.a;if(I=Fc.Wra.parseFromString(I,"text/xml").querySelector('[id="script-ids-node-id"]')){I=I.getElementsByTagName("scriptId");for(var Va={},Kb=0;Kb<I.length;Va={PLb:Va.PLb,MLb:Va.MLb,HLb:Va.HLb},Kb++)Va.PLb=I[Kb].getAttribute("id"),th.a.ma(Va.PLb)||(Va.MLb=void 0,Va.HLb=void 0,function(nc){return function(){var Mc=we.UUe(nc.PLb);nc.MLb=Mc.CMd;nc.HLb=Mc.ME;return Mc}}(Va)().returnValue&&
la.ia(Va.MLb,Va.HLb))}return la};Fc.prototype.C8b=function(I){if(td.a.MU||td.a.xp)return this.uX.C8b(I);switch(I){case "1":case "2":case "3":return this.pA.jJ(parseInt(I)-1);default:return this.vm.py(I)||this.hg.py(I)||this.Ds.py(I)}};Fc.prototype.ktb=function(I){if(this.vm.Lp(I)){this.vm.sort();var la=""}else{la="";var Va=I.mga();this.hg.Tca(Va);this.hg.sort();this.vm.Tca(I);this.vm.sort()}return{returnValue:!0,message:la}};Fc.prototype.itb=function(I){this.hg.Oga(I.id);return this.vm.Oga(I.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};Fc.prototype.htb=function(I){var la=I.mga();la.ME=null;this.vm.Lp(la)&&this.vm.sort();return this.hg.Lp(I)?(this.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};Fc.prototype.jtb=function(I){return this.hg.Oga(I.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};
Fc.prototype.wC=function(I){if(td.a.MU||td.a.xp)this.uX.wC(I);else{this.mDb();this.$.zf();var la=[];la.push(Object.assign(new of.a,{name:"Operation",string:I}));la.push(Object.assign(new of.a,{name:"HasReadCachedScripts",bool:this.v3}));la.push(Object.assign(new of.a,{name:"ReadScriptsDone",bool:this.U1a}));la.push(Object.assign(new of.a,{name:"ReadSamplesScriptsDone",bool:this.wba}));la.push(Object.assign(new of.a,{name:"SamplesScriptCount",int64:this.Ds.length}));la.push(Object.assign(new of.a,
{name:"ReadPublishedScriptsDone",bool:this.z5}));la.push(Object.assign(new of.a,{name:"PublishedScriptCount",int64:this.vm.length}));la.push(Object.assign(new of.a,{name:"ReadWorkbookScriptsDone",bool:this.As}));la.push(Object.assign(new of.a,{name:"WorkbookScriptCount",int64:this.hg.length}));wa.a(ni.a.hsd,!0,0,la)}};Fc.prototype.mDb=function(){this.pA=new We([],function(){});for(var I=this.hg?this.hg.length:0,la=this.vm?this.vm.length:0,Va=this.Ds?this.Ds.length:0,Kb=0,nc=0;nc<td.a.Hxd;nc++)if(nc<
I)this.pA.Lp(this.hg.jJ(nc));else if(nc-I+Kb<la){var Mc=this.vm.jJ(nc-I+Kb);this.hg.py(Mc.id)?(Kb++,nc--):this.pA.Lp(Mc)}else nc-I-la+Kb<Va&&this.pA.Lp(this.Ds.jJ(nc-I+Kb-la))};Fc.prototype.CTc=function(I,la){if(td.a.xp)this.Ne.CTc(I,la);else if(this.cache.Yf()){var Va={};Va.TimeStamp=Gh.a.Qa.Gb;Va.IsEnabled=la;this.cache.Eqc(I,Gi.a.Hc(Va))}};Fc.prototype.l8c=function(I){if(td.a.xp)return this.Ne.l8c(I);var la=!1,Va=!1,Kb=null;this.cache.Yf()&&(I=yh.b(this.cache.P0a(I)))&&(Va=I.IsEnabled,Kb=new Date(I.TimeStamp),
la=!0);return new Ub(Va,la,Kb)};Fc.prototype.c$b=function(I){this.businessBarManager.bKa(I)&&this.businessBarManager.removeEntry(I)};Fc.prototype.uHb=function(I){this.businessBarManager.eg(I,null)};Fc.prototype.fDd=function(I){ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(I?(Bj.PageLoadTrackingInfo.instance.ala(oj.a.GV,["automateTab"]),Bj.PageLoadTrackingInfo.instance.XZ(oj.a.GV,["automateTab"]),Bj.PageLoadTrackingInfo.instance.wV(oj.a.GV,["automateTab"])):Bj.PageLoadTrackingInfo.instance.n9a(oj.a.GV,
["automateTab"]))};Ll.Object.defineProperties(Fc.prototype,{vm:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?this.Ne.vm:this.u7d}},hg:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?this.Ne.hg:this.T5d}},Ds:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?this.Ne.Ds:this.V8d}},Bk:{configurable:!0,enumerable:!0,get:function(){return this.Ne.Bk}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.iKc}},wba:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?
this.Ne.wba:this.M7d},set:function(I){td.a.xp?this.Ne.wba=I:this.M7d=I}},As:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?this.Ne.As:this.O7d},set:function(I){td.a.xp?this.Ne.As=I:this.O7d=I}},vba:{configurable:!0,enumerable:!0,get:function(){return this.Ne.vba}},XIa:{configurable:!0,enumerable:!0,get:function(){return this.Ne.XIa}},U1a:{configurable:!0,enumerable:!0,get:function(){return(td.a.MU?this.vba:this.z5)&&this.As&&this.wba}},S1a:{configurable:!0,enumerable:!0,get:function(){return(td.a.MU?
this.XIa:this.v3)||this.U1a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.beg}},eaa:{configurable:!0,enumerable:!0,get:function(){var I=!!this.gv.cx&&this.gv.cx.isSuccess&&this.gv.cx.value,la=!!this.xz&&!this.xz.isSuccess,Va=!!this.xz&&this.gv.cx.isSuccess&&this.xz.value;return this.w9e&&I&&(Va||la&&!Li.a.jva(11))}},u8a:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?this.Ne.u8a:this.K7d},set:function(I){td.a.xp?this.Ne.u8a=I:this.K7d=I}},Cxa:{configurable:!0,enumerable:!0,
get:function(){return td.a.xp?this.Ne.Cxa:this.N7d},set:function(I){td.a.xp?this.Ne.Cxa=I:this.N7d=I}},v3:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?this.Ne.v3:this.F_d},set:function(I){td.a.xp?this.Ne.v3=I:this.F_d=I}},z5:{configurable:!0,enumerable:!0,get:function(){return td.a.xp?this.Ne.z5:this.L7d},set:function(I){td.a.xp?this.Ne.z5=I:this.L7d=I}},w9e:{configurable:!0,enumerable:!0,get:function(){var I="TestHost"===this.$.ya.DocumentHostInfo.HostTier,la=$f.AFrameworkApplication.ha.Ta("UserPrincipalName");
la=!$f.AFrameworkApplication.ha.sa("IsAnonymousUser")&&!th.a.ma(la)&&!th.a.contains(la,"ext#",!1)&&!th.a.contains(la,"guest#",!1);return!Li.a.Uua&&(I||this.tqa.Nke&&la)}}});Fc.Wra=new DOMParser;Object(Md.a)(Fc,"AutomateCommandManager",null,[15]);var Cj=b(1325),yk=b(1272),Ri=b(232);ac.key="InsertAgaveClientSideParametersKey";Object(Md.a)(ac,"InsertAgaveClientSideParameters",null,[]);var Zi=b(58),ck=b(102),Hi=b(20);bd.prototype.ltb=function(I){if(ag.EwaSettings.getBooleanFeatureGate(td.a.pwa,!1)&&I.eaa){var la=
[];la.push(Object.assign(new of.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.e4a}));la.push(Object.assign(new of.a,{name:"actionName",string:I.actionName}));la.push(Object.assign(new of.a,{name:td.a.jga,string:I.Wqe.toString()}));this.e4a?this.$Lf(I):this.HNh(I);wa.a(ni.a.rni,void 0,void 0,la)}};bd.prototype.nbj=function(){this.QRf()?this.pxf():Hi.g(this.$).Ca.Yee(Object(qf.a)(this,this.h6a,"onAllFloatingObjectsRendered"))};bd.prototype.h6a=function(){this.QRf()?(this.pxf(),Hi.g(this.$).Ca.XBd(Object(qf.a)(this,
this.h6a,"onAllFloatingObjectsRendered"))):this.e4a&&Hi.g(this.$).Ca.XBd(Object(qf.a)(this,this.h6a,"onAllFloatingObjectsRendered"))};bd.prototype.QRf=function(){if(this.e4a||mc(this.$))return!1;var I=ck.a(this.$);return Hi.g(this.$).Ca.WVb&&I.d_h()};bd.prototype.pxf=function(){var I=this;this.gv.cx?this.gv.cx.value&&this.tqa.Z7b():this.gv.Wpe().then(function(la){la&&I.tqa.Z7b()});wa.a(ni.a.nni)};bd.prototype.rqi=function(I,la){Object.getType(la)===String&&la.toString().endsWith(td.a.yIa(this.$))&&
(this.e4a=!1)};bd.prototype.H4i=function(){var I=Ci.a.create().toString(),la={};od(this.$,la);var Va={};Va[td.a.hWf]=this.tqa.getAuthContext();var Kb={};Kb[td.a.vLe]=Gi.a.Hc(la);Kb[td.a.B2e]=Gi.a.Hc(Va);Kb[td.a.U4g]=Gi.a.Hc(this.$.ya.DocumentHostInfo);Kb[td.a.lmj]=id(this.$);Kb[td.a.$Xf]=Gi.a.Hc(td.a.Qq);Kb[td.a.Dle]=this.$.cjf?"true":"false";Kb[td.a.FZe]=Qe(this.$);Kb[td.a.eZf]=Bd(this.$);Kb[td.a.jga]=I;la=[];la.push(Object.assign(new of.a,{name:td.a.jga,string:I}));wa.a(ni.a.pni,void 0,void 0,la);
this.mMf(td.a.hVh,Kb)};bd.prototype.HNh=function(I){var la=this;mc(this.$)&&Tc(this.$,"localstorage");wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.Va(this.$.ea,374,375,1,"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveCommandManager"),function(Va){la.mbi(Va.result).continueWith(function(){la.G4i(I)});la.e4a=!0},this.$.la,3)};bd.prototype.mbi=function(I){var la={};ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(la.SolutionId=td.a.assetId,la.Version=
td.a.DFb,la.StoreType=OSF.StoreType.Sdx,la.StoreId=OSF.StoreType.Sdx,la.AssetId=td.a.assetId,la.AssetStoreId=OSF.StoreType.Sdx,la.TargetType=1,la.SharedRuntimeId=td.a.yIa(this.$),la.SourceLocationOverrideResourceId=td.a.yIa(this.$),la.IsToBePersisted=!1,la.Id=td.a.assetId,la.AppVersion=td.a.DFb,la.CurrentStoreType=OSF.StoreType.Sdx):(la.AppVersion=td.a.DFb,la.AssetId=td.a.assetId,la.AssetStoreId=OSF.StoreType.Sdx,la.CurrentStoreType=OSF.StoreType.Sdx,la.Id=td.a.assetId,la.StoreId=OSF.StoreType.Sdx,
la.TargetType=1,la.SharedRuntimeId=td.a.yIa(this.$),la.SourceLocationOverrideResourceId=td.a.yIa(this.$),la.IsToBePersisted=!1);var Va=new Cj.a;Va.el=Gf.a.instance.da(2053);Va.taskPaneWidth=td.a.Qq;var Kb=new ac;Kb.Cuc=Bd(this.$);Kb.w$=Qe(this.$);return I.yFd(la,Va,void 0,void 0,Kb)};bd.prototype.G4i=function(I){this.H4i();Ri.a(this.$)&&Ri.a(this.$).jfe(Object(qf.a)(this,this.rqi,"onControlDeleted"));this.$Lf(I)};bd.prototype.$Lf=function(I){var la={};la[td.a.R0i]=I.shapeId;la[td.a.Q0i]=I.y2i;la[td.a.jga]=
I.Wqe.toString();this.mMf(I.actionName,la)};bd.prototype.mMf=function(I,la){var Va=new ah.a(td.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,td.a.DFb),Kb=new rj.a(td.a.G_e,td.a.hMe,this.$.ya.UICultureTag),nc=new Qi.a;nc.Ri[Nb.el]=Gf.a.instance.da(2053);nc.Ri[Nb.sourceLocationOverrideResourceId]=td.a.yIa(this.$);nc.Ri[Nb.KNc]=la;nc.Ri[Nb.taskPaneWidth]=td.a.Qq;Yg.a.instance.iLa(Va,yk.a.action,I,Kb,nc)};Object(Md.a)(bd,"AutomateCommandRunFromButton",null,[436]);Em(Oe,we);Oe.prototype.CTc=function(I,
la){if(this.cache.Yf()){var Va={};Va.TimeStamp=Gh.a.Qa.Gb;Va.IsEnabled=la;this.cache.Eqc(I,Gi.a.Hc(Va))}};Oe.prototype.l8c=function(I){var la=!1,Va=!1,Kb=null;this.cache.Yf()&&(I=yh.b(this.cache.P0a(I)))&&(Va=I.IsEnabled,Kb=new Date(I.TimeStamp),la=!0);return new Ub(Va,la,Kb)};Oe.prototype.CBf=function(I){var la=this,Va=Gh.a.Qa.Gb,Kb=[];return wh.TaskExtensions.vFa(this.indexedDB.iIa(td.a.INa),function(nc){var Mc=!la.vba||!la.Bk.length;nc=nc.result;Kb.push(Object.assign(new of.a,{name:"ExistingScriptCount",
int64:la.Bk.length}));if(""!==nc&&(nc=yh.b(nc),Kb.push(Object.assign(new of.a,{name:"CachedScriptCount",int64:nc.length})),Mc)){for(var Yc=Ol(nc),Ed=Yc.next();!Ed.done;Ed=Yc.next())la.Bk.Lp(new Qd(Ed.value));la.XIa=!0;la.Lzd=0<nc.length;wa.a(ni.a.ejf,Mc,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);la.tAd(I);return!0}wa.a(ni.a.ejf,Mc,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);return!1},this.$.la,3)};Oe.prototype.XNi=function(I){this.$Ni(I);td.a.MU?this.CBf(I):this.WNi(I)};Oe.prototype.qGh=function(I,
la,Va){var Kb=this,nc=Gh.a.Qa.Gb,Mc=[];if(I&&I.IsSuccess){Tc(this.$,I.Token);var Yc=qj.a.create().toString();Mc.push(Object.assign(new of.a,{name:"CorrelationId",string:Yc}));makerstorage.getRecentScripts(Yc).then(function(Ed){Mc.push(Object.assign(new of.a,{name:"HasReadCachedScripts",bool:Kb.XIa}));Kb.Bk.clear();Ed=Ol(Ed);for(var re=Ed.next();!re.done;re=Ed.next())Kb.Bk.Lp(new Qd(re.value));Kb.Lzd=!0;Kb.vba=!0;Kb.indexedDB.Yf()&&(Ed=Gi.a.Hc(Kb.Bk.jbb()),Kb.indexedDB.U9a(new wk.a(td.a.INa,Ed)));
Mc.push(Object.assign(new of.a,{name:"ScriptCount",int64:Kb.Bk.length}));wa.a(ni.a.Gzb,!0,Ph.getElapsedMilliseconds(nc,Gh.a.Qa.Gb),Mc);la.wC(td.a.INa)}).catch(function(Ed){Object.getType(Ed)===makerstorage.StorageServiceError?(Mc.push(Object.assign(new of.a,{name:"Error",string:Ed.message})),Mc.push(Object.assign(new of.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Ed.errorCode.toString(),Ed.status.toString())})),17===Ed.errorCode&&Va.ABd(td.a.N6b(Kb.$))):(Mc.push(Object.assign(new of.a,
{name:"Error",string:Ed.toString()})),Mc.push(Object.assign(new of.a,{name:"ErrorCode",string:"exception"})));wa.a(ni.a.oni,!1,Ph.getElapsedMilliseconds(nc,Gh.a.Qa.Gb),Mc);Kb.vba=!0;la.wC(td.a.INa)})}else Yc=I?I.ErrorCode:"need_token",I=I?I.ErrorMessage:"No Access Token",Mc.push(Object.assign(new of.a,{name:"ServiceChecked",bool:!1})),Mc.push(Object.assign(new of.a,{name:"Error",string:I})),Mc.push(Object.assign(new of.a,{name:"ErrorCode",string:Yc})),wa.a(ni.a.Gzb,!1,Ph.getElapsedMilliseconds(nc,
Gh.a.Qa.Gb),Mc),this.vba=!0,la.wC(td.a.INa)};Oe.prototype.Mzd=function(I,la){var Va=this,Kb=new sj.a,nc=Ob(this.$);return yc(this.$,function(Mc){if((Mc=Mc.Result)&&200===Mc.ResponseStatusCode)Mc=JSON.parse(Mc.ResponseBody.join("")),I(Va.Yvd(Mc.value)),Kb.setResult(!0);else{Mc=Mc?"RichApi_"+Mc.ResponseStatusCode:"RichApiError";var Yc=[];Yc.push(Object.assign(new of.a,{name:"Error",string:"Failed to read shared script ids from document"}));Yc.push(Object.assign(new of.a,{name:"ErrorCode",string:Mc}));
Va.As=!0;Va.SS(la,Gh.a.Qa.Gb,0,Yc);Kb.setResult(!1)}},function(Mc){Mc=bk.a.xg(Mc.data);Je.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var Yc=[];Yc.push(Object.assign(new of.a,{name:"Error",string:"Failure using rich api: "+Mc}));Yc.push(Object.assign(new of.a,{name:"ErrorCode",string:"RichApiFailure"}));Va.As=!0;Va.SS(la,Gh.a.Qa.Gb,0,Yc);Kb.setResult(!1)},nc,Kb)};Oe.prototype.Bad=function(I,la,Va){var Kb=this,nc=Gh.a.Qa.Gb,Mc=0,Yc=0;this.As=
Mc===I.count;var Ed=[];Ed.push(Object.assign(new of.a,{name:"ScriptIds",int64:I.count}));if(I.count)if(la&&la.IsSuccess){Tc(this.$,la.Token);var re={};la=Ol(I);for(var pf=la.next();!pf.done;re={Rcb:re.Rcb},pf=la.next())pf=pf.value,re.Rcb=qj.a.create().toString(),makerstorage.getSharedScript(pf.value,re.Rcb).then(function(Ze){return function(cg){var Ug=[];Ug.push(Object.assign(new of.a,{name:"BodySize",int64:cg.body.length}));Ug.push(Object.assign(new of.a,{name:"CorrelationId",string:Ze.Rcb}));wa.a(ni.a.shc,
!0,Ph.getElapsedMilliseconds(nc,Gh.a.Qa.Gb),Ug);Mc++;cg=new Qd(cg);cg.ME=I.oa(cg.id);Kb.hg.Lp(cg);Kb.As=Mc===I.count;Kb.Cxa=!0;Kb.SS(Va,nc,Yc,Ed)}}(re)).catch(function(Ze){return function(cg){var Ug=[];Object.getType(cg)===makerstorage.StorageServiceError?(Ed.push(Object.assign(new of.a,{name:"Error",string:cg.message})),Ed.push(Object.assign(new of.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",cg.errorCode.toString(),cg.status.toString())}))):(Ug.push(Object.assign(new of.a,{name:"Error",
string:cg.toString()})),Ug.push(Object.assign(new of.a,{name:"ErrorCode",string:"exception"})));Ug.push(Object.assign(new of.a,{name:"CorrelationId",string:Ze.Rcb}));wa.a(ni.a.shc,!1,Ph.getElapsedMilliseconds(nc,Gh.a.Qa.Gb),Ug);Mc++;Yc++;Kb.As=Mc===I.count;Kb.SS(Va,nc,Yc,Ed)}}(re)).finally(function(){if(Kb.indexedDB.Yf()&&Kb.As){var Ze=we.MHh(Kb.$,Kb.hg);Kb.indexedDB.U9a(new wk.a(td.a.cLb,Ze))}})}else re=la?la.ErrorCode:"need_token",la=la?la.ErrorMessage:"No Access Token",Ed.push(Object.assign(new of.a,
{name:"Error",string:la})),Ed.push(Object.assign(new of.a,{name:"ErrorCode",string:re})),this.As=!0,this.SS(Va,nc,Yc,Ed);else this.As=this.Cxa=!0,this.SS(Va,nc,Yc,Ed)};Oe.prototype.oad=function(I){var la={id:"samples-2"};la.name=Gf.a.instance.da(2049);this.Ds.Lp(new Qd(la));la.id="samples-4";la.name=Gf.a.instance.da(2050);this.Ds.Lp(new Qd(la));la.id="samples-5";la.name=Gf.a.instance.da(2051);this.Ds.Lp(new Qd(la));this.wba=!0;I.wC("SampleScripts")};Oe.prototype.Yvd=function(I){var la=new xk.a;if(I=
this.Wra.parseFromString(I,"text/xml").querySelector('[id="script-ids-node-id"]')){I=I.getElementsByTagName("scriptId");for(var Va={},Kb=0;Kb<I.length;Va={QLb:Va.QLb,NLb:Va.NLb,ILb:Va.ILb},Kb++)Va.QLb=I[Kb].getAttribute("id"),th.a.ma(Va.QLb)||(Va.NLb=void 0,Va.ILb=void 0,function(nc){return function(){var Mc=we.UUe(nc.QLb);nc.NLb=Mc.CMd;nc.ILb=Mc.ME;return Mc}}(Va)().returnValue&&la.ia(Va.NLb,Va.ILb))}return la};Oe.prototype.$Ni=function(I){var la=this,Va=Gh.a.Qa.Gb,Kb=[];wh.TaskExtensions.vFa(this.indexedDB.iIa(td.a.cLb),
function(nc){nc=nc.result;Kb.push(Object.assign(new of.a,{name:"ExistingScriptCount",int64:la.hg.length}));if(""!==nc){var Mc=yh.b(nc);nc=Mc[td.a.f6f];Mc=Mc[td.a.jLf];Kb.push(Object.assign(new of.a,{name:"CachedScriptCount",int64:Mc.length}));if(nc=nc===encodeURIComponent(la.$.workbookContext.WorkbookFileName)&&(!la.As||!la.hg.length)){Mc=Ol(Mc);for(var Yc=Mc.next();!Yc.done;Yc=Mc.next())la.hg.Lp(new Qd(Yc.value));la.hg.sort();wa.a(ni.a.gsd,nc,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);la.tAd(I);
return!0}wa.a(ni.a.gsd,nc,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb)}else wa.a(ni.a.gsd,!1,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);return!1},this.$.la,3)};Oe.prototype.WNi=function(I){var la=this,Va=Gh.a.Qa.Gb,Kb=[];wh.TaskExtensions.vFa(this.indexedDB.iIa(td.a.tNa),function(nc){var Mc=!la.z5||!la.vm.length;nc=nc.result;Kb.push(Object.assign(new of.a,{name:"ExistingScriptCount",int64:la.vm.length}));if(""!==nc&&(nc=yh.b(nc),Kb.push(Object.assign(new of.a,{name:"CachedScriptCount",int64:nc.length})),
Mc)){nc=Ol(nc);for(var Yc=nc.next();!Yc.done;Yc=nc.next())la.vm.Lp(new Qd(Yc.value));la.vm.sort();wa.a(ni.a.Fzb,Mc,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);la.tAd(I);return!0}wa.a(ni.a.Fzb,Mc,Ph.getElapsedMilliseconds(Va,Gh.a.Qa.Gb),Kb);return!1},this.$.la,3)};Oe.prototype.SS=function(I,la,Va,Kb){this.As&&(Kb.push(Object.assign(new of.a,{name:"ScriptCount",int64:this.hg.length})),Kb.push(Object.assign(new of.a,{name:"ScriptErrorCount",int64:Va})),wa.a(ni.a.fjf,!Va,Ph.getElapsedMilliseconds(la,
Gh.a.Qa.Gb),Kb),this.hg.sort(),I.wC(td.a.cLb))};Oe.prototype.tAd=function(I){this.v3=!0;I.wC("CachedScripts")};Object(Md.a)(Oe,"AutomateCommandStorage",we,[]);var pk=Ji.a;Em(ng,pk);ng.prototype.create=function(){var I=this,la=Zi.GetServiceTaskFactory.Va(this.$.ea,349,350,this.rb,"Microsoft.Office.Excel.WebUI.Client.OAuth.IOAuthManagerWrapper"),Va=Jf.a.loadScript(110,4,this.rb,void 0,void 0,351),Kb=Zi.GetServiceTaskFactory.create(this.$.ea,102,this.$.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),
nc=Zi.GetServiceTaskFactory.create(this.$.ea,396,this.$.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IndexedDB.IIndexedDB"),Mc=Zi.GetServiceTaskFactory.Va(this.$.ea,5,4,this.rb,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");wh.TaskExtensions.Aa(wh.TaskExtensions.xe([la,Va,Kb,nc,Mc],this.la,3),function(){var Yc=la.result,Ed=nc.result,re=Mc.result,pf=new bb,Ze=new Pe(I.$,Yc,pf),cg=new Oe(I.$,Ed),Ug=new ad(I.$,cg),rh=new bd(I.$,Ze,pf);I.Eb(I.$.ea.Ba(352)||new Fc(I.$,Yc,Kb.result,
Ed,rh,pf,Ze,cg,Ug,re))},this.la,3)};ng.ja=function(I){I&&I.ea.Ia(351,new ng(I))};Object(Md.a)(ng,"AutomateCommandManagerFactory",Ji.a,[]);var lk=b(831),Sj=b(804),Ik=lk.a;Em(me,Ik);me.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};me.ke=function(){return["AugLoop_Core_Annotation"]};Object(Md.a)(me,"DetectedHtmlTableAnnotation",lk.a,[]);var jj=b(36),ri=b(46),Tj=b(364),Fj=b(92),qk=jj.a;Em(Fe,qk);Fe.prototype.dispose=function(){window.removeEventListener("message",Object(qf.a)(this,
this.Dxe,"dataFromPictureMessageReceivedEventHandler"),!1);qk.prototype.dispose.call(this)};Fe.prototype.JJf=function(I,la){this.oub=Ci.a.create().toString();this.lub="";this.imageHeight=this.imageWidth=0;this.errorMessage=this.tableData="";this.JNc=!1;this.DCi(I,la);this.Pzj()};Fe.prototype.Dxe=function(I){if(I){var la={};if(function(){var Ed=yh.d(I.data);la=Ed.eu;return Ed}().returnValue){var Va=Object(qi.a)(Object,la);if("."===Va.DataFromPictureWildcard)if(Va.SessionId!==this.oub)Je.ULS.sendTraceTag(537163345,
0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(Va.CmdType){case "ACK":this.JNc=!0;this.F4i();0<this.errorMessage.length?this.eMf():0<this.tableData.length&&this.wMf();break;case "insert_html":Je.ULS.sendTraceTag(537163344,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane");var Kb=this.$.ra.ua,nc={},Mc=Hi.g(this.$).ga.wa.Nd.clone();
nc.PasteId=Ci.a.create().toString();nc.DestinationRanges=ri.s(ri.v(Mc,this.$));nc.SourceHtml=Va.Parameters;nc.CopyOperationId=null;var Yc=Kb.Na(1,Kb.Wb());Yc.pasteHtmlParameters=nc;Tj.a(this.$.userOperationManager,function(Ed,re,pf){return Yi.i(Kb,"pasteHtmlContent",Yc,Ed,re,pf,null,64)},function(Ed){return new Kj.a(204,0,Ed,1)},null)}}}};Fe.prototype.Pzj=function(){if(this.lub.length){var I=window.self.atob(this.lub);for(var la=Array(I.length),Va=0;Va<I.length;Va++)la[Va]=I.charCodeAt(Va);this.augmentationLoopManager.Ozj(la,
this.oub,this.imageWidth,this.imageHeight)}else Je.ULS.sendTraceTag(537163343,0,50,"DataFromPicturePaneCommandManager:UploadImageToAugmentationLoop - imageDataBase64 is empty")};Fe.prototype.DCi=function(I,la){la.SessionID=this.oub;la.DataFromPictureURL="ImageToDoc.Dogfood.Url";la.DataFromPictureAssetId="FA000000050";la.LoadDataFromPictureTaskpane=!0;I=new Fj.a(-859308420,I.method,I.mode,I.Ze,I.tabName);this.$.Ka.Ub(I,la)};Fe.prototype.F4i=function(){if(this.lub.length){var I=Ri.a(this.$).W2("FA000000050.ImageToDoc.Dogfood.Url"),
la={};la=(la.DataFromPictureWildcard=".",la);la.imageData=this.lub;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",la,function(Va){Va&&Je.ULS.sendTraceTag(537163341,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else Je.ULS.sendTraceTag(537163342,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};Fe.prototype.wMf=function(){if(this.tableData.length){var I=
Ri.a(this.$).W2("FA000000050.ImageToDoc.Dogfood.Url"),la={};la=(la.DataFromPictureWildcard=".",la);la.tableHtml=this.tableData;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",la,function(Va){Va&&Je.ULS.sendTraceTag(537163339,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else Je.ULS.sendTraceTag(537163340,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};
Fe.prototype.eMf=function(){if(this.errorMessage.length){var I=Ri.a(this.$).W2("FA000000050.ImageToDoc.Dogfood.Url"),la={};la=(la.DataFromPictureWildcard=".",la);la.errorMessage=this.errorMessage;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",la,function(Va){Va&&Je.ULS.sendTraceTag(537163337,0,50,"DataFromPicturePaneCommandManager:sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else Je.ULS.sendTraceTag(537163338,0,50,"DataFromPicturePaneCommandManager:sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
Fe.prototype.initialize=function(){window.addEventListener("message",Object(qf.a)(this,this.Dxe,"dataFromPictureMessageReceivedEventHandler"),!1);this.augmentationLoopManager.activateAnnotation(this.A0e);this.augmentationLoopManager.h8(this.A0e,Object(qf.a)(this,this.mTh,"imageToTableAnnotationHandler"))};Fe.prototype.mTh=function(I,la){if(I=la.qX)if(!la.parentPath||1>=la.parentPath.length||la.parentPath[1]!==this.oub)Je.ULS.sendTraceTag(537163335,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");
else{la=I.errorCode;switch(la){case null:case -1:this.errorMessage=Gf.a.instance.da(2165);break;case 1:this.errorMessage=Gf.a.instance.da(2166);break;case 2:this.errorMessage=Gf.a.instance.da(2167)}0<this.errorMessage.length&&Je.ULS.sendTraceTag(537163334,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - ErrorCode:{0}.",la?la.toString():"null");this.tableData=I.html;this.JNc&&(0<this.errorMessage.length?this.eMf():0<this.tableData.length&&this.wMf())}else Je.ULS.sendTraceTag(537163336,
0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - Received annotation is null.")};Object(Md.a)(Fe,"DataFromPicturePaneCommandManager",jj.a,[]);var dk=b(173),Gj=b(51);Pf.prototype.Wc=function(){return!1};Pf.prototype.executeCommand=function(I,la,Va){I=!1;switch(la.command){case 73979048:this.Iob?this.Iob.JJf(la,Va):(this.Zd=la,this.XS=Va,this.M_c=!0),I=!0}return I?Gj.Task.Ra(!0):dk.a(la.command)};Pf.prototype.Ec=function(I,la){return 73979048===la.command&&ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)};Pf.prototype.Yc=function(){return!1};Pf.prototype.dispose=function(){this.Iob.dispose()};Object(Md.a)(Pf,"DataFromPictureCommandHandler",null,[160,6]);var zk=cj.a;Em(Zf,zk);Zf.prototype.Gd=function(){this.Ad([new Pf(this.$)])};Zf.ja=function(I){cj.a.Yd(452,new Zf(I))};Object(Md.a)(Zf,"DataFromPictureCommandHandlerFactory",cj.a,[]);var Mg=b(829),ek=b(802);Ve.prototype.iEh=function(I){Je.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",I);for(var la=new lh.a,Va=Ol(this.bYb),Kb=Va.next();!Kb.done;Kb=
Va.next()){Kb=Ol(Kb.value.Czb);for(var nc=Kb.next();!nc.done;nc=Kb.next())nc=nc.value,nc.id===I&&la.add(nc)}return la};Ve.prototype.Bde=function(I){this.bYb.add(I)};Ve.prototype.cSi=function(I){for(var la=Ol(this.bYb),Va=la.next();!Va.done;Va=la.next())if(Va=Va.value,Va.ihe===I.ihe){this.bYb.remove(Va);break}};Ve.Y2g=function(I,la,Va){Va=void 0===Va?null:Va;I=Ve.Rwh(I);0<I.length&&(Ve.rqc(I,!1),Va&&Va(la,I))};Ve.Rwh=function(I){var la=[];if(I&&I.Czb&&0<I.Czb.count){I=Ol(I.Czb);for(var Va=I.next();!Va.done;Va=
I.next())if(Va=Va.value,Va.controls&&0<Va.controls.count){Va=Ol(Va.controls);for(var Kb=Va.next();!Kb.done;Kb=Va.next())if(Kb=Kb.value,Kb.menuItems&&0<Kb.menuItems.count){Kb=Ol(Kb.menuItems);for(var nc=Kb.next();!nc.done;nc=Kb.next())Array.add(la,nc.value.id)}}}return la};Ve.rqc=function(I,la){if(I.length){I=Ol(I);for(var Va=I.next();!Va.done;Va=I.next())Va=document.querySelector('[id^="'+Va.value+'"]'),ek.a.hca(Va,la)}};Ll.Object.defineProperties(Ve.prototype,{bYb:{configurable:!0,enumerable:!0,
get:function(){return this.K$f}}});Object(Md.a)(Ve,"ContextMenuExtensibilityCache",null,[808,809]);var Rj=b(1399),Fk=b(998),fk=b(868),Ng=b(811),rk=b(876),Ak=rk.a;Em(se,Ak);se.prototype.clone=function(){var I=new se;I.xfd=this.xfd;I.ffd=this.ffd;I.ribbon=this.ribbon;return I};Object(Md.a)(se,"RibbonBuildContext",rk.a,[]);var Ii=b(801);Ad.prototype.kfa=function(I,la,Va){la=void 0===la?null:la;Va=void 0===Va?null:Va;var Kb=fk.Builder.O_b(I);if(Ii.c(Kb))Va&&Va(!1);else if(I=new se,I.ffd=this.U7.homeTab.id,
I.xfd=this.U7.homeTab,I.ribbon=this.U7,Kb=new Ng.a(Kb),Kb=Ng.a.VT(Kb.node,Ng.a.fUd),Ii.c(Kb))Va&&Va(!1);else{Kb=Ng.a.qm(Kb);for(var nc=0;nc<Kb.length;nc++){var Mc=Kb[nc],Yc=(new Ng.a(Mc)).attributes[Ng.a.id];if(this.U7.e$(Yc))this.RRb.PEj(Yc,Mc,I);else{var Ed=-1;la&&(Ed=this.Emh(Yc,la));-1!==Ed?this.RRb.yqg(Mc,I,Ed):this.RRb.yqg(Mc,I)}}Va&&Va(!0)}};Ad.prototype.Emh=function(I,la){I=Array.indexOf(la,I);if(-1===I)return-1;--I;for(var Va=-1;0<=I;){Va=this.zBh(la[I]);if(-1!==Va)break;I--}return Va+1};
Ad.prototype.zBh=function(I){for(var la=0,Va=!1,Kb=Ol(this.U7.children),nc=Kb.next();!nc.done;nc=Kb.next()){nc=nc.value;if(nc.id===I){Va=!0;break}nc.visible&&la++}return Va?la:-1};Ad.prototype.Q8a=function(I){I=fk.Builder.O_b(I);if(!Ii.c(I)&&(I=new Ng.a(I),I=Ng.a.VT(I.node,Ng.a.fUd),!Ii.c(I))){I=Ng.a.qm(I);for(var la=0;la<I.length;la++){var Va=I[la],Kb=(new Ng.a(Va)).attributes[Ng.a.id];Va=Ng.a.VT(Va,Ng.a.TLb);Va=Ng.a.qm(Va);for(var nc=0;nc<Va.length;nc++){var Mc=Ng.a.FSe(Va[nc],Ng.a.id);Ii.c(Mc)||
this.RRb.lGj(Kb,Mc)}}}};Object(Md.a)(Ad,"RibbonExtensibilityBuilder",null,[]);ne.prototype.kfa=function(I,la){la=void 0===la?null:la;var Va=I.CNe();this.u8d.kfa(Va,I.g7a,la)};ne.prototype.Q8a=function(I){I=I.CNe();this.u8d.Q8a(I)};ne.f3g=function(I,la,Va){Va=void 0===Va?null:Va;I=ne.WGh(I);0<I.length&&(ne.rqc(I,!1),Va&&Va(la,I))};ne.WGh=function(I){var la=[];if(I){var Va=I.Zaa;if(!Va){if(I.tabs&&0<I.tabs.count)for(I=Ol(I.tabs),Va=I.next();!Va.done;Va=I.next())if(Va=Va.value,0<Va.kJ.count){var Kb=
Ol(Va.kJ);for(Va=Kb.next();!Va.done;Va=Kb.next())if(Va=Va.value,0<Va.Aga.count){var nc=Ol(Va.Aga);for(Va=nc.next();!Va.done;Va=nc.next())Array.add(la,Va.value.id)}}}else if(Va.sw&&0<Va.sw.count)for(I=Ol(Va.sw),Va=I.next();!Va.done;Va=I.next())if(Va=Va.value,Va.groups&&0<Va.groups.length)for(Kb=Ol(Va.groups),Va=Kb.next();!Va.done;Va=Kb.next())if(Va=Va.value,Va.controls&&0<Va.controls.length)for(nc=Ol(Va.controls),Va=nc.next();!Va.done;Va=nc.next())Array.add(la,Va.value.id)}return la};ne.rqc=function(I,
la){if(I.length){I=Ol(I);for(var Va=I.next();!Va.done;Va=I.next())Va=document.querySelector('[id^="'+Va.value+'"]'),ek.a.hca(Va,la)}};Object(Md.a)(ne,"RibbonExtensibilityManager",null,[832]);var Uj=b(1055);ee.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(I,la){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(I,la)};ee.prototype.Xbd=function(I,la,Va,Kb,nc,Mc,Yc){Mc=void 0===Mc?null:Mc;Yc=void 0===Yc?null:Yc;Je.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",
I);if((I=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?la.sP(nc.ownerAddinInfo.storeType,nc.ownerAddinInfo.solutionId):la.sP(nc.ownerAddinInfo.storeType,nc.ownerAddinInfo.assetId))&&I.Fy&&!I.Fy.getIsUpgrading())if(la=null,0<I.Fy.getNotificationParams().length&&(la=this.zme(I.Fy.getNotificationParams()[0])),2!==I.Fy.getStatus()&&(1!==I.Fy.getStatus()||la&&2147758681===la.errorCode))la&&this.BSf(I,la,Yc);else try{Va.setOwnerAddinEToken(I.Fy.getEToken()),
nc.action(Va,Kb.xka),Mc&&Mc()}catch(Ed){Je.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error message : {0}.",Ed.message)),Uj.a.lKd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};ee.prototype.BSf=function(I,la,Va){var Kb=this;Va=void 0===Va?null:Va;var nc=I.Fy;if(1===nc.getNotificationParams().length||la.r$b){var Mc=la.Wfa,Yc=la.Sga;la.Wfa=function(){nc.removeFirstNotification();if(0<nc.getNotificationParams().length){var Ed=Kb.zme(nc.getNotificationParams()[0]);
Kb.BSf(I,Ed)}2147758681===la.errorCode&&(ne.f3g(I.Kq,nc,Object(qf.a)(Kb,Kb.o1e,"initUpgradeStateDetectTask")),Ve.Y2g(I.Lnb,nc,Object(qf.a)(Kb,Kb.o1e,"initUpgradeStateDetectTask")));Mc&&Mc()};la.Sga=function(){Yc&&Yc();Va&&Va()};Uj.a.nKd(la)}};ee.prototype.o1e=function(I,la){var Va=null;Va=function(){I.getIsUpgrading()?window.setTimeout(Va,1E3):I.getUpgradingFailed()?ne.rqc(la,!0):$f.AFrameworkApplication.xa.updateCommandUI()};window.setTimeout(Va,1E3)};ee.prototype.zme=function(I){var la=new Fk.a;
la.vJa=I.infoType;la.id=I.id;la.title=I.title;la.description=I.description;la.buttonText=I.buttonTxt;la.Wfa=I.buttonCallback;la.r$b=I.highPriority;la.Sga=I.dismissCallback;la.errorCode=I.errorCode;la.p0e=I.iframeNotificationUrl;return la};Ll.Object.defineProperties(ee.prototype,{kce:{configurable:!0,enumerable:!0,get:function(){return this.zyc||(this.zyc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(I){this.zyc=I}},xAg:{configurable:!0,enumerable:!0,get:function(){return this.pVd||
(this.pVd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(Md.a)(ee,"AddinCommandsActionHandler",null,[811]);Wd.prototype.Orh=function(I){if(void 0!==I&&null!==I&&I===oj.a.YPg)I="ContextMenuCell";else return null;var la=this.Sa.Oc();this.frh(la,I);return la};Wd.prototype.frh=function(I,la){la=this.VPg.iEh(la);la=Ol(la);for(var Va=la.next();!Va.done;Va=la.next()){Va=Ol(Va.value.controls);for(var Kb=Va.next();!Kb.done;Kb=Va.next())this.Tqh(I,Kb.value)}};Wd.prototype.Tqh=
function(I,la){var Va=la.Iz[Ng.a.id],Kb=la.Iz[Ng.a.XRa],nc=la.Iz[Ng.a.ZRa],Mc="Image16by16",Yc=la.Iz[Ng.a.hdb];Ii.c(nc)&&(Mc="None");0<la.menuItems.count?(Va=this.Sa.Kz(Va,Va,Kb,798637440),Va.rGb(Mc,nc,null),this.Mrh(Va.menu,la),Array.add(I.buttons,Va)):Array.add(I.buttons,this.Sa.zFa(Va,Kb,Yc,nc,Mc,null,!1))};Wd.prototype.Mrh=function(I,la){var Va,Kb=this.Sa.Oc();la=Ol(la.menuItems);for(Va=la.next();!Va.done;Va=la.next()){var nc=Va.value;Va=nc.fQ[Ng.a.id];var Mc=nc.fQ[Ng.a.XRa],Yc=nc.fQ[Ng.a.ZRa],
Ed="Image16by16";nc=nc.fQ[Ng.a.hdb];Ii.c(Yc)&&(Ed="None");Va=this.Sa.zFa(Va,Mc,nc,Yc,Ed,null,!1);Array.add(Kb.buttons,Va)}Array.add(I.Bc,Kb)};Object(Md.a)(Wd,"AddInCommandsContextMenuExtensibilityHandler",null,[472]);var Bk=b(985);Object(Md.a)(ld,"AddinStatusCommandValues",null,[]);Rc.HKi=function(I){var la=new ld;la.Qi=I.eWa;la.visible=la.Qi?!0:!1;return la};Rc.osc=function(I,la,Va,Kb,nc){var Mc=document.getElementById(Va);Mc?Rc.Wgj(I,la,Mc,Kb,nc):Je.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",
Va))};Rc.Wgj=function(I,la,Va,Kb,nc){Va?I.eWa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Uj.a.Cfj(la,Va,Kb,nc):I.eWa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Uj.a.ahj(la,Va):Je.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(Md.a)(Rc,"AddinCommandsStatusHandler",null,[]);var mk=b(216),gk=jj.a;Em(hd,gk);hd.prototype.Qp=function(I){this.addHandler("LAC",I)};hd.prototype.jq=function(I){this.removeHandler("LAC",I)};hd.prototype.mr=
function(I,la){var Va=this;if("QueryAddinLabel"!==I)return!1;la[Bk.a.LabelText]!==this.Ky.eWa&&(I=Rc.HKi(this.Ky),la[Bk.a.LabelText]=I.Qi,la[Bk.a.Visible]=I.visible,window.setTimeout(function(){Va.osc()},0));return!0};hd.prototype.Vm=function(){return!0};hd.prototype.osc=function(){this.$&&Rc.osc(this.Ky,this.$.domElement,this.Slj,Gf.a.instance.da(319),Gf.a.instance.da(320))};hd.prototype.dispose=function(){this.$.fa.qk(Object(qf.a)(this,this.Vc,"onSessionIdChanged"));this.Ky.gTi(Object(qf.a)(this,
this.fXe,"handleAddinCommandsLoadingMessageChanged"));this.agaveCommandManager&&(this.agaveCommandManager.uUi(Object(qf.a)(this,this.Gqe,"clearLoadingAddinMessage")),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.xE(this),this.statusBarManager=null);this.Ky=this.$=null;gk.prototype.dispose.call(this)};hd.prototype.Gqe=function(){this.Ky&&this.Ky.nqe()};hd.prototype.fXe=function(){this.raiseEvent("LAC")};hd.prototype.Vc=function(I,la){!I.lc&&mk.b(la)&&this.statusBarManager&&
(this.statusBarManager.xE(this),this.statusBarManager=null)};Object(Md.a)(hd,"AddinCommandsStatusBarManager",jj.a,[156,157]);var Zj=b(1273),R=b(143);xc.prototype.setErrorMessageForAddin=function(I,la){this.dWa||(this.dWa={});this.dWa[I]=la};xc.prototype.fzh=function(I){return this.dWa&&I in this.dWa?this.dWa[I]:null};Object(Md.a)(xc,"AddinCommandsErrorManager",null,[]);var va=b(422),jb=b(94);Object(Md.a)(pc,"AddinCommandsListLoaderContext",null,[]);var Xb=b(934),Jc=Sys.EventArgs;Em(kd,Jc);Object(Md.a)(kd,
"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);Ta.prototype.I4c=function(I){var la=new Sys.StringBuilder(this.YEb);la.append("RoamingServiceHandler.ashx?action=");la.append("getAddinTeachingCalloutSettings");la.append("&");la.append(this.dad(I));la.append("&");la.append($f.AFrameworkApplication.Xi);$f.AFrameworkApplication.Cd.Jl(la.toString(),1,null,null,!0,2,Object(qf.a)(this,this.BIa,"getRequestSuccessCallback"),Object(qf.a)(this,this.fia,"getRequestFailureCallback"),null)};Ta.prototype.J4c=
function(I){var la=new Sys.StringBuilder(this.YEb);la.append("RoamingServiceHandler.ashx?action=");la.append("saveAddinTeachingCalloutSettings");la.append("&");la.append($f.AFrameworkApplication.Xi);la=la.toString();I=yh.c(I);$f.AFrameworkApplication.Cd.Jl(la,2,I,null,!0,4,null,Object(qf.a)(this,this.iNa,"postRequestFailureCallback"),null)};Ta.prototype.BIa=function(I){var la=!1,Va=null;try{if(0<I.data.ae.length){for(var Kb=Object(qi.a)(Object,yh.a(I.data.ae)),nc=Kb?Kb[this.appName]:null,Mc=Ol(Kb),
Yc=Mc.next();!Yc.done;Yc=Mc.next()){var Ed=Yc.value;Je.ULS.sendTraceTag(538765393,306,50,"All user setting Key:{0}, Value:{1}",Ed.key.toString(),Ed.value.toString())}nc&&(Va=Object(qi.a)(Object,yh.a(nc.toString())));var re=Ol(Va);for(Yc=re.next();!Yc.done;Yc=re.next()){var pf=Yc.value;Je.ULS.sendTraceTag(538765394,306,50,"User setting Key:{0}, Value:{1}",pf.key.toString(),pf.value.toString())}}la=!0}catch(Ze){this.fia(null)}la&&this.Bfb&&this.Bfb(Va)};Ta.prototype.fia=function(I){this.xfb&&this.xfb(I?
I.data:null)};Ta.prototype.iNa=function(I){this.Lhb&&this.Lhb(I?I.data:null)};Ta.prototype.dad=function(I){for(var la=new Sys.StringBuilder("requestedsettings="),Va=0;Va<I.count;Va++)la.append(I.oa(Va)),Va<I.count-1&&la.append(";");return la.toString()};Object(Md.a)(Ta,"AddinTeachingUIRoamingRequestHandler",null,[]);var Xc=b(923);Ib.prototype.drg=function(I){this.Oa.addHandler(Mg.a.CVb,I)};Ib.prototype.Ftj=function(I){var la=this;null!==I&&(this.context.p5=I[Mg.a.q8],this.context.xr=I[Mg.a.oO],this.context.ROd=
this.context.slc=0,I=Mg.a.fWa in I?I[Mg.a.fWa]:0,-1!==this.context.p5&&this.context.xr&&(this.context.Xpa=new Xc.a,this.context.fQc=this.ivg.createAddinDataProvider(dc(this.context.p5),this.contextActivationMgr),this.context.fQc?this.context.fQc.getEntitlementsAsync(this.contextActivationMgr.xka,!0,I,function(Va){la.Ivi(Va)}):Je.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.p5)))};Ib.prototype.Ivi=function(I){var la=this;if(I&&0<I.length){this.context.ROd=
I.length;for(var Va=0;Va<I.length;Va++){var Kb=I[Va];if(!Kb||1!==Kb.targetType&&-1!==Kb.targetType)this.tsd();else{var nc={};$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(nc.marketplaceId=Kb.solutionId,nc.marketplaceVersion=Kb.version):(nc.marketplaceId=Kb.assetId,nc.marketplaceVersion=Kb.appVersion);nc.storeType=Kb.storeType;nc.storeId=Kb.storeId;nc.targetData=Kb;this.contextActivationMgr.isAddinCommandsAsync(nc,function(Mc,
Yc,Ed){Mc?Yc&&la.context.Xpa.add(Ed.targetData):Je.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(Ed.targetData.storeType,Ed.targetData.storeId,Ed.targetData.assetId),Ed.targetData.storeType);la.tsd()})}}}else this.tsd()};Ib.prototype.tsd=function(){var I;(I=this.context).slc=I.slc+1;this.context.slc>=this.context.ROd&&(this.evg.RMf(this.context.p5,!1),$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&10===this.context.p5&&"Excel"===this.appName?this.vth(this.context.Xpa):this.IOc(this.context.Xpa))};Ib.prototype.IOc=function(I){var la=new lh.a;if(I){I=Ol(this.context.Xpa);for(var Va=I.next();!Va.done;Va=I.next())la.add(ub(Va.value))}this.context.Xpa&&1>this.context.Xpa.count&&Xb.a.IJb(Mg.a.DVb,"false",this.context.p5);I={};la=(I.ack2=la,I);la[Mg.a.q8]=this.context.p5;la[Mg.a.oO]=this.context.xr;this.Oa.raiseEvent(Mg.a.CVb,new kd(la),this)};Ib.prototype.f1i=function(I){if(this.appName){var la=
{},Va={};Va.LastTeachingUIShowTime=(new Date).toUTCString();Va.AddinHasShown=I;la[this.appName]=yh.c(Va);this.jMb&&(this.jMb.J4c(la),Je.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Je.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};Ib.prototype.vth=function(I){if(this.oRa=I)I=new lh.a,I.add(this.appName),this.jMb=new Ta(this.appName,Object(qf.a)(this,this.BIa,
"getRequestSuccessCallback"),Object(qf.a)(this,this.fia,"getRequestFailureCallback"),Object(qf.a)(this,this.iNa,"postRequestFailureCallback")),this.jMb.I4c(I);else{I=new lh.a;var la={};I=(la.ack2=I,la);I[Mg.a.q8]=this.context.p5;I[Mg.a.oO]=this.context.xr;this.Oa.raiseEvent(Mg.a.CVb,new kd(I),this)}};Ib.prototype.BIa=function(I){I?this.Eej(I)?(this.N9a="AddinHasShown"in I?I.AddinHasShown.toString():null,I=this.jze(),this.Yde(I),Je.ULS.sendTraceTag(538248465,306,50,"Should Show TeachingUI, addinID:{0}",
I)):(Je.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.IOc(this.oRa)):(this.N9a=null,I=this.jze(),this.Yde(I),Je.ULS.sendTraceTag(538248464,306,50,"No teaching callout data found for current user. Show teaching callout for: {0}",I))};Ib.prototype.fia=function(I){Je.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",I?I.httpStatus:-1);this.IOc(this.oRa)};Ib.prototype.iNa=function(I){Je.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
I?I.httpStatus:-1)};Ib.prototype.Eej=function(I){return"LastTeachingUIShowTime"in I&&(I=+new Date-+new Date(I.LastTeachingUIShowTime.toString()),I<$f.AFrameworkApplication.ha.WT("AddinShowTeachingUIIntervalInMS",864E5))?(Je.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",I),!1):!0};Ib.prototype.jze=function(){for(var I=new va.a("",0),la=new va.a("",0),Va=0,Kb=0,nc=0,Mc=Ol(this.oRa),Yc=Mc.next();!Yc.done;Yc=Mc.next())if(Yc=Yc.value,!("excatalog"!==
Yc.storeType||Ii.c(Yc.installTimeInMS)||!Yc.installTimeInMS||Yc.installTimeInMS<=$f.AFrameworkApplication.ha.WT("DateTimeInMSForNewAddin",63776592E6))){var Ed=this.NNe(Yc);if(this.N9a){var re=this.N9a.split(",");if(0<re.length&&Array.contains(re,Ed)){nc++;Je.ULS.sendTraceTag(538817694,306,50,"This addin has shown teaching UI before");continue}}Ed.startsWith("private_")?(I.value<Yc.installTimeInMS&&(I=new va.a(Ed,Yc.installTimeInMS)),Kb++):(la.value<Yc.installTimeInMS&&(la=new va.a(Ed,Yc.installTimeInMS)),
Va++)}Je.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Kb,Va,nc);return 0<la.value?la.key:0<I.value?I.key:null};Ib.prototype.Yde=function(I){for(var la=new lh.a,Va=Ol(this.oRa),Kb=Va.next();!Kb.done;Kb=Va.next()){var nc=Kb.value;Kb=ub(nc);I&&(nc=this.NNe(nc),I===nc&&(Kb.showCallout=!0,this.f1i(this.N9a?this.N9a+","+I:I)));la.add(Kb)}this.oRa&&1>this.context.Xpa.count&&Xb.a.IJb(Mg.a.DVb,"false",this.context.p5);I={};
la=(I.ack2=la,I);la[Mg.a.q8]=this.context.p5;la[Mg.a.oO]=this.context.xr;this.Oa.raiseEvent(Mg.a.CVb,new kd(la),this)};Ib.prototype.NNe=function(I){return Telemetry.PrivacyRules.IsPrivateAddin(I.storeType,I.storeId,I.assetId)?"private_"+I.installTimeInMS:I.assetId};Object(Md.a)(Ib,"AddInCommandsListLoader",null,[]);fc.prototype.insertOsfControl=function(I){return this.xka.insertOsfControl(I)};fc.prototype.getManifestInvaildErrorString=function(){return this.xka.getManifestInvaildErrorString()};fc.prototype.isAddinCommandsAsync=
function(I,la){this.xka.isAddinCommandsAsync(I,la)};fc.prototype.ownerAddinControlRecreated=function(I,la){this.xka.ownerAddinControlRecreated(I,la)};Ll.Object.defineProperties(fc.prototype,{xka:{configurable:!0,enumerable:!0,get:function(){return this.Ygg}}});Object(Md.a)(fc,"ContextActivationMgrWrapper",null,[804]);Da.prototype.createAddinDataProvider=function(I,la){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(I,la.xka)};Ll.Object.defineProperties(Da,{instance:{configurable:!0,
enumerable:!0,get:function(){Da.Ma||(Da.Ma=new Da);return Da.Ma}}});Da.Ma=null;Object(Md.a)(Da,"OSFAddinDataProviderFactory",null,[803]);var Dc=b(1070),Cc=b(935);lf.prototype.RMf=function(I,la){I=Mg.a.CQe()+I;Cc.a.instance.setItem(I,la.toString())};Ll.Object.defineProperties(lf,{instance:{configurable:!0,enumerable:!0,get:function(){lf.Ma||(lf.Ma=new lf);return lf.Ma}}});lf.Ma=null;Object(Md.a)(lf,"AddInCommandsCacheManager",null,[806]);var cd=Sys.EventArgs;Em(Ee,cd);Object(Md.a)(Ee,"InsertionParamEventArgs",
Sys.EventArgs,[]);Object(Md.a)(fe,"PostLaunchAddinCommandsParameters",null,[]);var Gd=b(116);Vc.prototype.yog=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(qf.a)(this,this.wvi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(qf.a)(this,this.$qi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(qf.a)(this,this.Jpi,"onCloseButtonClickedEventHandler"),!0)):Je.ULS.sendTraceTag(539353218,
306,15,"AddEventListenerForTeachingCallout failed to get Window")};Vc.prototype.wvi=function(){var I=this,la={};la=(la["Data.AppTeachingUICalloutAction"]="ClickOnLaunch",la["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.v7.storeType,this.v7.storeId,this.v7.assetId),la);aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(la)}));this.KUd?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.KUd,function(){var Va=new Ee;
Va.Oi=I.v7;I.Ya.raiseEvent(Mg.a.vaf,Va)}):Je.ULS.sendTraceTag(539353219,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Vc.prototype.Jpi=function(){var I={};I=(I["Data.AppTeachingUICalloutAction"]="ClickOnClose",I["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.v7.storeType,this.v7.storeId,this.v7.assetId),I);aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(I)}))};Vc.prototype.$qi=function(){var I=
{};I=(I["Data.AppTeachingUICalloutAction"]="ClickOnDismiss",I["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.v7.storeType,this.v7.storeId,this.v7.assetId),I);aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(I)}))};Object(Md.a)(Vc,"PrivateCatalogTeachingCalloutHandler",null,[]);Nd.prototype.kfa=function(I,la){this.E0d.kfa(I,void 0===la?null:la);this.C2d=I};Nd.prototype.Q8a=function(I){this.E0d.Q8a(I)};Ll.Object.defineProperties(Nd.prototype,
{H4a:{configurable:!0,enumerable:!0,get:function(){return this.C2d}}});Object(Md.a)(Nd,"RibbonExtensibilityManagerWithChangeDetection",null,[832]);var zd=b(925);He.prototype.kfa=function(I,la){la=void 0===la?null:la;if(I=zd.a.prb(I)){appChrome.addInApi.dispatchActionsToInstallAddIn(I,la);la=Ol(I.tabs);for(var Va=la.next();!Va.done;Va=la.next())if(Va.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(I,function(){});break}}};He.prototype.Q8a=function(I){(I=zd.a.prb(I))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(I)};
Object(Md.a)(He,"OneLineRibbonExtensibilityManager",null,[832]);var pe=b(997);Vd.kRe=function(I){var la=new lh.a;if(Vd.Kse)for(var Va=Ol(Vd.Kse),Kb=Va.next();!Kb.done;Kb=Va.next())la.add(Kb.value);Kb=null;switch(I){case "Workbook":Kb=Vd.cDj;break;case "Document":Kb=Vd.T4g;break;case "Presentation":Kb=Vd.zIi}if(Kb)for(I=Ol(Kb),Kb=I.next();!Kb.done;Kb=I.next())la.add(Kb.value);return la};Vd.Kse=["PrimaryCommandSurface","ContextMenu"];Vd.cDj=null;Vd.T4g=null;Vd.zIi=null;Object(Md.a)(Vd,"ExtensionPointType",
null,[]);Ll.Object.defineProperties(Id.prototype,{Czb:{configurable:!0,enumerable:!0,get:function(){return this.D5d||(this.D5d=new lh.a)}},ihe:{configurable:!0,enumerable:!0,get:function(){return this.r9f}}});Object(Md.a)(Id,"ContextMenuExtensibility",null,[805]);rd.prototype.CNe=function(){for(var I=new Sys.StringBuilder,la=Ol(this.fX),Va=la.next();!Va.done;Va=la.next())I.append(Va.value.r6());return this.Ypg(I.toString())};rd.prototype.Ypg=function(I){var la=new Sys.StringBuilder;la.append("<Ribbon><Tabs>");
la.append(I);la.append("</Tabs></Ribbon>");return la.toString()};Ll.Object.defineProperties(rd.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.fX}},Zaa:{configurable:!0,enumerable:!0,get:function(){return this.Rgg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.jkg}},g7a:{configurable:!0,enumerable:!0,get:function(){return this.rhb}},Jsh:{configurable:!0,enumerable:!0,get:function(){return this.Tcg}}});Object(Md.a)(rd,"RibbonExtensibility",null,[860]);
Pc.prototype.createActionContext=function(I,la){I={};I.ownerAddinInfo=this.entitlement;I.action=la;return I};Ll.Object.defineProperties(Pc.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.Rbg}}});Object(Md.a)(Pc,"AddInCommandsContextProvider",null,[]);hc.prototype.hTg=function(I){return new Pc(I)};hc.prototype.createActionBuilder=function(I,la){return OfficeExt.DefaultControlActionBinder.createActionBuilder(I,la.entitlement,la.manifest)};hc.prototype.startApplyAddin=
function(I){this.JUd=I;var la=this.hTg(I);this.actionBuilder=this.createActionBuilder(la,I)};hc.prototype.endApplyAddin=function(){};hc.prototype.h0a=function(I,la,Va){Va=void 0===Va?0:Va;return this.ribbonBuilder.Qtc&&0<this.ribbonBuilder.Qtc.count||this.ribbonBuilder.sw&&0<this.ribbonBuilder.sw.count?new rd(this.ribbonBuilder.Qtc,this.Yrh(I,la),this.gQc.startedNode,this.ribbonBuilder.I4.xEh(),Va):null};hc.prototype.ZMe=function(){var I=void 0===I?null:I;if(this.contextMenuBuilder.igc&&0<this.contextMenuBuilder.igc.count){I||
(I=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.gQc.entitlement.solutionId:this.gQc.entitlement.assetId);I=new Id(I);for(var la=Ol(this.contextMenuBuilder.igc),Va=la.next();!Va.done;Va=la.next())I.Czb.add(Va.value);return I}return null};hc.prototype.Yrh=function(I,la){return this.ribbonBuilder.sw&&0<this.ribbonBuilder.sw.count?new zd.a(this.ribbonBuilder.sw,I,la):null};Ll.Object.defineProperties(hc.prototype,{gQc:{configurable:!0,
enumerable:!0,get:function(){return this.JUd}}});Object(Md.a)(hc,"AddinCommandsBuilder",null,[]);Bb.prototype.hLa=function(I,la,Va,Kb,nc,Mc,Yc){function Ed(nh,Ki,Wh,si){nc(nh,Ki,Wh,si);nh=pe.a[re.xr]+Ki.assetId;Wh=re.Zya.zc(nh);Ki=Wh.value;Wh.returnValue&&(Ki.stop(),re.Zya.remove(nh))}var re=this;if(this.xr&&I)for(Je.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",I.count),4===this.xr&&(Je.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Kb)),this.RKg(I,
Kb),Mc()),I=Ol(I),Kb=I.next();!Kb.done;Kb=I.next())if(Kb=Kb.value,$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Kb.solutionId=Kb.solutionId||Kb.assetId,Kb.storeType=Kb.storeType||Kb.currentStoreType,Kb.version=Kb.version||Kb.appVersion,Je.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(Kb.storeType,Kb.storeId,Kb.solutionId)))):Je.ULS.sendTraceTag(540379088,220,
50,String.format("{0}: Install addin {1}",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(Kb.currentStoreType,Kb.storeId,Kb.assetId))),this.R4f(Kb))if(Yc&&Kb.requireConsent)Yc(Kb,function(nh){try{if(re.IH){var Ki=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?pe.a[re.xr]+nh.solutionId:pe.a[re.xr]+nh.assetId;var Wh=re.IH.Dc("ComponentAttach",Ki);re.Zya.ia(Ki,Wh)}var si=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?re.Ky.sP(nh.storeType,nh.solutionId):re.Ky.sP(nh.currentStoreType,nh.id);6!==re.xr&&(si&&(re.Ymb(si),si.Fy.purge(!1)),re.sh.insertOsfControl(re.P7a(nh,la,Va,Ed)),si&&($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?re.sh.ownerAddinControlRecreated(nh.solutionId,nh.storeType):re.sh.ownerAddinControlRecreated(nh.assetId,nh.currentStoreType)))}catch(Ti){$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?Je.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",re.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(nh.storeType,nh.storeId,nh.solutionId),nh.version,nh.storeType,nh.storeId,Ti.message)):Je.ULS.sendTraceTag(540379089,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",re.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(nh.currentStoreType,
nh.storeId,nh.assetId),nh.appVersion,nh.currentStoreType,nh.storeId,Ti.message)),Ed(!1,nh,null,null)}});else if($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1))try{if(this.IH){var pf=pe.a[this.xr]+Kb.solutionId,Ze=this.IH.Dc("ComponentAttach",pf);this.Zya.ia(pf,Ze)}var cg=this.Ky.sP(Kb.storeType,Kb.solutionId);6!==this.xr&&(cg&&(this.Ymb(cg),cg.Fy.purge(!1)),this.sh.insertOsfControl(this.P7a(Kb,la,Va,Ed)),cg&&this.sh.ownerAddinControlRecreated(Kb.solutionId,
Kb.storeType))}catch(nh){Je.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(Kb.storeType,Kb.storeId,Kb.solutionId),Kb.version,Kb.storeType,Kb.storeId,nh.message)),Ed(!1,Kb,null,null)}else try{if(this.IH){var Ug=pe.a[this.xr]+Kb.assetId,rh=this.IH.Dc("ComponentAttach",Ug);this.Zya.ia(Ug,rh)}var Lh=this.Ky.sP(Kb.currentStoreType,Kb.id);6!==
this.xr&&(Lh&&(this.Ymb(Lh),Lh.Fy.purge(!1)),this.sh.insertOsfControl(this.P7a(Kb,la,Va,Ed)),Lh&&this.sh.ownerAddinControlRecreated(Kb.assetId,Kb.currentStoreType))}catch(nh){Je.ULS.sendTraceTag(540379090,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(Kb.currentStoreType,Kb.storeId,Kb.assetId),Kb.appVersion,Kb.currentStoreType,Kb.storeId,nh.message)),Ed(!1,Kb,null,null)}else Ed(!1,
Kb,null,null)};Bb.prototype.n$h=function(I,la,Va,Kb,nc,Mc){function Yc(cg,Ug,rh,Lh){Mc(cg,Ug,rh,Lh);cg=pe.a[Ed.xr]+Ug.assetId;rh=Ed.Zya.zc(cg);Ug=rh.value;rh.returnValue&&(Ug.stop(),Ed.Zya.remove(cg))}var Ed=this;if(6===this.xr&&I)if($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(I.solutionId=I.solutionId||I.assetId,I.storeType=I.storeType||I.currentStoreType,I.version=I.version||I.appVersion,Je.ULS.sendTraceTag(592290762,220,
50,String.format("{0}: Install dynamic ribbon {1}",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(I.storeType,I.storeId,I.solutionId)))):Je.ULS.sendTraceTag(540379091,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(I.currentStoreType,I.storeId,I.assetId))),this.R4f(I))try{if(this.IH){var re=pe.a[this.xr]+I.assetId,pf=this.IH.Dc("ComponentAttach",re);this.Zya.ia(re,pf)}var Ze=this.Ky.sP(I.currentStoreType,I.id);Ze||Yc(!1,I,null,null);$f.AFrameworkApplication.xa&&
$f.AFrameworkApplication.xa.Xa.delayInstallAddInIsEnabled?this.ANe(I,la,Kb,nc,Va,function(cg){Yc(cg,I,Va,Ze.displayName)}):(this.ANe(I,la,Kb,nc,Va),Yc(!0,I,Va,Ze.displayName))}catch(cg){Je.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(I.currentStoreType,I.storeId,I.assetId),I.appVersion,I.currentStoreType,I.storeId,cg.message)),
Yc(!1,I,null,null)}else Yc(!1,I,null,null)};Bb.prototype.Uni=function(I,la,Va,Kb,nc,Mc){if(Mc)if(Mc._isAddinCommandsManifest(this.Kl.Xz))try{$f.AFrameworkApplication.xa&&$f.AFrameworkApplication.xa.Xa.delayInstallAddInIsEnabled?this.zNe(I,la,Va,nc,Mc,function(Yc){Kb(Yc,I,Mc,Mc.getDefaultDisplayName())}):(this.zNe(I,la,Va,nc,Mc),Kb(!0,I,Mc,Mc.getDefaultDisplayName()))}catch(Yc){Je.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(I.currentStoreType,I.storeId,I.assetId),I.appVersion,I.currentStoreType,I.storeId,Yc.message)),Kb(!1,I,Mc,Mc.getDefaultDisplayName())}else Je.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(I.currentStoreType,I.storeId,I.assetId),I.appVersion,I.currentStoreType,I.storeId)),Kb(!1,I,null,
null);else Je.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Kl.Xz,Telemetry.PrivacyRules.GetAssetId(I.currentStoreType,I.storeId,I.assetId),I.appVersion,I.currentStoreType,I.storeId)),Kb(!1,I,null,null)};Bb.prototype.P7a=function(I,la,Va,Kb){function nc(re,pf){var Ze;(Ze=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Mc.Ky.sP(I.storeType||
I.currentStoreType,I.solutionId||I.id):Mc.Ky.sP(I.currentStoreType,I.id))&&Mc.Ymb(Ze);Mc.Uni(I,la,Va,Kb,re,pf)}var Mc=this,Yc={},Ed=document.createElement("div");Ed.setAttribute("visible","false");$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Yc.div=Ed,Yc.id=I.solutionId||I.id,Yc.solutionId=I.solutionId||I.id,Yc.version=I.version||I.appVersion,Yc.storeType=I.storeType||I.currentStoreType,Yc.storeId=I.storeId,Yc.assetId=I.assetId,
Yc.assetStoreId=I.assetStoreId,Yc.isvirtualOsfControl=!0,Yc.virtualOsfControlActivationCallback=nc,Yc.reason=3===this.xr?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,Yc.marketplaceID=I.id,Yc.marketplaceVersion=I.appVersion,Yc.store=I.storeId):(Yc.div=Ed,Yc.id=I.id,Yc.marketplaceID=I.id,Yc.marketplaceVersion=I.appVersion,Yc.store=I.storeId,Yc.storeType=I.currentStoreType,Yc.osfControlType=I.targetType,Yc.isvirtualOsfControl=
!0,Yc.virtualOsfControlActivationCallback=nc,Yc.reason=3===this.xr?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened);return Yc};Bb.prototype.zNe=function(I,la,Va,Kb,nc,Mc){Mc=void 0===Mc?null:Mc;var Yc={};$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Yc.solutionId=Kb.getSolutionId(),Yc.version=Kb.getVersion(),Yc.storeType=Kb.getStoreType(),Yc.storeId=
Kb.getStoreId(),Yc.assetId=Kb.getSolutionId(),Yc.assetStoreId=Kb.getAssetStoreId(),Yc.targetType=Kb.getOsfControlType(),Yc.appVersion=Kb.getMarketplaceVersion()):(Yc.storeType=Kb.getStoreType(),Yc.storeId=Kb.getStoreLocator(),Yc.assetId=Kb.getMarketplaceID(),Yc.appVersion=Kb.getMarketplaceVersion(),Yc.targetType=Kb.getOsfControlType());var Ed=null,re=null;if($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Kl.Xz,
this.Kl.formFactor)).parseExtensions(Yc,nc,this.sfa),re=Vd.kRe(this.Kl.Xz);else try{Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Kl.Xz,this.Kl.formFactor)).parseExtensions(Yc,nc,this.sfa),re=Vd.kRe(this.Kl.Xz)}catch(Ti){throw Je.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ti.message),Ti;}if(re&&0<re.count){if($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var pf=la(I);var Ze=Va(I);Va=!!$f.AFrameworkApplication.ha&&$f.AFrameworkApplication.ha.sa("AddinCommandsMultipleCustomTabsEnabled");pf=new hc(pf,null,Ze);re=Ol(re);for(Ze=re.next();!Ze.done;Ze=re.next())pf.commandSurface=Ze.value,Ed.apply(pf,this.sfa,Va)}else try{var cg=la(I),Ug=Va(I),rh=!!$f.AFrameworkApplication.ha&&$f.AFrameworkApplication.ha.sa("AddinCommandsMultipleCustomTabsEnabled");pf=new hc(cg,null,Ug);var Lh=Ol(re);for(Ze=Lh.next();!Ze.done;Ze=Lh.next())pf.commandSurface=Ze.value,
Ed.apply(pf,this.sfa,rh)}catch(Ti){throw Je.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Ti.message),Ti;}if(OSF.OUtil.checkFlight(14))try{var nh=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?pf.h0a(I.solutionId||I.id,nc.getDefaultDisplayName()):pf.h0a(I.id,nc.getDefaultDisplayName());var Ki=pf.ZMe();nh&&this.ribbonManager.kfa(nh,Mc);Ki&&this.contextMenuManager.Bde(Ki);this.Ky.cee(Kb,
nh,Ki,nc.getDefaultDisplayName());Je.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",nc.getDefaultDisplayName())}catch(Ti){throw OfficeExt.DevConsole.log(Ti),Je.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ti.message),Ti;}else try{var Wh=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?pf.h0a(I.solutionId||I.id,nc.getDefaultDisplayName()):pf.h0a(I.id,nc.getDefaultDisplayName());var si=
pf.ZMe();Wh&&this.ribbonManager.kfa(Wh);si&&this.contextMenuManager.Bde(si);this.Ky.cee(Kb,Wh,si,nc.getDefaultDisplayName());Je.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",nc.getDefaultDisplayName())}catch(Ti){throw Je.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ti.message),Ti;}}};Bb.prototype.ANe=function(I,la,Va,Kb,nc,Mc){Mc=void 0===Mc?null:Mc;var Yc={};$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(Yc.solutionId=I.solutionId||I.assetId,Yc.version=I.version||I.appVersion,Yc.storeType=I.storeType||I.currentStoreType,Yc.storeId=I.assetStoreId,Yc.assetId=I.assetId,Yc.assetStoreId=I.assetStoreId,Yc.targetType=I.targetType,Yc.appVersion=I.appVersion):(Yc.storeType=I.currentStoreType,Yc.storeId=I.assetStoreId,Yc.assetId=I.assetId,Yc.appVersion=I.appVersion,Yc.targetType=I.targetType);var Ed=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Kl.Xz,this.Kl.formFactor);try{var re=la.getManifest(),
pf=Ed.parse(Yc,re,nc,this.sfa,la.getSharedRuntimeId()),Ze=Va(I),cg=Kb(I),Ug=new hc(Ze,null,cg);Ug.commandSurface="PrimaryCommandSurface";pf.apply(Ug,this.sfa,!0);if(Ug.ribbonBuilder.sw&&0<Ug.ribbonBuilder.sw.count){var rh=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Ug.h0a(I.solutionId||I.id,la.getManifest().getDefaultDisplayName(),1):Ug.h0a(I.id,la.getManifest().getDefaultDisplayName(),1);$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.kfa(rh,Mc):rh&&this.ribbonManager.kfa(rh,Mc);this.Ky.opg(la,rh,nc,la.getManifest().getDefaultDisplayName());Je.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",la.getManifest().getDefaultDisplayName())}}catch(Lh){Je.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",la.getManifest().getDefaultDisplayName(),Lh.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Lh)}};Bb.prototype.Ymb=function(I){I.Kq&&
this.ribbonManager.Q8a(I.Kq);I.Lnb&&this.contextMenuManager.cSi(I.Lnb);this.Ky.LRi(I.Fy.getStoreType(),I.Fy.getMarketplaceID())};Bb.prototype.RKg=function(I,la){la=dc(la);for(var Va=Ol(this.Ky.G2a),Kb=Va.next();!Kb.done;Kb=Va.next())if(Kb=Kb.value,Kb.Fy.getStoreType()===la){for(var nc=!0,Mc=Ol(I),Yc=Mc.next();!Yc.done;Yc=Mc.next())if(Yc=Yc.value,$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(Yc&&Kb.Hjd(Yc.storeType||Yc.currentStoreType,
Yc.solutionId||Yc.id)){nc=!1;break}}else if(Yc&&Kb.Hjd(Yc.currentStoreType,Yc.id)){nc=!1;break}nc&&(this.Ymb(Kb),Kb.Fy.purge(!1))}};Bb.prototype.R4f=function(I){return $f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(I.solutionId!==I.assetId&&Je.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId"),I.id!==I.assetId&&Je.ULS.sendTraceTag(540379093,220,50,"VerifyInsertAgaveParameter Id != AssetId"),!!I&&
!!I.solutionId&&!!I.version&&!!I.storeType&&!!I.storeId):!!I&&!!I.currentStoreType&&!!I.storeId&&!!I.id&&!!I.appVersion};Object(Md.a)(Bb,"AddInCommandsIntegration",null,[]);var kf=b(844);Oc.prototype.erg=function(I){this.Ya.addHandler(Mg.a.Ige,I)};Oc.prototype.Xsg=function(I){this.Ya.addHandler(Mg.a.vaf,I)};Oc.prototype.wug=function(I){this.Ya.addHandler(Mg.a.JSf,I)};Oc.prototype.hLa=function(I,la,Va){var Kb=this,nc=Va[Mg.a.cWa],Mc=void 0===Va[Mg.a.oO]?0:Va[Mg.a.oO];if(nc&&Mc)if(0>=nc.count&&4!==
Mc)this.Pkc(new fe(Mc,null,null,I,la,null,!0));else{var Yc=nc.count,Ed=new Nd(new ne(I));Va=void 0===Va[Mg.a.q8]?-1:Va[Mg.a.q8];(new Bb(Mc,this.fm,this.eSa,Ed,this.sXd,this.yea,this.qna)).hLa(nc,function(re){return Kb.oTb.zEg(re.assetId,Kb.qna,Kb.eSa)},function(re){return Kb.oTb.pme(re.assetId)},Va,function(re,pf,Ze,cg){Yc--;Ze=new fe(Mc,pf,Ed,I,la,cg,0>=Yc);re&&pf?Kb.Pkc(Ze):Kb.Okc(Ze)},function(){Kb.ehc();0>=nc.count&&4===Mc&&Kb.yea.sqc()},this.I5d)}else Je.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",
this.eSa.Xz)),this.Okc(new fe(Mc,null,null,I,la,null,!0))};Oc.prototype.E$h=function(I,la,Va){var Kb=this,nc=Va[Mg.a.cWa],Mc=void 0===Va[Mg.a.oO]?0:Va[Mg.a.oO];if(nc&&Mc)if(0>=nc.count&&4!==Mc)this.Pkc(new fe(Mc,null,null,null,la,null,!0));else{var Yc=nc.count,Ed=new Nd(new He),re=void 0===Va[Mg.a.q8]?-1:Va[Mg.a.q8],pf=new Bb(Mc,this.fm,this.eSa,Ed,this.sXd,this.yea,this.qna),Ze=function(nh){return Kb.oTb.lEg(nh.assetId,Kb.qna,Kb.eSa,I)},cg=function(nh){return Kb.oTb.pme(nh.assetId)},Ug=function(nh,
Ki,Wh){Yc--;Wh=new fe(Mc,Ki,Ed,null,la,Wh,0>=Yc);nh&&Ki?Kb.Pkc(Wh):Kb.Okc(Wh);Yc||$f.AFrameworkApplication.xa.updateCommandUI()},rh=function(nh,Ki,Wh,si){Ug(nh,Ki,si)},Lh=function(){Kb.ehc();0>=nc.count&&4===Mc&&Kb.yea.sqc()};6===Mc?(re=Va[Mg.a.GGa],Va=Va[Mg.a.HGa],pf.n$h(nc.oa(0),re,Va,Ze,cg,function(nh,Ki,Wh,si){Ug(nh,Ki,si)})):pf.hLa(nc,Ze,cg,re,rh,Lh,this.I5d)}else Je.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.eSa.Xz)),this.Okc(new fe(Mc,
null,null,null,la,null,!0))};Oc.prototype.Okc=function(I){this.ehc(I);this.yTf(!1,I)};Oc.prototype.Pkc=function(I){var la=I.Oi;this.ehc(I);if(la){lf.instance.RMf(ce(la.currentStoreType.toLowerCase()),!0);if("uploadfiledevcatalog"===la.currentStoreType.toLowerCase()){var Va=this.j9f.createAddinDataProvider(la.currentStoreType.toLowerCase(),this.fm);Va&&($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Va.localCacheAddinCommands(this.fm.xka,
la.solutionId||la.id,la.version||la.appVersion,la.storeId):Va.localCacheAddinCommands(this.fm.xka,la.id,la.appVersion,la.storeId))}this.Z1i(I.aya.H4a,la.currentStoreType,I.xr,I.wMe);Xb.a.IJb(Mg.a.DVb,"true",ce(la.currentStoreType.toLowerCase()))}this.yTf(!0,I)};Oc.prototype.yTf=function(I,la){I?$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&la.aya&&5===la.xr&&la.aya.H4a&&void 0!==la.Oi.showCallout&&null!==la.Oi.showCallout&&
la.Oi.showCallout?((new Vc(this.Ya,la.Oi,zd.a.prb(la.aya.H4a))).yog(),I=new Ee,I.Kq=la.aya.H4a,I.Oi=la.Oi,this.Ya.raiseEvent(Mg.a.JSf,I)):3!==la.xr?la.z$e&&this.yea.sqc():la.aya&&la.aya.H4a&&(I=Object(qi.a)(kf.Ribbon,la.wMe),"hardcodedpreinstall"!==la.Oi.currentStoreType&&Uj.a.Efj(I,la.Lph,la.displayName,la.aya.H4a)):3===la.xr?la.Oi&&"uploadfiledevcatalog"===la.Oi.currentStoreType.toLowerCase()?(la=this.qna.fzh(la.Oi.assetId),Uj.a.lKd(la?la:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.yea.VNf():la.z$e&&this.yea.sqc()};Oc.prototype.ehc=function(I){var la=(I=void 0===I?null:I)?I.Oi:null,Va=new Ee;if(Va.Oi=la)I=6===I.xr?1:0,(la=$f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.yea.sP(la.storeType||la.currentStoreType,la.solutionId||la.id,I):this.yea.sP(la.currentStoreType,la.assetId,I))&&la.Kq&&(Va.Kq=la.Kq);this.Ya.raiseEvent(Mg.a.Ige,Va)};Oc.prototype.Z1i=function(I,la,Va,Kb){Kb=Object(qi.a)(kf.Ribbon,
Kb);I&&Kb&&(I=I.tabs.oa(0).tQa[Ng.a.id],3===Va&&"hardcodedpreinstall"!==la&&Kb.fGd(I),Kb.d6h(I)&&Kb.Y1i())};Object(Md.a)(Oc,"LaunchAddinCommandsHandler",null,[810]);b(896);b(875);rc.prototype.r6=function(){return eh.k(this.vXd,this.Mhi(),this.Iz)};rc.prototype.Mhi=function(){var I=null;if(this.eea){I=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');for(var la=Ol(this.eea),Va=la.next();!Va.done;Va=la.next())I.append(Va.value.r6());I.append("</Controls></MenuSection></Menu>")}return I?
I.toString():""};Ll.Object.defineProperties(rc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},Iz:{configurable:!0,enumerable:!0,get:function(){return this.tXd||(this.tXd={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.vXd||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.eea||(this.eea=new lh.a)}}});Object(Md.a)(rc,"ControlDefinition",null,[101]);Lb.prototype.r6=function(){return eh.k(Ng.a.button,null,this.FHc)};
Ll.Object.defineProperties(Lb.prototype,{fQ:{configurable:!0,enumerable:!0,get:function(){return this.FHc||(this.FHc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(Md.a)(Lb,"MenuItemDefinition",null,[100]);vb.prototype.r6=function(){var I=null;if(this.d7){I=new Sys.StringBuilder;for(var la=Ol(this.d7),Va=la.next();!Va.done;Va=la.next())I.append(Va.value.r6())}return I?I.toString():""};Ll.Object.defineProperties(vb.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.d7||(this.d7=new lh.a)}}});Object(Md.a)(vb,"OfficeMenuDefinition",null,[194]);var tf=b(28);sa.prototype.addButton=function(I){Je.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",I.actionType);this.aI=new rc(this.yO(I.id),Ng.a.button);this.aI.Iz[Ng.a.ULb]=I.label;this.aI.Iz[Ng.a.XRa]=I.label;this.aI.Iz[Ng.a.ZRa]=I.icon["16"];this.vqa(this.aI.Iz[Ng.a.id],I.action);this.d1(this.aI.Iz);
this.LSa.controls.add(this.aI);this.aI=null};sa.prototype.startBuildMenu=function(I){if(Ii.c(this.LSa))this.LSa=new vb(I.id);else{var la=this.yO(I.id);this.aI=new rc(la,Ng.a.Y2);this.Qfa(this.aI.Iz,I);this.aI.Iz[Ng.a.ZRa]=I.icon["16"];this.aI.Iz[Ng.a.hdb]=tf.a.alwaysEnabled}};sa.prototype.addMenuItem=function(I){Je.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",I.actionType);var la=new Lb(this.yO(I.id));this.Qfa(la.fQ,I);I.icon&&(la.fQ[Ng.a.ZRa]=I.icon["16"]);this.vqa(la.fQ[Ng.a.id],
I.action);this.d1(la.fQ);this.aI.menuItems.add(la)};sa.prototype.endBuildMenu=function(){Ii.c(this.aI)?(this.igc.add(this.LSa),this.LSa=null):(this.LSa.controls.add(this.aI),this.aI=null)};sa.prototype.vqa=function(I,la){this.vjb.bindAction(I,la)};sa.prototype.d1=function(I){this.cFa.d1(I)};sa.prototype.yO=function(I){return this.I4.mta(I)};sa.prototype.Qfa=function(I,la){I[Ng.a.ULb]=la.label;I[Ng.a.XRa]=la.label};Ll.Object.defineProperties(sa.prototype,{I4:{configurable:!0,enumerable:!0,get:function(){return this.dhb}},
cFa:{configurable:!0,enumerable:!0,get:function(){return this.uda}},vjb:{configurable:!0,enumerable:!0,get:function(){return this.jda}},igc:{configurable:!0,enumerable:!0,get:function(){return this.bgg}}});Object(Md.a)(sa,"ContextMenuExtensibilityCreator",null,[173,89]);Od.prototype.mta=function(I){return this.ZLa+I};Ll.Object.defineProperties(Od.prototype,{ZLa:{configurable:!0,enumerable:!0,get:function(){return this.uCa}}});Object(Md.a)(Od,"DefaultContextMenuNamingProvider",null,[172]);yd.prototype.Xwh=
function(I){return this.mQg+I};Ll.Object.defineProperties(yd.prototype,{Loj:{configurable:!0,enumerable:!0,get:function(){return this.clg}},mQg:{configurable:!0,enumerable:!0,get:function(){return this.Pag}}});Object(Md.a)(yd,"DefaultRibbonGroupTemplate",null,[192]);Ll.Object.defineProperties(Nc.prototype,{VIb:{configurable:!0,enumerable:!0,get:function(){return this.Yib}}});Object(Md.a)(Nc,"DefaultRibbonGroupTemplateResolver",null,[171]);var Df=b(1274);Lc.prototype.bindAction=function(I,la){OfficeExt.DefaultControlActionBinder.bindAction(I,
la)};Object(Md.a)(Lc,"DefaultUIControlActionBinder",null,[169]);gc.prototype.d1=function(I){I[Ng.a.hdb]=this.command};Ll.Object.defineProperties(gc.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.UAa}}});Object(Md.a)(gc,"DefaultUIControlCommandBinder",null,[168]);var Cg=b(31);Object(Md.a)(Ab,"AddInControl",null,[]);Object(Md.a)(cb,"AddInGroup",null,[]);Object(Md.a)(Qa,"AddInMenuItem",null,[]);Object(Md.a)(fb,"AddInTab",null,[]);sb.prototype.startBuildTab=function(I){var la=
I.isOfficeTab?I.id:this.I4.Sad(I.id),Va=I.isOfficeTab?null:I.label;this.Uu=Object.assign(new fb,{id:la,title:Va,isOfficeTab:I.isOfficeTab,visible:I.visible,groups:[],tabType:I.tabType,insertBefore:I.insertBefore,insertAfter:I.insertAfter,autoFocus:I.autoFocus})};sb.prototype.startBuildGroup=function(I){var la=this.yO(I.id);this.cw=Object.assign(new cb,{id:la,mlrId:I.mlrId,title:I.label,controls:[],groupType:0})};sb.prototype.addNativeGroup=function(I){this.cw=Object.assign(new cb,{id:I.id,mlrId:I.mlrId,
title:I.label,controls:[],groupType:1});this.Uu.groups.push(this.cw)};sb.prototype.addButton=function(I){var la=this.yO(I.id);la&&(this.vqa(la,I.action),Je.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",I.actionType),I=Object.assign(new Ab,{id:la,title:I.label,iconLocation:this.Y9c(I),enabled:I.enabled,controlType:0,attributes:this.Qfa()}),this.sZd.ode(new Cg.a(la,this.cFa.command.toString())),this.cw.controls.push(I))};sb.prototype.addNativeControl=function(I){I.id&&
(Je.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",I.actionType),I=Object.assign(new Ab,{id:I.id,title:"",iconLocation:"",enabled:I.enabled,controlType:2,attributes:this.Qfa()}),this.cw.controls.push(I))};sb.prototype.startBuildMenu=function(I){var la=this.yO(I.id);la&&(this.e7=Object.assign(new Ab,{id:la,title:I.label,iconLocation:this.Y9c(I),controlType:1,attributes:{},menuItems:[]}))};sb.prototype.addMenuItem=function(I){var la=this.yO(I.id);la&&(this.vqa(la,
I.action),Je.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",I.actionType),I=Object.assign(new Qa,{id:la,title:I.label,iconLocation:this.Y9c(I),enabled:I.enabled,attributes:this.Qfa()}),this.sZd.ode(new Cg.a(la,this.cFa.command.toString())),this.e7.menuItems.push(I))};sb.prototype.endBuildMenu=function(){Ii.c(this.e7.id)||this.cw.controls.push(this.e7);this.e7=null};sb.prototype.endBuildGroup=function(){Ii.c(this.cw.id)||this.Uu.groups.push(this.cw);this.cw=null};
sb.prototype.endBuildTab=function(){Ii.c(this.Uu.id)||this.gMb.add(this.Uu);this.Uu=null};sb.prototype.Qfa=function(){var I={};this.d1(I);return I};sb.prototype.Y9c=function(I){return I.icon["80"]?I.icon["80"]:I.icon["32"]};sb.prototype.d1=function(I){this.cFa.d1(I)};sb.prototype.yO=function(I){return this.I4.mta(I)};sb.prototype.vqa=function(I,la){this.vjb.bindAction(I,la)};Ll.Object.defineProperties(sb.prototype,{I4:{configurable:!0,enumerable:!0,get:function(){return this.dhb}},sw:{configurable:!0,
enumerable:!0,get:function(){return this.gMb}},Qtc:{configurable:!0,enumerable:!0,get:function(){return null}},vjb:{configurable:!0,enumerable:!0,get:function(){return this.jda}},cFa:{configurable:!0,enumerable:!0,get:function(){return this.uda}}});Object(Md.a)(sb,"OneLineRibbonExtensibilityCreator",null,[88,89]);jc.prototype.r6=function(){for(var I=new lh.a,la=Ol(this.Aga),Va=la.next();!Va.done;Va=la.next())I.add(Va.value.r6());I=eh.e.apply(null,[Ng.a.idb,null].concat(I.toArray()));return eh.e(Ng.a.GROUP,
this.Qta,I)};Ll.Object.defineProperties(jc.prototype,{VIb:{configurable:!0,enumerable:!0,get:function(){return this.Yib},set:function(I){this.Yib=I;this.Qta[Ng.a.z8f]=this.Yib}},Qta:{configurable:!0,enumerable:!0,get:function(){return this.s_d||(this.s_d={})}},Aga:{configurable:!0,enumerable:!0,get:function(){return this.uXd||(this.uXd=new lh.a)}}});Object(Md.a)(jc,"GroupDefinition",null,[]);Db.prototype.r6=function(){for(var I=new lh.a,la=new lh.a,Va=Ol(this.vFd),Kb=Va.next();!Kb.done;Kb=Va.next())I.add(Kb.value.r6());
Va=Ol(this.kJ);for(Kb=Va.next();!Kb.done;Kb=Va.next())la.add(Kb.value.r6());la=this.Lme(Ng.a.TLb,this.cXe,la.toArray());I=this.Lme(Ng.a.cUd,this.PKf,I.toArray());return eh.e(Ng.a.x8f,this.tQa,I,la)};Db.prototype.Lme=function(I,la,Va){var Kb={};Kb[Ng.a.id]=la;return eh.e.apply(null,[I,Kb].concat(Va))};Ll.Object.defineProperties(Db.prototype,{gza:{configurable:!0,enumerable:!0,get:function(){return this._id}},tQa:{configurable:!0,enumerable:!0,get:function(){return this.$$d||(this.$$d={})}},kJ:{configurable:!0,
enumerable:!0,get:function(){return this.t_d||(this.t_d=new lh.a)}},vFd:{configurable:!0,enumerable:!0,get:function(){return this.d9d||(this.d9d=new lh.a)}}});Object(Md.a)(Db,"TabDefinition",null,[]);Hb.prototype.startBuildTab=function(I){I=I.isOfficeTab?this.I4.kEh(I.id):this.I4.Sad(I.id);this.Uu=new Db(I)};Hb.prototype.startBuildGroup=function(I){I=this.yO(I.id);this.cw=new jc(I)};Hb.prototype.addButton=function(I){var la=this.yO(I.id);this.vqa(la,I.action)};Hb.prototype.startBuildMenu=function(){};
Hb.prototype.addMenuItem=function(I){var la=this.yO(I.id);this.vqa(la,I.action)};Hb.prototype.endBuildMenu=function(){};Hb.prototype.endBuildGroup=function(){this.Uu.kJ.add(this.cw);this.cw=null};Hb.prototype.endBuildTab=function(){Ii.c(this.Uu.gza)||this.dae.add(this.Uu);this.Uu=null};Hb.prototype.vqa=function(I,la){this.vjb.bindAction(I,la)};Hb.prototype.yO=function(I){return this.I4.mta(I)};Ll.Object.defineProperties(Hb.prototype,{sw:{configurable:!0,enumerable:!0,get:function(){return null}},
I4:{configurable:!0,enumerable:!0,get:function(){return this.dhb}},vjb:{configurable:!0,enumerable:!0,get:function(){return this.jda}},Qtc:{configurable:!0,enumerable:!0,get:function(){return this.dae}}});Object(Md.a)(Hb,"RibbonExtensibilityCreatorBase",null,[88,89]);Qb.prototype.r6=function(){return eh.k(this.Yig,null,this.c_)};Ll.Object.defineProperties(Qb.prototype,{c_:{configurable:!0,enumerable:!0,get:function(){return this.c9d||(this.c9d={})}}});Object(Md.a)(Qb,"ScalingDefinition",null,[]);
Em(Sa,Hb);Sa.prototype.startBuildTab=function(I){Hb.prototype.startBuildTab.call(this,I);this.Uu.isOfficeTab=I.isOfficeTab;if(!this.Uu.isOfficeTab)this.Uu.tQa[Ng.a.ena]=this.v3b(I.label);else if(this.Uu.gza){var la=this.I4.eCh(I.id);la&&(this.Uu.tQa[Ng.a.ena]=la);(I=this.I4.cCh(I.id))&&(this.Uu.tQa[Ng.a.W7f]=I)}I=this.Uu.gza;this.Uu.PKf=I+"."+Ng.a.cUd;this.Uu.cXe=I+"."+Ng.a.TLb};Sa.prototype.startBuildGroup=function(I){Hb.prototype.startBuildGroup.call(this,I);this.cw.Qta[Ng.a.ena]=this.v3b(I.label)};
Sa.prototype.addButton=function(I){Hb.prototype.addButton.call(this,I);Je.ULS.sendTraceTag(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",I.actionType);var la=this.DS(I,Ng.a.button);this.d1(la.Iz);la.Iz[Ng.a.YRa]=I.enabled;this.cw.Aga.add(la)};Sa.prototype.startBuildMenu=function(I){this.e7=this.DS(I,Ng.a.Y2)};Sa.prototype.addMenuItem=function(I){Hb.prototype.addMenuItem.call(this,I);Je.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",I.actionType);
var la=this.yO(I.id);la=new Lb(la);this.Qfa(la.fQ,I);this.d1(la.fQ);la.fQ[Ng.a.YRa]=I.enabled;this.e7.menuItems.add(la)};Sa.prototype.endBuildMenu=function(){this.cw.Aga.add(this.e7);this.e7=null};Sa.prototype.endBuildGroup=function(){this.CEg();this.Uu.vFd.add(this.yda);this.Bda&&(this.Uu.vFd.add(this.Bda),this.Bda=null);this.yda=null;Hb.prototype.endBuildGroup.call(this)};Sa.prototype.d1=function(I){this.cFa.d1(I)};Sa.prototype.DS=function(I,la){var Va=this.yO(I.id);la=new rc(Va,la);this.Qfa(la.Iz,
I);return la};Sa.prototype.Qfa=function(I,la){I[Ng.a.ULb]=this.v3b(la.label);I[Ng.a.XRa]=this.v3b(la.label);I[Ng.a.ZRa]=la.icon["16"];I[Ng.a.S7f]=la.icon["32"]};Sa.prototype.CEg=function(){var I=this.QMh.VIb;this.cw.VIb=I.Loj;var la=this.cw.Aga.count;Je.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",la);var Va=this.cw.Qta[Ng.a.id];this.yda=new Qb(Ng.a.ZTd);this.yda.c_[Ng.a.id]=Va+".Scaling."+Ng.a.ZTd;this.yda.c_[Ng.a.TTd]=this.cw.Qta[Ng.a.id];2<la&&(this.Bda=new Qb(Ng.a.bUd),this.Bda.c_[Ng.a.id]=
Va+".Scaling."+Ng.a.bUd,this.Bda.c_[Ng.a.TTd]=this.cw.Qta[Ng.a.id]);this.i$i(la,I)};Sa.prototype.i$i=function(I,la){var Va=1;switch(I){case 1:case 2:this.yda.c_[Ng.a.vAa]=Ng.a.LARGE;break;case 3:this.yda.c_[Ng.a.vAa]=Ng.a.LARGE;this.Bda.c_[Ng.a.vAa]=Ng.a.myc;break;case 4:this.yda.c_[Ng.a.vAa]=Ng.a.myc+"TwoRow";this.Bda.c_[Ng.a.vAa]=Ng.a.SMALL+"TwoRow";break;case 5:case 6:this.yda.c_[Ng.a.vAa]=Ng.a.myc;this.Bda.c_[Ng.a.vAa]=Ng.a.SMALL;break;default:throw Je.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",
I),this.qna.setErrorMessageForAddin(this.xMb,CommonUIStrings.l_AddinManifestInvalid_Message),Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",I));}for(var Kb=Ol(this.cw.Aga),nc=Kb.next();!nc.done;nc=Kb.next())nc.value.Iz[Ng.a.A8f]=la.Xwh(Va),Va+=3!==I?1:2};Sa.prototype.v3b=function(I){return I?(I=dd.a.replaceAll(I,"&","&amp;"),I=dd.a.replaceAll(I,"'","&apos;"),I=dd.a.replaceAll(I,'"',"&quot;"),I=dd.a.replaceAll(I,">","&gt;"),I=dd.a.replaceAll(I,"<","&lt;")):
null};Ll.Object.defineProperties(Sa.prototype,{QMh:{configurable:!0,enumerable:!0,get:function(){return this.rdg}},cFa:{configurable:!0,enumerable:!0,get:function(){return this.uda}}});Object(Md.a)(Sa,"RibbonExtensibilityCreator",Hb,[]);Ca.prototype.pme=function(I){I=new Od(I);return new sa(I,this.uda,this.jda)};Ca.prototype.zEg=function(I,la,Va){Va=new Df.a(this.uCa,I,Va,!0);var Kb=new Nc(this.uCa+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new Sa(Va,this.jda,this.uda,Kb,
I,la)};Ca.prototype.lEg=function(I,la,Va,Kb){Va=new Df.a(this.uCa,I,Va,!0);return new sb(Va,this.jda,this.uda,I,la,Kb)};Object(Md.a)(Ca,"UIExtensibilityFactory",null,[63]);var mh=b(933);ua.prototype.uvi=function(){if(this.Oi&&this.RDa){var I=new Fj.a(tf.a.j8,0,0,2,null),la={};this.addinUICommandHandler.executeCommand(0,I,(la.SourceControlId=this.RDa,la),null);Je.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};ua.prototype.Ffj=function(I,la){var Va=this;I=null;if(la)if(I=
la,this.Oi=I.Oi,(this.Kq=I.Kq)&&this.Kq.Zaa&&this.Kq.Zaa.sw&&(this.SDa=this.Kq.Zaa.sw.oa(0)),this.SDa&&this.SDa.id)if(this.SDa.isOfficeTab)if(la=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),this.Oi.assetId in la?this.RDa=la[this.Oi.assetId]:(Je.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,this.Oi.storeId,this.Oi.assetId)),this.RDa=this.uth(this.Kq)),this.RDa)if(th.a.contains(this.SDa.id,
oj.a.lV,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(zd.a.prb(this.Kq),function(){Va.YTf(Va.ead(Va.RDa))});else{if(la=this.$.Ka)la.Eug(Object(qf.a)(this,this.ftf,"onTabSwitched")),Je.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Je.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),la={},la=(la.AppTeachingUICalloutAction="NoEnabledButtonFound",la["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,this.Oi.storeId,
this.Oi.assetId),la.AppTeachingUICalloutGoal="NewAdminDeployment",la["SDX.AppInstallOrigin"]="Organization",la),aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(la)}));else this.$Tf(this.ead(this.SDa.id),0);else Je.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),la={},la=(la.AppTeachingUICalloutAction="NoTabFound",la["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,
this.Oi.storeId,this.Oi.assetId),la.AppTeachingUICalloutGoal="NewAdminDeployment",la["SDX.AppInstallOrigin"]="Organization",la),aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(la)}))};ua.prototype.ftf=function(){if(th.a.contains(this.SDa.id,appChrome.selectors.getSelectedTabId(),!0)){var I=this.$.Ka;I&&I.YVi(Object(qf.a)(this,this.ftf,"onTabSwitched"));this.YTf(this.ead(this.RDa))}};ua.prototype.ead=function(I){return"[id="+
I+"]"};ua.prototype.$Tf=function(I,la){var Va=this;la>$f.AFrameworkApplication.ha.xd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)?(window.clearTimeout(this.bEf),this.ZTf("[data-unique-id='pivotOverflowButton']"),Je.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+I)?this.ZTf(I):this.bEf=window.setTimeout(function(){Va.$Tf(I,la+1)},1E3)};ua.prototype.YTf=function(I){var la=document.querySelector("button[data-unique-id='RightPaddle']");
if(la)I={},I=(I.AppTeachingUICalloutAction="RightPaddlePresent",I["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,this.Oi.storeId,this.Oi.assetId),I.AppTeachingUICalloutGoal="NewAdminDeployment",I["SDX.AppInstallOrigin"]="Organization",I),aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(I)}));else if(la=document.querySelector("button"+I),!la&&(la=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),
!la)){la={};la=(la.AppTeachingUICalloutAction="NoAnchor",la["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,this.Oi.storeId,this.Oi.assetId),la.AppTeachingUICalloutGoal="NewAdminDeployment",la["SDX.AppInstallOrigin"]="Organization",la);aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(la)}));Je.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");return}this.k_f(la,"ShowTeachingUIForAddinButton")};
ua.prototype.ZTf=function(I){I=document.querySelector("button"+I);if(!I&&(I=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!I)){I={};I=(I.AppTeachingUICalloutAction="NoAnchor",I["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,this.Oi.storeId,this.Oi.assetId),I.AppTeachingUICalloutGoal="NewAdminDeployment",I["SDX.AppInstallOrigin"]="Organization",I);aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(I)}));
Je.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");return}this.k_f(I,"ShowTeachingUIForAddinTab")};ua.prototype.k_f=function(I,la){I.setAttribute("lpp-id","latestAddin");var Va=oi.a.instance.oc("Common.ISystemInitiatedFeedback");Va&&I?(Va.execute(function(Kb){Kb.logActivity(la,null)}),I={},I=(I.AppTeachingUICalloutAction="Show",I["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,this.Oi.storeId,this.Oi.assetId),I.AppTeachingUICalloutGoal=
"NewAdminDeployment",I["SDX.AppInstallOrigin"]="Organization",I),aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(I)})),Je.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Je.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),I={},I=(I.AppTeachingUICalloutAction="NoSifFutureObject",I["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Oi.storeType,
this.Oi.storeId,this.Oi.assetId),I.AppTeachingUICalloutGoal="NewAdminDeployment",I["SDX.AppInstallOrigin"]="Organization",I),aj.a.sendTelemetryEvent(Object.assign(new Ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Gd.a.fy(I)})))};ua.prototype.uth=function(I){if(!I)return null;if((I=I.Zaa)&&I.sw&&0<I.sw.count){I=Ol(I.sw);for(var la=I.next();!la.done;la=I.next())if(la=la.value,la.groups&&0<la.groups.length){la=Ol(la.groups);for(var Va=la.next();!Va.done;Va=la.next())if(Va=Va.value,
Va.controls&&0<Va.controls.length){Va=Ol(Va.controls);for(var Kb=Va.next();!Kb.done;Kb=Va.next()){Kb=Kb.value;if(Kb.attributes&&!Kb.controlType&&Kb.enabled)return Kb.id;if(Kb.menuItems)for(var nc=Ol(Kb.menuItems),Mc=nc.next();!Mc.done;Mc=nc.next())if(Mc=Mc.value,Mc.attributes&&Mc.enabled)return Kb.id}}}}return null};Object(Md.a)(ua,"AddinTeachingCalloutHandler",null,[]);var ji=b(1231),ki=b(370),bi=b(9),ai=b(38);$a.prototype.dispose=function(){void 0!==this.Hkb&&null!==this.Hkb&&(this.Hkb.dispose(),
this.Hkb=null);this.se=this.$=null;this.disposed=!0};$a.prototype.bdj=function(I,la){switch(I){case tf.a.j8:I=this.Qcj(la);break;default:I=!1}return I};$a.prototype.Wc=function(){return!1};$a.prototype.executeCommand=function(I,la,Va){var Kb=this;I=wh.TaskExtensions.dm();la=la.command;switch(la){case 843847158:break;case -2025863019:Uj.a.lKd(Va[Mg.a.jvg].toString(),function(){Hi.g(Kb.$).focus()});break;case -1777565636:ji.a.showUILessDialog(Va[Mg.a.Ikb].toString());this.se.Ufj(Va[Mg.a.Ikb].toString());
break;case 1592314317:ji.a.hideUILessDialog(Va[Mg.a.Ikb].toString());this.se.nRh(Va[Mg.a.Ikb].toString());break;case tf.a.j8:I=this.Xbd(Va);break;case tf.a.Bxb:this.hLa(Va);break;case tf.a.kla:this.kla(Va);break;case tf.a.mKd:this.Hkb.osc();break;case tf.a.refreshAddinCommands:this.oPi();break;case 1949669462:this.tfa.VNf(!0);break;case -1014260128:I=this.executeDynamicAddInCommandsAPI(Va);break;default:I=dk.a(la)}return I};$a.prototype.Ec=function(I,la){I=!1;switch(la.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case tf.a.kla:case tf.a.mKd:case tf.a.refreshAddinCommands:case 1949669462:case tf.a.Bxb:case -1014260128:I=
!0;break;case tf.a.j8:I=!$f.AFrameworkApplication.protectedFile}return I};$a.prototype.Yc=function(){return!1};$a.prototype.oPi=function(){if(this.tfa.ind()){this.tfa.nqe();var I=this.f8c();if(I&&0<I.count){I=Ol(I);for(var la=I.next();!la.done;la=I.next()){var Va={};la=(Va.ack1=la.value,Va.ack0=4,Va.ak0=(new Date).getTime(),Va);this.kla(la)}}}};$a.prototype.kla=function(I){var la=this;Je.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
I[Mg.a.oO],I[Mg.a.q8]);this.tfa.q6i();window.setTimeout(function(){if(void 0===la.se||null===la.se)Je.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",ai.a.e2()));else{var Va=new Ib(new fc(la.se.sh),Da.instance,lf.instance);Va.drg(function(Kb,nc){la.hLa(nc.properties)});Va.Ftj(I)}},0)};$a.prototype.hLa=function(I){var la=this;if(!this.disposed){Je.ULS.sendTraceTag(537170655,220,50,
"LaunchOperationType {0}.",I[Mg.a.oO]);try{if(ag.EwaSettings.ka(187)){var Va=I[Mg.a.cWa];if(Va&&0<Va.count){for(var Kb=Va.count,nc=Kb-1;0<=nc;nc--){var Mc=Va.oa(nc);ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Mc.currentStoreType)||Va.remove(Va.oa(nc)):Mc.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&Va.remove(Va.oa(nc))}if(Va.count<Kb){var Yc=Zi.GetServiceTaskFactory.Va(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");
wh.TaskExtensions.Aa(Yc,function(){Yc.result.eg(35,null)},this.$.la,3)}if(!Va.count)return}}if(void 0===this.se||null===this.se)Je.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",ai.a.e2()));else{var Ed=null;Ed=$f.AFrameworkApplication.ha.sa("HostInstallAddInsIsEnabled")?new Oc(this.Kl,this.Fte,new fc(this.se.sh),new Ca(this.$.Jb,tf.a.j8),this.tfa,Da.instance,this.sfa,function(pf,Ze){var cg={};cg.InstanceId=qj.a.create().toString();
cg.PrimaryMarketplace={};cg.PrimaryMarketplace.MarketplaceRef=pf.storeId;cg.PrimaryMarketplace.MarketplaceType=pf.currentStoreType;cg.PrimaryMarketplace.SolutionId=pf.assetId;cg.PrimaryMarketplace.SolutionVersion=pf.appVersion;cg.WebExtensionType=1;la.se.kij(cg,function(){Ze(pf)})}):new Oc(this.Kl,this.Fte,new fc(this.se.sh),new Ca(this.$.Jb,tf.a.j8),this.tfa,Da.instance,this.sfa);Ed.erg(Object(qf.a)(this,this.vvi,"onLaunchAddinCommandsCompleted"));if($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){var re=new ua(this);Ed.Xsg(Object(qf.a)(re,re.uvi,"onLaunchAddinButtonClicked"));Ed.wug(Object(qf.a)(re,re.Ffj,"showCalloutOnAddin"))}this.$.ea.Ba(53).tn&&R.a.get_instance().Om(5,null).continueWith(function(){la.disposed||Ed.E$h(la.$4c,la.$.domElement,I)})}}catch(pf){Je.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",pf.message))}}};$a.prototype.Xbd=function(I){var la=wh.TaskExtensions.dm();I=I[this.Kl.Bga];var Va=this.BVb.kce(I),Kb=new ji.a(this.$,
this.se,Va.ownerAddinInfo,la);return this.eXe(la,I,Va,Kb)};$a.prototype.eXe=function(I,la,Va,Kb){var nc=this;this.BVb.Xbd(la,this.tfa,Kb,new fc(this.se.sh),Va,function(){I=Kb.CPg()},function(){Hi.g(nc.$).focus()});return I};$a.prototype.wAg=function(I){var la=this,Va=wh.TaskExtensions.dm(),Kb=this.se.W2(I.assetId);if(Kb){var nc=this.se.HT(Kb);if(bi.HelperMethods.qy(nc)&&nc.SharedRuntime.State)return}nc=this.BVb.xAg;var Mc=I.assetId in nc?nc[I.assetId]:null;if(Mc){var Yc=this.BVb.kce(Mc),Ed=new ji.a(this.$,
this.se,Yc.ownerAddinInfo,Va);nc=function(pf){if(pf){var Ze={};pf=Ol(pf);for(var cg=pf.next();!cg.done;cg=pf.next())cg=cg.value,Ze[cg[0]]=cg[1];(Ze=Mg.a.Hge in Ze?Ze[Mg.a.Hge]:null)&&"true"===Ze.toLowerCase()&&(Je.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",I.currentStoreType,I.storeId,Telemetry.PrivacyRules.GetAssetId(null!==Yc.ownerAddinInfo?Yc.ownerAddinInfo.storeType:I.currentStoreType,I.storeId,I.assetId)),la.eXe(Va,Mc,
Yc,Ed))}};Je.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",I.currentStoreType,I.storeId,Telemetry.PrivacyRules.GetAssetId(null!==Yc.ownerAddinInfo?Yc.ownerAddinInfo.storeType:I.currentStoreType,I.storeId,I.assetId));if(Kb)nc(this.se.HT(Kb).OsfPropertyBag);else if(Kb=this.$.fa.workbookContext.WebExtensions){Kb=Ol(Kb);for(var re=Kb.next();!re.done;re=Kb.next())if(re=re.value,(1===re.WebExtensionType?OSF.OsfControlTarget.TaskPane:
OSF.OsfControlTarget.InContent)===I.targetType&&re.PrimaryMarketplace.MarketplaceType.toLowerCase()===I.currentStoreType.toLowerCase()&&re.PrimaryMarketplace.MarketplaceRef.toLowerCase()===I.storeId.toLowerCase()&&re.PrimaryMarketplace.SolutionId.toLowerCase()===I.assetId.toLowerCase()){nc(re.OsfPropertyBag);break}}}};$a.prototype.JIb=function(I,la,Va){Va=void 0===Va?!1:Va;th.a.ma(I)||(!Va||la||this.l0c.contains(I)||this.l0c.add(I),(Va=this.wZa.contains(I))&&la&&this.wZa.remove(I),Va||la||this.wZa.add(I))};
$a.prototype.S9i=function(I){var la=I.Zaa;if(la){if(la.sw)for(I=Ol(la.sw),la=I.next();!la.done;la=I.next())if(la=la.value,la.groups){la=Ol(la.groups);for(var Va=la.next();!Va.done;Va=la.next())if(Va=Va.value,Va.controls){var Kb=Ol(Va.controls);for(Va=Kb.next();!Va.done;Va=Kb.next())if(Va=Va.value,this.JIb(Va.id,Va.enabled,!0),1===Va.controlType&&Va.menuItems){var nc=Ol(Va.menuItems);for(Va=nc.next();!Va.done;Va=nc.next())Va=Va.value,this.JIb(Va.id,Va.enabled,!0)}}}}else if(I.tabs)for(I=Ol(I.tabs),
la=I.next();!la.done;la=I.next())if(la=la.value,la.kJ)for(la=Ol(la.kJ),Va=la.next();!Va.done;Va=la.next())if(Va=Va.value,Va.Aga)for(Kb=Ol(Va.Aga),Va=Kb.next();!Va.done;Va=Kb.next())if(Va=Va.value,this.JIb(Va.id,Ng.a.YRa in Va.Iz?Va.Iz[Ng.a.YRa]:!0,!0),Va.controlType===Ng.a.Y2&&Va.menuItems)for(nc=Ol(Va.menuItems),Va=nc.next();!Va.done;Va=nc.next())Va=Va.value,this.JIb(Va.id,Ng.a.YRa in Va.fQ?Va.fQ[Ng.a.YRa]:!0,!0)};$a.prototype.vvi=function(I,la){I=null;la&&(I=la);I&&I.Kq&&this.S9i(I.Kq);this.$.zf();
ag.EwaSettings.ka(87)&&I&&I.Oi&&this.wAg(I.Oi)};$a.prototype.f8c=function(){var I=new lh.a;ag.EwaSettings.ka(53)&&(this.$.fa.$g.get(27)&&(I.add(0),I.add(16)),this.$.fa.$g.get(33)&&I.add(1),I.add(8));return I};$a.prototype.executeDynamicAddInCommandsAPI=function(I){var la=!0;if(void 0===I||null===I||void 0===I[Mg.a.Dpb]||null===I[Mg.a.Dpb])return Gj.Task.Ra(!1);switch(I[Mg.a.Dpb]){case 1:la=this.Awj(I);break;case 2:la=this.W9i(I);break;case 4:this.wZa.clear();this.wZa.addRange(this.l0c);break;case 3:la=
this.installContextualTab(I);break;default:la=!1}return Gj.Task.Ra(la)};$a.prototype.Qcj=function(I){if(!(I&&this.Kl.Bga in I))return!1;I=I[this.Kl.Bga];return th.a.ma(I)?!1:this.wZa.contains(I)};$a.prototype.Awj=function(I){var la=null,Va=null,Kb=null,nc=!0;void 0!==I[Mg.a.E2]&&null!==I[Mg.a.E2]&&void 0!==I[this.Kl.Bga]&&null!==I[this.Kl.Bga]&&void 0!==I[Mg.a.D2]&&null!==I[Mg.a.D2]&&(la=I[Mg.a.E2],Va=I[Mg.a.c3b],Kb=I[this.Kl.Bga],nc=I[Mg.a.D2]);if(th.a.ma(la)||th.a.ma(Kb))return Je.ULS.sendTraceTag(537170649,
220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;I=(new Df.a(this.$.Jb,la,this.Kl,!0)).mta(Kb);la={DynamicAddinCommandsApiName:"UpdateControlEnableState"};la.AssetId=Va;la.MaskedTabId=I;la.IsToEnable=nc;Je.ULS.sendTraceTag(537170648,220,15,Gi.a.Hc(la));this.JIb(I,nc);ki.a.Nx.updateCommandUI();return!0};$a.prototype.W9i=function(I){var la=null,Va=null,Kb=null,nc=null,Mc=!0;void 0!==I[Mg.a.R1c]&&null!==I[Mg.a.R1c]&&void 0!==I[Mg.a.E2]&&null!==I[Mg.a.E2]&&void 0!==I[this.Kl.Bga]&&
null!==I[this.Kl.Bga]&&void 0!==I[Mg.a.D2]&&null!==I[Mg.a.D2]&&(la=I[Mg.a.R1c],Va=I[Mg.a.E2],Kb=I[Mg.a.c3b],nc=I[this.Kl.Bga],Mc=I[Mg.a.D2]);if(th.a.ma(la)||th.a.ma(Va)||th.a.ma(nc))return Je.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;I=(new Df.a(this.$.Jb,Va,this.Kl,!0)).Sad(nc);nc={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};nc.StoreType=la;nc.AssetId=Kb;nc.MaskedTabId=I;nc.IsToShow=Mc;Je.ULS.sendTraceTag(537170646,220,15,Gi.a.Hc(nc));
Va=this.tfa.sP(la,Va,1);la=!1;if(Va&&Va.Kq&&Va.Kq.Zaa&&Va.Kq.Zaa.sw)for(Va=Ol(Va.Kq.Zaa.sw),Kb=Va.next();!Kb.done;Kb=Va.next())if(Kb.value.id===I){la=!0;break}if(!la)return Je.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;la=[];Mc?appChrome.selectors.getSelectedTabId()!==I&&la.push(appChrome.actions.activateRibbonTab(I)):(appChrome.selectors.getSelectedTabId()===I&&la.push(appChrome.actions.setCurrentTab(oj.a.lV)),la.push(appChrome.actions.deactivateRibbonTab(I)));
appChrome.api.dispatch(la);return!0};$a.prototype.installContextualTab=function(I){var la=null,Va=null,Kb=null,nc=null;if(void 0!==I[Mg.a.E2]&&null!==I[Mg.a.E2]&&void 0!==I[Mg.a.D2]&&null!==I[Mg.a.D2]){var Mc=I[Mg.a.D2];la=I[Mg.a.E2];void 0!==Mc[Mg.a.GGa]&&null!==Mc[Mg.a.GGa]&&void 0!==Mc[Mg.a.HGa]&&null!==Mc[Mg.a.HGa]&&(Va=Mc[Mg.a.GGa],Kb=Mc[Mg.a.HGa],nc=Mc[Mg.a.S1c])}if(th.a.ma(la)||!Kb||!Va||!nc)return Je.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;
if((I=this.tfa.sP(nc.PrimaryMarketplace.MarketplaceType,nc.PrimaryMarketplace.SolutionId,1))&&I.Kq)return Je.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;I={};ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(I.solutionId=nc.PrimaryMarketplace.SolutionId,I.version=nc.PrimaryMarketplace.SolutionVersion,I.storeType=nc.PrimaryMarketplace.MarketplaceType,I.storeId=nc.PrimaryMarketplace.MarketplaceRef,I.assetId=
nc.PrimaryMarketplace.SolutionId,I.assetStoreId=nc.PrimaryMarketplace.MarketplaceRef,I.targetType=nc.WebExtensionOsfControlType,I.width=nc.TaskpaneWidth,I.height=0,I.isAddinCommands=!0,I.id=I.assetId,I.appVersion=nc.PrimaryMarketplace.SolutionVersion,I.currentStoreType=nc.PrimaryMarketplace.MarketplaceType):(I.appVersion=nc.PrimaryMarketplace.SolutionVersion,I.assetId=nc.PrimaryMarketplace.SolutionId,I.assetStoreId=nc.PrimaryMarketplace.MarketplaceRef,I.currentStoreType=nc.PrimaryMarketplace.MarketplaceType,
I.id=I.assetId,I.storeId=I.assetStoreId,I.targetType=nc.WebExtensionOsfControlType,I.width=nc.TaskpaneWidth,I.height=0,I.isAddinCommands=!0);nc=new lh.a;nc.add(I);I={};I[Mg.a.cWa]=nc;I[Mg.a.oO]=6;I[Mg.a.GGa]=Va;I[Mg.a.HGa]=Kb;this.hLa(I);return!0};Object(Md.a)($a,"AddinUICommandHandler",null,[161,160,6]);var Dh=b(69);Ua.prototype.oJd=function(){return this.pJd()};Ua.prototype.activate=function(){return this.QNc()};Ua.prototype.deactivate=function(){this.b0c()};Ua.prototype.dispose=function(){this.b0c=
this.QNc=this.pJd=null};Object(Md.a)(Ua,"FeatureActivator",null,[66,6]);var fh=b(21),li=b(19),sh=cj.a;Em(Jb,sh);Jb.prototype.Gd=function(){var I=this;Je.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Dh.a(this.$).add(Object.assign(new Ua,{pJd:function(){var la=I.$.fa.fE&&I.$.fa.lc&&!!(I.$.zd&16384)&&I.$.isEditMode;I.$.fa.lc&&Je.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",
la,I.$.fa.fE,I.$.fa.lc,!!(I.$.zd&16384),I.$.isEditMode);return la},QNc:Object(qf.a)(this,this.dng,"activateFeature"),b0c:Object(qf.a)(this,this.G_g,"deactivateFeature"),Q4b:2}))};Jb.prototype.dng=function(){var I=this;Je.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",this.$.isEditMode,!!(this.$.zd&16384));var la=new sj.a;this.$.ea.$a(53,function(pf){Je.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
la.setResult(pf)});var Va=la.task,Kb=new Ve,nc=Rj.a.getInstance(),Mc=new hd(this.$,nc),Yc=Zi.GetServiceTaskFactory.create(this.$.ea,203,this.la,this.rb,"System.IDisposable"),Ed=this.VPi(Kb),re=Zi.GetServiceTaskFactory.Va(this.$.ea,349,350,this.rb,"Microsoft.Office.Excel.WebUI.Client.OAuth.IOAuthManagerWrapper");return wh.TaskExtensions.Aa(wh.TaskExtensions.xe([Va,Yc,Ed,re],this.la),function(){Je.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.create(I.$.ea,106,I.la,I.rb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),function(pf){I.handler=new $a(I.$,pf.result,Kb,new ee,nc,Mc,oi.a.instance.Mh("Common.IExternalUICommandDefinitionMapping"));Je.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");I.Ad([I.handler]);I.$.ea.Ia(198,I.handler)},I.la,3)},this.la,3)};Jb.prototype.G_g=function(){void 0!==this.handler&&null!==this.handler?
(this.$.Ka.O8a(this.handler),this.$.ea.cP(198),this.handler=null):Je.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.ea.cP(204);li.a(2,fh.a,21,this.$.ea,198,"Microsoft.Office.Excel.WebUI.Client.IServiceFactory<Microsoft.Office.Excel.WebUI.Client.ICommandHandler>")};Jb.prototype.VPi=function(I){var la=this,Va=Zi.GetServiceTaskFactory.create(this.$.ea,102,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager");
return wh.TaskExtensions.Aa(Va,function(){Je.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");la.$.ea.Ia(204,new Wd(Va.result,I))},this.la,3)};Jb.ja=function(I){cj.a.Yd(199,new Jb(I))};Object(Md.a)(Jb,"AddinUICommandHandlerFactory",cj.a,[]);var Rh=b(1220),Di=b(1222),Oi=Ji.a;Em(ic,Oi);ic.prototype.create=function(){var I=this,la;if(ag.EwaSettings.ka(416)){var Va=Zi.GetServiceTaskFactory.create(this.$.ea,106,this.$.la,
this.rb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),Kb=Zi.GetServiceTaskFactory.create(this.$.ea,396,this.$.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IndexedDB.IIndexedDB");wh.TaskExtensions.Aa(Gj.Task.WAA(Va,Kb),function(){I.Eb(I.$.ea.Ba(278)||new Rh.CustomFunctionsInstaller(I.$,Va.result,Kb.result))},this.$.la,3)}else(la=this.$.ea.Ba(278))||(la=this.$.ea.Ia(278,new Di.CustomFunctionsLegacyInstaller(this.$))),this.Eb(la)};ic.ja=function(I){I.ea.Ia(279,new ic(I))};Object(Md.a)(ic,
"CustomFunctionsInstallerFactory",Ji.a,[]);var Sh=b(86),ei=b(43),yi=b(42);wb.prototype.ja=function(I){this.MRc?Je.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.MRc=!0,this.DNa={},this.ENa={},I?I.Qrg(Object(qf.a)(this,this.o_f,"triggerReadout")):Je.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};wb.prototype.detach=function(I){if(I){I.KTi(Object(qf.a)(this,this.o_f,"triggerReadout"));
I=this.DNa;for(var la in I)Sh.a.Fa(I[la]);this.ENa=this.DNa=null;this.MRc=!1}else Je.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};wb.prototype.o_f=function(I,la){var Va=this,Kb=null,nc=null,Mc=null;la?(Object(Kh.a)(237,la)?(Kb=la.XDa,Mc=la.instanceId):Object(Kh.a)(402,la)&&(Kb=la.get_element(),Mc=la.instanceId),Kb)?(nc=Object(qi.a)(431,I),nc)?this.JBf(Mc,Kb,nc)||Mc in this.DNa||(this.ENa[Mc]=0,this.DNa[Mc]=ei.a.instance.AB(function(){10<=
Va.ENa[Mc]||Va.JBf(Mc,Kb,nc)?(delete Va.ENa[Mc],Va.DNa[Mc].dispose(),delete Va.DNa[Mc]):Va.ENa[Mc]+=1},500,yi.a.Yvg,!0,!1)):Je.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Je.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):Je.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};wb.prototype.JBf=function(I,la,Va){if(this.UZh(Va,I))return!1;I=la.querySelector("iframe");
if(!I)return Je.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;I=I.title;if(!I||!I.length)return Je.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(I);return!0};wb.prototype.UZh=function(I,la){return(I=I.sh.getOsfControl(la))?I.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(Md.a)(wb,"AgaveOnSelectedReadoutHandler",null,[432]);var Si=
Ji.a;Em(qb,Si);qb.prototype.create=function(){var I=this,la=this.$.ea;wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.Va(la,211,212,this.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),function(Va){Va=la.Ba(224)||new wb(Va.result,I.$);I.Eb(Va)},this.la,3)};qb.ja=function(I){I.ea.Ia(225,new qb(I))};Object(Md.a)(qb,"AgaveOnSelectedReadoutHandlerFactory",Ji.a,[]);var Uh=b(843),pj=b(231);Aa.prototype.eYe=function(I){try{if(I&&I.rawEvent&&I.rawEvent.origin&&this.iframe&&this.iframe.id){var la=
this.Cvf(I.rawEvent.origin),Va=this.Cvf(document.domain);if(Lj.a.rl().equals(Va,la))if(I.rawEvent.source&&I.rawEvent.source.frameElement&&I.rawEvent.source.frameElement.id&&Lj.a.rl().equals(I.rawEvent.source.frameElement.id,this.iframe.id)){la=null;try{la=JSON.parse(I.rawEvent.data)}catch(Kb){Je.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Kb.message)}la?(la.statusCode!==pj.a.JN||void 0!==
la.error&&la.error?(Je.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",la.statusCode,la.error),this.onError()):(Je.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(la.authorizationCode?la.authorizationCode:la.signInUrl)),$removeHandler(window,"message",Object(qf.a)(this,this.eYe,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):
Je.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):Je.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Je.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Je.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else Je.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Je.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Kb){Je.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Kb.message)}};Aa.prototype.Cvf=function(I){var la="";try{I&&(la=-1<I.indexOf("//")?I.split("/")[2]:I.split("/")[0])&&(la=la.split(":")[0],la=la.split("?")[0])}catch(Va){Je.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Va.message)}return la};Aa.ja=function(I,la,Va){new Aa(I,la,Va)};Object(Md.a)(Aa,
"ResponseHandler",null,[]);var hi=b(279);Zb.prototype.tryAuthenticate=function(I,la){this.B7a(Zb.Qdg,function(){I()},la)};Zb.prototype.tryAuthorize=function(I,la){this.B7a(Zb.a$f,I,la)};Zb.prototype.getSignInUrl=function(I,la){this.B7a(Zb.m$d,I,la)};Zb.prototype.signOut=function(I,la){this.B7a(Zb.Wjg,I,la)};Zb.prototype.B7a=function(I,la,Va){var Kb=new hi.QueryStringBuilder("AuthenticationProxyHandler.aspx");Kb.Xj("responseType",I);$f.AFrameworkApplication.Ujb(Kb);Kb=String.format("{0}{1}&{2}",this.rDa,
Kb.toString(),$f.AFrameworkApplication.Xi);var nc=document.createElement("iframe");nc.setAttribute("id","privateCatalogIframe");nc.setAttribute("name","privateCatalogIframe");nc.setAttribute("style","display: none");Lj.a.rl().equals(I,Zb.m$d)||nc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Aa.ja(nc,la,Va);nc.setAttribute("src",Kb);document.body.appendChild(nc)};Zb.a$f="authcode";Zb.Qdg="identitytoken";Zb.m$d="signinurl";Zb.Wjg="signout";Object(Md.a)(Zb,
"AuthenticationProxy",null,[]);cc.getUserId="getUserId";cc.getLastStoreUpdate="laststoreupdate";cc.getEntitlement="getEntitlements";cc.getEToken="getEToken";cc.getManifest="getManifest";cc.getAppState="getAppState";cc.getKilledApps="getRemovedAddins";cc.getAppDetails="getAppDetails";cc.removeApps="removeAddin";cc.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";cc.getPrivateCatalogAddIns="getAddIns";cc.getPrivateCatalogManifests="getAppManifests";cc.isStoreDisabled="isStoreDisabled";Object(Md.a)(cc,
"S2SWebRequestActions",null,[]);var Vh=b(590);tc.prototype.getUserId=function(I,la){var Va=new lh.a;Va.add(new va.a("corr",I));this.NV(cc.getUserId,Va,1,la)};tc.prototype.getLastStoreUpdate=function(I,la,Va){var Kb=new lh.a;Kb.add(new va.a("lc",I));Kb.add(new va.a("corr",la));this.NV(cc.getLastStoreUpdate,Kb,1,Va)};tc.prototype.getEntitlement=function(I,la,Va,Kb){I=new lh.a;I.add(new va.a("av",la));I.add(new va.a("corr",Va));this.NV(cc.getEntitlement,I,1,Kb)};tc.prototype.getEToken=function(I,la,
Va,Kb,nc,Mc){var Yc=new lh.a;Yc.add(new va.a("cmu",I));Yc.add(new va.a("cmf",la));Yc.add(new va.a("assetid",Va));Yc.add(new va.a("expver",Kb));Yc.add(new va.a("corr",nc));this.NV(cc.getEToken,Yc,1,Mc)};tc.prototype.getManifest=function(I,la,Va,Kb){var nc=new lh.a;nc.add(new va.a("cmu",I));nc.add(new va.a("assetid",la));nc.add(new va.a("corr",Va));this.NV(cc.getManifest,nc,1,Kb)};tc.prototype.getAppState=function(I,la,Va){var Kb=new lh.a;Kb.add(new va.a("ma",I));Kb.add(new va.a("corr",la));this.NV(cc.getAppState,
Kb,1,Va)};tc.prototype.getKilledApps=function(I,la){var Va=new lh.a;Va.add(new va.a("corr",I));this.NV(cc.getKilledApps,Va,1,la)};tc.prototype.getAppDetails=function(I,la,Va,Kb){var nc=new lh.a;nc.add(new va.a("cmo",I));nc.add(new va.a("corr",Va));this.g$a(cc.getAppDetails,nc,la,2,Kb,!1)};tc.prototype.removeApps=function(I,la,Va){var Kb=new lh.a;Kb.add(new va.a("corr",la));this.g$a(cc.removeApps,Kb,I,2,Va,!1)};tc.prototype.getLastPrivateCatalogUpdate=function(I,la,Va,Kb,nc,Mc){var Yc=new lh.a;Yc.add(new va.a("catalog",
"privatecatalog"));Yc.add(new va.a("clientCode",I));Yc.add(new va.a("clientVersion",la));Yc.add(new va.a("corr",nc));I=String.format("authorizationCode={0}&refreshToken={1}",Va?dd.a.ff(Va):"",Kb?dd.a.ff(Kb):"");this.g$a(cc.getLastPrivateCatalogUpdate,Yc,I,2,Mc,!0)};tc.prototype.getPrivateCatalogAddIns=function(I,la,Va,Kb,nc,Mc){var Yc=new lh.a;Yc.add(new va.a("catalog","privatecatalog"));Yc.add(new va.a("clientCode",I));Yc.add(new va.a("clientVersion",la));Yc.add(new va.a("corr",nc));I=String.format("authorizationCode={0}&refreshToken={1}",
Va?dd.a.ff(Va):"",Kb?dd.a.ff(Kb):"");this.g$a(cc.getPrivateCatalogAddIns,Yc,I,2,Mc,!0)};tc.prototype.getPrivateCatalogManifests=function(I,la,Va,Kb,nc){var Mc=new lh.a;Mc.add(new va.a("catalog","privatecatalog"));Mc.add(new va.a("corr",Kb));I=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",dd.a.ff(I),la?dd.a.ff(la):"",Va?dd.a.ff(Va):"");this.g$a(cc.getPrivateCatalogManifests,Mc,I,2,nc,!0)};tc.prototype.isStoreDisabled=function(I,la){var Va=new lh.a;Va.add(new va.a("corr",I));
this.NV(cc.isStoreDisabled,Va,2,la)};tc.prototype.NV=function(I,la,Va,Kb){this.g$a(I,la,null,Va,Kb,!1)};tc.prototype.g$a=function(I,la,Va,Kb,nc,Mc){var Yc=new hi.QueryStringBuilder("AddinServiceHandler.ashx");Yc.Xj("action",I);Yc.Xj("app",Vh.a[$f.AFrameworkApplication.xa.Xa.Tk]);la=Ol(la);for(var Ed=la.next();!Ed.done;Ed=la.next())Ed=Ed.value,Yc.Xj(Ed.key,Ed.value);Yc=String.format("{0}{1}&{2}",$f.AFrameworkApplication.xa.Xa.vZ,Yc.toString(),$f.AFrameworkApplication.Xi);$f.AFrameworkApplication.Cd.Jl(Yc,
Kb,Va,null,!1,2,function(re){var pf=null;re&&re.data&&(re.data.responseHeaders["X-BlockedForMinor"]&&"1"===re.data.responseHeaders["X-BlockedForMinor"].toString()&&(re.data.httpStatus=451),pf=re.data.ae);nc(re.data.httpStatus,pf)},function(re){var pf=null;Mc&&re&&re.data&&re.data.ae&&(pf=re.data.ae);nc(re.data.httpStatus,pf);if($f.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){pf={message:"AddinServiceHandler request failed"};pf.code=
re.data.httpStatus;pf.action=I;if(re.data.request||re.data.request.get_headers())pf["X-UserSessionId"]=re.data.request.get_headers()["X-UserSessionId"];408===re.data.httpStatus||503===re.data.httpStatus?Je.ULS.sendTraceTag(538784582,220,10,JSON.stringify(pf)):Je.ULS.sendTraceTag(18392345,220,50,JSON.stringify(pf))}else Je.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",re.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+I)};Object(Md.a)(tc,"S2SWebRequestManager",
null,[]);var zh=Ji.a;Em(Ec,zh);Ec.prototype.create=function(){var I=this;Je.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");$f.AFrameworkApplication.disableWholeAppsForOfficeFeature?Je.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",$f.AFrameworkApplication.disableWholeAppsForOfficeFeature):ag.EwaSettings.ka(421)?oi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(la){la.isFeatureEnabled("mso_officeStore",
!0).then(function(Va){Uh.DdaFacade.XXc=Va;I.Ive();return null})}):this.Ive()};Ec.prototype.Ive=function(){var I=this,la=Zi.GetServiceTaskFactory.Va(this.$.ea,224,225,this.rb,"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveOnSelectedReadoutHandler"),Va=Jf.a.dnd(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.rb,106),Kb=Ia(this.la,this.rb);wh.TaskExtensions.Aa(wh.TaskExtensions.xe([la,Va,Kb],this.$.la),function(){"undefined"===typeof OfficeExt||
"undefined"===typeof OSF?Je.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",ai.a.e2()):I.KUh();Je.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");I.IBf=la.result;I.Eb(I.se);Je.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Ec.prototype.KUh=function(){ag.EwaSettings.ka(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new tc);
this.$.Qf.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new tc,new Zb($f.AFrameworkApplication.ha.appSettings.WebServiceBase),ag.EwaSettings.ka(71),ag.EwaSettings.ka(452))};Ec.prototype.dispose=function(){Sh.a.Fa(this.ddaFacade);this.$=this.ddaFacade=null;zh.prototype.dispose.call(this)};Ec.ja=function(I){new Ec(I)};Ll.Object.defineProperties(Ec.prototype,{se:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new Uh.DdaFacade(this.$,this.IBf))}}});Object(Md.a)(Ec,
"DdaFacadeServiceFactory",Ji.a,[]);lc.prototype.Yc=function(){return!1};lc.prototype.Wc=function(){return!1};lc.prototype.Ec=function(I,la,Va,Kb){var nc=!1;switch(la.command){case -684355545:nc=!0;break;case -741808261:nc=!!Va;break;case -859308420:nc=!!Kb&&1===Kb.Ez;break;case 418618014:nc=1===I&&!!Kb&&1===Kb.Ez;break;case -515602470:la=ag.EwaSettings.ka(237)&&2===I;nc=(1===I||la)&&!!Kb&&1===Kb.Ez;break;case 2086613372:nc=ag.EwaSettings.ka(237)&&2===I&&!!Kb&&1===Kb.Ez;break;case -1336341324:nc=ag.EwaSettings.ka(506)&&
1===I&&!!Kb&&1===Kb.Ez;break;case -1444574190:case -336193495:nc=1===I&&!!Kb&&1===Kb.Ez;break;case 1296389134:nc=1===I&&!!Kb&&1===Kb.Ez;break;case 1221897806:nc=ag.EwaSettings.ka(167)&&2===I;break;case -1753056834:nc=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:nc=!0;break;case 301511274:nc=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:nc=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!1)&&this.$.isEditMode;break;case 1723441034:nc=this.$.fa.ZGb}return nc};lc.prototype.executeCommand=function(I,la,Va){var Kb=wh.TaskExtensions.dm(),nc=la.command;switch(la.command){case 1296389134:this.agaveCommandManager.hlj(Va.SourceControlId,Va.LabelText);break;case -684355545:this.agaveCommandManager.jUc();break;case -741808261:Kb=this.agaveCommandManager.insertAgave(Va,la);break;case -1336341324:ag.EwaSettings.ka(506)&&(Kb=this.agaveCommandManager.FXe(Va,I,la));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 418618014:case 1221897806:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:Kb=
this.agaveCommandManager.FXe(Va,I,la);break;default:Kb=dk.a(nc)}return Kb};Object(Md.a)(lc,"AgaveCommandHandler",null,[160]);Object(Md.a)(P,"Selection",null,[]);Object(Md.a)(uc,"SmartLookupApplicationInterface",null,[]);Object(Md.a)(zb,"ApplicationProperties",null,[]);Object(Md.a)(oc,"EnterpriseUserInfo",null,[]);Object(Md.a)(Yb,"FeatureGates",null,[]);Ra.prototype.lIh=function(){var I=void 0===I?!0:I;var la=this.Kxe();if(la<this.vod+this.Qqj)return la>this.vod+this.Tqj&&this.$7c(),this.Hdf;I&&this.$7c();
return""};Ra.prototype.$7c=function(){var I=this;this.zod=this.zod||new Promise(function(la){I.mIh().then(function(Va){I.Hdf=Va;I.vod=I.Kxe();I.zod=null;la(Va)})})};Ra.prototype.mIh=function(){var I=this;return this.s5a&&this.s5a.length?new Promise(function(la){I.Ova.aR("SmartLookup",I.s5a).then(function(Va){Va.IsSuccess?Va.Token||(la(""),Je.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Je.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Va.ErrorCode+": "+Va.ErrorMessage),la(""));la(Va.Token)}).catch(function(Va){Va=yh.c(Va);Je.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Va);la("")})}):(Je.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(Md.a)(Ra,"SmartLookupAuthenticationManager",null,[452]);Wa.azh=function(){switch(Object(qi.a)(String,$f.AFrameworkApplication.Fb.AudienceGroup)||""){case "Dogfood":if($f.AFrameworkApplication.ha){var I=
$f.AFrameworkApplication.ha.Ta("UserPrincipalName");I=dd.a.$m(I);var la=$f.AFrameworkApplication.ha.Yx("SmartLookupINTEnabledForSKITeam")?$f.AFrameworkApplication.ha.Uw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(la,I)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};Wa.OHh=function(){switch($f.AFrameworkApplication.ha.sa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":$f.AFrameworkApplication.ha.sa("IntentSvcEnableProdSourceLocationOverride")?"PROD":$f.AFrameworkApplication.ha.sa("IntentSvcEnableIntSourceLocationOverride")?
"INT":Wa.azh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(Md.a)(Wa,"Utils",null,[]);var pi=b(78),Ei=b(575);lb.prototype.Xth=function(){return Promise.resolve(this.Yth())};lb.prototype.Yth=function(){var I=new zb;I.anid="";I.applicationVersion=$f.AFrameworkApplication.buildVersion;
I.appCorrelationId=Ci.a.create().toString();I.themePlatform=lb.qCj;I.lcid=$f.AFrameworkApplication.lcid;I.launchUtcTime=(new Date).toUTCString();I.featureGates=this.r5a;var la=Ei.a.eJ($f.AFrameworkApplication.lcid);la=la?la.name:null;I.market=this.l7b(la);I.uiLanguage=la;I.sessionId=$f.AFrameworkApplication.userSessionId;I.themeId=0;I.parentalControl=lb.$Di;var Va=new oc;Va.CountryCode=this.l7b(la);Va.ServiceEndpoint=this.s5a;Va.IsGoLocal=!1;Va.IsEnabled=this.fef;Va.IsEnterpriseEnabled=this.fef;Va.TenantRoot=
this.mfi;I.enterpriseUserInfo=Va;I.accessToken=this.hfi.lIh();return I};lb.prototype.l7b=function(I){I=I.split("-");return I[I.length-1]};Ll.Object.defineProperties(lb.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.Oei}}});lb.qCj="web";lb.$Di="yes";Object(Md.a)(lb,"SmartLookupManager",null,[447]);var Wi=jj.a;Em(ha,Wi);ha.prototype.Yc=function(){return!1};ha.prototype.Wc=function(){return!1};ha.prototype.Ec=function(I,la){I=ag.EwaSettings.ka(135);return-983891024===
la.command&&I};ha.prototype.executeCommand=function(I,la){I=wh.TaskExtensions.dm();-983891024===la.command&&this.o$h();return I};ha.prototype.o$h=function(){var I=this,la=new lb(null),Va={},Kb=Hi.g(this.$).tc(null).originalText;Kb=Object.assign(new P,{neighborhood:Kb,mentionStart:0,mentionLength:Kb?Kb.length:0});var nc=Object.assign(new uc,{selection:Kb,entryPoint:0});la.Xth().then(function(Yc){Yc.applicationName=ha.appName;Yc.isFirstLaunch=I.isFirstLaunch;Yc.themeId=5;Va[ha.smartLookupApplicationInterface]=
JSON.stringify(nc);Va[ha.cxg]=JSON.stringify(Yc);I.isFirstLaunch=!1});la=new rj.a("ExcelOnline","Web","en-Us");Kb=new ah.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Mc=new Qi.a;Mc.Ri[Nb.el]=Gf.a.instance.da(1734);Mc.Ri[Nb.taskPaneWidth]=350;Mc.Ri[Nb.sourceLocationOverrideResourceId]="WAC.PROD.URL";Mc.gr=Va;Yg.a.instance.iLa(Kb,"Taskpane","SmartLookupSDXTaskpane",la,Mc)};ha.cxg="AppProperties";ha.appName="Excel";ha.smartLookupApplicationInterface="SmartLookupApplicationInterface";
Object(Md.a)(ha,"SmartLookupCommandHandler",jj.a,[160]);var kj=cj.a;Em(Tb,kj);Tb.prototype.Gd=function(){var I=this;Nj.a(this.$,374,375,this.rb,function(la){I.Ad([new lc(I.$,null,null,null,null,la),new ha(I.$)])},"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveCommandManager")};Tb.ja=function(I){cj.a.Yd(76,new Tb(I))};Object(Md.a)(Tb,"AgaveCommandHandlerFactory",cj.a,[]);Object(Md.a)(function(){},"AppInfoDetail",null,[]);b(1064);Object(Md.a)(function(){},"AppsForOfficeUtils",null,[]);Object(Md.a)(kb,
"AppsDataManager",null,[464]);var zj=b(1276),Hj=b(108);Na.prototype.initialize=function(I){Na.initialized||(this.se=I,this.Lg(),Na.initialized=!0)};Na.prototype.Lg=function(){$f.AFrameworkApplication.Hb.Af(tf.a.Pyd,Hj.a.frame,Object(qf.a)(this,this.Pyd,"queryEntitledAppsForOffice"),96);$f.AFrameworkApplication.Hb.Xb(tf.a.MPi,Hj.a.frame,Object(qf.a)(this,this.PQi,"registerOsfControlInsertedEvent"))};Na.prototype.Pyd=function(I,la,Va,Kb,nc){if(2===Va){I=nc?nc:{};la=I.callback;if(!la)return 16;this.se.Oyd(la,
I.refresh?I.refresh:!1)}return 32};Na.prototype.PQi=function(I,la,Va,Kb,nc){2===Va&&(I=nc?nc.callback:null)&&this.se.Prg(I);return 32};Ll.Object.defineProperties(Na,{instance:{configurable:!0,enumerable:!0,get:function(){Na.Ma||(Na.Ma=new Na);return Na.Ma}}});Na.Ma=null;Na.initialized=!1;Object(Md.a)(Na,"AgaveCommandActor",null,[]);var hj=b(349),uk=b(346),hk=b(1246),ij=b(110),uj=b(336);Object(Md.a)(db,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(Md.a)(eb,"IdeasSelectionContext",null,[]);Em(Fa,
eb);Object(Md.a)(Fa,"IdeasTableSelectionContext",eb,[]);var ui=b(60),Ok=b(153),Vk=b(581),Zk=b(127),Pk=b(140),vk=b(170),Ck=Pk.a;Em(Ga,Ck);Ga.prototype.qC=function(){Ck.prototype.qC.call(this);this.Qo.style.width=this.EVd;this.Qo.style.height=this.CSa;this.Qo.style.marginTop=this.gNb;this.Qo.style.padding=this.DSa};Ga.prototype.zNa=function(){this.Qo.style.width=this.EVd;this.Qo.style.height=this.CSa;this.Qo.style.marginTop=this.gNb;this.Qo.style.padding=this.DSa;this.iBa>vk.a.n7a?(this.Lb.style.width=
String.format("{0}px",vk.a.n7a),this.Lb.style.overflowX="scroll",$f.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left="0"):(this.Lb.style.width=String.format("{0}px",this.iBa),this.Lb.style.overflowX="hidden");this.Lb.offsetHeight>vk.a.m7a||this.zbg+50>vk.a.m7a?(this.Lb.style.height=String.format("{0}px",vk.a.m7a),this.Lb.style.overflowY="scroll",this.Lb.style.top="0",$f.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left="0",this.eCc||(this.Lb.style.marginTop=
"-48px"),this.Qo.style.minHeight=String.format("{0}px",this.p$f)):(this.Lb.style.overflowY="hidden",this.Lb.style.top="10%",this.Lb.style.height=this.Neb);this.NXa()};Ga.prototype.NXa=function(){if(this.Lb){var I=this.Lb.style.zIndex;this.Lb.style.zIndex="-9999";if(this.iBa>vk.a.n7a)$f.AFrameworkApplication.isRtl?this.Lb.style.marginRight="0":this.Lb.style.marginLeft="0";else{var la=String.format("{0}px",Math.floor(-this.Lb.offsetWidth/2));$f.AFrameworkApplication.isRtl?this.Lb.style.marginRight=
la:this.Lb.style.marginLeft=la;$f.AFrameworkApplication.isRtl?this.Lb.style.right="50%":this.Lb.style.left="50%"}this.Lb.style.zIndex=String(I)}else Je.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};Ga.prototype.mN=function(){Ck.prototype.mN.call(this);var I=document.getElementById(this.Yh(this.ybg));I.style.width=String.format("{0}px",this.iBa);I.style.height=this.Neb};Ll.Object.defineProperties(Ga.prototype,{kGa:{configurable:!0,enumerable:!0,get:function(){return this.Qo}}});
Object(Md.a)(Ga,"AppsForOfficeInsertionDialog",Pk.a,[449]);var ik=b(1085),Wk=jj.a;Em(Ha,Wk);Ha.prototype.Isg=function(I){this.addHandler(Ha.nvd,I)};Ha.prototype.uUi=function(I){this.removeHandler(Ha.nvd,I)};Ha.prototype.dispose=function(){Sh.a.Fa(this.uua);this.uua=null;Wk.prototype.dispose.call(this)};Ha.prototype.jUc=function(){this.uua.hide()};Ha.prototype.hlj=function(I,la){if(I){this.raiseEvent(Ha.nvd);var Va=I.split("|");this.hdi(I,la,Va);this.uua=new Ga;this.uua.initializeAndShow("",null,null);
this.se.G$h(this.uua.kGa,Va)}};Ha.prototype.FXe=function(I,la,Va){var Kb=wh.TaskExtensions.dm();if(-515602470===Va.command||-336193495===Va.command||2086613372===Va.command||-1444574190===Va.command||-1336341324===Va.command)Kb=this.VNh(I,la,Va);418618014===Va.command&&(la=new Cj.a,la.el=Gf.a.instance.da(1745),Kb=this.q_(Va,Ha.$Qh,la,!0));if((Va.tabName===this.$.Jb+oj.a.WIf||Va.tabName===oj.a.AQ)&&2===Va.Ze||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),I[wi.a.Md])||
I[wi.a.Md]===oj.a.AY)return this.OXe(I,Va);if(7===Va.Ze&&I.SourceControlId===this.$.Jb+oj.a.f9b)return I.MenuItemId=oj.a.Pzd,this.OXe(I,Va);1221897806===Va.command&&(Kb=this.Lfj(Va));-1753056834===Va.command&&(Kb=this.Ugj(Va));932597253===Va.command&&(Je.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),wa.c(932597253,!0),la=new Cj.a,la.el=Gf.a.instance.da(2064),la.sourceLocationOverrideResourceId=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?Ha.wHi:Ha.xHi,la.focusOnIframeWhenLoaded=!0,la.taskPaneWidth=Ha.l0e,Kb={},Kb.LaunchSource=Object(qi.a)(String,I.SourceControlId),Kb.LaunchMode="Default",la.eH=Kb,Kb=this.q_(Va,Ha.vHi,la,!0));301511274===Va.command&&(Kb=this.dhj(Va));515196233===Va.command&&((la=this.$.ea.Ba(465))&&la.c$b(),la=new Cj.a,la.el=Gf.a.instance.da(2130),Kb={},Kb.SourceUILocation=hj.a[Va.Ze],la.eH=Kb,Kb=new ac,Kb.w$=gf.a.$Ga,Kb=this.q_(Va,Ha.KCi,la,!0,Kb,void 0,la.el));1723441034===Va.command&&(la=new Cj.a,la.el=Gf.a.instance.da(2142),
la.focusOnIframeWhenLoaded=!0,la.taskPaneWidth=Ha.nKi,Kb=new ac,Kb.w$=gf.a.Rbh,Kb=this.q_(Va,Ha.mKi,la,!0,Kb));ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&I.LoadDataFromPictureTaskpane&&(la={},Kb=new Cj.a,Kb.el="Data From Picture",Kb.sourceLocationOverrideResourceId=I.DataFromPictureURL?I.DataFromPictureURL:"",la.SessionID=I.SessionID,Kb.eH=la,Kb.focusOnIframeWhenLoaded=!0,Kb=this.q_(Va,I.DataFromPictureAssetId,Kb));return Kb};Ha.prototype.insertAgave=function(I,
la){var Va=this,Kb=wh.TaskExtensions.dm(),nc=this.$,Mc=I[Mg.a.Gkb];if("SourceControlId"in I){var Yc={};var Ed=I.SourceControlId.split("|");if(8!==Ed.length||th.a.ma(Ed[0])||th.a.ma(Ed[1])||th.a.ma(Ed[2])||isNaN(parseInt(Ed[2]))||th.a.ma(Ed[3])||isNaN(parseInt(Ed[3]))||th.a.ma(Ed[4])||th.a.ma(Ed[5])||isNaN(parseInt(Ed[5]))||th.a.ma(Ed[6])||th.a.ma(Ed[7]))return wh.TaskExtensions.p3();ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Mc={},Mc.version=
Yc.Version=Ed[0],Mc.assetId=Yc.AssetId=Ed[1],Mc.solutionId=Yc.SolutionId=Ed[1],Mc.height=Yc.Height=parseInt(Ed[2]),Mc.width=Yc.Width=parseInt(Ed[3]),Mc.storeId=Yc.StoreId=Ed[4],Mc.targetType=Yc.TargetType=parseInt(Ed[5]),Mc.assetStoreId=Yc.AssetStoreId=Ed[6],Mc.storeType=Yc.StoreType=Ed[7],Mc.appVersion=Ed[0],Mc.currentStoreType=Ed[7],Mc.id=Ed[1]):(Mc={},Mc.appVersion=Yc.AppVersion=Ed[0],Mc.assetId=Yc.AssetId=Ed[1],Mc.id=Yc.Id=Ed[1],Mc.height=Yc.Height=parseInt(Ed[2]),Mc.width=Yc.Width=parseInt(Ed[3]),
Mc.storeId=Yc.StoreId=Ed[4],Mc.targetType=Yc.TargetType=parseInt(Ed[5]),Mc.assetStoreId=Yc.AssetStoreId=Ed[6],Mc.currentStoreType=Yc.CurrentStoreType=Ed[7])}else Yc=I[wi.a.Hj];Ed=null;ac.key in I&&(Ed=I[ac.key]);this.uua&&this.uua.hide();if(!Yc||!Mc)return Je.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Kb;this.$.X3&&oj.a.Uab in I&&(Yc.EnabledInViewMode=I[oj.a.Uab]);I=this.rwh(la.command);if(!Yc.EnabledInViewMode&&!nc.Xs(null,!1,I))return Kb;ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(Yc.AssetId===Ha.R5f||Yc.SolutionId===Ha.S5f)&&(Kb=this.$.ea.Ba(271))&&Kb.hhe():(Yc.AssetId===Ha.R5f||Yc.AssetId===Ha.S5f)&&(Kb=this.$.ea.Ba(271))&&Kb.hhe();var re=void 0===Yc.IsToBePersisted||null===Yc.IsToBePersisted||Yc.IsToBePersisted?0:16;if(1===Yc.TargetType)Kb=this.RXh(Yc,Mc,la,Ed,re);else{Ed=Hi.g(nc);Mc=this.viewBlockContainerHelpers.xcb(Ed);var pf=nc.fa.isNamedObjectViewMode?nc.qa.sheetName:nc.qa.name;if(Mc){Ed=Mc.jg;var Ze=Ed.fg.top;var cg=Ed.fg.left;var Ug=Mc.VH.x;var rh=Mc.VH.y}else Ze=
cg=1,Mc=this.viewBlockContainerHelpers.IIa(Ed),Ug=Mc.x,rh=Mc.y;var Lh=this.$.ra.ua.Wb();Mc=function(nh,Ki,Wh){var si=nc.ra.ua,Ti=Yc,ak=Ze,Ij=cg,Vj=Ug,Jj=rh;nh=di.b(nh,Object(qf.a)(Va,Va.mHi,"postInsertWebExtensionSuccess"));var kk=si.Na(9,Lh);kk.sharedInfo=Ti;kk.sheetName=pf;kk.positionRow=ak;kk.positionCol=Ij;kk.positionOffsetX=Vj;kk.positionOffsetY=Jj;return Yi.i(si,"InsertWebExtension",kk,nh,Ki,Wh,null,0)};ag.EwaSettings.pc()?(re|=64,Kb=Tj.a(this.$.userOperationManager,Mc,function(nh){return new Kj.a(534,
0,nh,re)},la)):Kb=Tj.a(this.$.userOperationManager,Mc,function(nh){return new Pj.a(534,0,nh,re)},la)}return Kb};Ha.prototype.uPg=function(){var I=oi.a.instance.oc("Common.App.ICustomerFeedbackUiWrapper"),la=oi.a.instance.oc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.n5c?this.n5c.qgb?this.Hoe():la.instance.D1c(Object(qf.a)(this,this.wkh,"feedbackDownloaded")):Je.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");la={};$f.AFrameworkApplication.ha.Wde(la);
I=I.instance.getContext(la);la={};"telemetryGroup"in I&&(la=I.telemetryGroup);la.processSessionId=I.sessionId;la.officeBuild=I.build;I.telemetryGroup=la;I.feedbackType=-1;I.userVoiceEnabled=!1;"disableIncludeScreenshot"in I||(I.disableIncludeScreenshot=!1);"screenshot"in I||(I.screenshot=!1);I.disableScreenshotPreview=!1;I.includeScreenshotSelectedDefault=!0;return I};Ha.prototype.JHi=function(I){if(!this.N7a&&ag.EwaSettings.ka(750)&&ag.EwaSettings.getBooleanFeatureGate(Ha.RSh,!1)){var la=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";la=this.tme(la);var Va=new ac;Va.Nj=gf.a.l4c;this.N7a=this.yFd(la,null,!1,null,Va);la={};Zk.b(this.$).ee(ni.a.KHi,(la.Location=hj.a[I.Ze],la.InputMethod=uk.a[I.method],la),void 0,!0)}};Ha.prototype.WNf=function(I){var la=this.$.fa.$g.get(17);oi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Va){Va.isFeatureEnabled("mso_sendASmile",la).then(function(Kb){I.FeedbackEnabled=la&&Kb;return null})})};
Ha.prototype.Lfj=function(I){var la=Hi.g(this.$),Va=new Cj.a,Kb={ActiveTab:"Format"};Kb.DatapaneFlighting=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Kb.RangePickerFlighting=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);Kb.AceFlighting=!0;Kb.ChartNewSDXRecording=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Kb.ThemeColorsFlighting=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)&&ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");this.WNf(Kb);Kb.startTimeMs=Date.now();Kb.UserSessionId=this.$.ya.UserSessionId;(la=la.ga.Pa.Ap)&&(Kb.SubSelection=la);Je.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",Kb.UserSessionId,void 0===I.Ze||null===I.Ze?"Null":hj.a[I.Ze],la?la:"ChartRoot");Va.eH=Kb;Va.el=Gf.a.instance.da(931);Kb=new ac;Kb.w$=gf.a.$Ga;return this.q_(I,Ha.vJg,Va,
!0,Kb)};Ha.prototype.Ugj=function(I){var la=new Cj.a;la.eH={};la.el=Gf.a.instance.da(1733);la.xQa=Ha.bbf;var Va=new ac;Va.w$=gf.a.$Ga;return this.q_(I,Ha.bbf,la,!0,Va,void 0,la.el)};Ha.prototype.dhj=function(I){var la=new Cj.a;la.eH={};la.el=Gf.a.instance.da(2088);var Va=new ac;Va.w$=gf.a.$Ga;return this.q_(I,Ha.rki,la,!0,Va)};Ha.prototype.OXe=function(I,la){var Va=Ha.NZe,Kb=I[wi.a.Md].toString(),nc={},Mc=new Cj.a;Mc.el=Gf.a.instance.da(9);switch(Kb){case "A0":nc.query=(I[wi.a.Hj]||"").split("|").slice(2,
uj.a.kR).join("|");break;case "A1":nc.query=I.CommandValueId;break;case "Help":nc.gwdropdownflightinfo=ag.EwaSettings.ka(242);nc.query="";break;case oj.a.Pzd:ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Mc.el=Gf.a.instance.da(1699),Mc.sourceLocationOverrideResourceId=Ha.yWe,nc.feedback=this.uPg()):nc.query=Kb;break;case "HelpArticle":nc.query=I[wi.a.Hj];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":nc.query=Kb;break;default:return Gj.Task.Ra(!0)}Mc.eH=
nc;Kb=new ac;Kb.w$=gf.a.$Ga;return this.q_(la,Va,Mc,!1,Kb,I[oj.a.Uab]||!1)};Ha.prototype.tme=function(I){var la={};ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(la.Version="0.0.0.0",la.AssetId=Ha.C$,la.SolutionId=Ha.C$,la.AssetStoreId="",la.StoreType=OSF.StoreType.Sdx,la.Height=0,la.Width=0,la.StoreId=OSF.StoreType.Sdx,la.TargetType=OSF.OsfControlTarget.TaskPane,la.IsToBePersisted=!1,la.SourceLocationOverrideResourceId=I,la.SharedRuntimeId=
I,la.Id=Ha.C$,la.CurrentStoreType=OSF.StoreType.Sdx,la.AppVersion="0.0.0.0"):(la.AppVersion="0.0.0.0",la.AssetId=Ha.C$,la.Id=Ha.C$,la.AssetStoreId="",la.CurrentStoreType=OSF.StoreType.Sdx,la.Height=0,la.Width=0,la.StoreId=OSF.StoreType.Sdx,la.TargetType=OSF.OsfControlTarget.TaskPane,la.IsToBePersisted=!1,la.SourceLocationOverrideResourceId=I,la.SharedRuntimeId=I);return la};Ha.prototype.VNh=function(I,la,Va){var Kb=this,nc=new Cj.a,Mc=new ac,Yc={};this.WNf(Yc);Yc.LaunchSource="";Yc.StartTimeMs=Date.now();
Yc.CorrelationId=Ci.a.create().toString();nc.eH=Yc;nc.focusOnIframeWhenLoaded=!0;nc.taskPaneWidth=Ha.l0e;Mc.w$=gf.a.odh;Mc.Cuc=gf.a.BFe;switch(Va.command){case -1444574190:var Ed,re;Yc.LaunchMode="RecommendedPivotTables";Yc.SelectionContext="";Yc.LaunchSource="PivotTableHandRaise"===Object(qi.a)(String,I.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&!th.a.ma(I.SourceSelection)){var pf=I.SourceSelection.split(",")[0];
la=ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var Ug=ri.Y(pf,Kb.$.va);Ed=Ug.sheetName;re=Ug.bDb;Ze=Ug.range;return Ug}().returnValue&&!Hi.g(this.$).$b.baa(Ze))I=this.$.va.getItemByName(Ed),Yc.SelectionContext=JSON.stringify(Object.assign(new eb,{address:re,addressWithSheet:Ed+"!"+Ze.nG(!1),sheetId:ui.d(I),sheetName:Ed,isSheetEmpty:!1,columnCount:Ze.width,rowCount:Ze.height,columnIndex:Ze.left+la,rowIndex:Ze.top+la,selectionType:"Continuous"}));
else if((I=this.$.wb.getItemByName(Object(qi.a)(String,I.SourceSelection)))&&ui.o(I)){var Ze=Ok.a(I,!0);var cg=this.$.va.getItemByName(I.sheetName);Yc.SelectionContext=JSON.stringify(Object.assign(new Fa,{tableName:I.name,hasTableHeaders:Ok.d(I),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Ze.nG(!1),addressWithSheet:cg.name+"!"+Ze.nG(!1),sheetId:ui.d(cg),sheetName:cg.name,isSheetEmpty:!1,columnCount:Ze.width,rowCount:Ze.height,columnIndex:Ze.left+la,rowIndex:Ze.top+la,selectionType:"Continuous"}))}}ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?nc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":nc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";nc.el=Gf.a.instance.da(1743);nc.Nj=gf.a.UHe;Mc.Nj=gf.a.UHe;break;case -336193495:Yc.LaunchMode="RecommendedCharts";ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?nc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":nc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";nc.el=Gf.a.instance.da(1742);nc.Nj=gf.a.VHe;
Mc.Nj=gf.a.VHe;break;case -1336341324:if(!ag.EwaSettings.ka(506))return Gj.Task.Ra(!1);Yc.LaunchMode="NL";ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?nc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":nc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(ag.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:nc.el=Gf.a.instance.da(1747);Yc.NLLaunchModeBrandingCandidatesIndex=1;break;
case 2:nc.el=Gf.a.instance.da(1748);Yc.NLLaunchModeBrandingCandidatesIndex=2;break;default:nc.el=Gf.a.instance.da(1746),Yc.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!ag.EwaSettings.ka(237))return Gj.Task.Ra(!1);Yc.LaunchMode="ChartDesigner";Yc.LaunchSelectionMode=la.toString();ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?nc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":nc.sourceLocationOverrideResourceId="Insights.Https.Bundle";
nc.el=Gf.a.instance.da(1749);break;default:Yc.LaunchMode="Default",ag.EwaSettings.ka(237)&&(Yc.LaunchSelectionMode=la.toString()),ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?nc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":nc.sourceLocationOverrideResourceId="Insights.Https.Bundle",nc.el=Gf.a.instance.da(1744),nc.Nj=gf.a.l4c,Mc.Nj=gf.a.l4c}return ag.EwaSettings.ka(750)?(ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?nc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":nc.sourceLocationOverrideResourceId="Insights.Https.Bundle",this.N7a?this.N7a.CWR(function(){return Kb.ZLf(Yc,nc)}):this.fWh(Va,nc,Mc,Yc)):this.q_(Va,Ha.C$,nc,!0,Mc)};Ha.prototype.fWh=function(I,la,Va,Kb){var nc=this,Mc=this.tme(la.sourceLocationOverrideResourceId);this.N7a=this.yFd(Mc,la,!1,I,Va,!1);return this.N7a.CWR(function(){return nc.ZLf(Kb,la)})};Ha.prototype.ZLf=function(I,la){var Va=this.se.W2(this.se.Hha(Ha.C$,la.sourceLocationOverrideResourceId));
if(Va){this.H$a[Ha.C$]=I;var Kb=this.kgc(this.se.HT(Va).OsfPropertyBag,Ha.C$);this.se.HT(Va).OsfPropertyBag=Kb}this.iLa(Ha.C$,"LaunchIdeasAction",I,la);return Gj.Task.Ra(!0)};Ha.prototype.lPh=function(I,la,Va,Kb,nc){if(2!==Va)return 32;I=nc[ik.a.F4b];Va=nc[ik.a.jFa];nc=nc[ik.a.Wwa];la=new Cj.a;la.VXh=nc.Ri.InstanceToken;la.el=nc.Ri[Nb.el];la.xQa=nc.Ri[Nb.xQa];Nb.taskPaneWidth in nc.Ri&&(la.taskPaneWidth=nc.Ri[Nb.taskPaneWidth]);la.sourceLocationOverrideResourceId=nc.Ri[Nb.sourceLocationOverrideResourceId];
la.eH=nc.gr;la.onTaskPaneClose=nc.Ri[Nb.onTaskPaneClose];la.jFa=Va;Va=new Fj.a(-859308420,0,2,0,"");Kb=I.getStoreType()===OSF.StoreType.Sdx;var Mc=new ac,Yc=nc.Ri.HeaderCssClass;Mc.w$=Yc?Yc:gf.a.$Ga;Mc.Cuc=nc.Ri.TitleCssClass;this.q_(Va,I.getId(),la,Kb,Mc);return 32};Ha.prototype.WOh=function(I,la,Va,Kb,nc){if(2!==Va)return 32;I=nc[ik.a.F4b].getId();nc=nc[ik.a.Wwa].Ri[Nb.sourceLocationOverrideResourceId];return I?(this.se.sh.refreshOsfControl(I,nc),32):8};Ha.prototype.q_=function(I,la,Va,Kb,nc,Mc,
Yc){Va=void 0===Va?null:Va;Kb=void 0===Kb?!1:Kb;nc=void 0===nc?null:nc;Mc=void 0===Mc?!1:Mc;Yc=void 0===Yc?null:Yc;wh.TaskExtensions.dm();Va||(Va=new Cj.a);var Ed={};ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Ed.Version="0.0.0.0",Ed.AssetId=la,Ed.SolutionId=la,Ed.AssetStoreId="",Ed.StoreType=Kb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Ed.Height=0,Ed.Width=0,Ed.StoreId=Kb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Ed.TargetType=OSF.OsfControlTarget.TaskPane,
Ed.IsToBePersisted=!1,Ed.SourceLocationOverrideResourceId=Va.sourceLocationOverrideResourceId,Ed.AppVersion="0.0.0.0",Ed.Id=la,Ed.CurrentStoreType=Kb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty):(Ed.AppVersion="0.0.0.0",Ed.AssetId=la,Ed.Id=la,Ed.AssetStoreId="",Ed.CurrentStoreType=Kb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Ed.Height=0,Ed.Width=0,Ed.StoreId=Kb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Ed.TargetType=OSF.OsfControlTarget.TaskPane,Ed.IsToBePersisted=!1,Ed.SourceLocationOverrideResourceId=
Va.sourceLocationOverrideResourceId);if(Va.el||Yc)this.z5b[la]=Object.assign(new db,{buc:Va.el,INd:Yc,JNd:Va.xQa});ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Va.eH||(Va.eH={}),Va.eH.ShowFeedback=this.$.isFeedbackEnabled,this.H$a[la]=Va.eH):Va.eH&&(this.H$a[la]=Va.eH);la={};la[wi.a.Hj]=Ed;Yc={};ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Yc.id=Ed.Id,Yc.solutionId=
Ed.SolutionId,Yc.version=Ed.Version,Yc.storeType=Ed.StoreType,Yc.storeId=Ed.StoreId,Yc.assetId=Ed.AssetId,Yc.assetStoreId=Ed.AssetStoreId,Yc.height=Ed.Height,Yc.targetType=Ed.TargetType,Yc.width=Ed.Width,Yc.isAddinCommands=!Kb,Yc.appVersion=Ed.AppVersion,Yc.currentStoreType=Ed.CurrentStoreType):(Yc.appVersion=Ed.AppVersion,Yc.assetId=Ed.AssetId,Yc.assetStoreId=Ed.AssetStoreId,Yc.currentStoreType=Ed.CurrentStoreType,Yc.height=Ed.Height,Yc.id=Ed.Id,Yc.storeId=Ed.StoreId,Yc.targetType=Ed.TargetType,
Yc.width=Ed.Width,Yc.isAddinCommands=!Kb);la[Mg.a.Gkb]=Yc;nc||(nc=new ac);nc.focusOnIframeWhenLoaded=Va.focusOnIframeWhenLoaded;nc.width=Va.taskPaneWidth;la[ac.key]=nc;la[oj.a.Uab]=Mc;return this.insertAgave(la,I)};Ha.prototype.RXh=function(I,la,Va,Kb,nc){function Mc(Ze){ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Je.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(Ze.storeType,
Ze.storeId,Ze.solutionId),Ze.storeType):Je.ULS.sendTraceTag(537170439,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(Ze.currentStoreType,Ze.storeId,Ze.assetId),Ze.currentStoreType);var cg={},Ug=new lh.a;Ug.add(Ze);cg[Mg.a.cWa]=Ug;cg[Mg.a.oO]=3;Ze=new Fj.a(tf.a.Bxb,0,Ed.$.dd,0,null);return Ed.$.Ka.Ub(Ze,cg)}function Yc(Ze,cg){if(ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){var Ug=Ze.SolutionId;var rh=Ze.StoreType;
ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(rh)&&Ze.SourceLocationOverrideResourceId&&(Ug=Ed.se.Hha(Ug,Ze.SourceLocationOverrideResourceId)):rh!==OSF.StoreType.FirstParty&&rh!==OSF.StoreType.Sdx||!Ze.SourceLocationOverrideResourceId||(Ug=Ed.se.Hha(Ug,Ze.SourceLocationOverrideResourceId))}else Ug=Ze.Id,rh=Ze.CurrentStoreType,ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Ze.CurrentStoreType)&&
Ze.SourceLocationOverrideResourceId&&(Ug=Ed.se.Hha(Ug,Ze.SourceLocationOverrideResourceId)):Ze.CurrentStoreType!==OSF.StoreType.FirstParty&&Ze.CurrentStoreType!==OSF.StoreType.Sdx||!Ze.SourceLocationOverrideResourceId||(Ug=Ed.se.Hha(Ug,Ze.SourceLocationOverrideResourceId));var Lh=Ed.se.pVc(Ug,null,Ze.SharedRuntimeId);if(ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(rh):rh===OSF.StoreType.FirstParty||rh===OSF.StoreType.Sdx)ag.EwaSettings.ka(302)&&
Lh&&(rh=Ed.se.W2(Ug))&&(Ug=null,Ug=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Ed.kgc(Ed.se.HT(rh).OsfPropertyBag,Ze.SolutionId):Ed.kgc(Ed.se.HT(rh).OsfPropertyBag,Ze.AssetId),(rh=Ed.se.sh.getOsfControl(rh))&&rh.setSettings(Ug)),Ze.SharedRuntimeId&&Lh||(ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Ed.se.sh.refreshOsfControl(Ze.SolutionId,Ze.SourceLocationOverrideResourceId):Ed.se.sh.refreshOsfControl(Ze.Id,
Ze.SourceLocationOverrideResourceId));if(!Lh){var nh=Ed.$.ra.ua.Wb(),Ki=519;Lh=function(Wh,si,Ti){var ak=Ed.$.ra.ua;Wh=di.b(Wh,Object(qf.a)(Ed,Ed.hxf,"postInsertAgaveTaskpaneSuccess"));var Ij=ak.Na(9,nh);Ij.sharedInfo=Ze;return Yi.i(ak,"InsertAgaveTaskpane",Ij,Wh,si,Ti,Kb,0)};void 0===Ze.IsToBePersisted||null===Ze.IsToBePersisted||Ze.IsToBePersisted||(Ki=538,Lh=function(Wh,si,Ti){ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Je.ULS.sendTraceTag(537170442,
220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",Ze.StoreType,Ze.StoreId,Telemetry.PrivacyRules.GetAssetId(Ze.StoreType,Ze.StoreId,Ze.SolutionId)):Je.ULS.sendTraceTag(537170441,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",Ze.CurrentStoreType,Ze.StoreId,Telemetry.PrivacyRules.GetAssetId(Ze.CurrentStoreType,Ze.StoreId,Ze.AssetId));var ak=Ed.$.ra.ua;Wh=di.b(Wh,Object(qf.a)(Ed,Ed.hxf,"postInsertAgaveTaskpaneSuccess"));
var Ij=ak.Na(9,void 0===nh?null:nh);Ij.sharedInfo=Ze;return Yi.i(ak,"ShowAgaveTaskpane",Ij,Wh,si,Ti,Kb,0)});return ag.EwaSettings.pc()?(nc|=64,Tj.a(Ed.$.userOperationManager,Lh,function(Wh){return new Kj.a(Ki,0,Wh,nc)},cg)):Tj.a(Ed.$.userOperationManager,Lh,function(Wh){return new Pj.a(Ki,0,Wh,nc)},cg)}return wh.TaskExtensions.p3()}var Ed=this;if(!ag.EwaSettings.ka(53)||I.StoreId===OSF.StoreType.FirstParty)return Yc(I,Va,Kb);if(la.isAddinCommands)return Mc(la);var re=new sj.a,pf={};ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(pf.marketplaceId=I.SolutionId,pf.marketplaceVersion=I.Version,pf.storeType=I.StoreType):(pf.marketplaceId=I.Id,pf.marketplaceVersion=I.AppVersion,pf.storeType=I.CurrentStoreType);pf.storeId=I.StoreId;pf.targetData=I;ag.EwaSettings.ka(93)&&(pf.clearCache=!0);this.se.sh.isAddinCommandsAsync(pf,function(Ze,cg,Ug){re.setResult(cg);Ze||(Ze=Ug.targetData,ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Je.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",
Telemetry.PrivacyRules.GetAssetId(Ze.StoreType,Ze.StoreId,Ze.SolutionId),Ze.StoreType):Je.ULS.sendTraceTag(537170437,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(Ze.CurrentStoreType,Ze.StoreId,Ze.Id),Ze.CurrentStoreType))});return wh.TaskExtensions.ts(re.task,function(Ze){return Ze.result?Mc(la):Yc(I,Va,Kb)},this.$.la)};Ha.prototype.mHi=function(I){I=I.Result;I=null===I?null:I.SolutionId;th.a.ma(I)||(this.se.Ede(I),ck.a(this.$).ula(3,
I))};Ha.prototype.kgc=function(I,la){if(!this.H$a[la])return I;var Va={};if(I){I=Ol(I);for(var Kb=I.next();!Kb.done;Kb=I.next())Kb=Kb.value,Va[Kb[0]]=Kb[1]}I=this.H$a[la];Kb=Ol(Object.keys(I));for(la=Kb.next();!la.done;la=Kb.next())la=la.value,la===Ha.ykh&&ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Va[la]=Sys.Serialization.JavaScriptSerializer.serialize(I[la]):Va[la]=Sys.Serialization.JavaScriptSerializer.serialize(I[la].toString());la=Object.keys(Va).length;
I=Array(la);Kb=0;var nc=Ol(Object.keys(Va));for(la=nc.next();!la.done;la=nc.next())la=la.value,I[Kb]=[la,Va[la].toString()],Kb++;return I};Ha.prototype.hxf=function(I,la){var Va=(I=I.Result)?I.AgaveData:null;if(Va){Je.ULS.shipAssertTag(537170434,0,Va.TaskpaneWidth===Ha.u0g,"Taskpane width is {0}, assetId is {1}.",Va.TaskpaneWidth,Va.PrimaryMarketplace.SolutionId);var Kb=this.z5b[Va.PrimaryMarketplace.SolutionId];Kb&&(Kb.buc&&(Va.TaskpaneTitle=Kb.buc),Kb.JNd&&(Va.TaskpaneIconId=Kb.JNd),Kb.INd&&(Va.TaskpaneButtonTooltip=
Kb.INd),0<Kb.Qq&&(Va.TaskpaneWidth=Kb.Qq));la&&(Va.FocusOnIframeWhenLoaded=la.focusOnIframeWhenLoaded,la.width&&(Va.TaskpaneWidth=la.width),Va.TaskpaneIconCssClass=la.Nj,Va.TaskpaneHeaderCssClass=la.w$,Va.TaskpaneTitleCssClass=la.Cuc);this.H$a[Va.PrimaryMarketplace.SolutionId]&&(Va.OsfPropertyBag=this.kgc(Va.OsfPropertyBag,Va.PrimaryMarketplace.SolutionId));Vk.a(Va)||(Va.WebExtensionOsfControlType=1);Va&&(this.se.Ede(I.SolutionId),this.se.IYa(Va))}else Je.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};
Ha.prototype.hdi=function(I,la,Va){var Kb=this.$.ya.UserSessionId,nc=this.$.ya.UICultureTag,Mc=this.$.ya.UICultureTagLcid,Yc=this.$.ya.WacHostId,Ed="",re="";5<=Va.length&&(Ed=Va[3],re=Va[4]);this.idi(Ed,re,I,la,nc,Mc,Kb,Yc)};Ha.prototype.idi=function(I,la,Va,Kb,nc,Mc,Yc,Ed){var re={};re.a=Yc;re.b=Va;re.c=Kb;re.d=I;re.e=la;re.f=nc;re.g=Mc;re.h=Ed;vj.b().Je(36,re)};Ha.prototype.Hoe=function(){if(hk.a.Wif())Je.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(qf.a)(this,
this.jxf,"postScreenshotData"));return}catch(I){Je.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(I?I.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(qf.a)(this,this.jxf,"postScreenshotData"))}catch(I){Je.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(I?I.toString():null))}}};Ha.prototype.wkh=function(I){I&&(this.n5c.g$e(I),this.Hoe())};Ha.prototype.jxf=function(I){I=I.toDataURL("image/jpeg");var la=this.se.W2(Ha.NZe+
"."+Ha.yWe);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(la,"onScreenshot",{screenshot:I},function(){})};Ha.prototype.yFd=function(I,la,Va,Kb,nc,Mc){la=void 0===la?null:la;Va=void 0===Va?!1:Va;Kb=void 0===Kb?null:Kb;nc=void 0===nc?null:nc;Mc=void 0===Mc?!0:Mc;var Yc=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?I.SolutionId:I.AssetId,Ed=Gj.Task.Ra(!1);!I||th.a.ma(Yc)||th.a.ma(I.SharedRuntimeId)||(Kb=Kb?Kb:new Fj.a(-859308420,0,2,
0,""),Yc={},ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Yc.id=I.Id,Yc.solutionId=I.SolutionId,Yc.version=I.Version,Yc.storeType=I.StoreType,Yc.storeId=I.StoreId,Yc.assetId=I.AssetId,Yc.assetStoreId=I.AssetStoreId,Yc.height=I.Height,Yc.targetType=I.TargetType,Yc.width=0,Yc.isAddinCommands=!1,Yc.sharedRuntimeId=I.SharedRuntimeId,I.Preload=Mc,Yc.appVersion=I.AppVersion,Yc.currentStoreType=I.CurrentStoreType):(Yc.appVersion=I.AppVersion,Yc.assetId=
I.AssetId,Yc.assetStoreId=I.AssetStoreId,Yc.currentStoreType=I.CurrentStoreType,Yc.height=I.Height,Yc.id=I.Id,Yc.storeId=I.StoreId,Yc.targetType=I.TargetType,Yc.width=0,Yc.isAddinCommands=!1,Yc.sharedRuntimeId=I.SharedRuntimeId,I.Preload=Mc),nc=nc?nc:new ac,nc.width=0,la&&(nc.focusOnIframeWhenLoaded=la.focusOnIframeWhenLoaded,Mc=new db,la.el&&(Mc.buc=la.el),0<la.taskPaneWidth&&(Mc.Qq=la.taskPaneWidth),ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?this.z5b[I.SolutionId]=Mc:this.z5b[I.AssetId]=Mc),la={},la[wi.a.Hj]=I,la[Mg.a.Gkb]=Yc,la[ac.key]=nc,la[oj.a.Uab]=Va,Ed=this.insertAgave(la,Kb));return Ed};Ha.prototype.iLa=function(I,la,Va,Kb){Kb=void 0===Kb?null:Kb;if(!th.a.ma(I)&&!th.a.ma(la)){I=new ah.a(I,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var nc=new rj.a("ExcelOnline","Web",this.$.ya.UICultureTag),Mc=new Qi.a;Mc.Ri[Nb.KNc]=Va;Kb&&(Va=Kb,th.a.ma(Va.sourceLocationOverrideResourceId)||(Mc.Ri[Nb.sourceLocationOverrideResourceId]=Va.sourceLocationOverrideResourceId),
th.a.ma(Va.el)||(Mc.Ri[Nb.el]=Va.el),th.a.ma(Va.Nj)||(Mc.Ri.IconCssClass=Va.Nj),th.a.ma(Va.DNd)||(Mc.Ri.TaskPaneIconUrl=Va.DNd),th.a.ma(Va.xQa)||(Mc.Ri.TaskPaneIconId=Va.xQa));Yg.a.instance.iLa(I,yk.a.action,la,nc,Mc)}};Ha.prototype.ANh=function(I,la,Va,Kb,nc){if(2!==Va)return 32;if(ij.a.ma(nc)||nc[ik.a.Wse]!==yk.a.action)return 8;I=nc[ik.a.Wwa];if(!I)return 8;la=(la=this.zEh(nc))?this.se.W2(la):null;return th.a.ma(la)?8:(nc=this.se.IRg(nc[ik.a.jFa],I.Ri[Nb.KNc]),ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&
(Va=this.se.HT(la),Va.TaskpaneTitle!==I.Ri[Nb.el]&&(Va.TaskpaneTitle=I.Ri[Nb.el],Va.TaskpaneIconCssClass=I.Ri.IconCssClass,Va.TaskpaneIconUrl=I.Ri.TaskPaneIconUrl,Va.TaskpaneIconId=I.Ri.TaskPaneIconId,I=this.se.sh.getOsfControl(la),this.se.sh.raiseOsfControlStatusChange(I))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(la,nc,Object(qf.a)(this,this.PFb,"sendActionToAddin")),32)};Ha.prototype.PFb=function(I,la){this.se.cnh(I,la)};Ha.prototype.zEh=function(I){if(!ij.a.ma(I)){var la=
I[ik.a.F4b];if(la&&(la=la.getId(),I=I[ik.a.Wwa],!th.a.ma(la)&&I))return this.Hha(la,I.Ri[Nb.sourceLocationOverrideResourceId])}return null};Ha.prototype.Hha=function(I,la){la=void 0===la?null:la;return th.a.ma(I)||th.a.ma(la)?I:String.format("{0}.{1}",I,la)};Ha.prototype.rwh=function(I){switch(I){case 1221897806:return 2;case -515602470:case 2086613372:return ag.EwaSettings.ka(237)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Ha.RSh=
"Microsoft.Office.Excel.IdeasXLOPreload";Ha.nvd="IDS";Ha.NZe="FA000000012";Ha.C$="FA000000005";Ha.$Qh="HelloWorld";Ha.vJg="FA000000014";Ha.yWe="Help.GiveFeedback.Url";Ha.ykh="feedback";Ha.bbf="FA000000066";Ha.xHi="PowerBi.Url";Ha.wHi="PowerBi.DevUrl";Ha.vHi="FA000000054";Ha.rki="FA000000064";Ha.KCi="FA000000075";Ha.mKi="FA000000080";Ha.R5f="WA200002680";Ha.S5f="a048b5e5-dc67-4812-b114-0969772a09ec";Ha.u0g=350;Ha.l0e=320;Ha.nKi=320;Object(Md.a)(Ha,"AgaveCommandManager",jj.a,[443,444]);Ll.Object.defineProperties(mb,
{instance:{configurable:!0,enumerable:!0,get:function(){return mb.Ma}}});mb.Ma=new mb;Object(Md.a)(mb,"AppsDataManagerFactory",null,[]);Object(Md.a)(function(I,la){this.httpStatus=I;this.data=la},"AppData",null,[]);Ka.prototype.Wub=function(I){this.H9f(this.J9f,I)};Ka.prototype.NV=function(I,la,Va,Kb){I?(la={},Je.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(la.dataType=I,la))):this.vb&&this.Ng&&la?this.Ng.Jl(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",
this.vb.appSettings.WebServiceBase,$f.AFrameworkApplication.lcid,la),1,"",null,!0,2,Va,Kb,null):Je.ULS.sendTraceTag(6070476,344,10,"The request objects are not available")};Object(Md.a)(Ka,"AppsDataProvider",null,[434]);var $k=Ji.a;Em(ta,$k);ta.prototype.create=function(){var I=this,la=this.$.ea,Va=Zi.GetServiceTaskFactory.create(la,106,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),Kb=Zi.GetServiceTaskFactory.create(la,104,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IViewBlockContainerHelpers"),
nc=Jf.a.loadScript(36,0,this.rb,void 0,void 0,375);wh.TaskExtensions.Aa(wh.TaskExtensions.xe([Kb,Va,nc],this.la),function(){var Mc=new Dc.a(Cc.a.instance),Yc=new Ka($f.AFrameworkApplication.ha,$f.AFrameworkApplication.Cd,"WAC_Excel");new kb(Mc,Yc,"PreinstalledAppsData_Excel");Mc=null;ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Mc=oi.a.instance.oc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);Na.instance.initialize(Va.result);
Mc=new Ha(I.$,Va.result,Kb.result,Mc,$f.AFrameworkApplication.Hb);la.Ia(206,Mc);I.Eb(la.Ba(374)||la.Ia(374,Mc))},this.la,3);oi.a.instance.register(zj.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").wc().Fc(function(){return new zj.a(I.$.Zx)})};ta.ja=function(I){I.ea.Ia(375,new ta(I))};Object(Md.a)(ta,"AgaveCommandManagerFactory",Ji.a,[]);var Pi=b(841);ea.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};ea.prototype.invokePropertyGet=function(I){switch(I){case 4:return this.displayName;
case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};ea.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};ea.prototype.invokePropertySet=function(I,la){switch(I){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,
0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};ea.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ea.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
};ea.prototype.invokeMethodAsync=function(I,la){I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};ea.oUg=function(I){var la=new ea;la.displayName=I.displayName;la.email=I.email;switch(I.authority){case ef.nuf:la.identityType=1;break;default:la.identityType=0}la.federationProvider="";return la};Ll.Object.defineProperties(ea.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.Fda},set:function(I){this.Fda=I}},email:{configurable:!0,
enumerable:!0,get:function(){return this.ZYd},set:function(I){this.ZYd=I}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.EZd},set:function(I){this.EZd=I}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Rfb},set:function(I){this.Rfb=I}}});Object(Md.a)(ea,"OfficeIdentityInfo",null,[]);ab.z7b=function(I){return I in ab.TDe?ab.TDe[I].toString():I};Ll.Object.defineProperties(ab,{TDe:{configurable:!0,enumerable:!0,get:function(){return ab.Vbg}}});ab.map=
null;var wj={};ab.Vbg=(wj.GeneralException=Pi.a.generalException,wj.AccessDenied=Pi.a.GNc,wj.ApiNotAvailable=Pi.a.apiNotAvailable,wj.UserNotSignedIn=Pi.a.userNotSignedIn,wj.UserAborted=Pi.a.userAborted,wj.UnsupportedUserIdentity=Pi.a.Ivj,wj.InvalidResourceUrl=Pi.a.invalidResourceUrl,wj.InvalidGrant=Pi.a.invalidGrant,wj.AddinIsAlreadyRequestingToken=Pi.a.lvg,wj.ResourceNotAllowed=Pi.a.PZi,wj.ClientError=Pi.a.clientError,wj.ServerError=Pi.a.serverError,wj);Object(Md.a)(ab,"SingleSignOnErrorCodeMap",
null,[]);Ya.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};Ya.prototype.invokePropertyGet=function(I){switch(I){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};Ya.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};Ya.prototype.invokePropertySet=function(I,la){switch(I){case 2:this.accessToken=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};Ya.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Ya.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
};Ya.prototype.invokeMethodAsync=function(I,la){I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};Ll.Object.defineProperties(Ya.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.kdb},set:function(I){this.kdb=I}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Rfb},set:function(I){this.Rfb=I}}});Object(Md.a)(Ya,"SingleSignOnToken",null,[]);xb.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};
xb.prototype.invokePropertyGet=function(I){switch(I){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};xb.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};xb.prototype.invokePropertySet=function(I,la){switch(I){case 3:this.authChallenge=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 6:this.silentLogin=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};xb.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};xb.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};xb.prototype.invokeMethodAsync=function(I,la){I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};
Ll.Object.defineProperties(xb.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.lVd},set:function(I){this.lVd=I}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.tR},set:function(I){this.tR=I}},policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.HRb},set:function(I){this.HRb=I}},scope:{configurable:!0,enumerable:!0,get:function(){return this.f9d},
set:function(I){this.f9d=I}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.o$d},set:function(I){this.o$d=I}}});Object(Md.a)(xb,"TokenParameters",null,[331]);pb.prototype.getAccessToken=function(I){var la=this,Va=this.peb.getOsfControl(this.oz),Kb=Va.getManifest(),nc=Kb.getMarketplaceID();this.ALa(I,nc);return OfficeExtension.WacRuntime.Utility.createPromise(function(Mc,Yc){Va.isFirstParty()&&la.peb._enableFirstPartySSO?la.i_h(Kb,I)?oi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(I,
nc).then(function(Ed){Mc(Ed)},function(Ed){Yc(Ed)}):Yc(Pi.a.GNc):Yc(Pi.a.apiNotAvailable)}).then(function(Mc){switch(Mc.authority){case ef.nuf:var Yc=1;break;default:Yc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ya(Mc.accessToken,Yc))},function(Mc){la.zci(I,nc,Mc);return Mc?OfficeExtension.WacRuntime.Utility.createPromise(function(Yc,Ed){Ed(OfficeExtension.WacRuntime.Utility.createRichApiException(Mc,ab.z7b(Mc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Yc,
Ed){Ed(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,ab.z7b(Pi.a.generalException)))})})};pb.prototype.getAuthContext=function(){return null};pb.prototype.getPrimaryIdentityInfo=function(){var I=this.peb.getOsfControl(this.oz);I.getManifest();var la=I.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Va,Kb){oi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(la).then(function(nc){Va(nc)},
function(nc){Kb(nc.toString())})}).then(function(Va){Va=ea.oUg(Va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Va)},function(Va){return Va?OfficeExtension.WacRuntime.Utility.createPromise(function(Kb,nc){nc(OfficeExtension.WacRuntime.Utility.createRichApiException(Va,ab.z7b(Va)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Kb,nc){nc(OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,ab.z7b(Pi.a.generalException)))})})};pb.prototype.getTypeName=
function(){return"Microsoft.Authentication.AuthenticationService"};pb.prototype.invokePropertyGet=function(I){switch(I){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};pb.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};pb.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};pb.prototype.invokePropertySetAsync=
function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};pb.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};pb.prototype.invokeMethodAsync=function(I,la){switch(I){case 1:return this.Ush(la);case 3:return this.kuh();case 2:return this.xFh()}I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};pb.prototype.Ush=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
0,xb);return this.getAccessToken(I)};pb.prototype.kuh=function(){return this.getAuthContext()};pb.prototype.xFh=function(){return this.getPrimaryIdentityInfo()};pb.prototype.i_h=function(I,la){var Va=!1,Kb=I.getWebApplicationAuthorizations();I=null;Kb=Ol(Kb);for(var nc=Kb.next();!nc.done;nc=Kb.next())if(nc=nc.value,nc.getResource().toLowerCase()===la.resource.toLowerCase()){I=nc;Va=!0;break}if(!Va)return!1;la=la.scope.split(" ,+");la=Ol(la);for(Va=la.next();!Va.done;Va=la.next())if((Va=Va.value)&&
Va.length){Kb=!1;nc=Ol(I.getScopes());for(var Mc=nc.next();!Mc.done;Mc=nc.next())Va.toLowerCase()===Mc.value.toLowerCase()&&(Kb=!0);if(!Kb)return!1}return!0};pb.prototype.ALa=function(I,la){I=this.Pif(I.resource);var Va={};Je.ULS.sendTraceTag(538572831,369,50,"{0}",(Va.manifestId=la,Va.resource=I,Va))};pb.prototype.zci=function(I,la,Va){I=this.Pif(I.resource);var Kb={};Je.ULS.sendTraceTag(538572830,369,10,"{0}",(Kb.manifestId=la,Kb.resource=I,Kb.error=Va,Kb))};pb.prototype.Pif=function(I){return I.replace("://",
"__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Ll.Object.defineProperties(pb.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(Md.a)(pb,"AuthenticationService",null,[]);ib.prototype.create=function(I,la){return new pb(I,la)};Object(Md.a)(ib,"AuthenticationServiceFactory",null,[]);var Qk=b(973),Jk=b(1105),Rk=b(1067);Pa.generalException="generalException";Pa.invalidArgument="invalidArgument";Pa.notAllowed="notAllowed";Pa.apiNotAvailable="apiNotAvailable";
Pa.unresolvedPendingRequest="unresolvedPendingRequest";Pa.timeout="timeout";Pa.adalTimeout="adalTimeout";Pa.userNotSignedIn="userNotSignedIn";Pa.userAborted="userAborted";Pa.silentSignInFailed="silentSignInFailed";Pa.invalidResourceUrl="invalidResourceUrl";Pa.invalidGrant="invalidGrant";Pa.connectionLost="connectionLost";Pa.clientError="clientError";Pa.serverError="serverError";Object(Md.a)(Pa,"WopiHostErrorCodes",null,[]);Object(Md.a)(xa,"OAuthCallerMetadata",null,[]);ma.prototype.Rmg=function(I,
la,Va,Kb,nc,Mc){var Yc=this;if(!this.Ova)return Kb=new Jk.a,Kb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Kb);var Ed=new xa;Ed.AddinName=nc;Ed.AddinTrustId=Mc;var re=-1;Mc=null;if(Kb&&this.O5e())Mc=this.Ova.V_f(Mg.a.suc,I,Kb,ma.BTe(nc),Ed);else{var pf=Date.now();Mc=this.Ova.aR(Mg.a.suc,I,Ed).then(function(Ze){re=Date.now()-pf;var cg=(la||Va)&&"login_required"===Ze.ErrorCode;return(la&&("interaction_required"===Ze.ErrorCode||"consent_required"===Ze.ErrorCode||"invalid_grant"===
Ze.ErrorCode)||cg)&&Yc.O5e()?Yc.Ova.V_f(Mg.a.suc,I,null,ma.BTe(nc),Ed):Promise.resolve(Ze)})}return Mc.then(function(Ze){var cg=new Jk.a;Ze.IsSuccess?(cg.token=Ze.Token,Ze.Telemetry&&(cg.LQa=Ze.Telemetry.fromCache,cg.expiresOn=Ze.Telemetry.expiresOn)):(cg.errorCode=Yc.fgi(Ze),cg.ONd=Yc.bEi(Ze));return cg}).catch(function(){var Ze=new Jk.a;Ze.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Ze)}).then(function(Ze){Ze.Hfa="OauthManager";0<=re&&(Ze.Vsb=re);return Ze})};
ma.prototype.q1h=function(I){var la=($f.AFrameworkApplication.ha.Ta($f.AFrameworkApplication.Bza)||"").toLowerCase();return(Li.a.nja||"teams"===la&&mi.a.aub)&&!ma.V0h(I)||!this.Ova||!this.Ova.NJa()?!1:!0};ma.prototype.O5e=function(){return this.Mbg||1!==Rk.a.G6b()};ma.prototype.fgi=function(I){switch(I.ErrorCode){case "UserCancelled":case "interaction_required":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;
break;case "login_required":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:I=I.ErrorCode===Pa.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:I.ErrorCode===
Pa.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:I.ErrorCode===Pa.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:I.ErrorCode===Pa.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:I.ErrorCode===Pa.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return I};ma.prototype.bEi=function(I){var la="";(I=RegExp("AADSTS(\\d+)").exec(I.ErrorMessage))&&
1<I.length&&(la=I[1]);return la};ma.BTe=function(I){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,I)};ma.V0h=function(I){if(!I)return!1;I=I.toLowerCase();for(var la=Ol(Qk.AppsForOfficeSingleSignOnManager.iLe),Va=la.next();!Va.done;Va=la.next())if(Va.value===I)return!0;return!1};Object(Md.a)(ma,"AppsforOfficeTokenFromOauthManager",null,[486]);na.Gma=function(){if($f.AFrameworkApplication.ha.sa("AppForOfficeSSOV2IsEnabled")){var I=null;try{I=oi.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(la){Je.ULS.sendTraceTag(592061330,
1300,10,"Unable to resolve IOAuthManager: "+la)}I=new ma(I);na.Ma=new na(I)}};na.getInstance=function(){na.w0d||(na.Gma(),na.w0d=!0);return na.Ma};na.Ma=null;na.w0d=!1;Object(Md.a)(na,"AppsForOfficeOauthManagerFactory",null,[476]);var Dk=b(128);Object(Md.a)(La,"NewDocumentParameters",null,[]);var al=b(253),c=b(154);ca.prototype.createAndOpenWorkbook=function(I){var la=this;if(I&&I.length>this.Xfg)throw Je.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",I.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.invalidArgument,
c.a.da(1693));var Va=new La("blank","agave",I?"streamBase64":"streamEmpty",I),Kb=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(nc,Mc){var Yc=new Dk.StandardDialog;Yc.hc=4;Yc.ul(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Ed){2!==Ed&&Ed?(Kb=window.open(""),la.tgg.create(nc,Mc,Va).HYa()):Mc("Cancelled")})}).then(function(nc){if(!nc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,
c.a.da(1689));try{Kb.top.location.href=nc}catch(Mc){Je.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Li.a.Co,Mc),Je.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Kb.location.replace(nc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(nc){if("Cancelled"===nc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.qvd,
c.a.da(1692));Kb.close();la.ypj();return null})};ca.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ca.prototype.invokePropertyGet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};ca.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};ca.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
};ca.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ca.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};ca.prototype.invokeMethodAsync=function(I,la){switch(I){case 1:return this.aSg(la)}I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};ca.prototype.aSg=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
0,"string");return this.createAndOpenWorkbook(I)};ca.prototype.ypj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,c.a.da(1689));};Object(Md.a)(ca,"WacWorkbook",null,[]);var k=b(840),D=b(850);Ll.Object.defineProperties(da.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ub}}});Object(Md.a)(da,"RichApiPreviewExecutionContext",null,[]);var ba=b(25),Ba=b(999),nb=b(195),Rb=b(198),Ic=b(114),Wc=b(11),Rd=Rb.a;Em(V,Rd);V.prototype.start=
function(I,la){var Va="<div class='"+Ic.a.zah+" "+gf.a.lr+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Ic.a.zT+"' /></div>";Va=String.format(Va,dd.a.Xf(this.a0c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Nb.innerHTML=Va;this.Mlb=Wc.DOMElementExtensions.getElementById(this.Nb,"bindingText");(I=th.a.ma(la)?null:I.F_a(la,this.a0c.DdaBindingsMethod.BindingId))&&I.IsValidRef?(la=new ba.Range(I.Reference.FirstRow+1,I.Reference.FirstColumn+
1,I.Reference.LastRow+1,I.Reference.LastColumn+1,!1,!1),this.Mlb.value=I.Reference.SheetName+"!"+la):(I=Hi.g(this.$).ga,this.Mlb.value=ui.f(this.$.qa)||!I.wa.xh?"":I.Lga);this.initialize();this.mf()};V.prototype.Zl=function(){this.HVc();this.addButton(0);this.addButton(1);Rd.prototype.Zl.call(this)};V.prototype.setFocus=function(){Wc.DOMElementExtensions.setFocus(this.Mlb)};V.prototype.validate=function(){return!0};V.prototype.commit=function(){var I=this.Mlb.value.trim(),la=I.indexOf("!");-1!==la&&
(I=this.fIh(I.substring(0,la))+I.substr(la));this.Nxe.addBinding(this.a0c,I,0,this.callback);return!0};V.prototype.HEa=function(){this.Nxe.lP.hf(k.a.internalError,this.callback);Rd.prototype.HEa.call(this)};V.prototype.fIh=function(I){I=th.a.trimStart(I.trim(),"=");return I.length?I.startsWith("'")&&I.endsWith("'")?I:bi.HelperMethods.P3b(I):""};Ll.Object.defineProperties(V.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(Md.a)(V,"DdaBindingPrompt",Rb.a,
[]);Y.prototype.hf=function(I,la){if(la){var Va={};Va.Error=I;Va.Version=this.fa.vf;la(Va)}};Y.prototype.RHa=function(I,la){this.hf(I,la)};Y.prototype.gG=function(I,la){this.hf(k.a.zMe(I.Errors[0].MessageId),la)};Y.prototype.iu=function(I){I&&I(this.PO())};Y.prototype.PO=function(){var I={Error:0};I.Version=this.fa.vf;return I};Object(Md.a)(Y,"DdaErrorGenerator",null,[]);var Ge=b(303),df=b(105);N.prototype.Dqd=function(I,la){function Va(Ed){var re=Kb.$.va.getItemByName(Ed.SheetName);re&&re.visible?
(Hi.g(Kb.$).ki(Ed,null,null,null,3,df.a.C_g,void 0,void 0,void 0,void 0,!0),Kb.lP.iu(la)):Kb.lP.hf(k.a.jIg,la)}var Kb=this,nc=I.DdaGoToByIdMethod.GoToType,Mc=I.DdaGoToByIdMethod.SelectionMode,Yc=I.DdaGoToByIdMethod.Id.toString().trim();nc?1===nc?this.lki(Yc,Mc,Va,la):this.lP.hf(k.a.Fvj,la):this.hki(Yc,Mc,I.DdaMethod.ControlId,Va,la)};N.prototype.hki=function(I,la,Va,Kb,nc){var Mc=this;this.Zy.ddaGetBinding(Va,I,function(Yc){if(!Ge.a(Yc)&&Yc.Result&&Yc.Result.Reference){Yc=Yc.Result;var Ed={};Ed.SheetName=
Yc.Reference.SheetName;Ed.FirstRow=Yc.Reference.FirstRow;Ed.FirstColumn=Yc.Reference.FirstColumn;Ed.LastRow=Yc.Reference.LastRow;Ed.LastColumn=Yc.Reference.LastColumn;N.vQc(Ed,la);1!==Yc.BindingType?Kb(Ed):Mc.Zy.ddaGetBindingData(Va,I,1,0,2,0,0,-1,-1,function(re){Ge.a(re)||!re.Result?Mc.lP.gG(re,nc):(re=re.Result,2!==la&&(Ed.FirstRow-=re.Headers.length,0>Ed.FirstRow&&(Ed.FirstRow=0)),Kb(Ed))},nc)}else Mc.lP.RHa(k.a.ZUf,nc)},nc)};N.prototype.lki=function(I,la,Va,Kb){var nc=this,Mc=ri.z(I);Mc?(Mc=ri.v(Mc,
this.$),N.vQc(Mc,la),Va(Mc)):this.$.fa.isNamedObjectViewMode&&this.$.wb.Aj(I)?this.$.wb.qa=this.$.wb.getItemByName(I):(Mc=function(Yc){Ge.a(Yc)||!Yc.Result?nc.$.va.contains(I)?(Yc={},Yc.SheetName=I,Yc.FirstRow=0,Yc.FirstColumn=0,Yc.LastRow=0,Yc.LastColumn=0,Va(Yc)):nc.lP.RHa(k.a.ZUf,Kb):(Yc=Yc.Result,N.vQc(Yc,la),Va(Yc))},this.$.va.qa?this.Zy.parseRangeForGoto(I,this.$.va.qa.name,Mc,Kb):this.Zy.parseRange(I,Mc,Kb))};N.vQc=function(I,la){I.LastRow=2===la?I.FirstRow:I.LastRow;I.LastColumn=2===la?I.FirstColumn:
I.LastColumn};Object(Md.a)(N,"DdaNavigator",null,[]);var Wf=b(289),Pg;(function(I){I[I.unsupported=0]="unsupported";I[I.surface=1]="surface";I[I.combo=2]="combo";I[I.column=3]="column";I[I.column3D=4]="column3D";I[I.bar=5]="bar";I[I.bar3D=6]="bar3D";I[I.line=7]="line";I[I.line3D=8]="line3D";I[I.pie=9]="pie";I[I.pie3D=10]="pie3D";I[I.scatter=11]="scatter";I[I.bubble=12]="bubble";I[I.area=13]="area";I[I.area3D=14]="area3D";I[I.doughnut=15]="doughnut";I[I.radar=16]="radar";I[I.stock=17]="stock";I[I.waterfall=
18]="waterfall";I[I.funnel=19]="funnel";I[I.treemap=20]="treemap";I[I.sunburst=21]="sunburst";I[I.boxWhisker=22]="boxWhisker";I[I.histogram=23]="histogram";I[I.pareto=24]="pareto";I[I.regionMap=25]="regionMap";I[I.noVisibleSeries=26]="noVisibleSeries";I[I.complexDataSource=27]="complexDataSource";I[I.pivotChart=28]="pivotChart"})(Pg||(Pg={}));Object(Md.b)("ChartCategory",Pg);Object(Md.a)(W,"MacroRecorderEventData",null,[]);fa.prototype.LGh=function(I){if(void 0===I||null===I||void 0===I.RequestBody||
null===I.RequestBody)return null;var la=JSON.parse(I.RequestBody);if(void 0!==I.ActiveChartId&&null!==I.ActiveChartId){la.ActiveChartId=I.ActiveChartId;var Va=Hi.g(this.$).ga.Pa.kc;Va&&Va.floatingObject&&Va.floatingObject.Nc&&(la.ActiveChartType=Pg[Va.floatingObject.Nc.ChartCategory])}void 0!==I.SheetMultiRange&&null!==I.SheetMultiRange&&(la.SheetName=I.SheetMultiRange.SheetName);return la};fa.prototype.SGh=function(I){if(void 0===I||null===I||void 0===I.Result||null===I.Result)return null;I=I.Result;
return void 0===I.ResponseBody||null===I.ResponseBody||I.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(I.ResponseBody.join(""))};fa.prototype.l5h=function(I){return!!I&&!(void 0===I.eventId||null===I.eventId)&&0<I.eventId.length};fa.prototype.Ll=function(I){var la=this;return function(){if(la.$.U$){var Va=la.tEg(la.request);if(la.l5h(Va)){var Kb=la.LGh(la.request),nc=la.SGh(I);if(Kb&&!ij.a.isEmpty(Kb)&&nc&&!ij.a.isEmpty(nc))return Je.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),
new Fd(Va,Kb,nc);Va=String.format("requestInfo: {0}; responseInfo: {1}",Kb?"(not null)":"(null)",nc?"(not null)":"(null)");Je.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Va)}}return new Fd(null,null,null)}};fa.prototype.tEg=function(I){var la=this.m5h(I.SolutionId),Va=fa.sGh(I);if(Va&&la)return la={},Je.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(la.recorderEventId=Va,la["request.SolutionId"]=I.SolutionId,la)),new W(I.SolutionId,
Va);var Kb={};Je.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(Kb.recorderEventId=Va,Kb.isRecorderAwareAddin=la,Kb["request.SolutionId"]=I.SolutionId,Kb));return null};fa.prototype.m5h=function(I){if(!I)return!1;I=I.toLowerCase();return fa.MLh().contains(I)};fa.MLh=function(){fa.Exa||(fa.Exa=new Wj.a(Lj.a.rl()),fa.Exa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),fa.Exa.add("fa000000005"),fa.Exa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),fa.Exa.add("fa000000014"),fa.Exa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return fa.Exa};fa.sGh=function(I){var la=null,Va=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Va.test(I.RequestBody))la=Va.exec(I.RequestBody)[1];else{I=I.RequestHeaders;if(!I)return la;Va=gj.a.lni.toLowerCase();for(var Kb=0;Kb<I.length;Kb++)if(I[Kb].Name.toLowerCase()===Va){la=I[Kb].Value;break}}return la};fa.Exa=null;Object(Md.a)(fa,"DdaRichApiRequestRecorder",null,[]);var Bg=b(65),qh=Wf.a;Em(aa,qh);aa.prototype.y1=function(I){return qh.prototype.y1.call(this,
I)||this.gHg(I)};aa.prototype.Ll=function(){return this.PEd.Ll(this.hd)};aa.prototype.kbb=function(){var I={OperationType:3};I.RichApiRequest=this.request;return I};aa.prototype.gHg=function(I){var la=this;return function(Va,Kb,nc){return G(I,la.request,di.b(Va,la.Sib),di.a(Kb,la.gfb),nc,la.q2)}};Ll.Object.defineProperties(aa.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ag.EwaSettings.pc()?Object(Bg.a)(aa.prototype,this,"operationWorkingState"):2}},Ewc:{configurable:!0,
enumerable:!0,get:function(){return this.mDa}},Oq:{configurable:!0,enumerable:!0,get:function(){return this.Sib}},V2:{configurable:!0,enumerable:!0,get:function(){return this.gfb}}});Object(Md.a)(aa,"DdaRichApiRequestBatchOperation",Wf.a,[]);var dj=Kj.a;Em(L,dj);L.prototype.Ll=function(){return this.PEd.Ll(this.hd)};Ll.Object.defineProperties(L.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ag.EwaSettings.pc()?Object(Bg.a)(L.prototype,this,"operationWorkingState"):
0}}});Object(Md.a)(L,"DdaRichApiRequestOperation",Kj.a,[]);Q.prototype.ddaAddBinding=function(I,la,Va,Kb,nc,Mc,Yc){var Ed=this;this.QI(function(re,pf,Ze){var cg=Ed.$.ra.ua,Ug=Ed.Qha();re=di.b(re,Mc);pf=di.a(pf,Object(qf.a)(Ed,Ed.kH,"onWebServiceFailed"));var rh=cg.Na(9);rh.controlId=I;rh.bindingId=la;rh.bindingType=Va;rh.currentSheetName=Ug;rh.formula=Kb;rh.options=nc;return Yi.i(cg,"DdaAddBinding",rh,re,pf,Ze,Yc,0)},Yc,563)};Q.prototype.ddaReleaseBinding=function(I,la,Va,Kb){var nc=this;this.QI(function(Mc,
Yc,Ed){var re=nc.$.ra.ua;Mc=di.b(Mc,Va);Yc=di.a(Yc,Object(qf.a)(nc,nc.kH,"onWebServiceFailed"));var pf=re.Na(9);pf.controlId=I;pf.bindingId=la;return Yi.i(re,"DdaReleaseBinding",pf,Mc,Yc,Ed,Kb,0)},Kb,564)};Q.prototype.ddaGetBinding=function(I,la,Va,Kb){var nc=this;this.QI(function(Mc,Yc,Ed){var re=nc.$.ra.ua;Mc=di.b(Mc,Va);Yc=di.a(Yc,Object(qf.a)(nc,nc.kH,"onWebServiceFailed"));var pf=re.Na(1);pf.controlId=I;pf.bindingId=la;return Yi.i(re,"DdaGetBinding",pf,Mc,Yc,Ed,Kb,0)},Kb,565,16)};Q.prototype.ddaGetAllBindings=
function(I,la,Va){var Kb=this;this.QI(function(nc,Mc,Yc){var Ed=Kb.$.ra.ua;nc=di.b(nc,la);Mc=di.a(Mc,Object(qf.a)(Kb,Kb.kH,"onWebServiceFailed"));var re=Ed.Na(1);re.controlId=I;return Yi.i(Ed,"DdaGetAllBindings",re,nc,Mc,Yc,Va,0)},Va,566,16)};Q.prototype.ddaGetBindingData=function(I,la,Va,Kb,nc,Mc,Yc,Ed,re,pf,Ze){var cg=this;this.QI(function(Ug,rh,Lh){var nh=cg.$.ra.ua,Ki=cg.Qha();Ug=di.b(Ug,pf);rh=di.a(rh,Object(qf.a)(cg,cg.kH,"onWebServiceFailed"));var Wh=nh.Na(1);Wh.controlId=I;Wh.bindingId=la;
Wh.coerceType=Va;Wh.valueFormat=Kb;Wh.filterType=nc;Wh.startRow=Mc;Wh.startCol=Yc;Wh.rowCount=Ed;Wh.colCount=re;Wh.currentSheetName=Ki;return Yi.i(nh,"DdaGetBindingData",Wh,Ug,rh,Lh,Ze,0)},Ze,567,16)};Q.prototype.ddaSetBindingData=function(I,la,Va,Kb,nc,Mc,Yc){var Ed=this;this.QI(function(re,pf,Ze){var cg=Ed.$.ra.ua,Ug=Ed.Qha();re=di.b(re,Mc);pf=di.a(pf,Object(qf.a)(Ed,Ed.kH,"onWebServiceFailed"));var rh=cg.Na(9);rh.controlId=I;rh.bindingId=la;rh.startRow=Va;rh.startCol=Kb;rh.currentSheetName=Ug;
rh.bindingData=nc;return Yi.i(cg,"DdaSetBindingData",rh,re,pf,Ze,Yc,0)},Yc,568)};Q.prototype.ddaGetSelectedData=function(I,la,Va,Kb,nc,Mc,Yc){var Ed=this;this.QI(function(re,pf,Ze){var cg=Ed.$.ra.ua,Ug=Ed.Qha();re=di.b(re,Mc);pf=di.a(pf,Object(qf.a)(Ed,Ed.kH,"onWebServiceFailed"));var rh=cg.Na(1);rh.controlId=I;rh.coerceType=la;rh.valueFormat=Va;rh.filterType=Kb;rh.currentSheetName=Ug;rh.formula=nc;return Yi.i(cg,"DdaGetSelectedData",rh,re,pf,Ze,Yc,0)},Yc,569,16)};Q.prototype.ddaSetSelectedData=function(I,
la,Va,Kb,nc){var Mc=this;this.QI(function(Yc,Ed,re){var pf=Mc.$.ra.ua,Ze=Mc.Qha();Yc=di.b(Yc,Kb);Ed=di.a(Ed,Object(qf.a)(Mc,Mc.kH,"onWebServiceFailed"));var cg=pf.Na(9);cg.controlId=I;cg.currentSheetName=Ze;cg.formula=la;cg.bindingData=Va;return Yi.i(pf,"DdaSetSelectedData",cg,Yc,Ed,re,nc,0)},nc,570)};Q.prototype.ddaLoadSettings=function(I,la,Va){var Kb=this;this.QI(function(nc,Mc,Yc){var Ed=Kb.$.ra.ua;nc=di.b(nc,la);Mc=di.a(Mc,Object(qf.a)(Kb,Kb.kH,"onWebServiceFailed"));var re=Ed.Na(1);re.controlId=
I;return Yi.i(Ed,"DdaLoadSettings",re,nc,Mc,Yc,Va,0)},Va,501,16)};Q.prototype.ddaSaveSettings=function(I,la,Va,Kb,nc){var Mc=this;this.QI(function(Yc,Ed,re){var pf=Mc.$.ra.ua;Yc=di.b(Yc,Kb);Ed=di.a(Ed,Object(qf.a)(Mc,Mc.kH,"onWebServiceFailed"));var Ze=pf.Na(9);Ze.controlId=I;Ze.settings=la;Ze.overwriteIfStale=Va;return Yi.i(pf,"DdaSaveSettings",Ze,Yc,Ed,re,nc,0)},nc,571)};Q.prototype.ddaAddRowsColumns=function(I,la,Va,Kb,nc,Mc){var Yc=this;this.QI(function(Ed,re,pf){var Ze=Yc.$.ra.ua,cg=Yc.Qha();
Ed=di.b(Ed,nc);re=di.a(re,Object(qf.a)(Yc,Yc.kH,"onWebServiceFailed"));var Ug=Ze.Na(9);Ug.controlId=I;Ug.bindingId=la;Ug.isRow=Va;Ug.currentSheetName=cg;Ug.bindingData=Kb;return Yi.i(Ze,"DdaAddRowsColumns",Ug,Ed,re,pf,Mc,0)},Mc,572)};Q.prototype.ddaDeleteAllDataValues=function(I,la,Va,Kb){var nc=this;this.QI(function(Mc,Yc,Ed){var re=nc.$.ra.ua,pf=nc.Qha();Mc=di.b(Mc,Va);Yc=di.a(Yc,Object(qf.a)(nc,nc.kH,"onWebServiceFailed"));var Ze=re.Na(9);Ze.controlId=I;Ze.bindingId=la;Ze.currentSheetName=pf;return Yi.i(re,
"DdaDeleteAllDataValues",Ze,Mc,Yc,Ed,Kb,0)},Kb,573)};Q.prototype.ddaClearBindingFormats=function(I,la,Va,Kb){var nc=this;this.QI(function(Mc,Yc,Ed){var re=nc.$.ra.ua,pf=nc.Qha();Mc=di.b(Mc,Va);Yc=di.a(Yc,Object(qf.a)(nc,nc.kH,"onWebServiceFailed"));var Ze=re.Na(9);Ze.controlId=I;Ze.bindingId=la;Ze.currentSheetName=pf;return Yi.i(re,"DdaClearBindingFormats",Ze,Mc,Yc,Ed,Kb,0)},Kb,574)};Q.prototype.ddaSetBindingFormats=function(I,la,Va,Kb,nc,Mc){var Yc=this;this.QI(function(Ed,re,pf){var Ze=Yc.$.ra.ua,
cg=Yc.Qha();Ed=di.b(Ed,nc);re=di.a(re,Object(qf.a)(Yc,Yc.kH,"onWebServiceFailed"));var Ug=Ze.Na(9);Ug.controlId=I;Ug.bindingId=la;Ug.currentSheetName=cg;Ug.bindingData=Va;Ug.isSetFormats=Kb;return Yi.i(Ze,"DdaSetBindingFormats",Ug,Ed,re,pf,Mc,0)},Mc,575)};Q.prototype.parseRange=function(I,la,Va){var Kb=this;this.QI(function(nc,Mc,Yc){var Ed=Kb.$.ra.ua.Wb();return Yi.P(Kb.$.ra.ua,I,-1,di.b(nc,la),di.a(Mc,Object(qf.a)(Kb,Kb.kH,"onWebServiceFailed")),Yc,Va,Ed)},Va,162,16)};Q.prototype.parseRangeForGoto=
function(I,la,Va,Kb){var nc=this;this.QI(function(Mc,Yc,Ed){var re=nc.$.ra.ua.Wb();return Yi.Q(nc.$.ra.ua,I,la,di.b(Mc,Va),di.a(Yc,Object(qf.a)(nc,nc.kH,"onWebServiceFailed")),Ed,Kb,re)},Kb,562,16)};Q.prototype.executeRichApiRequest=function(I,la,Va){var Kb=this;ag.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(I.RequestFlags&=8191);if(ag.EwaSettings.ka(261))this.mjh(this.$.ra.ua.Wb(),la,function(){Kb.lP.RHa(k.a.internalError,Va)},Va,I);else{var nc=Uh.DdaFacade.G$c(I);
!ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.zb.xJ||nc&16?(ag.EwaSettings.pc()&&(nc|=64),this.$.userOperationManager.ft(new L(this.$,I,function(Mc,Yc,Ed){return G(Kb.$.ra.ua,I,di.b(Mc,la),di.a(Yc,Object(qf.a)(Kb,Kb.kH,"onWebServiceFailed")),Ed,Va)},nc))):(this.lP.RHa(k.a.zxc,Va),Je.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};Q.prototype.Qha=function(){return this.$.fa.isNamedObjectViewMode?this.$.qa.sheetName:this.$.activeItemName};
Q.prototype.kH=function(I,la){this.lP.RHa(k.a.internalError,la)};Q.prototype.QI=function(I,la,Va,Kb){Kb=void 0===Kb?0:Kb;!ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.zb.xJ||Kb&16?ag.EwaSettings.pc()?this.$.userOperationManager.ft(new Kj.a(Va,0,I,Kb|64)):this.$.userOperationManager.ft(new Pj.a(Va,0,I,Kb)):(this.lP.RHa(k.a.zxc,la),Je.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};Q.prototype.mjh=function(I,la,Va,Kb,nc){var Mc=
Uh.DdaFacade.G$c(nc);if(!ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.zb.xJ||Mc&16){var Yc=this.$.Vb.Dc("UserAction","Rich Api request");ag.EwaSettings.pc()&&(Mc|=64);this.$.userOperationManager.jc(new aa(this.$,I,la,Va,Kb,Yc,nc,Mc),null)}else this.lP.RHa(k.a.zxc,Kb),Je.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(Md.a)(Q,"DdaWebServiceHelper",null,[]);Object(Md.a)(S,"DocumentFile",null,[]);H.generalException="GeneralException";
H.Uwg="ApiNotFound";H.qvd="OperationCancelled";H.invalidArgument="InvalidArgument";Object(Md.a)(H,"ErrorCodes",null,[]);A.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};A.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};A.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(Md.a)(A,"WacApiDelegates",null,[]);var vi=b(650);Em(E,
A);E.prototype.replaceShortcuts=function(I){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,I,Object(qf.a)(this,this.x8e,"isShortcutKeyUsedByHost"))};E.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};E.prototype.checkShortcutsInUse=function(I){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(I,Object(qf.a)(this,this.x8e,"isShortcutKeyUsedByHost"))};E.prototype.x8e=function(I,la){I=E.CQg(I,la);if(!vi.a(this.$,
I))return!0;I=this.$.shortcutKeyManager.JUe(I);return!!I&&0<I.length};E.XUg=function(I,la){var Va=document.createEvent("KeyboardEvent");if(Li.a.gE)Va.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(I&8),!!(I&32),!!(I&4),!!(I&256));else{var Kb=[];I&4&&Kb.push("Shift");I&8&&Kb.push("Control");I&32&&Kb.push("Alt");Va.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,Kb,!1,"en-US")}I=new Sys.UI.DomEvent(Va);I.keyCode=la;return I};E.CQg=function(I,la){if(Li.a.uf)switch(la){case 189:la=173;break;
case 187:la=61;break;case 186:la=59}return E.XUg(I,la)};Object(Md.a)(E,"ExcelWacApiDelegates",A,[]);J.prototype.uog=function(I,la){this.K9b(I)||(this.zGa[I]={});if(this.U0h(I))return Je.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",I),k.a.vhi;this.zGa[I][la.alh.toString()]=la;return k.a.success};J.prototype.Ayh=function(I,la){var Va=null;this.K9b(I)&&(Va=this.zGa[I][la.toString()]);Va||Je.ULS.sendTraceTag(537163156,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",
I,la);return Va};J.prototype.K9b=function(I){return I in this.zGa};J.prototype.DRi=function(I,la){if(this.K9b(I)){var Va=this.zGa[I];delete Va[la.toString()];1>Object.keys(Va).length&&delete this.zGa[I];return la.toString()in Va?k.a.internalError:k.a.success}return k.a.internalError};J.prototype.U0h=function(I){return this.K9b(I)?Object.keys(this.zGa[I]).length>=this.Rgi:!1};J.getInstance=function(I){return I.ea.Ba(200)||I.ea.Ia(200,new J(J.Sgi))};J.Tki=function(){return++J.wGg};J.ygi=4194304;J.Sgi=
1;J.wGg=0;Object(Md.a)(J,"GetFileApiHelper",null,[]);y.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.oz)};y.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};y.prototype.invokePropertyGet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};y.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};
y.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};y.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype.invokeMethod=function(I){switch(I){case 1:return this.Ali()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};y.prototype.invokeMethodAsync=function(I,la){I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};
y.prototype.Ali=function(){this.notifyActionHandlerReady();return null};Object(Md.a)(y,"AddinInternalService",null,[]);x.prototype.getAppRuntimeState=function(){return this.bI.getAppRuntimeState(this.oz)?2:1};x.prototype.setAppRuntimeState=function(I){switch(I){case 2:I=!0;break;case 1:I=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.invalidArgument,c.a.da(1693));}this.bI.setAppRuntimeState(this.oz,I)};x.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};
x.prototype.invokePropertyGet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};x.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};x.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};x.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
x.prototype.invokeMethod=function(I,la){switch(I){case 2:return this.Zth();case 1:return this.h6i(la)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};x.prototype.invokeMethodAsync=function(I,la){I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};x.prototype.Zth=function(){return this.getAppRuntimeState()};x.prototype.h6i=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");this.setAppRuntimeState(I);
return null};Object(Md.a)(x,"AppRuntimeService",null,[]);var $i=b(1107);z.prototype.disable=function(){try{if(!c.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.Que();if(!this.b8e())return this.Rue();this.r0.Muj(this.$u)}catch(I){return Je.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",I.message||"Unknown"),this.Oue()}return null};z.prototype.enable=function(){try{if(!c.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.Que();
if(!this.b8e())return this.Rue();this.r0.RPi(this.$u)}catch(I){return Je.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",I.message||"Unknown"),this.Oue()}return null};z.prototype._OnAccess=function(){};z.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};z.prototype.invokePropertyGet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};z.prototype.invokePropertyGetAsync=
function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};z.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};z.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};z.prototype.invokeMethod=function(I){switch(I){case 1:return this.wAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
};z.prototype.invokeMethodAsync=function(I,la){switch(I){case 3:return this.b3g();case 2:return this.h8g()}I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};z.prototype.b3g=function(){return this.disable()};z.prototype.h8g=function(){return this.enable()};z.prototype.wAa=function(){this._OnAccess();return null};z.prototype.Que=function(){return $i.a(Pi.a.notImplemented,c.a.da(1694))};z.prototype.Rue=function(){return $i.a(Pi.a.sharedRuntimeNotAvailable,
c.a.da(1698))};z.prototype.Oue=function(){return $i.a(Pi.a.generalException,c.a.da(1689))};z.prototype.b8e=function(){var I=this.Gx.getSharedRuntimeId();return!!I&&0<I.length};Object(Md.a)(z,"BeforeDocumentCloseNotification",null,[]);B.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};B.prototype.invokePropertyGet=function(I){switch(I){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
};B.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};B.prototype.invokePropertySet=function(I,la){switch(I){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,
"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};B.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};B.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};B.prototype.invokeMethodAsync=function(I,la){I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};Ll.Object.defineProperties(B.prototype,
{enabled:{configurable:!0,enumerable:!0,get:function(){return this.iz},set:function(I){this.iz=I}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.V4d},set:function(I){this.V4d=I}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.O$d},set:function(I){this.O$d=I}}});Object(Md.a)(B,"CustomFunctionEngineStatus",null,[]);t.prototype.register=function(I){return OfficeExtension.WacRuntime.Utility.createPromise(this.hig(I))};t.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};
t.prototype.invokePropertyGet=function(I){switch(I){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};t.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};t.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};t.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
t.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};t.prototype.invokeMethodAsync=function(I,la){switch(I){case 1:return this.CQi(la)}I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};t.prototype.CQi=function(I){var la=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"string");return this.register(la,I)};Ll.Object.defineProperties(t.prototype,
{status:{configurable:!0,enumerable:!0,get:function(){var I=new B;I.enabled=this.peg;I.streamingEnabled=this.qeg;I.nativeRuntime=!1;return I}}});Object(Md.a)(t,"CustomFunctionManager",null,[]);var jk=b(1063);w.prototype._RegisterStateChange=function(){var I=this;this.mOb||this.NN.execute(function(la){I.bWd=la.ONa(I._id,function(Va){I.bI.fnh(I.oz,I._id,JSON.stringify(Va))})});this.mOb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype._UnregisterStateChange=function(){var I=
this;this.mOb--;this.mOb||this.NN.execute(function(la){la.uBd(I._id,I.bWd)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};w.prototype.invokePropertyGet=function(I){switch(I){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};w.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};
w.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};w.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};w.prototype.invokeMethodAsync=function(I,la){switch(I){case 6:return this.Y8f();case 7:return this.$8f()}I=this.invokeMethod(I,
la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};w.prototype.Y8f=function(){return this._RegisterStateChange()};w.prototype.$8f=function(){return this._UnregisterStateChange()};Ll.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(Md.a)(w,"LicenseFeature",null,[]);v.prototype.getFeatureTier=function(I,la){var Va=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Kb){var nc=1===la?1:2===la?2:0;
Va.NN.execute(function(Mc){Mc.getFeatureTier(I,nc).then(function(Yc){Kb(Va.zCh(Yc))},function(){Kb(la)})})})};v.prototype.getLicenseFeature=function(I){I=new w(this.NN,I,this.oz,this.bI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};v.prototype.isFeatureEnabled=function(I,la){var Va=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Kb){Va.NN.execute(function(nc){nc.isFeatureEnabled(I,la).then(function(Mc){Kb(Mc)},function(){Kb(la)})})})};v.prototype.isFreemiumUpsellEnabled=
function(){var I=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(la){I.NN.execute(function(Va){Va=Va.isFreemiumUpsellEnabled();la(Va)})})};v.prototype.launchUpsellExperience=function(I){var la=this;if(this.Zgg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){la.NN.execute(function(Va){Va.launchUpsellExperience(I)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.GNc,"");};v.prototype._TestFireStateChangedEvent=function(){};
v.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};v.prototype.invokePropertyGet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};v.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};v.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};v.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,
la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(I,la){switch(I){case 6:return this.Z8f(la)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};v.prototype.invokeMethodAsync=function(I,la){switch(I){case 2:return this.uzh(la);case 5:return this.yCh(la);case 1:return this.G1h(la);case 3:return this.i2h();case 4:return this.O$h(la)}I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};
v.prototype.uzh=function(I){var la=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"int");return this.getFeatureTier(la,I)};v.prototype.yCh=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getLicenseFeature(I)};v.prototype.G1h=function(I){var la=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
1,"boolean");return this.isFeatureEnabled(la,I)};v.prototype.i2h=function(){return this.isFreemiumUpsellEnabled()};v.prototype.O$h=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.launchUpsellExperience(I)};v.prototype.Z8f=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");this._TestFireStateChangedEvent(I);return null};v.prototype.zCh=function(I){switch(I){case 1:return 1;case 2:return 2;default:return 0}};Object(Md.a)(v,
"License",null,[]);var sk=b(147);r.prototype.areShortcutsInUse=function(I){var la=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Va,Kb){la.Tod.checkShortcutsInUse(I).then(function(nc){Va(nc)}).catch(function(nc){Kb(nc)})})};r.prototype.getShortcuts=function(){var I=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(la,Va){I.Tod.getShortcuts().then(function(Kb){la(Kb)}).catch(function(Kb){Va(Kb)})})};r.prototype.replaceShortcuts=function(I){var la=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Va,
Kb){la.Tod.replaceShortcuts(I).then(function(){Va(null)}).catch(function(nc){Kb(nc)})})};r.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};r.prototype.invokePropertyGet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};r.prototype.invokePropertyGetAsync=function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};r.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
};r.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};r.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};r.prototype.invokeMethodAsync=function(I,la){switch(I){case 3:return this.Cyg(la);case 1:return this.jIh();case 2:return this.fXi(la)}I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};r.prototype.Cyg=
function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"Array<string>");return this.areShortcutsInUse(I)};r.prototype.jIh=function(){return this.getShortcuts()};r.prototype.fXi=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"any");return this.replaceShortcuts(I)};Object(Md.a)(r,"ActionService",null,[]);var Ek=b(520);n.prototype.$Hh=function(){this.Jea||(this.Jea=Ek.a.mq(oi.a.instance.oc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Jea};
n.prototype.getSharedFilePickerResponse=function(I){var la=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Va,Kb){try{var nc=la.$Hh();Gj.Task.WAA.call(null,nc).continueWith(function(){var Mc=nc.result;if(Mc){var Yc={};(function(){var Ed=yh.d(I);Yc=Ed.eu;return Ed})().returnValue?Mc.D7b(Yc).then(function(Ed){Ed&&0<Ed.length?Va(Ed):Kb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(function(Ed){Kb(Ed)}):
Kb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Kb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Mc){Kb(Mc)}})};n.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};n.prototype.invokePropertyGet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};n.prototype.invokePropertyGetAsync=
function(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};n.prototype.invokePropertySet=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};n.prototype.invokePropertySetAsync=function(I,la){this.invokePropertySet(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);};n.prototype.invokeMethodAsync=
function(I,la){switch(I){case 1:return this.ZHh(la)}I=this.invokeMethod(I,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)};n.prototype.ZHh=function(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getSharedFilePickerResponse(I)};Object(Md.a)(n,"SharedFilePicker",null,[]);l.prototype.createInstance=function(I,la){switch(I){case "Microsoft.Office.ActionService":return new r(la);case "Microsoft.Office.SharedFilePicker":return new n}return null};
Object(Md.a)(l,"WacApiHost",null,[]);d.prototype.hostName=function(){return"ExcelOnline"};d.prototype.appId=function(){return this.uMb};d.prototype.createInstance=function(I){switch(I){case "Microsoft.Authentication.AuthenticationService":return oi.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.oz,this.bI.sh);case "Microsoft.Authentication.TokenParameters":return new xb;case "Microsoft.ExcelServices.CustomFunctionManager":I=this.ub.ka(121);
var la=this.ub.ka(122);return new t(I,la,h(this.uMb,this.ub,this.bI));case "Microsoft.AppRuntime.AppRuntimeService":return new x(this.oz,this.bI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return I=Ri.a(this.ub),new z(this.uMb,this.oz,I,this.bI);case "Microsoft.DynamicRibbon.DynamicRibbon":return I=Ri.a(this.ub),new jk.DynamicRibbon(this.uMb,this.oz,this.bI,I,I.Pm(this.oz).Wk);case "Microsoft.Office.Licensing.License":return new v(this.oz,this.bI);case "Microsoft.InternalService.AddinInternalService":return new y(this.oz);
default:if(this.nNc||(this.nNc=new l),la=this.nNc.createInstance(I,this.kmg))return la}Je.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",I);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Pi.a.generalException,Pi.a.generalException);};Object(Md.a)(d,"RichApiHost",null,[]);var Xk=b(379),Sk=b(113),Kk=b(32),gl=b(95),hl=b(280),il=b(39),jl=b(246),fl=b(6),Lk=b(64),bl=b(186);e.prototype.dispose=function(){this.$=this.f5c=
null};e.prototype.Wc=function(){return!1};e.prototype.Yc=function(){return!1};e.prototype.executeCommand=function(I,la,Va){I=la.command;switch(I){case 451041795:this.pe.hf(Va[wi.a.Hj],Va[wi.a.q2]);break;case 974713501:this.kOh(Va[wi.a.Hj],Va[wi.a.q2]);break;case 1237877382:this.pe.iu(Va[wi.a.q2]);break;default:return dk.a(I)}return Gj.Task.Ra(!0)};e.prototype.Ec=function(I,la,Va){if(I=!!Va)switch(la.command){case 974713501:case 1237877382:case 451041795:break;default:I=!1}return I};e.prototype.kOh=
function(I,la){var Va=I.DdaMethod;if("undefined"===typeof Va.DispatchId)this.pe.hf(k.a.internalError,la);else if(e.O0h(I)||this.$.zd&1){if(Va.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new V(this.$,this,I,la)).start(this.se,I.DdaMethod.ControlId):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.zHh(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.w$i(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(I,this.S8c(I.DdaMethod.ControlId),0,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.Euh(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.r6i(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.Duh(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.CRi(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.Eth(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.fnd(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(I.DdaAddRowsColumns.IsRow=!0,this.wee(I,la)):Va.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(I.DdaAddRowsColumns.IsRow=!1,this.wee(I,la)):Va.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.P0g(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.WKg(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(I.DdaSetBindingFormats.IsSetFormats=!0,this.gNf(I,la)):Va.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(I.DdaSetBindingFormats.IsSetFormats=!1,this.gNf(I,la)):Va.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(I,I.DdaBindingsMethod.ItemName,I.DdaBindingsMethod.FailOnCollision?2:1,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.yzh(la):Va.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.Dqd(I,la):Va.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.xyh(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.yyh(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.ERi(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(I.DdaMethod.ControlId,I),this.pe.iu(la)):
Va.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?ag.EwaSettings.ka(24)?this.pe.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,la):this.cii(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?ag.EwaSettings.ka(24)?this.pe.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,la):this.Zhi(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(I,la):Va.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(I,la):this.pe.hf(k.a.tvd,la),ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Va.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){I=this.se.HT(I.DdaMethod.ControlId);la="";if(I){la=Uh.DdaFacade.getSolutionId(I,this.$);var Kb=I.PrimaryMarketplace.MarketplaceType;Kb===OSF.StoreType.InMemory?I.OwnerAddinAssetId&&I.AssetMarketplace&&(Kb=I.AssetMarketplace.MarketplaceType):Kb===OSF.StoreType.WopiCatalog&&(Kb=OSF.StoreType.OMEX);
la=Telemetry.PrivacyRules.GetAssetId(Kb,I.PrimaryMarketplace.MarketplaceRef,la)}Je.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",Va.DispatchId,la)}}else this.pe.hf(k.a.MAe,la)};e.prototype.Euh=function(I,la){var Va=this;I.DdaGetBindingData.CoerceType=e.GZb(I.DdaGetBindingData.CoerceType);I.DdaGetBindingData.FilterType=e.sKe(I.DdaGetBindingData.FilterType);I.DdaGetBindingData.ValueFormat=e.L4f(I.DdaGetBindingData.ValueFormat);if(this.Ddc(I.DdaGetBindingData.CoerceType,la)){if(I.DdaGetBindingData){var Kb=
I.DdaGetBindingData;Kb.FilterType||(Kb.FilterType=2);Kb.StartCol|=0;Kb.StartRow|=0;Kb.ColCount=void 0===Kb.ColCount?-1:Kb.ColCount;Kb.RowCount=void 0===Kb.RowCount?-1:Kb.RowCount}this.Zy.ddaGetBindingData(I.DdaMethod.ControlId,I.DdaGetBindingData.BindingId,I.DdaGetBindingData.CoerceType,I.DdaGetBindingData.ValueFormat,I.DdaGetBindingData.FilterType,I.DdaGetBindingData.StartRow,I.DdaGetBindingData.StartCol,I.DdaGetBindingData.RowCount,I.DdaGetBindingData.ColCount,function(nc){if(Ge.a(nc)||!nc.Result)Va.pe.gG(nc,
la);else{var Mc=Va.pe.PO();Mc.Data=e.rme(nc.Result);la(Mc)}},la)}};e.prototype.r6i=function(I,la){var Va=this;I.DdaSetBindingData.CoerceType=e.GZb(I.DdaSetBindingData.CoerceType);if(this.Ddc(I.DdaSetBindingData.CoerceType,la)){var Kb=e.bTc(I.DdaSetBindingData.CoerceType,I.DdaSetBindingData.Data);e.$ac(Kb)?this.pe.hf(k.a.zvc,la):(1===Kb.CoerceType&&(Kb.CellFormat||(Kb.CellFormat=I.DdaSetBindingData.CellFormat),Kb.TableOptions||(Kb.TableOptions=I.DdaSetBindingData.TableOptions)),I.DdaSetBindingData&&
(I.DdaSetBindingData.StartCol|=0,I.DdaSetBindingData.StartRow|=0),this.Zy.ddaSetBindingData(I.DdaMethod.ControlId,I.DdaSetBindingData.BindingId,I.DdaSetBindingData.StartRow,I.DdaSetBindingData.StartCol,Kb,function(nc){Ge.a(nc)?Va.pe.gG(nc,la):Va.pe.iu(la)},la))}};e.prototype.zHh=function(I,la){var Va=this;I.DdaGetBindingData.CoerceType=e.GZb(I.DdaGetBindingData.CoerceType);I.DdaGetBindingData.ValueFormat=e.L4f(I.DdaGetBindingData.ValueFormat);I.DdaGetBindingData.FilterType=e.sKe(I.DdaGetBindingData.FilterType);
if(this.Ddc(I.DdaGetBindingData.CoerceType,la)){var Kb=this.S8c(I.DdaMethod.ControlId);th.a.ma(Kb)?this.pe.hf(k.a.rUe,la):this.Zy.ddaGetSelectedData(I.DdaMethod.ControlId,I.DdaGetBindingData.CoerceType,I.DdaGetBindingData.ValueFormat,I.DdaGetBindingData.FilterType,Kb,function(nc){if(Ge.a(nc))Va.pe.gG(nc,la);else{var Mc=Va.pe.PO();Mc.Data=e.rme(nc.Result);la(Mc)}},la)}};e.prototype.xyh=function(I,la){var Va=this;if(Li.a.did)this.pe.hf(k.a.CCg,la);else{var Kb=I[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],
nc=I[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Mc=I.DdaMethod.ControlId,Yc=J.getInstance(this.$);if(0>=nc)Je.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.pe.hf(k.a.RYh,la);else if(nc>J.ygi)Je.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.pe.hf(k.a.HPe,la);else{var Ed=null;switch(Kb){case 1:Ed="Compressed";break;case 0:Ed="Text";break;case 2:Ed="Pdf";break;default:Je.ULS.sendTraceTag(537163219,
344,15,"Requested file type {0} is not supported.",Kb);this.pe.hf(k.a.fKe,la);return}if("Text"===Ed)Je.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Ed),this.pe.hf(k.a.fKe,la);else{ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(I=new Sys.StringBuilder,I.append(Ba.a(this.$,Ed)),"Pdf"===Ed&&nb.a.lg(I,gj.a.Syd,"WholeWorkbook"),I=I.toString()):I=Ba.a(this.$,Ed);var re=null,pf=new XMLHttpRequest;pf.onreadystatechange=function(){if(4===
pf.readyState)if(200===pf.status){var Ze=pf.response;if(Ze){re=new Uint8Array(Ze);Ze=Va.pe.PO();for(var cg=re.length,Ug=J.Tki(),rh={},Lh=0,nh=0;nh<cg;nh+=nc){for(var Ki=[],Wh=nh+nc<cg?nh+nc:cg,si=0,Ti=nh;Ti<Wh;si++,Ti++)Ki[si]=re[Ti];rh[(Lh++).toString()]=Ki}rh=new S(Ug,cg,nc,rh);rh=Yc.uog(Mc,rh);rh!==k.a.success?Va.pe.hf(rh,la):(Ze[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Ug,Ze[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=cg,Je.ULS.sendTraceTag(537163216,344,
50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Ed,cg),la(Ze))}else Je.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Ed),Va.pe.hf(k.a.internalError,la)}else 500===pf.status?Va.pe.hf(k.a.zMe(parseInt(pf.statusText)),la):(Je.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",Ed),Va.pe.hf(k.a.Aki,la))};pf.open("GET",I,!0);pf.responseType="arraybuffer";pf.setRequestHeader("If-Modified-Since",
"0");pf.send(null)}}}};e.prototype.yyh=function(I,la){var Va=I[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],Kb=I[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];I=I.DdaMethod.ControlId;(Va=J.getInstance(this.$).Ayh(I,Va))?(Va=Va.Yij,0>Kb||Kb>=Object.keys(Va).length?this.pe.hf(k.a.OTh,la):(Kb=Va[Kb.toString()],Va=this.pe.PO(),Va[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=Kb,Va[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=Kb.length,la(Va))):
this.pe.hf(k.a.internalError,la)};e.prototype.ERi=function(I,la){var Va=I[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];I=I.DdaMethod.ControlId;Va=J.getInstance(this.$).DRi(I,Va);Va===k.a.success?this.pe.iu(la):this.pe.hf(Va,la)};e.prototype.w$i=function(I,la){var Va=this;I.DdaSetBindingData.CoerceType=e.GZb(I.DdaSetBindingData.CoerceType);if(this.Ddc(I.DdaSetBindingData.CoerceType,la)){var Kb=this.S8c(I.DdaMethod.ControlId);if(th.a.ma(Kb))this.pe.hf(k.a.Eoe,la);else{var nc=e.bTc(I.DdaSetBindingData.CoerceType,
I.DdaSetBindingData.Data),Mc=Hi.g(this.$).ga;1===nc.CoerceType&&(!nc.Data&&Mc.wa.tU&&(nc.Headers||(nc.Headers=[]),nc.Headers.length||Array.add(nc.Headers,[]),nc.Headers[0].length||Array.add(nc.Headers[0],"")),e.$ac(nc)||(nc.CellFormat||(nc.CellFormat=I.DdaSetBindingData.CellFormat),nc.TableOptions||(nc.TableOptions=I.DdaSetBindingData.TableOptions)));if(e.$ac(nc))this.pe.hf(k.a.zvc,la);else{var Yc=Mc.wa.Nd.clone(),Ed=Mc.wa.activeCell.clone();this.Zy.ddaSetSelectedData(I.DdaMethod.ControlId,Kb,nc,
function(re){if(Ge.a(re))Va.pe.gG(re,la);else{re=Yc.clone();var pf=nc.Headers?nc.Headers[0].length:nc.Data[0].length;1!==nc.CoerceType||nc.Data?1===nc.CoerceType&&nc.TableOptions&&nc.TableOptions.length&&0==nc.TableOptions[0]?(re.top+=1,re.bottom=re.top+nc.Data.length-1):re.bottom=re.top+nc.Data.length-(1===nc.CoerceType?0:1):re.bottom=re.top+1;re.right=re.left+pf-1;pf=re.contains(Ed)?Ed:re.topLeft;Mc.updateSelection(re,pf,0);Va.pe.iu(la)}},la)}}}};e.prototype.addBinding=function(I,la,Va,Kb){var nc=
this;la?this.Zy.ddaAddBinding(I.DdaMethod.ControlId,I.DdaBindingsMethod.BindingId,I.DdaBindingsMethod.BindingType,la,Va,function(Mc){if(Ge.a(Mc))nc.pe.gG(Mc,Kb);else{var Yc=nc.pe.PO();Yc.Bindings=Array(1);Yc.Bindings[0]=nc.se.qXb(Mc.Result);Kb(Yc)}},Kb):this.pe.hf(k.a.L3i,Kb)};e.prototype.Duh=function(I,la){var Va=this;this.Zy.ddaGetBinding(I.DdaMethod.ControlId,I.DdaBindingsMethod.BindingId,function(Kb){if(Ge.a(Kb)||!Kb.Result)Va.pe.gG(Kb,la);else{var nc=Va.pe.PO();nc.Bindings=Array(1);nc.Bindings[0]=
Va.se.qXb(Kb.Result);la(nc)}},la)};e.prototype.yzh=function(I){var la=this.pe.PO(),Va={};Va[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;la[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Va;I(la)};e.prototype.CRi=function(I,la){var Va=this;this.Zy.ddaReleaseBinding(I.DdaMethod.ControlId,I.DdaBindingsMethod.BindingId,function(Kb){Ge.a(Kb)?Va.pe.gG(Kb,la):Va.pe.iu(la)},la)};e.prototype.Eth=function(I,la){var Va=this;this.Zy.ddaGetAllBindings(I.DdaMethod.ControlId,
function(Kb){if(Ge.a(Kb))Va.pe.gG(Kb,la);else{var nc=Va.pe.PO();if(Kb.Result){Kb=Kb.Result;nc.Bindings=Array(Kb.length);for(var Mc=0;Mc<Kb.length;Mc++)nc.Bindings[Mc]=Va.se.qXb(Kb[Mc])}else nc.Bindings=null;la(nc)}},la)};e.prototype.fnd=function(I,la){var Va=this;this.Zy.ddaLoadSettings(I.DdaMethod.ControlId,function(Kb){if(Ge.a(Kb))Va.pe.gG(Kb,la);else{var nc=Va.pe.PO();nc.Properties=Kb.Result;la(nc)}},la)};e.prototype.saveSettings=function(I,la){for(var Va=this,Kb={Settings:[]},nc=0;nc<I.DdaSettingsMethod.Properties.length;nc++){var Mc=
{};Mc.Name=I.DdaSettingsMethod.Properties[nc][0];Mc.Value=I.DdaSettingsMethod.Properties[nc][1];Kb.Settings[nc]=Mc}this.Zy.ddaSaveSettings(I.DdaMethod.ControlId,Kb,I.DdaSettingsMethod.OverwriteIfStale,function(Yc){Ge.a(Yc)?Va.pe.gG(Yc,la):Va.pe.iu(la)},la)};e.prototype.wee=function(I,la){var Va=this,Kb=e.bTc(1,I.DdaAddRowsColumns.Data);e.$ac(Kb)?this.pe.hf(k.a.zvc,la):this.Zy.ddaAddRowsColumns(I.DdaMethod.ControlId,I.DdaAddRowsColumns.BindingId,I.DdaAddRowsColumns.IsRow,Kb,function(nc){Ge.a(nc)?Va.pe.gG(nc,
la):Va.pe.iu(la)},la)};e.prototype.P0g=function(I,la){var Va=this;this.Zy.ddaDeleteAllDataValues(I.DdaMethod.ControlId,I.DdaBindingsMethod.BindingId,function(Kb){Ge.a(Kb)?Va.pe.gG(Kb,la):Va.pe.iu(la)},la)};e.prototype.WKg=function(I,la){var Va=this;this.Zy.ddaClearBindingFormats(I.DdaMethod.ControlId,I.DdaClearBindingFormats.BindingId,function(Kb){Ge.a(Kb)?Va.pe.gG(Kb,la):Va.pe.iu(la)},la)};e.prototype.gNf=function(I,la){var Va=this,Kb={},nc=I.DdaSetBindingFormats.IsSetFormats;nc?Kb.CellFormat=I.DdaSetBindingFormats.CellFormat:
Kb.TableOptions=I.DdaSetBindingFormats.TableOptions;this.Zy.ddaSetBindingFormats(I.DdaMethod.ControlId,I.DdaSetBindingFormats.BindingId,Kb,nc,function(Mc){Ge.a(Mc)?Va.pe.gG(Mc,la):Va.pe.iu(la)},la)};e.prototype.executeRichApiRequest=function(I,la){var Va=this,Kb=I.ArrayData,nc={},Mc=Hi.g(this.$).ga;if(Kb){if("WacPartition"===Kb[0]){this.Wih(I,la);return}var Yc=Object(qi.a)(Uh.DdaFacade,Ri.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Kb[0]){var Ed=Yc.Pm(I.DdaMethod.ControlId);Ed&&
(Ed.Rid=!0,Ed.$yf())}nc.HttpMethod=Kb[1];nc.PathAndQuery=Kb[2];nc.RequestHeaders=e.bRe(Kb[3]);nc.RequestBody=Kb[4];nc.AppPermission=Kb[5];Ed=Kb[6];nc.RequestFlags=Ed;var re=0;if(ui.i(this.$.qa))switch(Mc.Qe){case 1:re=2;break;case 2:re=3;break;case 128:re=4;break;default:re=1}var pf=null;Mc.Pa.EB&&(pf=Mc.Pa.EB.gj);nc.SheetMultiRange=ri.r(Mc.wa.selectedRanges,this.$);nc.ActiveCell=ri.v(Mc.wa.activeCell,this.$);nc.ActiveChartId=pf;nc.SelectionState=re;re=this.se.HT(I.DdaMethod.ControlId);nc.InstanceId=
re?re.InstanceId:"";if(re&&re.PrimaryMarketplace){pf=Uh.DdaFacade.getSolutionId(re,this.$);var Ze=re.PrimaryMarketplace.MarketplaceType;if(Ze===OSF.StoreType.InMemory){if(ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(!re.OwnerAddinSolutionId){this.pe.hf(k.a.J2a,la);return}}else if(!re.OwnerAddinAssetId){this.pe.hf(k.a.J2a,la);return}if(re.AssetMarketplace)Ze=re.AssetMarketplace.MarketplaceType;else{this.pe.hf(k.a.J2a,la);return}}else Ze===
OSF.StoreType.WopiCatalog&&(Ze=OSF.StoreType.OMEX);var cg=Telemetry.PrivacyRules.GetAssetId(Ze,re.PrimaryMarketplace.MarketplaceRef,pf);nc.CompliantSolutionId=cg;nc.SolutionId=pf;nc.MarketplaceType=Ze;nc.SolutionVersion=re.PrimaryMarketplace.SolutionVersion;nc.StoreLocation=re.PrimaryMarketplace.MarketplaceRef}else nc.SolutionId=nc.MarketplaceType="",nc.CompliantSolutionId="";nc.IsEventsEnabled=void 0===Yc||null===Yc||Yc.Ti.BWb(nc.InstanceId);nc.RequestGuid=Ci.a.create().toString();Yc=nc.RequestBody.length;
if(ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Yc>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.pe.hf(k.a.zYi,la);Je.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",Yc);return}ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Ed&4096&&(Yc=new da(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Yc,U,Kb),nc.RequestBody=Kb[4])}var Ug=e.YTe(nc.RequestHeaders);e.jwd++;var rh=Gh.a.Qa.Gb;
ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&nc&&nc.RequestBody&&Je.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",nc.RequestBody.length));this.Zy.executeRichApiRequest(nc,function(Lh){Va.qMf(rh,!0,Lh.ServerCorrelationId);var nh=null,Ki=null,Wh=Lh.ServerCorrelationId;Lh&&Lh.Errors&&Lh.Errors[0]&&(nh=Lh.Errors[0].MessageIdName,Ki=Lh.Errors[0].Description,ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&
Lk.a(Va.$).fd.lO(Lh.Errors[0].MessageId));if(Ge.a(Lh)||!Lh.Result)Va.zLa(Wh,Ug,"Server error",nh,Ki),Va.pe.gG(Lh,la);else{var si=null;if(ag.EwaSettings.ka(261)){var Ti=Lh.Result;if(Ti&&Ti.length){for(var ak=0;ak<Ti.length;ak++)if(Ti[ak].RequestGuid===nc.RequestGuid){si=Ti[ak];break}si||Va.pe.gG(Lh,la)}else si=Lh.Result}else si=Lh.Result;if(!nh&&si&&si.ResponseBody&&!th.a.ma(si.ResponseBody[0]))if(Lh=si.ResponseBody[0],Lh.startsWith('{"Error":')){1<si.ResponseBody.length&&(Lh=Lh.substring(0,Lh.indexOf("}")+
1),Lh+="}");try{var Ij=Gi.a.Xh(Lh);Ij.Error&&Va.zLa(Wh,Ug,"Pipeline error",Ij.Error.Code,Ij.Error.Message)}catch(Gk){Va.zLa(Wh,Ug,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Va.zLa(Wh,Ug);else Va.zLa(Wh,Ug,"Server error",nh,Ki);var Vj=(Ij=si.SheetMultiRange)?Ij.SheetName:null;Lh=si.ActiveChartId;var Jj=si.SelectionState;nh=5===Jj&&!!Ij||6===Jj||7===Jj||8===Jj;if(ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Va.$.zb.xJ&&
nh)Va.pe.hf(k.a.zxc,la),Je.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",Jj.toString()));else if(5===Jj&&Ij){if(Va.$.va&&Vj)if(Va.$.va.Aj(Vj))Va.cOc(Vj);else{var kk=null;kk=function(){Va.$.va.Aj(Vj)&&(Je.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Va.cOc(Vj),Va.$.va.Y8a(kk))};Va.$.va.WVa(kk);if(ag.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Tk=null;Tk=function(){Va.$.va.Aj(Vj)&&(Va.cOc(Vj),Va.$.va.Yka(Tk))};
Va.$.va.pfa(Tk)}}}else if(6===Jj||7===Jj||8===Jj||9===Jj){if(Ij){var dl=ri.g(Ij.Ranges);if(Vj&&ri.bb(dl,!0))if(ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Va.$.va.Aj(Vj)){var el=null;el=function(){Va.l3f(Mc,dl,Vj,Jj);Va.$.va.Yka(el)};Va.$.va.pfa(el)}else Va.l3f(Mc,dl,Vj,Jj)}7===Jj?(Lh="38.{"+bl.c(Lh)+"}",ck.a(Va.$).ula(0,Lh,!0)):8===Jj&&ck.a(Va.$).ula(2,Lh,!0);9===Jj&&(Va.$.ya.ApiCallToSetPageLayout=!0)}th.a.ma(si.PostProcessActions)?Va.e$a(si,
la):Va.$.u7e?(Wh=Gi.a.Xh(si.PostProcessActions),Va.rHi(Wh).then(function(){Va.e$a(si,la);Va.a6c(I.DdaMethod.ControlId,nc);return Promise.resolve(null)},function(Gk){Va.e$a(si,la,Gk);return Promise.reject(Gk)})):(Va.zLa(Wh,Ug,"Promise not supported",null,"Promise is not supported on this browser."),Va.pe.hf(k.a.internalError,la))}},function(Lh){Va.qMf(rh,!1,null);Va.zLa(null,Ug,"Web service error");la(Lh)})};e.prototype.a6c=function(I,la){var Va=Object(qi.a)(Uh.DdaFacade,Ri.a(this.$));Va&&Va.OEd&&
Va.Pm(I)&&e.kdj(la.RequestHeaders)&&(Je.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",I,la.SolutionId),Va.OEd.o9g(I))};e.prototype.Wih=function(I,la){var Va=this,Kb=this.se.HT(I.DdaMethod.ControlId),nc=Uh.DdaFacade.getSolutionId(Kb,this.$),Mc=null;Mc=Uh.DdaFacade.dta(Kb,this.$);Mc=new E(Mc,this.$);Mc=new d(nc,I.DdaMethod.ControlId,this.se,this.$,Mc);var Yc={ResponseHeaders:[]};Yc.ResponseBody=Array(1);Kb=
e.bRe(I.ArrayData[3]);var Ed=e.YTe(Kb);Kb=new ca(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.shf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Mc,ra,Kb,I.ArrayData).then(function(re){if(!re)return Va.Pnd(!1,"The rich api executor call failed",Ed),Je.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Yc.ResponseStatusCode=500,Va.e$a(Yc,la),null;Va.Pnd(!0,"The rich api executor call succeeded",Ed);Yc.ResponseStatusCode=re[0];Yc.ResponseBody[0]=re[2];Va.e$a(Yc,la);
return null},function(re){Yc.ResponseStatusCode=400;Yc.ResponseBody[0]=re.toString();Va.Pnd(!1,"The rich api executor call failed",Ed);Je.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",nc);Va.e$a(Yc,la);return null})};e.prototype.qMf=function(I,la,Va){e.jwd--;I=Sk.a(Gh.a.Qa,I);Je.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",I,e.jwd,la?"success":"false",
Va)};e.prototype.e$a=function(I,la,Va){Va=void 0===Va?null:Va;var Kb=Array(3);Kb[0]=I.ResponseStatusCode;Kb[1]=e.MIh(I.ResponseHeaders);var nc=[],Mc=!1;if(Va&&I.ResponseBody){var Yc=Gi.a.Xh(I.ResponseBody.join(""));Yc.Error||(Mc={},Mc.Error=Va,Mc.TraceIds=Yc.TraceIds,Mc.ProcessedResults={},Mc.ProcessedResults.Results=Yc.Results,nc[0]=Gi.a.Hc(Mc),Mc=!0)}Kb[2]=Mc?nc:I.ResponseBody;I=this.pe.PO();I.Data=Kb;la(I)};e.prototype.Dqd=function(I,la){(new N(this.$,this.pe,this.Zy)).Dqd(I,la)};e.prototype.cii=
function(I,la){Je.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Va=I[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],Kb=I[Mg.a.hQc],nc=I[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];I=this.$.ea.Ba(232).sZa.dii(I.DdaMethod.ControlId,Va,Kb,nc);I===k.a.success?this.pe.iu(la):(Je.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.pe.hf(I,la))};e.prototype.Zhi=function(I,la){Je.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Va=I[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],
Kb=I[Mg.a.hQc],nc=I[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.ea.Ba(232).sZa.L4i(I.DdaMethod.ControlId,Va,Kb,nc);this.pe.iu(la)};e.prototype.getAccessToken=function(I,la){function Va(Mc,Yc){if(Mc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Mc=Kb.pe.PO(),Mc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Yc.accessToken,la(Mc);else{Yc=Kb.se.HT(I.DdaMethod.ControlId);var Ed=ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?null!==Yc.OwnerAddinSolutionId?Yc.OwnerAddinSolutionId:Yc.PrimaryMarketplace.MarketplaceType:null!==Yc.OwnerAddinAssetId?Yc.OwnerAddinAssetId:Yc.PrimaryMarketplace.MarketplaceType;var re={};Je.ULS.sendTraceTag(537163202,0,10,"{0}.",(re.errorCode=Mc.toString(),re.appId=Telemetry.PrivacyRules.GetAssetId(Ed,Yc.PrimaryMarketplace.MarketplaceRef,Uh.DdaFacade.getSolutionId(Yc,Kb.$)),re.storeType=Ed,re));Kb.pe.hf(Mc,la)}}var Kb=this;Je.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var nc=
!ag.EwaSettings.ka(24);wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.create(this.$.ea,137,this.$.la,1,"Postmessage.IHostPostmessenger"),function(Mc){var Yc=Kb.se.sh,Ed=na.getInstance();Qk.AppsForOfficeSingleSignOnManager.getInstance(Yc,Mc.result,Ed).getAccessToken(I.DdaMethod.ControlId,nc,I,Va)},this.$.la)};e.prototype.getAuthContext=function(I,la){var Va=this;wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.create(this.$.ea,137,this.$.la,1,"Postmessage.IHostPostmessenger"),function(){var Kb=Va.se.sh.getOsfControl(I.DdaMethod.ControlId);
if(!ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||Kb.isFirstParty()){Kb=Kb.getManifest();var nc=Kb.getMarketplaceID(),Mc=Kb.getWebApplicationId(),Yc=Kb.getWebApplicationMsaId();oi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(nc).then(function(Ed){var re=Va.pe.PO(),pf={};pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Mc;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Yc?Yc:Mc;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
Ed.upn;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ed.userId;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ed.authority;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Uc.muh(Ed.authorityType);pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ed.isAnonymous;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ed.tenantId;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ed.supportsAuthToken;
re[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=pf;la(re)},function(Ed){var re=Va.pe.PO(),pf={},Ze=new Uc;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Mc;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Yc?Yc:Mc;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ze.upn;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ze.userId;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ze.authority;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
Ze.authorityType;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ze.isAnonymous;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ze.tenantId;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Ed;pf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ze.supportsAuthToken;re[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=pf;re.Error=1;la(re)})}},this.$.la)};e.prototype.D0h=function(I){var la=Hi.g(this.$).ga;return 16===
la.Qe&&!!la.Pa.kc&&!!la.Pa.kc.floatingObject&&th.a.equals(la.Pa.kc.floatingObject.id,I,!0)};e.prototype.S8c=function(I){var la=Hi.g(this.$).ga;return la.wa.xh?1===la.Qe||this.D0h(I)?la.Lga:null:null};e.prototype.Ddc=function(I,la){return 1!==I&&2!==I&&3!==I?(this.pe.hf(k.a.Tre,la),!1):!0};e.prototype.Pnd=function(I,la,Va){var Kb={};Kb.a=this.$.ya.UserSessionId;Kb.b=I;Kb.c=la;Kb.d=null;Kb.e=Va;vj.b().Je(37,Kb)};e.prototype.zLa=function(I,la,Va,Kb,nc){Va=void 0===Va?null:Va;Kb=void 0===Kb?null:Kb;nc=
void 0===nc?null:nc;var Mc={};th.a.ma(I)||(Mc.ServerCorrelationId=I);void 0!==la&&null!==la&&(Mc.Source=la);th.a.ma(Va)||(Mc.ErrorType=Va);th.a.ma(Kb)||(Mc.MessageId=Kb);th.a.ma(nc)||(Mc.StatusDescription=nc);Je.ULS.sendTraceTag(50688452,0,50,Gi.a.Hc(Mc))};e.prototype.rHi=function(I){for(var la=new Promise(function(Kb){Kb(null)}),Va=0;Va<I.length;Va++)la=this.qHi(la,I[Va]);return la};e.prototype.qHi=function(I,la){var Va=this;if(!la)return Je.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),
I.then(function(){return Promise.reject(e.i0a(H.generalException,Gf.a.instance.da(1689),null))});switch(la.actionType){case 1:case 2:I=I.then(function(){var Kb=Object(qi.a)(Uh.DdaFacade,Ri.a(Va.$));if(Kb.Pm(la.controlId))switch(Kb.Ti.zNh(la),la.messageType){case 14:case 100:Kb.NEd.YWb(la);break;case 11:case 12:Kb.b0i.ylb(la);break;case 51:case 52:Kb.$_i.ylb(la);break;case 2101:case 2102:Kb.a0i.ylb(la);break;case 2E3:Kb.c0i.YWb(la);break;case 2201:Va.$.fja&&Kb.OEd.wzg(la);break;case 2203:Kb.d0i.xzg(la);
break;case 2700:ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Kb.MEd.YWb(la)}else Je.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",la.controlId);return Promise.resolve(null)});break;case 3:I=I.then(function(){Va.oNh(la);return Promise.resolve(null)});break;case 15:ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(I=I.then(function(){Va.OOh(la);return Promise.resolve(null)}));break;case 4:I=I.then(function(){if(ag.EwaSettings.ka(104)){var Kb=
Hi.g(Va.$).ga.wa.activeCell;Kb.top!==la.row+1&&Kb.left!==la.column+1&&(Kb=ri.v(ba.Range.ld(la.row+1,la.column+1),Va.$),Hi.g(Va.$).ki(Kb,null,null,null,3,df.a.A_g));Nj.a(Va.$,243,242,0,function(nc){nc.wHb(la.row+1,la.column+1,1,!1,!1)},"Microsoft.Office.Excel.WebUI.Client.CardView.ICardViewManager")}return Promise.resolve(null)});break;case 7:I=I.then(function(){Object(qi.a)(Uh.DdaFacade,Ri.a(Va.$)).Ti.JCe(la.controlId,la.isEnableEvents);return Promise.resolve(null)});break;case 5:I=I.then(function(){return Va.VYg(la)});
break;case 6:I=I.then(function(){return Va.ECi(la)});break;case 8:I=I.then(function(){ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(qi.a)(Uh.DdaFacade,Ri.a(Va.$)).VKg();var Kb=new jl.a(fl.a.vk,5,null);il.a(Va.$).zs(Kb);return Promise.resolve(null)});break;case 9:I=I.then(function(){return Va.u6i(la)});break;case 10:I=I.then(function(){return Va.jDj(la)});break;case 11:I=I.then(function(){return Va.iDj()});break;case 12:I=I.then(function(){return Va.fDj()});
break;case 13:I=I.then(function(){return Va.gDj(la)});break;case 14:I=I.then(function(){return Va.hDj(la)});break;case 16:I=I.then(function(){return Promise.resolve(la)});break;case 17:I=I.then(function(){return Va.M2i(la,Object(qi.a)(Uh.DdaFacade,Ri.a(Va.$)))});break;case 18:Hi.g(this.$).focus();break;default:I=I.then(function(){return Promise.reject(e.i0a(H.Uwg,Gf.a.instance.da(1690),null))})}return I};e.prototype.OOh=function(I){var la=Object(qi.a)(Uh.DdaFacade,Ri.a(this.$)).Pm(I.controlId);if(la&&
!(!I.operationType^!la.Vba)){Hi.g(this.$).Ycc=!0;switch(I.operationType){case 0:var Va=new hl.a(document.createElement("input"));Va.text=I.range;la.JWh(Hi.g(this.$).wi.pXg(Va,new Xk.a(this.$)));la.Vba.startEdit(!0);break;case 1:la.tEf();this.rangePicker=null;break;case 2:la.Vba.B3f(I.range);break;case 3:la.Vba.B3f(I.startingRange);la=I.expandSelection;Va=I.getNextDataRegionCell;var Kb=0;switch(I.keyboardDirectionValue){case 2:Kb=38;I=la&&Va?105288353:la?-31900117:Va?542791952:137938150;break;case 3:Kb=
40;I=la&&Va?-1297307319:la?-1603798598:Va?1713663844:-798660877;break;case 0:Kb=37;I=la&&Va?-403586027:la?2039316657:Va?-2012742350:-1470715894;break;case 1:Kb=39;I=la&&Va?784916030:la?589730764:Va?1324884057:-1231471547;break;default:I=1461300262}la=this.q0b("keydown",Kb,la,Va);Hi.g(this.$).$Eb(la,new Fj.a(I,1,0,8,null))}Hi.g(this.$).Ycc=!1}};e.prototype.q0b=function(I,la,Va,Kb){var nc=document.createEvent("KeyboardEvent");if(Li.a.gE)nc.initKeyboardEvent(I,!1,!1,window.self,"A",0,Kb,!1,Va,!1);else{var Mc=
"";Va&&(Mc+="Shift");Kb&&(Mc+=0<Mc.length?" Control":"Control");nc.initKeyboardEvent(I,!1,!1,window.self,"A",0,Mc,!1,"en-US")}I=new Sys.UI.DomEvent(nc);I.keyCode=la;return I};e.prototype.oNh=function(I){switch(I.operationType){case 1:wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.create(this.$.ea,153,this.$.la,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager"),function(la){la.result.HDd()},this.$.la,3);break;case 2:if(I=Object(qi.a)(Uh.DdaFacade,Ri.a(this.$)).Pm(I.controlId))I.Rid=
!0,I.$yf()}};e.prototype.VYg=function(I){var la=this,Va=I.fileBase64;return Va&&Va.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(e.i0a(H.invalidArgument,Gf.a.instance.da(1693),"Application.CreateWorkbook")):(new Promise(function(Kb,nc){var Mc=new Dk.StandardDialog;Mc.hc=4;Mc.ul(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Yc){2!==Yc&&Yc||nc(e.i0a(H.qvd,Gf.a.instance.da(1692),"Application.CreateWorkbook"));Yc=new La("blank",
"agave",Va?"streamBase64":"streamEmpty",Va);la.shf.create(Kb,nc,Yc).HYa()})})).then(function(Kb){la.f5c.add(I.fakeFileId,Kb);return Promise.resolve(null)},function(Kb){return Kb?Promise.reject(Kb):Promise.reject(e.i0a(H.generalException,Gf.a.instance.da(1689),"Application.CreateWorkbook"))})};e.prototype.ECi=function(I){var la=this;return new Promise(function(Va,Kb){var nc=null;(function(){var Mc=la.f5c.zc(I.fakeFileId);nc=Mc.value;return Mc})().returnValue?(Kb=new Dk.StandardDialog,Kb.hc=4,Kb.ul(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_OpenWindowConsentMessage,1,function(Mc){1===Mc&&bi.HelperMethods.lf(nc,void 0,void 0,"DdaMethodHandler.fileUrl");Va(null)})):Kb(e.i0a(H.generalException,Gf.a.instance.da(1689),"Document.Open"))})};e.prototype.u6i=function(I){var la=this;return new Promise(function(Va){Object(qi.a)(Uh.DdaFacade,Ri.a(la.$)).aJf=I.runtimeCalculationMode;var Kb=la.$.ea.Ba(268);Kb&&Kb.Drd(3===I.runtimeCalculationMode);Va(null)})};e.prototype.jDj=function(I){Vi.a.Owb(this.$)&&this.$.ea.Ba(331).f$a(0,I.urlStr,
!0,!0,null);return Promise.resolve(null)};e.prototype.iDj=function(){Vi.a.Owb(this.$)&&this.$.ea.Ba(331).f$a(1,null,!0,!0,null);return Promise.resolve(null)};e.prototype.fDj=function(){Vi.a.Owb(this.$)&&this.$.ea.Ba(331).HCe();return Promise.resolve(null)};e.prototype.gDj=function(I){Vi.a.Owb(this.$)&&this.$.ea.Ba(331).f$a(5,I.urlStr,!0,!0,null);return Promise.resolve(null)};e.prototype.hDj=function(I){if(Vi.a.Owb(this.$)){var la=this.$.ea.Ba(331);la=Ol(la.L9);for(var Va=la.next();!Va.done;Va=la.next())Va=
Va.value,Va.IsActive&&Va.HostEditUrl&&Va.UrlStr===I.hostEditUrlStr&&bi.HelperMethods.lf(Va.HostEditUrl,"_blank")}return Promise.resolve(null)};e.prototype.M2i=function(I,la){var Va=D.a.HV;I=Gi.a.Xh(I.payload);var Kb={};"eventId"in I&&"payload"in I&&(Kb.eventId=I.eventId,Kb.payload=I.payload);la.AL(2201,Va,Gi.a.Hc(Kb));return Promise.resolve(null)};e.prototype.cOc=function(I){(I=Object(qi.a)(gl.a,this.$.va.getItemByName(I)))&&I.visible&&I.activate(!0)};e.prototype.l3f=function(I,la,Va,Kb){var nc=I.wa.Yz,
Mc=nc<la.length&&la[nc].contains(I.wa.activeCell);I=Mc?I.wa.activeCell:la[0].topLeft;nc=Mc?nc:0;Hi.g(this.$).YT(la,nc,Va,null,I,null,null,3,df.a.B_g,void 0,void 0,void 0,6===Kb)};e.bRe=function(I){if(!I||!I.length)return null;for(var la=Array(I.length/2),Va=0;Va<I.length/2;Va++)la[Va]={},la[Va].Name=I[2*Va],la[Va].Value=I[2*Va+1];return la};e.MIh=function(I){if(!I||!I.length)return null;for(var la=Array(2*I.length),Va=0;Va<I.length;Va++)la[2*Va]=I[Va].Name,la[2*Va+1]=I[Va].Value;return la};e.n6c=
function(I){if(!I||!I.length)return null;for(var la=Array(I.length),Va=0,Kb=I.length;Va<Kb;Va++){var nc=I[Va].length;if(nc){la[Va]=Array(nc);for(var Mc=0;Mc<nc;Mc++)la[Va][Mc]=null==I[Va][Mc]?null:I[Va][Mc].toString()}else return null}return la};e.GZb=function(I){return"string"===typeof I?Kk.a.yn(e.w_g,I,0):I};e.sKe=function(I){return"string"===typeof I?Kk.a.yn(e.z_g,I,0):I};e.L4f=function(I){return"string"===typeof I?Kk.a.yn(e.D_g,I,0):I};e.O0h=function(I){switch(I.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};
e.bTc=function(I,la){var Va={};Va.CoerceType=I;1===Va.CoerceType?(Va.Data=e.n6c(la.Rows),Va.Headers=e.n6c(la.Headers)):Va.Data=e.n6c(la);return Va};e.rme=function(I){if(1===I.CoerceType){var la={};return la.Headers=I.Headers,la.Rows=I.Data,la}return I.Data};e.$ac=function(I){return 1===I.CoerceType?!I.Data&&!I.Headers:!I.Data};e.YTe=function(I){var la="Unknown";if(!I)return la;for(var Va=0;Va<I.length;Va++)if(I[Va].Name.toLowerCase()===gj.a.e0i){la=I[Va].Value;break}return la};e.kdj=function(I){if(!I)return!1;
for(var la=gj.a.mni.toLowerCase(),Va=0;Va<I.length;Va++)if(I[Va].Name.toLowerCase()===la)return!0;return!1};e.i0a=function(I,la,Va){var Kb={};Kb.Code=I;Kb.Message=la;Kb.Location=Va;Kb.ActionIndex=0;return Kb};Ll.Object.defineProperties(e.prototype,{lP:{configurable:!0,enumerable:!0,get:function(){return this.pe}}});Ll.Object.defineProperties(e,{w_g:{configurable:!0,enumerable:!0,get:function(){e.Nna||(e.Nna={},e.Nna[Microsoft.Office.WebExtension.CoercionType.Table]=1,e.Nna[Microsoft.Office.WebExtension.CoercionType.Text]=
2,e.Nna[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,e.Nna[Microsoft.Office.WebExtension.CoercionType.Html]=4,e.Nna[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return e.Nna}},z_g:{configurable:!0,enumerable:!0,get:function(){e.Ceb||(e.Ceb={},e.Ceb[Microsoft.Office.WebExtension.FilterType.All]=1,e.Ceb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return e.Ceb}},D_g:{configurable:!0,enumerable:!0,get:function(){e.Deb||(e.Deb={},e.Deb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=
2,e.Deb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return e.Deb}}});e.Nna=null;e.Ceb=null;e.Deb=null;e.jwd=0;Object(Md.a)(e,"DdaMethodHandler",null,[160,6]);var cl=cj.a;Em(a,cl);a.prototype.Gd=function(){var I=this,la=Zi.GetServiceTaskFactory.create(this.$.ea,106,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),Va=Zi.GetServiceTaskFactory.create(this.$.ea,165,this.la,this.rb,"System.IDisposable"),Kb=Ia(this.la,this.rb);wh.TaskExtensions.Aa(wh.TaskExtensions.xe([la,
Va,Kb],this.la),function(){var Mc=la.result,Yc=oi.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");I.Ad([new e(I.$,Mc,Yc)])},this.la,3);var nc=oi.a.instance;wh.TaskExtensions.Aa(Zi.GetServiceTaskFactory.create(this.$.ea,137,this.$.la,this.rb,"Postmessage.IHostPostmessenger"),function(){nc.register(ib,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").wc().Fc(function(){return new ib})},this.$.la)};a.ja=function(I){cj.a.Yd(82,new a(I))};
Object(Md.a)(a,"DdaCommandHandlerFactory",cj.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");Nf.a.Li("");Nf.a.Li(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");
window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=kh.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");O.main();(function(){Ch.a.Ga(function(I){wg.ja(I)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){Ch.a.Ga(function(I){Vf.ja(I);ng.ja(I)})})();(function(){Ch.a.Ga(function(I){Zf.ja(I)})})();Type.registerNamespace("CommandUI.AddInCommands");
(function(){Ch.a.Ga(function(I){ag.EwaSettings.ka(53)&&Jb.ja(I)})})();(function(){Ch.a.Ga(function(I){ag.EwaSettings.ka(121)&&ic.ja(I)})})();Ch.a.Ga(qb.ja);Ch.a.Ga(Ec.ja);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){Ch.a.Ga(function(I){Tb.ja(I);ta.ja(I)})})();Ch.a.Ga(a.ja)},1399:function(C,F,b){function a(){this.Pyc=null;this.yDc=0;this.fFc=!1;this.Ya=new l.a;this.heg=new d.a}function e(){this.JBe=this.displayName=this.Lnb=this.Kq=
this.Fy=null}C=b(0);var d=b(211),l=b(94);e.prototype.Hjd=function(n,r){return this.Fy.getStoreType().toLowerCase()===n.toLowerCase()&&this.Fy.getMarketplaceID().toLowerCase()===r.toLowerCase()};Object(C.a)(e,"AddinCommandsResourceItem",null,[]);b.d(F,"a",function(){return a});a.prototype.frg=function(n){this.Ya.addHandler("AddinCommandsLoadingMessageChanged",n)};a.prototype.gTi=function(n){this.Ya.removeHandler("AddinCommandsLoadingMessageChanged",n)};a.prototype.F$a=function(n){n!==this.Pyc&&(this.Pyc=
n,this.Ya.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.q6i=function(){this.yDc++;this.eWa||this.F$a(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.sqc=function(){this.yDc--;this.ind()&&(this.fFc?this.eWa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.F$a(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.F$a(null))};a.prototype.VNf=function(n){this.fFc=!0;this.F$a((void 0===n?0:n)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};
a.prototype.nqe=function(){this.fFc=!1;this.ind()?this.F$a(null):this.F$a(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.ind=function(){return 0>=this.yDc};a.prototype.sP=function(n,r,h){h=void 0===h?0:h;for(var v=Ol(this.G2a),w=v.next();!w.done;w=v.next())if(w=w.value,w.Hjd(n,r)&&(!w.Kq||w.Kq.Jsh===h))return w;return null};a.prototype.cee=function(n,r,h,v){var w=new e;w.Fy=n;w.Kq=r;w.Lnb=h;w.displayName=v;this.G2a.add(w)};a.prototype.opg=function(n,r,h,v){var w=new e;w.Fy=n;w.Kq=r;w.Lnb=null;
w.JBe=h;w.displayName=v;this.G2a.add(w)};a.prototype.LRi=function(n,r){for(var h=0,v=Ol(this.G2a),w=v.next();!w.done;w=v.next())w=w.value,w.Fy.getStoreType()===n&&w.Fy.getMarketplaceID()===r?this.G2a.removeAt(h):h++};a.getInstance=function(){a.Ma||(a.Ma=new a);return a.Ma};Ll.Object.defineProperties(a.prototype,{eWa:{configurable:!0,enumerable:!0,get:function(){return this.Pyc}},G2a:{configurable:!0,enumerable:!0,get:function(){return this.heg}}});a.Ma=null;Object(C.a)(a,"AddinCommandsResourceManager",
null,[])},840:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);var e=b(32);a.zMe=function(d){return e.a.yn(a.aii,d.toString(),a.internalError)};Ll.Object.defineProperties(a,{aii:{configurable:!0,enumerable:!0,get:function(){var d={};return a.s4d||(a.s4d=(d["-2002156328"]=a.Tre,d["-1954750170"]=a.rUe,d["317650254"]=a.LMg,d["-1005263101"]=a.KYh,d["1353664579"]=a.d4i,d["159671765"]=a.LYh,d["1446690022"]=a.HPe,d["1150069548"]=a.zvc,d["-1409306331"]=a.Eoe,d["338507772"]=a.Exe,d["-457159301"]=
a.ADi,d["-1037701970"]=a.WZg,d["-1893322318"]=a.QYh,d["965579896"]=a.YZg,d["93287890"]=a.XZg,d["358088857"]=a.b7i,d["-1223650923"]=a.Exe,d["2007306190"]=a.QIg,d["1549955423"]=a.Ale,d["-1275974171"]=a.PYh,d["382101082"]=a.HCi,d["-898776235"]=a.Jji,d["335464256"]=a.Aji,d["1677378049"]=a.OYh,d["-261992848"]=a.Guj,d["-980820954"]=a.Ale,d["-931375837"]=a.GCi,d["929186550"]=a.L6g,d["-982144310"]=a.lKi,d["-785741187"]=a.IYh,d["2125217573"]=a.SYh,d["299124955"]=a.JYh,d["1669853884"]=a.r0i,d["-1515932330"]=
a.MMg,d["314621024"]=a.iph,d["-300049690"]=a.UIg,d["14766835"]=a.ebj,d["-1251992761"]=a.MAe,d["-2087635043"]=a.invalidOrTimedOutSession,d["2100961153"]=a.invalidOrTimedOutSession,d["-1218744139"]=a.invalidSheetName,d["-1468309555"]=5006,d["-315732528"]=a.invalidOrTimedOutSession,d["611268539"]=a.invalidOrTimedOutSession,d["1531005923"]=5006,d["1593924569"]=5006,d["299476328"]=a.yDa,d["49173765"]=a.yDa,d["-907155566"]=a.yDa,d["-1201603824"]=a.yDa,d["1541165282"]=a.yDa,d["-1347753427"]=a.yDa,d["134912532"]=
a.yDa,d["1780971550"]=a.responsePayloadSizeLimitExceeded,d))}}});a.success=0;a.Tre=1E3;a.rUe=1001;a.LMg=1002;a.KYh=1003;a.d4i=1004;a.LYh=1005;a.HPe=1008;a.fKe=1009;a.invalidSheetName=1014;a.zvc=2E3;a.Eoe=2001;a.Exe=2002;a.ADi=2003;a.WZg=2004;a.QYh=2005;a.YZg=2007;a.XZg=2008;a.b7i=2009;a.QIg=2014;a.L3i=3E3;a.Ale=3002;a.PYh=3004;a.HCi=3005;a.Jji=3006;a.Aji=3007;a.OYh=3008;a.Guj=3009;a.GCi=3010;a.ebj=4002;a.tvd=5E3;a.internalError=5001;a.MAe=5002;a.J2a=5004;a.Fvj=5007;a.OTh=5008;a.CCg=5009;a.invalidOrTimedOutSession=
5012;a.zxc=5016;a.yDa=5102;a.zYi=5103;a.responsePayloadSizeLimitExceeded=5104;a.jIg=7001;a.ZUf=7002;a.L6g=8E3;a.lKi=8001;a.IYh=8010;a.SYh=8011;a.JYh=8012;a.r0i=8020;a.MMg=8021;a.iph=8022;a.UIg=8023;a.vhi=11E3;a.Aki=11001;a.RYh=11002;a.s4d=null;Object(C.a)(a,"DdaErrorIds",null,[])},841:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.GNc="AccessDenied";a.notSupported="NotSupported";
a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.qvd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.Ivj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.lvg="AddinIsAlreadyRequestingToken";a.PZi="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.lQg="ControlIdNotFound";a.F_i="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";
a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(C.a)(a,"ErrorCodes",null,[])},843:function(C,F,b){function a(za,Nb){var bb=we.call(this)||this;bb.fa=null;bb.fm=null;bb.vh=null;bb.rf=[];bb.OGa=null;bb.mxe=!1;bb.bLb=!1;bb.initialized=!1;bb.disposed=!1;bb.eAa=null;bb.Ljc=[];bb.hxe=[];bb.XMa=[];bb.hZa=null;bb.uwd=new lc.a(Ec.a.rl());bb.AVb=new tc.a(Ec.a.rl());bb.$Bb=[];bb.hwf=[];bb.B1b=350;bb.rda=null;bb.sva=null;bb.qNc=!1;bb.z8d=null;bb.w8d=null;bb.A8d=null;bb.y8d=null;bb.C8d=null;bb.Iig=
null;bb.x8d=null;bb.B8d=null;bb.D8d=null;bb.E8d=null;bb.F8d=null;bb.ub=za;bb.BQc=Nb;bb.initialize();fa.ja(bb);bb.aJf=0;(za=(za=!(Ha.a.tr||Ha.a.Uua))&&(!Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!Ha.a.uf))&&OfficeExt.ShortcutKeyDispatchManager.init();bb.ieg={};return bb}function e(za){id.a.sendOtelCustomerContent(Object.assign(new Tc.a,{otelEvent:za}))}function d(za){id.a.sendOtelEvent(Object.assign(new Tc.a,{otelEvent:za}))}function l(za,Nb,bb){za=
ne.call(this,bb,za)||this;za.hashCode=null;za.Lta=null;za.w_b=!1;za.HRa=Nb;za.domElement.classList.add(ub.a.k4b);za.domElement.classList.add(pc.a.lr);bb.tabIndex=0;za.gQa(za.$.qa,!1);za.rc.ja("mousedown",Object(ab.a)(za,za.CM,"onMouseDown"));za.rc.ja("contextmenu",function(Ub){ee.g(Ub)});za.$.va.uI(Object(ab.a)(za,za.Yn,"onActiveItemChanging"));za.$.wb.uI(Object(ab.a)(za,za.Yn,"onActiveItemChanging"));za.$.wb.Pf(Object(ab.a)(za,za.kf,"onActiveItemChanged"));za.$.va.Pf(Object(ab.a)(za,za.kf,"onActiveItemChanged"));
za.Ca.Pp(Object(ab.a)(za,za.Be,"onBlockCacheItemChanged"));za.Ca.DF(Object(ab.a)(za,za.Vl,"onBlockCacheItemEvicted"));za.Ca.Np(Object(ab.a)(za,za.Sg,"onBlockCacheConsistent"));Db.EwaSettings.pc()&&za.uq(Object(ab.a)(za,za.onContentReady,"onContentReady"));return za}function n(za,Nb,bb,Ub,kc,ad,Qd,We,Ke){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=
!1;this.enqueueUtcTime=za;this.processUtcTime=Nb;this.dequeueUtcTime=bb;this.inQueueDurationInMS=Ub;this.executionDurationInMS=kc;this.operationCount=ad;this.ServerCorrelationId=Qd;this.UserOperationName=We;this.IsDocumentHidden=Ke}function r(za,Nb,bb){this.$=za;this.Ti=Nb;this.runtimeCalculationMode=bb}function h(){}function v(za,Nb,bb){this.Quf=null;this.$=za;this.Ti=Nb;this.vh=bb;this.nWh()}function w(za,Nb,bb){this.HDb=0;this.g6f=!0;this.L5b=0;this.Cjd=!0;this.$=za;this.Ti=Nb;this.vh=bb;window.requestIdleCallback||
(this.Cjd=!1)}function t(za,Nb,bb){this.GDb=0;this.L7a=this.U7a=null;this.$=za;this.Ti=Nb;this.vh=bb}function B(za,Nb,bb){this.vZb=null;this.ydc=!1;this.$=za;this.gridView=jc.g(za);this.Ti=Nb;this.vh=bb;this.p2h=Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GetCellOffSetPointFromEventPointOptimization",!1);this.kRi()}function z(za,Nb,bb,Ub){var kc=Ta.call(this)||this;kc.sheet=za;kc.OIg=Nb;kc.offsetX=bb;kc.offsetY=Ub;return kc}function x(za,Nb,bb){this.wDf=this.vDf=this.xDf=this.uDf=
0;this.$=za;this.Ti=Nb;this.vh=bb}function y(za,Nb,bb){this.RNa=this.QNa=0;this.CEa=this.Zfa=null;this.$=za;this.Ti=Nb;this.vh=bb}function J(za,Nb,bb){za=E.call(this,za,Nb,bb)||this;za.J$e=null;za.I$e=null;return za}function E(za,Nb,bb){var Ub=Ee.call(this)||this;Ub.Jxa=0;Ub.oT=0;Ub.$=za;Ub.Ti=Nb;Ub.vh=bb;Ub.grid=jc.g(za);Ub.$Ka={};Ub.kec={};return Ub}function A(za,Nb,bb){this.tDf=this.sDf=0;this.YGb=this.X7a=null;this.$=za;this.Ti=Nb;this.vh=bb}function H(){this.hWa={}}function S(za,Nb,bb,Ub){Ub=
void 0===Ub?!1:Ub;var kc=Pc.call(this)||this;kc.i$a=0;kc.AD=null;kc.jua=!1;kc.ilc=null;kc.oT=0;kc.kVd=null;kc.tBc=null;kc.NSa=null;kc.k1b=null;kc.R1d=!1;kc.HSd=null;kc.Vba=null;kc.DIc=null;kc.ub=za.$;kc.Qg=za;kc.ed=bb;kc.ed.InstanceId=bb.SrcLocationOverrideResourceId?za.Hha(bb.InstanceId,bb.SrcLocationOverrideResourceId):bb.InstanceId;kc.vh=Nb;kc.a0={};kc.a0.WebExtensionId=bb.InstanceId;kc.Puf="osfControl_"+bb.InstanceId;kc.a1c="disabled_"+bb.InstanceId;kc.a0.BindingData=bb.BindingData;kc.Q2a=kc.Qg.Q2a(bb.InstanceId);
kc.Tac=kc.Qg.Tac(bb.InstanceId);kc.i6d=bb.WebExtensionOsfControlType;kc.Wxf=Ub;return kc}function Q(za,Nb,bb,Ub,kc,ad,Qd,We){za=fb.call(this,za,Nb,bb)||this;za.startRow=0;za.startColumn=0;za.rowCount=0;za.columnCount=0;za.startColumn=ad-Ub.Reference.FirstColumn;za.columnCount=We;ad=Math.max(kc,Ub.Reference.FirstRow);kc=Math.min(kc+Qd-1,Ub.Reference.LastRow);ad>kc?za.startRow=za.rowCount=void 0:(za.startRow=ad-Ub.Reference.FirstRow,za.rowCount=kc-ad+1);return za}function L(za){this.AD=null;this.jua=
!1;this.Qg=za}function aa(za,Nb){this.Mz=null;this.Mda=za;this.Mkg=Nb}function fa(za){this.sh=this.cRc=null;this.handlers=new Tb.a;this.lgc=new Tb.a;this.Qg=za;this.sZa.Btg(Object(ab.a)(this,this.fwi,"onMessageParentEvent"));this.sZa.Atg(Object(ab.a)(this,this.ewi,"onMessageDialogEvent"))}function W(za,Nb,bb,Ub,kc,ad,Qd){za=Hb.call(this,za,Nb,bb)||this;za.messageType=0;za.messageContent=null;za.messageOrigin=null;za.targetOrigin=null;za.messageType=Ub;za.messageContent=kc;za.messageOrigin=ad;za.targetOrigin=
Qd;return za}function G(za,Nb,bb,Ub,kc,ad,Qd){za=Qb.call(this,za,Nb,bb)||this;za.messageType=0;za.messageContent=null;za.messageOrigin=null;za.targetOrigin=null;za.messageType=Ub;za.messageContent=kc;za.messageOrigin=ad;za.targetOrigin=Qd;return za}function N(za,Nb){var bb=Ca.call(this)||this;bb.requests=new Ia.a;bb.GYb=!1;bb.disposed=!1;bb.ddaFacade=za;bb.grid=Nb;return bb}function Y(){this.command=0;this.properties=null}function V(za){this.Ya=new ea.a;this.fm=za}function da(za,Nb,bb,Ub,kc){bb=void 0===
bb?null:bb;Ub=void 0===Ub?"":Ub;kc=void 0===kc?"":kc;var ad=eb.call(this)||this;ad.controlId=za;ad.messageType=Nb;ad.messageContent=bb;ad.messageOrigin=Ub;ad.targetOrigin=kc;return ad}function U(za,Nb,bb,Ub,kc){bb=void 0===bb?null:bb;Ub=void 0===Ub?"":Ub;kc=void 0===kc?"":kc;var ad=Fa.call(this)||this;ad.controlId=za;ad.messageType=Nb;ad.messageContent=bb;ad.messageOrigin=Ub;ad.targetOrigin=kc;return ad}function Z(){this.height=this.width=0;this.Ie=this.controlId=this.pageUrl=null;this.q$b=this.g1c=
!1}function ca(){}function ra(){this.dialog=this.Ie=null}function La(za,Nb,bb){var Ub=Ga.call(this)||this;Ub.Z7=null;Ub.IMc="WACDialogTitleText";Ub.DSa="0";Ub.gNb="15px";Ub.Eag="0px";Ub.CSa="calc(100% - 30px)";Ub.Dag="100%";Ub.Y7d=0;Ub.Ya=new ea.a;Ub.n9f=new ma;Ub.hc=5;Ub.fBa=bb;Ub.Ie=bb;Ub.QBc=za;Ub.oYd=Nb;Ub.eCc=!!Ka.AFrameworkApplication.ha&&Ka.AFrameworkApplication.ha.sa("OfficeAddinEnableInsertDialogAccessibilityFix");return Ub}function na(){}function ma(){}function xa(za,Nb){za=Pa.call(this,
1,za,Nb)||this;za.L2e=OfficeExt.CommandInvokeMode.ExclusiveForNew;return za}function Pa(za,Nb,bb){this._id=za;this.l9f=Nb;this.oag=bb;this.L2e=OfficeExt.CommandInvokeMode.Default}b.r(F);var ib=b(0),pb=b(15),xb=b(1270),Ya=b(973),ab=b(37),ea=b(94);Pa.prototype.execute=function(za,Nb,bb){var Ub=this;bb=bb||{};bb.commandMode=this.L2e;Nb.invokeAppCommand(this.kvg,this.lNg,bb,function(){za.qwi(Ub.id)})};Ll.Object.defineProperties(Pa.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},
kvg:{configurable:!0,enumerable:!0,get:function(){return this.l9f}},lNg:{configurable:!0,enumerable:!0,get:function(){return this.oag}}});Object(ib.a)(Pa,"AddinNativeActionBase",null,[485]);Em(xa,Pa);Object(ib.a)(xa,"AddinTakeSnapshotAction",Pa,[]);ma.prototype.MRg=function(za){return new Pa(3,za,this.sth().getNativeActionName(3))};ma.prototype.sth=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(ib.a)(ma,"AddinNativeActionManager",null,[475]);var ta=b(140);na.prototype.invokeAppCommand=
function(za,Nb,bb,Ub){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(za,Nb,bb,Ub)};na.getInstance=function(){na.Ma||(na.Ma=new na);return na.Ma};na.Ma=null;Object(ib.a)(na,"OSFAddinCommandsRuntimeManager",null,[474]);var Ka=b(5),mb=b(170),Ha=b(23),Ga=ta.a;Em(La,Ga);La.prototype.utg=function(za){this.Ya.addHandler("OnDialogClosedEventKey",za)};La.prototype.T8i=function(){this.nCa=null};La.prototype.qC=function(){Ga.prototype.qC.call(this);this.Qo.style.width="100%";this.Qo.style.height=this.P9b?
this.CSa:this.Dag;this.Qo.style.marginTop=this.P9b?this.gNb:this.Eag;this.Qo.style.padding=this.DSa};La.prototype.mN=function(){Ga.prototype.mN.call(this);this.Lb.style.width=String.format("{0}px",this.QBc*window.innerWidth/100);this.Lb.style.height=String.format("{0}px",this.oYd*window.innerHeight/100);this.Lb.style.minWidth="0px";this.eCc&&Ka.AFrameworkApplication.isRtl&&100===this.QBc&&(this.Lb.style.right="0px",this.Lb.style.marginRight="0px");this.Z7=document.getElementById(this.Yh(this.IMc));
this.Z7.style.position="absolute";this.Z7.style.whiteSpace="nowrap";this.Z7.style.textOverflow="ellipsis";Ka.AFrameworkApplication.isRtl?(this.Z7.style.right="14px",this.Z7.style.left="44px"):(this.Z7.style.right="44px",this.Z7.style.left="14px")};La.prototype.Eu=function(za){Ga.prototype.Eu.call(this,za);this.Z7&&this.Z7.setAttribute("title",za)};La.prototype.NDd=function(){this.Lb.style.width=String.format("{0}px",this.QBc*window.innerWidth/100);this.Lb.style.height=String.format("{0}px",this.oYd*
window.innerHeight/100);this.Lb.style.overflowY="hidden";this.Lb.style.overflowX="hidden";this.Lb.style.marginTop="";this.Lb.style.top="";Ha.a.QP&&Ka.AFrameworkApplication.isRtl?(this.Lb.style.right="",this.Lb.style.marginRight=""):(this.Lb.style.left="",this.Lb.style.marginLeft="")};La.prototype.hide=function(){var za=this;this.n9f.MRg(this.fBa).execute(this,na.getInstance(),{});this.Y7d=window.setTimeout(function(){za.Ya.raiseEvent("OnDialogClosedEventKey",za.fBa);mb.a.prototype.hide.call(za)},
500)};La.prototype.qwi=function(za){3===za&&(window.clearTimeout(this.Y7d),this.Ya.raiseEvent("OnDialogClosedEventKey",this.fBa),Ga.prototype.hide.call(this))};Ll.Object.defineProperties(La.prototype,{kGa:{configurable:!0,enumerable:!0,get:function(){return this.Qo}}});Object(ib.a)(La,"AppsForOfficeDialog",ta.a,[466,467]);Object(ib.a)(ra,"DialogInfo",null,[]);ca.url="url";ca.height="height";ca.width="width";ca.g1c="displayInIframe";ca.q$b="hideTitle";Object(ib.a)(ca,"DialogSettings",null,[]);Object(ib.a)(Z,
"DisplayDialogParams",null,[]);var Fa=Sys.EventArgs;Em(U,Fa);Object(ib.a)(U,"OnMessageDialogEventArgs",Sys.EventArgs,[]);var eb=Sys.EventArgs;Em(da,eb);Object(ib.a)(da,"OnMessageParentEventArgs",Sys.EventArgs,[]);var db=b(41),Na=b(30),kb=b(196),Tb=b(106);V.prototype.Btg=function(za){this.Ya.addHandler("OnMessageParentEventKey",za)};V.prototype.Atg=function(za){this.Ya.addHandler("OnMessageDialogEventKey",za)};V.prototype.showDialog=function(za,Nb,bb,Ub){if(V.O6.qb(Nb))pb.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var kc=db.b(za),ad=kc[ca.url];if(this.fm.getOsfControl(Nb).checkAppDomains(ad)){var Qd=new Z;Qd.width=kc[ca.width];Qd.height=kc[ca.height];Qd.pageUrl=ad;Qd.g1c=kc[ca.g1c];Qd.q$b=kc[ca.q$b];Qd.controlId=Nb;Qd.Ie=kb.a.create().toString();var We=new ra;We.Ie=Qd.Ie;var Ke=this.fm.getOsfControl(Qd.controlId).getManifest().getDefaultDisplayName(),nf=this.fm.getOsfControl(Qd.controlId).getStoreType().toLowerCase();
za=null;za=4===Ka.AFrameworkApplication.xa.Xa.Tk&&"hardcodedpreinstall"===nf&&Qd.q$b?this.createAndShowAppsForOfficeDialog(Qd.width,Qd.height,Qd.Ie,!0,Ke):this.createAndShowAppsForOfficeDialog(Qd.width,Qd.height,Qd.Ie,!1,Ke);var Pe=this.fm.getOsfControl(Qd.controlId),hf=Pe.getManifest();Nb={};Ka.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Nb.id=Qd.Ie,Nb.solutionId=hf.getMarketplaceID(),Nb.version=hf.getMarketplaceVersion(),Nb.storeType=
nf,Nb.storeId=Pe.getStoreLocator(),Nb.assetId=Pe.getAssetId(),Nb.assetStoreId=Pe.getAssetStoreId(),Nb.ownerAddinSolutionId=Pe.getOwnerAddinSolutionId(),Nb.ownerAddinStoreType=Pe.getOwnerAddinStoreType(),Nb.appDomains=hf.getAppDomains(),Nb.dialogUrl=ad,Nb.osfControlType=1,Nb.marketplaceID=hf.getMarketplaceID(),Nb.marketplaceVersion=hf.getMarketplaceVersion(),Nb.store=Pe.getStoreLocator(),Nb.ownerAddinAssetId=Pe.getOwnerAddinAssetId(),Nb.agaveName=Ke,Nb.div=za.kGa,pb.ULS.sendTraceTag(542978531,344,
50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==Nb.ownerAddinStoreType?Nb.ownerAddinStoreType:Nb.storeType,Nb.store,Nb.solutionId),Na.a.jv(Qd.pageUrl))):(Nb.id=Qd.Ie,Nb.marketplaceID=hf.getMarketplaceID(),Nb.marketplaceVersion=hf.getMarketplaceVersion(),Nb.appDomains=hf.getAppDomains(),Nb.store=Pe.getStoreLocator(),Nb.storeType=nf,Nb.ownerAddinAssetId=Pe.getOwnerAddinAssetId(),Nb.ownerAddinStoreType=Pe.getOwnerAddinStoreType(),Nb.dialogUrl=ad,Nb.osfControlType=
1,Nb.agaveName=Ke,Nb.div=za.kGa,pb.ULS.sendTraceTag(540379087,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==Nb.ownerAddinStoreType?Nb.ownerAddinStoreType:Nb.storeType,Nb.store,Nb.marketplaceID),Na.a.jv(Qd.pageUrl)));this.fm.insertDialogControl(Nb);za.utg(Object(ab.a)(this,this.Vqi,"onDialogClosed"));We.dialog=za;V.O6.ia(Qd.controlId,We);Ub&&Ub(Nb);bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else pb.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),
bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Vf){pb.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Vf.message),bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};V.prototype.dii=function(za,Nb,bb,Ub){Ka.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Ub&&(Ub=bb);try{var kc=this.mta(za);kc&&this.Ya.raiseEvent("OnMessageParentEventKey",new da(kc,OSF.DialogMessageType.DialogMessageReceived,
Nb,bb,Ub))}catch(ad){return pb.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",ad.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};V.prototype.tWc=function(za,Nb){if(V.O6.qb(za))try{var bb=V.O6.oa(za);bb.dialog&&bb.dialog.hide();this.fm.purgeDialogControl(bb.Ie);V.O6.remove(za);Nb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ub){pb.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",
Ub.message),Nb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else pb.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Nb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};V.prototype.L4i=function(za,Nb,bb,Ub){Ka.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Ub&&(Ub=bb);if(V.O6.qb(za)&&(za=V.O6.oa(za),za.dialog))try{this.Ya.raiseEvent("OnMessageDialogEventKey",
new U(za.Ie,OSF.DialogMessageType.DialogParentMessageReceived,Nb,bb,Ub))}catch(kc){pb.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",kc.message)}};V.prototype.mta=function(za){for(var Nb=null,bb=Ol(V.O6),Ub=bb.next();!Ub.done;Ub=bb.next())if(Ub=Ub.value,Ub.value.Ie===za){Nb=Ub.key;break}return Nb};V.prototype.Vqi=function(za,Nb){if(za=this.mta(Nb))this.fm.purgeDialogControl(Nb),V.O6.remove(za),this.Ya.raiseEvent("OnMessageParentEventKey",new da(za,OSF.DialogMessageType.DialogClosed,
null,null,"*"))};V.prototype.createAndShowAppsForOfficeDialog=function(za,Nb,bb,Ub,kc){za=new La(za,Nb,bb);kc=Ub?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,kc);Ub&&(za.P9b=!1,za.lu=!1);za.initializeAndShow(kc,null,null);za.T8i();return za};V.vLh=function(){return V.O6};V.getInstance=function(za){V.Ma||(V.Ma=new V(za));return V.Ma};V.Ma=null;V.O6=new Tb.a;Object(ib.a)(V,"AppsForOfficeDialogManager",null,[465]);var ha=b(1274),lb=b(1350),Wa=b(1055),Ra=b(1276),Yb=b(163),oc=b(88),
zb=b(86),uc=b(829),P=b(184),lc=b(787),Ec=b(786),tc=b(797),cc=b(83),Zb=b(403),Aa=b(139),Ia=b(211),qb=b(36),wb=b(4),ic=b(933),Jb=b(1231),Ua=b(74);Object(ib.a)(Y,"DdaRequestInfo",null,[]);var $a=b(840),ua=b(79),Ca=Ua.a;Em(N,Ca);N.prototype.F0g=function(za,Nb){this.disposed||(this.GYb||(this.grid.Gc.Xr(Object(ab.a)(this,this.pj,"onEditEnded")),this.GYb=!0),this.requests.add(Object.assign(new Y,{command:za,properties:Nb})))};N.prototype.pj=function(){if(!this.disposed){this.grid.Gc.Fr(Object(ab.a)(this,
this.pj,"onEditEnded"));this.GYb=!1;var za=this.requests;this.requests=new Ia.a;za=Ol(za);for(var Nb=za.next();!Nb.done;Nb=za.next())Nb=Nb.value,this.ddaFacade.lJ(Nb.command,Nb.properties)}};N.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.GYb&&this.grid.Gc.Fr(Object(ab.a)(this,this.pj,"onEditEnded"));var za=this.requests;this.requests=null;za=Ol(za);for(var Nb=za.next();!Nb.done;Nb=za.next())Nb=Nb.value,(Nb=Nb.properties?Nb.properties[ua.a.q2]:null)&&this.ddaFacade.hf($a.a.J2a,
Nb);this.ddaFacade=this.grid=null;Ca.prototype.dispose.call(this)}};N.oNg=function(za,Nb){var bb=!1;974713501===za&&(Nb=(za=Nb?Nb[ua.a.Hj]:null)?za.DdaMethod:null)&&Nb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(bb=za.ArrayData,bb=!!bb&&64===(bb[6]&64));return bb};Object(ib.a)(N,"DdaCellEditDelayRequestHandler",Ua.a,[]);var Sa=b(878),Qb=Sa.a;Em(G,Qb);Object(ib.a)(G,"DialogMessageReceivedEventArgs",Sa.a,[]);var Hb=Sa.a;Em(W,Hb);Object(ib.a)(W,"DialogParentMessageReceivedEventArgs",
Sa.a,[]);var Db=b(1);fa.prototype.addHandler=function(za,Nb,bb,Ub){var kc=this;if(Db.EwaSettings.ka(24))this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,bb);else{pb.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var ad=function(Qd){Qd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(kc.handlers.ia(za,Nb),kc.Qg.iu(bb)):(pb.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),kc.Qg.hf(Qd,bb))};this.handlers.qb(za)?
ad(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(za,Ub,ad)}};fa.prototype.fpg=function(za,Nb,bb){Db.EwaSettings.ka(24)?this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,bb):(pb.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.lgc.ia(za,Nb),this.Qg.iu(bb))};fa.prototype.removeHandler=function(za,Nb){var bb=this;Db.EwaSettings.ka(24)?this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Nb):this.handlers.qb(za)?(pb.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.sZa.tWc(za,function(Ub){bb.handlers.remove(za);Ub===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?bb.Qg.iu(Nb):(pb.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),bb.Qg.hf(Ub,Nb))})):this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Nb)};fa.prototype.ESi=function(za,Nb){Db.EwaSettings.ka(24)?this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Nb):(pb.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.lgc.remove(za),this.Qg.iu(Nb))};fa.prototype.showDialog=function(za,Nb,bb){var Ub=this;try{this.sZa.showDialog(Nb,za,bb,function(kc){Ub.Qg.xpg(Ub.oFg(kc))})}catch(kc){pb.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",kc.message),bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};fa.prototype.oFg=function(za){var Nb={};Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(Nb.InstanceId=za.id,Nb.WebExtensionType=za.osfControlType===OSF.OsfControlTarget.InContent?0:1,Nb.PrimaryMarketplace={},Nb.PrimaryMarketplace.SolutionId=za.solutionId,Nb.PrimaryMarketplace.SolutionVersion=za.version,Nb.PrimaryMarketplace.MarketplaceRef=za.storeId):(Nb.InstanceId=za.id,Nb.WebExtensionType=za.osfControlType===OSF.OsfControlTarget.InContent?0:1,Nb.PrimaryMarketplace={},Nb.PrimaryMarketplace.SolutionId=za.marketplaceID,Nb.PrimaryMarketplace.SolutionVersion=za.marketplaceVersion,
Nb.PrimaryMarketplace.MarketplaceRef=za.store);Nb.PrimaryMarketplace.MarketplaceType=za.storeType;return Nb};fa.prototype.fwi=function(za,Nb){this.handlers.qb(Nb.controlId)&&(za=new G(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Nb.controlId,null,Nb.messageType,Nb.messageContent,Nb.messageOrigin,Nb.targetOrigin),this.handlers.oa(Nb.controlId)(za),Nb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(Nb.controlId))};fa.prototype.ewi=function(za,Nb){this.lgc.qb(Nb.controlId)&&
(za=new W(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Nb.controlId,null,Nb.messageType,Nb.messageContent,Nb.messageOrigin,Nb.targetOrigin),this.lgc.oa(Nb.controlId)(za))};fa.ja=function(za){if(!za.$.ea.Ba(232)){var Nb=new fa(za);za.$.ea.Ia(232,Nb)}};Ll.Object.defineProperties(fa.prototype,{sZa:{configurable:!0,enumerable:!0,get:function(){this.cRc||(this.cRc=V.getInstance(this.contextActivationMgr));return this.cRc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.sh&&
this.Qg&&(this.sh=this.Qg.sh);return this.sh}}});Object(ib.a)(fa,"DialogMessageReceivedEventManager",null,[481]);aa.prototype.kVb=function(za){za&&(this.Mz||(this.Mz=[]),Array.add(this.Mz,za))};aa.prototype.hnc=function(za){this.Mz&&Array.remove(this.Mz,za)};aa.prototype.wgi=function(za){return this.eventId!==za.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===za.ddaBinding.Name:!0};aa.prototype.lYb=
function(za){this.Mz&&Array.forEach(this.Mz,function(Nb){Nb(za)})};aa.prototype.Vka=function(){this.Mz=[]};Ll.Object.defineProperties(aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Mda}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Mkg}},kQh:{configurable:!0,enumerable:!0,get:function(){return 0<this.Mz.length}}});Object(ib.a)(aa,"DdaEventRegistration",null,[]);var jc=b(20);L.prototype.invokeDdaMethod=function(za,Nb){var bb={};bb[ua.a.Hj]=za;
bb[ua.a.q2]=Nb;this.Qg.lJ(974713501,bb)};L.prototype.registerDdaEventAsync=function(za,Nb,bb,Ub,kc){L.yvb(za)?(L.Rgd(za)&&this.Edd(),this.AD||(this.AD=[]),Nb=this.Bqb(za,bb),Nb||(Nb=new aa(za,bb),Array.add(this.AD,Nb)),Nb.kVb(Ub),this.Qg.iu(kc)):this.Qg.hf(-1,kc)};L.prototype.unregisterDdaEventAsync=function(za,Nb,bb,Ub,kc){L.yvb(za)?((za=this.Bqb(za,bb))&&za.hnc(Ub),this.Qg.iu(kc)):this.Qg.hf(-1,kc)};L.prototype.Edd=function(){this.jua||(jc.g(this.Qg.$).ga.GF(Object(ab.a)(this,this.$c,"onSelectionChanged")),
this.jua=!0)};L.prototype.$c=function(){this.AD.forEach(function(za){za.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&za.lYb(new Sa.a(za.eventId,"",null))})};L.prototype.Bqb=function(za,Nb){if(!this.AD)return null;for(var bb=0;bb<this.AD.length;bb++){var Ub=this.AD[bb];if(Ub.eventId===za&&Ub.targetId===Nb)return Ub}return null};L.yvb=function(za){return za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};L.Rgd=function(za){return za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};
Object(ib.a)(L,"EmbeddingPage",null,[471]);var sb=b(189),fb=Sa.a;Em(Q,fb);Q.prototype.getStartRow=function(){return this.startRow};Q.prototype.getStartColumn=function(){return this.startColumn};Q.prototype.getRowCount=function(){return this.rowCount};Q.prototype.getColumnCount=function(){return this.columnCount};Object(ib.a)(Q,"DdaBindingSelectionEventArgs",Sa.a,[]);var Qa=b(185),cb=b(25),Ab=b(46),gc=b(58),Lc=b(404),Nc=b(44),yd=b(35),Od=b(581),sa=b(107),vb=b(52),Lb=b(92),rc=b(11),Oc=b(9),Bb=b(7),
hc=b(102),Pc=sb.a;Em(S,Pc);S.prototype.JWh=function(za){this.Vba||(this.Vba=za)};S.prototype.tEf=function(){this.Vba&&(this.Vba.dispose(),this.Vba=null)};S.prototype.Wed=function(){var za=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.ed.PrimaryMarketplace.MarketplaceType)&&Db.EwaSettings.ka(187)){var Nb=gc.GetServiceTaskFactory.Va(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");yd.TaskExtensions.Aa(Nb,function(){Nb.result.eg(35,null)},this.la,3);return this}if(1===
this.ed.WebExtensionType)yd.TaskExtensions.Aa(Lc.a(this.$),function(kc){kc.result.dob(za.$.ea,77,6,Object(ab.a)(za,za.Ejf,"onAgavePaneCreated"),1)},this.la,3);else{var bb=this.xKe(),Ub=hc.a(this.$);bb||(bb={Type:3},bb.Id=this.a0.WebExtensionId,bb.WebExtensionData=this.ed,bb.ContentHtml="<div/>",bb.Version=0,bb.AbsoluteLeft=0,bb.AbsoluteTop=0,bb.AbsoluteRight=0,bb.AbsoluteBottom=0,bb.Width=0,bb.Height=0,bb.ZOrder=0,bb.OriginDeltaX=0,bb.OriginDeltaY=0,bb=new Qa.a(bb),Ub.X_b(bb,null),bb=Ub.kp(bb.Dg()));
bb?(this.Kqc(bb.Ld.firstChild),this.Dfa=Object(cc.a)(350,bb)):Ub.tPc(Object(ab.a)(this,this.onFloatingObjectControlAdded,"onFloatingObjectControlAdded"))}return this};S.prototype.i1e=function(za){this.Kqc(za);return this};S.prototype.Uhc=function(){this.Wxf||this.Qg.sh.purgeOsfControl(this.controlId,!1);this.J0f(!0);var za=this.xKe();za&&hc.a(this.$).deleteFloatingObject(za);this.Qg.Ti.oSi(this.controlId);this.Qg.Ti.JCe(this.controlId,!0);this.DIc=null};S.prototype.bud=function(za){this.a0=za};S.prototype.invokeDdaMethod=
function(za,Nb){if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var bb={};bb[ua.a.Hj]=za;bb[ua.a.q2]=Nb;this.Qg.lJ(974713501,bb)}else this.Qg.hf($a.a.J2a,Nb)};S.prototype.XPi=function(za,Nb,bb,Ub){if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!S.b5g(za)||void 0!==Nb&&null!==Nb&&void 0!==this.F_a(Nb)&&null!==this.F_a(Nb))if(pb.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",za,Nb),S.h4e(za)&&this.YRh(),
S.Rgd(za)&&this.Edd(),S.f4e(za))Db.EwaSettings.ka(24)?this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ub):this.Qg.$.ea.Ba(232).addHandler(this.controlId,bb,Ub,Nb);else if(S.g4e(za))Db.EwaSettings.ka(24)?this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ub):this.Qg.$.ea.Ba(232).fpg(this.controlId,bb,Ub);else{S.e4e(za)&&this.rXe(-1777565636,Ub);this.AD||(this.AD=[]);var kc=this.Bqb(za,Nb);kc||(kc=new aa(za,Nb),Array.add(this.AD,kc));kc.Vka();kc.kVb(bb);
this.Qg.iu(Ub);za===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.NSa&&(this.k1b=bb)}else this.Qg.hf(3002,Ub);else this.Qg.hf(-1,Ub)};S.prototype.Quj=function(za,Nb,bb,Ub){S.f4e(za)?Db.EwaSettings.ka(24)?this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ub):this.Qg.$.ea.Ba(232).removeHandler(this.controlId,Ub):S.g4e(za)?Db.EwaSettings.ka(24)?this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ub):this.Qg.$.ea.Ba(232).ESi(this.controlId,Ub):(S.e4e(za)&&
this.rXe(1592314317,Ub),Nb=this.Bqb(za,Nb),this.enabled?(Nb&&(Nb.hnc(bb),Nb.kQh||Array.remove(this.AD,Nb),this.AD.length?S.h4e(za)&&this.K0f(!1):this.J0f(!1)),this.Qg.iu(Ub)):this.Qg.hf(-1,Ub))};S.prototype.ja=function(za){rc.DOMElementExtensions.getElementById(za,this.Puf)||za.appendChild(rc.DOMElementExtensions.ig(this.wt))};S.prototype.showHide=function(za){rc.DOMElementExtensions.setVisible(this.wt,za)};S.prototype.resize=function(za,Nb){rc.DOMElementExtensions.nq(this.wt,za);rc.DOMElementExtensions.eF(this.wt,
Nb)};S.prototype.Eze=function(za){if(!this.oT&&!rc.DOMElementExtensions.getElementById(this.wt,this.a1c)&&this.wt){var Nb=document.createElement("div");Nb.id=this.a1c;Nb.className="ewa-wx-disabled-div";Nb.style.backgroundImage="url("+vb.a.current.mn(82)+")";Nb.style.opacity=za?"1":"0";Nb.style.backgroundRepeat="no-repeat";Nb.style.backgroundPosition="center";this.wt.insertBefore(Nb,this.wt.firstChild)}this.oT++};S.prototype.e8g=function(){0<this.oT&&this.oT--;this.oT||(rc.DOMElementExtensions.ig(rc.DOMElementExtensions.getElementById(this.wt,
this.a1c)),this.jua&&!Ab.Q(this.ilc,jc.g(this.$).ga.wa.selectedRanges)&&this.$c(null,null))};S.prototype.F_a=function(za){if(!this.a0||!this.a0.BindingData)return null;for(var Nb=0;Nb<this.a0.BindingData.length;Nb++)if(this.a0.BindingData[Nb].Name===za)return this.a0.BindingData[Nb];return null};S.prototype.getDefaultIconUrl=function(){var za=this.$Se();return za?za.getDefaultIconUrl():null};S.prototype.getDefaultDisplayName=function(){if(this.ed.TaskpaneTitle)return this.ed.TaskpaneTitle;var za=
this.$Se();return za?za.getDefaultDisplayName():null};S.prototype.$yf=function(){if(this.NSa&&this.k1b){var za=new Sa.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.NSa);this.k1b(za);this.k1b=this.NSa=null}};S.prototype.Hf=function(za){this.HSd&&this.HSd.Hf(za)};S.prototype.P6i=function(){var za=this;this.$.fa.isNamedObjectViewMode&&this.M4h()&&(this.$.ea.Ba(34).O6i(this.wt),this.showHide(!1));if(this.Qg.DCj){if(!this.Wxf){var Nb={};Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(Nb.div=this.wt,Nb.id=this.ed.InstanceId,Nb.solutionId=this.ed.PrimaryMarketplace.SolutionId,Nb.version=this.ed.PrimaryMarketplace.SolutionVersion,Nb.storeId=this.ed.PrimaryMarketplace.MarketplaceRef,Nb.storeType=this.ed.PrimaryMarketplace.MarketplaceType,Nb.ownerAddinSolutionId=this.ed.OwnerAddinSolutionId,Nb.ownerAddinStoreType=this.ed.OwnerAddinStoreType,this.ed.AssetMarketplace&&(Nb.assetId=this.ed.AssetMarketplace.SolutionId,Nb.assetStoreId=this.ed.AssetMarketplace.MarketplaceRef,Nb.alternateReference=
{},Nb.alternateReference.marketplaceID=this.ed.AssetMarketplace.SolutionId,Nb.alternateReference.marketplaceVersion=this.ed.AssetMarketplace.SolutionVersion,Nb.alternateReference.store=this.ed.AssetMarketplace.MarketplaceRef,Nb.alternateReference.storeType=this.ed.AssetMarketplace.MarketplaceType),Nb.marketplaceID=this.ed.PrimaryMarketplace.SolutionId,Nb.marketplaceVersion=this.ed.PrimaryMarketplace.SolutionVersion,Nb.store=this.ed.PrimaryMarketplace.MarketplaceRef,Nb.ownerAddinAssetId=this.ed.OwnerAddinAssetId):
(Nb.div=this.wt,Nb.id=this.ed.InstanceId,Nb.marketplaceID=this.ed.PrimaryMarketplace.SolutionId,Nb.marketplaceVersion=this.ed.PrimaryMarketplace.SolutionVersion,Nb.store=this.ed.PrimaryMarketplace.MarketplaceRef,Nb.storeType=this.ed.PrimaryMarketplace.MarketplaceType,Nb.ownerAddinAssetId=this.ed.OwnerAddinAssetId,Nb.ownerAddinStoreType=this.ed.OwnerAddinStoreType,this.ed.AssetMarketplace&&(Nb.alternateReference={},Nb.alternateReference.marketplaceID=this.ed.AssetMarketplace.SolutionId,Nb.alternateReference.marketplaceVersion=
this.ed.AssetMarketplace.SolutionVersion,Nb.alternateReference.store=this.ed.AssetMarketplace.MarketplaceRef,Nb.alternateReference.storeType=this.ed.AssetMarketplace.MarketplaceType));Nb.settings=this.ed.OsfPropertyBag;Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Nb.reason=this.Q2a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Tac?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:
Nb.reason=this.Q2a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Nb.osfControlType=this.ed.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent;Nb.isForUILessAction=4===this.ed.WebExtensionOsfControlType;Nb.sourceLocationOverrideResourceId=this.ed.SrcLocationOverrideResourceId;Nb.focusOnIframeWhenLoaded=this.ed.FocusOnIframeWhenLoaded;Od.a(this.ed)&&(Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?Nb.featureGates=Ka.AFrameworkApplication.ha.DQe(Nb.solutionId):Nb.featureGates=Ka.AFrameworkApplication.ha.DQe(Nb.marketplaceID));Nb.hostInfoFlags=0;Bb.a.ma(this.YFa)||(Nb.hostInfoFlags|=2);Oc.HelperMethods.qy(this.ed)&&(Nb.hostInfoFlags|=1);this.$.kqa||(pb.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Nb.hostInfoFlags|=4);Db.EwaSettings.ka(673)&&(Nb.hostInfoFlags|=8);Db.EwaSettings.ka(53)&&Db.EwaSettings.ka(93)&&Bb.a.ma(this.tBc)&&(Nb.virtualOsfControlActivationCallback=
function(){za.Qg.Yud(za.ed)});Nb.sharedRuntimeId=this.ed.SharedRuntime?this.ed.SharedRuntime.Resid:this.ed.SharedRuntimeId;!Oc.HelperMethods.qy(this.ed)||this.ed.Preload||Od.a(this.ed)||this.Qg.sh.getOsfControl(b(843).DdaFacade.getSolutionId(this.ed,this.$))||(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Qg.Yud(this.ed):this.Qg.Yud(this.ed));Nb.initialDisplayMode=this.ed.TaskpaneVisible?2:1;this.Qg.sh.insertOsfControl(Nb)}this.oT=
0}else this.Eze(!0)};S.prototype.J0f=function(za){this.K0f(za);this.yuj()};S.prototype.YRh=function(){this.i$a||this.vh.kVb(Object(ab.a)(this,this.pXe,"handleDdaEvent"));this.i$a++};S.prototype.K0f=function(za){0<this.i$a&&(za?this.i$a=0:this.i$a--,this.i$a||this.vh.hnc(Object(ab.a)(this,this.pXe,"handleDdaEvent")))};S.prototype.Edd=function(){if(!this.jua){var za=jc.g(this.$).ga;this.ilc=Ab.d(jc.g(this.$).ga.wa.selectedRanges);za.GF(Object(ab.a)(this,this.$c,"onSelectionChanged"));this.jua=!0}};
S.prototype.yuj=function(){this.jua&&(jc.g(this.$).ga.aK(Object(ab.a)(this,this.$c,"onSelectionChanged")),this.jua=!1)};S.prototype.M3i=function(za){var Nb=new cb.Range(za.Reference.FirstRow+1,za.Reference.FirstColumn+1,za.Reference.LastRow+1,za.Reference.LastColumn+1,!1,!1);1===za.BindingType&&(za.HasHeaders&&--Nb.top,za.HasTotals&&(Nb.bottom+=1));var bb=jc.g(this.$).ga.wa.selectedRanges;za=Nb.Uub(this.ilc);bb=Nb.Uub(bb);return(Nb=Nb.Ef(jc.g(this.$).ga.wa.activeRange))&&(sa.e(za)&&!sa.e(bb)||!sa.e(za)&&
!sa.e(bb)&&!Ab.Q(za,bb))?Nb:null};S.prototype.V4i=function(){var za=this;Array.forEach(this.AD,function(Nb){if(Nb.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Nb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za.Qg.Ti.BWb(za.controlId))if(Nb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Nb.lYb(new Sa.a(Nb.eventId,za.controlId,null));else if(Nb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var bb=za.F_a(Nb.targetId);if(bb&&
bb.IsValidRef&&(za.$.fa.isNamedObjectViewMode?za.$.wb.qa.sheetName:za.$.va.qa.name)===bb.Reference.SheetName){var Ub=za.M3i(bb);Ub&&Nb.lYb(new Q(Nb.eventId,za.controlId,za.Qg.qXb(bb),bb,Ub.top-1,Ub.left-1,Ub.height,Ub.width))}}})};S.prototype.$c=function(){this.enabled&&(this.V4i(),this.ilc=Ab.d(jc.g(this.$).ga.wa.selectedRanges))};S.prototype.Bqb=function(za,Nb){if(!this.AD)return null;for(var bb=0;bb<this.AD.length;bb++){var Ub=this.AD[bb];if(Ub.eventId===za&&Ub.targetId===Nb)return Ub}return null};
S.prototype.pXe=function(za){za.controlId===this.ed.InstanceId&&Array.forEach(this.AD,function(Nb){Nb.wgi(za)&&Nb.lYb(za)})};S.prototype.xKe=function(){for(var za=hc.a(this.$).ky,Nb=za.length-1;0<=Nb;--Nb){var bb=za[Nb];if(3===bb.floatingObject.type&&bb.floatingObject.Wk.InstanceId===this.a0.WebExtensionId)return bb}return null};S.prototype.M4h=function(){for(var za=0;za<this.$.wb.count;za++)if(this.$.wb.getItem(za).Eia===this.a0.WebExtensionId)return!0;return!1};S.prototype.Ejf=function(za){(za=
Object(cc.a)(237,za))&&!za.np()&&(!this.ed||OSF.OsfControl.isFirstPartyStoreString(this.ed.PrimaryMarketplace.MarketplaceType)||this.$.kqa?(za.Uf=this.ed,za.sg=this.Qg,this.HSd=za,this.Kqc(za.XDa),Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(za.sof(),(this.ed.SharedRuntime&&1===this.ed.SharedRuntime.LifeTime||this.ed.SharedRuntimeId)&&!this.ed.TaskpaneVisible&&za.Hf(!1)):((this.ed.SharedRuntime&&1===this.ed.SharedRuntime.LifeTime||this.ed.SharedRuntimeId)&&
!this.ed.TaskpaneVisible&&za.Hf(!1),za.sof()),this.Q2a||(Nc.a.Jd(this.$)?za.uQ():Lc.a(this.$).result.FC(za,!0)),this.$.ea.Ba(77).KEf(Object(ab.a)(this,this.Ejf,"onAgavePaneCreated")),this.Dfa=Object(cc.a)(350,za)):pb.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM"))};S.prototype.Kqc=function(za){this.DIc=za;this.wt.id=this.Puf;this.wt.className="ewa-wx-container-div";this.wt.dir=this.$.isChromeRtl?"rtl":"ltr";this.P6i()};S.prototype.onFloatingObjectControlAdded=function(za,
Nb){3===Nb.control.floatingObject.type&&Nb.control.floatingObject.Wk.InstanceId===this.a0.WebExtensionId&&(this.Dfa=Object(cc.a)(350,Nb.control),this.Kqc(Nb.control.Ld.firstChild),hc.a(this.$).fCd(Object(ab.a)(this,this.onFloatingObjectControlAdded,"onFloatingObjectControlAdded")))};S.prototype.$Se=function(){if(!this.enabled)return null;var za=Od.a(this.Wk)?"":this.Wk.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.Wk.PrimaryMarketplace.SolutionId,za)};S.prototype.rXe=
function(za,Nb){if(Db.EwaSettings.ka(24))this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Nb);else try{if(pb.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.i6d)this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Nb);else{var bb={};bb[uc.a.Ikb]=this.controlId;var Ub=new Lb.a(za,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Ub(Ub,bb);this.Qg.iu(Nb)}}catch(kc){pb.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",
kc.message),this.Qg.hf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Nb)}};S.b5g=function(za){return za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};S.h4e=function(za){return za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||za===OSF.DDA.EventDispId.dispidSettingsChangedEvent||za===OSF.DDA.EventDispId.dispidRichApiMessageEvent};S.Rgd=function(za){return za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};S.f4e=function(za){return za===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};S.g4e=function(za){return za===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};S.e4e=function(za){return za===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};Ll.Object.defineProperties(S.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.ed.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.ed.WebExtensionType}},
ownerAddinAssetId:{configurable:!0,enumerable:!0,get:function(){return this.ed.OwnerAddinAssetId}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.ed.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,get:function(){return this.ub}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.oT}},wt:{configurable:!0,enumerable:!0,get:function(){return this.DIc}},$S:{configurable:!0,enumerable:!0,get:function(){return this.ed.SrcLocationOverrideResourceId?
this.Qg.Hha(this.ed.PrimaryMarketplace.SolutionId,this.ed.SrcLocationOverrideResourceId):this.ed.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.ed.SrcLocationOverrideResourceId}},Wk:{configurable:!0,enumerable:!0,get:function(){return this.ed}},Dfa:{configurable:!0,enumerable:!0,get:function(){return this.kVd},set:function(za){this.kVd=za}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.i6d}},YFa:{configurable:!0,
enumerable:!0,get:function(){return this.tBc},set:function(za){this.tBc=za}},y_c:{configurable:!0,enumerable:!0,get:function(){return this.NSa},set:function(za){this.NSa=za}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.ed.FocusOnIframeWhenLoaded}},Rid:{configurable:!0,enumerable:!0,get:function(){return this.R1d},set:function(za){this.R1d=za}}});Object(ib.a)(S,"OsfControl",sb.a,[480]);H.prototype.add=function(za){this.hWa[za]=!0};H.prototype.remove=function(za){delete this.hWa[za]};
H.prototype.clear=function(){for(var za=Ol(Object.keys(this.hWa)),Nb=za.next();!Nb.done;Nb=za.next())delete this.hWa[Nb.value]};H.prototype.CYe=function(){return 0<Object.keys(this.hWa).length};H.prototype.rth=function(){return Object.keys(this.hWa)};Object(ib.a)(H,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var rd=b(55);A.prototype.ylb=function(za){51===za.messageType?this.sDf=this.lEa(za.actionType,this.sDf,Object(ab.a)(this,this.fpi,"onChartActiveChartChanged")):52===za.messageType&&
(this.tDf=this.lEa(za.actionType,this.tDf,Object(ab.a)(this,this.gpi,"onChartDeactiveChartChanged")))};A.prototype.lEa=function(za,Nb,bb){if(1===za)Nb||jc.g(this.$).ga.Pa.uPc(bb),Nb++,this.v$i();else if(2===za){if(1>Nb)return Nb;1===Nb&&jc.g(this.$).ga.Pa.gCd(bb);Nb--}return Nb};A.prototype.fpi=function(){var za=jc.g(this.$).ga.Pa.EB;if(this.Agd(za)&&(za=this.U6b(za))){var Nb={chartId:za};Nb.worksheetId=this.Rha();Nb=rd.a.Hc(Nb);this.tha(51,za,Nb);this.tha(51,this.Rha(),Nb)}};A.prototype.gpi=function(){if(this.X7a){var za=
{};za.chartId=this.X7a;za.worksheetId=this.YGb;za=rd.a.Hc(za);this.tha(52,this.X7a,za);this.tha(52,this.YGb,za)}za=jc.g(this.$).ga.Pa.EB;this.Agd(za)?(this.X7a=this.U6b(za),this.YGb=this.Rha()):this.YGb=this.X7a=null};A.prototype.tha=function(za,Nb,bb){Nb&&this.Ti.QY(za,Nb)&&this.vh.AL(za,Nb,bb)};A.prototype.U6b=function(za){return za&&za.floatingObject?(za=za.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===za.length?za[0]:null:null};A.prototype.Rha=function(){var za=
this.$.va.qa;return!za||za.AH?null:za.sheetId};A.prototype.v$i=function(){var za=jc.g(this.$).ga.Pa.EB;this.Agd(za)&&(this.X7a=this.U6b(za),this.YGb=this.Rha())};A.prototype.Agd=function(za){return!!za&&!!za.floatingObject&&!za.floatingObject.type};Object(ib.a)(A,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Id=b(850),Vd=b(180),He=b(646),Nd=b(95),Vc=b(335),fe=b(51),Ee=Ua.a;Em(E,Ee);E.prototype.YWb=function(za){Object(cc.a)(Vc.a,this.$.va);1===za.actionType?(this.Jxa||this.grid.ga.GF(Object(ab.a)(this,
this.$c,"onSelectionChanged")),this.Jxa++):2!==za.actionType||1>this.Jxa||(1===this.Jxa&&this.grid.ga.aK(Object(ab.a)(this,this.$c,"onSelectionChanged")),this.Jxa--)};E.prototype.pqc=function(za){za?this.oT++:(0<this.oT&&this.oT--,this.oT||this.$c(null,new He.a(!1)))};E.prototype.$c=function(za,Nb){var bb=this;if(this.enabled&&!(this.R5e()||Nb&&Nb.b9e)&&(za=Object(cc.a)(Nd.a,this.$.va.qa))&&!za.AH){var Ub=za.sheetId,kc=this.BPe(),ad=null,Qd=null;this.Ti.R8e()&&(ad=this.grid.$b.Mk(this.grid.ga.wa.activeCell),
Qd=Ub in this.kec?this.kec[Ub]:null);this.Hje(Ub,kc)&&yd.TaskExtensions.Aa(fe.Task.Ra(!0),function(){bb.IPh(Ub,kc);bb.sPh(Ub,kc,ad,Qd)},this.la);this.HAe(Ub,kc,ad)}};E.prototype.BPe=function(){return this.grid.ga.wa.selectedRanges};E.prototype.Hje=function(za,Nb){return Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!za&&Vd.e(this.$Ka)||za in this.$Ka)&&!Ab.Q(this.$Ka[za],Nb):za in this.$Ka&&!Ab.Q(this.$Ka[za],Nb)};E.prototype.HAe=function(za,
Nb,bb){this.$Ka[za]=Ab.d(Nb);this.kec[za]=bb};E.prototype.R5e=function(){return this.grid.isEditing||this.grid.li};E.prototype.YKe=function(za,Nb){this.Ti.QY(14,za)&&this.vh.AL(14,za,Nb);this.Ti.QY(14,Id.a.HV)&&this.vh.AL(14,Id.a.HV,Nb)};E.prototype.IPh=function(za,Nb){var bb={};bb.worksheetId=za;bb.address=this.had(Nb);Nb=rd.a.Hc(bb);this.YKe(za,Nb)};E.prototype.sPh=function(za,Nb,bb,Ub){if(this.Ti.R8e()){var kc="",ad="";Ub&&(kc=Ub.gj);bb&&(ad=bb.gj);Ub?bb?(Nb=bb.usedRange.Uub(Nb),kc!==ad&&this.v5b(kc,
"",za),this.v5b(ad,this.had(Nb),za)):this.v5b(kc,"",za):bb&&(kc=bb.usedRange.Uub(Nb),this.v5b(ad,this.had(kc),za))}};E.prototype.v5b=function(za,Nb,bb){if(this.Ti.QY(100,za)){var Ub={};Ub.address=Nb;Ub.worksheetId=bb;this.vh.AL(100,za,rd.a.Hc(Ub))}};E.prototype.had=function(za){return Ab.i(za,",",this.$,!1)};E.prototype.dispose=function(){0<this.Jxa&&this.grid.ga.aK(Object(ab.a)(this,this.$c,"onSelectionChanged"));this.kec=this.$Ka=null;this.Jxa=0;this.vh=this.Ti=this.$=this.grid=null};Ll.Object.defineProperties(E.prototype,
{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.oT&&0<this.Jxa}}});Object(ib.a)(E,"RichApiEventSelectionChangedHandler",Ua.a,[]);var lf=b(333);Em(J,E);J.prototype.BPe=function(){return lf.a.JYa(this.grid.ga.rangePicker.UJ)};J.prototype.Hje=function(za,Nb){return this.J$e!==za||!Ab.Q(this.I$e,Nb)};J.prototype.HAe=function(za,Nb){this.J$e=za;this.I$e=Ab.d(Nb)};J.prototype.R5e=function(){return!this.grid.isEditing&&!this.grid.li};J.prototype.YKe=function(za,Nb){this.Ti.QY(2700,Id.a.HV)&&
this.vh.AL(2700,Id.a.HV,Nb)};Object(ib.a)(J,"RichApiEventPickedRangesChangedHandler",E,[]);y.prototype.ylb=function(za){var Nb=jc.g(this.$).ga;1===za.actionType?(this.QNa||this.RNa||Nb.Pa.uPc(Object(ab.a)(this,this.Wmf,"onFloatingObjectSelectionChangedByUserAction")),2101===za.messageType?this.QNa++:2102===za.messageType&&this.RNa++):2===za.actionType&&(2101===za.messageType?this.QNa=0<this.QNa?this.QNa-1:0:2102===za.messageType&&(this.RNa=0<this.RNa?this.RNa-1:0),this.QNa||this.RNa||Nb.Pa.gCd(Object(ab.a)(this,
this.Wmf,"onFloatingObjectSelectionChangedByUserAction")))};y.prototype.Wmf=function(){var za=jc.g(this.$).ga.Pa.EB;if(0<this.RNa&&this.Zfa&&this.CEa){var Nb={};Nb.shapeId=this.Zfa;Nb.worksheetId=this.CEa;Nb=rd.a.Hc(Nb);this.fireEvent(2102,this.Zfa,Nb)}this.o6h(za)?(this.Zfa=this.dtj(za),this.CEa=this.Rha(),this.Zfa&&this.CEa)?0<this.QNa&&(za={},za.shapeId=this.Zfa,za.worksheetId=this.CEa,za=rd.a.Hc(za),this.fireEvent(2101,this.Zfa,za)):pb.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",
this.Zfa,this.CEa):this.CEa=this.Zfa=null};y.prototype.o6h=function(za){return!!za&&!!za.floatingObject&&(!za.floatingObject.type||7===za.floatingObject.type||1===za.floatingObject.type||3===za.floatingObject.type||5===za.floatingObject.type)};y.prototype.dtj=function(za){if(!za||!za.floatingObject)return null;za=za.floatingObject.id;var Nb=za.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Nb=Nb&&1===Nb.length?Nb[0]:null;return Nb?Nb:(pb.ULS.sendTraceTag(537170457,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",
za),null)};y.prototype.Rha=function(){var za=this.$.va.qa;return!za||za.AH?null:za.sheetId};y.prototype.fireEvent=function(za,Nb,bb){Nb&&this.Ti.QY(za,Nb)&&this.vh.AL(za,Nb,bb)};Object(ib.a)(y,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);x.prototype.ylb=function(za){11===za.messageType?za.targetId===Id.a.HV?this.zzg(za.actionType):this.yzg(za.actionType):12===za.messageType&&(za.targetId===Id.a.HV?this.Azg(za.actionType):this.Bzg(za.actionType))};x.prototype.yzg=function(za){this.uDf=this.lEa(za,
this.uDf,Object(ab.a)(this,this.TBi,"onWorksheetActiveSheetChanged"))};x.prototype.Bzg=function(za){this.xDf=this.lEa(za,this.xDf,Object(ab.a)(this,this.WBi,"onWorksheetDeactiveSheetChanged"))};x.prototype.zzg=function(za){this.vDf=this.lEa(za,this.vDf,Object(ab.a)(this,this.UBi,"onWorksheetCollectionActiveSheetChanged"))};x.prototype.Azg=function(za){this.wDf=this.lEa(za,this.wDf,Object(ab.a)(this,this.VBi,"onWorksheetCollectionDeactiveSheetChanged"))};x.prototype.lEa=function(za,Nb,bb){1===za?Nb=
this.KRc(Nb,bb):2===za&&(Nb=this.M0c(Nb,bb));return Nb};x.prototype.KRc=function(za,Nb){za||this.$.va.Pf(Nb);za++;return za};x.prototype.M0c=function(za,Nb){if(1>za)return za;1===za&&this.$.va.zg(Nb);za--;return za};x.prototype.TBi=function(za,Nb){za=Object(cc.a)(Nd.a,Nb.qa);this.v4a(za)&&(Nb={},Nb.worksheetId=za.sheetId,Nb=rd.a.Hc(Nb),this.tha(11,za.sheetId,Nb))};x.prototype.WBi=function(za,Nb){za=Object(cc.a)(Nd.a,Nb.WJ);this.v4a(za)&&(Nb={},Nb.worksheetId=za.sheetId,Nb=rd.a.Hc(Nb),this.tha(12,
za.sheetId,Nb))};x.prototype.UBi=function(za,Nb){za=Object(cc.a)(Nd.a,Nb.qa);this.v4a(za)&&(Nb={},Nb.worksheetId=za.sheetId,za=rd.a.Hc(Nb),this.tha(11,null,za,!0))};x.prototype.VBi=function(za,Nb){za=Object(cc.a)(Nd.a,Nb.WJ);this.v4a(za)&&(Nb={},Nb.worksheetId=za.sheetId,za=rd.a.Hc(Nb),this.tha(12,null,za,!0))};x.prototype.v4a=function(za){return!!za&&!za.AH};x.prototype.tha=function(za,Nb,bb,Ub){Nb=(void 0===Ub?0:Ub)?Id.a.HV:Nb;this.Ti.QY(za,Nb)&&this.vh.AL(za,Nb,bb)};Object(ib.a)(x,"RichApiEventSheetActivatedDeactivatedHandler",
null,[]);var Da=b(167),fc=b(13),Ib=b(278),Ta=Sys.EventArgs;Em(z,Ta);Object(ib.a)(z,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);B.prototype.dispose=function(){this.lvj()};B.prototype.kRi=function(){for(var za=Ol(this.gridView.ao),Nb=za.next();!Nb.done;Nb=za.next())Nb=Nb.value.domElement,Da.a.instance.pa(fc.a.pointerDown,Nb,Object(ab.a)(this,this.onPointerDown,"onPointerDown")),Ib.a.instance.pa(fc.a.click,Nb,Object(ab.a)(this,this.Rc,"onClick"))};B.prototype.lvj=function(){for(var za=Ol(this.gridView.ao),
Nb=za.next();!Nb.done;Nb=za.next())Nb=Nb.value.domElement,Da.a.instance.za(fc.a.pointerDown,Nb,Object(ab.a)(this,this.onPointerDown,"onPointerDown")),Ib.a.instance.za(fc.a.click,Nb,Object(ab.a)(this,this.Rc,"onClick"))};B.prototype.onPointerDown=function(za){var Nb=this,bb;Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5839170_Measure_onPointerDown")&&(bb=window.performance.now());var Ub;this.p2h?3===za.yb?(function(){var kc=Nb.gridView.R6b(za.clientPoint);Ub=kc.SEa;return kc}(),this.ydc=!!Ub&&this.gridView.ga.wa.z1c(Ub)):
this.ydc=!1:(function(){var kc=Nb.gridView.R6b(za.clientPoint);Ub=kc.SEa;return kc}(),this.ydc=3===za.yb&&!!Ub&&this.gridView.ga.wa.z1c(Ub));this.vZb=za.clientPoint;Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5839170_Measure_onPointerDown")&&pb.ULS.sendTraceTag(537147294,0,50,"RichApiEventSingleClickedHandler.onPointerDown duration: {0} ms",window.performance.now()-bb);return!1};B.prototype.Rc=function(za){if(this.gridView.inRangePicker||this.gridView.li||this.ydc||za.shiftKey||za.ctrlKey||za.Ea.button||
!this.vZb||!za.clientPoint||za.clientPoint.x!==this.vZb.x||za.clientPoint.y!==this.vZb.y)return!1;var Nb=this.gridView.R6b(za.clientPoint);za=Nb.SEa;Nb=Nb.returnValue;var bb=Object(cc.a)(Nd.a,this.$.va.qa);if(Nb&&bb&&!bb.AH){if(!this.gridView.ga.wa.c3.contains(za))return!1;za=new z(bb,za,Oc.HelperMethods.Dwd(Nb.x),Oc.HelperMethods.Dwd(Nb.y));this.XBi(za)}return!1};B.prototype.XBi=function(za){var Nb=za.sheet;if(this.v4a(Nb)){var bb={};bb.worksheetId=Nb.sheetId;bb.address=za.OIg.toString();bb.offsetX=
za.offsetX;bb.offsetY=za.offsetY;za=Nb.sheetId;this.Ti.QY(21,za)&&(Nb=rd.a.Hc(bb),this.vh.AL(21,za,Nb));za=Id.a.HV;this.Ti.QY(21,za)&&(bb=rd.a.Hc(bb),this.vh.AL(21,za,bb))}};B.prototype.v4a=function(za){return!!za&&!za.AH};Object(ib.a)(B,"RichApiEventSingleClickedHandler",null,[]);t.prototype.YWb=function(za){2E3===za.messageType&&(1===za.actionType?(this.GDb||jc.g(this.$).ga.Pa.uPc(Object(ab.a)(this,this.$tf,"onVisualSelectionChanged")),this.GDb++,this.W6i()):2===za.actionType&&this.GDb&&(1===this.GDb&&
jc.g(this.$).ga.Pa.gCd(Object(ab.a)(this,this.$tf,"onVisualSelectionChanged")),this.GDb--))};t.prototype.$tf=function(){var za=jc.g(this.$).ga.Pa.EB;if(za)if(this.A9e(za)){var Nb=this.Rha();this.b6c(Nb);this.U7a=za.floatingObject.id;this.L7a=Nb}else this.U7a&&(this.b6c(this.L7a),this.L7a=this.U7a=null);else this.U7a&&(this.b6c(this.L7a),this.L7a=this.U7a=null)};t.prototype.b6c=function(za){var Nb={};Nb.worksheetId=za;Nb.revisionLoad=!1;if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&
(Db.EwaSettings.ka(762)||Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var bb=jc.g(this.$).ga.Pa.EB;Nb.selectedVisualId=bb&&bb.floatingObject&&bb.floatingObject.Nc?bb.floatingObject.Nc.VisualID:null}Nb=rd.a.Hc(Nb);za&&this.Ti.QY(2E3,za)&&this.vh.AL(2E3,za,Nb)};t.prototype.Rha=function(){var za=this.$.va.qa;return!za||za.AH?null:za.sheetId};t.prototype.W6i=function(){var za=jc.g(this.$).ga.Pa.EB;this.A9e(za)&&(this.U7a=za.floatingObject.id,this.L7a=
this.Rha())};t.prototype.A9e=function(za){return!!za&&za.Wkd()};Object(ib.a)(t,"RichApiEventVisualSelectionChangedHandler",null,[]);w.prototype.xzg=function(za){1===za.actionType?(this.HDb||this.Szg(),this.HDb++):2!==za.actionType||1>this.HDb||(1===this.HDb&&this.J1g(),this.HDb--)};w.prototype.Qpe=function(){var za=document.hasFocus();if(this.g6f!==za){if(za){var Nb=rd.a.Hc({});this.vh.AL(2203,Id.a.HV,Nb)}this.g6f=za}};w.prototype.Szg=function(){if(this.Ti.QY(2203,Id.a.HV))if(this.Cjd){var za={};
za.timeout=this.$.ya.CheckFocusTimeout;this.L5b=window.requestIdleCallback(Object(ab.a)(this,this.Rpe,"checkFocusCallback"),za)}else this.L5b=window.setInterval(Object(ab.a)(this,this.Qpe,"checkFocus"),this.$.ya.CheckFocusTimeInterval)};w.prototype.J1g=function(){this.Cjd?window.cancelIdleCallback(this.L5b):window.clearInterval(this.L5b)};w.prototype.Rpe=function(za){(0<za.timeRemaining()||za.didTimeout)&&this.Qpe();window.requestIdleCallback(Object(ab.a)(this,this.Rpe,"checkFocusCallback"))};Object(ib.a)(w,
"RichApiEventWorkbookActivatedHandler",null,[]);var kd;(function(za){za[za.none=0]="none";za[za.registerEvent=1]="registerEvent";za[za.unregisterEvent=2]="unregisterEvent";za[za.customFunction=3]="customFunction";za[za.showCard=4]="showCard";za[za.createWorkbook=5]="createWorkbook";za[za.openWorkbook=6]="openWorkbook";za[za.enableEvents=7]="enableEvents";za[za.closeWorkbook=8]="closeWorkbook";za[za.setCalculationMode=9]="setCalculationMode";za[za.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";
za[za.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";za[za.workbookLinksEnableContent=12]="workbookLinksEnableContent";za[za.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";za[za.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";za[za.rangePicker=15]="rangePicker";za[za.enableRichApiRecording=16]="enableRichApiRecording";za[za.recordAction=17]="recordAction";za[za.focus=18]="focus"})(kd||(kd={}));Object(ib.b)("PostProcessActionType",kd);var ce=b(232);v.prototype.wzg=
function(za){1===za.actionType?(this.$.U$=!0,Object(cc.a)(b(843).DdaFacade,ce.a(this.$)).a6c(!0)):2===za.actionType&&(this.$.U$=!1);this.Quf=za.controlId;pb.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",kd[za.actionType],this.Quf,this.$.U$)};v.prototype.o9g=function(za){Object(cc.a)(b(843).DdaFacade,ce.a(this.$)).aLe(za,this.$.U$)};v.prototype.nWh=function(){var za=this;this.$.Z$&&yd.TaskExtensions.Aa(gc.GetServiceTaskFactory.Va(this.$.ea,
297,298,1,"Microsoft.Office.Excel.WebUI.Client.MacroRecorderEvents.IMacroRecorderEventHandler"),function(Nb){(Nb=Nb.result)&&Nb.init(Object(ab.a)(za,za.$5c,"fireMacroRecorderEvent"))},this.$.la,3)};v.prototype.$5c=function(za,Nb){var bb=Id.a.HV,Ub={};Ub.eventId=za;Ub.payload=Nb;this.Ti.QY(2201,bb)&&this.vh.AL(2201,bb,rd.a.Hc(Ub))};Object(ib.a)(v,"RichApiMacroRecorderEventHandler",null,[]);Object(ib.a)(h,"SessionRecreationInfo",null,[]);r.prototype.tki=function(){return Db.EwaSettings.ka(262)?this.Ti.tQh()||
!!this.runtimeCalculationMode:!1};r.prototype.yEg=function(){var za={};za.eventRegistrationInfos=this.Ti.kzh();za.runtimeCalculationMode=this.runtimeCalculationMode;za=Object.assign(new h,{runtimeState:za});var Nb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Nb.RequestBody=JSON.stringify(za);Nb.RequestFlags=1;return Nb};Object(ib.a)(r,"RichApiRuntimeStateHandler",null,[]);Object(ib.a)(n,"UserOperationQueueItemsStatisticsData",null,[]);var dc=b(320),ub=b(29),pc=b(18),
xc=b(288),hd=b(45),Rc=b(605),ld=b(60),Wd=b(57),ee=b(68),ne=dc.a;Em(l,ne);l.prototype.dispose=function(){this.$&&(this.$.va.zE(Object(ab.a)(this,this.Yn,"onActiveItemChanging")),this.$.wb.zE(Object(ab.a)(this,this.Yn,"onActiveItemChanging")),this.$.wb.zg(Object(ab.a)(this,this.kf,"onActiveItemChanged")),this.$.va.zg(Object(ab.a)(this,this.kf,"onActiveItemChanged")));this.HRa&&(this.HRa.Ko(Object(ab.a)(this,this.Be,"onBlockCacheItemChanged")),this.HRa.nH(Object(ab.a)(this,this.Vl,"onBlockCacheItemEvicted")),
this.HRa.Jq(Object(ab.a)(this,this.Sg,"onBlockCacheConsistent")));Db.EwaSettings.pc()&&this.Cs(Object(ab.a)(this,this.onContentReady,"onContentReady"));this.clearCache();zb.a.Fa(this.HRa);this.HRa=null;rc.DOMElementExtensions.ig(this.domElement);ne.prototype.dispose.call(this)};l.prototype.O6i=function(za){rc.DOMElementExtensions.ig(rc.DOMElementExtensions.getElementById(this.domElement,za.id));this.domElement.appendChild(za)};l.prototype.kfd=function(){if(this.Lta&&!this.w_b){var za=Object(cc.a)(b(843).DdaFacade,
ce.a(this.$)).Pm(this.Lta.InstanceId);za&&(za.resize(this.Lta.Width,this.Lta.Height),za.ja(this.domElement),za.showHide(!0),this.w_b=!0)}};l.prototype.x4a=function(){return!0};l.prototype.Vl=function(za,Nb){Nb.Ed.hash===this.hashCode&&this.Lta&&Object(cc.a)(b(843).DdaFacade,this.$.ea.Ba(35)).Agj(this.Lta.InstanceId)};l.prototype.Be=function(za,Nb){switch(Nb.Ed.block.state){case 1:case 3:case 5:this.Kla(Nb)}};l.prototype.Sg=function(){this.YCb(!0)};l.prototype.Kla=function(za){this.Lta=za.Ed.block.me;
this.w_b=!1;this.kfd()};l.prototype.$Qa=function(za){this.$.fa.LY&&za&&(za.Mt||(za.Mt=new xc.a),za.Mt.Mg=new hd.a(this.domElement.scrollLeft,this.domElement.scrollTop),za.Mt.tCb=20)};l.prototype.clearCache=function(){this.Ca.Mxa(this.hashCode);this.Lta=this.hashCode=null;this.w_b=!1};l.prototype.Yn=function(za,Nb){this.isVisible&&this.$Qa(Nb.WJ);this.clearCache()};l.prototype.kf=function(za,Nb){this.gQa(Nb.qa,!!Nb.WJ)};l.prototype.gQa=function(za,Nb){if(this.isVisible=!!za&&ld.p(za))this.hashCode=
this.Ca.gfa(za,Wd.a.Nob,this.hashCode),this.Wqc(Nb)};l.prototype.CM=function(){this.$.fa.tka()};l.mEa=function(za){if(!za.ea.Ba(34)){var Nb=za.Re;za.ea.Ia(34,new l(za,new Rc.a(za,za.fa,za.ra.xk,3,0),Nb.appendChild(Nb.ownerDocument.createElement("div"))))}};Ll.Object.defineProperties(l.prototype,{Ca:{configurable:!0,enumerable:!0,get:function(){return this.HRa}}});Object(ib.a)(l,"WebExtensionView",dc.a,[478,164,6]);var Ad=b(216),se=b(514),Ve=b(364),Zf=b(428),Pf=b(161),Fe=b(81),me=b(126),ng=b(43),Oe=
b(42),bd=b(147),ac=b(103),Fc=b(69),Zc=b(26),pd=b(27),bf=b(303),Bd=b(16),Qe=b(275),Ob=b(862),yc=b(49),id=b(144),Tc=b(1106),od=b(186),mc=b(998),Le=b(28);b.d(F,"DdaFacade",function(){return a});var we=qb.a;Em(a,we);a.prototype.jfe=function(za){this.addHandler("cd",za)};a.prototype.JTi=function(za){this.removeHandler("cd",za)};a.prototype.kfe=function(za){this.addHandler("csc",za)};a.prototype.Ymc=function(za){this.removeHandler("csc",za)};a.prototype.Org=function(za){this.addHandler("ca",za)};a.prototype.ITi=
function(za){this.removeHandler("ca",za)};a.prototype.Prg=function(za){this.addHandler("ci",za)};a.prototype.Qrg=function(za){this.addHandler("ekros",za)};a.prototype.KTi=function(za){this.removeHandler("ekros",za)};a.prototype.Zvd=function(za,Nb){try{return JSON.parse(za)[Nb].toLowerCase()}catch(bb){return""}};a.prototype.ocj=function(za){var Nb=this.Zvd(za,"AudienceGroup"),bb=this.Zvd(za,"SessionOrigin");try{var Ub=parseInt(this.Zvd(za,"Ring"));if("automation"!==Nb&&"bluechicken"!==bb&&-2<=Ub)return!0}catch(kc){if("automation"!==
Nb&&"bluechicken"!==bb)return!0}return!1};a.prototype.qXb=function(za){var Nb={};Nb.Name=za.Name;Nb.BindingType=za.BindingType;Nb.HasHeaders=za.HasHeaders;za.IsValidRef&&(Nb.ColCount=za.Reference.LastColumn-za.Reference.FirstColumn+1,Nb.RowCount=za.Reference.LastRow-za.Reference.FirstRow+1);return Nb};a.prototype.G$h=function(za,Nb){Nb=this.DDg(Nb);this.fm.launchInsertDialog(za,null,Nb)};a.prototype.Oyd=function(za,Nb){var bb={};bb.callbackFunc=za;bb.storeType=OSF.StoreTypeEnum.MarketPlace;bb.fromInsertDialog=
!1;bb.refresh=Nb;this.fm.queryEntitlementDetails(bb)};a.prototype.invokeDdaMethod=function(za,Nb){var bb=this.Pm(za.DdaMethod.ControlId);bb?bb.invokeDdaMethod(za,Nb):this.hf($a.a.internalError,Nb)};a.prototype.registerDdaEventAsync=function(za,Nb,bb,Ub,kc){(Nb=this.Pm(Nb))?a.yvb(za)?Nb.XPi(za,bb,Ub,kc):this.hf($a.a.tvd,kc):this.hf($a.a.internalError,kc)};a.prototype.unregisterDdaEventAsync=function(za,Nb,bb,Ub,kc){(Nb=this.Pm(Nb))?a.yvb(za)?Nb.Quj(za,bb,Ub,kc):this.hf($a.a.tvd,kc):this.hf($a.a.internalError,
kc)};a.prototype.dispose=function(){this.disposed||(this.$.dl(Object(ab.a)(this,this.jd,"onWorkbookOpened")),this.fa.qk(Object(ab.a)(this,this.Vc,"onSessionIdChanged")),this.fa.tV(Object(ab.a)(this,this.gq,"onLoadOnDemandOccurred")),this.fa.Qv(Object(ab.a)(this,this.Gf,"onWorkbookMetadataChanged")),this.BQc.detach(this),this.$.userOperationManager.zC(Object(ab.a)(this,this.rQ,"onQueueItemChanged")),this.Ljc=this.rf=this.vh=this.BQc=this.ub=null,this.OGa&&(this.OGa.dispose(),this.OGa=null),zb.a.Fa(this.NEd),
zb.a.Fa(this.MEd),this.hZa&&(this.hZa.dispose(),this.hZa=null),we.prototype.dispose.call(this),this.disposed=!0,pb.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.p7b=function(za){return(za=this.Pm(za))?za.getDefaultIconUrl():null};a.prototype.pqc=function(za){if(this.mxe!==za){this.mxe=za;for(var Nb=0,bb=this.rf.length;Nb<bb;Nb++){var Ub=this.rf[Nb];za?Ub.Eze(!1):Ub.e8g()}this.NEd.pqc(za);this.MEd.pqc(za)}};a.prototype.Xxh=function(za){return(za=this.Pm(za))?za.getDefaultDisplayName():
null};a.prototype.Gf=function(){this.eAa=this.fa.qn.WebExtensions;for(var za=this.rf.length-1;0<=za;--za){var Nb=this.rf[za],bb;if(bb=!this.Zmh(Nb.controlId))bb=Nb,bb=Db.EwaSettings.ka(121)?Bb.a.ma(bb.YFa):!0;bb&&(Nb.Uhc(),Array.removeAt(this.rf,za))}if(this.eAa)for(za=0,Nb=this.eAa.length;za<Nb;za++){bb=this.eAa[za];var Ub=this.Pm(bb.WebExtensionId);Ub&&Ub.bud(bb)}};a.prototype.pka=function(za){this.raiseEvent("csc",za.getID())};a.prototype.Ypf=function(za,Nb,bb){if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&
Nb===OSF.AgaveHostAction.KeyboardShortcuts){var Ub=Object(cc.a)(Object,bb);Nb={};Nb.keyCode=Ub.keyCode;Nb.type="keydown";Nb.ctrlKey=Ub.ctrlKey;Nb.shiftKey=Ub.shiftKey;Nb.altKey=Ub.altKey;Nb.metaKey=Ub.metaKey;za=this.Pm(za);Ub=za.Dfa;Nb.srcElement=Object(Zb.a)(237,Ub)?Ub.XDa:jc.g(this.$).Ib;Nb=new Sys.UI.DomEvent(Nb);za={focusedAddinId:a.dta(za.Wk,this.$)};Ub=new Lb.a(1461300262,1,this.$.dd,6,null);jc.g(this.$).$Eb(Nb,Ub,za)}else if(Nb===OSF.AgaveHostAction.Select)this.gXe(!0);else if(Nb===OSF.AgaveHostAction.UnSelect)this.gXe(!1);
else if(Nb===OSF.AgaveHostAction.CancelDialog)this.lJ(-684355545,null);else if(Nb===OSF.AgaveHostAction.InsertAgave)za={},bb&&(za[uc.a.Gkb]=bb,za[ua.a.Hj]=a.qob(bb),this.lJ(-741808261,za));else if(Nb===OSF.AgaveHostAction.InsertDevManifest)za={},bb&&(za[uc.a.Gkb]=bb,za[ua.a.Hj]=a.qob(bb),this.lJ(-741808261,za));else if(Nb===OSF.AgaveHostAction.InsertDevManifestError)za=Object(cc.a)(Object,bb),Nb={},za=(Nb.ak1=this.fm.getDevManifestInvalidUrlErrorString(za.manifestUrl),Nb),this.lJ(-2025863019,za);
else if(Nb===OSF.AgaveHostAction.NotifyHostError)za={},za=(za.ak1=this.fm.getManifestInvaildErrorString(),za),this.lJ(-2025863019,za);else if(Nb===OSF.AgaveHostAction.RefreshAddinCommands)Db.EwaSettings.ka(53)&&this.lJ(Le.a.refreshAddinCommands,null);else if(Nb===OSF.AgaveHostAction.CtrlF6Exit||Nb===OSF.AgaveHostAction.CtrlF6ExitShift){if(Ub=this.$.ea.Ba(15)){(za=this.Pm(za).Dfa)&&za.ltc();Ha.a.uf&&document.activeElement.blur();var kc={keyCode:117,type:"keydown",ctrlKey:!0};kc.shiftKey=Nb===OSF.AgaveHostAction.CtrlF6ExitShift;
kc.srcElement=Object(Zb.a)(237,za)?za.XDa:jc.g(this.$).Ib;za=new Sys.UI.DomEvent(kc);Ub.SU(za)}}else if(Nb===OSF.AgaveHostAction.PageIsReady){if((za=this.Pm(za).Dfa)&&za.lWa===OSF.OsfControlTarget.TaskPane&&(za=this.$.ea.Ba(183))&&this.rf)for(Nb=Nc.a.Jd(this.$),Ub=Ol(this.rf),kc=Ub.next();!kc.done;kc=Ub.next())a.TJa(kc.value.$S)&&(Nb?za.Le(!0,!1):za.setFocusOnToolbarFirstElement())}else if(Nb===OSF.AgaveHostAction.TabExit){Nb=this.Pm(za);var ad=Nb.Dfa;if(ad)if(ad.lWa===OSF.OsfControlTarget.InContent)ad.p$e();
else{if(ad.lWa===OSF.OsfControlTarget.TaskPane)if(Nc.a.Jd(this.$))Ha.a.uf&&document.activeElement.blur(),P.UISurfaces.Nk().then(function(Ke){var nf=Object(Zb.a)(237,ad)?ad:null;nf?nf.isResizable?Ke.focusResizeHandle():Ke.focusTabbedTaskPaneArea():Ke.focusTabbedTaskPaneArea();return null});else if(za=this.$.ea.Ba(183))Ha.a.uf&&document.activeElement.blur(),(Nb=document.getElementById(this.$.Jb+wb.a.ghc))&&rc.DOMElementExtensions.isVisible(Nb)?rc.DOMElementExtensions.setFocus(Nb):za.setFocusOnToolbarFirstElement()}else Nb&&
4===Nb.osfControlType&&this.fm.notifyAgave(za,OSF.AgaveHostAction.TabIn)}else if(Nb===OSF.AgaveHostAction.TabExitShift)(Nb=this.Pm(za),Ub=Nb.Dfa)?Ub.lWa===OSF.OsfControlTarget.InContent?Ub.q$e():Ub.lWa===OSF.OsfControlTarget.TaskPane&&(za=Object(Zb.a)(237,Ub)?Ub:null)&&(Ha.a.uf&&document.activeElement.blur(),za.dOf()):Nb&&4===Nb.osfControlType&&this.fm.notifyAgave(za,OSF.AgaveHostAction.TabIn);else if(Nb===OSF.AgaveHostAction.EscExit||Nb===OSF.AgaveHostAction.ExitNoFocusable||Nb===OSF.AgaveHostAction.ExitNoFocusableShift)if(Ub=
this.Pm(za).Dfa)Ub.ltc();else{if(Nb===OSF.AgaveHostAction.EscExit){Nb=null;Ub=Ol(V.vLh());for(kc=Ub.next();!kc.done;kc=Ub.next())if(kc=kc.value,kc.value.Ie===za){kc.value.dialog.hide();Nb=kc.key;break}Nb&&(za=this.Pm(Nb))&&4!==za.osfControlType&&this.sh.notifyAgave(Nb,OSF.AgaveHostAction.TabIn)}}else if(Nb===OSF.AgaveHostAction.InstallCustomFunctions)if(Db.EwaSettings.ka(121)){Fc.a(this.$).aMe(function(){return!1});var Qd=this;yd.TaskExtensions.Aa(gc.GetServiceTaskFactory.Va(this.$.ea,278,279,1,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),
function(Ke){Ke=Ke.result;Qd.$.ea.Ba(278)||Qd.$.ea.Ia(278,Ke);var nf=bb.osfControl.getStoreType();Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Ke.Ifd(bb.osfControl.getSolutionId(),nf,a.EPe(bb.osfControl),bb).Yba():Ke.Ifd(bb.osfControl.getMarketplaceID(),nf,a.EPe(bb.osfControl),bb).Yba()},this.la,3)}else pb.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Nb===
OSF.AgaveHostAction.UninstallCustomFunctions)if(Db.EwaSettings.ka(121)){Fc.a(this.$).aMe(function(){return!1});var We=this;yd.TaskExtensions.Aa(gc.GetServiceTaskFactory.Va(this.$.ea,278,279,1,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),function(Ke){Ke=Ke.result;We.$.ea.Ba(278)||We.$.ea.Ia(278,Ke);Ke.M0f(bb.solutionId,bb.storeType).Yba()},this.la,3)}else pb.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");
else Nb===OSF.AgaveHostAction.SendTelemetryEvent?d(bb):Nb===OSF.AgaveHostAction.SendCustomerContent?e(bb):Nb===OSF.AgaveHostAction.LaunchExtensionComponent?xb.a.instance.q$h(bb):Nb===OSF.AgaveHostAction.RefreshRibbonGallery?(za=this.$.ea.Ba(352))&&za.A9b(bb):Nb===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.LSi(bb.assetId),Nc.a.Jd(this.$)||(za=this.$.ea.Ba(183))&&za.No()):Nb===OSF.AgaveHostAction.GetOriginalControlId&&(za=new ha.a(this.$.Jb,bb.ownerAssetId,new ic.a,!0),bb.originalControlId=za?
za.H_c(bb.controlId):bb.controlId)};a.prototype.hf=function(za,Nb,bb){var Ub={};Ub[ua.a.Hj]=za;Ub[ua.a.q2]=Nb;this.lJ(451041795,Ub,void 0===bb?!0:bb)};a.prototype.iu=function(za){var Nb={};Nb[ua.a.q2]=za;this.lJ(1237877382,Nb)};a.prototype.lJ=function(za,Nb,bb){var Ub=this;bb=void 0===bb?!0:bb;var kc=new Lb.a(za,0,this.$.dd,0,null),ad=Nb?Nb[ua.a.q2]:null;this.hZa&&jc.g(this.$).isEditing&&N.oNg(za,Nb)?this.hZa.F0g(za,Nb):(za=this.$.Ka.Ub(kc,Nb),bb&&yd.TaskExtensions.Aa(za,function(Qd){bd.a(Qd)?Ub.hf($a.a.internalError,
ad,!1):Qd.result||(jc.g(Ub.$).isEditing?Ub.hf($a.a.J2a,ad,!1):Ub.hf($a.a.internalError,ad,!1))},this.la,8))};a.prototype.JPg=function(za){var Nb=this;return!!this.sha(function(bb){return a.getSolutionId(bb.Wk,Nb.$)===a.getSolutionId(za,Nb.$)&&bb.Wk.PrimaryMarketplace.MarketplaceType===za.PrimaryMarketplace.MarketplaceType&&bb.Wk.PrimaryMarketplace.MarketplaceRef===za.PrimaryMarketplace.MarketplaceRef&&bb.Wk.PrimaryMarketplace.SolutionVersion===za.PrimaryMarketplace.SolutionVersion})};a.prototype.Pm=
function(za){return this.sha(function(Nb){return Nb.controlId.startsWith(za)})};a.prototype.Nmh=function(za){return this.sha(function(Nb){return Nb.YFa===za})};a.prototype.yKe=function(za){return this.sha(function(Nb){return Nb.$S===za&&!Bb.a.ma(Nb.YFa)})};a.prototype.PKe=function(za,Nb,bb,Ub){return this.sha(function(kc){return kc.$S===za&&kc.Wk.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Nb.toLowerCase()&&kc.Wk.PrimaryMarketplace.MarketplaceType.toLowerCase()===bb.toLowerCase()&&!!kc.Wk.SharedRuntime&&
!!kc.Wk.SharedRuntime.Resid&&!!Ub&&!!Ub.Resid&&kc.Wk.SharedRuntime.Resid.toLowerCase()===Ub.Resid.toLowerCase()})};a.prototype.kzg=function(za,Nb){if(za=this.Pm(za))za.ja(Nb),za.showHide(!0)};a.prototype.Agj=function(za){(za=this.Pm(za))&&za.showHide(!1)};a.prototype.IYa=function(za){if(1!==za.WebExtensionType||this.$.zd&8388608&&za.TaskpaneVisible||this.$.zd&8388608&&!za.TaskpaneVisible&&Oc.HelperMethods.qy(za)){var Nb=null;Oc.HelperMethods.qy(za)&&(Nb=a.dta(za,this.$),za.TaskpaneWidth||(za.TaskpaneWidth=
this.B1b));var bb=(new S(this,this.vh,za)).Wed();pb.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(za.PrimaryMarketplace.MarketplaceType,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.SolutionId),za.PrimaryMarketplace.MarketplaceType,Oc.HelperMethods.qy(za));Nb&&(bb.YFa=Nb);Array.add(this.rf,bb);this.sva=null;this.Q2a(za.InstanceId)||(za=String.format("{0}|{1}|{2}|{3}|{4}",za.PrimaryMarketplace.SolutionId,
za.PrimaryMarketplace.SolutionVersion,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.MarketplaceType,za.WebExtensionType),this.raiseEvent("ci",za))}};a.prototype.kij=function(za,Nb){function bb(){Ub.WNa(ad.controlId);Ub.sh.purgeOsfControl(ad.controlId,!1);Nb()}var Ub=this;za.TaskpaneWidth=this.B1b;za.TaskpaneVisible=!0;var kc={};Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(kc.SolutionId=za.PrimaryMarketplace.SolutionId,kc.TargetType=
za.WebExtensionType,kc.Version=za.PrimaryMarketplace.SolutionVersion,kc.StoreType=za.PrimaryMarketplace.MarketplaceType,kc.StoreId=za.PrimaryMarketplace.MarketplaceRef,kc.AssetId=za.PrimaryMarketplace.SolutionId,kc.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,kc.Width=za.TaskpaneWidth,kc.Id=za.PrimaryMarketplace.SolutionId,kc.AppVersion=za.PrimaryMarketplace.SolutionVersion,kc.CurrentStoreType=za.PrimaryMarketplace.MarketplaceType):(kc.Id=za.PrimaryMarketplace.SolutionId,kc.TargetType=za.WebExtensionType,
kc.AppVersion=za.PrimaryMarketplace.SolutionVersion,kc.CurrentStoreType=za.PrimaryMarketplace.MarketplaceType,kc.StoreId=za.PrimaryMarketplace.MarketplaceRef,kc.AssetId=za.PrimaryMarketplace.SolutionId,kc.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,kc.Width=za.TaskpaneWidth);var ad=new S(this,this.vh,za,!0);ad.Wed();Array.add(this.rf,ad);var Qd=null;Qd=ng.a.instance.AB(function(){ad.wt&&(zb.a.Fa(Qd),Qd=null,Ub.sh.insertBlankControlWithErrorUX(Ub.P7a(ad,kc),bb))},100,Oe.a.y_g)};a.prototype.oTg=
function(za){var Nb=this;if(za&&za.length){var bb=[];za.forEach(function(Ub){if(Ub.ContainsCustomFunctions){var kc=a.dta(Ub,Nb.$);Nb.uwd.contains(kc)||(Nb.uwd.add(kc),Array.add(Nb.hwf,Ub));Nb.JPg(Ub)||Array.add(bb,Ub)}});bb.length&&this.Hue(bb)}};a.prototype.xwe=function(za,Nb){this.Pm(za.InstanceId)||(Nb=Nb(),za=(new S(this,this.vh,za)).i1e(Nb),Array.add(this.rf,za),this.sva=null)};a.prototype.Ufj=function(za){a.bZa.qb(za)&&a.bZa.oa(za).initializeAndShowWithTitle()};a.prototype.nRh=function(za){a.bZa.qb(za)&&
a.bZa.oa(za).hide()};a.prototype.uEh=function(za){var Nb=this,bb=null,Ub,kc=null;var ad=a.zbd(za,!0);if(!ad)return pb.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),fe.Task.Ra(null);(Ub=this.fm.getOsfControl(a.getSolutionId(ad,this.$)))&&(bb=Ub.getManifest())&&(kc=bb.getSharedRuntimeForCustomFunctions("Workbook"));if(bb=kc&&1===kc.LifeTime?this.PKe(ad.PrimaryMarketplace.SolutionId,ad.PrimaryMarketplace.MarketplaceRef,ad.PrimaryMarketplace.MarketplaceType,
kc):this.Nmh(za))return fe.Task.Ra(bb.controlId);var Qd=new Aa.a;Oc.HelperMethods.Gdc(kc)&&(ad.SharedRuntime=kc);za=Ub?Ub.getNotificationParams():[];if(!za.length)return this.ive(ad);this.DSf(za,function(){yd.TaskExtensions.Aa(Qd.task,function(){Nb.ive(ad)},Nb.la,3)},function(){});return Qd.task};a.prototype.qth=function(za){za=a.zbd(za,!1);if(!za)return pb.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var Nb=null,bb=this.fm.getOsfControl(a.getSolutionId(za,
this.$));bb&&(bb=bb.getManifest())&&(Nb=bb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Oc.HelperMethods.Gdc(Nb)&&(za=this.PKe(za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.MarketplaceType,Nb))?za.controlId:null};a.prototype.LRg=function(za,Nb){var bb=this,Ub=a.zbd(za,!1);if(Ub){var kc=null,ad=this.fm.getOsfControl(a.getSolutionId(Ub,this.$));ad&&(ad=ad.getManifest())&&(kc=ad.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Oc.HelperMethods.Gdc(kc)){Ub.SharedRuntime=
kc;var Qd=Ub.PrimaryMarketplace.SolutionId;ad=Ub.PrimaryMarketplace.SolutionVersion;var We=OSF.OsfManifestManager.getCachedManifest(Qd,ad);if(We)if(this.AVb.qb(za))kc=this.AVb.oa(za),yd.TaskExtensions.Aa(kc,function(Pe){(Pe=Pe.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Pe,Nb,Object(ab.a)(bb.vh,bb.vh.PFb,"sendActionToAddin"))},this.la,3);else{var Ke={};Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Ke.solutionId=
Qd,Ke.version=ad,Ke.storeType=Ub.PrimaryMarketplace.MarketplaceType,Ke.storeId=Ub.PrimaryMarketplace.MarketplaceRef,Ke.assetId=Qd,Ke.assetStoreId=null):(Ke.appVersion=ad,Ke.assetId=Qd,Ke.storeType=Ub.PrimaryMarketplace.MarketplaceType,Ke.storeId=Ub.PrimaryMarketplace.MarketplaceRef);Ke.targetType=OSF.OsfControlTarget.TaskPane;var nf=new Aa.a;Ub=yd.TaskExtensions.dm();Ub=new Jb.a(this.$,this,Ke,Ub);kc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Qd,kc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(We,
kc,ad);Ub.createUILessSandbox(Ke,We,function(Pe,hf){Pe&&!hf?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Pe,Nb,Object(ab.a)(bb.vh,bb.vh.PFb,"sendActionToAddin")),nf.setResult(Pe)):nf.setResult(null);bb.AVb.remove(za)});this.AVb.ia(za,nf.task)}}}else pb.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.Cpe=function(za){(za=this.yKe(za))&&(za.Wk.SharedRuntime||this.ODb(za.controlId))};a.prototype.ODb=function(za){(za=
this.yKe(za))&&this.WNa(za.controlId)};a.prototype.B4g=function(za,Nb){if(!this.rf||!za||!Nb)return!1;if(za.toLowerCase()===Nb.toLowerCase())return!0;for(var bb=null,Ub=null,kc=0,ad=this.rf.length;kc<ad;kc++){var Qd=this.rf[kc];if(Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(Qd.ownerAddinSolutionId&&(Qd.controlId===za&&(bb=Qd.ownerAddinSolutionId.toLowerCase()),Qd.controlId===Nb&&(Ub=Qd.ownerAddinSolutionId.toLowerCase()),bb&&Ub))break}else if(Qd.ownerAddinAssetId&&
(Qd.controlId===za&&(bb=Qd.ownerAddinAssetId.toLowerCase()),Qd.controlId===Nb&&(Ub=Qd.ownerAddinAssetId.toLowerCase()),bb&&Ub))break}return bb&&bb===Ub?!0:!1};a.prototype.xpg=function(za){this.Pm(za.InstanceId)||(za=new S(this,this.vh,za),Array.add(this.rf,za),this.sva=null)};a.prototype.IBd=function(za){if(this.rf&&0<=za&&za<this.rf.length){var Nb=this.rf[za],bb=Nb.wt;Array.removeAt(this.rf,za);this.Mlf(Nb);rc.DOMElementExtensions.ig(bb)}};a.prototype.WNa=function(za){if(this.rf)for(var Nb=0,bb=
this.rf.length;Nb<bb;Nb++)if(this.rf[Nb].controlId===za){this.IBd(Nb);break}};a.prototype.LSi=function(za){if(this.rf){"WA200002680"===za&&this.$.ea.Ba(271).Xvg();za=za.toLowerCase();for(var Nb=0,bb=this.rf.length;Nb<bb;Nb++)if(Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(za===this.rf[Nb].ownerAddinSolutionId.toLowerCase()){this.IBd(Nb);break}}else if(za===this.rf[Nb].ownerAddinAssetId.toLowerCase()){this.IBd(Nb);break}}};a.prototype.Rzg=
function(za){za.Zz&&(this.Pm(za.floatingObject.Wk.InstanceId)||(this.Tac(za.floatingObject.Wk.InstanceId)||Array.add(this.Ljc,za.floatingObject.Wk.InstanceId),this.IYa(za.floatingObject.Wk)),this.fa.isNamedObjectViewMode&&this.kzg(za.floatingObject.Wk.InstanceId,za.Ld))};a.prototype.W2=function(za){if(this.rf)for(var Nb=0,bb=this.rf.length;Nb<bb;Nb++)if(1===this.rf[Nb].controlType&&Bb.a.equals(this.rf[Nb].$S,za,!0))return this.rf[Nb].controlId;return null};a.prototype.mmh=function(za){var Nb=[];if(this.rf)for(var bb=
0,Ub=this.rf.length;bb<Ub;bb++)Bb.a.equals(this.rf[bb].$S,za,!0)&&Nb.push(this.rf[bb].controlId);return Nb};a.prototype.QKe=function(za,Nb){if(!Nb||Bb.a.ma(za))return null;if(this.rf)for(var bb=0,Ub=this.rf.length;bb<Ub;bb++)if(1===this.rf[bb].controlType&&Bb.a.equals(this.rf[bb].$S,za,!0)&&this.rf[bb].Wk.SharedRuntime&&Bb.a.equals(this.rf[bb].Wk.SharedRuntime.Resid,Nb.Resid,!0))return this.rf[bb].controlId;return null};a.prototype.Hha=function(za,Nb){Nb=void 0===Nb?null:Nb;return za?Nb?String.format("{0}.{1}",
za,Nb):za:""};a.prototype.pVc=function(za,Nb,bb){if(this.sva===za)return!0;this.sva=za;var Ub=null,kc=!1;if(Bb.a.ma(Ub)&&this.rf)for(var ad=0,Qd=this.rf.length;ad<Qd;ad++)if(1===this.rf[ad].controlType&&Bb.a.equals(this.rf[ad].$S,za,!0)){var We=!1,Ke=!1;Nb?(We=!0,Ke=!!this.rf[ad].Wk.SharedRuntime&&Bb.a.equals(this.rf[ad].Wk.SharedRuntime.Resid,Nb.Resid,!0)):bb&&(We=!0,Ke=Bb.a.equals(this.rf[ad].Wk.SharedRuntimeId,bb,!0));if(!We||Ke){Ke&&this.rf[ad].Hf(!0);Ub=this.rf[ad].controlId;kc=!0;this.sva=null;
break}}Bb.a.ma(Ub)||this.raiseEvent("ca",Ub);return kc};a.prototype.setAppRuntimeState=function(za,Nb){if(Bb.a.ma(za))throw pb.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Bd.a.instance.da(2144));var bb=this.Pm(za);if(bb&&Oc.HelperMethods.qy(bb.Wk))bb.Hf(Nb),Nb&&(this.raiseEvent("ca",za),bb.wt&&bb.wt.firstChild&&(za=bb.wt.firstChild.title)&&0<za.length&&this.IWb.N4i(za));else throw pb.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(Bd.a.instance.da(2143));};a.prototype.getAppRuntimeState=function(za){if(Bb.a.ma(za))throw pb.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Bd.a.instance.da(2144));if((za=this.Pm(za))&&Oc.HelperMethods.qy(za.Wk))za=za.Wk.TaskpaneVisible;else throw pb.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Bd.a.instance.da(2143));return za};a.prototype.F_a=function(za,Nb){return(za=
this.Pm(za))?za.F_a(Nb):null};a.prototype.Q2a=function(za){return this.Hpe(this.Ljc,za)};a.prototype.Tac=function(za){return this.Hpe(this.hxe,za)};a.prototype.Ede=function(za){Array.add(this.hxe,za)};a.prototype.HT=function(za){return(za=this.Pm(za))?za.Wk:null};a.prototype.Frd=function(za){this.raiseEvent("ekros",za,this)};a.prototype.Yud=function(za){if(za){var Nb=this.Pm(za.InstanceId);Nb&&(za.SharedRuntime||za.SharedRuntimeId||(this.WNa(Nb.controlId),this.sh.purgeOsfControl(Nb.controlId,!1)),
Nb={},Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Nb.SolutionId=za.PrimaryMarketplace.SolutionId,Nb.TargetType=za.WebExtensionType,Nb.Version=za.PrimaryMarketplace.SolutionVersion,Nb.StoreType=za.PrimaryMarketplace.MarketplaceType,Nb.StoreId=za.PrimaryMarketplace.MarketplaceRef,Nb.AssetId=za.PrimaryMarketplace.SolutionId,Nb.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,Nb.Width=za.TaskpaneWidth,Nb.SharedRuntimeId=za.SharedRuntimeId,
Nb.Id=za.PrimaryMarketplace.SolutionId,Nb.AppVersion=za.PrimaryMarketplace.SolutionVersion,Nb.CurrentStoreType=za.PrimaryMarketplace.MarketplaceType):(Nb.Id=za.PrimaryMarketplace.SolutionId,Nb.TargetType=za.WebExtensionType,Nb.AppVersion=za.PrimaryMarketplace.SolutionVersion,Nb.CurrentStoreType=za.PrimaryMarketplace.MarketplaceType,Nb.StoreId=za.PrimaryMarketplace.MarketplaceRef,Nb.AssetId=za.PrimaryMarketplace.SolutionId,Nb.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,Nb.Width=za.TaskpaneWidth,
Nb.SharedRuntimeId=za.SharedRuntimeId),this.l_f(Nb))}};a.prototype.$ga=function(){this.vh.$ga()};a.prototype.AL=function(za,Nb,bb){this.vh.AL(za,Nb,bb)};a.prototype.W4i=function(za,Nb){var bb=Array(2);bb[0]=Nb;bb[1]=null;this.vh.hnh(za,JSON.stringify(bb))};a.prototype.aLe=function(za,Nb){Nb=a.$Wg(Nb);za=this.HT(za);this.vh.u5b(za.InstanceId,2202,Id.a.HV,Nb)};a.prototype.a6c=function(za){for(var Nb=0,bb=this.rf.length;Nb<bb;Nb++)this.aLe(this.rf[Nb].controlId,za)};a.prototype.dnh=function(za,Nb){Nb=
a.qSg(Nb);this.vh.u5b(za,65539,"",Nb)};a.prototype.fnh=function(za,Nb,bb){this.vh.u5b(za,1,Nb,bb)};a.prototype.cnh=function(za,Nb){this.vh.gnh(za,Nb)};a.prototype.IRg=function(za,Nb){return[[2,1E3,"",JSON.stringify([za,Nb]),0,!1]]};a.prototype.o_h=function(){return!!this.lla&&this.lla.CYe()};a.prototype.VKg=function(){this.lla&&this.lla.clear()};a.prototype.enh=function(){if(this.lla&&this.lla.CYe()){var za=this.lla.rth();za=Ol(za);for(var Nb=za.next();!Nb.done;Nb=za.next()){Nb=this.mmh(Nb.value);
Nb=Ol(Nb);for(var bb=Nb.next();!bb.done;bb=Nb.next())this.vh.u5b(bb.value,65540,"","{}")}}};a.prototype.RPi=function(za){this.lla.add(za)};a.prototype.Muj=function(za){this.lla.remove(za)};a.prototype.sha=function(za){if(!this.rf)return null;for(var Nb=Ol(this.rf),bb=Nb.next();!bb.done;bb=Nb.next())if(bb=bb.value,za(bb))return bb;return null};a.prototype.ive=function(za){var Nb=this,bb=new Aa.a,Ub=a.dta(za,this.$);if(Oc.HelperMethods.qy(za))pb.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),
this.ewf(za,function(ad){ad?(za.InstanceId=ad.InstanceId,za.WebExtensionOsfControlType=3,za.TaskpaneVisible=!1,Nb.IYa(za),bb.setResult(za.InstanceId)):(pb.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetAssetId(za.PrimaryMarketplace.MarketplaceType,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.SolutionId)),bb.setException(Error.create("Null insert data")))});else{a.bZa.ia(za.InstanceId,new lb.a);var kc=a.bZa.oa(za.InstanceId).kGa;
this.nTg(za,kc,Ub);this.ewf(za,null);bb.setResult(za.InstanceId)}return bb.task};a.prototype.nTg=function(za,Nb,bb){this.Pm(za.InstanceId)||(za=new S(this,this.vh,za),za.YFa=bb,za.i1e(Nb),Array.add(this.rf,za),this.sva=null)};a.prototype.ewf=function(za,Nb){var bb=a.dta(za,this.$);if(!this.uwd.contains(bb))this.$Bb.push(za),1<=this.$Bb.length&&this.fwf(za,Nb);else if(Nb){za=Ol(this.hwf);for(var Ub=za.next();!Ub.done;Ub=za.next())if(Ub=Ub.value,a.dta(Ub,this.$)===bb){Nb(Ub,0);break}}};a.prototype.fwf=
function(za,Nb){function bb(Pe){if(!Pe||bf.a(Pe))Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?pb.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(Qd.StoreType,Qd.StoreId,Qd.SolutionId),pd.a.Uc(Pe.Errors)):pb.ULS.sendTraceTag(537170526,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(Qd.CurrentStoreType,Qd.StoreId,
Qd.Id),pd.a.Uc(Pe.Errors));kc.$Bb.shift();0<kc.$Bb.length&&kc.fwf(kc.$Bb[0],Nb)}function Ub(Pe){Pe=me.a.xg(Pe.data);pb.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",pd.a.Uc(Pe))}var kc=this,ad=null,Qd={};Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Qd.SolutionId=a.getSolutionId(za,this.$),Qd.TargetType=za.WebExtensionType,Qd.Version=za.PrimaryMarketplace.SolutionVersion,
Qd.StoreType=za.PrimaryMarketplace.MarketplaceType,Qd.StoreId=za.PrimaryMarketplace.MarketplaceRef,Qd.AssetId=za.PrimaryMarketplace.SolutionId,Qd.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,Qd.Width=za.TaskpaneWidth,Qd.ContainsCustomFunctions=!0,Qd.Id=a.getSolutionId(za,this.$),Qd.AppVersion=za.PrimaryMarketplace.SolutionVersion,Qd.CurrentStoreType=za.PrimaryMarketplace.MarketplaceType):(Qd.Id=a.getSolutionId(za,this.$),Qd.TargetType=za.WebExtensionType,Qd.AppVersion=za.PrimaryMarketplace.SolutionVersion,
Qd.CurrentStoreType=za.PrimaryMarketplace.MarketplaceType,Qd.StoreId=za.PrimaryMarketplace.MarketplaceRef,Qd.AssetId=za.PrimaryMarketplace.SolutionId,Qd.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,Qd.Width=za.TaskpaneWidth,Qd.ContainsCustomFunctions=!0);Oc.HelperMethods.qy(za)&&(Qd.SharedRuntimeId=za.SharedRuntime.Resid);var We=this.$.ra.ua;za=this.$.ra.ua.Wb();var Ke=We.Na(9,za);Ke.sharedInfo=Qd;if(Nb){var nf=function(Pe){var hf=Pe.Result;(ad=hf?hf.AgaveData:null)||Nb(null,Pe.Errors?Pe.Errors[0].ErrorCause:
5001);Nb(ad,0)};za=function(Pe,hf,Vf){return Fe.i(We,"InsertAgaveTaskpane",Ke,Qe.b(Pe,bb,nf),Qe.a(hf,Ub),Vf,null,0)}}else za=function(Pe,hf,Vf){return Fe.i(We,"InsertAgaveTaskpane",Ke,Qe.b(Pe,bb),Qe.a(hf,Ub),Vf,null,0)};Db.EwaSettings.pc()?Ve.a(this.$.userOperationManager,za,function(Pe){return new Pf.a(519,0,Pe,64)},null):Ve.a(this.$.userOperationManager,za,function(Pe){return new se.a(519,0,Pe)},null)};a.prototype.ddj=function(){return this.$.Qf.get(35)};a.prototype.MBd=function(za){(za=this.Pm(za))&&
za.Vba&&za.tEf()};a.prototype.Fli=function(za){var Nb=this.sha(function(bb){return a.TJa(bb.$S)});Nb&&(Nb=this.sh.getOsfControl(Nb.controlId))&&Nb.notifyAgave(OSF.AgaveHostAction.SendMessage,za)};a.prototype.U_h=function(){return!!this.sha(function(za){return 1===za.controlType&&a.TJa(za.$S)})};a.prototype.T_h=function(){var za=this.sha(function(Nb){return a.TJa(Nb.$S)});return za?za.wt?rc.DOMElementExtensions.isVisible(za.wt):!1:!1};a.prototype.M7i=function(){var za=this.sha(function(Nb){return a.TJa(Nb.$S)});
za&&(za.Hf(!0),this.raiseEvent("ca",za.controlId))};a.prototype.initialize=function(){var za=b(1328).DdaEventDispatch,Nb=void 0===this.$||null===this.$||Db.EwaSettings.ka(262);void 0!==this.$&&null!==this.$||pb.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Nb&&pb.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(l.mEa(this.$),this.fa=this.$.fa,this.vh=new za(this.$),this.$.Jk(Object(ab.a)(this,
this.jd,"onWorkbookOpened")),this.fa.Yj(Object(ab.a)(this,this.Vc,"onSessionIdChanged")),this.fa.nO(Object(ab.a)(this,this.gq,"onLoadOnDemandOccurred")),this.fa.Vs(Object(ab.a)(this,this.Gf,"onWorkbookMetadataChanged")),this.$.userOperationManager.jB(Object(ab.a)(this,this.rQ,"onQueueItemChanged")),this.obf(),this.Mvi(),this.CVh(),this.$.ea.Ia(35,this),this.BQc.ja(this),Nb&&pb.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.z8d=new Id.a,Nb&&pb.ULS.sendTraceTag(537170521,
0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.C8d=new x(this.$,this.Ti,this.vh),this.Iig=new B(this.$,this.Ti,this.vh),this.A8d=new E(this.$,this.Ti,this.vh),this.y8d=new J(this.$,this.Ti,this.vh),this.x8d=new A(this.$,this.Ti,this.vh),this.B8d=new y(this.$,this.Ti,this.vh),this.D8d=new t(this.$,this.Ti,this.vh),this.E8d=new w(this.$,this.Ti,this.vh),this.$.Z$&&(this.F8d=new v(this.$,this.Ti,this.vh)),Db.EwaSettings.ka(191)&&(this.hZa=new N(this,jc.g(this.$))),Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.w8d=new H),this.initialized=!0,pb.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.Zmh=function(za){if(!this.eAa)return null;for(var Nb=0,bb=this.eAa.length;Nb<bb;Nb++)if(za.startsWith(this.eAa[Nb].WebExtensionId))return this.eAa[Nb];return null};a.prototype.obf=function(){var za=this.fa;if(za.lc&&!this.bLb){if(za.workbookContext){if(this.qNc=this.$.fa.$g.get(22),za.workbookContext.WebExtensions&&za.workbookContext.WebExtensions.length){za=za.workbookContext.WebExtensions;
for(var Nb=!1,bb={},Ub=za.length-1;0<=Ub;bb={vLb:bb.vLb},Ub--){if(!this.fa.isNamedObjectViewMode){Array.add(this.Ljc,za[Ub].InstanceId);if(1!==za[Ub].WebExtensionType){Array.removeAt(za,Ub);continue}if(Oc.HelperMethods.qy(za[Ub])&&za[Ub].SharedRuntime.State)1===za[Ub].SharedRuntime.State?za[Ub].TaskpaneVisible=!1:2===za[Ub].SharedRuntime.State?za[Ub].TaskpaneVisible=!0:pb.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!za[Ub].ContainsCustomFunctions&&!za[Ub].TaskpaneVisible&&
!Od.a(za[Ub])){Array.removeAt(za,Ub);continue}}var kc=OSF.OsfControl.isFirstPartyStoreString(za[Ub].PrimaryMarketplace.MarketplaceType);Db.EwaSettings.ka(187)&&!kc&&(Array.removeAt(za,Ub),Nb||(Nb=!0,bb.vLb=gc.GetServiceTaskFactory.Va(this.$.ea,5,4,3,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager"),yd.TaskExtensions.Aa(bb.vLb,function(ad){return function(){ad.vLb.result.eg(35,null)}}(bb),this.la,3)));Db.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&
za[Ub].PrimaryMarketplace&&a.TJa(za[Ub].PrimaryMarketplace.SolutionId)&&(pb.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(za,Ub))}this.Hue(za)}}else this.qNc=!1;this.bLb=!0}};a.prototype.gXe=function(za){var Nb=jc.g(this.$),bb=Nb.ga.Pa.kc;if(bb&&za){za=!1;if(this.rf)for(var Ub=Ol(this.rf),kc=Ub.next();!kc.done;kc=Ub.next())if(kc=kc.value,a.TJa(kc.$S)||a.L2h(kc.$S)){za=!0;break}za||Nb.ga.Pa.VF(bb)}};a.prototype.Mvi=function(){this.sh&&
this.fa.isNamedObjectViewMode&&this.$.qa&&ld.p(this.$.qa)&&(this.$.ea.Ba(34).MP?this.$.ea.Ba(34).kfd():this.$.ea.Ba(34).uq(Object(ab.a)(this,this.CBi,"onWebExtensionContentReady")))};a.prototype.CBi=function(){this.$.qa&&ld.p(this.$.qa)&&this.$.ea.Ba(34).kfd()};a.prototype.Hue=function(za){var Nb=this,bb=null;bb=function(ad){function Qd(){Nb.XMa.shift();0<Nb.XMa.length&&bb(Nb.XMa[0])}var We=ad.WebExtensionData,Ke=ad.IsTaskPane,nf=ad.RecordHandler;if(Nb.W2(We.PrimaryMarketplace.SolutionId))Qd();else{Ke&&
(We.WebExtensionOsfControlType=1);var Pe=Od.a(We);if(!Ke||We.TaskpaneVisible||Pe||We.SharedRuntime&&We.SharedRuntime.State||We.ContainsCustomFunctions){var hf=new S(Nb,Nb.vh,We,!Ke);pb.ULS.sendTraceTag(537170517,0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(We.PrimaryMarketplace.MarketplaceType,We.PrimaryMarketplace.MarketplaceRef,We.PrimaryMarketplace.SolutionId),We.PrimaryMarketplace.MarketplaceType,Oc.HelperMethods.qy(We));
hf.Wed();Oc.HelperMethods.qy(We)&&(hf.YFa=a.dta(We,Nb.$),We.TaskpaneWidth=Nb.B1b);Pe&&(We.WebExtensionToolTip="");Ke&&We.TaskpaneVisible&&!Pe&&(We.TaskpaneWidth=Nb.B1b);Array.add(Nb.rf,hf);var Vf=Nb.sva=null;Vf=ng.a.instance.AB(function(){hf.wt&&(zb.a.Fa(Vf),Vf=null,nf&&nf(ad,hf),Qd())},100,Oe.a.x_g)}else Qd()}};for(var Ub={},kc=0;kc<za.length;Ub={d0:Ub.d0},kc++)if(!this.Pm(za[kc].InstanceId))if(1!==za[kc].WebExtensionType)this.IYa(za[kc]);else if(!Db.EwaSettings.ka(53))this.Cjb(za[kc],bb);else if(this.$.zd&
8388608||za[kc].TaskpaneVisible)Ub.d0={},Ub.d0.marketplaceId=za[kc].PrimaryMarketplace.SolutionId,Ub.d0.marketplaceVersion=za[kc].PrimaryMarketplace.SolutionVersion,Ub.d0.storeType=za[kc].PrimaryMarketplace.MarketplaceType,Ub.d0.storeId=za[kc].PrimaryMarketplace.MarketplaceRef,Ub.d0.targetData=za[kc],this.sh.isAddinCommandsAsync(Ub.d0,function(ad){return function(Qd,We,Ke){if(Qd){var nf=Ke.targetData;if(We){if(Db.EwaSettings.ka(87))if(ad.d0.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Qd=
ad.d0.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),We=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&ad.d0.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Qd||We)&&Oc.HelperMethods.qy(nf)&&Nb.Cjb(nf,bb);else if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))Nb.wOh(Ke,bb);else{var Pe=!1;Nb.Oyd(function(hf){if(!hf.errorCode){if(hf.value){hf=Ol(hf.value);
for(var Vf=hf.next();!Vf.done&&!Pe;Vf=hf.next())Pe=od.c(Vf.value[1])===od.c(nf.PrimaryMarketplace.SolutionId)}Pe?Oc.HelperMethods.qy(nf)&&Nb.Cjb(nf,bb):(hf={},Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(hf.SolutionId=Ke.marketplaceId,hf.TargetType=nf.WebExtensionType,hf.Version=Ke.marketplaceVersion,hf.StoreType=nf.PrimaryMarketplace.MarketplaceType,hf.StoreId=Ke.storeId,hf.AssetId=Ke.marketplaceId,hf.AssetStoreId=Ke.storeId,hf.Width=nf.TaskpaneWidth,
nf.TaskpaneVisible=!0,hf.Id=Ke.marketplaceId,hf.AppVersion=Ke.marketplaceVersion,hf.CurrentStoreType=nf.PrimaryMarketplace.MarketplaceType):(hf.Id=Ke.marketplaceId,hf.TargetType=nf.WebExtensionType,hf.AppVersion=Ke.marketplaceVersion,hf.CurrentStoreType=nf.PrimaryMarketplace.MarketplaceType,hf.StoreId=Ke.storeId,hf.AssetId=Ke.marketplaceId,hf.AssetStoreId=Ke.storeId,hf.Width=nf.TaskpaneWidth,nf.TaskpaneVisible=!0),Nb.oce(hf,nf,bb))}},!0)}}else Nb.Cjb(nf,bb)}else Qd=Ke.targetData,pb.ULS.sendTraceTag(542185164,
220,10,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetAssetId(Qd.PrimaryMarketplace.MarketplaceType,Qd.PrimaryMarketplace.MarketplaceRef,Qd.PrimaryMarketplace.SolutionId),Qd.PrimaryMarketplace.MarketplaceType)}}(Ub))};a.prototype.wOh=function(za,Nb){var bb=this,Ub=!1;this.Oyd(function(kc){var ad=za.targetData;if(!kc.errorCode){if(kc.value){kc=Ol(kc.value);for(var Qd=kc.next();!Qd.done&&!Ub;Qd=kc.next())Ub=od.c(Qd.value[1])===od.c(ad.PrimaryMarketplace.SolutionId)}Ub?
Oc.HelperMethods.qy(ad)&&bb.Cjb(ad,Nb):(kc={},Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(kc.SolutionId=za.marketplaceId,kc.TargetType=ad.WebExtensionType,kc.Version=za.marketplaceVersion,kc.StoreType=ad.PrimaryMarketplace.MarketplaceType,kc.StoreId=za.storeId,kc.AssetId=za.marketplaceId,kc.AssetStoreId=za.storeId,kc.Width=ad.TaskpaneWidth,kc.Id=za.marketplaceId,kc.AppVersion=za.marketplaceVersion,kc.CurrentStoreType=ad.PrimaryMarketplace.MarketplaceType):
(kc.Id=za.marketplaceId,kc.TargetType=ad.WebExtensionType,kc.AppVersion=za.marketplaceVersion,kc.CurrentStoreType=ad.PrimaryMarketplace.MarketplaceType,kc.StoreId=za.storeId,kc.AssetId=za.marketplaceId,kc.AssetStoreId=za.storeId,kc.Width=ad.TaskpaneWidth),ad.TaskpaneVisible=!0,bb.oce(kc,ad,Nb))}},!0)};a.prototype.Cjb=function(za,Nb){var bb={};bb.WebExtensionData=za;bb.IsTaskPane=!0;this.XMa.push(bb);1===this.XMa.length&&Nb(bb)};a.prototype.oce=function(za,Nb,bb){var Ub=this,kc={};kc.ActivationInfo=
za;kc.WebExtensionData=Nb;kc.IsTaskPane=!1;kc.RecordHandler=function(ad,Qd){var We=ad.ActivationInfo;Ub.sh.insertBlankControlWithErrorUX(Ub.P7a(Qd,We),function(){Ub.WNa(Qd.controlId);Ub.sh.purgeOsfControl(Qd.controlId,!1);Ub.l_f(We)})};this.XMa.push(kc);1===this.XMa.length&&bb(kc)};a.prototype.l_f=function(za){var Nb={};Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Nb.solutionId=za.SolutionId,Nb.version=za.Version,Nb.storeType=za.StoreType,
Nb.storeId=za.StoreId,Nb.assetId=za.AssetId,Nb.assetStoreId=za.AssetStoreId,Nb.targetType=za.TargetType,Nb.sharedRuntimeId=za.SharedRuntimeId,Nb.id=za.Id,Nb.currentStoreType=za.CurrentStoreType,Nb.appVersion=za.AppVersion):(Nb.id=za.Id,Nb.targetType=za.TargetType,Nb.currentStoreType=za.CurrentStoreType,Nb.assetId=za.AssetId,Nb.appVersion=za.AppVersion,Nb.storeId=za.StoreId,Nb.assetStoreId=za.AssetStoreId,Nb.sharedRuntimeId=za.SharedRuntimeId);za=new Ia.a;za.add(Nb);Nb={};Nb[uc.a.cWa]=za;Nb[uc.a.oO]=
3;za=new Lb.a(Le.a.Bxb,0,this.$.dd,0,null);this.$.Ka.Ub(za,Nb)};a.prototype.P7a=function(za,Nb){var bb={};Ka.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(bb.div=za.wt,bb.id=za.controlId,bb.solutionId=Nb.SolutionId,bb.version=Nb.Version,bb.storeId=Nb.StoreId,bb.storeType=Nb.StoreType,bb.osfControlType=OSF.OsfControlTarget.TaskPane,bb.marketplaceID=Nb.Id,bb.marketplaceVersion=Nb.AppVersion,bb.store=Nb.StoreId):(bb.div=za.wt,bb.id=
za.controlId,bb.marketplaceID=Nb.Id,bb.marketplaceVersion=Nb.AppVersion,bb.store=Nb.StoreId,bb.storeType=Nb.CurrentStoreType,bb.osfControlType=OSF.OsfControlTarget.TaskPane);return bb};a.prototype.jd=function(){this.obf()};a.prototype.rQ=function(za,Nb){1===Nb.vC&&(za=Nb.Jh)&&(za=new n(ac.toTimestamp(za.enqueueUtcTime),ac.toTimestamp(za.processUtcTime),ac.toTimestamp(za.dequeueUtcTime),ac.getElapsedMilliseconds(za.enqueueUtcTime,za.processUtcTime),ac.getElapsedMilliseconds(za.processUtcTime,za.dequeueUtcTime),
za.operationCount,za.operation&&za.operation.hd&&za.operation.hd.ServerCorrelationId?za.operation.hd.ServerCorrelationId:null,za.operation?Enum.toString(Zf.a,za.operation.operationName):null,Ob.a.vJ(ac.getElapsedMilliseconds(za.enqueueUtcTime,Zc.a.Qa.Gb))),za=Sys.Serialization.JavaScriptSerializer.serialize(za),pb.ULS.sendTraceTag(50872916,0,50,za))};a.prototype.Vc=function(za,Nb){!this.fa.lc&&Ad.a(Nb)?(Array.forEach(this.rf,Object(ab.a)(this,this.Mlf,"onDeleteOsfControl")),Array.clear(this.rf),this.bLb=
!1):(Nb.AG&&(pb.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.eIf()),this.dK(),Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.bLb=!1))};a.prototype.gq=function(){Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(pb.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.eIf());this.dK();Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&
(this.bLb=!1)};a.prototype.eIf=function(){var za=this;if(Db.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var Nb=[],bb=0;bb<this.rf.length;bb++){var Ub=this.rf[bb];Ub.osfControlType&&3!==Ub.osfControlType&&4!==Ub.osfControlType||Array.add(Nb,Ub)}bb=!1;for(Ub=0;Ub<Nb.length;Ub++){var kc=Nb[Ub];this.WNa(kc.controlId);!bb&&kc&&kc.Wk&&(bb=Oc.HelperMethods.qy(kc.Wk))}bb&&(Nb={},Nb=(Nb.DynamicAddinCommandsMethodDispatchId=4,Nb),this.lJ(-1014260128,Nb))}Db.EwaSettings.ka(416)&&
yd.TaskExtensions.Aa(gc.GetServiceTaskFactory.Va(this.$.ea,278,279,3,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),function(ad){ad&&(ad=ad.result)&&(za.$.ea.Ba(278)||za.$.ea.Ia(278,ad),ad.h2e().Yba())},this.la,3)};a.prototype.dK=function(){var za=this,Nb=new r(this.$,this.Ti,this.aJf);void 0===this.$||null===this.$?pb.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Db.EwaSettings.ka(262)&&pb.ULS.sendTraceTag(537170513,
0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Ti||null===this.Ti));if(Nb.tki()){var bb=function(){},Ub=function(Qd){Qd=me.a.xg(Qd.data);pb.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",pd.a.Uc(Qd))},kc=Nb.yEg();Nb=function(Qd,We,Ke){return Fe.i(za.$.ra.ua,"ExecuteRichApiRequest",za.AEg(kc),Qe.b(Qd,bb),Qe.a(We,Ub),Ke,null,0)};var ad=a.G$c(kc);Db.EwaSettings.pc()?
this.$.userOperationManager.ft(new Pf.a(507,0,Nb,ad|64)):this.$.userOperationManager.ft(new se.a(507,0,Nb,ad))}};a.prototype.AEg=function(za){var Nb=this.$.ra.ua.Na(1);Nb.request=za;return Nb};a.prototype.Mlf=function(za){za.Uhc();this.raiseEvent("cd",za.controlId)};a.prototype.Hpe=function(za,Nb){if(za)for(var bb=0;bb<za.length;bb++)if(Bb.a.equals(za[bb],Nb,!0))return!0;return!1};a.prototype.DDg=function(za){var Nb={};Nb.navigationMode=OSF.OsfNavigationMode.DefaultMode;Nb.assetId=null;Nb.category=
null;if(!za||3>za.length)return Nb;if(!Bb.a.ma(za[0])){var bb=parseInt(za[0]);isNaN(parseInt(bb))||(Nb.navigationMode=bb)}Bb.a.ma(za[1])||(Nb.assetId=za[1]);Bb.a.ma(za[2])||(Nb.category=za[2]);return Nb};a.prototype.CVh=function(){if(Db.EwaSettings.ka(61)){var za=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(!Bb.a.ma(za)&&"*"!==za.trim()){this.OGa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new L(this),za,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Qf.get(2));
try{this.OGa.init()}catch(Nb){try{this.OGa.dispose()}catch(bb){}this.OGa=null;pb.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Nb.message)}za={};za.a=this.$.ya.UserSessionId;yc.b().Je(39,za)}}};a.prototype.DSf=function(za,Nb,bb){var Ub=this,kc=a.TCg(za[0]),ad=kc.Wfa,Qd=kc.Sga;kc.Wfa=function(){ad&&ad();var We=kc.vJa!==OSF.InfoType.Error?Nb:null;za.shift();za.length?Ub.DSf(za,We,bb):We&&We()};kc.Sga=function(){Qd&&Qd();bb&&kc.vJa!==OSF.InfoType.Error&&bb()};
Wa.a.nKd(kc)};a.prototype.lBh=function(){var za={};za.AddinRibbonControlsOverriddenByApi=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();za.AddinActionDefinitionHybridMode=Db.EwaSettings.ka(676).toString();za.UseActionIdForUILessCommand=Db.EwaSettings.ka(681).toString();za.AllowStorageAccessByUserActivationOnIFrame=Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();za.RequirementSetRibbonApiOnePointTwo=
Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();za.flightingTreatmentVariables=Ka.AFrameworkApplication.ha.E5b;za.ShortcutInfoArrayInUserPreferenceData=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return za};a.getSolutionId=function(za){var Nb=za.PrimaryMarketplace.SolutionId;Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?Db.EwaSettings.ka(300)&&za.OwnerAddinSolutionId&&(Nb=za.OwnerAddinSolutionId):Db.EwaSettings.ka(300)&&za.OwnerAddinAssetId&&(Nb=za.OwnerAddinAssetId);return Nb};a.G$c=function(za){var Nb=0;Db.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?za.RequestFlags&1&&256!==(za.RequestFlags&256)||(Nb=16):Nb=za.RequestFlags&1?0:16;return Nb};a.dta=function(za,Nb){Nb=a.getSolutionId(za,Nb);return a.T8c(Nb,za.PrimaryMarketplace.SolutionVersion,za.PrimaryMarketplace.MarketplaceType,
za.PrimaryMarketplace.MarketplaceRef)};a.$Wg=function(za){var Nb={};za=(Nb.recording=za,Nb);return JSON.stringify(za)};a.qSg=function(za){var Nb={};Nb.visibility=za?"Visible":"Hidden";return JSON.stringify(Nb)};a.EPe=function(za){if(Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){var Nb=za.getSolutionId(),bb=za.getVersion(),Ub=za.getStoreType();za=za.getStoreId();return a.T8c(Nb,bb,Ub,za)}Nb=za.getMarketplaceID();bb=za.getMarketplaceVersion();
Ub=za.getStoreType();za=za.getStoreLocator();return a.T8c(Nb,bb,Ub,za)};a.T8c=function(za,Nb,bb,Ub){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",za,Nb,a.KIh(bb).toString(),Ub)};a.zbd=function(za,Nb){var bb=za.split("|");if(7>bb.length)return pb.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==bb[0])return pb.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",
bb[0]),null;var Ub=bb[1],kc=bb[2],ad=a.LIh(bb[3]),Qd=bb[4];bb=bb[5];Ub&&Ub.length||(Ub=bb);bb={};bb.InstanceId=String.format("{{{0}}}",kb.a.create().toString());bb.WebExtensionOsfControlType=4;bb.WebExtensionType=1;bb.PrimaryMarketplace={};bb.PrimaryMarketplace.SolutionId=Ub;bb.PrimaryMarketplace.SolutionVersion=kc;bb.PrimaryMarketplace.MarketplaceRef=Qd;bb.PrimaryMarketplace.MarketplaceType=ad;bb.ContainsCustomFunctions=Nb?!0:!1;Nb&&(bb.OsfPropertyBag=[["customFunctionAddinId",za]]);return bb};a.LIh=
function(za){za=parseInt(za);return za===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:za===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:za===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:za===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:za===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:za===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:za===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:za===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:
za===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:za===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:za===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null};a.KIh=function(za){return za===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:za===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:za===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:za===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:za===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:
za===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:za===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:za===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:za===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:za===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:za===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.qob=function(za){var Nb={};Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(Nb.Version=za.appVersion,Nb.AssetId=za.assetId,Nb.AssetStoreId=null!==za.assetStoreId?za.assetStoreId.toString():null,Nb.StoreType=za.storeType,Nb.Height=za.height,Nb.SolutionId=za.solutionId,Nb.StoreId=za.storeId,Nb.TargetType=za.targetType,Nb.Width=1===Nb.TargetType?0:za.width,Nb.SharedRuntimeId=za.sharedRuntimeId,Nb.AppVersion=za.appVersion,Nb.CurrentStoreType=za.currentStoreType,Nb.Id=za.id):(Nb.AppVersion=za.appVersion,Nb.AssetId=za.assetId,Nb.AssetStoreId=null!==za.assetStoreId?za.assetStoreId.toString():
null,Nb.CurrentStoreType=za.currentStoreType,Nb.Height=za.height,Nb.Id=za.id,Nb.StoreId=za.storeId,Nb.TargetType=za.targetType,Nb.Width=1===Nb.TargetType?0:za.width,Nb.SharedRuntimeId=za.sharedRuntimeId);return Nb};a.yvb=function(za){return za===OSF.DDA.EventDispId.dispidSettingsChangedEvent||za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||za===OSF.DDA.EventDispId.dispidRichApiMessageEvent||
za===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||za===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||za===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.TCg=function(za){return Object.assign(new mc.a,{vJa:za.infoType,id:za.id,title:za.title,description:za.description,buttonText:za.buttonTxt,Wfa:za.buttonCallback,r$b:za.highPriority,Sga:za.dismissCallback,errorCode:za.errorCode,p0e:za.iframeNotificationUrl})};a.TJa=function(za){var Nb="FA000000014"===za;Nb||
(Nb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===za);return Nb};a.L2h=function(za){return"FA000000005"===za};Ll.Object.defineProperties(a.prototype,{IWb:{configurable:!0,enumerable:!0,get:function(){return this.rda||(this.rda=new Ra.a(this.$.Zx))}},sh:{configurable:!0,enumerable:!0,get:function(){if(!this.fm){var za={},Nb=!(this.$.zd&1),bb=vb.a.current.lH,Ub=this.$.workbookContext,kc=Yb.a.w_+Yb.a.WZb,ad=0;Db.EwaSettings.ka(515)&&(ad|=2);za.pageBaseUrl=bb.LayoutsContentUrlPrefix;za.appName=OSF.AppName.ExcelWebApp;
za.appVersion="16";za.appSettings=this.lBh();za.singleSignOnSettings=Ya.AppsForOfficeSingleSignOnManager.rIh();za.clientMode=Nb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;za.appUILocale=this.$.ya.UICultureTag;za.dataLocale=this.$.ya.DataCultureTag;za.docUrl=Ub.ClientUrl;za.hostControl=this;za.formFactor=OSF.FormFactor.Default;za.lcid=this.$.QH.toString();za.localizedScriptsUrl=Yb.a.w_+Yb.a.nXc;za.localizedImagesUrl=kc;za.localizedStylesUrl=Yb.a.w_+Yb.a.Jse;za.localizedResourcesUrl=kc;za.osfOmexBaseUrl=
bb.OsfOmexBaseUrl;za.firstPartyManifestCDNUrl=bb.FirstPartyAddInManifestCDN;za.sdxAssetsToPrefetchMapping=Ka.AFrameworkApplication.ha.Ta("SdxAssetsToPrefetchMapping");za.sdxCdnUrl=bb.SdxCdnUrl;za.sdxDmsUrl=bb.SdxDmsUrl;za.devCatalogUrl=bb.DevCatalogUrl;za.controlStatusChanged=Object(ab.a)(this,this.pka,"onOsfControlStatusChanged");za.notifyHost=Object(ab.a)(this,this.Ypf,"onOsfNotifyHost");za.allowExternalMarketplace=this.$.fa.$g.get(27)&&a.XXc;za.enableAddinCommands=Db.EwaSettings.ka(53);za.enableBlackForestRedirect=
Db.EwaSettings.ka(88);za.enableMyOrg=this.$.fa.$g.get(33);za.enableMyApps=this.$.fa.$g.get(34);za.enableDevCatalog=Db.EwaSettings.ka(45);za.enablePrivateCatalog=this.ddj();za.enableTaskpaneUpgradeToAppCommand=Db.EwaSettings.ka(93);za.showSignOutFromPrivateCatalogMessage=this.$.fa.$g.get(36);za.enableUploadFileDevCatalog=Db.EwaSettings.ka(53)&&!Db.EwaSettings.ka(287);za.userNameHashCode=Na.a.jv(Ka.AFrameworkApplication.userName);za.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();za.enableSingleSignOnForAddin=
!Db.EwaSettings.ka(24)&&Ka.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;za.enableDisplayBlockedMinorError=Db.EwaSettings.ka(184);za.hideAppsExtensionUrl=Ka.AFrameworkApplication.hideAppsExtensionUrl;za.enableAnonymousUseLegacyCatalogService=Db.EwaSettings.ka(174);za.enableInsertDialogAccessibilityFix=Db.EwaSettings.ka(181);za.disableAppsForOfficeThirdParty=Db.EwaSettings.ka(187);za.enableFirstPartySSO=Db.EwaSettings.ka(199);za.wacSessionId=this.$.ya.UserSessionId;za.disableLogging=
!this.$.ya.AriaLoggingIsEnabled;za.enableFirstPartySDXErrorMessages=Db.EwaSettings.ka(213);za.enableRichApiCellEditDelay=Db.EwaSettings.ka(191);za.isHostDocumentDomain=Db.EwaSettings.ka(229);za.loggableUserId=Ka.AFrameworkApplication.ha.Ta("LoggableUserId");za.sessionStartInfoJson=Ka.AFrameworkApplication.ha.Ta("SessionStartInfoJson");za.wopiHostOriginFromPostMessage=Ka.AFrameworkApplication.wopiHostOriginFromPostMessage;za.wopiHostOriginFromWacPropBag=Ka.AFrameworkApplication.ha.Ta("PostMessageOrigin");
za.wacIsEmbedded=Ka.AFrameworkApplication.ha.sa("IsEmbedded");za.accessibilityAllowFocusAddinTaskpane=Ka.AFrameworkApplication.ha.sa("AccessibilityAllowFocusAddinTaskpane");za.enableRemoveAppCommandsAddin=Ka.AFrameworkApplication.ha.sa("RemoveAppCommandsAddinIsEnabled");za.isHostFrameTrustCheckEnabledForAddIns=Ka.AFrameworkApplication.ha.sa("HostFrameTrustCheckIsEnabledForAddIns");za.isHostFrameTrusted=Ka.AFrameworkApplication.isHostFrameTrusted;za.agaveAddinUploadEnabled=Db.EwaSettings.ka(47);za.hostAllowedOfficeStore=
Ka.AFrameworkApplication.ha.sa("HostAllowedOfficeStore");za.hostAllowedSdxEmbedding=Ka.AFrameworkApplication.ha.sa("HostAllowedSdxEmbedding");za.hostInstallAddIns=Ka.AFrameworkApplication.ha.Ta("HostInstallAddIns");za.hostInstallAddInsIsEnabled=Ka.AFrameworkApplication.ha.sa("HostInstallAddInsIsEnabled");za.approvedAddIns=Ka.AFrameworkApplication.ha.Ta("ApprovedAddIns");za.addinEnforceHttpsIsEnabled=this.ocj(za.sessionStartInfoJson);za.hostFeatureGateFlag=ad;za.isUpnCheckEnabled=Ka.AFrameworkApplication.ha.sa("IsUpnCheckEnabled");
za.wacUpn=Ka.AFrameworkApplication.ha.Ta("UserPrincipalName");za.isReactRibbonEnabled=Nc.a.isReactRibbonEnabled();za.enableSetFocusOnTaskpaneOnUserAction=Db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);za.isSafariWithIndexedDBDisabled=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ha.a.Y3a;za.isIndexedDBDisabled=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ha.a.Y3a||Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Ha.a.uf;za.enableCustomShortcuts=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");za.changeGetModifierKeyStringOutputOrder=Db.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.fm=new OSF.ContextActivationManager(za);za={};this.fm.setIframeAttributeBag((za.frameborder=0,za.marginheight=0,za.marginwidth=0,za));this.fm.setWSA(Ka.AFrameworkApplication.Cm);this.fm&&"undefined"!==typeof this.fm.hostCheckReadyHandler&&Ka.AFrameworkApplication.Nsg(Object(ab.a)(this.fm,
this.fm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var Qd=oc.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.fm.setOAuthManager(Qd)}catch(We){}}return this.fm}},DCj:{configurable:!0,enumerable:!0,get:function(){return this.qNc}},Ti:{configurable:!0,enumerable:!0,get:function(){return this.z8d}},lla:{configurable:!0,enumerable:!0,get:function(){return this.w8d}},NEd:{configurable:!0,enumerable:!0,get:function(){return this.A8d}},MEd:{configurable:!0,enumerable:!0,get:function(){return this.y8d}},
b0i:{configurable:!0,enumerable:!0,get:function(){return this.C8d}},$_i:{configurable:!0,enumerable:!0,get:function(){return this.x8d}},a0i:{configurable:!0,enumerable:!0,get:function(){return this.B8d}},c0i:{configurable:!0,enumerable:!0,get:function(){return this.D8d}},d0i:{configurable:!0,enumerable:!0,get:function(){return this.E8d}},OEd:{configurable:!0,enumerable:!0,get:function(){return this.F8d}},jU:{configurable:!0,enumerable:!0,get:function(){return this.ieg}},$:{configurable:!0,enumerable:!0,
get:function(){return this.ub}}});Ll.Object.defineProperties(a,{XXc:{configurable:!0,enumerable:!0,get:function(){return a.wXd},set:function(za){a.wXd=za}}});a.bZa=new Tb.a;a.wXd=!0;Object(ib.a)(a,"DdaFacade",qb.a,[199,469,431,470,471,6])},850:function(C,F,b){function a(){this.fBd=0;this.sV={};this.dra={}}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(110);a.prototype.AEh=function(l,n){return this.sV[a.dTc(l,n)]};a.prototype.JCe=function(l,n){n||void 0!==this.dra[l]&&null!==this.dra[l]?n&&
void 0!==this.dra[l]&&null!==this.dra[l]&&delete this.dra[l]:this.dra[l]=1};a.prototype.BWb=function(l){return void 0===this.dra[l]||null===this.dra[l]};a.prototype.zNh=function(l){var n=a.dTc(l.messageType,l.targetId);1===l.actionType?this.SOh(l.controlId,l.messageType,n):2===l.actionType&&this.BPh(l.controlId,l.messageType,n)};a.prototype.oSi=function(l){if(l){var n=Object.keys(this.sV);if(!(void 0===n||null===n||0>=n.length)){n=Ol(n);for(var r=n.next();!r.done;r=n.next()){r=r.value;var h=this.sV[r];
h[l]&&(delete h[l],Object.keys(h).length||delete this.sV[r])}}}};a.prototype.QY=function(l,n){l=a.dTc(l,n);l=this.sV[l];return!!l&&0<Object.keys(l).length};a.prototype.tQh=function(){return!d.a.isEmpty(this.sV)};a.prototype.R8e=function(){return 0<this.fBd};a.prototype.kzh=function(){var l=[],n=this.sV,r;for(r in n){var h=r,v=n[r],w;for(w in v){v=w;var t={};t.eventType=parseInt(h.split("#")[0]);t.targetId=h.split("#")[1];t.addinId=v;l.push(t)}}return l};a.prototype.SOh=function(l,n,r){if(this.sV[r])r=
this.sV[r],r[l]=r[l]?r[l]+1:1;else{var h={};h[l]=1;this.sV[r]=h}100===n&&this.fBd++};a.prototype.BPh=function(l,n,r){if(this.sV[r]){var h=this.sV[r];if(l){var v=h[l];1===v?(delete h[l],Object.keys(h).length||delete this.sV[r]):h[l]=v-1;100===n&&this.fBd--}else e.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",l,r)}else e.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",r)};a.dTc=function(l,n){return String.format("{0}#{1}",
l,n)};a.HV="Workbook";Object(C.a)(a,"RichApiEventRegistration",null,[])},878:function(C,F,b){function a(e,d,l,n){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=e;this.controlId=d;this.ddaBinding=l;this.ArrayData=void 0===n?null:n}b.d(F,"a",function(){return a});C=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(C.a)(a,"DdaEventArgs",null,[])},925:function(C,F,b){function a(d,l,n){this.gMb=
d;this.h9f=l;this.i9f=n}function e(){this.title=this.id=this.tabs=null}C=b(0);Object(C.a)(e,"AddInDataTransferObject",null,[]);b.d(F,"a",function(){return a});a.prb=function(d){return(d=d.Zaa)?Object.assign(new e,{tabs:d.sw.toArray(),id:d.Sog,title:d.Tog}):null};Ll.Object.defineProperties(a.prototype,{sw:{configurable:!0,enumerable:!0,get:function(){return this.gMb}},Sog:{configurable:!0,enumerable:!0,get:function(){return this.h9f}},Tog:{configurable:!0,enumerable:!0,get:function(){return this.i9f}}});
Object(C.a)(a,"OneLineRibbonExtensibility",null,[])},933:function(C,F,b){function a(){var d={};this.C4c=(d.tabhome="Ribbon.Home",d.tabinsert="Ribbon.Insert",d.tabdata="Ribbon.Data",d.tabreview="Ribbon.Review",d.tabview="Ribbon.View",d);d={};this.A4c=(d.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",e.a.instance.da(1562),e.a.instance.da(1566)],d.tabformulas=["Ribbon.Formulas",e.a.instance.da(1563),e.a.instance.da(1567)],d.tabdeveloper=["Ribbon.Developer",e.a.instance.da(1564),e.a.instance.da(1568)],
d.tabaddins=["Ribbon.AddIns",e.a.instance.da(1565),e.a.instance.da(1569)],d);this.Oih="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");this.r_a=null}b.d(F,"a",function(){return a});C=b(0);var e=b(16);a.prototype.fDh=function(){if(this.r_a)return this.r_a;this.r_a={};for(var d=Ol(Object.keys(this.C4c)),l=d.next();!l.done;l=d.next())l=l.value,this.r_a[l]=this.C4c[l];d=Ol(Object.keys(this.A4c));for(l=d.next();!l.done;l=
d.next())l=l.value,this.r_a[l]=this.A4c[l][0];return this.r_a};Ll.Object.defineProperties(a.prototype,{Bga:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},Xz:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},Ptc:{configurable:!0,enumerable:!0,get:function(){return this.C4c}},g7a:{configurable:!0,enumerable:!0,get:function(){return this.Oih}},Dii:{configurable:!0,enumerable:!0,
get:function(){return this.A4c}}});Object(C.a)(a,"AddinCommandsStringProvider",null,[482])},973:function(C,F,b){function a(L,aa){this.Oyc=new t.a;this.fm=L;this.wlg=aa}function e(L,aa,fa,W){this.VR=new v.a;this.rF=new v.a;this.Ana=null;this.Zhb=new v.a;this.Z2d=Promise.resolve(null);this.k$d=!1;this.HRb=aa;this.Oag=L;this.N$d=fa;this.m9f=W}function d(){var L=l.call(this)||this;L.errorCode=0;return L}function l(){this.NMb=new v.a;this.w8=this.v8=!1;this.wma=this.authChallenge=null;this.startTime=this.retryCount=
0;this.Kge=null}function n(){this.token=null;this.expiresOn=0;this.Hfa=this.authChallenge=null}function r(){this.accessToken=null}function h(){this.startTime=0;this.callback=null}b.r(F);C=b(0);var v=b(211),w=b(15),t=b(106);Object(C.a)(h,"SSOCallbackInfo",null,[]);Object(C.a)(r,"AccessTokenInformation",null,[498]);var B=b(1105);Object(C.a)(n,"CachedTokenInfo",null,[]);Ll.Object.defineProperties(l.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.NMb}}});Object(C.a)(l,"SSORequestInfo",
null,[]);Em(d,l);Object(C.a)(d,"SSOFailedRequestInfo",l,[]);var z=b(5);e.prototype.eej=function(L){if(this.Ana&&this.Ana.authChallenge===L.authChallenge){if(Date.now()/1E3+e.Jgi>this.Ana.expiresOn)return this.Ana=null,!1;L=new B.a;L.token=this.Ana.token;L.expiresOn=this.Ana.expiresOn;L.Hfa=this.Ana.Hfa;L.LQa=!0;L.Vsb=0;this.mtb(L);return!0}return!1};e.prototype.Mcj=function(L){for(var aa=0;aa<this.rF.count;aa++)if(this.rF.oa(aa).authChallenge===L.authChallenge&&this.rF.oa(aa).wma===L.wma){var fa=
void 0;(fa=this.rF.oa(aa)).retryCount=fa.retryCount+1;L.retryCount=this.rF.oa(aa).retryCount;if(this.rF.oa(aa).retryCount<e.ehi||!this.rF.oa(aa).v8&&L.v8||!this.rF.oa(aa).w8&&L.w8){if(!this.rF.oa(aa).v8&&L.v8||!this.rF.oa(aa).w8&&L.w8)L.retryCount=0;this.rF.removeAt(aa);break}L=new B.a;L.errorCode=this.rF.oa(aa).errorCode;this.mtb(L);return!0}return!1};e.prototype.Gqg=function(L,aa){for(var fa=0;fa<this.rF.count;fa++)if(this.rF.oa(fa).wma===L.wma&&this.rF.oa(fa).authChallenge===L.authChallenge)return;
this.rF.add(Object.assign(new d,{v8:L.v8,w8:L.w8,authChallenge:L.authChallenge,wma:L.wma,errorCode:aa,retryCount:L.retryCount}))};e.prototype.M7c=function(L,aa,fa,W,G,N){var Y=this,V=b(973).AppsForOfficeSingleSignOnManager;""===fa&&(fa=null);if(this.k$d)V.s4(N,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var da=null,U=Ol(this.VR),Z=U.next();!Z.done;Z=U.next())if(Z=Z.value,Z.v8===L&&Z.w8===aa&&Z.authChallenge===fa&&Z.wma===G){da=Z;break}da||(da=Object.assign(new l,{v8:L,
w8:aa,authChallenge:fa,Kge:W,wma:G,retryCount:0,startTime:V.wv()}),this.VR.add(da));da.retryCount=0;da.callbacks.add(N);this.Z2d=this.Z2d.then(function(){var ca=b(973).AppsForOfficeSingleSignOnManager;if(0<Y.VR.count){var ra=Y.VR.oa(0);if(Y.eej(ra)||Y.Mcj(ra))return null;for(var La=0;La<Y.Zhb.count;)Y.Zhb.oa(La)+e.qpj<ca.wv()?Y.Zhb.removeAt(La):La++;if(Y.Zhb.count>=e.$gi||Y.VR.count>=e.Ggi)return ra=new B.a,ra.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,Y.mtb(ra),null;var na=
null;z.AFrameworkApplication.xa&&(ca=z.AFrameworkApplication.xa.MC)&&(na=ca.Dc("ComponentAttach",Y.Oag+e.qkg));return ra.wma.Rmg(Y.resource,ra.v8,ra.w8,ra.authChallenge,Y.m9f,ra.Kge).then(function(ma){na&&na.stop();Y.mtb(ma)},function(){na&&na.stop();var ma=new B.a;ma.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;Y.mtb(ma)})}return null})}};e.prototype.mtb=function(L){var aa=b(973).AppsForOfficeSingleSignOnManager;try{if(this.VR.count){var fa=this.VR.oa(0);this.VR.removeAt(0);var W=
null;L.errorCode||(W=new r,W.accessToken=L.token);L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.Gqg(fa,L.errorCode);var G={};null!=L.Vsb&&(G.getTokenSilentTime=L.Vsb.toString());null!=L.dbd&&(G.getTokenPopupTime=L.dbd.toString());null!=L.X9c&&(G.getIDTokenTime=
L.X9c.toString());null!=L.LQa&&(G.tokenCached=L.LQa.toString());L.ONd&&(G.detailedError=L.ONd);L.Hfa&&(G.authLibrary=L.Hfa);fa.retryCount&&(G.retryCount=fa.retryCount);for(var N=Ol(fa.callbacks),Y=N.next();!Y.done;Y=N.next())aa.s4(Y.value,L.errorCode,W,G);null!=L.LQa&&L.LQa||this.Zhb.add(fa.startTime);if(!L.errorCode)for(null!=L.expiresOn&&(this.Ana=Object.assign(new n,{token:L.token,expiresOn:L.expiresOn,authChallenge:fa.authChallenge,Hfa:L.Hfa})),this.rF.clear(),N=0;N<this.VR.count;)if(this.VR.oa(N).authChallenge===
fa.authChallenge){var V=Ol(this.VR.oa(N).callbacks);for(Y=V.next();!Y.done;Y=V.next())aa.s4(Y.value,L.errorCode,W,G);this.VR.removeAt(N)}else N++}}catch(da){w.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",da.message)}};e.prototype.shutdown=function(){this.k$d=!0;this.VR.clear()};Ll.Object.defineProperties(e.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.HRb}}});e.qpj=6E4;e.$gi=6;e.Ggi=6;e.ehi=3;e.Jgi=300;e.qkg="GetAccessToken";
Object(C.a)(e,"SSOCallbackManager",null,[]);var x=b(829),y=b(839),J=b(116),E=b(78),A=b(23),H=b(30),S=b(144),Q=b(337);b.d(F,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.N7c=function(L,aa,fa,W,G,N,Y,V,da,U){U=Object.assign(new h,{startTime:a.wv(),callback:U});try{var Z=!!fa&&""!==fa,ca=U.startTime,ra=this.getOsfControl(L),La=ra.getStoreType()||"",na=ra.getOwnerAddinStoreType()||"",ma=ra.getMarketplaceID()||"",xa=ra.getMarketplaceVersion()||"";La=La.toLowerCase();na=na.toLowerCase();
ma=ma.toLowerCase();var Pa=E.a.W9c(aa)||"",ib=E.a.W9c(ra.getIframeUrl())||"",pb=Pa.toLowerCase()===ib.toLowerCase();Pa=La;"inmemory"===La&&(Pa=na);var xb=Telemetry.PrivacyRules.GetAssetId(Pa,ra.getStoreLocator(),ma);ra={};var Ya=(ra.callInstanceId=ca.toString(),ra.controlAssetId=xb,ra.controlVersion=xa,ra.storeType=La,ra.ownerStoreType=na,ra.allowConsentPrompt=W.toString(),ra.forMSGraphAccess=G.toString(),ra.allowSignInPrompt=N.toString(),ra.hasAddinAuthChallenge=Z.toString(),ra.securityOriginEqualsSourceLocation=
pb.toString(),ra.singleSignOnEnabled=Y.toString(),ra.accountTypeFilter=V||"",ra);w.ULS.sendTraceTag(51401115,344,50,"{0}",Ya);S.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:J.a.fy(Ya)}));ca=!0;var ab=z.AFrameworkApplication.ha.Ta("HostAuthType");switch(V){case "aad":ca="aad"===ab;break;case "msa":ca="msa"===ab;break;default:ca=!V||"noFilter"===V}if(ca){V=null;if(Y)for(var ea=Ol(this.wlg),ta=ea.next();!ta.done;ta=ea.next()){var Ka=
ta.value;if(Ka.q1h(ma)){V=Ka;break}}V?this.isSSOAddin(L)?(Y=!0,"omex"===Pa&&(Y=!1),"spapp"===Pa||"spcatalog"===Pa?(w.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.s4(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):G&&!Y?(w.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.s4(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(G&&"exchange"===
Pa&&(W=!1),this.M7c(L,aa,fa,Pa,W,N,da,V,U))):(w.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.s4(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.s4(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.s4(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(mb){this.Yec(),w.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",mb.message),a.s4(U,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(L,aa,fa,W){this.N7c(L,fa[x.a.hQc]||null,fa[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,fa[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,fa[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,fa[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,aa,fa[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,fa[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,W)};a.prototype.M7c=function(L,aa,fa,W,G,N,Y,V,da){this.Oyc.qb(L)?W=this.Oyc.oa(L):(W=new e(L,this.getWebApplicationResource(L).split(",")[0],W,this.getDefaultDisplayName(L)),this.Oyc.add(L,W));var U=W.resource;L=a.RGh(U,this.getWebApplicationId(L));var Z=OfficeExt.WACUtils.getHostSecure(aa);L&&Z?L.toLowerCase()===Z.toLowerCase()?W.M7c(G,N,fa,Y,V,da):(a.BLa('SSO Resource "'+U+'" cannot be used from "'+aa+'" origin due to domain mismatch.'),
w.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.s4(da,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(L||w.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Z||w.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.s4(da,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.Yec=function(){var L={};w.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",
(L.UserAgent=window.navigator.userAgent,L))};a.prototype.getOsfControl=function(L){return this.fm.getOsfControl(L)};a.prototype.isSSOAddin=function(L){return this.getOsfControl(L).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(L){return this.getOsfControl(L).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(L){return this.getOsfControl(L).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(L){return this.getOsfControl(L).getManifest().getDefaultDisplayName()};
a.rIh=function(){try{var L={};A.a.nja&&y.a.aub&&(L.UiHostSupportsAuthTokenAddinList=a.iLe);L.UiHostSupportsAuthToken=y.a.aub;return L}catch(aa){w.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",aa.message)}return null};a.getInstance=function(L,aa,fa){fa=void 0===fa?null:fa;a.Ma||(aa=new v.a,fa&&aa.add(fa.ofi),a.Ma=new a(L,aa));return a.Ma};a.BLa=function(L){window.console.warn&&window.console.warn(L)};a.RGh=function(L,aa){if(!L)return"";aa||(aa="");var fa=
L.toLowerCase(),W=aa.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(W)||(a.BLa('SSO App Id "'+aa+'" is not a valid format. It will be rejected from store submission.'),w.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));fa.endsWith(W)||(a.BLa('SSO Resource "'+L+'" does not end with App Id "'+aa+'". It will be rejected from store submission.'),w.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!fa.startsWith("https://")&&
!fa.startsWith("api://"))return a.BLa('SSO Resource "'+L+'" must be https:// or api:// protocol.'),w.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(aa=0;aa<L.length;aa++){W=L.charAt(aa);var G=H.a.charCodeAt(L,aa);if(33>G||126<G||"&"===W||"?"===W||"#"===W||"%"===W||"\\"===W)return a.BLa('SSO Resource "'+L+'" contains an invalid character "'+W+'".'),w.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+W+"' in resource URI."),""}if(0<=L.indexOf("::"))return a.BLa('SSO Resource "'+
L+'" contains an invalid string "::".'),w.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<L.length)return a.BLa('SSO Resource "'+L+'" is '+L.length+" characters and exceeds the max length of 120 characters."),w.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+L.length+"."),"";fa.startsWith("api://")&&(fa="https://"+fa.substring(6,fa.length));return 8===fa.length?"":OfficeExt.WACUtils.getHostSecure(fa)||""};a.s4=function(L,aa,fa,W){var G=L.startTime,N=0;0<G&&(N=a.wv()-G);
var Y={};G=(Y.callInstanceId=G.toString(),Y.callDuration=N.toString(),Y.errorCode=aa.toString(),Y);if(W)for(var V in W)G[V]=W[V];w.ULS.sendTraceTag(51401116,344,50,"{0}",G);S.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:J.a.fy(G)}));L.callback(aa,fa)};a.wv=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(L){}return Date.now()};a.iLe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
a.Ma=null;Object(C.a)(a,"AppsForOfficeSingleSignOnManager",null,[477])},998:function(C,F,b){function a(){this.vJa=0;this.Wfa=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.r$b=!1;this.p0e=this.Sga=null}b.d(F,"a",function(){return a});C=b(0);Object(C.a)(a,"AddInCommandsNotificationParameters",null,[])}}]);

//# sourceMappingURL=EwaDS.agave.js.map