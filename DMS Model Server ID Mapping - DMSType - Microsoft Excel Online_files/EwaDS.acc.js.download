(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1360:function(C,F,b){function a(O){var qa=xi.call(this)||this;qa.$=O;qa.Yb();return qa}function e(O,qa){var rb=xj.call(this)||this;rb.$=O;rb.gridView=Hf.g(O);rb.tableManager=qa;rb.ex=new x(rb.gridView);rb.Xo=new N(rb.gridView);rb.gridView.Kb&&(rb.gridView.Kb.Csg(Object(bd.a)(rb,rb.wlb,"attachBehavior")),rb.gridView.Kb.update(!1));O.ea.Ia(64,rb);return rb}function d(O,qa,rb,Sb){return fa.call(this,O,qa,rb,Sb)||this}function l(O){var qa=
G.call(this,O)||this;l.nob(O,hb.a.Ohh+" "+jg.a.Asa);l.nob(O,hb.a.Nhh+" "+jg.a.Asa);l.nob(O,hb.a.Khh+" "+jg.a.Asa);l.nob(O,hb.a.Mhh+" "+jg.a.Asa);l.nob(O,jg.a.Lhh);return qa}function n(O){var qa=G.call(this,O)||this;appChrome.renderSpinner(O);return qa}function r(O){var qa=G.call(this,O)||this;r.Znb(O,hb.a.uhh+" "+jg.a.Asa);r.Znb(O,hb.a.thh+" "+jg.a.Asa);r.Znb(O,hb.a.qhh+" "+jg.a.Asa);r.Znb(O,hb.a.shh+" "+jg.a.Asa);r.Znb(O,jg.a.rhh);return qa}function h(O,qa,rb,Sb,Uc){O=w.call(this,O,qa,rb,Sb,Uc)||
this;Zd.a.Kfe(Object(bd.a)(O,O.wAb,"onLastInputMethodChanged"));O.Nld=3===Zd.a.Tb;O.Xo.ftg(Object(bd.a)(O,O.kyi,"onResizeStartedOrEnded"));return O}function v(O,qa,rb,Sb,Uc){return w.call(this,O,qa,rb,Sb,Uc)||this}function w(O,qa,rb,Sb,Uc){var vd=G.call(this,O)||this;vd.hK=null;vd.pb=null;vd.k2=0;vd.sourceRange=null;vd.Zc=null;vd.iQa=!1;vd.gridView=qa;vd.$=qa.$;vd.eK=[];vd.ga=vd.gridView.ga;vd.ex=rb;vd.Xo=Sb;vd.z$=Uc;vd.coloredReferencesManager=vd.$.ea.Ba(281);Tc.ULS.shipAssertTag(537159362,0,!!vd.coloredReferencesManager,
"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");qa=Ol(vd.lIf());for(rb=qa.next();!rb.done;rb=qa.next())rb=vd.Xo.mve(O,rb.value,vd.Lge(),Object(bd.a)(vd,vd.onPointerDown,"onPointerDown")),Array.add(vd.eK,rb);O=Ol(vd.eK);for(qa=O.next();!qa.done;qa=O.next())qa=qa.value,Ud.a.instance.pa(ed.a.cV,qa,Object(bd.a)(vd.ex,vd.ex.V_e,"hoveringStarted")),Ud.a.instance.pa(ed.a.Hy,qa,Object(bd.a)(vd.ex,vd.ex.W_e,"hoveringStopped"));
vd.iWa(Uc);return vd}function t(O,qa){var rb=G.call(this,O)||this;var Sb=document.createElement("div"),Uc=document.createElement("div");Sb.className=qa?Q.Qhh:Q.Shh;Uc.className=qa?Q.Rhh:Q.Phh;O.appendChild(Sb);O.appendChild(Uc);return rb}function B(O,qa,rb,Sb){return fa.call(this,O,qa,rb,Sb)||this}function z(O,qa){var rb=G.call(this,O)||this;rb.mu=Object(nf.a)(Jh.a,qa.metadata);rb.oJ=document.createElement("div");rb.oJ.id=String.format("{0}-{1}",O.id,Ue.a.Noe);rb.oJ.className=ud.a.FIg;rb.xG=document.createElement("div");
rb.xG.id=String.format("{0}-{1}",O.id,Ue.a.LUc);rb.xG.className=ud.a.LUc;rb.oJ.appendChild(rb.xG);O.appendChild(rb.oJ);Tc.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Ud.a.instance.pa(ed.a.cV,rb.oJ,Object(bd.a)(rb,rb.tqf,"onPointerEnter"));Ud.a.instance.pa(ed.a.Hy,rb.oJ,Object(bd.a)(rb,rb.Iwa,"onPointerLeave"));Ud.a.instance.pa(ed.a.pointerDown,rb.oJ,Object(bd.a)(rb,rb.onPointerDown,"onPointerDown"));
rg.a.instance.pa(ed.a.click,rb.oJ,Object(bd.a)(rb,rb.CAb,"onMouseClick"));rg.a.instance.pa(ed.a.zj,rb.oJ,Object(bd.a)(rb,rb.onDoubleClick,"onDoubleClick"));return rb}function x(O){this.gridView=O;this.k2a=0;this.Yhd=this.Xbc=!1;this.j4=Number.NaN;this.gridView.ga.p8(Object(bd.a)(this,this.hq,"onSelectionStarted"));this.gridView.ga.n1(Object(bd.a)(this,this.Bh,"onSelectionEnded"));this.gridView.ga.qge(Object(bd.a)(this,this.Bh,"onSelectionEnded"))}function y(O,qa){var rb=G.call(this,O)||this;rb.ndg=
qa;Tf.a.instance.pa(ed.a.click,O,Object(bd.a)(rb,rb.czi,"onSelectionClick"));return rb}function J(O,qa){var rb=L.call(this,O)||this;rb.gridView=qa;qa=document.createElement("div");qa.className=jg.a.Ihh;rb.S9=qa;rb.jd(null,null);O.appendChild(qa);Ud.a.instance.pa(ed.a.pointerDown,rb.S9,Object(bd.a)(rb,rb.onPointerDown,"onPointerDown"));Tf.a.instance.pa(ed.a.zj,rb.S9,Object(bd.a)(rb,rb.Paa,"onDblClick"));rb.gridView.ga.p8(Object(bd.a)(rb,rb.hq,"onSelectionStarted"));rb.gridView.ga.n1(Object(bd.a)(rb,
rb.Bh,"onSelectionEnded"));rb.gridView.$.Jk(Object(bd.a)(rb,rb.jd,"onWorkbookOpened"));rb.gridView.$.zb.zVb(Object(bd.a)(rb,rb.e5,"onWacDialogOpened"));rb.gridView.$.zb.yVb(Object(bd.a)(rb,rb.d5,"onWacDialogClosed"));he.EwaSettings.isChangeGateEnabled("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&(rb.gridView.ffe(Object(bd.a)(rb,rb.Wzb,"onComponentRangePickerActiveStateChanged")),rb.gridView.uc.Jm(Object(bd.a)(rb,rb.Onf,"onGridEditStarted")),rb.gridView.uc.Xr(Object(bd.a)(rb,rb.Nnf,"onGridEditEnded")));
return rb}function E(O,qa,rb,Sb,Uc){O=S.call(this,O,qa,rb,Uc)||this;O.T2b=Sc.a.instance.da(2161);O.tBe=Sc.a.instance.da(2162);O.qrc=Sc.a.instance.da(2163);O.aRf=Sc.a.instance.da(2164);O.Ev=he.EwaSettings.getBooleanFeatureGate(Xg.a.rpb,!1);O.$t=null;O.rca=null;O.YP=!1;O.isRow=!1;O.Fh=!1;O.XP=!1;O.DGa=null;O.zPa=null;O.Eld=0;O.MI=0;O.tableManager=Sb;O.tableRange=null;O.ho={};O.FG=!1;O.NY=!1;O.OY=!1;O.fid=!1;O.ga.p8(Object(bd.a)(O,O.hq,"onSelectionStarted"));O.ga.n1(Object(bd.a)(O,O.Bh,"onSelectionEnded"));
O.ga.qge(Object(bd.a)(O,O.esf,"onSelectionAbort"));O.ga.GF(Object(bd.a)(O,O.$c,"onSelectionChanged"));return O}function A(O,qa){this.destinationRange=this.sourceRange=null;this.sourceRange=O;this.destinationRange=qa}function H(O,qa,rb,Sb,Uc,vd){O=S.call(this,O,qa,rb,Uc)||this;O.hK=null;O.pb=null;O.gridView=Hf.g(O.$);O.ex=Sb;O.coloredReferencesManager=O.$.ea.Ba(281);Tc.ULS.shipAssertTag(537159391,0,!!O.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
Sb=Ol(O.MB);for(qa=Sb.next();!qa.done;qa=Sb.next())qa=qa.value,Ud.a.instance.pa(ed.a.cV,qa,Object(bd.a)(O.ex,O.ex.V_e,"hoveringStarted")),Ud.a.instance.pa(ed.a.Hy,qa,Object(bd.a)(O.ex,O.ex.W_e,"hoveringStopped"));O.iWa(vd);return O}function S(O,qa,rb,Sb){var Uc=L.call(this,O)||this;Uc.iQa=!1;Uc.Y0h=he.EwaSettings.getBooleanFeatureGate(Xg.a.rpb,!1);Uc.Fce=null;Uc.Ece=null;Uc.Mpa=0;Uc.X1=0;Uc.Gdd=0;Uc.nSd=0;Uc.Kka=null;Uc.sourceRange=null;Uc.Zc=null;Uc.kba=null;Uc.MB=[];Uc.$=qa;Uc.ga=Hf.g(Uc.$).ga;
Uc.paneType=rb;Uc.Xo=Sb;qa=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");rb=zf.a.jf;qa=Ol(qa&&!rb?[Q.Chh,Q.whh,Q.yhh,Q.Ahh]:[Q.Dhh,Q.xhh,Q.zhh,Q.Bhh]);for(rb=qa.next();!rb.done;rb=qa.next())rb=Uc.Xo.mve(O,rb.value,[Q.vhh],Object(bd.a)(Uc,Uc.onPointerDown,"onPointerDown")),Array.add(Uc.MB,rb);Uc.$.Jk(Object(bd.a)(Uc,Uc.jd,"onWorkbookOpened"));Uc.nHd(Uc.$.isEditMode);return Uc}function Q(){}function L(O){var qa=G.call(this,O)||this;var rb=document.createElement("div");rb.className=
jg.a.Jhh;O.appendChild(rb);return qa}function aa(O,qa,rb,Sb){return fa.call(this,O,qa,rb,Sb)||this}function fa(O,qa,rb,Sb){var Uc=G.call(this,qa)||this;Uc.elb=!1;Uc.xWb=!1;Uc.Fkd=!1;Uc.vXa=null;Uc.Dkd=!1;Uc.S$=!1;var vd=rb.$;Uc.Ix=rb;Uc.ga=rb.ga;Uc.z$=O;Uc.O3i=qa;Uc.paneType=Sb;O=Uc.domElement.currentStyle;qa="#000000";O&&(qa=O.borderTopColor);Uc.xN=new W(Uc.U5c(),qa,vd);Uc.cL=new W(Uc.U5c(),qa,vd);Uc.Kid=vd.fa.isNamedObjectViewMode&&1===vd.workbookContext.NovMode;Uc.xN.Afe(Object(bd.a)(Uc,Uc.Htf,
"onTopGrippieDrag"));Uc.xN.zfe(Object(bd.a)(Uc,Uc.lic,"onGrippieContextMenu"));Uc.xN.Bfe(Object(bd.a)(Uc,Uc.mic,"onGrippiePointerUp"));Uc.cL.Afe(Object(bd.a)(Uc,Uc.kkf,"onBottomGrippieDrag"));Uc.cL.zfe(Object(bd.a)(Uc,Uc.lic,"onGrippieContextMenu"));Uc.cL.Bfe(Object(bd.a)(Uc,Uc.mic,"onGrippiePointerUp"));O=Ol(Uc.gridView.ao);for(qa=O.next();!qa.done;qa=O.next())qa=qa.value,xd.a.instance.pa(ed.a.yf,qa.domElement,Object(bd.a)(Uc,Uc.Vnf,"onGridViewTouchStart")),xd.a.instance.pa(ed.a.ye,qa.domElement,
Object(bd.a)(Uc,Uc.Unf,"onGridViewTouchEnd"));rb.view.Us(Object(bd.a)(Uc,Uc.Mv,"onVisibleAreaChanged"));rb.Gc.Jm(Object(bd.a)(Uc,Uc.NBe,"editStarted"));rb.Kb.Akb(Object(bd.a)(Uc,Uc.Lwa,"onSelectionHighlightChanged"));rb.hkb(Object(bd.a)(Uc,Uc.akf,"onBeforeActiveItemCleanUp"));vd.hD(Object(bd.a)(Uc,Uc.Nlc,"reDrawGrippies"));rb.uq(Object(bd.a)(Uc,Uc.Nlc,"reDrawGrippies"));Uc.ga.n1(Object(bd.a)(Uc,Uc.Bh,"onSelectionEnded"));Uc.ga.p8(Object(bd.a)(Uc,Uc.hq,"onSelectionStarted"));rb.iD(Object(bd.a)(Uc,
Uc.Ho,"onCurrentSelectionModeChanged"));Uc.ga.dVb(Object(bd.a)(Uc,Uc.Mnf,"onGridContextMenu"));Zd.a.Kfe(Object(bd.a)(Uc,Uc.wAb,"onLastInputMethodChanged"));sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.Va(vd.ea,376,377,0,"Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior.IGridHighlightBehaviorEventManager"),function(oe){oe.result.Iug(Object(bd.a)(Uc,Uc.Itf,"onTouchAutoFillModeSet"))},vd.la,3);return Uc}function W(O,qa,rb){var Sb=vf.call(this,document.createElement("div"))||this;Sb.Z0b=null;
Sb.UKb=!1;Sb.$=rb;rb=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");var Uc=zf.a.jf;Sb.domElement.classList.add(!rb||Uc?jg.a.bIe:jg.a.aIe);Sb.domElement.classList.add(jg.a.o4b);O.appendChild(Sb.domElement);mf.DOMElementExtensions.setVisible(Sb.domElement,!1);Sb.RIa=document.createElement("div");Sb.RIa.classList.add(jg.a.n4b);Sb.RIa.style.borderColor=qa;Sb.domElement.appendChild(Sb.RIa);Ud.a.instance.pa(ed.a.pointerDown,Sb.domElement,Object(bd.a)(Sb,Sb.onPointerDown,"onPointerDown"));
Ud.a.instance.pa(ed.a.Ud,Sb.domElement,Object(bd.a)(Sb,Sb.Ah,"onPointerUp"));xd.a.instance.pa(ed.a.ye,Sb.domElement,Object(bd.a)(Sb,Sb.Ah,"onPointerUp"));Ud.a.instance.pa(ed.a.Ch,Sb.domElement,Object(bd.a)(Sb,Sb.pk,"onPointerMove"));xd.a.instance.pa(ed.a.Gg,Sb.domElement,Object(bd.a)(Sb,Sb.pk,"onPointerMove"));Tf.a.instance.pa(ed.a.click,Sb.domElement,Object(bd.a)(Sb,Sb.Rc,"onClick"));return Sb}function G(O,qa){return Ae.call(this,O,void 0===qa?null:qa)||this}function N(O){var qa=$d.call(this)||this;
qa.Ref=[3];qa.gridView=O;return qa}function Y(O,qa){var rb=Fd.call(this)||this;rb.start=O;rb.zub=qa;return rb}function V(O){var qa=gd.call(this)||this;qa.$=O;qa.Yb();return qa}function da(O){var qa=vc.call(this)||this;O.ea.Ia(376,qa);return qa}function U(O){var qa=Eb.call(this)||this;qa.$=O;qa.Yb();return qa}function Z(){this.CEd=Bd.AFrameworkApplication.USd;this.dhi=Bd.AFrameworkApplication.VCj;this.tokens=Bd.AFrameworkApplication.TLh();this.priority=Bd.AFrameworkApplication.VSd;this.p8d=this.O9i();
this.vNc=Bd.AFrameworkApplication.SLh();this.JFc=!1;this.s8d=Bd.AFrameworkApplication.USd;Bd.AFrameworkApplication.ha&&(this.JFc=Bd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",!1))&&(this.s8d=Bd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",Bd.AFrameworkApplication.USd))}function ca(O,qa,rb,Sb,Uc){var vd=this;Sb=void 0===Sb?null:Sb;Uc=void 0===Uc?!1:Uc;this.hpa=0;
this.Pea=this.Fi=null;this.jTb=new Cf.a;this.zR=new Cf.a;this.Hl=null;this.EPb=!1;this.fe=O;this.$6d=qa;this.$6d.execute(function(oe){oe.xm(Nb.a.Sdd,Object(bd.a)(vd,vd.vui,"onHostResponseReceived"))});this.R7=rb;this.Gae=new Oa.a("WebServiceCall","TokenRefresh");this.Gj=Sb||new ra(O);this.gjg=Uc}function ra(O){this.jo={};this.yW={};this.Bhg={};this.vcf=15;this.h2d=!1;this.mjg=new Date;this.NPb=new Date;this.fe=O;this.aTb=new kc.a(2,2,6E4*this.vcf,Object(bd.a)(this,this.k6f,"writeMeasures"),135,"SL",
!1);this.fe.kh(this.aTb);this.oWh()}function La(){}function na(O,qa){var rb=this;this.documentVisibilityObserver=null;this.Oa=new pa.a;this.xw=null;this.Hab=this.bib=!1;this.lmc=null;this.FDb=!1;this.$nd=!0;this.M2d=this.m2d=this.$F=this.fjb=!1;this.sR=null;this.$=O;this.FOd=qa;this.CAd=O.Vb.yi("WebServiceCall","refreshToken");this.D5b=he.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");lg.a.instance.YPc(Object(bd.a)(this,this.uYe,"handleTokenExpired"));
lg.a.instance.WPc(Object(bd.a)(this,this.XXe,"handleOnTokenExpiring"));qa=this.$.fa;qa.Yj(Object(bd.a)(this,this.Vc,"onSessionIdChanged"));qa.nVb(Object(bd.a)(this,this.Hwa,"onOpenWorkbookFailed"));this.pii=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.bRf=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.xCf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.C3f(O.fa.bvf,Bd.AFrameworkApplication.jk);O=new Date;qa={};Tc.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",
(qa.AccessTokenTtl=Bd.AFrameworkApplication.jk,qa.NowGetTime=O.getTime(),qa.BootTime=Bd.AFrameworkApplication.Pfa,qa.WopiTokenExpiresAfterMinutes=Bd.AFrameworkApplication.SSd,qa.WopiTokenTaskItemPriority=Bd.AFrameworkApplication.VSd,qa));this.$.ea.$a(291,function(Sb){rb.documentVisibilityObserver=Sb})}function ma(O,qa){this.jTb=O;this.zR=qa}function xa(){return Pa.apply(this,arguments)||this}function Pa(){}function ib(){}function pb(O,qa){this.zDb=!1;this.correlationID=O;this.c_c=qa;this.Juc=!1;this.creationTime=
Zh.a.Qa.Gb}function xb(O){var qa=Ya.call(this)||this;qa.Oa=new pa.a;qa.fjb=!1;qa.$F=!1;qa.$=O;return qa}function Ya(){this.I9d=this.WKc=!1;var O=Bd.AFrameworkApplication.jk;if(!(0>=O)){this.jk=O;O=new Date;var qa={};Tc.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(qa.AccessTokenTtl=this.jk,qa.NowGetTime=O.getTime(),qa.BootTime=Bd.AFrameworkApplication.Pfa,qa));lg.a.instance.YPc(Object(bd.a)(this,this.BMa,"onSessionExpiredDetected"));lg.a.instance.WPc(Object(bd.a)(this,
this.ksf,"onSessionExpiringDetected"))}}function ab(O){var qa=Af.call(this)||this;qa.$=O;qa.Yb();return qa}function ea(O,qa,rb){rb=void 0===rb?null:rb;var Sb=Yf.call(this,qa)||this;Sb.sheetTabActivatePreviousHidden=Sc.a.instance.da(694);Sb.sheetTabActivateNextHidden=Sc.a.instance.da(696);Sb.svgIconProvider=null;Sb.gh=[];Sb.KJ=Array(6);Sb.Lqd=Array(6);Sb.Fk=null;Sb.iJd=null;Sb.prc=null;Sb.P$a=null;Sb.mrc=null;Sb.zG=null;Sb.Rub=null;Sb.uPa=null;Sb.isRtl=!1;Sb.hu=0;Sb.zJ=0;Sb.Cnc=!1;Sb.L2b=!1;Sb.sla=
0;Sb.Ckc=0;Sb.V2b=null;Sb.y9=null;Sb.C2=null;Sb.tL=null;Sb.TB=0;Sb.e9b=0;Sb.HIb=null;Sb.dxb=-1;Sb.TX=null;Sb.Mjc=0;Sb.dtc=-1;Sb.Oka=0;Sb.Pra=new Ra;Sb.HFc=!1;Sb.sZ=null;Sb.T9d=null;Sb.jJd=null;Sb.kJd=null;Sb.Dnc=null;Sb.$1d=!1;Sb.Ned=null;Sb.cqd=!1;Sb.S9d=null;Sb.$=O;Sb.fa=Sb.$.fa;Sb.uy=mg.a.y6e();Sb.d3b=Sb.uy&&!he.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");Sb.Ul=he.EwaSettings.ka(531);Sb.Fv=mg.a.Fjd();Sb.v8e=Sb.Ul;Sb.s1h=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5717930_EndEditViaSheetChangeTracking");
Sb.uy&&(Sb.$1d=Sb.Ul&&!zf.a.pu);Sb.dki=Sb.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;Sb.cki=Sb.$.ya.SheetTabNavigateButtonIntervalPeriodMS;Sb.B5g=Sb.$.ya.SheetTabDragStartPixelThreshold;Sb.bNa=-1;Sb.aNa=-1;Sb.VXc=!1;Sb.Fv&&(Sb.svgIconProvider=rb);Sb.oB=new ve.a(Sb.domElement,3);Sb.Ul&&Sb.domElement.classList.add(Wa.jeh);Sb.IVg();Sb.cTg();Sb.JVg();Sb.JWg();Sb.oqc(!0);Sb.jd(null,null);O=Sb.$.va;O.Pf(Object(bd.a)(Sb,Sb.Ai,"onActiveSheetChanged"));O.aVb(Object(bd.a)(Sb,Sb.S4,"onCleared"));O.oX(Object(bd.a)(Sb,
Sb.hC,"onSheetDeleted"));O.pfa(Object(bd.a)(Sb,Sb.aBb,"onSheetInserted"));O.MDa(Object(bd.a)(Sb,Sb.Owa,"onSheetRenamed"));O.Gfe(Object(bd.a)(Sb,Sb.Asf,"onSheetReordered"));O.VVa(Object(bd.a)(Sb,Sb.Csf,"onSheetVisibilityChanged"));O.Osg(Object(bd.a)(Sb,Sb.Bsf,"onSheetTabColorChanged"));O.zPc(Object(bd.a)(Sb,Sb.tjf,"onActiveItemLockChanged"));O.Dfe(Object(bd.a)(Sb,Sb.ujf,"onActiveItemLockPausedChanged"));O.Efe(Object(bd.a)(Sb,Sb.vjf,"onActiveItemNamedSheetViewModeChanged"));O.Ffe(Object(bd.a)(Sb,Sb.vMa,
"onItemNamedSheetViewSwitched"));Sb.$.Jk(Object(bd.a)(Sb,Sb.jd,"onWorkbookOpened"));Sb.$.hD(Object(bd.a)(Sb,Sb.fk,"onContentAreaResized"));ec.a(Sb.$).Og(Sb);Sb.$.ea.Ia(32,Sb);he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)&&Sb.$.fa.Vs(Object(bd.a)(Sb,Sb.Gf,"onWorkbookMetadataChanged"));Sb.orc=Sb.Hd.yd(Sb.domElement);Sb.orc.ja("keydown",Object(bd.a)(Sb,Sb.onKeyDown,"onKeyDown"));cf.a(Sb.$).Eq()&&Sb.qE(null,new Og.a(!0));cf.a(Sb.$).pg.qfa(Object(bd.a)(Sb,
Sb.qE,"onPartialInteractivityStatusChanged"));Hf.g(Sb.$).ffe(Object(bd.a)(Sb,Sb.Wzb,"onComponentRangePickerActiveStateChanged"));he.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Sb.orc.ja("mousedown",function(Uc){Uc.preventDefault()});rg.a.instance.pa(ed.a.dC,Sb.domElement,Object(bd.a)(Sb,Sb.X4,"onMouseWheel"));Sb.hJd=Sb.Hd.yd(Sb.Fk);Sb.hJd.ja("scroll",Object(bd.a)(Sb,Sb.onScroll,"onScroll"));Sb.tpj=De.a(function(){Sb.SZ()},200,Sb.$.la,md.a.ccj,!0);Sb.$.XD(Ue.a.Kij);
Sb.v8e&&(Sb.S9d=new Na(Sb.$,Sb.uPa.domElement));he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&rf.PageLoadTrackingInfo.instance.ala("sheetTabBar",["sheetTabBar"]);return Sb}function ta(O,qa,rb){qa=lb.call(this,document.createElement("a"),qa)||this;qa.Xfa=he.EwaSettings.ka(531)?hb.a.N3c:hb.a.ffh;rb.Ab(qa.domElement,Sc.a.instance.da(685),0,qa.Xfa,Sc.a.instance.da(685),u.a.lXc,!0);O.appendChild(qa.domElement);qa.rc.ja("contextmenu",function(Sb){yg.g(Sb)});return qa}
function Ka(O,qa,rb,Sb,Uc,vd,oe){var ef=lb.call(this,document.createElement("li"),O)||this;ef.UQf=0;ef.VQf=0;ef.MWc=0;ef.NWc=0;ef.i_c=.5;ef.dJd=!1;ef.tsa=!1;ef.uN=null;ef.Zyb=null;ef.uD=null;ef.DBc=null;ef.color=null;ef.f6e=!1;ef.Mcc=!1;ef.e1b="#BEBBB8";ef.bzc=null;ef.Vqe=new mb(ef,O);ef.Ul=vd;ef.Fv=oe;ef.Mwb=mg.a.Mwb(O);ef.Sgd=he.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!ef.Fv;ef.Ul?(ef.UQf=O.ya.SheetDragReorderDelayInMilliseconds,ef.VQf=O.ya.SheetDragReorderDelayInMillisecondsForTouch,
ef.MWc=18,ef.NWc=20):(ef.MWc=19,ef.NWc=22);ef.$=O;ef.qSb=Sb;ef.TQ=Uc;ef.V3a=Uc.whe();ef.WXg();ef.QRg();ef.Vdd=O.Vb.yi("UserAction",ef.name);ef.Thd=!1;mf.DOMElementExtensions.fo(ef.domElement,Ue.a.Zr,null,null);ef.domElement.appendChild(ef.anchor);ef.anchor.appendChild(ef.uD);ef.Sla=new Cf.a;O=new Fa(ef.sheet,ef.Ul,ef.Fv);ef.Sla.add(new Ha(ef.$,O));ef.$.fa.ZGb&&(O=new eb(ef.sheet,ef.Ul,ef.Fv),ef.Sla.add(new Ha(ef.$,O)));ef.Sgd||(O=new Ga(ef.sheet,ef.TQ.grc,function(){return ef.color?Ka.kKd(ef.color):
!1},ef.Fv),ef.Zyb=new Ha(ef.$,O),ef.Sla.add(ef.Zyb));ef.dva=ef.TQ.dva;ef.fcb();ef.jRi();ef.fme=new ve.a(ef.domElement,1);qa.insertBefore(ef.domElement,rb);uf.a(ef.$)&&ef.r3f(!0);return ef}function mb(O,qa){var rb=Xd.call(this,O.domElement)||this;rb.X9d=O;rb.$=qa;Tf.a.instance.pa(ed.a.zj,O.domElement,Object(bd.a)(rb,rb.Paa,"onDblClick"));fd.a.instance.pa(O.domElement,Object(bd.a)(rb,rb.Uk,"onContextMenu"));rb.rc.ja("keydown",Object(bd.a)(rb,rb.onKeyDown,"onKeyDown"));return rb}function Ha(O,qa){this.yoa=
this.t0=this.fza=this.Oj=null;this.n7e=!1;this.ILc=this.pma=this.Qqa=this.hga=this.Pqa=null;this.$=O;this.dataSource=qa;this.Fv=mg.a.Fjd()}function Ga(O,qa,rb,Sb){this.sheet=O;this.altText=Sc.a.instance.da(1825);this.brj=qa;this.ySf=rb;this.Fv=Sb}function Fa(O,qa,rb){this.Ul=qa;this.Fv=rb;this.sheet=O;this.altText=Sc.a.instance.da(1901)}function eb(O,qa,rb){this.Ul=qa;this.Fv=rb;this.sheet=O;this.altText=Sc.a.instance.da(1902)}function db(O,qa,rb){O=lb.call(this,document.createElement("a"),O,!0)||
this;O.Dqa=qa.Ab(O.domElement,Sc.a.instance.da(491),0,hb.a.Qdh,Sc.a.instance.da(491),u.a.UMh,O.disabled);O.domElement.classList.add(Wa.Tdh);rb.appendChild(O.domElement);O.$.fa.oo(Object(bd.a)(O,O.Ih,"onCommandUIGeneratedAndGridInteractive"));O.fQi();return O}function Na(O,qa){var rb=m.call(this,document.createElement("div"))||this;rb.$=O;rb.qoj=qa;rb.tsa=!1;rb.nJb=0;return rb}function kb(O,qa){this.sheetName=null;this.newSheetIndex=0;this.sheetName=O;this.newSheetIndex=qa}function Tb(O,qa,rb){var Sb=
lb.call(this,document.createElement("a"),qa)||this;Sb.$=qa;Sb.Xfa=he.EwaSettings.ka(531)?hb.a.N3c:hb.a.HGe;Sb.Yme=rb.Ab(Sb.domElement,Sc.a.instance.da(489),0,Sb.Xfa,Sc.a.instance.da(490),u.a.lXc);O.appendChild(Sb.domElement);Sb.rc.ja("contextmenu",function(Uc){yg.g(Uc)});Sb.rc.ja("mouseover",Object(bd.a)(Sb,Sb.DAb,"onMouseOverOrOut"));Sb.rc.ja("mouseout",Object(bd.a)(Sb,Sb.DAb,"onMouseOverOrOut"));Tf.a.instance.pa(ed.a.click,Sb.domElement,Object(bd.a)(Sb,Sb.Rc,"onClick"));Sb.Xwb=de.KeyInputManager.instance.Cr(Sb.domElement,
Object(bd.a)(Sb,Sb.Rc,"onClick"),Xf.a.Ph,Xf.a.W_);return Sb}function ha(O,qa,rb,Sb){Sb=void 0===Sb?!1:Sb;qa=lb.call(this,document.createElement("a"),qa,Sb)||this;qa.Xfa=he.EwaSettings.ka(531)?hb.a.N3c:hb.a.HGe;qa.Dqa=rb.Ab(qa.domElement,Sc.a.instance.da(487),0,qa.Xfa,Sc.a.instance.da(488),u.a.lXc,Sb);O.appendChild(qa.domElement);qa.rc.ja("contextmenu",function(Uc){yg.g(Uc)});he.EwaSettings.ka(531)||(qa.rc.ja("mouseover",Object(bd.a)(qa,qa.DAb,"onMouseOverOrOut")),qa.rc.ja("mouseout",Object(bd.a)(qa,
qa.DAb,"onMouseOverOrOut")));Tf.a.instance.pa(ed.a.click,qa.domElement,Object(bd.a)(qa,qa.Rc,"onClick"));qa.Xwb=de.KeyInputManager.instance.Cr(qa.domElement,Object(bd.a)(qa,qa.Rc,"onClick"),Xf.a.Ph,Xf.a.W_);he.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(Hf.g(qa.$).uc.Jm(Object(bd.a)(qa,qa.Rj,"onEditStarted")),Hf.g(qa.$).uc.Xr(Object(bd.a)(qa,qa.pj,"onEditEnded")));return qa}function lb(O,qa,rb){rb=void 0===rb?!1:rb;O=ia.call(this,O)||this;O.Dqa=null;O.Q7a=
null;O.$=qa;O.GW=rb;return O}function Wa(){}function Ra(){this.Sze=new Fi.a(!0);this.RBc=0}function Yb(O){return $h.call(this,O)||this}function oc(O){this.R5g=O}function zb(O){return fi.call(this,O)||this}function uc(O,qa,rb,Sb){this.menuId=null;this.LOa=-1;this.$=O;this.tableManager=qa;this.namedSheetViewPublic=rb;this.frame=this.$.frame;this.ga=Hf.g(this.$).ga;this.wa=this.ga.wa;this.ou=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Sb;this.tableStyleManager.cug(Object(bd.a)(this,
this.htf,"onTableStylesDataLoadSuccess"))}function P(O){var qa=Sf.call(this,O)||this;qa.gridView=Hf.g(O);qa.wa=qa.gridView.ga.wa;qa.Njc=qa.gridView.$b.Mk(qa.wa.activeCell).usedRange;O=qa.k3(qa.Njc.toString());qa.initializeAndShow(Sc.a.instance.da(705),Object(bd.a)(qa,qa.foj,"tableResizeDialogHandler"),O);return qa}function lc(O,qa){O=xe.call(this,O)||this;O.iza=qa;return O}function Ec(O,qa){O=Dd.call(this,O,Sc.a.instance.da(704))||this;O.iza=qa;return O}function tc(O,qa,rb){this.fwb=!1;this.sharedSheetRange=
qa;this.$=O;this.Kh=this.$.Vb.yi("UserAction","ConvertToRangeManager");this.tableName=rb}function cc(O,qa){this.zTd=null;this.ATd=0;this.Ui=null;this._state=0;this.sf=O;this.qAa=qa;this.Rt=this.xK;this.moveNext()}function Zb(O){this.tableName=null;this.tableName=O}function Aa(O,qa,rb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=O;this.optionType=qa;this.isPivotTable=rb}function Ia(O){this.originalRange=null;this.originalRange=O}function qb(O,qa){this.newName=this.oldName=
null;this.oldName=O;this.newName=qa}function wb(O,qa,rb,Sb){O=ic.call(this,O,rb)||this;O.hasHeaders=!1;O.isCreation=!1;O.hasHeaders=qa;O.isCreation=Sb;return O}function ic(O,qa){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=O;this.tableRange=Bf.l(O.Ranges[0],O.SheetName);this.styleIndex=qa}function Jb(O){this.autoFilterOptions=null;this.autoFilterOptions=O}function Ua(O,qa){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=O;this.sortType=qa}function $a(O){var qa=
Ld.call(this)||this;qa.tableStyleManager=null;qa.$=O;qa.Yb();return qa}function ua(O,qa,rb){var Sb=Hc.call(this)||this;var Uc={};Sb.JIi=(Uc.height="100%",Uc);Sb.DDb={};Sb.Wad=0;Sb.MFa=0;Sb.lastSyncTime=new Date;Sb.cca=-1;Sb.MM=null;Sb.Jka={};Sb.nK=null;Sb.YE={};Sb.vQa={};Sb.imc=null;Sb.k7e=!1;Sb.isInitialized=!1;Sb.p3a=!1;Sb.Ewb=!1;Sb.Yoc=null;Sb.iMe=!1;Sb.tIb=!1;Sb.stc=!1;Sb.$=O;Sb.Sa=qa;Sb.tableManager=rb;Sb.$.ea.Ia(329,Sb);Sb.HTc=Sb.Trb();Sb.$.Ka.NDa(Object(bd.a)(Sb,Sb.gtf,"onTableStyleGalleryMenuClosed"));
return Sb}function Ca(O,qa,rb,Sb,Uc,vd){this.headerRow=O;this.totalRow=qa;this.firstCol=rb;this.lastCol=Sb;this.KQ=Uc;this.rga=vd}function Sa(){}function Qb(){}function Hb(O){var qa=Nh.call(this)||this;qa.tableManager=null;qa.$=O;qa.Yb();return qa}function Db(O){var qa=Nc.call(this,Hf.g(O))||this;qa.smb=null;qa.Ttc=null;qa.D_=null;qa.umb=null;qa.Zhe=!1;qa.A2d=null;qa.xNb=0;qa.g1b=null;qa.$=O;qa.gridView=Hf.g(qa.$);qa.$.ea.Ia(66,qa);qa.dMb={};qa.ZWb(null,null);qa.$.va&&qa.$.va.Pf(Object(bd.a)(qa,qa.VAf,
"reAttachTableBehviors"));qa.ege(Object(bd.a)(qa,qa.ZWb,"attachTableResizeBehavior"));qa.$.fa.j1(Object(bd.a)(qa,qa.P4,"onApplicationModeChanged"));qa.gridView.ga.CF(Object(bd.a)(qa,qa.mh,"onActiveCellChanged"));qa.$.isEditMode&&qa.mh(null,null);return qa}function jc(O){var qa=ae.call(this,document.createElement("div"))||this;qa.GP=!1;qa.yvf=!1;qa.dhd=!1;qa.YNc=!1;qa.NFb=null;qa.$=O;qa.gridView=Hf.g(qa.$);qa.parentElement=qa.domElement;qa.parentElement.className=sb.oeh;qa.MIa=qa.gridView.Gi;qa.JJa=
!0;qa.XVh();qa.uzg();qa.Wnb(!1);Tc.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return qa}function sb(){}function fb(O,qa,rb,Sb){var Uc=uh.call(this,O)||this;Uc.MXf=[6];Uc.EXf=[26];Uc.$q=null;Uc.zdc=!1;Uc.Xvb=!1;Uc.t$=null;Uc.ss=null;Uc.gridView=qa;Uc.$=qa.$;Uc.tableManager=Sb;Uc.ga=qa.ga;Uc.Kb=qa.Kb;Uc.parentElement=O;Uc.YEg();zf.a.tr||zf.a.Uua||Ud.a.instance.pa(ed.a.pointerDown,Uc.t$,Object(bd.a)(Uc,Uc.onPointerDown,"onPointerDown"));Uc.xn=rb;Uc.Tjd=!1;Uc.TFc=
!1;Uc.tableManager.urg(Object(bd.a)(Uc,Uc.ukf,"onCancelEditTable"));return Uc}function Qa(O){var qa=Kc.call(this)||this;qa.$=O;qa.Yb();return qa}function cb(O){this.$=O;this.tXf={};this.jNd={};var qa=he.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",rb=this.oRe(qa);rb?(this.Hee(rb),this.$.fa.Wh?this.jbf():O.fa.oo(Object(bd.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive")),this.$.ea.Ia(388,this)):Tc.ULS.sendTraceTag(537151263,
0,15,"window[{0}].icons returned null.",qa)}function Ab(){}function gc(O){var qa=Ye.call(this)||this;qa.sparklineManager=null;qa.$=O;qa.Yb();return qa}function Lc(O,qa){O=Nc.call(this,O)||this;qa.Ia(240,O);return O}function Nc(O){var qa=ye.call(this)||this;qa.PR=[];qa.zbe=O;var rb=O.Ca;rb.Pp(Object(bd.a)(qa,qa.Be,"onBlockCacheItemChanged"));rb.nfa(Object(bd.a)(qa,qa.Be,"onBlockCacheItemChanged"));rb.ZUb(Object(bd.a)(qa,qa.Be,"onBlockCacheItemChanged"));rb.DF(Object(bd.a)(qa,qa.Vl,"onBlockCacheItemEvicted"));
O.$.va.uI(Object(bd.a)(qa,qa.Yn,"onActiveItemChanging"));O.$.wb.uI(Object(bd.a)(qa,qa.Yn,"onActiveItemChanging"));rb=Ol(O.ao);for(var Sb=rb.next();!Sb.done;Sb=rb.next()){Sb=Ol(Sb.value);for(var Uc=Sb.next();!Uc.done;Uc=Sb.next()){Uc=Ol(Uc.value);for(var vd=Uc.next();!vd.done;vd=Uc.next()){vd=vd.value;var oe=O.Ca.zk(vd.hashCode);qa.Be(qa,new qc.a(new tb.a(oe,vd.hashCode),null))}}}return qa}function yd(O){var qa=$g.call(this)||this;qa.$=O;qa.Yb();return qa}function Od(O,qa){this.Bd=!1;this.VX=qa.dT;
this.ariaLiveNotifier=O;this.YSd=new vb(O,qa);this.VX&&this.VX.MP?this.She():this.Uj()}function sa(O,qa,rb){this.$=qa;this.ariaLiveNotifier=O;this.YSd=new vb(O,qa);this.M5b=rb.L$c(this.$);this.M5b.Usg(Object(bd.a)(this,this.Cof,"onKeyboardInteractionStarted"))}function vb(O,qa){this.$=qa;this.ariaLiveNotifier=O}function Lb(O){var qa=Kg.call(this)||this;qa.$=O;qa.Yb();return qa}function rc(O,qa,rb,Sb,Uc){this.gridReadoutNotifier=null;this.q8a=!1;this.Fqa=this.qlb=null;this.$=qa;this.ariaLiveNotifier=
O;this.sparklineManager=Sb;this.tableManager=rb;this.sC=new Oc;this.m3a=rd.m3a();this.q8a=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.m3a&&(he.EwaSettings.GG()?this.gridReadoutNotifier=Uc:this.gridReadoutNotifier=qa.ea.Ba(244),Tc.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),rc.VNc=700);this.NWb=Qc.a.instance.create(Object(bd.a)(this,this.Oni,"onActiveCellTimerFinish"),rc.VNc,
md.a.e4i,!1);this.Uj()}function Oc(){this.activeItemName=null;this.k8e=!1;this.tableName=null;this.iYa=0;this.Rtc=!1}function Bb(){}function hc(O){switch(O){case 1:return 1386;case 2:return 1387;case 3:return 1388;case 4:return 1389;case 5:return 1390;case 6:return 1391;case 7:return 1392;case 8:return 1393;case 9:return 1394;case 10:return 1395;case 11:return 1396;case 12:return 1397;case 13:return 1398;case 14:return 1399;case 15:return 1400;case 16:return 1401;case 17:return 1402;case 18:return 1403;
case 19:return 1404;case 20:return 1405;case 21:return 1406;case 22:return 1409;case 23:return 1407;case 24:return 1408;case 25:return 1410;case 26:return 1411;case 27:return 1412;case 28:return 1413;default:return 1414}}function Pc(O){var qa=Xe.call(this)||this;qa.$=O;qa.Yb();return qa}function rd(O,qa){this.RZ=this.C5=this.nV=null;this.zha=qa;this.ZWg(O);this.XHi();he.EwaSettings.GG()&&O.ea.Ia(244,this)}function Id(O){var qa=Rg.call(this)||this;qa.$=O;qa.Yb();return qa}function Vd(O,qa,rb){this.$=
O;this.pda=document.createElement("div");this.pda.setAttribute(Ue.a.rO,Ue.a.hj);this.pda.className=Se.a.D3c;qa.insertBefore(this.pda,rb);this.Gea=document.createElement("div");this.Gea.setAttribute(Ue.a.rO,Ue.a.hj);this.Gea.className=Se.a.D3c;qa.insertBefore(this.Gea,this.pda);this.Rfg=Sc.a.instance.Ua(2);this.Jfa=document.createElement("div");this.Jfa.setAttribute(Ue.a.Od,Ue.a.Afa);this.Jfa.setAttribute(Ue.a.Bfa,Ue.a.hlb);this.Jfa.className=Se.a.D3c;qa.insertBefore(this.Jfa,this.Gea);this.register();
this.$.ea.Ia(211,this)}function He(O,qa){Yd.a.ma(qa)||(O.append(qa),O.append(Nd.dod))}function Nd(O){this.Loc=O||""}function Vc(O){var qa=Kd.call(this)||this;qa.$=O;qa.Yb();return qa}function fe(O){var qa=Hd.call(this)||this;qa.Amd=null;qa.$=O;Tc.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return qa}function Ee(){return Qf.call(this)||this}function lf(O){var qa=Jg.call(this)||this;qa.$=O;qa.Yb();return qa}function Da(O){var qa=Ag.call(this,document.documentElement,O)||this;qa.YA=
0;qa.VAg=[Uf.a.jYc,Uf.a.Brd,Uf.a.W9b,Uf.a.GZf,Uf.a.HEd,Uf.a.mTc,Uf.a.Z6c,Uf.a.TWe,Uf.a.xSc,Uf.a.QIb,Uf.a.Rij,Uf.a.Sbd,Uf.a.GUc,Uf.a.Oqb,Uf.a.fJd,Uf.a.NUc,Uf.a.OVf,Uf.a.fbf,Uf.a.QSc];qa.DBj=[Uf.a.W9b,Uf.a.Y4f,Uf.a.X4f,Uf.a.Z4f];qa.YIi=[Uf.a.W9b,Uf.a.vyf,Uf.a.wyf,Uf.a.zyf];qa.SIg=[Uf.a.pMe,Uf.a.SWe,Uf.a.X6c,Uf.a.V6c];qa.AIi=[Uf.a.jYc,Uf.a.Brd,Uf.a.mTc,Uf.a.Z6c,Uf.a.xSc,Uf.a.QIb,Uf.a.Sbd,Uf.a.GUc,Uf.a.Oqb,Uf.a.fJd,Uf.a.Qxf,Uf.a.NUc,Uf.a.QSc];var rb=Sc.a.instance.Ua(251);qa.X7i=qa.$.shortcutKeyManager.K7b(rb);
qa.mode=0;O.ea.Ia(15,qa);sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.Va(O.ea,21,137,1,"Postmessage.IHostPostmessenger"),function(Sb){Sb=Sb.result;Sb.En(Nb.a.sjb);Sb.xm(Nb.a.sjb,Object(bd.a)(qa,qa.OEb,"resumeFocusWithDirection"))},O.la);return qa}function fc(){this.ijb=this.J7d=this.Za=null;this.hm=!1}function Ib(O,qa,rb,Sb,Uc,vd,oe){this.qdb={};this.H0=O;this.Jfg=qa;this.dpa=new kd(Bd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),Bd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.jC.Sgc);this.Ipa=new kd(Bd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),Bd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.jC.Sgc);this.fig=rb;this.Sbe=Sb;this.smg={};this.GR=new ce;this.Xcg=Uc;this.nQb="";this.Vu=vd;this.gZd=oe;return this}function Ta(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function kd(O,qa,rb){this.task=
null;this.nac=O;this.bhi=qa;this.taskManager=rb;this.retryCount=this.Tub=0;this.pJc=this.nxb=null}function ce(){this._state=0;this.L4d=this.N4d=this.M4d=null;this.state=this.Fae=0;this.KEc=!1;return this}function dc(O,qa,rb,Sb,Uc){this.Xdg=6E4;this.J0e="inactive";this.yce="active";this.PW=!0;this.fe=O;this.adg=qa;this.nDc=rb;this.gTb=Sb;this.Ya=new Ke.a;Uc&&this.flj();this.B2d=this.JRe()}function ub(O,qa){this.qdb={};this.H0=O;this.kib=new pc(qa,this.Oyb.Sgc,"GetMoreInfo");this.Gp=new hd;return this}
function pc(O,qa,rb){this.gSb=this.Fi=null;this.fKc=0;this.ijg=O;this.fe=qa;this.mYd=rb}function xc(O,qa,rb,Sb,Uc,vd,oe,ef){this.La=O;this.Ng=qa;this.I9f=rb;this.h0=Sb;this.fe=Uc;this.nDc=vd;this.sdg=oe;this.VSb=ef}function hd(){this._state=0;this.ULc=this.Ghb=null;this.state=0;this.KEc=this.K0d=!1;return this}function Rc(){this._state=0}function ld(){this.qdb={}}function Wd(){this.Za=null}function ee(){this.yTa=null}function ne(O){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",
Bd.AFrameworkApplication.ha.appSettings.RoamingServiceHandlerWebServiceBase||"",O,Bd.AFrameworkApplication.Xi)}function Ad(O){var qa=new bf.a;Bd.AFrameworkApplication.Cd.Jl(ne(O),1,null,null,!0,2,function(rb){200===rb.data.httpStatus?qa.setResult("true"===rb.data.ae.toLowerCase()):qa.setResult(!1)},function(){qa.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return qa.task}function se(O,qa){this.La=O;this.ZLb=qa}function Ve(O){var qa=Fc.call(this,!1,!1,!0)||this;qa.ZLb=O;return qa}function Zf(O,
qa){this.ID=O;this.type=qa}function Pf(O,qa){this.value=O;this.contextId=qa}function Fe(O,qa,rb,Sb,Uc,vd,oe,ef){this.type=O;this.startTime=null==rb||void 0==rb.value?new Pf(rb,null):rb;this.endTime=null==Sb||void 0==Sb.value?new Pf(Sb,null):Sb;null!=Uc&&void 0!=Uc.value||new Pf(Uc,null);null!=vd&&void 0!=vd.value||new Pf(vd,null);this.operationType=ef}function me(O){this.ID=O}function ng(){this.Je=[];this.Tkb=[];this.LQc=0;this.duration=this.startTime=null;this.k3b={};this.npd=this.Rpd=this.cSc=-1}
b.r(F);var Oe=b(0),bd=b(37),ac=b(140),Fc=ac.a;Em(Ve,Fc);Ve.prototype.start=function(){var O={},qa={};O=(qa.id="AccessibilitySettingsDialog",qa.bodyControls=(O.tooltipPersistenceEnabled=this.ZLb.T_e,O),qa);this.initializeAndShow("",Object(bd.a)(this,this.i_i,"resultHandler"),O)};Ve.prototype.i_i=function(O,qa){1===O&&(this.ZLb.T_e=qa.tooltipPersistenceEnabled)};Object(Oe.a)(Ve,"AccessibilitySettingsDialog",ac.a,[]);var Zc=b(108),pd=b(28);se.prototype.Lg=function(){this.La.Xb(pd.a.mfj,Zc.a.frame,Object(bd.a)(this,
this.nfj,"showAccessibilitySettingsDialogHandler"))};se.prototype.nfj=function(){(new Ve(this.ZLb)).start();return 32};Object(Oe.a)(se,"AccessibilitySettingsDialogActor",null,[241]);var bf=b(139),Bd=b(5),Qe=b(213);ee.prototype.Zai=function(){var O=this,qa=new bf.a;if(this.yTa)qa.setResult(this.yTa);else if(this.$7e()){var rb=Ad("getHoverableRibbonTooltipIsEnabled");rb.continueWith(function(){O.yTa=rb.result;Qe.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(rb.result);
qa.setResult(rb.result)},8)}else qa.setResult(!1)};ee.prototype.$7e=function(){var O=Bd.AFrameworkApplication.ha.sa("IsRoamingServiceEnabled"),qa=Bd.AFrameworkApplication.ha.sa("IsAnonymousUser");return O&&!qa};Ll.Object.defineProperties(ee.prototype,{T_e:{configurable:!0,enumerable:!0,get:function(){return!!this.yTa},set:function(O){O!==this.yTa&&(this.yTa=O,Qe.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(O),this.$7e()&&Bd.AFrameworkApplication.Cd.Jl(ne("saveHoverableRibbonTooltipIsEnabled"),
2,O.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(Oe.a)(ee,"AccessibilitySettingsInfo",null,[240]);var Ob=b(276),yc=b(166);Wd.prototype.Qh=function(O){var qa=this;this.Za=O;Wd.Y4e()&&(this.Za.register(ee,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Fc(function(){return new ee}).wc(),this.Za.register(se,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Fc(function(){return new se(Bd.AFrameworkApplication.Hb,
qa.Za.Mh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).wc())};Wd.prototype.init=function(){if(Wd.Y4e()){var O=this.Za.Mh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),qa=this.Za.Mh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");O&&qa?(qa.Lg(),O.Zai()):yc.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}};Wd.prototype.dispose=function(){};Wd.main=function(){Ob.a.instance.ej(new Wd)};
Wd.Y4e=function(){Wd.jFc||(Wd.jFc=Bd.AFrameworkApplication.ha?Bd.AFrameworkApplication.ha.sa("AccessibilitySettingsDialogIsEnabled")&&Bd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AccessibilitySettingsDialogIsEnabled",!1):!1);return Wd.jFc};Ll.Object.defineProperties(Wd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Wd.jFc=null;Object(Oe.a)(Wd,"AccessibilitySettingsPackage",null,[8,9]);var id=b(675),Tc=
b(15);ld.prototype.bng=function(O){this.qdb[O.id.toString()]=O};ld.prototype.Bli=function(O){var qa=this.qdb,rb;for(rb in qa)qa[rb].notify(O,!1);this.qdb={}};ld.prototype.GKi=function(O,qa){qa&&this.bng(qa);return this.urf(O,qa)};ld.prototype.n2c=function(O){this.Bli(O)};ld.prototype.zCe=function(O,qa){O.notify(qa,!0)};Object(Oe.a)(ld,"AEventEmitter",null,[375]);var od;(function(O){O[O.notStarted=0]="notStarted";O[O.waiting=1]="waiting";O[O.shouldRetry=2]="shouldRetry";O[O.complete=3]="complete"})(od||
(od={}));Object(Oe.b)("EventResultState",od);Ll.Object.defineProperties(Rc.prototype,{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(O){var qa={};Tc.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(qa.OldState=od[this._state],qa.NewState=od[O],qa),"ResultType",this.XTe());this._state=O}}});Object(Oe.a)(Rc,"AEventResult",null,[489]);Em(hd,Rc);hd.prototype.XTe=function(){return"GetMoreInfo Result"};Ll.Object.defineProperties(hd.prototype,{$U:{configurable:!0,
enumerable:!0,get:function(){return this.Ghb}},$ya:{configurable:!0,enumerable:!0,get:function(){return this.ULc}},eYh:{configurable:!0,enumerable:!0,get:function(){return this.K0d}}});Object(Oe.a)(hd,"GetMoreInfoResult",Rc,[488,489]);var mc=b(78),Le=b(48),we=b(789),za=b(519),Nb=b(178),bb=b(678),Ub=b(590);xc.prototype.UPi=function(){this.Q5a.Xb(pd.a.openUrlInNewTab,Zc.a.frame,Object(bd.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.Q5a.Xb(pd.a.JMa,Zc.a.frame,Object(bd.a)(this,this.JMa,"openDocumentUrl"));
Bd.AFrameworkApplication.eP?this.zcf():this.Q5a.Af(pd.a.K2b,Zc.a.frame,Object(bd.a)(this,this.K2b,"documentLoaded"),96)};xc.prototype.openUrlInNewTab=function(O,qa,rb,Sb,Uc){Uc&&Uc.MenuItemId&&(O={},Tc.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",(O.Id=Uc.SourceControlId,O.AppType=Ub.a[this.Faa],O)),Le.a.lf(Uc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};xc.prototype.JMa=function(O,qa,rb,Sb,Uc){if(Uc&&Uc.MenuItemId){var vd=Bd.AFrameworkApplication.ha.sa("WacInTabOpenMRUIsEnabledForUiHost"),
oe=Bd.AFrameworkApplication.ha.sa("UiHostSupportsDocRebootFeatures");Tc.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",vd,oe);if(vd&&oe){O={};Tc.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(O.Id=Uc.SourceControlId,O.AppType=Ub.a[this.Faa],O));Uc=Uc.MenuItemId.toString();var ef={};ef[za.a.GNa]="1";ef[za.a.documentUrl]=Uc;ef[za.a.reason]=bb.a.open;Tc.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");
Bd.AFrameworkApplication.yY().execute(function(Nf){Nf.Vj(Nb.a.Vra,ef)})}else this.openUrlInNewTab(O,qa,rb,Sb,Uc)}return 32};xc.prototype.K2b=function(){this.zcf();return 32};xc.prototype.xLa=function(O,qa,rb){rb=void 0===rb?"":rb;if(qa&&qa.bE){var Sb=we.a[qa.status];qa=qa.bE.getTime();var Uc=this.wv()-qa,vd={};Tc.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(vd.Caller=O,vd.RequestStatus=Sb,vd.ElapsedMs=Uc,vd.StartTime=qa,vd.Notes=rb,vd))}else rb={},Tc.ULS.sendTraceTag(5849680,
202,50,"Attempted to make a request to the WAC server with null request item {0}",(rb.Caller=O,rb))};xc.prototype.zcf=function(){var O=Bd.AFrameworkApplication.ha.sa("QPGVCI"),qa=mc.a.Vz(document.URL,"wdNewAndOpenCt",O);if(qa){qa=parseInt(qa);var rb=mc.a.Vz(document.URL,"wdPreviousSession",O);O=mc.a.Vz(document.URL,"wdPreviousCorrelation",O);var Sb=Bd.AFrameworkApplication.ha.sa("NAOPLP");if(Bd.AFrameworkApplication.eP){var Uc=Bd.AFrameworkApplication.eP.getTime();if(!qa||qa>Uc)Sb={},Tc.ULS.sendTraceTag(5849682,
202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",(Sb.ClickTimestamp=qa,Sb.DocumentLoadedTime=Uc,Sb.SessionId=rb,Sb.Correlation=O,Sb));else{var vd={};Tc.ULS.sendTraceTag(5849683,202,Sb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(vd.ClickToLoadTime=Uc-qa,vd.ClickTimestamp=qa,vd.SessionId=rb,vd.Correlation=O,vd))}}else Uc={},Tc.ULS.sendTraceTag(5849681,202,Sb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
(Uc.ClickTimestamp=qa,Uc.SessionId=rb,Uc.Correlation=O,Uc))}};xc.MT=function(){return new xc(new id.a(function(){return Bd.AFrameworkApplication.Hb}),new id.a(function(){return Bd.AFrameworkApplication.Cd}),new id.a(function(){return Bd.AFrameworkApplication.xa}),new id.a(function(){return Bd.AFrameworkApplication.xa.Xa.Tk}),new id.a(function(){return Bd.AFrameworkApplication.sj}),function(){return(new Date).getTime()},new id.a(function(){return Bd.AFrameworkApplication.xa.Xa.vZ}),new id.a(function(){return Bd.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};
Ll.Object.defineProperties(xc.prototype,{Q5a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},dzb:{configurable:!0,enumerable:!0,get:function(){return this.Ng.value}},ohf:{configurable:!0,enumerable:!0,get:function(){return this.I9f.value}},Faa:{configurable:!0,enumerable:!0,get:function(){return this.h0.value}},Sgc:{configurable:!0,enumerable:!0,get:function(){return this.fe.value}},wv:{configurable:!0,enumerable:!0,get:function(){return this.nDc}},vZ:{configurable:!0,enumerable:!0,
get:function(){return this.sdg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.VSb.value}}});Ll.Object.defineProperties(xc,{instance:{configurable:!0,enumerable:!0,get:function(){return xc.Ma||(xc.Ma=xc.MT())}}});xc.Ma=null;Object(Oe.a)(xc,"NewAndOpenCommonHelpers",null,[374]);var kc=b(109);pc.prototype.Rvg=function(){this.fKc=this.I9a+1};pc.prototype.YDd=function(O){this.Fi&&(this.fe.cp(this.Fi),this.Fi=null);O&&(this.fKc=0)};pc.prototype.nlj=
function(O){var qa=this.kqj;0<=qa?(this.Rvg(),this.YDd(!1),this.Fi=new kc.a(4,1,qa,O,107),this.fe.kh(this.Fi)):(this.YDd(!0),O={},Tc.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(O.Action=this.mYd,O)))};Ll.Object.defineProperties(pc.prototype,{I9a:{configurable:!0,enumerable:!0,get:function(){return this.fKc}},kqj:{configurable:!0,enumerable:!0,get:function(){return this.I9a>=this.EMf.length?-1:this.EMf[this.I9a]}},EMf:{configurable:!0,enumerable:!0,get:function(){if(!this.gSb){var O=(this.ijg.value||
"0").split(",");this.gSb=[];for(var qa=0;qa<O.length;qa++){var rb=parseInt(O[qa]);isNaN(rb)?(rb={},Tc.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",(rb.Action=this.mYd,rb.Entry=O[qa],rb))):Array.add(this.gSb,rb)}}return this.gSb}}});Object(Oe.a)(pc,"RetryHelper",null,[]);var ad=b(41),Qd=b(30);Em(ub,ld);ub.prototype.Efi=function(){this.Vod("Document opened")};ub.prototype.oVg=function(O){var qa=this;return function(){qa.Vod(O,!0)}};ub.prototype.urf=function(O,
qa){qa=void 0===qa?null:qa;var rb={};Tc.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(rb.Trigger=O,rb));3===this.Gp.state?(qa&&this.zCe(qa,this.Gp),qa={},Tc.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(qa.Trigger=O,qa))):this.Vod(O);return this.Gp};ub.prototype.Vod=function(O,qa){this.kib.YDd(!(void 0===qa?0:qa));1===this.Gp.state?(qa={},Tc.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
(qa.Trigger=O,qa.RetryIndex=this.kib.I9a,qa))):(qa={},Tc.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(qa.Trigger=O,qa.RetryIndex=this.kib.I9a,qa)),this.Gp.state=1,qa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Oyb.vZ,Bd.AFrameworkApplication.Xi),this.Oyb.dzb.l8(qa,1,null,null,[ub.L6d,ub.M$d],!1,5,this.qUg(),this.pUg(O),null))};ub.prototype.qUg=function(){var O=this;return function(qa){var rb=!1,Sb=!1,Uc=!1;if(Bd.AFrameworkApplication.ha.sa("GetMoreInfoDataFromResponseBody"))if(qa.data.ae){var vd=
ad.d(qa.data.ae);var oe=vd.eu;vd.returnValue?oe?(Uc=!0,O.Gp.ULc=oe.StorageServiceDisplayName,O.Gp.Ghb=ub.x9e(oe.PersonalFileStorageUrl)?oe.PersonalFileStorageUrl:"",""===O.Gp.$U&&"SharePointOnlineConsumer"===Bd.AFrameworkApplication.ha.Ta("FileSource")&&(O.Gp.Ghb=Bd.AFrameworkApplication.breadcrumbFolderUrl),rb=""===O.Gp.$U&&""!==O.Gp.$ya):Tc.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
Tc.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else Tc.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");Uc||((oe=qa.data.responseHeaders)?(O.Gp.ULc=(oe[ub.M$d]||"").toString(),rb=(oe[ub.L6d]||"").toString(),O.Gp.Ghb=ub.x9e(rb)?rb:"",""===O.Gp.$U&&"SharePointOnlineConsumer"===Bd.AFrameworkApplication.ha.Ta("FileSource")&&
(O.Gp.Ghb=Bd.AFrameworkApplication.breadcrumbFolderUrl),rb=""===rb&&""!==O.Gp.$ya):(Tc.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Sb=!0));Uc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",O.kib.I9a,Sb,rb,Uc);O.Oyb.xLa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",qa.data,Uc);O.XMf(3,rb,Sb)}};ub.prototype.pUg=function(O){var qa=this;return function(rb){qa.Oyb.xLa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
rb.data,"Failure");qa.XMf(2);qa.kib.nlj(qa.oVg(O))}};ub.prototype.XMf=function(O,qa,rb){this.Gp.state=O;this.Gp.K0d=void 0===qa?!1:qa;this.Gp.KEc=void 0===rb?!1:rb;this.n2c(this.Gp)};ub.MT=function(){return new ub(new id.a(function(){return xc.instance}),new id.a(function(){return Bd.AFrameworkApplication.tDh}))};ub.x9e=function(O){if(!O)return Tc.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(Qd.a.$m(O).startsWith("https://"))return!0;Tc.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1};Ll.Object.defineProperties(ub.prototype,{Oyb:{configurable:!0,enumerable:!0,get:function(){return this.H0.value}}});Ll.Object.defineProperties(ub,{instance:{configurable:!0,enumerable:!0,get:function(){return ub.Ma||(ub.Ma=ub.MT())}}});ub.L6d="PersonalFileStorageUrl";ub.M$d="StorageServiceDisplayName";ub.Ma=null;Object(Oe.a)(ub,"GetMoreInfoActor",ld,[]);var We=b(98),Ke=b(94);dc.prototype.qde=function(O){this.Ya.addHandler(this.yce,O)};dc.prototype.rpg=
function(O){this.Ya.addHandler(this.J0e,O)};dc.prototype.flj=function(){var O=new kc.a(5,2,this.Xdg,Object(bd.a)(this,this.yTh,"inactiveLoop"),108);this.zTh.kh(O)};dc.prototype.yTh=function(){var O=this.JRe(),qa=this.wv()-O;if(qa>this.yuc&&this.PW){var rb={};Tc.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(rb.TimeSinceLastActive=qa,rb));this.PW=!1;this.Ya.raiseEvent(this.J0e)}O-this.B2d>this.yuc&&(this.PW=!0,this.Ya.raiseEvent(this.yce));this.B2d=O};dc.MT=function(){return new dc(new id.a(function(){return We.a.instance}),
function(){return Bd.AFrameworkApplication.taf.getTime()},function(){return(new Date).getTime()},new id.a(function(){return Bd.AFrameworkApplication.yuc}),!0)};Ll.Object.defineProperties(dc.prototype,{zTh:{configurable:!0,enumerable:!0,get:function(){return this.fe.value}},JRe:{configurable:!0,enumerable:!0,get:function(){return this.adg}},wv:{configurable:!0,enumerable:!0,get:function(){return this.nDc}},yuc:{configurable:!0,enumerable:!0,get:function(){return this.gTb.value}}});Ll.Object.defineProperties(dc,
{instance:{configurable:!0,enumerable:!0,get:function(){return dc.Ma||(dc.Ma=dc.MT())}}});dc.Ma=null;Object(Oe.a)(dc,"InactivityManager",null,[]);var nf=b(83),Pe=b(1028);Em(ce,Rc);ce.prototype.XTe=function(){return"MruActor Result"};Ll.Object.defineProperties(ce.prototype,{mqd:{configurable:!0,enumerable:!0,get:function(){return this.M4d}},Ggf:{configurable:!0,enumerable:!0,get:function(){return this.N4d}},lqd:{configurable:!0,enumerable:!0,get:function(){return this.L4d}},oqj:{configurable:!0,enumerable:!0,
get:function(){return this.Fae}}});Object(Oe.a)(ce,"MruResult",Rc,[490,489]);var hf=b(231);kd.prototype.w4h=function(O,qa){return O===hf.a.N6c||20===qa||18===qa||3===qa};kd.prototype.C5h=function(O){return 3===O||5===O||6===O||7===O||9===O||10===O||11===O||12===O||13===O||14===O||15===O||16===O||23===O||26===O||27===O||28===O};kd.prototype.reset=function(){this.Tub=this.retryCount=0;this.pJc=this.nxb=null;this.task&&(this.taskManager.cp(this.task),this.task=null)};kd.prototype.kXh=function(O,qa,rb,
Sb){this.pJc=String.format("{0}_{1}",rb,Sb);if(this.retryCount>=this.bhi)return Tc.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.w4h(rb,Sb))return Tc.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.C5h(Sb)&&1<=this.Tub)return this.nxb=rb,!1;qa=Math.max(qa,this.nac*Math.pow(2,this.Tub));if(26===Sb)qa=Math.max(qa,3E4);else if(27===Sb||28===Sb)qa=Math.max(qa,6E4);9===Sb||412===rb&&(null==this.nxb||412!==this.nxb)?qa=500:this.Tub+=1;this.nxb=
rb;this.retryCount+=1;this.task&&this.taskManager.cp(this.task);Tc.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",qa);this.task=new kc.a(2,1,qa,O,107);this.taskManager.kh(this.task);return!0};Ll.Object.defineProperties(kd.prototype,{mlc:{configurable:!0,enumerable:!0,get:function(){return this.pJc}}});Object(Oe.a)(kd,"RetryManager",null,[]);var Vf=b(93);Object(Oe.a)(Ta,"WriteOptions",null,[]);var Sg=b(575),wg=b(177);Em(Ib,ld);Ib.prototype.yRi=function(){this.jC.Q5a.Xb(pd.a.renameMostRecentlyUsedFileEntry,
Zc.a.frame,Object(bd.a)(this,this.qWi,"renameMruEntry"))};Ib.prototype.qWi=function(){return this.dTd("Rename")};Ib.prototype.Mfi=function(){this.Hef("File Opened")};Ib.prototype.Nfi=function(){this.Hef("IntervalUpdate")};Ib.prototype.Hef=function(O){var qa={};Tc.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(qa.Trigger=O,qa));this.dTd(O)};Ib.prototype.g3=function(O){(O=Qd.a.g3(O))&&O.startsWith(".")&&(O=O.substring(1,O.length));return O};Ib.prototype.aOe=function(){switch(this.jC.Faa){case 3:return"Word";
case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};Ib.prototype.OKh=function(O){var qa=this.Xcg();if(!qa)return null;var rb=new Ta;rb.documentUrl=this.gZd.value?encodeURI(qa):qa;rb.mruItemId=this.nQb;rb.app=this.aOe();if(qa=this.Vu())rb.folderName=qa.breadcrumbFolderName,qa=qa.fn,rb.documentName=Qd.a.Bq(qa),rb.documentExt=this.g3(qa);O&&(rb.documentName?rb.documentName.length?255<=rb.documentName.length?O.set("DocumentNameLength","Long"):
2084<=rb.documentName.length&&O.set("DocumentNameLength","VeryLong"):O.set("DocumentNameLength","0"):O.set("DocumentNameLength","Null"));return JSON.stringify(rb)};Ib.prototype.dTd=function(O,qa){qa=void 0===qa?!1:qa;if(4===this.jC.Faa&&!Bd.AFrameworkApplication.AGa)return 2;var rb=this.fs();rb&&(rb.set("Trigger",O),rb.set("IsRetry",qa?"true":"false"),rb.set("MruIdSent",this.nQb?"true":"false"),rb.set("URLEncoded",this.gZd.value?"true":"false"));Vf.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",
rb);O=this.OKh(rb);if(!O)return qa=!Bd.AFrameworkApplication.webEditingEnabled,rb&&(rb.set("WebEditingIsEnabled",Bd.AFrameworkApplication.webEditingEnabled?"true":"false"),rb.set("ProtectedFile",Bd.AFrameworkApplication.wlc?"true":"false")),Vf.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",qa,!1,Object.assign(new wg.a,{extendedProperties:rb})),2;this.Ipa&&!qa&&this.Ipa.reset();rb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.jC.vZ,this.localeName);this.Sbe?this.yxc["X-FileId"]=
Bd.AFrameworkApplication.Xi:rb+=String.format("&{0}",Bd.AFrameworkApplication.Xi);Bd.AFrameworkApplication.Fb&&(this.yxc["X-Office-AudienceGroup"]=Object(nf.a)(String,Bd.AFrameworkApplication.Fb.AudienceGroup)||"");this.yxc["X-Timeout"]=Bd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteTimeout",1E4);return this.jC.dzb.Jl(rb,2,O,this.yxc,!0,5,Object(bd.a)(this,this.tDj,"writeMruV2EntryOnServerSuccessCallback"),Object(bd.a)(this,this.WYg,"createWriteMruV2EntryOnServerFailureCallback"),
null,void 0,void 0,void 0,void 0,"4")};Ib.prototype.tDj=function(O){this.WXe(O.data)};Ib.prototype.WXe=function(O){var qa=this.fs();this.Ipa&&(qa&&this.Ipa.mlc&&(qa.set("LastError",this.Ipa.mlc),qa.set("NumRetries",this.Ipa.retryCount.toString())),this.Ipa.reset());var rb=Pe.c(O.ae);rb&&rb.diagnostics_data&&(this.nQb=rb.diagnostics_data.mru_id);O=+O.a2-+O.bE;qa&&qa.set("RequestDuration",O.toString());Vf.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new wg.a,{extendedProperties:qa}))};
Ib.prototype.WYg=function(O){if(O.data.httpStatus===hf.a.tob)this.WXe(O.data);else{var qa=O.data.httpStatus===hf.a.yCb,rb=this.fs();this.fYe(this.Ipa,O,this.MYg(),rb);rb&&(rb.set("StatusCode",O.data.httpStatus.toString()),qa||this.BOc(O.data,rb));Vf.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",O.data.httpStatus),qa,!1,Object.assign(new wg.a,{extendedProperties:rb}))}};Ib.prototype.MYg=function(){var O=this;return function(){O.dTd("Retry",!0)}};Ib.prototype.zDh=function(){this.Ofc("Polling")};
Ib.prototype.yDh=function(){this.Ofc("Retry",!0)};Ib.prototype.Gfi=function(){this.Ofc("Open")};Ib.prototype.Ffi=function(){this.Ofc("Activity")};Ib.prototype.Ofc=function(O,qa){qa=void 0===qa?!1:qa;var rb={};Tc.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(rb.Trigger=O,rb));if(rb=this.fs())rb.set("Trigger",O),rb.set("IsRetry",qa?"true":"false");Vf.Health.instance.recordKpiUsage("GetMru",0,"smartfio",rb);this.dpa&&!qa&&this.dpa.reset();this.rUg(Object(bd.a)(this,this.ADh,"getMruV2FromServerSuccessCallback"),
Object(bd.a)(this,this.xDh,"getMruFromServerFailureCallback"))};Ib.prototype.BOc=function(O,qa){O&&O.responseHeaders&&(O=O.responseHeaders["X-CorrelationId"])&&qa.set("ServerCorrelationId",O)};Ib.prototype.fs=function(){try{return new Map}catch(O){return null}};Ib.prototype.Rci=function(O,qa){O&&(qa&&qa.set("RequestDuration",(+O.a2-+O.bE).toString()),Vf.Health.instance.recordKpiSuccess("GetMru",Object.assign(new wg.a,{extendedProperties:qa})))};Ib.prototype.ADh=function(O){var qa="",rb=null,Sb=null,
Uc=null,vd=Pe.c(O.data.ae);vd&&(rb=vd.places?vd.places.items:[],Sb=vd.documents?vd.documents.items:[],(Uc=Pe.a(vd))&&(qa=ad.c(Uc)));Bd.AFrameworkApplication.xa&&Bd.AFrameworkApplication.xa.Xa.YY&&Qe.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(qa,!0));qa=this.fs();this.dpa&&(qa&&this.dpa.mlc&&(qa.set("LastError",this.dpa.mlc),qa.set("NumRetries",this.dpa.retryCount.toString())),this.dpa.reset());Uc||rb||Sb?(this.jC.xLa("MruActor.GetMruV2FromServerSuccessCallback",
O.data,"Success"),this.gwc(3,Uc,rb,Sb),this.Rci(O.data,qa)):(this.jC.xLa("MruActor.GetMruV2FromServerSuccessCallback",O.data,"Failure: Invalid JSON"),qa&&this.BOc(O.data,qa),Vf.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new wg.a,{extendedProperties:qa})),this.gwc(3,null,null,null,!0));this.n2c(this.GR)};Ib.prototype.fYe=function(O,qa,rb,Sb){var Uc=0,vd=0,oe=Pe.c(qa.data.ae);oe&&(null!=oe.response_code&&(Uc=oe.response_code,Sb&&Sb.set("MruResponseCode",Uc.toString()),
9===Uc&&(this.nQb="")),oe.error_data&&null!=oe.error_data.retry_after_ms&&(vd=oe.error_data.retry_after_ms,Sb&&Sb.set("ExpectedRetryAfter",vd.toString())));O&&(qa=O.kXh(rb,vd,qa.data.httpStatus,Uc),Sb&&(Sb.set("CurrentRetryCount",O.retryCount.toString()),Sb.set("RetryScheduled",qa?"true":"false")))};Ib.prototype.xDh=function(O){var qa=O.data.httpStatus===hf.a.yCb,rb=this.fs();rb&&(rb.set("StatusCode",O.data.httpStatus.toString()),qa||this.BOc(O.data,rb));this.jC.xLa("MruActor.GetMruFromServerFailureCallback",
O.data,"Failure");this.gwc(2);this.fYe(this.dpa,O,Object(bd.a)(this,this.yDh,"getMruFromServerRetryTask"),rb);Vf.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",O.data.httpStatus),qa,!1,Object.assign(new wg.a,{extendedProperties:rb}));this.n2c(this.GR);Bd.AFrameworkApplication.xa&&Bd.AFrameworkApplication.xa.Xa.YY&&Qe.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1))};Ib.prototype.gwc=function(O,qa,rb,Sb,Uc){if(3!==this.GR.state||
3===O)this.GR.M4d=void 0===qa?null:qa,this.GR.N4d=void 0===rb?null:rb,this.GR.L4d=void 0===Sb?null:Sb,this.GR.state=O,this.GR.KEc=void 0===Uc?!1:Uc,this.GR.Fae=this.jC.wv()};Ib.prototype.urf=function(O,qa){var rb={};Tc.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(rb.Trigger=O,rb.ResultState=this.GR.state,rb));qa&&3===this.GR.state&&this.zCe(qa,this.GR);return this.GR};Ib.prototype.rUg=function(O,qa){this.gwc(1);var rb={};var Sb=String.format(this.jC.vZ+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",
10,this.aOe(),this.localeName);this.fig.value||(Sb+="&entity=docs");Bd.AFrameworkApplication.Fb&&(rb["X-Office-AudienceGroup"]=Object(nf.a)(String,Bd.AFrameworkApplication.Fb.AudienceGroup)||"");this.Sbe?rb["X-FileId"]=Bd.AFrameworkApplication.Xi:Sb+=String.format("&{0}",Bd.AFrameworkApplication.Xi);this.jC.dzb.Jl(Sb,1,null,rb,!0,5,O,qa,null)};Ib.MT=function(){return new Ib(new id.a(function(){return xc.instance}),new id.a(function(){return Sg.a.eJ(Bd.AFrameworkApplication.lcid).name}),new id.a(function(){return Bd.AFrameworkApplication.xa.Xa.qu}),
Bd.AFrameworkApplication.ha.sa("MruWriteFileIdInHeader"),function(){return Bd.AFrameworkApplication.xa.Xa.rB},function(){return Bd.AFrameworkApplication.nl},new id.a(function(){return Bd.AFrameworkApplication.ha.sa("OICEncodeUrlIsEnabled")}))};Ll.Object.defineProperties(Ib.prototype,{yxc:{configurable:!0,enumerable:!0,get:function(){return this.smg}},jC:{configurable:!0,enumerable:!0,get:function(){return this.H0.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.Jfg.value}}});
Ll.Object.defineProperties(Ib,{instance:{configurable:!0,enumerable:!0,get:function(){return Ib.Ma||(Ib.Ma=Ib.MT())}}});Ib.Ma=null;Object(Oe.a)(Ib,"MruActor",ld,[]);fc.prototype.Qh=function(O){this.Za=O;O.register(374,"Common.INewAndOpenCommonHelpers").wc().Fc(function(){return xc.instance});O.register(375,"Common.IEventEmitter<Common.IGetMoreInfoResult>").wc().Fc(function(){return ub.instance});O.register(375,"Common.IEventEmitter<Common.IMruResult>").wc().Fc(function(){return Ib.instance})};fc.prototype.init=
function(){var O=this;Bd.AFrameworkApplication.ha.Dv(function(){O.Cub()})};fc.prototype.Cub=function(){this.Za.resolve("Common.INewAndOpenCommonHelpers");this.Za.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Za.resolve("Common.IEventEmitter<Common.IMruResult>");var O=!1;xc.instance.UPi();Bd.AFrameworkApplication.Vja&&(O=!0);Bd.AFrameworkApplication.zBf&&(Ib.instance.Gfi(),0<Bd.AFrameworkApplication.Hgf&&this.Tde(),this.obj(),O=!0);Bd.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&
O&&ub.instance.Efi();Bd.AFrameworkApplication.Wxj&&(O=Ib.instance,O.yRi(),O.Mfi(),We.a.instance.kh(this.Xxj))};fc.prototype.obj=function(){dc.instance.qde(Object(bd.a)(Ib.instance,Ib.instance.Ffi,"makeGetMruRequestActivityTrigger"));dc.instance.qde(Object(bd.a)(this,this.Tde,"addGetMruFromServerTask"));dc.instance.rpg(Object(bd.a)(this,this.Y0g,"deleteGetMruFromServerTask"))};fc.prototype.Y0g=function(){We.a.instance.cp(this.Igf)};fc.prototype.Tde=function(){We.a.instance.kh(this.Igf)};fc.prototype.dispose=
function(){this.hm||(this.hm=!0,this.ijb&&(We.a.instance.cp(this.ijb),this.ijb=null))};Ll.Object.defineProperties(fc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},Igf:{configurable:!0,enumerable:!0,get:function(){return this.J7d||(this.J7d=new kc.a(5,2,Bd.AFrameworkApplication.Hgf,Object(bd.a)(Ib.instance,Ib.instance.zDh,"getMruFromServerTask"),109))}},Xxj:{configurable:!0,enumerable:!0,get:function(){return this.ijb||(this.ijb=new kc.a(2,2,6E4*
Bd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(bd.a)(Ib.instance,Ib.instance.Nfi,"makeUpdateMruTask"),197))}}});Object(Oe.a)(fc,"CorePackageManager",null,[8,9,6]);var Ef=b(509);new Zf(0,0,0,0,0,0);new Zf(1,1,0,0,0,0);new Zf(2,2,0,0,0,0);new Zf(3,3,0,0,0,1);new Zf(4,3,1,0,1,1);new Zf(5,3,0,0,.42,1);new Zf(6,3,.83,0,1,1);new Zf(7,3,0,0,.58,1);new Zf(8,3,.42,0,.58,1);new Zf(9,3,.1,.25,.75,.9);new Zf(10,3,.1,.9,.2,1);new Zf(11,3,.1,
.9,.2,1);new Zf(12,3,.9,.1,.2,1);new Zf(13,3,.4,0,0,1);new Zf(14,3,.13,.21,.1,.7);new Zf(15,3,.02,.33,.38,.77);new Zf(16,3,.57,.17,.95,.75);new Zf(17,3,0,.19,.07,.72);new Zf(18,3,0,0,.95,.37);new Zf(19,3,.66,0,.34,1);new Zf(20,3,.8,0,.2,1);Fe.prototype={type:0,startTime:new Pf(0,null),endTime:new Pf(0,null),rGj:new Pf(0,null),iFj:new Pf(0,null),operationType:0};new me(0,[new Fe(5,0,0,0,null,1,1,0)]);new me(1,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,50,null,1,1,0)]);new me(2,[new Fe(1,3,0,167,null,
0,1,1),new Fe(2,3,0,167,null,0,1,1)]);new me(3,[new Fe(3,3,0,167,null,0,1,1),new Fe(4,3,0,167,null,0,1,1)]);new me(4,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,167,null,1,1,0)]);new me(5,[new Fe(5,2,0,167,null,0,1,0)]);new me(6,[new Fe(1,3,0,100,null,0,1,1),new Fe(2,3,0,100,null,0,1,1)]);new me(7,[new Fe(3,3,0,100,null,0,1,1),new Fe(4,3,0,100,null,0,1,1)]);new me(8,[new Fe(5,2,0,100,null,1,1,0)]);new me(9,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,100,null,1,1,0)]);new me(10,[new Fe(5,2,0,100,null,0,
1,0)]);new me(11,[new Fe(1,3,0,267,null,0,1,1),new Fe(2,3,0,267,null,0,1,1)]);new me(12,[new Fe(3,3,0,267,null,0,1,1),new Fe(4,3,0,267,null,0,1,1)]);new me(13,[new Fe(5,2,0,267,null,1,1,0)]);new me(14,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,267,null,1,1,0)]);new me(15,[new Fe(5,2,0,267,null,0,1,0)]);new me(16,[new Fe(6,3,0,267,null,0,1,1),new Fe(7,3,0,267,null,0,1,1)]);new me(17,[new Fe(1,3,0,750,null,0,1,1),new Fe(2,3,0,750,null,0,1,1)]);new me(18,[new Fe(3,3,0,750,null,0,1,1),new Fe(4,3,0,750,
null,0,1,1)]);new me(19,[new Fe(5,2,0,750,null,1,1,0)]);new me(20,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,750,null,1,1,0)]);new me(21,[new Fe(6,3,0,1E3,null,0,1,1),new Fe(7,3,0,1E3,null,0,1,1)]);new me(22,[new Fe(1,3,0,367,null,0,1,1),new Fe(2,3,0,367,null,0,1,1)]);new me(23,[new Fe(3,3,0,367,null,0,1,1),new Fe(4,3,0,367,null,0,1,1)]);new me(24,[new Fe(5,2,0,367,null,1,1,0)]);new me(25,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,367,null,1,1,0)]);new me(26,[new Fe(5,2,0,367,null,0,1,0)]);new me(27,
[new Fe(5,2,0,0,null,1,1,0),new Fe(5,2,0,50,null,0,1,0)]);new me(28,[new Fe(1,3,0,433,null,0,1,1),new Fe(2,3,0,433,null,0,1,1)]);new me(29,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,50,null,1,1,0),new Fe(2,3,0,0,null,40,1,1),new Fe(2,3,0,100,null,0,1,1)]);new me(30,[new Fe(2,0,0,0,null,32,1,1),new Fe(2,0,0,100,null,32,1,1),new Fe(2,3,101,350,null,0,1,1),new Fe(3,0,0,0,null,0,2,1),new Fe(3,0,0,100,null,0,2,1),new Fe(3,3,101,350,null,0,1,1),new Fe(5,0,0,0,null,0,2,0),new Fe(5,0,0,100,null,1,1,0)]);new me(31,
[new Fe(2,3,0,267,null,32,1,1),new Fe(3,3,0,267,null,0,2,1),new Fe(5,2,0,0,null,1,0,0),new Fe(5,2,0,267,null,0,2,0)]);new me(32,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,100,null,0,2,0),new Fe(5,2,101,267,null,1,1,0)]);new me(33,[new Fe(1,10,0,300,null,0,1,1),new Fe(2,10,0,300,null,0,1,1)]);new me(34,[new Fe(3,10,0,300,null,0,1,1),new Fe(4,10,0,300,null,0,1,1)]);new me(35,[new Fe(1,8,0,750,null,0,1,1),new Fe(2,8,0,750,null,0,1,1)]);new me(36,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,200,null,0,2,0),
new Fe(5,3,201,500,null,1,1,0)]);new me(37,[new Fe(1,2,0,0,null,0,2,1),new Fe(2,2,0,0,null,0,2,1),new Fe(1,2,0,200,null,0,2,1),new Fe(2,2,0,200,null,0,2,1),new Fe(1,3,201,267,null,0,1,1),new Fe(2,3,201,267,null,0,1,1)]);new me(38,[new Fe(1,3,0,267,null,0,1,1),new Fe(2,3,0,267,null,0,1,1)]);new me(39,[new Fe(5,2,0,0,null,0,2,0),new Fe(5,2,0,267,null,1,1,0)]);new me(40,[new Fe(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(O){window.setTimeout(O,16)}}();ng.prototype={Je:null,Qwg:5,Tkb:null,LQc:0,startTime:null,duration:null,k3b:null,cSc:-1,Rpd:-1,npd:-1};ng.prototype.Start=function(){this.startTime=new Date;this.k3b={}};ng.prototype.GetRecentAnimationStats=function(){var O,qa=[],rb=0;for(O=Fg.LQc;O<Fg.Qwg;O++)null!=Fg.Tkb[O]&&(qa[rb]=Fg.Tkb[O],rb++);for(O=0;O<Fg.LQc;O++)null!=
Fg.Tkb[O]&&(qa[rb]=Fg.Tkb[O],rb++);return qa};ng.prototype.GetAnimationSqmStats=function(){var O=[];return O[0]=0>Fg.cSc?0:Fg.cSc,O[1]=0>Fg.Rpd?0:Fg.Rpd,O[2]=0>Fg.npd?0:Fg.npd,O};var Fg=new ng;var xf=b(212),Uf=b(245),Gg=b(1195),Eg=b(142),ig=b(58),sg=b(35),yg=b(68),Yd=b(7),Sc=b(16),Ag=Gg.a;Em(Da,Ag);Da.prototype.SU=function(O){this.$.zd&65536&&Ag.prototype.SU.call(this,O)};Da.prototype.GXe=function(O){if(Yd.a.equals(this.X7i,this.$.shortcutKeyManager.P9c(O),!1)){var qa=Eg.b(this.$);qa&&qa.canReceiveFocus&&
(yg.g(O),qa.Le(!0,!1))}};Ll.Object.defineProperties(Da.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.YA},set:function(O){this.YA=O;switch(O){case 0:this.tva=this.VAg;break;case 2:this.tva=this.DBj;break;case 3:this.tva=this.YIi;break;case 4:this.tva=this.SIg;break;case 5:this.tva=this.AIi;break;default:Tc.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(Oe.a)(Da,"EwaAccessibilityManager",Gg.a,[]);var Jg=xf.a;Em(lf,Jg);lf.prototype.create=
function(){this.Eb(this.$.ea.Ba(15)||new Da(this.$))};lf.ja=function(O){O.ea.Ia(157,new lf(O))};Object(Oe.a)(lf,"AccessibilityManagerFactory",xf.a,[]);var je=b(12),dg=b(137),ke=b(557),Qf=ke.a;Em(Ee,Qf);Ee.prototype.dispose=function(){dg.WacAirSpace.fgd()&&dg.WacAirSpace.Duc()};Ee.prototype.animate=function(O,qa,rb,Sb,Uc){Yd.a.ma(qa)||dg.WacAirSpace.jK(O.element,qa);dg.WacAirSpace.animate(O,Sb,Uc);Yd.a.ma(rb)||dg.WacAirSpace.SRi(O.element,rb)};Object(Oe.a)(Ee,"AnimationManager",ke.a,[6]);var og=b(101),
Cf=b(211),Ea=b(924),ob=b(520),wc=b(88),zc=b(74),Hd=zc.a;Em(fe,Hd);fe.prototype.r_i=function(){var O=new Cf.a,qa=ob.a.mq(wc.a.instance.oc("Common.IEventEmitter<Common.IMruResult>")),rb=new id.a(function(){return qa.result});this.Amd=new id.a(function(){return new Ea.a(rb.value,null)});if(!this.Amd)return O;var Sb=this.Amd.value.oy("NewAndOpenCoreManager",!1);if(!Sb||3!==Sb.state||!Sb.lqd)return Sb?Tc.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",
Sb.state,!Sb.lqd):Tc.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;Sb=Sb.lqd;for(var Uc=["xlsx","xlsb","xlsm"],vd=0;vd<Sb.length;vd++){var oe=Sb[vd];if(!(0>Array.indexOf(Uc,oe.extension))){var ef=String.format("{0}.{1}",oe.title,oe.extension),Nf=Pe.b(oe,Bd.AFrameworkApplication.isRtl);oe=oe.url;if(ef&&Nf&&oe){var kh={};O.add((kh.FileName=ef,kh.FriendlyPath=Nf,kh.Section="mru",kh.AbsoluteUrl=oe,kh))}else oe||Tc.ULS.sendTraceTag(537155200,0,50,
"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return O};fe.prototype.dispose=function(){Hd.prototype.dispose.call(this)};fe.fileName="FileName";fe.friendlyPath="FriendlyPath";fe.section="Section";fe.absoluteUrl="AbsoluteUrl";Object(Oe.a)(fe,"NewAndOpenCoreManager",zc.a,[377,6]);var Kd=xf.a;Em(Vc,Kd);Vc.prototype.create=function(){this.Eb(this.$.ea.Ba(451)||this.$.ea.Ia(451,new fe(this.$)))};Vc.ja=function(O){O.ea.Ia(164,new Vc(O))};Object(Oe.a)(Vc,"NewAndOpenCoreFactory",xf.a,
[]);var he=b(1),Se=b(29),Ue=b(4),mf=b(11),Vg=b(239),Hf=b(20);Nd.a0a=function(O){O=Qd.a.Xf(O||"");return new Nd(O)};Nd.j6b=function(O){return Nd.a0a(Sc.a.instance.da(O))};Nd.l7c=function(O){return new Nd(Sc.a.instance.Ua(O))};Nd.dqh=function(O,qa){for(var rb=[],Sb=1;Sb<arguments.length;++Sb)rb[Sb-1]=arguments[Sb];return Nd.cqh.apply(null,[Sc.a.instance.Bb(O)].concat(rb))};Nd.cqh=function(O,qa){for(var rb=[],Sb=1;Sb<arguments.length;++Sb)rb[Sb-1]=arguments[Sb];Sb=rb.length;for(var Uc=Array(Sb),vd=0;vd<
Sb;vd++)Uc[vd]=(rb[vd]||Nd.ECe).Loc;return new Nd(String.format.apply(null,[O].concat(Uc)))};Ll.Object.defineProperties(Nd,{ECe:{configurable:!0,enumerable:!0,get:function(){return Nd.eZd||(Nd.eZd=new Nd(""))}},dod:{configurable:!0,enumerable:!0,get:function(){return Nd.S3d||(Nd.S3d=Nd.l7c(2).Loc)}}});Nd.eZd=null;Nd.S3d=null;Object(Oe.a)(Nd,"SafeHtml",null,[413]);Vd.prototype.dispose=function(){this.$&&this.unregister();mf.DOMElementExtensions.ig(this.Jfa);mf.DOMElementExtensions.ig(this.pda);mf.DOMElementExtensions.ig(this.Gea);
this.Gea=this.pda=this.Jfa=this.$=null};Vd.prototype.setEnabled=function(O){this.PNf(this.Gea,O)};Vd.prototype.u7i=function(){this.PNf(this.pda,!0)};Vd.prototype.readText=function(O){this.lDb(Nd.a0a(O),!0)};Vd.prototype.CNa=function(O){this.lDb(Nd.a0a(O),!1)};Vd.prototype.ABf=function(O,qa){if(1>qa||Yd.a.ma(O))Tc.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var rb=new Sys.StringBuilder;O=String.format(Sc.a.instance.Bb(33),qa,O);He(rb,O);He(rb,Sc.a.instance.da(818));
this.lDb(Nd.a0a(rb.toString()),!1)}};Vd.prototype.NNi=function(O,qa,rb){if(1>rb||1>qa||qa>rb||Yd.a.ma(O))Tc.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Sb=new Sys.StringBuilder;He(Sb,O);Sb.append(String.format(Sc.a.instance.Bb(54),qa,rb));this.lDb(Nd.a0a(Sb.toString()),!1)}};Vd.prototype.xBf=function(O){O=this.XGh(O);this.lDb(O,!1)};Vd.prototype.lDb=function(O,qa){if(O=O?O.Loc:null)qa=qa?this.Gea:this.pda,Yd.a.equals(qa.innerHTML,O,!1)&&(O+=Nd.dod),qa.innerHTML=O};Vd.prototype.kDb=
function(O,qa){this.Jfa.getAttribute(Ue.a.Bfa)!==qa&&this.Jfa.setAttribute(Ue.a.Bfa,qa);O=O?Nd.a0a(O).Loc:"";this.Jfa.innerHTML=O};Vd.prototype.ONi=function(O,qa,rb,Sb){var Uc=Sc.a.instance.Bb(53);Tc.ULS.shipAssertTag(537153949,0,!(void 0===O||null===O));Tc.ULS.shipAssertTag(537153948,0,!(void 0===qa||null===qa));Tc.ULS.shipAssertTag(537153947,0,!(void 0===rb||null===rb));Tc.ULS.shipAssertTag(537153946,0,!(void 0===Sb||null===Sb));Tc.ULS.shipAssertTag(537153945,0,!(void 0===Uc||null===Uc));O=String.format(Uc,
O||"",qa||"",rb||"",Sb||"");this.readText(O)};Vd.prototype.Tvj=function(O){var qa=this.Gea.style;O?(O=Vg.a.OXb(O.cell,qa),qa=O.JH,qa.top=qa.left=qa.bottom=qa.right=null,O.z8()):qa.cssText=""};Vd.prototype.XGh=function(O){switch(O){case -1985798686:return Nd.j6b(12);case -911352779:return Nd.j6b(11);case 237279923:return Nd.j6b(13);case -1502853784:return Nd.l7c(81);case -111689794:return Nd.l7c(78);case -287251124:return this.lad(1268,function(qa){return qa.bold});case -1925065947:return this.lad(1269,
function(qa){return qa.italic});case 1764140053:return this.lad(1270,function(qa){return qa.underline})}return null};Vd.prototype.register=function(){Tc.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(Tc.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.mkb(Object(bd.a)(this,this.glf,"onCommandExecutionStarted")))};Vd.prototype.unregister=function(){this.$&&this.$.Ka.U8a(Object(bd.a)(this,this.glf,
"onCommandExecutionStarted"))};Vd.prototype.glf=function(O,qa){this.xBf(qa.Zd.command)};Vd.prototype.PNf=function(O,qa){var rb=O===this.pda;qa?(O.setAttribute(Ue.a.Bfa,Ue.a.DWa),rb&&O.setAttribute(Ue.a.Od,Ue.a.Afa),O.setAttribute(Ue.a.rO,Ue.a.Vo),O.removeAttribute(Ue.a.rO),O.innerHTML+=" "):(O.removeAttribute(Ue.a.Bfa),rb&&O.removeAttribute(Ue.a.Od),O.setAttribute(Ue.a.rO,Ue.a.hj))};Vd.prototype.lad=function(O,qa){var rb=this.activeCell;if(!rb)return null;qa=qa(rb)?7:8;return Nd.dqh(qa,Nd.j6b(O))};
Ll.Object.defineProperties(Vd.prototype,{Kva:{configurable:!0,enumerable:!0,get:function(){return this.Rfg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return Hf.g(this.$).tc(null)}}});Object(Oe.a)(Vd,"AriaLiveNotifier",null,[385,357,6]);var Rg=xf.a;Em(Id,Rg);Id.prototype.create=function(){this.Eb(this.$.ea.Ba(211)||new Vd(this.$,this.$.Zx,this.$.Re))};Id.ja=function(O){O.ea.Ia(212,new Id(O))};Object(Oe.a)(Id,"AriaLiveNotifierFactory",
xf.a,[]);var zf=b(23),gg=b(205);rd.prototype.readText=function(O){this.nV.setAttribute(Ue.a.fv,O);this.C5.setAttribute(Ue.a.fv,O);this.Dnj()};rd.prototype.dispose=function(){this.RZ&&this.RZ.parentNode&&this.RZ.parentNode.removeChild(this.RZ);this.C5=this.nV=this.RZ=this.zha=null};rd.prototype.ZWg=function(O){var qa=O.Jb+"readoutElementWrapper",rb=O.Jb+"readoutElement1",Sb=O.Jb+"readoutElement2";this.RZ=document.getElementById(qa);this.RZ||(this.RZ=document.createElement(gg.a.div),this.RZ.id=qa,this.nV=
document.createElement(gg.a.label),this.nV.id=rb,this.C5=document.createElement(gg.a.label),this.C5.id=Sb,this.nV.style.width="0px",this.nV.style.height="0px",this.C5.style.width="0px",this.C5.style.height="0px",this.nV.tabIndex=-1,this.C5.tabIndex=-1,this.RZ.appendChild(this.nV),this.RZ.appendChild(this.C5),O=O.Jb+Ue.a.PXc,qa=document.getElementById(O),Tc.ULS.shipAssertTag(537153942,3,!!qa,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",O),qa&&qa.appendChild(this.RZ))};
rd.prototype.XHi=function(){this.zha&&this.nV&&this.C5&&(this.zha.setAttribute(Ue.a.s1,this.nV.id),this.zha.setAttribute(Ue.a.qRc,String.format("{0} {1}",this.nV.id,this.C5.id)))};rd.prototype.Dnj=function(){if(this.isActive){var O="";mf.DOMElementExtensions.hasAttribute(this.zha,Ue.a.s1)&&(O=this.zha.getAttribute(Ue.a.s1).toString());this.zha.setAttribute(Ue.a.s1,O===this.nV.id?this.C5.id:this.nV.id)}else Tc.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};
rd.m3a=function(){if(null==rd.Uqb)if(he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1))rd.Uqb=!0,Tc.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(rd.Uqb=!1,zf.a.IG||zf.a.uf)rd.Uqb=!0,Tc.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return rd.Uqb};rd.ja=function(O){rd.m3a()&&O.ea.Ia(244,new rd(O,
Hf.g(O).uc.textBox.ef))};Ll.Object.defineProperties(rd.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.zha&&document.activeElement===this.zha}}});rd.Uqb=null;Object(Oe.a)(rd,"FocusBasedReadout",null,[357,6]);var Xe=xf.a;Em(Pc,Xe);Pc.prototype.create=function(){var O=this;rd.m3a()?Hf.g(this.$).uc.textBox.HS(function(){var qa=O.$.ea.Ba(244)||new rd(O.$,Hf.g(O.$).uc.textBox.ef);O.Eb(qa)}):this.Eb(null)};Pc.ja=function(O){O.ea.Ia(315,new Pc(O))};Object(Oe.a)(Pc,"FocusBasedReadoutFactory",
xf.a,[]);var If=b(86),yf=b(25),Bf=b(46),Vb=b(250),Qc=b(43),md=b(42),Ce=b(115);Bb.fad=function(O){return Bb.ETe(O.toString())};Bb.ETe=function(O){return Bb.eKg.test(O)?O.replace(Bb.AMi,"$1 ").replace(Bb.zMi,' "$1"').trim():O};Bb.dXi=function(O){var qa=O.lastIndexOf("!");return O.substring(0,-1<qa?qa+1:0)+Bb.ETe(O.substring(-1<qa?qa+1:0,O.length))};Ll.Object.defineProperties(Bb,{AMi:{configurable:!0,enumerable:!0,get:function(){return Bb.B7d||(Bb.B7d=RegExp("([A-Z]+)","g"))}},zMi:{configurable:!0,enumerable:!0,
get:function(){return Bb.A7d||(Bb.A7d=RegExp("([A-Z])","g"))}},eKg:{configurable:!0,enumerable:!0,get:function(){return Bb.xWd||(Bb.xWd=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});Bb.B7d=null;Bb.A7d=null;Bb.xWd=null;Object(Oe.a)(Bb,"RangeAriaExtensions",null,[]);Object(Oe.a)(Oc,"SelectionReadoutState",null,[]);var le=b(60),Zd=b(79);rc.prototype.dispose=function(){this.$&&this.$l();If.a.Fa(this.NWb);this.sparklineManager=
this.$=this.NWb=null};rc.prototype.EOe=function(O,qa,rb){rb=void 0===rb?!0:rb;if(!O)return"";var Sb=this.$.ea,Uc=new Sys.StringBuilder;this.Axg(Uc,O,qa);if(he.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var vd=this.tableManager.wIa(O.range);vd&&vd.rKd&&this.rie(Uc,vd);(vd=this.tableManager.zo(O.range))&&vd.bua&&this.rie(Uc,vd)}vd=O.v$?this.mRe(O):O.text;He(Uc,vd);vd=this.$.activeItemName;this.sC.activeItemName!==vd&&(He(Uc,vd),this.sC.activeItemName=vd);vd=1===qa.length?
Bf.K(qa).isSingle?"":Sc.a.instance.da(814):String.format(Sc.a.instance.Bb(30),qa.length);He(Uc,vd);vd=Ol(qa);for(var oe=vd.next();!oe.done;oe=vd.next())oe=oe.value,He(Uc,Bb.fad(oe)),1===qa.length&&rc.z7h(oe)&&(oe=Hf.g(this.$).Ca.qr(oe.bottomRight),void 0===oe||null===oe||Yd.a.ma(oe.text)||(oe=oe.v$?this.lRe(oe,oe.text):oe.text,He(Uc,oe)));vd=O.cell;vd=this.GEh(vd.u0i,vd.aNg);He(Uc,vd);this.lxg(Uc,O);rb&&(O.M3a?He(Uc,Sc.a.instance.da(802)):O.wKa&&He(Uc,Sc.a.instance.da(803)));if(O.hasAutoFilter||O.u3)this.Bxg(Uc,
O.hasAutoFilter?O.cell.dXb:O.cell.HFi),rb&&He(Uc,Sc.a.instance.da(805));Vb.c(this.$,O.range)&&He(Uc,Sc.a.instance.da(809));this.ixg(Uc,O);rb=(rb=Sb.Ba(14))?rb.cuh():"";He(Uc,rb);O.mJ&&(rb=Hf.g(this.$).Ca.qr(O.range),rb=!!rb&&rb.aZe,rc.rcj(O)?rc.jxg(Uc,O):he.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&rb?He(Uc,Sc.a.instance.da(807)):He(Uc,Sc.a.instance.da(806)));O.u$&&(He(Uc,Sc.a.instance.da(808)),O.ttb&&He(Uc,String.format(Sc.a.instance.Bb(16),O.j_g)),He(Uc,O.iconName));
O.hasRichValueIcon&&(vd=this.$.ea.Ba(271),rb="",vd&&O.cell.Yaf&&(vd=vd.fP(O.cell.Yaf))&&vd.DomainId.Id!==rc.UCj&&(rb=vd.Name),O.cell.b_h?(He(Uc,String.format(Sc.a.instance.Bb(176),rb)),He(Uc,Sc.a.instance.da(1736))):(He(Uc,String.format(Sc.a.instance.Bb(174),rb)),He(Uc,Sc.a.instance.da(1735))));this.fQh(O)&&He(Uc,rc.AAh(O));(Sb=Sb.Ba(231))&&He(Uc,Sb.zRe(qa,!0));1===qa.length&&qa[0].isSingle&&rc.qcj(O,qa[0],this.$)&&(qa=this.$.ea.Ba(271))&&He(Uc,qa.nuh());O.sJb&&!Yd.a.ma(O.tJb)&&He(Uc,O.tJb);qa=O.cell.YIg;
Yd.a.ma(qa)||He(Uc,qa);he.EwaSettings.isChangeGateEnabled("OfficeVSO:5463515_PhoneticSlice1")&&O.$ua&&O.iCb&&(O=O.wwd)&&(He(Uc,Sc.a.instance.da(1893)),He(Uc,O));return Uc.toString()};rc.prototype.pne=function(O){this.Fqa=this.sC;this.sC=Object.assign(new Oc,{activeItemName:this.Fqa.activeItemName,Rtc:O?this.Fqa.Rtc:!1,tableName:O?this.Fqa.tableName:"",iYa:O?this.Fqa.iYa:-1})};rc.prototype.FIf=function(){this.Fqa&&(this.sC=this.Fqa,this.Fqa=null)};rc.prototype.GEh=function(O,qa){return 2===O||2===
qa?Sc.a.instance.da(835):1===O||1===qa?Sc.a.instance.da(836):""};rc.prototype.mRe=function(O){return this.lRe(O.cell,O.text)};rc.prototype.uba=function(){Hf.g(this.$).isEditing||this.NWb.kq()};rc.prototype.Axg=function(O,qa,rb){if(rb&&1===rb.length&&rb[0].isSingle){rb="";var Sb=this.tableManager.wIa(qa.range);Sb?(rb=Sb.pivotTableName,this.SQc(O,rb),this.tie(O,!0,rb,Sb.Dbc?Sc.a.instance.da(797):""),He(O,this.tableManager.K5h(Sb,qa.range)?Sc.a.instance.da(799):""),He(O,this.tableManager.h0h(Sb,qa.range)?
Sc.a.instance.da(798):"")):(Sb=this.tableManager.zo(qa.range))?(rb=(rb=Hf.g(this.$).$b.Mk(qa.range))?rb.name:"",this.SQc(O,rb),this.tie(O,!1,rb,""),He(O,this.tableManager.r5e(Sb,qa.range)?Sc.a.instance.da(798):"")):(this.SQc(O,rb),this.sC.tableName="",this.sC.iYa=-1)}};rc.prototype.SQc=function(O,qa){qa===this.sC.tableName||Yd.a.ma(this.sC.tableName)||(O.append(Sc.a.instance.da(this.sC.Rtc?796:795)),He(O," "+this.sC.tableName))};rc.prototype.tie=function(O,qa,rb,Sb){rb!==this.sC.tableName&&(O.append(Sc.a.instance.da(qa?
794:793)),He(O," "+rb),He(O,Sb),this.sC.tableName=rb,this.sC.Rtc=qa,this.sC.iYa=-1)};rc.prototype.rie=function(O,qa){var rb=Hf.g(this.$).ga.wa.activeCell;if(rb.top!==qa.top&&rb.left!==this.sC.iYa){O.append(Sc.a.instance.da(798));qa=new yf.Range(qa.top,rb.left,qa.top,rb.left,!0,!0);He(O,Bb.fad(qa));if(qa=Hf.g(this.$).tc(qa))qa=qa.v$?this.mRe(qa):qa.text,He(O,qa);this.sC.iYa=rb.left}};rc.prototype.lRe=function(O,qa){var rb=O.m2a;return O.vtb?String.format(Sc.a.instance.Bb(14),qa,rb):String.format(Sc.a.instance.Bb(13),
qa,Bb.dXi(rb))};rc.prototype.Uj=function(){Tc.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var O=Hf.g(this.$);Tc.ULS.shipAssertTag(537153929,0,!!O,"Can't register to grid's events");O&&(O.Gc.Jm(Object(bd.a)(this,this.hH,"onEditingStarted")),O.Ca.Np(Object(bd.a)(this,this.uba,"readActiveItemDescription")),O.iD(Object(bd.a)(this,this.uba,"readActiveItemDescription")),this.q8a&&O.Gc.Xr(this.pj.bind(this)),O=O.ga,Tc.ULS.shipAssertTag(537153928,0,!!O,"Can't register to selectionManager's events"),
O&&(O.HF(Object(bd.a)(this,this.$c,"onSelectionChanged")),O.CF(Object(bd.a)(this,this.uba,"readActiveItemDescription")),O.Pa.l1(Object(bd.a)(this,this.uba,"readActiveItemDescription")),this.q8a&&(this.Nzd=this.Nzd.bind(this))))}};rc.prototype.$l=function(){if(this.$){var O=Hf.g(this.$);O&&(O.Gc.ym(Object(bd.a)(this,this.hH,"onEditingStarted")),O.Ca.Jq(Object(bd.a)(this,this.uba,"readActiveItemDescription")),O.AE(Object(bd.a)(this,this.uba,"readActiveItemDescription")),this.q8a&&O.Gc.Fr(this.pj),O=
O.ga)&&(O.CE(Object(bd.a)(this,this.uba,"readActiveItemDescription")),O.SM(Object(bd.a)(this,this.uba,"readActiveItemDescription")),O.Pa.Xka(Object(bd.a)(this,this.uba,"readActiveItemDescription")))}};rc.prototype.Oni=function(){if(!Hf.g(this.$).ga.Pa.Zid){var O=this.cth();this.readText(O.returnValue,O.activeCell)}};rc.prototype.readText=function(O,qa){this.m3a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(O):(he.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(O),this.q8a&&!qa||this.ariaLiveNotifier.Tvj(qa))};rc.prototype.hH=function(){var O=this.activeCell;this.readText("Editing",O);he.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||O&&O.WIa&&!Hf.g(this.$).LYe||this.NWb.cancel()};rc.prototype.$c=function(){this.uba();this.q8a&&Hf.g(this.$).inRangePicker&&1===Zd.a.Tb&&(null===this.qlb?this.qlb=Qc.a.instance.create(this.Nzd,rc.VNc,"readSelectedRanges"):this.qlb.kq())};
rc.prototype.pj=function(){this.qlb&&this.qlb.cancel()};rc.prototype.Nzd=function(){this.readText(this.DHh())};rc.prototype.DHh=function(){var O=this,qa="";Hf.g(this.$).ga.rangePicker.UJ.forEach(function(rb){qa+=O.qIh(rb)});return qa+=" selected"};rc.prototype.qIh=function(O){return" "+(O.sheetId!==le.d(this.$.qa)?this.$.va.Dad(O.sheetId).name:"")+" "+O.range.topLeft+" "+(O.range.isSingle?"":O.range.bottomRight)};rc.prototype.cth=function(){var O=null;var qa=Hf.g(this.$).ga;if(1!==qa.Qe&&!qa.Pa.kc)return Tc.ULS.sendTraceTag(537153927,
0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",qa.Qe),{returnValue:"",activeCell:O};switch(qa.Qe){case 2:return{returnValue:this.Pvh(qa),activeCell:O};case 64:var rb=qa.Pa.kc.floatingObject,Sb="";if(qa=qa.Pa.kc.Mr||qa.Pa.kc.Ld)Sb=(Sb=qa.firstChild)?mf.DOMElementExtensions.getTextContent(Sb):"";return{returnValue:String.format(Sc.a.instance.Bb(52),rc.v6b(rb.altText,rb.altTextDescription,rb.name),Sb,rb.altTextDescription),activeCell:O};case 4:return{returnValue:rc.zwg(qa.Pa.kc.floatingObject),
activeCell:O};case 512:return{returnValue:Ce.a.aQe(qa.Pa.kc.floatingObject.V1c),activeCell:O};case 8:return rb=(rb=qa.Pa.kc.floatingObject)?rb.name:"",{returnValue:String.format(Sc.a.instance.Bb(50),rb),activeCell:O};case 1:return O=this.activeCell,{returnValue:this.EOe(O,qa.wa.selectedRanges),activeCell:O}}return{returnValue:"",activeCell:O}};rc.prototype.Pvh=function(O){var qa=new Sys.StringBuilder;qa.append(rc.AJg(O));var rb=this.$.ea.Ba(231);rb&&He(qa,rb.zRe(O.Pa.kc.floatingObject,!1));return qa.toString()};
rc.prototype.fQh=function(O){O=O.A3e();var qa=!1;this.sC.k8e!==O&&(this.sC.k8e=O,qa=!0);return qa};rc.prototype.lxg=function(O,qa){if(qa.Etb)if(qa=this.sparklineManager.xIh(qa)){var rb=Sc.a.instance,Sb=rb.da;a:switch(qa.type){case 0:var Uc=790;break a;case 1:Uc=791;break a;default:Uc=792}rb=Sb.call(rb,Uc);He(O,String.format(Sc.a.instance.Bb(25),rb));qa=String.format(Sc.a.instance.Bb(24),Bb.fad(qa.jkj));He(O,qa)}else Tc.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),
He(O,String.format(Sc.a.instance.Bb(25),""))};rc.prototype.Bxg=function(O,qa){switch(qa){case 1:case 11:He(O,Sc.a.instance.da(810));break;case 6:He(O,Sc.a.instance.da(810));He(O,Sc.a.instance.da(812));break;case 7:He(O,Sc.a.instance.da(810));He(O,Sc.a.instance.da(813));break;case 2:He(O,Sc.a.instance.da(811));He(O,Sc.a.instance.da(812));break;case 3:He(O,Sc.a.instance.da(811));He(O,Sc.a.instance.da(813));break;default:He(O,Sc.a.instance.da(811))}};rc.prototype.ixg=function(O,qa){var rb=this.$.ea.Ba(65);
qa=rb?rb.aIa(qa.range):null;var Sb="",Uc=Object(nf.a)(382,qa);qa?Sb=!qa.x3a&&Uc&&Uc.b7h?String.format(Sc.a.instance.Bb(29),Uc.soj):String.format(Sc.a.instance.Bb(23),qa.author):rb&&rb.wl&&rb.wl.WD&&(Sb=String.format(Sc.a.instance.Bb(28),rb.wl.rM.author));He(O,Sb)};rc.zwg=function(O){return String.format(Sc.a.instance.Bb(51),rc.v6b(O.altText,O.altTextDescription,O.name),O.altTextDescription)};rc.AAh=function(O){return Sc.a.instance.da(O.A3e()?800:801)};rc.v6b=function(O,qa,rb){return Yd.a.ma(O)&&Yd.a.ma(qa)?
rb:O};rc.AJg=function(O){var qa=O.Pa.kc;O=qa.floatingObject;var rb=O.Nc,Sb=rb.ChartTitle,Uc=O.altText,vd=O.altTextDescription,oe=!!(rb.Attributes&4);return(qa=qa.getSelectionDescription())?qa:rb.DataRangeForDisplay?String.format(Sc.a.instance.Bb(oe?48:46),rc.v6b(Uc,vd,O.name),vd,Sb,Sc.a.instance.da(hc(rb.ChartCategory)),rb.DataRangeForDisplay):String.format(Sc.a.instance.Bb(oe?49:47),rc.v6b(Uc,vd,O.name),vd,Sb,Sc.a.instance.da(hc(rb.ChartCategory)))};rc.rcj=function(O){return he.EwaSettings.ka(102)&&
(O.h3a||O.Abc)};rc.jxg=function(O,qa){if(!qa.eQa)Tc.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(qa.h3a)qa=qa.eQa.topLeft.toString(),He(O,String.format(Sc.a.instance.Bb(26),qa));else if(qa.Abc){var rb=qa.eQa.eW();qa=(rb.LastColumn-rb.FirstColumn+1).toString();rb=(rb.LastRow-rb.FirstRow+1).toString();He(O,String.format(Sc.a.instance.Bb(27),qa,rb))}};rc.qcj=function(O,
qa,rb){return O.mJ||!he.EwaSettings.ka(139)?!1:(O=rb.ea.Ba(271))?O.evb(qa):!1};rc.z7h=function(O){return O.top===O.bottom&&O.left+1===O.right||O.top+1===O.bottom&&O.left===O.right};Ll.Object.defineProperties(rc.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return Hf.g(this.$).tc(null)}}});rc.UCj=268435712;rc.VNc=500;Object(Oe.a)(rc,"SelectionReadoutHandler",null,[383,6]);var fg=b(51),Kg=xf.a;Em(Lb,Kg);Lb.prototype.create=function(){var O=this,qa=this.$.ea,rb=ig.GetServiceTaskFactory.Va(qa,
211,212,this.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),Sb=ig.GetServiceTaskFactory.Va(qa,66,134,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),Uc=ig.GetServiceTaskFactory.Va(qa,240,239,this.rb,"Microsoft.Office.Excel.WebUI.Client.SparklineManager.ISparklineManager"),vd=fg.Task.Ra(null);he.EwaSettings.GG()&&(vd=ig.GetServiceTaskFactory.Va(qa,244,315,this.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IReadoutNotifier"));sg.TaskExtensions.Aa(sg.TaskExtensions.xe([rb,
Sb,Uc,vd],this.la),function(){var oe=qa.Ba(226)||new rc(rb.result,O.$,Sb.result,Uc.result,vd.result);O.Eb(oe)},this.$.la,3)};Lb.ja=function(O){O.ea.Ia(227,new Lb(O))};Object(Oe.a)(Lb,"SelectionReadoutHandlerFactory",xf.a,[]);vb.prototype.EBf=function(){var O=this.euh();this.ariaLiveNotifier.kDb(O,Ue.a.hlb)};vb.prototype.euh=function(){var O=new Sys.StringBuilder;this.$.workbookContext&&He(O,this.$.workbookContext.WorkbookFileName);He(O,Sc.a.instance.da(816));He(O,this.guh());He(O,this.fuh());He(O,
Sc.a.instance.da(817));return O.toString()};vb.prototype.guh=function(){return this.$.isEditMode?Sc.a.instance.da(821):Sc.a.instance.da(822)};vb.prototype.fuh=function(){var O=this.eCj(),qa=this.$.va.qa;O=1!==O?String.format(Sc.a.instance.Bb(31),O):Sc.a.instance.da(815);O=new Sys.StringBuilder(O);qa&&!Yd.a.ma(qa.sheetName)&&(O.append(Nd.dod),O.append(String.format(Sc.a.instance.Bb(32),qa.sheetName)));return O.toString()};vb.prototype.eCj=function(){for(var O=0,qa=Ol(this.$.va.items),rb=qa.next();!rb.done;rb=
qa.next())rb.value.visible&&O++;return O};Object(Oe.a)(vb,"WorkbookReadout",null,[]);sa.prototype.dispose=function(){this.M5b&&this.M5b.BUi(Object(bd.a)(this,this.Cof,"onKeyboardInteractionStarted"));this.M5b=this.ariaLiveNotifier=this.$=null};sa.prototype.Cof=function(){this.YSd.EBf();this.ariaLiveNotifier.setEnabled(!0)};Object(Oe.a)(sa,"EmbeddedWorkbookReadoutHandler",null,[6]);Od.prototype.dispose=function(){this.$l();this.ariaLiveNotifier=this.VX=null;this.Bd=!0};Od.prototype.Uj=function(){if(this.VX){this.VX.uq(Object(bd.a)(this,
this.UU,"onUserAction"));this.VX.Ca.Np(Object(bd.a)(this,this.UU,"onUserAction"));this.VX.iD(Object(bd.a)(this,this.UU,"onUserAction"));var O=Object(nf.a)(202,this.VX);O&&(O.Gc.Jm(Object(bd.a)(this,this.UU,"onUserAction")),O.ga.HF(Object(bd.a)(this,this.UU,"onUserAction")),O.ga.CF(Object(bd.a)(this,this.UU,"onUserAction")),O.ga.Pa.l1(Object(bd.a)(this,this.UU,"onUserAction")))}else Tc.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};Od.prototype.$l=
function(){if(this.VX){this.VX.Ca.Jq(Object(bd.a)(this,this.UU,"onUserAction"));this.VX.AE(Object(bd.a)(this,this.UU,"onUserAction"));var O=Object(nf.a)(202,this.VX);O&&(O.Gc.ym(Object(bd.a)(this,this.UU,"onUserAction")),O.ga.CE(Object(bd.a)(this,this.UU,"onUserAction")),O.ga.SM(Object(bd.a)(this,this.UU,"onUserAction")),O.ga.Pa.Xka(Object(bd.a)(this,this.UU,"onUserAction")))}};Od.prototype.UU=function(){this.Bd||this.She()};Od.prototype.She=function(){this.YSd.EBf();this.ariaLiveNotifier.setEnabled(!0);
this.ariaLiveNotifier.u7i();this.dispose()};Object(Oe.a)(Od,"WorkbookReadoutHandler",null,[6]);var $g=xf.a;Em(yd,$g);yd.prototype.create=function(){var O=this,qa=ig.GetServiceTaskFactory.Va(this.$.ea,211,212,this.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier");if(this.$.V3){var rb=ig.GetServiceTaskFactory.Va(this.$.ea,12,477,this.rb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory");sg.TaskExtensions.Aa(sg.TaskExtensions.xe([qa,rb],this.$.la),
function(){var Sb=new sa(qa.result,O.$,rb.result);O.Eb(Sb)},this.$.la,3)}else sg.TaskExtensions.Aa(qa,function(Sb){Sb=new Od(Sb.result,O.$);O.Eb(Sb)},this.$.la,3)};yd.ja=function(O){O.ea.Ia(229,new yd(O))};Object(Oe.a)(yd,"WorkbookReadoutHandlerFactory",xf.a,[]);var pa=b(36),tb=b(237),qc=b(352),jd=b(176),Sd=b(644),ye=pa.a;Em(Nc,ye);Nc.prototype.dispose=function(){this.view&&(this.view.Ca.Ko(Object(bd.a)(this,this.Be,"onBlockCacheItemChanged")),this.view.Ca.nH(Object(bd.a)(this,this.Vl,"onBlockCacheItemEvicted")),
this.view.Ca.T8a(Object(bd.a)(this,this.Be,"onBlockCacheItemChanged")),this.view.Ca.$Db(Object(bd.a)(this,this.Be,"onBlockCacheItemChanged")),this.view.$.va.zE(Object(bd.a)(this,this.Yn,"onActiveItemChanging")),this.view.$.wb.zE(Object(bd.a)(this,this.Yn,"onActiveItemChanging")));this.PR=this.zbe=null;ye.prototype.dispose.call(this)};Nc.prototype.RUb=function(O){O=this.nzd(O);var qa=this.view.Hh;if(O&&0<O.length&&qa)for(var rb=0,Sb=O.length;rb<Sb;rb++)qa.contains(this.PR[rb])||Array.add(this.PR,jd.a.uP(O[rb]))};
Nc.prototype.LDb=function(){var O;if(this.PR.length&&(O=this.view.Hh))for(var qa=this.PR.length-1;0<=qa;qa--)O.contains(this.PR[qa])||Array.removeAt(this.PR,qa)};Nc.prototype.HTe=function(O){return this.cTe(O)};Nc.prototype.cTe=function(O){O=Bf.I(O,this.PR,!0);return 0<O.length?O[0]:null};Nc.prototype.Be=function(O,qa){var rb,Sb=qa.Ed.block;O=!1;if(Sb.jj&&Sb.state&1&&(rb=this.view.Mf(qa.Ed.block.ue.BlockCachePosition.PaneType).fF(qa.Ed.hash))){Sb=this.nzd(Sb.me);if(rb=rb.fg)for(var Uc=this.PR.length-
1;0<=Uc;Uc--)rb.contains(this.PR[Uc].bottomRight)&&(Array.removeAt(this.PR,Uc),O=!0);if(Sb)for(rb=0,Uc=Sb.length;rb<Uc;rb++)Array.add(this.rangeList,jd.a.uP(Sb[rb])),O=!0;O&&(qa=this.view.T1.fF(qa.Ed.hash),this.raiseEvent(Nc.ozd,new Sd.a(qa)))}};Nc.prototype.Vl=function(){this.LDb()};Nc.prototype.Yn=function(){this.PR=[]};Ll.Object.defineProperties(Nc.prototype,{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.PR}},view:{configurable:!0,enumerable:!0,get:function(){return this.zbe}}});
Nc.ozd="lrc";Object(Oe.a)(Nc,"LoadedRangeCollection",pa.a,[]);Em(Lc,Nc);Lc.prototype.xIh=function(O){for(var qa=Ol(this.rangeList),rb=qa.next();!rb.done;rb=qa.next())if(rb=rb.value,O.range.contains(rb))return rb;return null};Lc.prototype.nzd=function(O){return O.GridBlockModel&&(O=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(O.GridBlockModel))?O.getSparklineRanges():null};Object(Oe.a)(Lc,"SparklineManager",Nc,[372]);var Ye=xf.a;Em(gc,Ye);gc.prototype.create=function(){this.Eb(this.sparklineManager||
(this.sparklineManager=new Lc(Hf.g(this.$),this.$.ea)))};gc.ja=function(O){O.ea.Ia(239,new gc(O))};Object(Oe.a)(gc,"SparklineManagerFactory",xf.a,[]);var wf=b(52),Ma=b(283);Ab.WFe="ewa-svg-icon";Object(Oe.a)(Ab,"CssClassNames",null,[]);var gb=b(305),Wb=b(332);cb.prototype.dispose=function(){this.jNd=null;this.$.fa.Er(Object(bd.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"))};cb.prototype.Ita=function(O,qa,rb,Sb,Uc){Sb=void 0===Sb?null:Sb;Uc=void 0===Uc?null:Uc;var vd;(vd=this.jNd[O])||
(this.jNd[O]=vd=this.CEi(this.tXf[O]));if(!vd)return Tc.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",O),null;var oe=vd.cloneNode(!0);if(!oe.style){var ef=gb.b(vd),Nf=gb.b(oe),kh={};kh.iconId=O;kh.isOriginalNodeStyleNull=void 0===vd.style||null===vd.style;kh.isOriginalNodeCurrentStyleNull=void 0===vd.currentStyle||null===vd.currentStyle;kh.isClonedNodeCurrentStyleNull=void 0===oe.currentStyle||null===oe.currentStyle;kh.originalNode=ef.substring(0,
ef.indexOf(">")+1);kh.clonedNode=Nf.substring(0,Nf.indexOf(">")+1);Tc.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",JSON.stringify(kh))}O=String.format("height: {0}px; width: {0}px;",qa,rb);oe.setAttribute("style",O);Uc&&(O=document.createElement("title"),O.innerHTML=Uc,oe.insertBefore(O,oe.childNodes[0]));if(Sb)for(Sb=Ol(Sb),Uc=Sb.next();!Uc.done;Uc=Sb.next())Sys.UI.DomElement.addCssClass(oe,Uc.value);return oe};cb.prototype.I$=function(O,
qa,rb,Sb,Uc,vd,oe,ef){Uc=void 0===Uc?0:Uc;vd=void 0===vd?0:vd;oe=void 0===oe?null:oe;ef=void 0===ef?null:ef;Uc&&vd||(vd=mf.DOMElementExtensions.getBoundingClientRect(Sb),Uc=vd.height,vd=vd.width);if(oe=this.Ita(O,qa,rb,oe,ef))Sb.appendChild(oe),(Sb=mf.DOMElementExtensions.oY(oe,"style",null))?oe.setAttribute("style",Sb+String.format(" margin: {0}px {1}px;",(Uc-qa)/2,(vd-rb)/2)):Tc.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',
O);return oe};cb.prototype.Ih=function(){this.jbf();this.$.fa.Er(Object(bd.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"))};cb.prototype.jbf=function(){var O=this;sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.Va(this.$.ea,283,284,0,"Common.IDynamicScriptLoaderProvider"),function(qa){qa=Wb.c(qa.result.Cp.loadScript("excel-uiSlice20-sprite"));sg.TaskExtensions.Aa(qa,function(){var rb=O.oRe("excelUiSlice20Sprite");rb?O.Hee(rb):Tc.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.",
"excelUiSlice20Sprite")},O.$.la,3)},this.$.ea.la,3)};cb.prototype.Hee=function(O){O=Ol(O);for(var qa=O.next();!qa.done;qa=O.next())qa=qa.value,qa.type===gg.a.rXf&&(this.tXf[qa.id]=qa)};cb.prototype.CEi=function(O){if(!O)return null;var qa=O.viewBox;O=O.children;var rb=document.createElementNS(Ma.a.lNd,gg.a.rXf);Sys.UI.DomElement.addCssClass(rb,Ab.WFe);rb.setAttribute("focusable","false");rb.setAttribute("viewBox",qa);this.uqg(rb,O);return rb};cb.prototype.uqg=function(O,qa){qa=Ol(qa);for(var rb=qa.next();!rb.done;rb=
qa.next()){rb=rb.value;var Sb=document.createElementNS(Ma.a.lNd,rb.type),Uc;for(Uc in rb){var vd=Uc,oe=rb[Uc];"className"===vd?Sb.setAttribute("class",oe):Sb.setAttribute(vd,oe)}O.appendChild(Sb)}};cb.prototype.oRe=function(O){return(O=window[O])?O.icons:null};Object(Oe.a)(cb,"SvgIconProvider",null,[371,6]);var Kc=xf.a;Em(Qa,Kc);Qa.prototype.create=function(){var O=this;sg.TaskExtensions.Aa(wf.a.iZ([107],4,this.rb,void 0,void 0,void 0,387),function(){var qa=he.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?
"excelInitialAppSprite":"excelAppSprite";window[qa]?O.Eb(O.$.ea.Ba(388)||new cb(O.$)):Tc.ULS.sendTraceTag(537151258,0,50,"window.[{0}] returned null.",qa)},this.la,3)};Qa.ja=function(O){O.ea.Ia(387,new Qa(O))};Object(Oe.a)(Qa,"SvgIconProviderFactory",xf.a,[]);var Bc=b(403),Fb=b(523),bc=b(235),ge=b(153),Jd=b(121),ue=b(9),qd=b(333),Ud=b(167),ed=b(13),xd=b(156),Lg=b(82),hg=b(232),Dg=b(105),cf=b(39),Hg=b(34),uh=Lg.a;Em(fb,uh);fb.prototype.dispose=function(){this.u9a();this.tableManager.qTi(Object(bd.a)(this,
this.ukf,"onCancelEditTable"));this.Q8e||zf.a.tr||zf.a.Uua||Ud.a.instance.za(ed.a.pointerDown,this.t$,Object(bd.a)(this,this.onPointerDown,"onPointerDown"));if(this.bA){hg.b(this.$,!1);try{this.Ou()}catch(O){Tc.ULS.sendTraceTag(537151236,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",O)}}this.parentElement&&this.parentElement.contains(this.t$)&&this.parentElement.removeChild(this.t$);this.t$=this.parentElement=null;uh.prototype.dispose.call(this)};fb.prototype.LVe=
function(O){var qa=O.bottom-this.xn.topLeft.bottom-1;return 0<=O.right-this.xn.topLeft.right+1&&0<=qa&&O.bottom>=this.xn.top&&O.right>=this.xn.left?new yf.Range(this.xn.top,this.xn.left,O.bottom,O.right,!1,!1):this.ss};fb.prototype.zdd=function(O){this.zqc([this.ss],6,void 0===O?!0:O);this.Kb.Jr(this.MXf)};fb.prototype.QDb=function(O){O=void 0===O?!0:O;this.Kb.mk(this.MXf);this.zqc([null],6,O)};fb.prototype.tBd=function(O){O=void 0===O?!0:O;this.Kb.mk(this.EXf);this.zqc([null],26,O)};fb.prototype.ORh=
function(){var O=!1;O=void 0===O?!0:O;var qa=this.eoj();0<qa.length&&(this.zqc(qa,26,O),this.Kb.Jr(this.EXf))};fb.prototype.eoj=function(){var O=[];this.xn.contains(this.ss)&&(this.xn.right!==this.ss.right&&O.push(new yf.Range(this.xn.top,this.ss.right+1,this.ss.bottom,this.xn.right,!1,!1)),this.xn.bottom!==this.ss.bottom&&O.push(new yf.Range(this.ss.bottom+1,this.xn.left,this.xn.bottom,this.xn.right,!1,!1)));return O};fb.prototype.onPointerDown=function(O){if(1!==this.$.Ka.jG())return!0;O=Hg.a(this.$).He(O);
if(this.bA)return!0;var qa=cf.a(this.$).G5e||cf.a(this.$).Eq();if(this.Tjd||qa)return this.u9a(),!0;this.ss=this.xn;this.tBd();this.zdd();qa=2===O.yb&&!O.Xn;var rb=3===O.yb;if(qa||rb)O=this.ga.Br(O.clientPoint,O.Sb,5,void 0,void 0,!0),O||(O=this.ss),this.Xvb=qa,this.zdc=rb,this.ss=this.LVe(O),this.zdd(),qa?this.JQi():rb&&this.sRi(),hg.b(this.$,!0);return!0};fb.prototype.pk=function(O){O=Hg.a(this.$).He(O);if(!this.bA)return!1;if(O=this.Xvb?this.ga.Br(O.clientPoint,O.Sb,5,void 0,void 0,!0):this.ga.Br(O.clientPoint,
O.Sb,5,!0,!1,!0))O=this.LVe(this.IVb(O)),this.FXb(O.bottomRight),this.ss.equals(O)||(this.ss=O,this.QDb(!1),this.tBd(!1),this.zdd(!1),this.ORh(),this.Kb.update(!1)),this.Fwj(this.ss);return!0};fb.prototype.Ah=function(O){Hg.a(this.$).He(O);if(!this.bA)return!1;this.resizeTable();this.u9a();return!0};fb.prototype.nBb=function(O){Hg.a(this.$).He(O);if(!this.bA)return Tc.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();
this.u9a();return!0};fb.prototype.resizeTable=function(){if(!this.ss.equals(this.xn)){var O=new yf.Range(this.xn.top,this.xn.left,this.ss.bottom,this.ss.right,!1,!1);this.vsj(O);this.Tjd=!0}};fb.prototype.Iwa=function(O){Hg.a(this.$).He(O);this.u9a();return!0};fb.prototype.onKeyDown=function(O){Hg.a(this.$).He(O);return!0};fb.prototype.ukf=function(){this.bA&&this.u9a()};fb.prototype.s6a=function(){this.Q8e&&(zf.a.tr||zf.a.Uua||(Ud.a.instance.pa(ed.a.pointerDown,this.t$,Object(bd.a)(this,this.onPointerDown,
"onPointerDown")),this.t$.classList.remove("ewr-table-resize-default-cursor"),this.TFc=this.t$.disabled=!1),this.TFc=!1)};fb.prototype.YEg=function(){var O=document.createElement("div");O.className="ewr-table-resize-handle";var qa=document.createElement("div");qa.className="ewr-table-resize-fillhandle-higher";var rb=document.createElement("div");rb.className="ewr-table-resize-fillhandle-broader";O.appendChild(qa);O.appendChild(rb);this.t$=O;this.parentElement.appendChild(this.t$)};fb.prototype.FXb=
function(O){var qa=this,rb=this.ss.contains(O),Sb=O.top,Uc=O.bottom,vd=O.left;O=O.right;var oe=null;if(rb){if(this.gridView.gja(this.xn.topLeft)&&!this.xn.aQa)return;Sb=Math.max(1,Uc-5,this.xn.top);vd=Math.max(1,O-5,this.xn.left);Uc=Sb;O=vd;oe=new yf.Range(Sb,vd,Sb,vd,!1,!1)}else Uc+=5,O+=5,Sb=Uc,vd=O,oe=new yf.Range(Uc,O,Uc,O,!1,!1);this.gridView.gja(oe)||(this.$q?this.$q.Do||(this.$q=Qc.a.instance.create(function(){qa.gridView.kt(oe,60,Dg.a.JXf)},40,md.a.KXf)):this.$q=Qc.a.instance.create(function(){qa.gridView.kt(oe,
60,Dg.a.JXf)},40,md.a.KXf))};fb.prototype.IVb=function(O){var qa=O;if(this.gridView.Wa.t3){if(!this.gridView.tc(O.topLeft)){var rb=this.gridView.mm("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.aJ,this.ss.top!==O.top?1:2);try{rb.Lk=this.ss.top<O.top||this.ss.left<O.left,rb.uu(O.topLeft),qa=rb.$$cu().range}finally{rb&&rb.dispose()}}qa.right=qa.left+O.width-1;qa.bottom=qa.top+O.height-1}return qa};fb.prototype.zqc=function(O,qa,rb){rb=void 0===rb?!0:rb;var Sb=[];O=Ol(O);for(var Uc=O.next();!Uc.done;Uc=
O.next())Sb.push(new qd.a(Uc.value,le.d(this.$.qa)));this.Kb.Hs(Sb,[qa],!0,void 0,rb)};fb.prototype.JQi=function(){for(var O=Ol(this.gridView.ao),qa=O.next();!qa.done;qa=O.next())Ud.a.instance.pa(ed.a.Ch,qa.value.domElement,Object(bd.a)(this,this.pk,"onPointerMove"));Ud.a.instance.pa(ed.a.Ud,document.documentElement,Object(bd.a)(this,this.Ah,"onPointerUp"));this.Lze()};fb.prototype.sRi=function(){for(var O=Ol(this.gridView.ao),qa=O.next();!qa.done;qa=O.next())xd.a.instance.pa(ed.a.Gg,qa.value.domElement,
Object(bd.a)(this,this.pk,"onPointerMove"));xd.a.instance.pa(ed.a.ye,document.documentElement,Object(bd.a)(this,this.nBb,"onTouchUp"));this.Lze()};fb.prototype.Ou=function(){this.Xvb&&this.cvj();this.zdc&&this.nvj()};fb.prototype.cvj=function(){for(var O=Ol(this.gridView.ao),qa=O.next();!qa.done;qa=O.next())Ud.a.instance.za(ed.a.Ch,qa.value.domElement,Object(bd.a)(this,this.pk,"onPointerMove"));Ud.a.instance.za(ed.a.Ud,document.documentElement,Object(bd.a)(this,this.Ah,"onPointerUp"));this.vCf()};
fb.prototype.nvj=function(){for(var O=Ol(this.gridView.ao),qa=O.next();!qa.done;qa=O.next())xd.a.instance.za(ed.a.Gg,qa.value.domElement,Object(bd.a)(this,this.pk,"onPointerMove"));xd.a.instance.za(ed.a.ye,document.documentElement,Object(bd.a)(this,this.nBb,"onTouchUp"));this.vCf()};fb.prototype.Lze=function(){Ud.a.instance.pa(ed.a.Hy,document.documentElement,Object(bd.a)(this,this.Iwa,"onPointerLeave"));this.gridView.uc.q3b(!0)};fb.prototype.vCf=function(){Ud.a.instance.za(ed.a.Hy,document.documentElement,
Object(bd.a)(this,this.Iwa,"onPointerLeave"));this.gridView.uc.q3b(!1)};fb.prototype.vsj=function(O){var qa={};O=(qa.ResizeTableRange=O,qa.OriginalTableRange=this.xn,qa);this.$.De(-1400250766,Zd.a.Tb,30,O)};fb.prototype.Fwj=function(O){if(!this.xn.contains(O)){O=this.doj();O=Ol(O);for(var qa=O.next();!qa.done;qa=O.next())if(this.tableManager.ukd(qa.value)){this.gridView.wi.wA(Ue.a.pli);return}}this.gridView.rtl?this.gridView.wi.wA(Ue.a.vki):this.gridView.wi.wA(Ue.a.Xmi)};fb.prototype.u9a=function(){if(this.bA){hg.b(this.$,
!1);try{this.Ou()}catch(O){Tc.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",O)}}this.$q&&(this.$q.cancel(),this.$q.dispose());this.zdc=this.Xvb=!1;this.QDb();this.tBd();hg.b(this.$,!1);this.gridView.wi.wA(Ue.a.Ota)};fb.prototype.doj=function(){var O=[];this.xn.right!==this.ss.right&&O.push(new yf.Range(this.xn.top,this.xn.right+1,this.ss.bottom,this.ss.right,!1,!1));this.xn.bottom!==this.ss.bottom&&O.push(new yf.Range(this.xn.bottom+
1,this.xn.left,this.ss.bottom,this.xn.right,!1,!1));return O};fb.createInstance=function(O,qa,rb,Sb){if(!qa)return null;var Uc=O.Kb;Uc.Hs(rb,[27],!0);Uc.Jr(fb.Znj);rb=Uc.hJ(27,O.Wa.Bj(qa.bottomRight),fb.uyh(qa,rb)).Rm;return new fb(rb,O,qa,Sb)};fb.uyh=function(O,qa){for(var rb=0;rb<qa.length;rb++)if(qa[rb]&&qa[rb].range&&qa[rb].range.equals(O))return rb;return 0};Ll.Object.defineProperties(fb.prototype,{bA:{configurable:!0,enumerable:!0,get:function(){return this.Xvb||this.zdc}},Q8e:{configurable:!0,
enumerable:!0,get:function(){return this.TFc}}});fb.Znj=[27];Object(Oe.a)(fb,"TableResizeBehavior",Lg.a,[]);var te=b(230);sb.oeh="ewa-ttrd-buttonarea";Object(Oe.a)(sb,"CssClassNames",null,[]);var Wg=b(45),Kf=b(125),nd=b(92),qe=b(127),Qg=b(258),ae=te.a;Em(jc,ae);jc.prototype.dispose=function(){this.$&&this.F1g();this.$=this.gridView=this.parentElement=this.MIa=null;ae.prototype.dispose.call(this)};jc.prototype.owh=function(O){var qa=this.dKh(this.gridView.tc(null).range);return qa?String.format("=SUBTOTAL({0},{1})",
O,qa):null};jc.prototype.dKh=function(O){var qa=Hf.g(this.$).$b.Mk(O);if(!qa)return null;qa=ge.a(qa,!1);qa.right=qa.left=O.left;return qa.toString()};jc.prototype.XVh=function(){jc.aL={};jc.aL["100"]=Sc.a.instance.da(1036);jc.aL["101"]=Sc.a.instance.da(1039);jc.aL["102"]=Sc.a.instance.da(1038);jc.aL["103"]=Sc.a.instance.da(1043);jc.aL["104"]=Sc.a.instance.da(1040);jc.aL["105"]=Sc.a.instance.da(1041);jc.aL["109"]=Sc.a.instance.da(1037);jc.aL["107"]=Sc.a.instance.da(1044);jc.aL["110"]=Sc.a.instance.da(1046);
jc.aL["111"]=Sc.a.instance.da(1097)};jc.prototype.aEi=function(){var O=this.gridView.tc(null);if(O&&(O=O.mJ?O.formulaBarText:null))if("=SUBTOTAL("===O.substring(0,10)){if(O=O.substring(10,13),O in jc.aL)return O}else return"111";return"100"};jc.prototype.uzg=function(){this.gridView.Ca.Pp(Object(bd.a)(this,this.Be,"onBlockCacheItemChanged"));this.gridView.ga.CF(Object(bd.a)(this,this.mh,"onActiveCellChanged"));this.gridView.uq(Object(bd.a)(this,this.onContentReady,"onContentReady"));this.gridView.uc.Jm(Object(bd.a)(this,
this.zkf,"onCellEditStarted"));this.gridView.uc.Xr(Object(bd.a)(this,this.Ozb,"onCellEditEnded"))};jc.prototype.F1g=function(){this.gridView&&(this.gridView.ga&&(this.gridView.ga.SM(Object(bd.a)(this,this.mh,"onActiveCellChanged")),this.gridView.Ca.Ko(Object(bd.a)(this,this.Be,"onBlockCacheItemChanged"))),this.gridView.Cs(Object(bd.a)(this,this.onContentReady,"onContentReady")),this.gridView.uc&&(this.gridView.uc.ym(Object(bd.a)(this,this.zkf,"onCellEditStarted")),this.gridView.uc.Fr(Object(bd.a)(this,
this.Ozb,"onCellEditEnded"))),this.s1f())};jc.prototype.Wnb=function(O){this.Qwj(O);this.Iwb&&(this.Jmj(),this.Fjb?(this.yvf||this.Fzg(),this.YNc?this.J3=!1:(this.J3=!0,this.sGf())):(Tc.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.J3=!1))};jc.prototype.sGf=function(){var O=this;appChrome.renderTableTotalRowOptions(this.parentElement,jc.aL,jc.aL[this.aEi()].toString(),Math.round(Hg.a(this.$).ri(17)),function(qa){Tc.ULS.sendTraceTag(537151198,
0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",qa);var rb={};rb=(rb.SelectedOption=jc.aL[qa],rb.FunctionKeyCode=qa,rb.Location="canvas",rb);qe.b(O.$).ee(Kf.a.joj,rb,null,!0);if("111"===qa)return O.mZh(),!0;if("100"!==qa){O.NFb=O.owh(qa);if(!O.NFb)return Tc.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;O.XOa(O.NFb)}else O.XOa("");mf.DOMElementExtensions.setFocus(O.gridView.Gc.textBox.domElement);return!0})};
jc.prototype.mZh=function(){Tc.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var O=new nd.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Ub(O)};jc.prototype.yta=function(O){if(!O)return null;var qa=this.gridView.uc.textBox.domElement;var rb=0<mf.DOMElementExtensions.getHeight(qa)&&0<mf.DOMElementExtensions.getWidth(qa)&&0<=qa.offsetTop&&0<=qa.offsetLeft;if(rb)qa=mf.DOMElementExtensions.yta(qa,this.gridView.Gi);else{qa=this.gridView.getCellBounds(O.cell);
var Sb=mf.DOMElementExtensions.getBoundingClientRect(this.gridView.Gi);qa=new Sys.UI.Bounds(qa.x-Sb.x,qa.y-Sb.y,qa.width,qa.height)}if(qa)if(rb)2<qa.height&&2<qa.height&&(qa.x+=1,qa.y+=1,qa.height-=2,qa.width-=2);else if(rb=Hf.g(this.$).cJ(O.cell))rb=rb.width,Sb=Yd.a.equals(Vg.a.y0a(O.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Sb&&(qa.x=qa.x+qa.width-rb),O.mja&&this.gridView.rtl===Sb&&(qa.width=rb);else return null;return qa};jc.prototype.Qwj=function(O){var qa=this.Fjb;if(qa){var rb=
17>=qa.height?qa.y:qa.y+qa.height-17-2;qa=this.j3h?this.gridView.rtl?qa.x:qa.x+qa.width-(17<qa.height?17:qa.height):this.gridView.rtl?qa.x-(17<qa.height?17:qa.height):qa.x+qa.width;var Sb=Hg.a(this.$).xIa(new Sys.UI.Point(qa,rb));this.parentElement.style.top=ue.HelperMethods.Pb(Sb.y);this.parentElement.style.left=ue.HelperMethods.Pb(Sb.x);Hg.a(this.$).i9i(this.parentElement);O&&(this.J3=this.gridView.Jdc(new Wg.a(qa,rb)))}else this.J3=!1};jc.prototype.Fzg=function(){this.MIa.insertBefore(this.parentElement,
this.MIa.firstChild);this.yvf=!0};jc.prototype.Jmj=function(){this.GP||(this.gridView.view.Us(Object(bd.a)(this,this.fq,"onGridScroll")),this.GP=!0)};jc.prototype.s1f=function(){this.GP&&this.gridView.view&&(this.gridView.view.Gr(Object(bd.a)(this,this.fq,"onGridScroll")),this.GP=!1)};jc.prototype.XOa=function(O){var qa=this.gridView.Gc,rb=this.gridView.tc(null);rb&&(O=Object.assign(new Qg.a,{Text:O}),this.gridView.setCell(O,rb.range,0,127,null),qa.endEdit(!0,"TableTotalRowOptions.SetCellContent",
0))};jc.prototype.mh=function(){Vb.c(this.$,this.gridView.ga.wa.activeCell)?(this.JJa=!0,this.Wnb(!1)):(this.J3=this.JJa=!1,this.s1f())};jc.prototype.fq=function(){this.JJa?this.Wnb(!0):this.J3=!1};jc.prototype.zkf=function(){this.YNc=!0;this.JJa&&(this.J3=!1)};jc.prototype.onContentReady=function(){this.$.isEditMode?Vb.c(this.$,this.gridView.ga.wa.activeCell)&&(this.JJa=!0,this.Wnb(!1)):this.J3=!1};jc.prototype.Ozb=function(){this.YNc=!1;this.JJa?this.Wnb(!1):this.J3=!1};jc.prototype.Be=function(O,
qa){this.JJa&&(O=this.gridView.Mvd(qa.Ed.block.ue.BlockCachePosition.PaneType).fF(qa.Ed.hash))&&(O.KCd(Object(bd.a)(this,this.YIa,"headerBlockOnUpdatedBlockHtml")),O.eQc(Object(bd.a)(this,this.YIa,"headerBlockOnUpdatedBlockHtml")))};jc.prototype.YIa=function(){this.sGf()};Ll.Object.defineProperties(jc.prototype,{J3:{configurable:!0,enumerable:!0,get:function(){return this.dhd},set:function(O){this.dhd!==O&&(this.dhd=this.isVisible=O)}},Iwb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.zd&
16)}},j3h:{configurable:!0,enumerable:!0,get:function(){var O=this.gridView.ga.wa.activeCell;return O.right===O.maxColumns}},Fjb:{configurable:!0,enumerable:!0,get:function(){var O=this.gridView.tc(null);return O&&this.gridView.XY(O.range)?this.yta(O):(O&&Tc.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});jc.ioj="TableTotalRowDropDownIconButtonId";jc.aL=null;Object(Oe.a)(jc,"TableTotalRowOptions",te.a,[6]);Em(Db,Nc);Db.prototype.ege=
function(O){this.addHandler(Nc.ozd,O)};Db.prototype.FFf=function(O){this.removeHandler(Nc.ozd,O)};Db.prototype.urg=function(O){this.addHandler("tce",O)};Db.prototype.qTi=function(O){this.removeHandler("tce",O)};Db.prototype.ukd=function(O){return!!this.cTe(O)};Db.prototype.zo=function(O){return this.fGh(this.HTe(O))};Db.prototype.suh=function(O){return this.HTe(O)};Db.prototype.oRi=function(O){O?(this.umb?this.umb!==O&&(If.a.Fa(this.D_),this.D_=null,this.umb=O):this.umb=O,this.D_||(this.D_=Jd.a.instance.yd(this.umb)),
this.D_.Zz("focusin")||this.D_.ja("focusin",Object(bd.a)(this,this.onFocus,"onFocus"))):Tc.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};Db.prototype.r5e=function(O,qa){return O?O.bua&&O.top===qa.top:(Tc.ULS.shipAssertTag(537151244,0,!!O,"autofilterRange can't be null"),!1)};Db.prototype.wIa=function(O){O=this.smb?Bf.I(O,this.smb):this.view.getRangeInformation(O);return 0<O.length&&Object(Bc.a)(bc.PivotTableRange,O[0])?O[0]:null};Db.prototype.h0h=
function(O,qa){return O?!O.Dbc&&!!O.d9&&O.d9.$d(qa):(Tc.ULS.shipAssertTag(537151243,0,!!O,"Pivot table can't be null"),!1)};Db.prototype.K5h=function(O,qa){return O?!O.Dbc&&!!O.uOa&&O.uOa.$d(qa):(Tc.ULS.shipAssertTag(537151242,0,!!O,"Pivot table can't be null"),!1)};Db.prototype.RUb=function(O){Nc.prototype.RUb.call(this,O);if((O=ue.HelperMethods.qTe(O))&&0<O.length){this.smb=Array(O.length);for(var qa=0;qa<O.length;qa++)this.smb[qa]=jd.a.uP(O[qa])}};Db.prototype.LDb=function(){Nc.prototype.LDb.call(this);
this.smb=null};Db.prototype.vRg=function(O,qa){return this.wue(O,qa).returnValue};Db.prototype.wue=function(O,qa){var rb=this;var Sb=!1;if(!O||!qa)return{returnValue:!1,vX:Sb};O=O.clone();O.right+=1;O.left=O.right;if(!O.isValidRange)return{returnValue:!1,vX:Sb};if(O.top<qa.Wa.Hi){var Uc=O.clone();Uc.bottom>=qa.Wa.Hi&&(Uc.bottom=qa.Wa.Hi-1);if(!function(){var oe=rb.vue(Uc,qa);Sb=oe.vX;return oe}().returnValue)return{returnValue:!1,vX:Sb}}if(O.bottom>=qa.Wa.Hi){var vd=O.clone();vd.top<=qa.Wa.Hi&&(vd.top=
qa.Wa.Hi);if(!function(){var oe=rb.vue(vd,qa);Sb=oe.vX;return oe}().returnValue)return{returnValue:!1,vX:Sb}}return{returnValue:!0,vX:Sb}};Db.prototype.LXf=function(O){(O=this.zo(O.topLeft))&&O.toString()in this.xDa&&(this.xDa[O.toString()].Tjd=!1)};Db.prototype.rLi=function(){this.raiseEvent("tce")};Db.prototype.Vh=function(O,qa){if(!this.Ttc)return!1;switch(qa){case -569786022:case 541421805:if(this.Ttc.J3){var rb=document.getElementById(jc.ioj);rb&&Qc.a.instance.create(function(){mf.DOMElementExtensions.Xub(rb,
null)},0,md.a.boj,!0,!0)}return!0;default:return!1}};Db.prototype.dispose=function(){this.fZb(null,null);this.FFf(Object(bd.a)(this,this.ZWb,"attachTableResizeBehavior"));this.$.va.zg(Object(bd.a)(this,this.VAf,"reAttachTableBehviors"));this.$.Lo(Object(bd.a)(this,this.fZb,"clearAllActiveTableBehaviors"));this.dMb=null;this.$.fa&&this.$.fa.J5(Object(bd.a)(this,this.P4,"onApplicationModeChanged"));this.gridView.ga.SM(Object(bd.a)(this,this.mh,"onActiveCellChanged"));this.Ttc=null;he.EwaSettings.ka(424)&&
this.D_&&(If.a.Fa(this.D_),this.D_=null);Nc.prototype.dispose.call(this)};Db.prototype.tPh=function(O,qa,rb,Sb){var Uc=this.gridView.$b.Mk(new yf.Range(qa,rb,qa,rb,!1,!1));if(this.g1b=Uc){var vd=Uc.usedRange,oe=O.ctrlKey||zf.a.isMac&&yg.b(O),ef=!O.shiftKey&&oe;O=O.shiftKey&&!oe;he.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(Hf.g(this.$).ga.selectionType=3);switch(Sb){case 0:this.xNb=0;he.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(qa=this.ZZc(O,vd.top,rb,vd.bottom,rb),this.fId(qa,ef,O)):this.gId(vd.top,rb,vd.bottom,rb,ge.d(Uc),ge.g(Uc),ef);break;case 1:this.xNb=1;he.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(qa=this.ZZc(O,qa,vd.left,qa,vd.right),this.fId(qa,ef,O)):this.gId(qa,vd.left,qa,vd.right,!1,!1,ef);break;case 2:this.xNb=2;he.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(qa=this.ZZc(O,vd.top,vd.left,vd.bottom,vd.right),this.fId(qa,
ef,O)):this.gId(vd.top,vd.left,vd.bottom,vd.right,ge.d(Uc),ge.g(Uc),ef);break;default:Tc.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Sb.toString())}he.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(Hf.g(this.$).ga.selectionType=3)}else Tc.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};Db.prototype.Pcj=function(O){var qa=
this.g1b.usedRange;return this.w7e(O)||1!==this.WFa&&this.w7e(new yf.Range(qa.top,O.left,qa.bottom,O.right,!1,!1))?!0:!1};Db.prototype.nzd=function(O){return O.Autofilters};Db.prototype.ZWb=function(){var O={},qa=this.iad(),rb;for(rb in qa){var Sb=qa[rb];if(Sb){var Uc=this.mJh(Sb);if(Uc){if(Uc in this.xDa){var vd=this.xDa[Uc];if(vd.bA){vd.xn.equals(Sb)||(vd.xn=Sb);delete this.xDa[Uc];O[Uc]=vd;continue}}(vd=fb.createInstance(Hf.g(this.$),Sb,this.Dth(),this))?O[Uc]=vd:Tc.ULS.sendTraceTag(537151239,
0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",Sb.nG(!1))}}}this.fZb(null,null);this.dMb=O};Db.prototype.fZb=function(){var O=this.xDa,qa;for(qa in O){var rb=qa,Sb=O[qa];Sb&&(Sb.dispose(),delete this.xDa[rb])}this.dMb={}};Db.prototype.vue=function(O,qa){var rb=!1;var Sb=qa.Wa.Bj(O),Uc=qa.Mf(Sb).Hh;if(!Uc)return Tc.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",Sb),{returnValue:!1,vX:rb};if(!Uc.Ef(O))return{returnValue:!0,
vX:rb};O=qa.mm("TableManager.CouldExpandImpl",O,2);try{for(;O.$$mn();){if(!Yd.a.ma(O.$$cu().text)||O.jn.bZe)return rb=!0,{returnValue:!1,vX:rb};if(O.$$cu().cM)return{returnValue:!1,vX:rb}}}finally{O&&O.dispose()}return{returnValue:!0,vX:rb}};Db.prototype.fGh=function(O){if(!O)return null;var qa=new Fb.AutofilterRange(O.top,O.left,O.bottom,O.right,null,null,null,O.id,O.bua);qa.aQa=O.aQa;for(var rb=0,Sb=this.rangeList.length;rb<Sb;rb++){var Uc=this.rangeList[rb];Uc.id===O.id&&Uc!==O&&this.S4h(Uc)&&
(qa.union(Uc),Uc.aQa&&(qa.aQa=!0))}return qa};Db.prototype.S4h=function(O){return!!Hf.g(this.$).$b.Mk(O)};Db.prototype.Dth=function(){for(var O=[],qa=Ol(this.rangeList),rb=qa.next();!rb.done;rb=qa.next())rb=new qd.a(this.zo(rb.value.topLeft),le.d(this.$.qa)),O.push(rb);return O};Db.prototype.iad=function(){for(var O={},qa=Ol(this.rangeList),rb=qa.next();!rb.done;rb=qa.next())if(rb=rb.value){var Sb=this.zo(rb.topLeft);Sb&&(O[Sb.toString()]=this.zo(rb.topLeft))}return O};Db.prototype.VAf=function(){this.fZb(null,
null);this.ZWb(null,null)};Db.prototype.onFocus=function(){this.A2d=Hf.g(this.$).ga.wa.activeCell};Db.prototype.P4=function(){this.$.isEditMode&&this.mh(null,null)};Db.prototype.mh=function(){!this.Zhe&&Vb.c(this.$,this.gridView.ga.wa.activeCell)&&this.ibi()};Db.prototype.ibi=function(){this.$.fa.Wh?this.Jub(0):this.$.fa.oo(Object(bd.a)(this,this.vM,"onAppInteractive"))};Db.prototype.vM=function(){this.Jub(1);this.$.fa.Er(Object(bd.a)(this,this.vM,"onAppInteractive"))};Db.prototype.Jub=function(O){var qa=
this;this.$.RD(function(rb){rb.fta(O).then(Object(bd.a)(qa,qa.vCb,"postAppChromeLoadActions"))})};Db.prototype.vCb=function(){this.Zhe=!0;this.Ttc=new jc(this.$)};Db.prototype.mJh=function(O){var qa=this.gridView.$b.Mk(O);return qa?qa.name:O.toString()};Db.prototype.gId=function(O,qa,rb,Sb,Uc,vd,oe){var ef=O+(Uc?1:0),Nf=rb-(vd?1:0),kh=this.gridView.inRangePicker||this.gridView.li,Md=!1,Je=new yf.Range(ef,qa,Nf,Sb,!1,!1);if(Uc||vd)for(Uc=kh?qd.a.JYa(this.gridView.ga.rangePicker.UJ):this.gridView.ga.wa.selectedRanges,
Uc=Ol(Uc),vd=Uc.next();!vd.done;vd=Uc.next()){vd=vd.value;Md=this.wnb(vd,ef,qa,Nf,Sb);var qf=this.wnb(vd,O,qa,rb,Sb);if(kh&&Md)break;if(!kh&&(Md||qf)){this.gridView.ga.updateSelection(vd,vd.topLeft,0,1);if(oe&&qf)return;break}}Md&&(Je.top=O,Je.bottom=rb);O=Je.topLeft;oe?this.gridView.ga.updateSelection(Je,O,0,1):kh?this.gridView.ga.JC([Je],0,O,0):this.gridView.ga.updateSelection(Je,O,0,3)};Db.prototype.fId=function(O,qa,rb){O&&(rb=rb?Hf.g(this.$).ga.wa.activeCell:O.topLeft,qa?this.gridView.ga.updateSelection(O,
rb,0,1):this.gridView.ga.JC([O],0,rb,0))};Db.prototype.ZZc=function(O,qa,rb,Sb,Uc){var vd=ge.d(this.g1b),oe=ge.g(this.g1b),ef=qa+(1!==this.WFa&&vd?1:0),Nf=Sb-(1!==this.WFa&&oe?1:0),kh=this.gridView.inRangePicker||this.gridView.li;if(O){var Md=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&kh&&!qd.a.JYa(this.gridView.ga.rangePicker.UJ).length?new yf.Range(ef,rb,Nf,Uc,!1,!1):kh?this.gridView.ga.rangePicker.activeCell:this.gridView.ga.wa.activeCell;Md=new yf.Range(Md.top<
ef?Md.top:ef,Md.left<rb?Md.left:rb,Md.bottom>Nf?Md.bottom:Nf,Md.right>Uc?Md.right:Uc,!1,!1)}else Md=new yf.Range(ef,rb,Nf,Uc,!1,!1);if(1!==this.WFa&&(vd||oe)&&(!O||O&&this.wnb(Md,ef,rb,Nf,Uc)))for(O=kh?qd.a.JYa(this.gridView.ga.rangePicker.UJ):this.gridView.ga.wa.selectedRanges,O=Ol(O),vd=O.next();!vd.done;vd=O.next())if(this.wnb(vd.value,ef,rb,Nf,Uc)){Md.top=qa;Md.bottom=Sb;break}return Md};Db.prototype.w7e=function(O){var qa=this.gridView.inRangePicker||this.gridView.li?qd.a.JYa(this.gridView.ga.rangePicker.UJ):
this.gridView.ga.wa.selectedRanges;qa=Ol(qa);for(var rb=qa.next();!rb.done;rb=qa.next())if(this.wnb(rb.value,O.top,O.left,O.bottom,O.right))return!0;return!1};Db.prototype.wnb=function(O,qa,rb,Sb,Uc){return!!O&&O.top===qa&&O.bottom===Sb&&O.left===rb&&O.right===Uc};Ll.Object.defineProperties(Db.prototype,{xDa:{configurable:!0,enumerable:!0,get:function(){return this.dMb}},Gld:{configurable:!0,enumerable:!0,get:function(){return this.A2d}},WFa:{configurable:!0,enumerable:!0,get:function(){return this.xNb}},
Ij:{configurable:!0,enumerable:!0,get:function(){var O=Hf.g(this.$);return O.$b.Mk(O.ga.wa.activeCell,!1)}},Zxd:{configurable:!0,enumerable:!0,get:function(){return this.Gld?Hf.g(this.$).$b.Mk(this.Gld,!1):null}}});Object(Oe.a)(Db,"TableManager",Nc,[376,6]);var Nh=xf.a;Em(Hb,Nh);Hb.prototype.create=function(){this.Eb(this.tableManager||(this.tableManager=new Db(this.$)))};Object(Oe.a)(Hb,"TableManagerFactory",xf.a,[]);var wd=b(110),ze=b(931),Ah=b(1398),Xh=b(833),pg=b(1349),vg=b(162),Ih=b(81),Eh=b(103),
Zh=b(26),ih=b(180),eg=b(27),oh=b(303);Object(Oe.a)(Qb,"TableStyleElement",null,[]);var Hh=b(859),X=b(197),Xa=b(84),Pb=b(549);Sa.odf=function(O,qa){return Sa.OXf[O.Type]-Sa.OXf[qa.Type]};Sa.N0a=function(O,qa){try{return appChrome.buildTableStyleGalleryIconNew(Sa.hza,Sa.rma,O,qa)}catch(rb){return null}};Sa.S8e=function(O){return O&&Zd.a.Md in O&&(O=O[Zd.a.Md],!Yd.a.ma(O))?Yd.a.HH(O,Ue.a.DCb):!1};Sa.gra=function(O){var qa=[],rb=0;O=Ol(O);for(var Sb=O.next();!Sb.done;Sb=O.next()){Sb=Sb.value;qa[rb]={};
qa[rb].backgroundColor="white";qa[rb].color="black";for(var Uc in Sb){var vd=Sb[Uc];switch(Uc){case "background-color":qa[rb].backgroundColor=vd;break;case "color":qa[rb].color=vd;break;case "font-size":qa[rb].fontSize=vd;break;case "border-bottom":qa[rb].borderBottom=vd;break;case "border-right":qa[rb].borderRight=vd;break;case "border-left":qa[rb].borderLeft=vd;break;case "border-top":qa[rb].borderTop=vd}}rb++}return qa};Sa.N_b=function(O,qa){var rb=[];if(O&&O.TableStyleElementsList)for(var Sb=
!O.Category,Uc=0;Uc<Sa.rma;Uc++)rb.push.apply(rb,Sa.lxh(O,qa,Sb,Uc));else{if(Sa.w0c)return Sa.w0c;O={color:"black","background-color":"white"};for(qa=0;qa<Sa.rma;qa++)for(Sb=0;Sb<Sa.hza;Sb++)rb.push(O);Sa.w0c=rb}return rb};Sa.nJh=function(O,qa){if(!O.TableStyleElementsList)return"";var rb="";O=Ol(O.TableStyleElementsList);for(var Sb=O.next();!Sb.done;Sb=O.next())if(Sb=Sb.value,!Yd.a.ma(Sb.BackgroundColor)&&"#000000"!==Sb.BackgroundColor)switch(Sb.Type){case 0:rb=Sb.BackgroundColor;break;case 5:case 7:if(qa.rga||
qa.KQ)rb=Sb.BackgroundColor;break;case 3:case 4:if(qa.firstCol||qa.lastCol)rb=Sb.BackgroundColor;break;case 2:qa.totalRow&&(rb=Sb.BackgroundColor);break;case 1:qa.headerRow&&(rb=Sb.BackgroundColor)}return rb};Sa.LZb=function(O){O=new X.a(parseInt(String("0x"+O.substr(1,2))),parseInt(String("0x"+O.substr(3,2))),parseInt(String("0x"+O.substr(5,2))));return Hh.a.sIa(O)};Sa.iVe=function(O,qa){if(!O||!qa)return"";qa=Sa.nJh(O,qa);qa=Yd.a.ma(qa)?Sc.a.instance.da(1978)+", ":Sa.LZb(qa)+", ";switch(O.Index){case 0:return qa+
Sc.a.instance.da(1912);case 1:return qa+Sc.a.instance.da(1913);case 2:return qa+Sc.a.instance.da(1914);case 3:return qa+Sc.a.instance.da(1915);case 4:return qa+Sc.a.instance.da(1916);case 5:return qa+Sc.a.instance.da(1917);case 6:return qa+Sc.a.instance.da(1918);case 7:return qa+Sc.a.instance.da(1919);case 8:return qa+Sc.a.instance.da(1920);case 9:return qa+Sc.a.instance.da(1921);case 10:return qa+Sc.a.instance.da(1922);case 11:return qa+Sc.a.instance.da(1923);case 12:return qa+Sc.a.instance.da(1924);
case 13:return qa+Sc.a.instance.da(1925);case 14:return qa+Sc.a.instance.da(1926);case 15:return qa+Sc.a.instance.da(1927);case 16:return qa+Sc.a.instance.da(1928);case 17:return qa+Sc.a.instance.da(1929);case 18:return qa+Sc.a.instance.da(1930);case 19:return qa+Sc.a.instance.da(1931);case 20:return qa+Sc.a.instance.da(1932);case 21:return qa+Sc.a.instance.da(1933);case 22:return qa+Sc.a.instance.da(1934);case 23:return qa+Sc.a.instance.da(1935);case 24:return qa+Sc.a.instance.da(1936);case 25:return qa+
Sc.a.instance.da(1937);case 26:return qa+Sc.a.instance.da(1938);case 27:return qa+Sc.a.instance.da(1939);case 28:return qa+Sc.a.instance.da(1940);case 29:return qa+Sc.a.instance.da(1941);case 30:return qa+Sc.a.instance.da(1942);case 31:return qa+Sc.a.instance.da(1943);case 32:return qa+Sc.a.instance.da(1944);case 33:return qa+Sc.a.instance.da(1945);case 34:return qa+Sc.a.instance.da(1946);case 35:return qa+Sc.a.instance.da(1947);case 36:return qa+Sc.a.instance.da(1948);case 37:return qa+Sc.a.instance.da(1949);
case 38:return qa+Sc.a.instance.da(1950);case 39:return qa+Sc.a.instance.da(1951);case 40:return qa+Sc.a.instance.da(1952);case 41:return qa+Sc.a.instance.da(1953);case 42:return qa+Sc.a.instance.da(1954);case 43:return qa+Sc.a.instance.da(1955);case 44:return qa+Sc.a.instance.da(1956);case 45:return qa+Sc.a.instance.da(1957);case 46:return qa+Sc.a.instance.da(1958);case 47:return qa+Sc.a.instance.da(1959);case 48:return qa+Sc.a.instance.da(1960);case 49:return qa+Sc.a.instance.da(1961);case 50:return qa+
Sc.a.instance.da(1962);case 51:return qa+Sc.a.instance.da(1963);case 52:return qa+Sc.a.instance.da(1964);case 53:return qa+Sc.a.instance.da(1965);case 54:return qa+Sc.a.instance.da(1966);case 55:return qa+Sc.a.instance.da(1967);case 56:return qa+Sc.a.instance.da(1968);case 57:return qa+Sc.a.instance.da(1969);case 58:return qa+Sc.a.instance.da(1970);case 59:return qa+Sc.a.instance.da(1971);default:return Yd.a.ma(O.Name)?"":O.Name}};Sa.VDh=function(O){return(O+1)%Sa.HSh};Sa.Usb=function(O,qa,rb){rb=
void 0===rb?"":rb;return O||Yd.a.ma(rb)?String.format("{0}, {1}, -version, {2}",Sa.i0e,O.Index.toString(),qa.toString()):String.format("{0}, {1}, -version, {2}",Sa.i0e,rb,qa.toString())};Sa.lxh=function(O,qa,rb,Sb){for(var Uc=[],vd=0;vd<Sa.hza;vd++)Uc.push(Sa.O8c(O,qa,rb,Sb,vd));return Uc};Sa.O8c=function(O,qa,rb,Sb,Uc){var vd=O.TableStyleElementsList;O=new Qb;var oe={};if(!vd)return oe;for(var ef=Ol(vd),Nf=ef.next();!Nf.done;Nf=ef.next())if(Nf=Nf.value,!Nf.Type){O=Nf;break}ef=!Yd.a.ma(O.BackgroundColor);
var kh="";!rb&&O.TableStyleBorderFromatList&&0<O.TableStyleBorderFromatList.length&&(kh=O.TableStyleBorderFromatList[0].Color);oe["background-color"]=ef?O.BackgroundColor:"#FFFFFF";Yd.a.ma(O.FontColor)&&(O.FontColor="#000000");oe.color=O.FontColor;Sa.Ape(Sb,Uc,oe,O,kh,rb,ef);vd=Ol(vd);for(Nf=vd.next();!Nf.done;Nf=vd.next())(Nf=Nf.value)&&Nf.Type&&(2!==Nf.Type||ef||(Nf.BackgroundColor=O.BackgroundColor),Sa.okd(Nf,Sb,Uc,qa)&&(Yd.a.ma(Nf.BackgroundColor)||(oe["background-color"]=Nf.BackgroundColor),
oe.color=Yd.a.ma(Nf.FontColor)?O.FontColor:Nf.FontColor,Sa.Ape(Sb,Uc,oe,Nf,kh,rb,ef)));return oe};Sa.RT=function(O,qa,rb,Sb,Uc,vd){rb&&(Yd.a.ma(rb.Color)||rb.Style||(rb.Style=1),rb.Style&&Yd.a.ma(rb.Color)&&(Uc?rb.Color="#000000":Yd.a.ma(Sb)?rb.Color=vd?"#FFFFFF":"#000000":rb.Color=Sb),qa[Sa.borders[O]]="1px "+Sa.BU[rb.Style]+" "+rb.Color)};Sa.okd=function(O,qa,rb,Sb){return-1===O.Type?!1:Sa.pkd(O,qa,rb,Sb)||Sa.K6h(O,qa,rb,Sb)||Sa.qkd(O,qa,rb,Sb)};Sa.K6h=function(O,qa,rb,Sb){return!qa&&Sb.headerRow||
qa===Sa.rma-1&&Sb.totalRow?!1:1===qa%2&&5===O.Type&&Sb.KQ&&Sb.headerRow||1<qa&&!!((qa-1)%(O.BandSize+1))&&6===O.Type&&Sb.KQ&&Sb.headerRow||!(qa%2)&&5===O.Type&&Sb.KQ&&!Sb.headerRow||!!(qa%(O.BandSize+1))&&6===O.Type&&Sb.KQ&&!Sb.headerRow||!(rb%2)&&7===O.Type&&Sb.rga||!!(rb%(O.BandSize+1))&&8===O.Type&&Sb.rga};Sa.qkd=function(O,qa,rb,Sb){return qa===Sa.rma-1&&2===O.Type&&Sb.totalRow||rb===Sa.hza-1&&qa===Sa.rma-1&&12===O.Type&&Sb.totalRow&&Sb.lastCol||!rb&&qa===Sa.rma-1&&11===O.Type&&Sb.totalRow&&Sb.firstCol||
rb===Sa.hza-1&&4===O.Type&&Sb.lastCol};Sa.pkd=function(O,qa,rb,Sb){return!qa&&1===O.Type&&Sb.headerRow||!rb&&3===O.Type&&Sb.firstCol||!rb&&!qa&&9===O.Type&&Sb.headerRow&&Sb.firstCol||rb===Sa.hza-1&&!qa&&10===O.Type&&Sb.headerRow&&Sb.lastCol};Sa.Ape=function(O,qa,rb,Sb,Uc,vd,oe){if(Sb.TableStyleBorderFromatList)for(var ef=Ol(Sb.TableStyleBorderFromatList),Nf=ef.next();!Nf.done;Nf=ef.next())if(Nf=Nf.value,Nf.Style)switch(Nf.Position){case 0:O&&12!==Sb.Type&&11!==Sb.Type&&2!==Sb.Type&&5!==Sb.Type&&6!==
Sb.Type||Sa.RT(0,rb,Nf,Uc,vd,oe);break;case 1:O!==Sa.rma-1&&1!==Sb.Type&&10!==Sb.Type&&9!==Sb.Type&&5!==Sb.Type&&6!==Sb.Type||Sa.RT(1,rb,Nf,Uc,vd,oe);break;case 2:qa&&12!==Sb.Type&&10!==Sb.Type&&7!==Sb.Type&&8!==Sb.Type&&4!==Sb.Type||Sa.RT(2,rb,Nf,Uc,vd,oe);break;case 3:qa!==Sa.hza-1&&9!==Sb.Type&&11!==Sb.Type&&3!==Sb.Type&&7!==Sb.Type&&8!==Sb.Type||Sa.RT(3,rb,Nf,Uc,vd,oe);break;case 5:qa!==Sa.hza-1&&3!==Sb.Type&&4!==Sb.Type&&7!==Sb.Type&&8!==Sb.Type&&Sa.RT(3,rb,Nf,Uc,vd,oe);break;case 6:O!==Sa.rma-
1&&2!==Sb.Type&&1!==Sb.Type&&5!==Sb.Type&&6!==Sb.Type&&Sa.RT(1,rb,Nf,Uc,vd,oe)}};Sa.qJh=function(){var O=Array(12);O[0]=0;O[7]=1;O[8]=2;O[5]=3;O[6]=4;O[4]=5;O[3]=6;O[1]=7;O[2]=8;O[9]=9;O[10]=10;O[11]=11;O[12]=13;return O};Sa.rma=5;Sa.hza=5;Sa.HSh=5;Sa.i0e="TableStyleIcon";Sa.BU=[null,Xa.a.solid,Xa.a.dashed,Xa.a.dotted,Xa.a.dashed,Xa.a.dotted,Xa.a.dashed,Xa.a.double];Sa.borders=[Pb.a.borderTop,Pb.a.borderBottom,Pb.a.borderLeft,Pb.a.borderRight];Sa.OXf=Sa.qJh();Sa.w0c=null;Object(Oe.a)(Sa,"TableStyleHelper",
null,[]);Ca.prototype.equals=function(O){return O?this.headerRow===O.headerRow&&this.totalRow===O.totalRow&&this.firstCol===O.firstCol&&this.lastCol===O.lastCol&&this.rga===O.rga&&this.KQ===O.KQ:!1};Object(Oe.a)(Ca,"TableStyleOptions",null,[]);var Gc=b(906),Hc=pa.a;Em(ua,Hc);ua.prototype.uPh=function(O){var qa=this.tableManager.Ij;if(!qa)return!1;O=O[Zd.a.Md];if(Yd.a.ma(O))return!1;switch(Number.parseInvariant(O)){case 0:return ge.d(qa);case 1:return ge.c(qa);case 2:return ge.g(qa);case 3:return ge.e(qa);
case 4:return ge.f(qa);case 5:return ge.b(qa);case 6:return qa.hasAutoFilter}return!1};ua.prototype.Vwf=function(O,qa){if(wd.a.isEmpty(this.YE))return!0;if("PopulateTableMoreStylesMenu"!==O&&"PopulateTableAccessibleStylesMenu"!==O)return!1;if(he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===O&&!this.stc)return this.tIb||(this.tIb=!0,this.n1a("accessibilityTab")),!0;this.Ewb=!0;var rb=this.Sa.$o("TableStylesMenu"),Sb=this.Sa.Lz("Ribbon.TableTools.TableStyles.Gallery.Custom",
7,"Size48by48"),Uc=this.Sa.Lz("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),vd=this.Sa.Lz("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),oe=this.Sa.Lz("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),ef=-123538519;if(!Yd.a.ma(qa.MenuId))if(Yd.a.contains(qa.MenuId,"FormatAsTable",!0))ef=753331043,this.p3a=!0;else{var Nf=Sc.a.instance.da(1911);var kh=Sa.Usb(null,1,"-1");he.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?
oe.Ts("-1",ef,"QueryTableStyle",0,"-1",kh,void 0,void 0,Nf):oe.Ts("-1",ef,"QueryTableStyle",0,"-1",void 0,void 0,void 0,Nf);this.p3a=!1}kh=0;var Md=this.YE,Je;for(Je in Md){var qf=Md[Je];if(!he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==O||!qf.HasStyleViolations){Nf=Sa.iVe(qf,this.Trb());var ej=Sa.Usb(qf,this.MFa);if(qf)switch(qf.Category){case 0:Sb.Ts(qf.Index.toString(),ef,"QueryTableStyle",0,qf.Index.toString(),ej,
void 0,void 0,Nf);kh++;break;case 3:Uc.Ts(qf.Index.toString(),ef,"QueryTableStyle",0,qf.Index.toString(),ej,void 0,void 0,Nf);break;case 2:vd.Ts(qf.Index.toString(),ef,"QueryTableStyle",0,qf.Index.toString(),ej,void 0,void 0,Nf);break;case 1:oe.Ts(qf.Index.toString(),ef,"QueryTableStyle",0,qf.Index.toString(),ej,void 0,void 0,Nf)}}}0<kh&&this.h1(rb,Sb,1879);this.h1(rb,oe,1880);this.h1(rb,vd,1881);this.h1(rb,Uc,1882);qa.MenuItems=rb.pB();this.isInitialized||(this.isInitialized=!0);return!0};ua.prototype.vPh=
function(O){var qa=this;O[ze.a.On]=!1;var rb=O[Zd.a.Md];if(!Yd.a.ma(rb)&&!wd.a.isEmpty(this.YE)){Yd.a.contains(O.ParentMenuId,"FormatAsTable",!0)?this.p3a=!0:this.p3a=!1;this.p3a||this.d2f();Sa.S8e(O)&&(rb=this.msb(rb).toString());var Sb=this.Trb();O[ze.a.Alt]="-1"===rb?Sc.a.instance.da(1911):Sa.iVe(this.Vad(rb),Sb);if(rb in this.vQa&&Sb.equals(this.HTc))this.Ywf(O,rb,Sb,!0);else{if(!this.imc||this.imc&&!this.imc.Do)this.Jka={},this.imc=Qc.a.instance.create(function(){qa.QCf();qa.HTc=qa.Trb()},0,
md.a.hoj,!0,!0);this.Twd(Sb,O,rb)}}};ua.prototype.getTableStyleIndexFromName=function(O){if(Yd.a.ma(O)||wd.a.isEmpty(this.YE))return-1;if(O in this.YE)return this.YE[O].Index;this.n1a("getTableStyleIndexFromName");return-1};ua.prototype.vkd=function(){return!!this.nK};ua.prototype.msb=function(O){this.MM||this.kTc();return O in this.MM?this.MM[O]:-1};ua.prototype.n1a=function(O){if(this.$.isEditMode)if(he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var qa=
new Date;if(30<Eh.getElapsedSeconds(this.lastSyncTime,qa)||wd.a.isEmpty(this.YE)||this.tIb){var rb=this.$.ra.ua.Wb();this.lastSyncTime=qa;qa=(O=this.tIb&&"accessibilityTab"===O||"galleryMenuClosed"===O)?"accessibility":"normal";Ih.s(this.$.ra.ua,O,Object(bd.a)(this,this.Gnf,"onGetTableStyleSuccess"),Object(bd.a)(this,this.Etd,"onGetTableStyleFailed"),null,qa,rb)}}else if(rb=new Date,30<Eh.getElapsedSeconds(this.lastSyncTime,rb)||wd.a.isEmpty(this.YE))O=this.$.ra.ua.Wb(),this.lastSyncTime=rb,Ih.r(this.$.ra.ua,
Object(bd.a)(this,this.Gnf,"onGetTableStyleSuccess"),Object(bd.a)(this,this.Etd,"onGetTableStyleFailed"),null,null,O)};ua.prototype.dispose=function(){this.MM=this.vQa=this.nK=this.YE=null;this.$.Ka.Z8a(Object(bd.a)(this,this.gtf,"onTableStyleGalleryMenuClosed"));Hc.prototype.dispose.call(this)};ua.prototype.cug=function(O){this.addHandler("RefreshTableStyleGallery",O)};ua.prototype.wVi=function(O){this.removeHandler("RefreshTableStyleGallery",O)};ua.prototype.Gnf=function(O,qa,rb){var Sb=!1,Uc=he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",
!1);if(oh.a(O))-315732528!==O.Errors[0].MessageId&&(Tc.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",eg.a.Uc(O.Errors)),this.Etd(null,qa,rb));else if(Tc.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(O=O.Result)&&O.TableStyleItems.length){rb=60<O.TableStyleItems.length;var vd=!1,oe=!1;if(this.nK)for(var ef=0;60>ef;++ef){var Nf=O.TableStyleItems[ef],kh=this.nK.TableStyleItems[ef];
if(Uc&&Nf.HasStyleViolations!==kh.HasStyleViolations){Sb=oe=!0;break}for(var Md=0;9>Md&&!(Md>=Nf.TableStyleElementsList.length);Md++)if(!Yd.a.equals(Nf.TableStyleElementsList[Md].BackgroundColor,kh.TableStyleElementsList[Md].BackgroundColor,!1)){Sb=vd=!0;break}}else for(this.MFa=0,ef=Ol(O.TableStyleItems),Nf=ef.next();!Nf.done;Nf=ef.next())Nf=Nf.value,Nf.TableStyleElementsList&&Nf.TableStyleElementsList.sort(Sa.odf),this.YE[Nf.Name]=Nf;if(vd||oe)for(vd=0;60>vd;++vd)oe=O.TableStyleItems[vd],this.YE[oe.Name]=
oe;if(rb&&this.nK)for(Tc.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",O.TableStyleItems.length-60),Sb=!0,rb=60;rb<O.TableStyleItems.length;++rb)vd=O.TableStyleItems[rb],vd.Name in this.YE||vd.TableStyleElementsList&&vd.TableStyleElementsList.sort(Sa.odf),this.YE[vd.Name]=vd;if(Gc.a(this.YE).length!==O.TableStyleItems.length)for(Sb=!0,vd=rb=60;vd<this.nK.TableStyleItems.length;)rb>=O.TableStyleItems.length?delete this.YE[this.nK.TableStyleItems[vd].Name]:
rb>=O.TableStyleItems.length||!Yd.a.equals(O.TableStyleItems[rb].Name,this.nK.TableStyleItems[vd].Name,!1)?delete this.YE[this.nK.TableStyleItems[vd].Name]:++rb,++vd;this.nK=O;this.QCf(Sb);Sb&&this.kTc();Uc&&qa&&("accessibility"===qa?(this.tIb=!1,this.stc=!0):this.stc=!1);this.k7e||(this.Z6h()&&this.$.zf(),this.k7e=!0);this.Wad=0;this.Ewb||this.iMe?Uc&&this.stc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.iMe=!0)}};ua.prototype.Etd=function(){var O=
this;Tc.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.Wad++;5>this.Wad&&Qc.a.instance.create(function(){O.n1a("getTableStylesFailed")},1E3,md.a.NXf,!0,!0)};ua.prototype.kTc=function(){var O={};this.tableManager.Ij&&(this.cca=this.getTableStyleIndexFromName(this.tableManager.Ij.Stc));for(var qa=1;7>=qa;qa++)O["preview"+qa]=this.bDh(qa);this.MM=O};ua.prototype.bDh=function(O){var qa=this.nK.TableStyleItems.length;qa=4>=this.cca?this.cca+O-1:
4<this.cca&&this.cca<qa-4?4===O?this.cca:Math.floor(this.cca+O-4):this.cca+O-1;-1===qa||qa.toString()in this.vQa||(qa=O-3);return qa};ua.prototype.d2f=function(){if(this.tableManager.Ij){var O=!1,qa=this.getTableStyleIndexFromName(this.tableManager.Ij.Stc);if(qa!==this.cca){if(this.MM){var rb=this.MM,Sb;for(Sb in rb)rb[Sb]===qa&&(O=!0)}this.cca=qa;O||wd.a.isEmpty(this.vQa)||this.kTc()}}};ua.prototype.h1=function(O,qa,rb){var Sb=this.Sa.Oc();Sb.ep="Thin";Sb.title=Sc.a.instance.da(rb);Sb.buttons.push(qa);
O.Bc.push(Sb)};ua.prototype.Trb=function(){var O=this.tableManager.Ij;return this.p3a||!O?new Ca(!0,!1,!1,!1,!0,!1):new Ca(ge.d(O),ge.g(O),ge.c(O),ge.e(O),ge.f(O),ge.b(O))};ua.prototype.QCf=function(O){O=void 0===O?!1:O;var qa={},rb={},Sb=this.Trb();if(!wd.a.isEmpty(this.YE)&&(this.tableManager.Ij&&this.d2f(),!Sb.equals(this.HTc)||O||wd.a.isEmpty(this.vQa))){this.MFa=Sa.VDh(this.MFa);O=this.YE;for(var Uc in O){var vd=O[Uc],oe=Sa.Usb(vd,this.MFa);qa[vd.Index.toString()]=Sa.N0a(Sa.gra(Sa.N_b(vd,Sb)),
oe);rb[oe]=qa[vd.Index.toString()];this.CDb(rb)}Uc=Sa.Usb(null,this.MFa,"-1");qa["-1"]=Sa.N0a(Sa.gra(Sa.N_b(null,Sb)),Uc);rb[Uc]=qa["-1"];this.CDb(rb);ih.c(this.vQa,qa,!1)}};ua.prototype.Z6h=function(){var O=vg.a(this.$);return O?O.tn.eo===Ue.a.Rlc:!1};ua.prototype.Twd=function(O,qa,rb){Number.parseInvariant(rb);"-1"===rb&&Yd.a.contains(qa.ParentMenuId,"FormatAsTable",!0)||this.Ywf(qa,rb,O,!1)};ua.prototype.Ywf=function(O,qa,rb,Sb){var Uc=Sa.Usb(null,this.MFa,qa);Sa.S8e(O)?(Uc in this.Jka?rb=this.Jka[Uc]:
(rb=Sa.gra(Sa.N_b(this.Vad(qa),rb)),this.Jka[Uc]=rb),O[ze.a.GalleryButtonProps]=Object.assign(new Ah.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Uc,Alt:O[ze.a.Alt],MenuItemId:qa,TableCellStyles:rb,TableStyles:this.JIi})):(O[Xh.a.Icon]=Uc,O[ze.a.GalleryButtonProps]=Object.assign(new pg.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Uc,Alt:O[ze.a.Alt],MenuItemId:qa}),Sb||(Sb=[],this.Vad(qa),"-1"===qa||Yd.a.contains(O.ParentMenuId,"FormatAsTable",!0)||(Sb=Sa.N_b(this.nK.TableStyleItems[Number.parseInvariant(qa)],
rb)),this.vQa[qa]=Sa.N0a(Sa.gra(Sb),Uc)))};ua.prototype.CDb=function(O){var qa=this;if(this.Ewb)this.Yoc=function(){qa.CDb(O)};else{this.Yoc=null;var rb=[],Sb;for(Sb in O){var Uc=Sb;Uc in this.DDb?rb.push(Uc):this.DDb[Uc]=!0}try{0<rb.length&&appChrome.api.unregisterIcons(rb),wd.a.isEmpty(O)||appChrome.api.registerIconProvider(function(){return O})}catch(vd){}}};ua.prototype.Vad=function(O){O=Number.parseInvariant(O);if(-1===O||!this.nK)return null;if(60<O)for(var qa=60;qa<this.nK.TableStyleItems.length;++qa){var rb=
this.nK.TableStyleItems[qa];if(rb.Index===O)return rb}return this.nK.TableStyleItems[O]};ua.prototype.gtf=function(){var O=this;this.Ewb&&(this.Ewb=!1,this.Yoc&&this.Yoc(),Qc.a.instance.create(function(){O.n1a("galleryMenuClosed")},1E3,md.a.NXf,!0,!0))};Object(Oe.a)(ua,"TableStyleManager",pa.a,[373,6]);var Ld=xf.a;Em($a,Ld);$a.prototype.create=function(){var O=this,qa=ig.GetServiceTaskFactory.create(this.$.ea,102,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),
rb=ig.GetServiceTaskFactory.Va(this.$.ea,66,134,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager");sg.TaskExtensions.Aa(fg.Task.WAA(qa,rb),function(){O.Eb(O.tableStyleManager||(O.tableStyleManager=new ua(O.$,qa.result,rb.result)))},this.$.la,8)};Object(Oe.a)($a,"TableStyleManagerFactory",xf.a,[]);var Ie=b(800),Td=b(55);Object(Oe.a)(Ua,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[115]);Object(Oe.a)(Jb,"MacroRecorderRangeItemFilteredPayload",null,[115]);var Re=b(1046),ff=b(364),
Of=b(161),kg=b(173),Rf=b(275);Object(Oe.a)(ic,"MacroRecorderTableStyleAppliedPayload",null,[115]);Em(wb,ic);Object(Oe.a)(wb,"MacroRecorderRangeFormatedAsTablePayload",ic,[]);Object(Oe.a)(qb,"MacroRecorderTableRenamedPayload",null,[115]);Object(Oe.a)(Ia,"MacroRecorderTableResizedPayload",null,[115]);Object(Oe.a)(Aa,"MacroRecorderTableStyleOptionToggledPayload",null,[115]);Object(Oe.a)(Zb,"MacroRecorderTableConvertedToRangePayload",null,[115]);cc.prototype.xK=function(){Tc.ULS.sendTraceTag(537151186,
0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.sf.Kh.Cc);if(this.qAa&&!oh.a(this.qAa)){this.sf.fwb=this.qAa.Result;if(this.sf.fwb)return this.zTd=eg.a.gd(3,2,0,710,0,-66108047,"ConvertToRange"),this.Ui=cf.a(this.sf.$).ai(this.zTd).G(),this.Ui.isCompleted||(this._state=2,this.Ui.xM(Object(bd.a)(this,this.moveNext,"moveNext"))),this.Nxc;this.sf.hue();return this.Icb}return this.c0};cc.prototype.c0=function(){this.sf.Kh.stop();Tc.ULS.sendTraceTag(537151185,
0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.sf.Kh.Cc);this._state=3};cc.prototype.Icb=function(){return this.c0};cc.prototype.Nxc=function(){this.ATd=this.Ui.oy();Tc.ULS.sendTraceTag(537151184,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.sf.Kh.Cc);this.ATd||this.sf.gue();return this.Icb};cc.prototype.dispose=function(){};cc.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.Rt=
this.Rt()}catch(O){this.dispose(),this._state=3}};Object(Oe.a)(cc,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[6]);var Ig=b(854);tc.prototype.B7a=function(){var O=this;this.Kh.start();var qa=this.$.ra.ua.Wb();return he.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?Ig.g(this.$.ra.ua,this.sharedSheetRange,function(rb){O.showDialog(rb)},null,null,null,qa):Ig.g(this.$.ra.ua,
this.sharedSheetRange,function(rb){O.Yfj(rb)},null,null,null,qa)};tc.prototype.showDialog=function(O){var qa=this;Tc.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.Kh.Cc);O&&!oh.a(O)&&((this.fwb=O.Result)?(O=eg.a.gd(3,2,0,710,0,-66108047,"ConvertToRange"),sg.TaskExtensions.Aa(cf.a(this.$).ai(O),function(rb){Tc.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",
qa.Kh.Cc);rb.result||qa.gue()},this.$.la,11)):this.hue());this.Kh.stop();Tc.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.Kh.Cc)};tc.prototype.Yfj=function(O){new cc(this,O)};tc.prototype.qme=function(){var O={};O.IsQueryTable=this.fwb;O.Range=this.sharedSheetRange;return O};tc.prototype.gue=function(){var O=this,qa=this.$.ra.ua;Tc.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.T2e(194,
function(rb,Sb,Uc){return Ig.d(qa,O.qme(),rb,Sb,Uc,null)});Tc.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};tc.prototype.hue=function(){var O=this,qa=this.$.ra.ua;Tc.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.T2e(193,function(rb,Sb,Uc){return Ig.c(qa,O.qme(),rb,Sb,Uc,null)},function(){return new Zb(O.tableName)});Tc.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};tc.prototype.T2e=function(O,qa,
rb){rb=void 0===rb?null:rb;ff.a(this.$.userOperationManager,qa,function(Sb){return new Of.a(O,0,Sb,void 0,rb)},null)};Object(Oe.a)(tc,"ConvertToRangeManager",null,[]);var ya=b(1206),oa=b(1205),yb=b(1241),Dd=yb.a;Em(Ec,Dd);Ec.prototype.Ll=function(){var O=this,qa=Bf.s(this.zB.TableRange);return function(){return new wb(qa,O.O1a.checked,O.iza,!0)}};Ec.prototype.vw=function(){var O=this,qa=Bf.s(this.zB.TableRange);return function(rb,Sb,Uc){return Ig.f(O.$.ra.ua,qa,O.O1a.checked,!1,O.zB.HasTotalRow,O.iza,
rb,Sb,Uc,null)}};Ec.prototype.kx=function(O,qa,rb){Dd.prototype.kx.call(this,O,qa,rb)};Ll.Object.defineProperties(Ec.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},$v:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Oe.a)(Ec,"FormatAsTableDialogDeprecated",yb.a,[]);var ie=b(1071),xe=ie.a;Em(lc,xe);lc.prototype.Ll=function(){var O=this,qa=Bf.s(this.zB.TableRange);return function(){return new wb(qa,O.hasHeaders,O.iza,!0)}};lc.prototype.vw=
function(){var O=this,qa=Bf.s(this.zB.TableRange),rb=this.zB.HasTotalRow;return function(Sb,Uc,vd){return Ig.f(O.$.ra.ua,qa,O.hasHeaders,!1,rb,O.iza,Sb,Uc,vd,null)}};Ll.Object.defineProperties(lc.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},$v:{configurable:!0,enumerable:!0,get:function(){return 215}},Kn:{configurable:!0,enumerable:!0,get:function(){return Sc.a.instance.da(704)}}});Object(Oe.a)(lc,"FormatAsTableReactDialog",ie.a,[]);var Lf=b(517),ph=b(91),
Sf=Lf.a;Em(P,Sf);P.prototype.foj=function(O,qa){1===O&&this.qsj(Bf.D(this.Dvf(qa[P.KMi])))};P.prototype.Dvf=function(O){O=O.startsWith("=")?O.substring(1,O.length):O;var qa=Bf.Y(O,this.$.va);O=qa.sheetName;var rb=qa.range;return qa.returnValue&&rb?(rb=Bf.v(rb,this.$),rb.SheetName=Yd.a.equals(O,"",!0)?this.$.qa.name:O,rb):null};P.prototype.k3=function(O){var qa={};return qa.id="ResizeTableDialog",qa.range=O,qa.getInputErrorIfInvalid=Object(bd.a)(this,this.nsb,"getInputErrorIfInvalid"),qa};P.prototype.e$c=
function(O){O=this.Dvf(O);if(!O)return 1;var qa=Bf.D(O);return Yd.a.equals(O.SheetName,this.$.qa.sheetName,!0)&&this.Njc.top===qa.top&&this.Njc.$d(qa)?0:2};P.prototype.nsb=function(O){O=this.e$c(O);return this.B7c(O)};P.prototype.B7c=function(O){var qa="";switch(O){case 1:qa=Sc.a.instance.da(72);break;case 2:qa=ph.a.yq(Sc.a.instance.da(71))}return qa};P.prototype.qsj=function(O){var qa={};O=(qa.ResizeTableRange=O,qa.OriginalTableRange=this.Njc,qa);this.$.De(-1400250766,Zd.a.Tb,8,O)};Ll.Object.defineProperties(P.prototype,
{sc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});P.p2a="id";P.KMi="range";Object(Oe.a)(P,"ResizeTableDialog",Lf.a,[]);var Zg=b(910),Bh=b(911),ti=b(132),ci=b(64);uc.prototype.Wc=function(O,qa){switch(qa){case -544558380:return!(this.tableManager&&this.wa.KP()&&!this.b3a()&&ge.d(this.tableManager.Ij));case 1544516694:return!(this.tableManager&&(this.wa.KP()?!this.b3a():this.wa.IJa()));case -697806646:case 323142015:return!this.wa.KP();case 341449783:case 2128797448:return!(this.tableManager&&
this.tableManager.ukd(this.wa.activeCell));case -123538519:return!(this.wa.KP()&&this.tableStyleManager&&this.tableStyleManager.vkd());case 756677940:return!(he.EwaSettings.ka(424)&&this.FZh());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.GZh());case 844144422:return!this.wa.KP()}return!1};uc.prototype.executeCommand=function(O,qa,rb){var Sb=this;O=sg.TaskExtensions.dm();var Uc=this.$.ra.ua,vd=null,oe=1,ef=qa.command,Nf=this.$.ra.ua.Wb(),kh=null;switch(ef){case -2058042992:var Md=
Td.a.Xh(rb[Zd.a.Hj]);uc.cNf(this.$,Md);vd=function(Ji,lh,nj){return Ig.a(Uc,Md,null,null,!1,!1,!1,Zg.a.Hta(ti.a.oEa,Bh.a.clearAutoFilter,Ji),lh,nj,null)};oe=176;kh=function(){return new Jb(Md)};break;case 504133448:case -798968736:case 477776686:var Je=Td.a.Xh(rb[Zd.a.Hj]),qf=rb.TopCellAddress;uc.cNf(this.$,Je);var ej=504133448===qa.command?1:-798968736===qa.command?2:3;if(he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&qf&&this.$.isEditMode&&(rb=this.tableManager.zo(qf),
!this.$.Xs([rb],!0,1)))break;vd=function(Ji,lh,nj){return Ih.hb(Uc,Je,ej,Rf.b(Ji,Object(bd.a)(Sb,Sb.nAi,"onTableSortSuccessCallback")),lh,nj,qf,Nf)};oe=177;kh=function(){return new Ua(Je,ej)};break;case 341449783:case 2128797448:this.LOa=341449783===ef?0:2;rb=this.toggleTableStyleOption(Uc,Nf);vd=rb.B5f;oe=rb.operationName;kh=rb.Ll;break;case -712419744:this.ou?this.E2e(rb[Ue.a.event]):this.E2e(null);break;case 1868184698:he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",
!1)?new oa.a(this.$):(rb=new ya.a(this.$),rb.initialize(),rb.mf());break;case 844144422:new P(this.$);break;case 1544516694:case -544558380:rb=rb[Zd.a.Md];Yd.a.ma(rb)||(this.LOa=this.pJh(rb),-1!==this.LOa&&(rb=this.toggleTableStyleOption(Uc,Nf),vd=rb.B5f,oe=rb.operationName,kh=rb.Ll));break;case 756677940:if(this.b3a()&&this.o7e()){Tc.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}var $f=rb.Text,mi=this.hCh();if(mi){vd=function(Ji,lh,nj){return Ig.h(Uc,$f,mi,Rf.b(Ji,Object(bd.a)(Sb,Sb.mAi,"onTableRenameSuccessful")),Rf.a(lh,Object(bd.a)(Sb,Sb.lAi,"onTableRenameFailure")),nj,Nf)};oe=217;var qj=null;this.tableManager.Ij?qj=this.tableManager.Ij.name:this.tableManager.Zxd?qj=this.tableManager.Zxd.name:Tc.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");
qj&&(kh=function(){return new qb(qj,$f)})}else return Tc.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),fg.Task.Ra(!1);break;case 323142015:if(this.b3a())break;return(new tc(this.$,this.GNe(),this.tableManager.Ij.name)).B7a();case -1400250766:oe=211;vd=this.BZi(rb,Uc,Nf);var yh=Bf.m(rb.OriginalTableRange,this.$.va.qa);kh=function(){return new Ia(yh)};break;case 1872288872:this.tableManager.rLi();break;case -123538519:var Li=this.oJh(rb);rb=Yd.a.contains(rb[Zd.a.Md],
Ue.a.DCb,!0)||Yd.a.contains(rb[Ue.a.EH],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";Tc.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",rb,Li.toString());var aj=this.qUe();aj&&(vd=function(Ji,lh,nj){return Ig.b(Uc,aj,Li,Ji,lh,nj,null,Nf)},kh=function(){return new ic(aj,Li)},oe=212);break;case 753331043:rb=rb[Zd.a.Md];if(Yd.a.ma(rb))break;var gi=Number.parseInvariant(rb);if(this.wa.KP()){Tc.ULS.sendTraceTag(51181321,
0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",gi);var ii=this.qUe();ii&&(vd=function(Ji,lh,nj){return Ig.f(Uc,ii,!1,!1,!1,gi,Ji,lh,nj,null,Nf)},kh=function(){return new wb(ii,!1,gi,!1)},oe=215)}else Tc.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",gi),he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new lc(this.$,Number.parseInvariant(rb)):(rb=new Ec(this.$,
Number.parseInvariant(rb)),rb.initialize(),rb.mf());break;case 71074531:var of=rb.HasHeader,Ui=rb.TableRange;vd=function(Ji,lh,nj){return Ig.e(Uc,Ui,of,!1,!1,Ji,lh,nj,null)};kh=function(){return new Re.a(of,Ui)};oe=206;break;default:return kg.a(ef)}if(vd){var fj=function(Ji){return new Of.a(oe,0,Ji,void 0,kh)};if(!this.namedSheetViewPublic||-2058042992!==ef&&504133448!==ef&&-798968736!==ef&&477776686!==ef)O=ff.a(this.$.userOperationManager,vd,fj,qa);else{var Ch=this;O=this.namedSheetViewPublic.PPa().continueWith(function(Ji){Ji.result&&
ff.a(Ch.$.userOperationManager,vd,fj,qa)})}}return O};uc.prototype.toggleTableStyleOption=function(O,qa){var rb=this,Sb=this.wa.IJa();Tc.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Sb?"PivotTable":"table",this.LOa);var Uc=this.GNe();return{B5f:function(vd,oe,ef){return Ig.j(O,Uc,rb.LOa,Rf.b(vd,Object(bd.a)(rb,rb.QAi,"onToggleTableStyleOptionSuccessful")),oe,ef,null,qa)},operationName:196,Ll:function(){return new Aa(Uc,rb.LOa,Sb)}}};uc.prototype.BZi=
function(O,qa,rb){function Sb(Nf){Nf.Errors&&vd.tableManager.LXf(oe)}function Uc(){vd.tableManager.LXf(oe)}var vd=this,oe=O.OriginalTableRange,ef=Bf.m(O.ResizeTableRange,this.$.va.qa);return function(Nf,kh,Md){return Ig.i(qa,ef,Rf.b(Nf,Sb),Rf.a(kh,Uc),Md,null,rb)}};uc.prototype.oJh=function(O){var qa=-1;Yd.a.ma(O[Zd.a.Md])||(qa=O[Zd.a.Md],qa=Yd.a.contains(qa,Ue.a.DCb,!0)?this.tableStyleManager.msb(qa):Number.parseInvariant(O[Zd.a.Md]));return qa};uc.prototype.Ec=function(O,qa){O=!1;switch(qa.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:O=
!0;break;case 756677940:O=he.EwaSettings.ka(424)}return O};uc.prototype.Yc=function(O,qa,rb){O=!1;switch(qa){case "PopulateTableMoreStylesMenu":this.menuId=rb.MenuId;this.tableStyleManager.vkd()||this.tableStyleManager.n1a("formatAsTableMenu");O=this.tableStyleManager.Vwf(qa,rb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=rb.MenuId,this.tableStyleManager.vkd()||this.tableStyleManager.n1a("accessibilityTab"),O=this.tableStyleManager.Vwf(qa,rb)}return O};uc.prototype.dispose=function(){this.tableStyleManager.wVi(Object(bd.a)(this,
this.htf,"onTableStylesDataLoadSuccess"))};uc.prototype.htf=function(){this.Dba()};uc.prototype.Dba=function(){(Yd.a.contains(this.menuId,"Format",!0)||Yd.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Yv(this.menuId)};uc.prototype.GNe=function(){return Bf.v(this.wa.activeCell,this.$)};uc.prototype.hCh=function(){var O=this.tableManager.Gld;return O?Bf.v(O,this.$):null};uc.prototype.E2e=function(O){if(this.tableManager){var qa=Hf.g(this.$),rb=this.wa.activeCell,Sb=this.tableManager.zo(rb),
Uc=null;if(!Sb||Sb.aQa)for(qa=Ol(qa.T1),Sb=qa.next();!Sb.done;Sb=qa.next()){Sb=Ol(Sb.value);for(var vd=Sb.next();!vd.done;vd=Sb.next()){vd=vd.value;var oe=vd.Rn;rb.left>=oe[0]&&rb.left<=oe[oe.length-1]&&(Uc=(vd=vd.hs(rb).fJ())?mf.DOMElementExtensions.lj(vd,Se.a.ghe):null)}}else{var ef=qa.tc(yf.Range.ld(Sb.top,rb.left));if(this.ou){Qc.a.instance.create(function(){ef.invoke(8,O)},0,md.a.CXf,!0,!0);return}Uc=ef.pIa(56).I2a}Uc&&Qc.a.instance.create(function(){mf.DOMElementExtensions.Xub(Uc,null)},0,md.a.CXf,
!0,!0)}};uc.prototype.pJh=function(O){O=Number.parseInvariant(O);return-1<O&&8>=O?O:-1};uc.prototype.QAi=function(O){if(!(this.wa.IJa()||(!he.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||oh.a(O)||this.b3a())&&oh.a(O)&&this.b3a())){O=this.wa.activeCell;var qa=this.wa.activeRange,rb=this.tableManager.Ij.usedRange;2===this.LOa&&ge.g(this.tableManager.Ij)&&O.bottom===rb.bottom&&(qa=qa.faa?new yf.Range(qa.top-1,qa.left,qa.bottom-1,qa.right,!1,!0):new yf.Range(qa.top,
qa.left,qa.bottom-1,qa.right,!1,!0),O=qa.contains(O)?O:yf.Range.ld(qa.bottom,O.left),Hf.g(this.$).ga.updateSelection(qa,O,0,3))}};uc.prototype.mAi=function(O){oh.a(O)?(Tc.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),this.$.zf()):Tc.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};uc.prototype.lAi=function(){Tc.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");
this.$.zf()};uc.prototype.b3a=function(){return!this.tableManager.Ij};uc.prototype.o7e=function(){return this.tableManager.Zxd?!1:(Tc.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};uc.prototype.GZh=function(){var O=this.wa.KP(),qa=this.wa.xh&&!Hf.g(this.$).$b.ava(this.wa.Nd);return O||qa};uc.prototype.FZh=function(){return this.wa.KP()||!this.o7e()};uc.prototype.rJh=function(O){var qa=[];O=Ol(O);for(var rb=O.next();!rb.done;rb=
O.next())if((rb=Vb.b(this.$,rb.value))&&rb.length){rb=Ol(rb);for(var Sb=rb.next();!Sb.done;Sb=rb.next())Sb=Sb.value,Sb.usedRange&&!Array.contains(qa,Sb.usedRange)&&Array.add(qa,Sb.usedRange)}return qa};uc.prototype.qUe=function(){var O=this.wa.selectedRanges,qa=[];if(he.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))qa=this.rJh(O);else{O=Ol(O);for(var rb=O.next();!rb.done;rb=O.next())rb=rb.value,Hf.g(this.$).$b.ava(rb)&&Array.add(qa,rb)}return qa&&
qa.length?Bf.r(qa,this.$):null};uc.prototype.nAi=function(O,qa){qa&&this.$Q(qa);oh.b(O,-569193796)&&(ci.a(this.$).fd.lO(-569193796),this.J$h(O.Errors[0]))};uc.prototype.$Q=function(O){he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.Va(this.$.ea,430,431,1,"Microsoft.Office.Excel.WebUI.Client.PivotTableHandRaise.IPivotTableHandRaiseManager"),function(qa){qa.result.Ema(O);Tc.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},
this.$.la,3)};uc.prototype.J$h=function(O){var qa=this;sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.Va(this.$.ea,446,447,0,"Microsoft.Office.Excel.WebUI.Client.Sort.ISortUtil"),function(rb){rb.result.VXg(qa.$,O)},this.$.la,3)};uc.cNf=function(O,qa){qa.SheetName=O.qa.name;qa.NamedObjectView=O.fa.isNamedObjectViewMode};Object(Oe.a)(uc,"TableCommandHandler",null,[160]);var fi=Ie.a;Em(zb,fi);zb.prototype.dispose=function(){fi.prototype.dispose.call(this)};zb.prototype.Gd=function(){var O=this,qa=ig.GetServiceTaskFactory.create(this.$.ea,
134,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),rb=ig.GetServiceTaskFactory.create(this.$.ea,330,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.Tables.ITableStyleManager"),Sb=ig.GetServiceTaskFactory.Va(this.$.ea,309,310,this.rb,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewPublic");sg.TaskExtensions.Aa(fg.Task.WAA(qa,Sb,rb),function(){O.Ad([new uc(O.$,qa.result,Sb.result,rb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,
756677940])},this.$.la,3)};zb.ja=function(O){Ie.a.Yd(86,new zb(O))};Object(Oe.a)(zb,"TableCommandHandlerFactory",Ie.a,[]);oc.prototype.Wc=function(){return!1};oc.prototype.executeCommand=function(O,qa){O=qa.command;qa=null;switch(O){case 1243860697:this.R5g.Nqj();break;default:qa=kg.a(O)}return qa||fg.Task.Ra(!0)};oc.prototype.Ec=function(O,qa){return 1243860697===qa.command};oc.prototype.Yc=function(){return!1};Object(Oe.a)(oc,"SheetDropdownMenuCommandHandler",null,[160]);var $h=Ie.a;Em(Yb,$h);Yb.prototype.Gd=
function(){var O=this;this.$.RD(function(qa){qa.Xed().then(function(){sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.Va(O.$.ea,32,33,O.rb,"Microsoft.Office.Excel.WebUI.Client.SheetTabBar.ISheetTabBarControl"),function(rb){O.Ad([new oc(rb.result.Vbj)])},O.$.la)})})};Yb.ja=function(O){Ie.a.Yd(392,new Yb(O))};Object(Oe.a)(Yb,"SheetDropdownMenuCommandHandlerFactory",Ie.a,[]);var Th=b(73),mg=b(44),rg=b(203),af=b(40),de=b(117),Fi=b(32);Ra.prototype.Nxg=function(O,qa){this.Sze.add(O,qa);this.lW()};Ra.prototype.lW=
function(){var O=this;this.RBc=0;Fi.a.forEach(this.Sze.su,function(qa){O.RBc=O.b1c|qa.value})};Ll.Object.defineProperties(Ra.prototype,{b1c:{configurable:!0,enumerable:!0,get:function(){return this.RBc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.b1c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.b1c&2)}}});Object(Oe.a)(Ra,"SheetTabBarDisabledStateManager",null,[]);Wa.jeh="ewa-stb-uir";Wa.HFe="ewa-stb-drag";Wa.Udh=
"ewa-stb-navarea";Wa.Vdh="ewa-stb-navarea-dimensions";Wa.Xdh="ewa-stb-navbutton";Wa.QX="cui-disabled";Wa.Iga="cui-img-container";Wa.Wdh="ewa-stb-navareaextra";Wa.Rdh="ewa-stb-contentarea";Wa.IFe="ewa-stb-left-scrollable";Wa.TFe="ewa-stb-right-scrollable";Wa.heh="ewa-stb-tabarea";Wa.geh="ewa-stb-sheettabmoveindicator";Wa.VFe="ewa-stb-tabs";Wa.Lnj="tab-active";Wa.Snj="tab-inactive";Wa.Rnj="tab-hover";Wa.ieh="ewa-stb-tabs-ghost";Wa.Nnj="tab-anchor-text";Wa.dark="dark";Wa.light="light";Wa.Mnj="tab-active-text";
Wa.Pnj="tab-content-container";Wa.Unj="tab-text";Wa.$dh="ewa-stb-nsv-inactive";Wa.aeh="ewa-stb-nsv-inactive-svg";Wa.Ydh="ewa-stb-nsv-active";Wa.Zdh="ewa-stb-nsv-active-svg";Wa.edh="ewa_nsv_margin";Wa.Sdh="ewa-stb-disable-scrollbar";Wa.V$h="leave-size-fixed-on-tab-hover-old";Wa.U$h="leave-size-fixed-on-tab-hover";Wa.MFe="ewa-stb-locked-sheet";Wa.NFe="ewa-stb-locked-sheet-svg";Wa.Tdh="ewa-stb-dropdown-menu-button";Wa.l$g="ewa-active-sheet-menu-item";Object(Oe.a)(Wa,"CssClassNames",null,[]);var f=b(515),
hb=b(18),ec=b(257),$c=b(96),be=b(514),ve=b(281),De=b(453),Me=b(95),sf=b(335),tg=b(261),uf=b(366),Og=b(362),Tf=b(278),Xf=b(90),ia=te.a;Em(lb,ia);lb.prototype.dispose=function(){this.Q7a=this.Dqa=this.$=null;ia.prototype.dispose.call(this)};lb.prototype.gW=function(O){this.GW=O;this.domElement.setAttribute(Ue.a.lqa,O.toString());mf.DOMElementExtensions.toggleCssClass(this.domElement,f.a.QX,O)};Ll.Object.defineProperties(lb.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.GW}}});
Object(Oe.a)(lb,"SheetBarButton",te.a,[]);var u=b(818);Em(ha,lb);ha.prototype.dispose=function(){Tf.a.instance.za(ed.a.click,this.domElement,Object(bd.a)(this,this.Rc,"onClick"));de.KeyInputManager.instance.Mu(this.domElement,this.Xwb);he.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Hf.g(this.$)&&Hf.g(this.$).uc&&(Hf.g(this.$).uc.ym(Object(bd.a)(this,this.Rj,"onEditStarted")),Hf.g(this.$).uc.Fr(Object(bd.a)(this,this.pj,"onEditEnded")));lb.prototype.dispose.call(this)};
ha.prototype.gW=function(O){var qa=ha.BRf(this.$);lb.prototype.gW.call(this,O||qa)};ha.prototype.Rc=function(O){this.disabled||this.$.De(-1935155518,O.yb,30,null);return!0};ha.prototype.DAb=function(O){O="mouseover"===O.type||"focus"===O.type;var qa=uf.a(this.$)?this.Q7a:this.Dqa;ue.HelperMethods.BOd(qa,this.Xfa,this.Xfa+Ue.a.H$b,O&&!Hf.g(this.$).inRangePicker)};ha.prototype.Rj=function(){this.gW(!0)};ha.prototype.pj=function(){this.gW(!1)};ha.BRf=function(O){return!O.isEditMode||!O.va.count};Object(Oe.a)(ha,
"InsertSheetButton",lb,[]);Em(Tb,lb);Tb.prototype.dispose=function(){Tf.a.instance.za(ed.a.click,this.domElement,Object(bd.a)(this,this.Rc,"onClick"));de.KeyInputManager.instance.Mu(this.domElement,this.Xwb);this.Yme=null;lb.prototype.dispose.call(this)};Tb.prototype.Rc=function(O){this.$.De(-684145703,O.yb,0,null);return!0};Tb.prototype.DAb=function(O){ue.HelperMethods.BOd(this.Yme,this.Xfa,this.Xfa+Ue.a.H$b,("mouseover"===O.type||"focus"===O.type)&&!Hf.g(this.$).inRangePicker)};Object(Oe.a)(Tb,
"InsertTemplateButton",lb,[]);kb.prototype.getSheetName=function(){return this.sheetName};Object(Oe.a)(kb,"MacroRecorderSheetReorderedPayload",null,[115]);var m=te.a;Em(Na,m);Na.prototype.dispose=function(){this.$l();m.prototype.dispose.call(this)};Na.prototype.Nqj=function(){this.wGf(!0,"TogglerSheetDropdownMenu")};Na.prototype.wGf=function(O,qa){Tc.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",qa,O,this.nJb);
O&&(this.nJb+=1);var rb=this.$.Vb.Dc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",qa,O,this.nJb,this.$.va.count));O=this.KXg();appChrome.renderSheetDropdownMenu(this.domElement,this.qoj,O,this.nJb,Object(bd.a)(this,this.lri,"onDropdownMenuShow"),Object(bd.a)(this,this.kri,"onDropdownMenuDismiss"),function(){rb.stop()},uf.a(this.$))};Na.prototype.KXg=function(){for(var O=this.$.va,qa=[],rb=0;rb<O.count;rb++){var Sb=
Object(nf.a)(Me.a,O.getItem(rb));Sb.Bx||(Sb=this.JXg(Sb),qa.push(Sb))}return qa};Na.prototype.JXg=function(O){var qa={};qa.key=O.name;qa.text=O.name;qa.onClick=this.LXg(O);O.active&&(qa.className=uf.a(this.$)?"ewa-active-sheet-menu-item-present-mode":Wa.l$g);return qa};Na.prototype.LXg=function(O){var qa=this;return function(){var rb=new nd.a(-1876836819,0,qa.$.dd,30,null),Sb={};qa.$.Ka.Ub(rb,(Sb.SNTA=O.name,Sb))}};Na.prototype.sQ=function(){Tc.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");
this.wGf(!1,"OnSheetsChanged")};Na.prototype.Uj=function(){if(!this.tsa){var O=this.$.va;O.Pf(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.aVb(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.oX(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.pfa(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.MDa(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.Gfe(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.VVa(Object(bd.a)(this,this.sQ,"onSheetsChanged"));this.tsa=!0}};Na.prototype.$l=function(){if(this.tsa){var O=
this.$.va;O.zg(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.Vmc(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.K5(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.Yka(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.ZNa(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.tFf(Object(bd.a)(this,this.sQ,"onSheetsChanged"));O.hEb(Object(bd.a)(this,this.sQ,"onSheetsChanged"));this.tsa=!1}};Na.prototype.lri=function(){this.Uj()};Na.prototype.kri=function(){this.$l()};Object(Oe.a)(Na,"SheetDropdownMenu",te.a,
[483,6]);var K=b(346);Em(db,lb);db.prototype.dispose=function(){this.Vuj();lb.prototype.dispose.call(this)};db.prototype.gW=function(O){lb.prototype.gW.call(this,O||!this.$.fa.Fua)};db.prototype.vZf=function(O){this.disabled||(Tc.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",K.a[O]),this.$.Ka.Ub(new nd.a(1243860697,O,this.$.dd,30,null)))};db.prototype.Ih=function(){this.gW(!1);this.$.fa.Er(Object(bd.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"))};
db.prototype.fQi=function(){Tf.a.instance.pa(ed.a.click,this.domElement,Object(bd.a)(this,this.Rc,"onClick"));de.KeyInputManager.instance.pa(ed.a.Qb,this.domElement,Object(bd.a)(this,this.onKeyDown,"onKeyDown"))};db.prototype.Vuj=function(){Tf.a.instance.za(ed.a.click,this.domElement,Object(bd.a)(this,this.Rc,"onClick"));de.KeyInputManager.instance.za(ed.a.Qb,this.domElement,Object(bd.a)(this,this.onKeyDown,"onKeyDown"))};db.prototype.Rc=function(O){this.vZf(O.yb);return!0};db.prototype.onKeyDown=
function(O){return 13===O.Ea.keyCode||32===O.Ea.keyCode?(this.vZf(O.yb),!0):!1};Object(Oe.a)(db,"SheetDropdownMenuAnchor",lb,[]);var ka=b(184),ja=b(135),Gb=b(57),$b=b(214),Ac=b(158);eb.prototype.QG=function(){return this.sheet.active};eb.prototype.Uhd=function(){return this.sheet.isLockPausedInSession};eb.prototype.Pqa=function(){return this.Ul?hb.a.LFe:this.QG()?hb.a.KFe:hb.a.JFe};eb.prototype.pma=function(){return this.sheet.Pi?u.a.pzf:u.a.Huj};eb.prototype.iNd=function(){return 13};eb.prototype.kNd=
function(){return 12};eb.prototype.hga=function(){return null};eb.prototype.Qqa=function(){return this.Ul?this.Fv?Wa.NFe:Wa.MFe:null};eb.prototype.JOd=function(){return null};eb.prototype.Xv=function(){return null};eb.prototype.ped=function(){return 0};eb.prototype.RQc=function(){return!0};Object(Oe.a)(eb,"LockPausedSheetIconDataSource",null,[491]);Fa.prototype.QG=function(){return this.sheet.active};Fa.prototype.Uhd=function(){return this.sheet.Pi};Fa.prototype.Pqa=function(){return this.Ul?hb.a.LFe:
this.QG()?hb.a.KFe:hb.a.JFe};Fa.prototype.pma=function(){return u.a.pzf};Fa.prototype.iNd=function(){return 13};Fa.prototype.kNd=function(){return 12};Fa.prototype.hga=function(){return null};Fa.prototype.Qqa=function(){return this.Ul?this.Fv?Wa.NFe:Wa.MFe:null};Fa.prototype.JOd=function(){return null};Fa.prototype.Xv=function(){return null};Fa.prototype.ped=function(){return 0};Fa.prototype.RQc=function(){return!0};Object(Oe.a)(Fa,"LockedSheetIconDataSource",null,[491]);Ga.prototype.QG=function(){return this.sheet.active};
Ga.prototype.Uhd=function(){return this.sheet.Ke.YB};Ga.prototype.hga=function(){return this.Fv?this.QG()?Wa.Zdh:Wa.aeh:this.QG()?Wa.Ydh:Wa.$dh};Ga.prototype.Pqa=function(){return!this.QG()&&this.ySf()?hb.a.Qfh:hb.a.Pfh};Ga.prototype.pma=function(){return!this.QG()&&this.ySf()?u.a.fcj:u.a.ecj};Ga.prototype.iNd=function(){return 14};Ga.prototype.kNd=function(){return 16};Ga.prototype.Qqa=function(){return Wa.edh};Ga.prototype.JOd=function(){return this.sheet.Ke.Kjb};Ga.prototype.Xv=function(){return this.brj};
Ga.prototype.ped=function(){return 8};Ga.prototype.RQc=function(){return!1};Object(Oe.a)(Ga,"NamedSeetViewSheetIconDataSource",null,[491]);Ha.prototype.E2f=function(){if(this.FH&&(this.Oj||this.fza)){if(this.Fv){var O=this.dataSource.pma();this.pma!==O&&(this.fza&&this.fza.parentNode.removeChild(this.fza),this.Y1e(),this.pma=O)}else O=this.dataSource.Pqa(),this.Pqa!==O&&(this.bDd(this.Oj,this.Pqa,O),this.Pqa=O);O=this.dataSource.hga();this.hga!==O&&(this.Fv?this.TWi(this.fza,this.hga,O):this.bDd(this.Oj,
this.hga,O),this.hga=O);O=this.dataSource.Qqa();this.Qqa!==O&&(this.bDd(this.FH,this.Qqa,O),this.Qqa=O);this.dataSource.Xv()&&!this.dataSource.QG()&&this.clearToolTip()}};Ha.prototype.Bgj=function(O,qa,rb){this.QWh(O,qa,rb);mf.DOMElementExtensions.setVisible(this.FH,this.dataSource.Uhd())};Ha.prototype.clearToolTip=function(){var O=this;sg.TaskExtensions.Aa(this.Wxb,function(){dialogControls.clearToolTip(O.dataSource.Xv())},this.$.la,3)};Ha.prototype.QWh=function(O,qa,rb){this.FH&&this.n7e!==O&&(this.FH.parentNode.removeChild(this.FH),
this.Qqa=this.hga=this.pma=this.Pqa=this.ILc=null,this.dataSource.Xv()&&(this.rc.detach("mouseover",!0),this.rc.detach("mouseout",!0)));this.FH||(this.ILc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.FH,f.a.Iga),Sys.UI.DomElement.addCssClass(this.FH,hb.a.sB),he.EwaSettings.ka(531)?O===this.dataSource.RQc()?qa.appendChild(this.FH):qa.insertBefore(this.FH,rb):O?qa.insertBefore(this.FH,rb):qa.appendChild(this.FH),this.Fv?this.Y1e():(this.Oj=document.createElement("img"),this.Oj.tabIndex=
-1,this.Oj.alt=this.dataSource.altText,this.FH.appendChild(this.Oj),this.Oj.src=wf.a.ve(this.dataSource.ped())),this.dataSource.Xv()&&(this.rc.ja("mouseover",Object(bd.a)(this,this.pE,"onMouseOver"),!0),this.rc.ja("mouseout",Object(bd.a)(this,this.iH,"onMouseOut"),!0)),this.n7e=O)};Ha.prototype.TWi=function(O,qa,rb){O&&(Sys.UI.DomElement.removeCssClass(O,qa),Sys.UI.DomElement.addCssClass(O,rb))};Ha.prototype.bDd=function(O,qa,rb){qa&&Sys.UI.DomElement.removeCssClass(O,qa);rb&&Sys.UI.DomElement.addCssClass(O,
rb)};Ha.prototype.dispose=function(){If.a.Fa(this.t0)};Ha.prototype.pE=function(){var O=this;this.dataSource.QG()&&sg.TaskExtensions.Aa(this.Wxb,function(){dialogControls.renderToolTip(O.dataSource.Xv(),"SheetIconTooltip",O.dataSource.JOd(),O.FH,10,!1,!1,1)},this.$.la,3)};Ha.prototype.iH=function(){this.dataSource.QG()&&this.clearToolTip()};Ha.prototype.Y1e=function(){var O=this.$.ea.Ba(388);O?(this.fza=O.Ita(this.dataSource.pma(),this.dataSource.iNd(),this.dataSource.kNd()))?this.FH.appendChild(this.fza):
Tc.ULS.shipAssertTag(537153763,0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.pma()):Tc.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};Ll.Object.defineProperties(Ha.prototype,{rc:{configurable:!0,enumerable:!0,get:function(){return this.t0||(this.t0=Jd.a.instance.yd(this.FH))}},Wxb:{configurable:!0,enumerable:!0,get:function(){var O=this;if(this.yoa)return this.yoa;var qa=new bf.a;this.$.RD(function(rb){sg.TaskExtensions.Aa(rb.Xmd(),
function(){qa.setResult(!0)},O.$.la,3)});return this.yoa=qa.task}},FH:{configurable:!0,enumerable:!0,get:function(){return this.ILc}}});Object(Oe.a)(Ha,"SheetIcon",null,[6]);var fd=b(344),Pd=b(147),Xd=Lg.a;Em(mb,Xd);mb.prototype.dispose=function(){this.Vla&&(Tf.a.instance.za(ed.a.zj,this.Vla.domElement,Object(bd.a)(this,this.Paa,"onDblClick")),fd.a.instance.za(this.Vla.domElement,Object(bd.a)(this,this.Uk,"onContextMenu")),this.X9d=null);this.$=null;Xd.prototype.dispose.call(this)};mb.prototype.onKeyDown=
function(O){121===O.keyCode&&O.shiftKey&&!this.Vla.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Vla.anchor),yg.g(O))};mb.prototype.Paa=function(O){if(!this.$.isEditMode||this.Vla.disabled)return!0;this.rename(!1,O.yb);return!0};mb.prototype.Uk=function(O){return this.Vla.disabled?!0:this.showContextMenu(O.clientPoint,O.yb,O.Sb)};mb.prototype.showContextMenu=function(O,qa,rb){this.Vla.activate(qa,mg.a.skd());qa=new nd.a(-1075099431,qa,this.$.dd,30,null);var Sb,Uc={};return!Pd.a(Sb=
this.$.Ka.Ub(qa,(Uc.ClientPoint=O,Uc.Sheet=this.Vla.sheet,Uc.Target=rb,Uc)))&&(6!==Sb.status||Sb.result)};mb.prototype.rename=function(O,qa){this.$.De(817296323,qa,O?19:0,null)};Ll.Object.defineProperties(mb.prototype,{Vla:{configurable:!0,enumerable:!0,get:function(){return this.X9d}}});Object(Oe.a)(mb,"SheetOpsSheetClickHelper",Lg.a,[]);Em(Ka,lb);Ka.prototype.gAh=function(){return mf.DOMElementExtensions.canReceiveFocus(this.anchor)?this.anchor:null};Ka.prototype.dispose=function(){if(this.tsa){Ud.a.instance.za(ed.a.pointerDown,
this.domElement,Object(bd.a)(this,this.onPointerDown,"onPointerDown"));de.KeyInputManager.instance.za(ed.a.Qb,this.domElement,Object(bd.a)(this,this.onKeyDown,"onKeyDown"));de.KeyInputManager.instance.za(ed.a.Eo,this.domElement,Object(bd.a)(this,this.Cy,"onKeyPress"));Tf.a.instance.za(ed.a.click,this.domElement,Object(bd.a)(this,this.Rc,"onClick"));Ud.a.instance.za(ed.a.cV,this.domElement,Object(bd.a)(this,this.I6a,"onMouseEnter"));Ud.a.instance.za(ed.a.Hy,this.domElement,Object(bd.a)(this,this.eud,
"onMouseLeave"));if(this.V3a||he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))Ud.a.instance.za(ed.a.Ud,this.domElement,Object(bd.a)(this,this.Ah,"onPointerUp")),this.dva&&(xd.a.instance.za(ed.a.ye,this.domElement,Object(bd.a)(this,this.Ah,"onPointerUp")),xd.a.instance.za(ed.a.Gg,this.domElement,Object(bd.a)(this,this.FM,"onTouchMove")));this.tsa=!1;this.e1b="#BEBBB8"}If.a.mc([this.Vqe,this.fme]);this.uN=this.uD=this.bzc=this.TQ=this.fme=this.Vqe=null;
if(this.Sla){for(var O=Ol(this.Sla),qa=O.next();!qa.done;qa=O.next())qa.value.dispose();this.Sla=null}this.color=this.qSb=null;lb.prototype.dispose.call(this)};Ka.prototype.gW=function(O){O&&this.Lla(!1,!1);lb.prototype.gW.call(this,O)};Ka.prototype.LKd=function(O){if(Gb.a.Df.OG){this.$ze();var qa=ig.GetServiceTaskFactory.Va(this.$.ea,322,323,1,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewTeachingCallout");sg.TaskExtensions.Aa(qa,function(rb){ka.UISurfaces.JL().then(function(Sb){var Uc=
rb.result;Uc.a9i(Sb);Uc.show(O);return null},function(Sb){Tc.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Sb);return null})},this.la,3)}};Ka.prototype.see=function(){var O=this;if(this.sheet.active&&this.$.Yq){var qa=this.$.Yq,rb=Hf.g(this.$),Sb=rb.Phd;if(this.sheet.Ke.YB){if(!this.Zyb){var Uc=new Ga(this.sheet,this.TQ.grc,function(){return O.color?Ka.kKd(O.color):!1},this.Fv);this.Zyb=new Ha(this.$,Uc);this.Sla.add(this.Zyb)}Sb?
rb.Xbb(1):qa.classList.add(hb.a.w4c);qa=Ka.u$c(Ue.a.chf);rb=Ka.u$c(Ue.a.Bqd);Sb=Ka.u$c(Ue.a.Wgf);Uc=this.sheet.Ke.WJd;this.sheet.Ke.WJd=!1;"true"===Sb&&Uc&&this.$.fa.ZJd?(ja.a.Uv(Ue.a.Wgf,"false",ja.a.pZ),this.$.fa.ZJd=!1,this.LKd(3)):"true"===qa&&"true"===rb&&"true"===Sb?this.$.fa.$Jd&&this.$.fa.qHb&&(this.sheet.Ke.vU?(qa=1,ja.a.Uv(Ue.a.Bqd,"false",ja.a.pZ),this.$.fa.qHb=!1):qa=0,ja.a.Uv(Ue.a.chf,"false",ja.a.pZ),this.$.fa.$Jd=!1,this.LKd(qa)):this.sheet.Ke.vU&&"true"===rb&&"true"===Sb&&this.$.fa.qHb&&
(ja.a.Uv(Ue.a.Bqd,"false",ja.a.pZ),this.$.fa.qHb=!1,this.LKd(2))}else this.$ze(),Sb?rb.Xbb(0):qa.classList.remove(hb.a.w4c)}};Ka.prototype.$ze=function(){if(he.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var O=this.$.ea.Ba(322);O&&O.dismiss()}else this.$.akd&&(O=ig.GetServiceTaskFactory.Va(this.$.ea,322,323,0,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewTeachingCallout"),sg.TaskExtensions.Aa(O,function(qa){qa.result.dismiss()},this.$.la,3))};Ka.prototype.fcb=
function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.H3a()?Wa.Lnj:Wa.Snj;he.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.uN.parentNode.classList.add(Wa.U$h):this.uN.parentNode.classList.add(Wa.V$h);this.s3f();this.Sgd&&this.see();this.Cgj();this.y3f();this.Fvc();this.Sgd||this.see()};Ka.prototype.Azi=function(){this.dJd=!0;this.Lla(!0,!0,"OnSheetReorderStarted")};Ka.prototype.zzi=function(){this.dJd=!1;this.Lla(!1,void 0,"OnSheetReorderEnded")};
Ka.prototype.activate=function(O,qa){O=void 0===O?0:O;qa=void 0===qa?!1:qa;this.aZb()||(this.sheet.activate(),qa&&Hf.g(this.$).focus(),qa={},O=(qa.InputMethod=K.a[O],qa.AppMode=this.$.dd,qa.Location="canvas",qa),qe.b(this.$).ee(Kf.a.Sbj,O))};Ka.prototype.r3f=function(O){this.e1b=O?"#797775":"#BEBBB8";this.i_c=O?-.5:.5;this.DBc=O?$b.a.jp("#3B3A39"):$b.a.jp("#F5F5F5");this.y3f()};Ka.prototype.d6i=function(O){this.V3a=O};Ka.prototype.$sd=function(O){O.AXc();this.mpe(O)};Ka.prototype.mpe=function(O){O.oYa();
this.sheet.activate()};Ka.prototype.jng=function(O){O=new nd.a(-1876836819,O,this.$.dd,30,null);var qa={};return this.$.Ka.Ub(O,(qa.SNTA=this.sheet.name,qa))};Ka.prototype.s3f=function(){this.uN.parentNode.setAttribute("sheet-title",this.uN.innerText)};Ka.prototype.Fvc=function(){var O=this.duh();this.anchor.setAttribute(Ue.a.fv,O);this.anchor.setAttribute(Ue.a.Cfa,this.sheet.active.toString())};Ka.prototype.duh=function(){var O=this.sheet.Ke.YB,qa=this.sheet.Ke.Kjb,rb=this.sheet.Pi,Sb=this.sheet.isLockPausedInSession;
return O&&rb?String.format(Sc.a.instance.Bb(20),this.name,qa):O&&Sb?String.format(Sc.a.instance.Bb(22),this.name,qa):O?String.format(Sc.a.instance.Bb(19),this.name,qa):rb?String.format(Sc.a.instance.Bb(18),this.name):Sb?String.format(Sc.a.instance.Bb(21),this.name):this.name};Ka.prototype.onKeyDown=function(O){return 13!==O.Ea.keyCode||this.disabled?!1:(this.activateSheet(1),!0)};Ka.prototype.Cy=function(O){return 32!==O.Ea.charCode||this.disabled?!1:(this.activateSheet(1),!0)};Ka.prototype.pE=function(){this.disabled||
(this.TQ.Czi(this),this.TQ.eE||this.Lla(!0,void 0,"OnMouseOver"))};Ka.prototype.iH=function(){this.disabled||this.Lla(!1,void 0,"OnMouseOut")};Ka.prototype.I6a=function(){this.TQ.eE||(this.dlj(),this.sheet.Y5||Hf.g(this.$).p9a(this.sheet.sheetName));return!1};Ka.prototype.eud=function(){this.TCe(!1);return!1};Ka.prototype.Rc=function(O){if(this.disabled)return!0;var qa=Hf.g(this.$);this.sheet.active||3!==O.yb?this.Ul?this.activateSheet(O.yb):mg.a.skd()&&qa.focus():(!mg.a.QKa(this.$)&&!this.Mwb||qa.isEditing||
qa.li||qa.apb(),this.activateSheet(O.yb));return 3!==O.yb};Ka.prototype.onPointerDown=function(O){var qa=this;if(this.disabled)return!0;this.TCe(!0);Hf.g(this.$).inRangePicker&&Tc.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var rb=3===O.yb;if(2===O.yb||rb&&this.dva)this.Ul?(this.Lla(!0,!rb,"OnPointerDown"),rb=fg.Task.delay(rb?this.VQf:this.UQf).CWR(function(){return!0})):rb=this.activateSheet(O.yb),
this.V3a&&(this.Mcc=!0,this.TQ.Dnc=sg.TaskExtensions.Aa(rb,function(){qa.Mcc&&qa.TQ.Ezi(qa,O)},this.la,11));return!1};Ka.prototype.Ah=function(O){var qa=this;if(this.disabled||!this.V3a&&he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;var rb=this.TQ.eE&&!mg.a.y6e();this.Mcc=!1;this.Ul&&this.Lla(2===O.yb,void 0,"OnPointerUp");this.TQ.Dnc&&(sg.TaskExtensions.Aa(this.TQ.Dnc,function(){qa.TQ.Dzi(qa)},this.la,11),this.TQ.Dnc=null);return rb};Ka.prototype.activateSheet=
function(O){O=void 0===O?0:O;if(mg.a.skd()){if(he.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.aZb())return fg.Task.Ra(!1);Ac.a.current.MQ="ActivateSheet";this.sheet.activate();return fg.Task.Ra(!0)}return this.jng(O)};Ka.prototype.y3f=function(){var O=this.sheet.tabColor;this.color=Yd.a.ma(O)?this.t0g:$b.a.jp(O);this.f6e=Ka.kKd(this.color);this.Lla(!1,void 0,"UpdateTabColor")};Ka.prototype.Lla=function(O,qa,rb){qa=void 0===qa?!1:qa;rb=void 0===rb?null:
rb;if(this.sheet){rb=this.sheet.active;var Sb=this.H3a(),Uc=!Yd.a.ma(this.sheet.tabColor),vd=$b.a.$E(rb||Sb?X.a.white:this.color);this.uD.style.background="";rb||Sb?(Uc?he.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.gJa?this.S$i():this.Ul?this.R$i():this.Q$i():this.Ul||(this.uD.style.backgroundColor=vd),this.uD.style.height=this.MWc.toString()+"px"):(this.uD.style.filter="",this.uD.style.backgroundColor=vd,this.uD.style.height=this.NWc.toString()+
"px");this.uN.className=rb?Wa.Mnj:Sb?Wa.dark:this.f6e?Wa.light:Wa.dark;vd=Ol(this.Sla);for(var oe=vd.next();!oe.done;oe=vd.next())oe.value.E2f();this.Ul&&(O&&!Uc&&(this.uD.style.backgroundColor="#E1DFDD"),mf.DOMElementExtensions.toggleCssClass(this.domElement,Wa.Rnj,O),qa?(Uc||(this.uD.style.backgroundColor=this.e1b),this.domElement.style.backgroundColor=this.e1b):(Uc||(this.uD.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.uN.style.fontWeight=rb||Sb||!this.Ul&&O?this.Ul?
"600":"bold":""}else Tc.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",rb)};Ka.prototype.R$i=function(){var O=this.uD.style,qa=$b.a.$E(Ka.XUc(this.color,this.i_c));O.background=qa};Ka.prototype.Q$i=function(){var O=this.uD.style,qa=$b.a.$E(Ka.XUc(this.color,1)),rb=$b.a.$E(Ka.XUc(this.color,this.i_c)),Sb="";if(zf.a.sja)Sb="-webkit-";else if(zf.a.uf)Sb="-moz-";else if(zf.a.jf){if(Sb="-ms-",!zf.a.v3a){O.filter=
String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",qa,rb);return}}else zf.a.O6e&&(Sb="-o-");O.background=String.format("{0}linear-gradient({1}, {2})",Sb,qa,rb)};Ka.prototype.S$i=function(){this.uD.style.background="transparent"};Ka.prototype.QRg=function(){this.bzc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=Wa.Nnj;mf.DOMElementExtensions.fo(this.anchor,Ue.a.klb,null,null);this.tabIndex=-1};Ka.prototype.WXg=function(){this.uD=
document.createElement("span");this.uD.className=Wa.Pnj;this.uN=document.createElement("span");this.uN.className=Wa.Unj;this.uN.dir=this.sheet.rtlName?"rtl":"ltr";this.uD.appendChild(this.uN)};Ka.prototype.Cgj=function(){for(var O=this.$.qI,qa=Ol(this.Sla),rb=qa.next();!rb.done;rb=qa.next())rb.value.Bgj(O,this.uD,this.uN)};Ka.prototype.H3a=function(){return Hf.g(this.$).H3a(this.sheet)};Ka.prototype.dlj=function(){this.Vdd.start();this.Thd=!0};Ka.prototype.TCe=function(O){if(this.Thd){this.Vdd.stop();
var qa={};O=(qa["Sheet index"]=this.sheet.index,qa["Active Sheet"]=this.sheet.active,qa["Hovering time"]=this.Vdd.Cc,qa["Has been clicked"]=O,qa);Tc.ULS.sendTraceTag(537153686,0,50,ad.c(O));this.Thd=!1}};Ka.prototype.jRi=function(){Ud.a.instance.pa(ed.a.pointerDown,this.domElement,Object(bd.a)(this,this.onPointerDown,"onPointerDown"));de.KeyInputManager.instance.pa(ed.a.Qb,this.domElement,Object(bd.a)(this,this.onKeyDown,"onKeyDown"));de.KeyInputManager.instance.pa(ed.a.Eo,this.domElement,Object(bd.a)(this,
this.Cy,"onKeyPress"));this.rc.ja("mouseover",Object(bd.a)(this,this.pE,"onMouseOver"));this.rc.ja("mouseout",Object(bd.a)(this,this.iH,"onMouseOut"));Ud.a.instance.pa(ed.a.cV,this.domElement,Object(bd.a)(this,this.I6a,"onMouseEnter"));Ud.a.instance.pa(ed.a.Hy,this.domElement,Object(bd.a)(this,this.eud,"onMouseLeave"));if(this.V3a||he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))Ud.a.instance.pa(ed.a.Ud,this.domElement,Object(bd.a)(this,this.Ah,"onPointerUp")),
this.dva&&(xd.a.instance.pa(ed.a.ye,this.domElement,Object(bd.a)(this,this.Ah,"onPointerUp")),xd.a.instance.pa(ed.a.Gg,this.domElement,Object(bd.a)(this,this.FM,"onTouchMove")));Tf.a.instance.pa(ed.a.click,this.domElement,Object(bd.a)(this,this.Rc,"onClick"));this.tsa=!0};Ka.prototype.FM=function(){if(!this.V3a&&he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;this.Mcc=!1;this.dJd||this.Lla(!1,void 0,"OnTouchMove");return!1};Ka.prototype.aZb=
function(){var O=this.$.ea.Ba(65);return O&&O.I3()?(O.qFb(),this.mpe(O),!0):!1};Ka.u$c=function(O){var qa=ja.a.get(O);qa||(ja.a.Uv(O,"true",ja.a.pZ),qa=ja.a.get(O));return qa};Ka.XUc=function(O,qa){if(1<qa||-1>qa)return O;var rb=O.r,Sb=O.g;O=O.b;0<qa?(rb=rb*(1-qa)+255*qa,Sb=Sb*(1-qa)+255*qa,O=O*(1-qa)+255*qa):(rb*=1+qa,Sb*=1+qa,O*=1+qa);return X.a.krb(Math.round(rb),Math.round(Sb),Math.round(O))};Ka.kKd=function(O){return 128>=(222*O.r+707*O.g+71*O.b)/1E3};Ll.Object.defineProperties(Ka.prototype,
{t0g:{configurable:!0,enumerable:!0,get:function(){return this.DBc||(this.DBc=$b.a.jp("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.uN.innerText},set:function(O){this.uN&&(this.uN.innerText=O,this.Fvc(),this.s3f())}},sheet:{configurable:!0,enumerable:!0,get:function(){return this.qSb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.bzc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(O){this.anchor.tabIndex=
O}}});Object(Oe.a)(Ka,"SheetTabButton",lb,[]);Em(ta,lb);Object(Oe.a)(ta,"WorkbookProtectionButton",lb,[]);var Te=b(49),rf=b(47),Ne=b(53),Yf=te.a;Em(ea,Yf);ea.prototype.Ab=function(O,qa,rb,Sb,Uc,vd,oe){oe=void 0===oe?!1:oe;O.removeAttribute("Href");O.setAttribute(Ue.a.Od,Ue.a.Zq);O.className=Wa.Xdh;O.title=qa;O.tabIndex=0;this.Fv&&vd?rb=this.svgIconProvider.I$(vd,12,12,O,24,24):(qa=document.createElement("span"),qa.className=this.Ul?hb.a.WLg:hb.a.sB,qa.classList.add(f.a.Iga),qa.tabIndex=-1,O.appendChild(qa),
vd=document.createElement("img"),vd.src=wf.a.ve(rb),vd.className=Sb,vd.alt=Uc,vd.tabIndex=-1,qa.appendChild(vd),rb=vd);oe&&O.classList.add(f.a.QX);return rb};ea.prototype.dispose=function(){if(this.$){var O=this.$.va;O.zg(Object(bd.a)(this,this.Ai,"onActiveSheetChanged"));O.Vmc(Object(bd.a)(this,this.S4,"onCleared"));O.K5(Object(bd.a)(this,this.hC,"onSheetDeleted"));O.Yka(Object(bd.a)(this,this.aBb,"onSheetInserted"));O.ZNa(Object(bd.a)(this,this.Owa,"onSheetRenamed"));O.tFf(Object(bd.a)(this,this.Asf,
"onSheetReordered"));O.hEb(Object(bd.a)(this,this.Csf,"onSheetVisibilityChanged"));O.vUi(Object(bd.a)(this,this.Bsf,"onSheetTabColorChanged"));O.lCd(Object(bd.a)(this,this.tjf,"onActiveItemLockChanged"));O.qFf(Object(bd.a)(this,this.ujf,"onActiveItemLockPausedChanged"));O.rFf(Object(bd.a)(this,this.vjf,"onActiveItemNamedSheetViewModeChanged"));O.sFf(Object(bd.a)(this,this.vMa,"onItemNamedSheetViewSwitched"));this.$.dl(Object(bd.a)(this,this.jd,"onWorkbookOpened"));this.$.oH(Object(bd.a)(this,this.fk,
"onContentAreaResized"));cf.a(this.$)&&cf.a(this.$).pg.Zka(Object(bd.a)(this,this.qE,"onPartialInteractivityStatusChanged"));this.Pra&&Hf.g(this.$).VEf(Object(bd.a)(this,this.Wzb,"onComponentRangePickerActiveStateChanged"));rg.a.instance.za(ed.a.dC,this.domElement,Object(bd.a)(this,this.X4,"onMouseWheel"))}If.a.mc(this.Lqd);this.Lqd=null;if(this.KJ)for(O=0;O<this.KJ.length;O++){var qa=mf.DOMElementExtensions.fJ(this.KJ[O],this.domElement,!1,"a");qa&&af.a.Vka(qa)}If.a.Fa(this.oB);If.a.Fa(this.orc);
If.a.Fa(this.hJd);this.hJd=this.orc=this.Rub=this.zG=this.oB=null;this.$&&this.uy&&this.jP(!1);this.y9=null;this.oHd(null,"Dispose");this.HIb=this.tL=this.V2b=null;this.$Vc();this.P$a=this.prc=this.iJd=this.Fk=this.KJ=this.$=this.fa=null;Yf.prototype.dispose.call(this)};ea.prototype.Le=function(O,qa){if(!qa){Tc.ULS.shipAssertTag(537153760,0,0<this.gh.length,"There is no sheet tab button.");if(!this.gh.length)return!1;O=null;for(var rb=Ol(this.gh),Sb=rb.next();!Sb.done&&!(O=Sb.value.gAh());Sb=rb.next());
if(!O)return Tc.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;mf.DOMElementExtensions.setFocus(O)}return!qa};ea.prototype.rh=function(O){return mf.DOMElementExtensions.Ue(this.Ib,O)};ea.prototype.Uh=function(){};ea.prototype.Nh=function(){};ea.prototype.reorderSheets=function(O,qa,rb){if(this.sZ&&this.sZ!==O){var Sb=this.sZ.index;this.GWi(this.sZ,O,qa);O=O?O.index-1:qa?this.$.va.count-1:0;Sb!==O&&(this.Rdi(Sb,O,rb),this.H8g(this.sZ.name,O))}};ea.prototype.hC=function(O,
qa){this.xsf(qa.item)};ea.prototype.Owa=function(O,qa){O=this.$.va.qa.index;for(var rb=0,Sb=this.gh.length;rb<Sb;rb++){var Uc=this.BP(rb);if(Uc.name===qa.oldName){Uc.name=qa.newName;this.SZ();rb===O&&this.f_(6);break}}};ea.prototype.Bsf=function(O,qa){(O=this.H_a(qa.item))&&O.fcb()};ea.prototype.Csf=function(O,qa){qa.visible?(this.lPa(!1),this.ysf(qa.item)):this.xsf(qa.item)};ea.prototype.dLh=function(O){O=this.rha(O);return-1!==O&&this.hu<=O&&O<=this.zJ?this.gh[O].domElement:null};ea.prototype.Wyj=
function(O){if(this.Fv){for(var qa=0;qa<this.KJ.length;qa++){var rb=this.KJ[qa];if(rb&&this.svgIconProvider){var Sb=rb.parentNode;this.xEf(rb);Sb&&(this.KJ[qa]=this.svgIconProvider.I$(O?this.Oxf[qa]:this.Mqd[qa],12,12,Sb,24,24))}}for(qa=0;qa<this.gh.length;qa++)this.gh[qa].r3f(O);this.uPa&&this.uPa.Dqa&&this.q3f(u.a.VMh,this.uPa,O);this.zG&&this.zG.Dqa&&this.q3f(u.a.bOg,this.zG,O)}};ea.prototype.q3f=function(O,qa,rb){qa.Q7a||(qa.Q7a=this.svgIconProvider.I$(O,12,12,qa.Dqa.parentNode,24,24));qa.Q7a&&
(mf.DOMElementExtensions.setVisible(qa.Dqa,!rb),mf.DOMElementExtensions.setVisible(qa.Q7a,rb))};ea.prototype.Ezi=function(O,qa){var rb=Hf.g(this.$),Sb=rb.inRangePicker,Uc=ue.HelperMethods.om(qa);if(rb.isEditing&&!Sb){if(this.s1h){var vd=rb.nj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";tg.a(this.$).Bma(Uc.rawEvent,vd)}rb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}rb=this.dva&&3===qa.yb;(2!==qa.yb||Uc.button)&&!rb||Sb||this.eE||cf.a(this.$).Eq()||(rb&&O.Azi(),this.dxb=
qa.clientPoint.x,this.TX=qa,this.mBg(O))};ea.prototype.Czi=function(O){!this.uy&&this.eE&&this.WKd(O.sheet,!1)};ea.prototype.Dzi=function(O){this.uy||(this.eE&&this.reorderSheets(O.sheet,!1,!0),this.jP());this.SZ()};ea.prototype.whe=function(){return this.$.isEditMode&&!$c.k(this.$.kg)};ea.prototype.SZ=function(){var O=this,qa=ue.HelperMethods.Yva(function(){O.Ywj();O.Ul&&O.t$i();O.MHd()});Tc.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",
qa)};ea.prototype.t$i=function(){var O=this.zJ===this.gh.length-1;mf.DOMElementExtensions.toggleCssClass(this.P$a,this.$.qI?Wa.TFe:Wa.IFe,!!this.hu);mf.DOMElementExtensions.toggleCssClass(this.P$a,this.$.qI?Wa.IFe:Wa.TFe,!O)};ea.prototype.MHd=function(O){O=void 0===O?!1:O;var qa=!this.hu,rb=this.zJ===this.gh.length-1;this.POf(4,this.sheetTabActivatePreviousHidden,!qa);this.POf(5,this.sheetTabActivateNextHidden,!rb);this.Hqc(0,qa||O);this.Hqc(1,qa||O);this.Hqc(2,rb||O);this.Hqc(3,rb||O)};ea.prototype.POf=
function(O,qa,rb){if(O=this.KJ[O]){mf.DOMElementExtensions.setVisible(O,rb);var Sb=this.sSe(O);Sb.title="img"===O.nodeName?O.alt=0<this.gh.length&&rb?qa:"":O.title=0<this.gh.length&&rb?qa:"";Sb.tabIndex=rb?0:-1}};ea.prototype.sSe=function(O){return this.Fv?O.parentNode:O.parentNode.parentNode};ea.prototype.Hqc=function(O,qa){if(O=this.KJ[O])O=this.sSe(O),void 0!==O&&null!==O&&(!this.gh.length||qa?(O.classList.add(f.a.QX),O.setAttribute(Ue.a.lqa,"true")):(O.classList.remove(f.a.QX),O.setAttribute(Ue.a.lqa,
"false")))};ea.prototype.lPa=function(O){var qa=this.$.qI?this.gh.length-1:0,rb=this.EUe(this.$.qI?0:this.gh.length-1);rb&&(rb.borderRightWidth=O?"1px":"0");this.hu!==this.zJ&&(rb=this.EUe(qa))&&(rb.borderRightWidth="0")};ea.prototype.Eee=function(O,qa){this.gh||(this.gh=[]);-1===qa?Array.add(this.gh,O):Array.insert(this.gh,qa,O)};ea.prototype.y0b=function(O,qa){var rb=-1,Sb=null;qa||(rb=this.UDh(O.index),-1!==rb&&(Sb=this.EIa(rb)));O=new Ka(this.$,this.Fk,Sb,O,this,this.Ul,this.Fv);this.Eee(O,rb);
mf.DOMElementExtensions.setVisible(O.domElement,!0)};ea.prototype.WKd=function(O,qa){var rb=this.H_a(O);if(rb){this.Ned=O;this.cqd=qa;O=rb.domElement;rb=this.isRtl?O.offsetLeft+(this.Fk.scrollWidth-this.Fk.clientWidth-this.Fk.scrollLeft):O.offsetLeft-this.Fk.scrollLeft;if(!this.isRtl&&qa||this.isRtl&&!qa)rb+=O.offsetWidth;this.mrc.style.left=ue.HelperMethods.Pb(rb-4);mf.DOMElementExtensions.setVisible(this.mrc,!0)}};ea.prototype.j_e=function(){mf.DOMElementExtensions.setVisible(this.mrc,!1)};ea.prototype.f_=
function(O){var qa=this,rb=ue.HelperMethods.Yva(function(){switch(O){case 0:qa.bpc(0);break;case 1:qa.bpc(qa.hu-1);break;case 2:qa.bpc(qa.hu+1);break;case 3:qa.scrollIntoView(qa.gh.length-1);break;case 4:qa.hu&&1<=qa.gh.length&&(qa.uce(qa.hu-1),qa.PFd());break;case 5:qa.zJ!==qa.gh.length-1&&1<=qa.gh.length&&(qa.uce(qa.zJ+1),qa.PFd());break;case 6:qa.PFd()}});this.d3b&&this.eE&&this.$Jb();Tc.ULS.sendTraceTag(537153755,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",O,rb)};
ea.prototype.uce=function(O){(O=this.BP(O))&&O.activate()};ea.prototype.Ymh=function(O){if(!O.Bx)for(var qa=this.$.va,rb=0,Sb=0,Uc=qa.count;Sb<Uc;Sb++){var vd=Object(nf.a)(Me.a,qa.getItem(Sb));if(vd===O)return rb;vd.Bx||rb++}return-1};ea.prototype.Mmh=function(O){var qa=this.$.va;O=O.index+1;for(var rb=qa.count;O<rb;O++){var Sb=Object(nf.a)(Me.a,qa.getItem(O));if(!Sb.Bx)return Sb}return null};ea.prototype.rha=function(O){for(var qa=0;qa<this.gh.length;qa++){var rb=this.BP(qa);if(!rb)Tc.ULS.sendTraceTag(537153754,
0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",qa);else if(rb.sheet===O)return qa}return-1};ea.prototype.H_a=function(O){O=this.rha(O);return this.BP(O)};ea.prototype.Rdi=function(O,qa,rb){var Sb={};Sb.a=this.$.ya.UserSessionId;Sb.b=rb;Sb.c=this.L2b;Sb.d=O;Sb.e=qa;Sb.f=this.$.va.count;Te.b().Je(2,Sb,rb)};ea.prototype.GWi=function(O,qa,rb){var Sb=Object(nf.a)(sf.a,this.$.va);qa?(qa=qa.index,qa=O.index<qa?qa-1:qa):qa=rb?Sb.count-
1:0;Sb.reorderSheet(O,qa,!0)};ea.prototype.oOf=function(O){Hf.g(this.$).wi.wA(O)};ea.prototype.mBg=function(O){if(!this.Cnc){var qa=this.domElement.ownerDocument.body;this.uy?(Ud.a.instance.pa(ed.a.Ch,document.documentElement,Object(bd.a)(this,this.nE,"onDocumentPointerMove")),this.dva&&(xd.a.instance.pa(ed.a.Gg,document.documentElement,Object(bd.a)(this,this.nE,"onDocumentPointerMove")),xd.a.instance.pa(ed.a.Gg,this.domElement,Object(bd.a)(this,this.FM,"onTouchMove")))):(Ud.a.instance.pa(ed.a.Ch,
qa,Object(bd.a)(this,this.nE,"onDocumentPointerMove")),xd.a.instance.pa(ed.a.Gg,qa,Object(bd.a)(this,this.nE,"onDocumentPointerMove")));Ud.a.instance.pa(ed.a.Ud,document.documentElement,Object(bd.a)(this,this.nQ,"onDocumentPointerUp"));xd.a.instance.pa(ed.a.ye,qa,Object(bd.a)(this,this.nQ,"onDocumentPointerUp"));this.Cnc=!0}this.sZ=O.sheet;this.L2b=!1;this.uy?(this.tL=null,this.V2b=O,this.y9=O.domElement,this.oHd(mf.DOMElementExtensions.getBoundingClientRect(this.y9),"BeginSheetTabButtonDrag")):(Tc.ULS.sendTraceTag(537153752,
0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(Wa.HFe),this.domElement.style.cursor="",this.oOf("pointer"))};ea.prototype.jP=function(O){O=void 0===O?!0:O;if(this.Cnc){this.oOf(Ue.a.Ota);var qa=this.domElement.ownerDocument.body;this.uy?(Ud.a.instance.za(ed.a.Ch,document.documentElement,Object(bd.a)(this,this.nE,"onDocumentPointerMove")),this.dva&&(xd.a.instance.za(ed.a.Gg,document.documentElement,Object(bd.a)(this,this.nE,
"onDocumentPointerMove")),xd.a.instance.za(ed.a.Gg,this.domElement,Object(bd.a)(this,this.FM,"onTouchMove")))):(Ud.a.instance.za(ed.a.Ch,qa,Object(bd.a)(this,this.nE,"onDocumentPointerMove")),xd.a.instance.za(ed.a.Gg,qa,Object(bd.a)(this,this.nE,"onDocumentPointerMove")));Ud.a.instance.za(ed.a.Ud,document.documentElement,Object(bd.a)(this,this.nQ,"onDocumentPointerUp"));xd.a.instance.za(ed.a.ye,qa,Object(bd.a)(this,this.nQ,"onDocumentPointerUp"));this.HFc=this.Cnc=!1}this.Ckc=0;this.L2b=!1;this.Ned=
this.sZ=null;this.uy?(this.y9&&(this.y9.style.visibility="visible",this.y9=null),this.V2b=null,this.oHd(null,"EndSheetTabButtonDrag"),this.tL&&(this.tL.parentNode&&this.tL.parentNode.removeChild(this.tL),this.tL=null),this.VYi(O)):(this.domElement.classList.remove(Wa.HFe),this.j_e())};ea.prototype.VYi=function(O){this.zMd(O);this.TB=this.dxb=-1};ea.prototype.H8g=function(O,qa){function rb(oe,ef,Nf){var kh=vd.Na(9,null);kh.sheetName=O;kh.newSheetIndex=qa;return Ih.i(vd,"ReorderSheets",kh,oe,ef,Nf,
null,0)}function Sb(){return new kb(O,qa)}var Uc=this.$.ra,vd=Uc?Uc.ua:null;he.EwaSettings.pc()?this.$.userOperationManager.jc(new Of.a(557,0,rb,64,Sb),null):this.$.userOperationManager.jc(new be.a(557,0,rb,void 0,Sb),null)};ea.prototype.BP=function(O){return 0<=O&&O<this.gh.length?this.gh[O]:null};ea.prototype.DUe=function(O){return(O=this.BP(O))?O.sheet:null};ea.prototype.EIa=function(O){return(O=this.BP(O))?O.domElement:null};ea.prototype.EUe=function(O){return(O=this.EIa(O))?O.style:null};ea.prototype.UDh=
function(O){var qa=this.$.va;O+=1;for(var rb=-1,Sb=this.gh?this.gh.length:0;O<qa.count;){var Uc=Object(nf.a)(Me.a,qa.getItem(O));if(!Uc.Bx){for(rb=0;rb<Sb&&this.DUe(rb)!==Uc;rb++);break}O++}return-1===rb||rb===Sb?-1:rb};ea.prototype.xsf=function(O){var qa=this.H_a(O);qa&&(this.uy&&this.eE&&(Tc.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),he.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.jP()),this.Fk.removeChild(qa.domElement),qa=Array.indexOf(this.gh,qa),Array.removeAt(this.gh,qa),this.SZ(),(!this.isRtl&&qa===this.gh.length||this.isRtl&&!qa)&&this.lPa(!0),this.d3b&&this.eE?O===this.sZ?(this.jP(),this.f_(6)):this.$Jb():this.f_(6))};ea.prototype.ysf=function(O){var qa=Object(nf.a)(Me.a,O);this.uy&&this.eE&&(Tc.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),he.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.jP());if(!qa.Bx){this.lPa(!1);var rb=this.rha(O);-1===rb&&(Tc.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.y0b(qa,!1),rb=this.rha(O));this.nYe(rb,!0)}};ea.prototype.HWi=function(O,qa){var rb=this.H_a(O);rb&&(this.uy&&this.eE&&!qa&&(Tc.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),he.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.jP()),O=this.Hnj(O,rb),!he.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.uy&&O&&qa&&O.zzi())};ea.prototype.Hnj=function(O,qa){var rb=Array.indexOf(this.gh,qa),Sb=this.Ymh(Object(nf.a)(Me.a,O));if(-1===Sb||-1===rb)return null;rb!==Sb||this.uy?(this.lPa(!1),Sb=ea.DWi(rb,Sb,this.hu,this.zJ),this.hu=Sb.xnh,this.zJ=Sb.Z9h,qa&&qa.domElement.parentNode===this.Fk&&(this.Fk.removeChild(qa.domElement),Array.removeAt(this.gh,rb)),qa=this.Mmh(O),rb=this.rha(qa),
qa=new Ka(this.$,this.Fk,this.EIa(rb),Object(nf.a)(Me.a,O),this,this.Ul,this.Fv),this.Eee(qa,rb),rb=this.rha(O),this.nYe(rb,!1,!this.Ul)):qa=null;return qa};ea.prototype.t9g=function(){for(var O=this.gh?this.gh.length:0,qa=this.hu,rb=this.zJ,Sb=0;Sb<O;Sb++){var Uc=this.BP(Sb),vd=Sb>=qa;Uc&&(Uc.tabIndex=vd&&Sb<=rb?0:-1)}};ea.prototype.Pvj=function(){for(var O=this.gh?this.gh.length:0,qa=0;qa<O;qa++){var rb=this.BP(qa);rb&&rb.fcb()}};ea.prototype.nYe=function(O,qa,rb){rb=void 0===rb?!0:rb;qa&&O<=this.hu&&
this.hu++;this.t9g();this.lPa(!0);this.SZ();this.d3b&&this.eE?this.$Jb():rb&&this.f_(6)};ea.prototype.oqc=function(O){var qa=this.$.qI;if(O||this.isRtl!==qa)this.isRtl=qa,this.domElement.classList.remove(this.isRtl?hb.a.OFe:hb.a.UFe),this.domElement.classList.add(this.isRtl?hb.a.UFe:hb.a.OFe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.Pvj();O||this.lPa(!0);for(O=0;O<this.KJ.length;O++)O&&3!==O&&(!this.Ul||4!==O&&5!==O)&&this.QOf(O)};ea.prototype.IVg=function(){var O=this.iJd=document.createElement("div");
O.className=Wa.Udh;this.Ul&&O.classList.add(Wa.Vdh);this.domElement.appendChild(O);this.t0b(O,1,689,688);this.t0b(O,2,691,690);this.v8e&&(this.uPa=new db(this.$,this,O));this.Ul||this.t0b(O,4,695,694)};ea.prototype.JVg=function(){var O=this.prc=document.createElement("div");O.className=Wa.Wdh;this.domElement.appendChild(O);this.Ul||this.t0b(O,5,697,696);this.BZc()};ea.prototype.JWg=function(){var O=document.getElementById(Ue.a.Tbj),qa=document.getElementById(Ue.a.Ubj);O&&!qa&&Tc.ULS.sendTraceTag(537153746,
0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",O.parentNode.id,!!O.firstChild,!!document.getElementById(Ue.a.bJd));if(mg.a.A8e(this.$)&&O&&qa)this.domElement.appendChild(O),this.jJd=O.firstChild,this.kJd=document.getElementById(Ue.a.bJd),qa.style.visibility="visible";else{O=document.createElement("div");qa=document.createElement("div");O.className=hb.a.eeh;qa.className=
hb.a.ceh;qa.style.display="none";var rb=document.createElement("div");rb.className=hb.a.feh;var Sb=document.createElement("div");Sb.className=hb.a.deh;var Uc=document.createElement("div");Uc.className=hb.a.beh;qa.appendChild(rb);qa.appendChild(Sb);qa.appendChild(Uc);O.appendChild(qa);this.domElement.appendChild(O);this.jJd=qa;this.kJd=Sb}};ea.prototype.QOf=function(O){var qa=this.KJ[O];if(qa)if(this.Fv){var rb=qa.parentNode;this.xEf(qa);qa=uf.a(this.$)?this.Oxf[O]:this.Mqd[O];this.KJ[O]=this.svgIconProvider.I$(qa,
12,12,rb,24,24)}else qa.className=this.Kqd[O]};ea.prototype.xEf=function(O){O&&O.parentNode&&O.parentNode.removeChild(O)};ea.prototype.cTg=function(){var O=this.P$a=document.createElement("div");O.className=Wa.Rdh;this.domElement.appendChild(O);this.MXg(O)};ea.prototype.MXg=function(O){var qa=document.createElement("div");qa.className=Wa.heh;qa.classList.add(Wa.Sdh);this.$.printingEnabled||qa.classList.add(Se.a.$He);O.appendChild(qa);this.Fk=document.createElement("ul");mf.DOMElementExtensions.fo(this.Fk,
Ue.a.tRc,null,null);this.Fk.className=Se.a.VFe;qa.appendChild(this.Fk);this.BVg();this.T9d=document.createElement("div");this.grc.id="SheetIconTooltipContainer";qa.appendChild(this.grc)};ea.prototype.BVg=function(){var O=document.createElement("div"),qa="<div class='"+hb.a.ZLg+"'>{0}</div>",rb=wf.a.x8c(hb.a.efh,0,"55_16_N","");O.innerHTML=String.format(qa,rb);O.className=Wa.geh;mf.DOMElementExtensions.setVisible(O,!1);this.mrc=O;this.Fk.appendChild(O)};ea.prototype.UZc=function(){for(var O=this.$.va,
qa=0,rb=O.count;qa<rb;qa++){var Sb=Object(nf.a)(Me.a,O.getItem(qa));Sb.Bx||(this.y0b(Sb,!0),Sb.active&&Sb.activate())}};ea.prototype.$Vc=function(){If.a.mc(this.gh);this.gh=[];this.zJ=this.hu=0};ea.prototype.t0b=function(O,qa,rb,Sb){function Uc(Nf){"mouseup"===Nf.type&&vd.uy&&vd.eE||yg.g(Nf);oe.classList.contains(f.a.QX)||(ef?vd.rwi(Nf,qa):vd.Ul||vd.Fpf(Nf,qa))}var vd=this,oe=document.createElement("a");O.appendChild(oe);O=this.Mqd[qa];this.KJ[qa]=this.Ab(oe,Sc.a.instance.da(Sb),0,this.Kqd[qa],Sc.a.instance.da(rb),
O);if(5===qa||4===qa)mf.DOMElementExtensions.fJ(this.KJ[qa],oe,!1,"span").style.marginTop="10px";this.QOf(qa);rb=this.Lqd[qa]=this.Hd.yd(oe);Ud.a.instance.pa(ed.a.pointerDown,oe,function(Nf){return Nf.ctrlKey&&vd.Fqi(qa)?!0:vd.Dpf(qa)});Ud.a.instance.pa(ed.a.Ud,oe,function(){return vd.Epf()});xd.a.instance.pa(ed.a.ye,oe,function(){return vd.Epf()});Ud.a.instance.pa(ed.a.pointerOut,oe,function(){return vd.RVc()});de.KeyInputManager.instance.pa(ed.a.Qb,oe,function(Nf){return 13!==Nf.Ea.keyCode&&32!==
Nf.Ea.keyCode||vd.VXc?!1:(vd.VXc=!0,vd.Dpf(qa))});de.KeyInputManager.instance.pa(ed.a.Xd,oe,function(Nf){return 13===Nf.Ea.keyCode||32===Nf.Ea.keyCode?(vd.VXc=!1,vd.RVc()):!1});var ef=this.whe();rb.ja("mouseover",Uc);rb.ja("mouseout",Uc);rb.ja("focus",Uc);rb.ja("blur",Uc);ef&&rb.ja("mouseup",Uc)};ea.prototype.I4e=function(O){var qa=!1,rb=this.$.Re;rb&&(qa=Le.a.dA(mf.DOMElementExtensions.getBoundingClientRect(rb),O.clientPoint));return qa};ea.prototype.w8e=function(O){return Le.a.dA(mf.DOMElementExtensions.getBoundingClientRect(this.domElement),
O.clientPoint)||this.I4e(O)};ea.prototype.Umh=function(O){var qa=null,rb=O.clientPoint,Sb=this.hu;if(this.w8e(O))for(Sb=this.hu;Sb<=this.zJ;Sb++)if(qa=this.BP(Sb))if(O=mf.DOMElementExtensions.getBoundingClientRect(qa.domElement),!this.isRtl&&rb.x<O.x+O.width||this.isRtl&&rb.x>O.x)break;return{returnValue:qa,rfj:Sb>this.zJ}};ea.prototype.nE=function(O){this.eE?(this.TX=O,this.$Jb()):(this.TX&&(this.Ckc+=this.TX.clientPoint.x-O.clientPoint.x),this.TX=O,Math.abs(this.Ckc)>=this.B5g&&this.$Jb());return!0};
ea.prototype.FM=function(O){O.Ea.preventDefault();return!1};ea.prototype.$Jb=function(){if(this.uy){if(!this.tL){Tc.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.tL=this.y9.cloneNode(!0);if(!this.RJf(this.tL,this.y9,!0,"UpdateDragAndDropState"))return;this.y9.style.visibility="hidden";this.tL.classList.add(Wa.ieh);this.tL.style.borderRightWidth="";this.e9b=this.TX.clientPoint.x-this.C2.width/2;this.tL.style.left=this.e9b+
"px";this.TB=this.rha(this.sZ);0>this.TB&&Tc.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.d3b&&(this.TB=this.rha(this.sZ));var O=mf.DOMElementExtensions.getBoundingClientRect(this.Fk),qa=O.x;O=O.x+O.width;var rb=this.TX.clientPoint.x-this.C2.width/2;rb=Math.min(rb,O-this.C2.width);rb=Math.max(rb,qa);this.tL.style.transform="translateX("+Math.abs(rb-this.e9b)*(this.e9b<rb?1:-1)+"px)";var Sb=this.TX.clientPoint.x>this.dxb,Uc=this.TX.clientPoint.x;
rb>=O-this.C2.width?(Uc=O-this.C2.width/2,this.NFd()||this.Oka||(Tc.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Mjc=this.Fk.scrollLeft,this.Oka=window.requestAnimationFrame(Object(bd.a)(this,this.sLf,"scrollToTheRight")))):rb<=qa?(Uc=qa+this.C2.width/2,this.MFd()||this.Oka||(Tc.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.Mjc=this.Fk.scrollLeft,this.Oka=window.requestAnimationFrame(Object(bd.a)(this,this.rLf,"scrollToTheLeft")))):this.Oka&&(Tc.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.zMd());this.TX.clientPoint.x!==this.dxb&&(this.mNd(Sb,Uc),this.dxb=this.TX.clientPoint.x)}else O=this.Umh(this.TX),qa=O.rfj,(O=O.returnValue)?this.WKd(O.sheet,qa):this.j_e();this.HFc=!0};ea.prototype.mNd=function(O,qa){for(var rb=this,
Sb;function(){var Uc=rb.C5g(qa,O);Sb=Uc.AYb;return Uc}().returnValue;)this.HIb=Sb,this.Mwg(O)};ea.prototype.Mwg=function(O){if(this.HIb){var qa=(O?1:-1)*this.C2.width;if(O&&!this.$.qI||!O&&this.$.qI){var rb=this.y9;var Sb=this.TB+1;var Uc=!0}else rb=(Sb=this.BP(this.TB+1))?Sb.domElement:null,Sb=this.TB-1,Uc=!1;if(this.RJf(this.HIb,rb,Uc,"AnimateSheetSwap")){Tc.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",
this.TB,Sb,this.gJd,O);0<=this.TB&&this.TB<this.gh.length&&0<=Sb&&Sb<this.gh.length?(O=this.gh[Sb],this.gh[Sb]=this.gh[this.TB],this.gh[this.TB]=O):(Tc.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",this.gh.length,this.TB,Sb),this.jP());this.TB=Sb;var vd=this.HIb;vd.style.transform="translateX("+qa+"px)";window.requestAnimationFrame(function(){vd.style.transform="translateX(0px)"})}}};ea.prototype.RJf=
function(O,qa,rb,Sb){function Uc(vd){return vd?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",vd.id,vd.className,vd.nodeName):null}try{return this.Fk.insertBefore(O,qa),!0}catch(vd){return O=this.H_a(this.sZ),Tc.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
O?O!==this.V2b?"Changed":"NoChange":"Removed",Sb,Uc(qa),Uc(qa.parentNode),Uc(this.Fk),rb,this.TB,this.gJd,vd),this.jP(),!1}};ea.prototype.C5g=function(O,qa){var rb=this.$.qI===qa?this.BP(this.TB-1):this.BP(this.TB+1);if(!rb)return{returnValue:!1,AYb:null};rb=rb.domElement;var Sb=mf.DOMElementExtensions.getBoundingClientRect(rb);return this.C2?qa?{returnValue:O+this.C2.width/2>=Sb.x+.5*Sb.width,AYb:rb}:{returnValue:O-this.C2.width/2<=Sb.x+.5*Sb.width,AYb:rb}:(Tc.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.jP(),{returnValue:!1,AYb:rb})};ea.prototype.sLf=function(O){this.pLf(O,!0)};ea.prototype.rLf=function(O){this.pLf(O,!1)};ea.prototype.pLf=function(O,qa){var rb=qa?Object(bd.a)(this,this.sLf,"scrollToTheRight"):Object(bd.a)(this,this.rLf,"scrollToTheLeft");if(-1===this.dtc)this.dtc=O,this.Oka=window.requestAnimationFrame(rb);else{O=Math.floor((O-this.dtc)/1E3*300);var Sb=this.WEb>this.Gxb?1:-1;this.scrollLeft(Math.abs(this.Fk.scrollLeft-(qa?this.Mjc+O*Sb:this.Mjc-O*Sb))*(qa?-1:1));if(O=this.TQe("ScrollStep"))this.mNd(qa,
O.x+O.width/2),qa&&!this.NFd()||!qa&&!this.MFd()?this.Oka=window.requestAnimationFrame(rb):(Tc.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),this.zMd())}};ea.prototype.NFd=function(){var O=this.WEb>this.Gxb;return O&&this.sla>=this.WEb||!O&&this.sla<=this.WEb};ea.prototype.MFd=function(){var O=this.WEb>this.Gxb;return O&&this.sla<=this.Gxb||!O&&this.sla>=this.Gxb};ea.prototype.zMd=function(O){O=void 0===O?!0:O;this.Fk&&(this.sla=
this.Fk.scrollLeft);window.cancelAnimationFrame(this.Oka);this.Oka=0;this.dtc=-1;O&&this.SZ()};ea.prototype.nQ=function(O){if(this.eE&&(this.uy||this.w8e(O)))if(this.L2b=this.I4e(O),this.uy){var qa;O=(qa=this.BP(this.TB+1))?qa.sheet:null;this.reorderSheets(O,this.TB+1===this.gJd,!0)}else O=this.cqd?null:this.Ned,this.reorderSheets(O,this.cqd,!0);this.jP();return!0};ea.prototype.oHd=function(O,qa){O||Tc.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
qa);this.C2=O};ea.prototype.Fqi=function(O){return 2===O?(this.f_(3),!0):1===O?(this.f_(0),!0):!1};ea.prototype.Dpf=function(O){var qa=this;Tc.ULS.shipAssertTag(537153732,0,-1===this.bNa&&-1===this.aNa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.bNa&&(window.clearTimeout(this.bNa),this.bNa=-1);-1!==this.aNa&&(window.clearInterval(this.aNa),this.aNa=-1);this.f_(O);this.bNa=window.setTimeout(function(){qa.tlj(O)},
this.dki);return!0};ea.prototype.tlj=function(O){var qa=this;this.aNa=window.setInterval(function(){qa.f_(O)},this.cki)};ea.prototype.Epf=function(){this.RVc();return!this.uy||!this.eE};ea.prototype.RVc=function(){window.clearTimeout(this.bNa);window.clearInterval(this.aNa);this.aNa=this.bNa=-1;return!0};ea.prototype.Fpf=function(O,qa){var rb=this.Kqd[qa];ue.HelperMethods.BOd(this.KJ[qa],rb,rb+Ue.a.H$b,"mouseover"===O.type||"focus"===O.type)};ea.prototype.rwi=function(O,qa){var rb=this.Tbc(qa),Sb=
5===qa;if("mouseup"===O.type){if(Sb||4===qa)rb||this.reorderSheets(null,Sb,!1),this.jP()}else!this.uy&&this.eE?(rb||this.WKd(this.DUe(Sb?this.zJ:this.hu),Sb),this.f_(Sb?2:1)):this.Ul||this.Fpf(O,qa)};ea.prototype.Tbc=function(O){return!!mf.DOMElementExtensions.u9c(this.KJ[O],"a").title};ea.prototype.Ai=function(O,qa){qa.WJ&&this.pRd(qa.WJ);this.oqc(!1);this.SZ();qa.qa&&(this.pRd(qa.qa),this.f_(6),this.fa.tka())};ea.prototype.twc=function(O){this.pRd(O);this.SZ()};ea.prototype.tjf=function(O,qa){this.twc(qa.item)};
ea.prototype.ujf=function(O,qa){this.twc(qa.item)};ea.prototype.vjf=function(O,qa){this.twc(qa.item)};ea.prototype.vMa=function(O,qa){this.twc(qa.item)};ea.prototype.pRd=function(O){(O=this.H_a(O))&&O.fcb()};ea.prototype.S4=function(){this.$Vc()};ea.prototype.PFd=function(){var O=this.$.va;if(O.qa&&(!Ne.e(this.$)||O.count))if(O=this.rha(O.qa),-1===O)Tc.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var qa=this.EIa(O);O<this.hu?
this.bpc(O):O>this.hu&&!this.tkd(qa)&&this.scrollIntoView(O)}};ea.prototype.Ywj=function(){this.hu=0;this.zJ=this.gh.length-1;for(var O=!1,qa=0;qa<this.gh.length;qa++){var rb=this.BP(qa);if(!rb)break;var Sb=this.tkd(rb.domElement);rb.tabIndex=Sb?0:-1;if(!O&&Sb)this.hu=qa,O=!0;else if(O&&!Sb){this.zJ=qa-1;break}}};ea.prototype.bpc=function(O){this.$.va.count&&(this.gh.length||this.UZc(),this.fNf(this.EIa(Math.max(0,Math.min(O,this.gh.length-1)))),this.SZ())};ea.prototype.scrollIntoView=function(O){Tc.ULS.shipAssertTag(537153697,
0,O>=this.hu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.va.count){this.gh.length||this.UZc();var qa=this.EIa(Math.max(0,Math.min(O,this.gh.length-1))),rb=this.EIa(this.hu);if(!this.tkd(qa)){qa=mf.DOMElementExtensions.getBoundingClientRect(qa);var Sb=mf.DOMElementExtensions.getBoundingClientRect(this.P$a);qa=this.isRtl?Sb.x-qa.x:qa.x+qa.width-(Sb.x+Sb.width);for(Sb=0;rb&&Sb<qa;){var Uc=mf.DOMElementExtensions.getBoundingClientRect(rb);
Sb+=Uc.width;rb=rb.nextSibling}rb?this.fNf(rb):Tc.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.hu,this.zJ,O)}this.SZ()}};ea.prototype.fNf=function(O){var qa=mf.DOMElementExtensions.getBoundingClientRect(this.Fk);O=mf.DOMElementExtensions.getBoundingClientRect(O);this.isRtl?this.scrollLeft(Math.floor(qa.x+qa.width-(O.x+O.width+.5))):this.scrollLeft(Math.ceil(qa.x-
O.x-.5))};ea.prototype.scrollLeft=function(O){(0>O&&this.NFd()||0<O&&this.MFd())&&Tc.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var qa=this.Fk.scrollLeft;if(this.isRtl){if(zf.a.gE||zf.a.uf){this.Fk.scrollLeft=this.sla=qa-O;return}if(zf.a.aA||zf.a.IG){this.Fk.scrollLeft=this.sla=qa+O;return}Tc.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Fk.scrollLeft=this.sla=qa-O};ea.prototype.tkd=
function(O){O=mf.DOMElementExtensions.getBoundingClientRect(O);var qa=mf.DOMElementExtensions.getBoundingClientRect(this.P$a);return O&&qa?O.x>=qa.x-1&&O.x+O.width<=qa.x+qa.width+1:(Tc.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};ea.prototype.bWg=function(){var O=this.prc;if(ha.BRf(this.$))this.Ul?(If.a.Fa(this.zG),this.zG=new ha(O,this.$,this,!0)):(If.a.Fa(this.zG),this.zG=null);else if(!this.zG||this.Ul)If.a.Fa(this.zG),
$c.k(this.$.kg)?this.zG=new ta(O,this.$,this):this.zG=new ha(O,this.$,this)};ea.prototype.ewe=function(O,qa){var rb=this.$.va;if(!this.$.isEditMode||!rb.count)If.a.Fa(qa),qa=null;else if(!qa)if(rb=this.Ul?this.iJd:this.prc,$c.k(this.$.kg))qa=new ta(rb,this.$,this);else switch(O){case 0:qa=new ha(rb,this.$,this);break;case 1:qa=new Tb(rb,this.$,this);break;default:Tc.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return qa};
ea.prototype.jd=function(){this.isVisible=!this.fa.isNamedObjectViewMode;this.$Vc();this.UZc();he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(Ne.d(this.$)||Ne.e(this.$))&&(rf.PageLoadTrackingInfo.instance.XZ("sheetTabBar",["sheetTabBar"]),rf.PageLoadTrackingInfo.instance.wV("sheetTabBar",["sheetTabBar"]));this.BZc();this.SZ();this.lPa(!0);this.f_(6)};ea.prototype.fk=function(){this.isVisible&&(this.SZ(),this.f_(6))};ea.prototype.Gf=function(){Object(Bc.a)(ha,this.zG)===
$c.k(this.$.kg)&&this.BZc();for(var O=Ol(this.gh),qa=O.next();!qa.done;qa=O.next())qa.value.d6i(!$c.k(this.$.kg))};ea.prototype.BZc=function(){he.EwaSettings.ka(445)?(this.zG=this.ewe(0,this.zG),this.Rub=this.ewe(1,this.Rub)):this.bWg()};ea.prototype.Asf=function(O,qa){this.HWi(qa.item,qa.isUserOperation)};ea.prototype.aBb=function(O,qa){this.ysf(qa.item)};ea.prototype.onKeyDown=function(O){switch(O.keyCode){case 9:var qa=this.domElement.querySelectorAll(mf.DOMElementExtensions.gp),rb=mf.DOMElementExtensions.ql(qa);
qa=mf.DOMElementExtensions.ny(qa);mf.DOMElementExtensions.ica(O,rb,qa);break;case 39:case 37:mf.DOMElementExtensions.kOf(O,this.domElement.querySelectorAll(mf.DOMElementExtensions.gp),39===O.keyCode?!this.isRtl:this.isRtl)}Tc.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",O.keyCode)};ea.prototype.onScroll=function(){this.Fk.scrollLeft!==this.sla&&this.tpj()};ea.prototype.X4=function(O){if(O.ctrlKey||O.f9)return!1;this.Fk.scrollLeft+=Math.floor(30*O.iAa);if(this.uy&&this.eE){var qa=
this.TQe("OnMouseWheel");qa&&this.mNd(0<O.iAa,qa.x+qa.width/2)}return!0};ea.prototype.TQe=function(O){var qa=mf.DOMElementExtensions.getBoundingClientRect(this.tL);qa||(Tc.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",O),this.jP());return qa};ea.prototype.qE=function(O,qa){if(this.Pra)this.cYe("PartialInteractivity",qa.kO?3:0);else{this.jP(!1);this.MHd(qa.kO);O=Ol(this.jle);for(var rb=O.next();!rb.done;rb=O.next())(rb=rb.value)&&
rb.gW(qa.kO);O=Ol(this.gh);for(rb=O.next();!rb.done;rb=O.next())(rb=rb.value)&&rb.gW(qa.kO)}};ea.prototype.Wzb=function(O,qa){O=0;qa.Ice&&(O=2|(qa.Xbj?1:0));this.cYe("ComponentRangePicker",O)};ea.prototype.cYe=function(O,qa){this.Pra.Nxg(O,qa);this.jP(!1);this.MHd(this.navigationButtonsDisabled);O=Ol(this.Tnj);for(qa=O.next();!qa.done;qa=O.next())(qa=qa.value)&&qa.gW(this.navigationButtonsDisabled);O=Ol(this.jle);for(qa=O.next();!qa.done;qa=O.next())(qa=qa.value)&&qa.gW(this.operationButtonsDisabled)};
ea.DWi=function(O,qa,rb,Sb){O<rb?(qa>rb&&rb--,qa>Sb&&Sb--):O>Sb?(qa<rb&&rb++,qa<Sb&&Sb++):qa<rb&&rb++;return{xnh:rb,Z9h:Sb}};Ll.Object.defineProperties(ea.prototype,{Ib:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Vd:{configurable:!0,enumerable:!0,get:function(){return Uf.a.fJd}},eE:{configurable:!0,enumerable:!0,get:function(){return this.HFc}},gJd:{configurable:!0,enumerable:!0,get:function(){return this.gh.length}},
grc:{configurable:!0,enumerable:!0,get:function(){return this.T9d}},dva:{configurable:!0,enumerable:!0,get:function(){return this.$1d}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Pra&&this.Pra.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Pra&&this.Pra.operationButtonsDisabled}},Kqd:{configurable:!0,enumerable:!0,get:function(){return this.Ul?this.$.qI?[hb.a.$3b,hb.a.QFe,hb.a.SFe,hb.a.Z3b,hb.a.usa,
hb.a.usa]:[hb.a.Z3b,hb.a.SFe,hb.a.QFe,hb.a.$3b,hb.a.usa,hb.a.usa]:this.$.qI?[hb.a.$3b,hb.a.PFe,hb.a.RFe,hb.a.Z3b,hb.a.usa,hb.a.usa]:[hb.a.Z3b,hb.a.RFe,hb.a.PFe,hb.a.$3b,hb.a.usa,hb.a.usa]}},Mqd:{configurable:!0,enumerable:!0,get:function(){return this.$.qI?[null,u.a.Hse,u.a.Fse]:[null,u.a.Fse,u.a.Hse]}},Oxf:{configurable:!0,enumerable:!0,get:function(){return this.$.qI?[null,u.a.Ise,u.a.Gse]:[null,u.a.Gse,u.a.Ise]}},Gxb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(zf.a.gE)return 0;
if(zf.a.uf)return-1*(this.Fk.scrollWidth-this.Fk.clientWidth);if(zf.a.pu)return this.Fk.scrollWidth-this.Fk.clientWidth;Tc.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},WEb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(zf.a.gE)return this.Fk.scrollWidth-this.Fk.clientWidth;if(zf.a.uf||zf.a.pu)return 0;Tc.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Fk.scrollWidth-this.Fk.clientWidth}},
jle:{configurable:!0,enumerable:!0,get:function(){return this.Pra?[this.zG,this.Rub]:[this.zG,this.Rub,this.uPa]}},Tnj:{configurable:!0,enumerable:!0,get:function(){var O;return(O=this.gh).concat.call(O,this.uPa)}},Vbj:{configurable:!0,enumerable:!0,get:function(){return this.S9d}}});Object(Oe.a)(ea,"SheetTabBarControl",te.a,[370,6,120]);var Af=xf.a;Em(ab,Af);ab.prototype.create=function(){var O=this,qa=this.$.Jb;if(!Th.a(this.$.ya,1)){var rb=document.getElementById(qa+Ue.a.Z_c);rb&&(he.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&rf.PageLoadTrackingInfo.instance.xya(Ue.a.ZQf),mg.a.Fjd()?sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.Va(this.$.ea,388,387,this.rb,"Microsoft.Office.Excel.WebUI.Client.SvgIconProvider.ISvgIconProvider"),function(Sb){O.Eb(O.$.ea.Ba(32)||new ea(O.$,rb,Sb.result))},this.$.la,3):this.Eb(this.$.ea.Ba(32)||new ea(this.$,rb)))}};ab.ja=function(O){O.ea.Ia(33,new ab(O))};Object(Oe.a)(ab,"SheetTabBarFactory",xf.a,[]);var ch=b(50),lg=b(182);Ya.prototype.BMa=function(){lg.a.instance.FCd(Object(bd.a)(this,
this.BMa,"onSessionExpiredDetected"));Tc.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.ePh()};Ya.prototype.ksf=function(){lg.a.instance.ECd(Object(bd.a)(this,this.ksf,"onSessionExpiringDetected"));this.I9d||this.WKc||(Tc.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.I9d=!0,this.Xhj())};Ya.prototype.ePh=function(){this.WKc||(Bd.AFrameworkApplication.FE(ch.a.IMf),this.WKc=!0,this.Whj())};Object(Oe.a)(Ya,"ASessionExpirationManager",null,
[]);var jh=b(246),vh=b(6),dh=b(80),xg=b(248);Em(xb,Ya);xb.prototype.bge=function(O){this.Oa.addHandler("SessionExpired",O)};xb.prototype.mVb=function(O){this.Oa.addHandler("TokenRefreshed",O)};xb.prototype.uCd=function(O){this.Oa.removeHandler("TokenRefreshed",O)};xb.prototype.O9b=function(){return lg.a.instance.WP(Bd.AFrameworkApplication.jk)};xb.prototype.dispose=function(){If.a.Fa(this.Oa);this.$=null};xb.prototype.Xhj=function(){this.$.isEditMode&&this.o9b(!1)};xb.prototype.Whj=function(){this.fjb=
!0;this.o9b(!0);this.Oa.raiseEvent("SessionExpired")};xb.prototype.o9b=function(O){var qa=this;Tc.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",O,this.$.fa.o$);var rb=this.$.zb.ap;O&&rb&&rb.isVisible&&1299163859===rb.error.MessageId&&this.$.zb.ap.Yt();var Sb=this.gd(O);cf.a(this.$).zs(new jh.a(vh.a.ly,5,function(){var Uc=ci.a(qa.$),vd=Uc.fd.activityState;vd[dh.a.a1]=qa.$.$lb(qa.$.isEditMode);vd[dh.a.XK]=
dh.a.N5a;vd[xg.a.rq]=vh.a.accessTokenExpiringWarning;Uc.fd.Ss([Sb])}))};xb.prototype.gd=function(O){return O?eg.a.Awe():this.GXg()};xb.prototype.GXg=function(){var O=eg.a.gd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");O.Description=this.accessTokenExpiringMessage;return O};Ll.Object.defineProperties(xb.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var O=(new Date(this.jk)).format(this.$.ya.ShortTimeFormat);return String.format(Sc.a.instance.Bb(77),O)}},
tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.fjb}},S$a:{configurable:!0,enumerable:!0,get:function(){return!1}},haa:{configurable:!0,enumerable:!0,get:function(){return!1}},EAd:{configurable:!0,enumerable:!0,get:function(){return!1}},i4:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Oe.a)(xb,"EwaAccessTokenExpirationManager",Ya,[386,387,6]);var Ff=b(196),Ai=b(676);Object(Oe.a)(pb,"RefreshAccessTokenContext",null,[]);var Oh=b(175),zg=b(113),Bi=b(133),mj=
b(33),T=b(112);Object(Oe.a)(ib,"Error",null,[]);Object(Oe.a)(Pa,"NamedResult",null,[]);Em(xa,Pa);Object(Oe.a)(xa,"ErrorInfo",Pa,[]);Ll.Object.defineProperties(ma.prototype,{tokens:{configurable:!0,enumerable:!0,get:function(){return this.jTb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.zR}}});Object(Oe.a)(ma,"TokenRefreshArgs",null,[404]);na.prototype.bge=function(O){this.Oa.addHandler("SessionExpired",O)};na.prototype.mVb=function(O){this.Oa.addHandler("TokenRefreshed",O)};
na.prototype.uCd=function(O){this.Oa.removeHandler("TokenRefreshed",O)};na.prototype.O9b=function(){return lg.a.instance.WP(Bd.AFrameworkApplication.jk)};na.prototype.dispose=function(){lg.a.instance.FCd(Object(bd.a)(this,this.uYe,"handleTokenExpired"));lg.a.instance.ECd(Object(bd.a)(this,this.XXe,"handleOnTokenExpiring"));var O=this.$.fa;O&&(O.qk(Object(bd.a)(this,this.Vc,"onSessionIdChanged")),O.lnc(Object(bd.a)(this,this.Hwa,"onOpenWorkbookFailed")));If.a.Fa(this.Oa);this.documentVisibilityObserver=
this.$=null};na.prototype.$Yf=function(){return this.O9b()?0:(Bd.AFrameworkApplication.jk-(new Date).getTime())/6E4};na.prototype.C3f=function(O,qa){if(0<qa&&!this.O9b()){var rb=Bd.AFrameworkApplication.ha.xd("AccessTokenExpirationPromptSeconds",Bd.AFrameworkApplication.jX),Sb=(qa-O.getTime())/6E4;Tc.ULS.shipAssertTag(537170713,0,0<=Sb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",
qa,O.getTime(),Sb);Sb<this.pii?(Tc.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",this.bRf,Sb),Bd.AFrameworkApplication.jX=this.bRf):Bd.AFrameworkApplication.jX!==rb&&(Tc.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",rb,Sb),Bd.AFrameworkApplication.jX=rb)}};
na.prototype.ZRg=function(O){return!this.context||this.context.zDb||this.context.c_c!==O?(O=new pb(Ff.a.create().toString(),O),this.context&&!this.context.Juc&&Tc.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",O.correlationID,this.context.correlationID,this.context.zDb),this.sR=O,!0):!1};na.prototype.XXe=function(){if(!this.D5b||this.D5b&&this.$.fa.lc)this.vYe(!1);
else if(this.$nd){this.$nd=!1;var O=ci.a(this.$);Tc.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",O.gi?O.gi.activityName:"None",this.$Yf())}};na.prototype.Vc=function(O,qa){this.context&&(O=this.$.fa,qa.AG&&this.context.zDb&&!this.context.Juc?(this.context.Juc=!0,qa={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},qa.IsUserActive=
O.wf.Fq,qa.RefreshAccessTokenCorrelationID=this.context.correlationID,qa=Td.a.Hc(qa),Tc.ULS.sendTraceTag(537170708,0,50,qa)):this.D5b&&this.bib&&!O.lc&&!this.context.c_c&&(qa={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.xw&&(this.xw.C(),qa.Aborted=!0,he.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(qa.ResetStopRefreshRetriesUntilTokenExpired=!0,this.Hab=!1)),qa.TimeUntilTokenExpirationInMin=
this.$Yf(),qa.RefreshAccessTokenCorrelationID=this.context.correlationID,qa=Td.a.Hc(qa),Tc.ULS.sendTraceTag(572019856,0,50,qa)))};na.prototype.Hwa=function(){if(this.context&&this.context.zDb&&!this.context.Juc){var O={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};O.CreatedForExpired=this.context.c_c;O.RefreshAccessTokenCorrelationID=this.context.correlationID;O.OpenWorkbookErrors=eg.a.Uc(this.$.fa.tE);O.ExecutionContextErrors=eg.a.Uc(ci.a(this.$).fd.errors);O.accesstokenTTL=
Bd.AFrameworkApplication.jk;O=Td.a.Hc(O);Tc.ULS.sendTraceTag(537170707,0,15,O)}};na.prototype.uYe=function(){this.Hab=!1;this.vYe(!0)};na.prototype.XYi=function(O){O&&this.$F&&!this.haa&&this.$.fa.wf.Fq&&!this.i4&&(this.$F=!1)};na.prototype.vYe=function(O){var qa=this;this.XYi(O);if(!(this.bib||this.Hab&&!O||this.$F)&&this.S$a){this.bib=!0;var rb=this.context?this.context.creationTime:null,Sb=this.ZRg(O);this.$nd=!0;var Uc=this.$.fa,vd={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",
newContextCreated:Sb};vd.IsUserActive=Uc.wf.Fq;vd.IsSessionActive=Uc.lc;vd.ContainsChangesWorkbookOperations=this.$.userOperationManager.qFa();vd.isSessionExpired=O;vd.stopRefreshRetriesUntilTokenExpired=this.Hab;vd.FailedToRefreshExpiredToken=this.$F;vd.numOfFailuresWhileUserIsActive=T.a.L4;vd.numOfFailuresWhileUserIsInActive=T.a.N4;vd.numOfFailuresWhileOffline=T.a.lwa;vd.RefreshAccessTokenCorrelationID=this.context.correlationID;Sb&&rb&&(vd.TimeInMinFromPreviosContextCreation=Math.round(zg.b(Zh.a.Qa,
rb)/60));rb=Td.a.Hc(vd);Tc.ULS.sendTraceTag(40416199,0,50,rb);this.CAd.start();this.m2d=Uc.wf.Fq;this.xw=new Ai.a;this.uai(O);var oe=this.FOd.FPi(!O,this.xw?this.xw.token:null);oe.continueWith(function(){qa.dLg();var ef=qa.FOd.VJi(oe);qa.CAd.stop();var Nf=qa.O9b();if(!ef||he.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Nf){var kh=oe.result.errors;ef&&Nf&&qa.Bog(kh);qa.QOh(kh,O)}else qa.Hab=!1,qa.ROh(oe.result.tokens,O);qa.bib=!1},this.D5b?8:0)}};na.prototype.Bog=
function(O){var qa=[Object.assign(new ib,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];O.add(Object.assign(new xa,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:qa}))};na.prototype.uai=function(O){O&&(this.$.fa.wf.Fq?this.FVf():(this.$.fa.wf.Vpa(Object(bd.a)(this,this.avd,"onUserActivityThrottledDetected")),this.FDb=!0))};na.prototype.FVf=function(){var O=this;this.lmc=Oh.AsyncMethodContext.Hw(function(){O.EPi()},1E3*this.xCf,md.a.nPi,this.lmc)};na.prototype.avd=
function(){this.FDb&&(this.$.fa.wf.Rxa(Object(bd.a)(this,this.avd,"onUserActivityThrottledDetected")),this.FDb=!1);this.FVf()};na.prototype.dLg=function(){this.lmc&&this.lmc.cancel();this.FDb&&(this.$.fa.wf.Rxa(Object(bd.a)(this,this.avd,"onUserActivityThrottledDetected")),this.FDb=!1);this.xw=null};na.prototype.EPi=function(){Tc.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",this.xCf);this.xw.C()};na.prototype.QOh=
function(O,qa){this.Hab=!0;qa&&(this.$F||(this.fjb=this.$F=!0),this.FOd.Gcc(O)&&(this.M2d=!0));var rb=!qa||this.S$a&&!T.a.Jrc?40380379:39982555;qa=this.kve(qa);qa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";qa.FailedToRefreshExpiredToken=this.$F;qa.LastErrorIsPermanent=this.i4;if(0<O.count){var Sb=O.oa(0);qa.errorName=Sb.Name;0<Sb.Errors.length&&(qa.ErrorId=Sb.Errors[0].Id,Sb=Sb.Errors[0].Details,qa.ErrorDetails=this.a5g(Sb.toString())?"PiiScrubbed":Sb)}qa=Td.a.Hc(qa);Tc.ULS.sendTraceTag(rb,
0,15,qa);this.Oa.raiseEvent("TokenRefreshed",new ma(null,O))};na.prototype.a5g=function(O){return Yd.a.contains(O,"makes the internet safe for businesses",!0)};na.prototype.kve=function(O){var qa={},rb=this.$.fa;qa.Name="";qa.IsUserActive=rb.wf.Fq;qa.IsSessionActive=rb.lc;qa.GotDeploymentOrTimedOutError=rb.o$;qa.TimeInSecFromLastStatefulSuccessfulRequest=rb.p6;qa.TimeFromLastUserActivityInMs=rb.wf.hbb;qa.calledFromSessionExpiredFlow=O;qa.RefreshTokenDurationInMS=this.CAd.Cc;qa.numOfFailuresWhileUserIsActive=
T.a.L4;qa.numOfFailuresWhileUserIsInActive=T.a.N4;qa.numOfFailuresWhileOffline=T.a.lwa;qa.RefreshAccessTokenCorrelationID=this.context.correlationID;qa.accessTokenTTL=Bd.AFrameworkApplication.jk;qa.ContainsChangesWorkbookOperations=this.$.userOperationManager.qFa();qa.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.aj.toString():"Unknown";qa.TimeFromFirstOpenInHr=Math.floor(zg.b(Zh.a.Qa,Eh.toUtc(rb.bvf))/3600);return qa};na.prototype.ROh=function(O,qa){this.$F=!1;
this.xzj();this.C3f(new Date,Bd.AFrameworkApplication.jk);var rb=this.$.fa,Sb=!qa&&rb.wf.Fq,Uc=!this.$.isEditMode&&rb.v8a;qa=this.kve(qa);qa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";qa.shouldTriggerSilentReloadAfterExpiring=Sb;qa.WopiTokenTaskItemPriority=Bd.AFrameworkApplication.VSd;qa.isDirtyViewSession=Uc;qa=Td.a.Hc(qa);Tc.ULS.sendTraceTag(39982556,0,15,qa);this.Oa.raiseEvent("TokenRefreshed",new ma(O,null));Uc?rb.wf.Fq&&(Tc.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
rb.R6c()):rb.wf.Fq?Sb&&(O=ci.a(this.$).fd.activityState,O[T.a.xbb]=!0,O[Bi.a.mX]=!0,O[mj.a.Wq]=this.$.isEditMode,cf.a(this.$).zs(new jh.a(vh.a.Bla,2,null))):rb.lc&&Ih.m(this.$.ra.ua,!0,!1,!1,null,null,null,null,null)};na.prototype.xzj=function(){void 0!==this.$.fa.workbookContext.WorkbookUri&&null!==this.$.fa.workbookContext.WorkbookUri?(this.$.fa.workbookContext.WorkbookUri=mc.a.lS(this.$.fa.workbookContext.WorkbookUri,Bd.AFrameworkApplication.jO,Bd.AFrameworkApplication.accessToken),this.$.fa.workbookContext.WorkbookUri=
mc.a.lS(this.$.fa.workbookContext.WorkbookUri,Bd.AFrameworkApplication.kX,Bd.AFrameworkApplication.jk.toString()),this.$.fa.Ejc()):Tc.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=Bd.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=Bd.AFrameworkApplication.jk;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=
mc.a.lS(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,Bd.AFrameworkApplication.jO,Bd.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=mc.a.lS(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,Bd.AFrameworkApplication.kX,Bd.AFrameworkApplication.jk.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=mc.a.lS(this.$.ya.EmbedConfiguratorUrl,Bd.AFrameworkApplication.jO,Bd.AFrameworkApplication.accessToken),
this.$.ya.EmbedConfiguratorUrl=mc.a.lS(this.$.ya.EmbedConfiguratorUrl,Bd.AFrameworkApplication.kX,Bd.AFrameworkApplication.jk.toString()));this.context.zDb=!0};Ll.Object.defineProperties(na.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.fjb}},haa:{configurable:!0,enumerable:!0,get:function(){return this.m2d}},i4:{configurable:!0,enumerable:!0,get:function(){return this.M2d}},context:{configurable:!0,enumerable:!0,get:function(){return this.sR}},S$a:{configurable:!0,
enumerable:!0,get:function(){return this.i4?!1:this.$.fa.wf.Fq?1>T.a.L4:6>T.a.N4}},EAd:{configurable:!0,enumerable:!0,get:function(){return this.bib}}});Object(Oe.a)(na,"EwaAccessTokenExpirationRefreshManager",null,[386,387,6]);La.oUb="ActivityDuration";La.error="Error";La.Q9g="Errors";La.failed="Failed";La.knh="FirstActivity";La.initialized="Initialized";La.L9h="LastActivity";La.y_i="RetryOverride";La.wYi="RequestGroups";La.requests="Requests";La.BIf="Responses";La.Tpc="SessionDuration";La.status=
"Status";La.success="Success";La.tokens="Tokens";Object(Oe.a)(La,"SessionExpirationStrings",null,[]);ra.prototype.k6f=function(){var O={};Tc.ULS.sendTraceTag(41964821,217,50,Tc.ULS.Hc((O.Aggregate=this.yW,O.Current=this.jo,O)))};ra.prototype.oWh=function(){this.yW[La.wYi]=0;this.yW[La.requests]=0;this.yW[La.BIf]=0;this.yW[La.status]=La.initialized;this.yW[La.knh]=new Date;this.yW[La.Tpc]=0;this.yW[La.oUb]=0;this.yW[La.Tpc]=0;this.jo[La.Tpc]=0;this.yW[La.oUb]=0;this.jo[La.oUb]=0};ra.prototype.Jed=
function(O,qa){var rb=O[qa];rb=rb?rb:0;rb++;O[qa]=rb;this.EHd(O)};ra.prototype.EHd=function(O){var qa=new Date;O[La.oUb]=+qa-+this.NPb;this.NPb=qa;O[La.Tpc]=+this.NPb-+this.mjg;O[La.L9h]=this.NPb};ra.prototype.z$a=function(O,qa){this.jo[O]=qa;this.EHd(this.jo)};ra.prototype.ENf=function(O,qa){this.jo[O]=qa;this.EHd(this.jo)};ra.prototype.incrementCounter=function(O){this.Jed(this.jo,O);this.Jed(this.yW,O);this.Jed(this.Bhg,O)};ra.prototype.flush=function(){this.h2d||(this.yW[La.status]=this.jo[La.status],
this.k6f(this.aTb),this.fe.fla(this.aTb,6E4*this.vcf))};ra.prototype.stop=function(){Tc.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.h2d=!0;this.fe.cp(this.aTb)};Object(Oe.a)(ra,"SessionLogger",null,[405]);var Oa=b(1058);ca.prototype.vui=function(O){if(O.MessageId!==Nb.a.Sdd)yc.a(39408099,306,15,"Unexpected message.");else{var qa=new Cf.a,rb=new Cf.a;this.Gj.incrementCounter(La.BIf);var Sb=O.Values[za.a.LMf];if(!Sb||0>=Sb.length)yc.a(40122317,306,
15,"Found no tokens in the dictionary"),Sb=O.Values;yc.a(40122318,306,100,"The Tokens array contains {0} tokens",Sb.length);this.Gj.z$a("Correlation",O.CorrelationId);for(var Uc=null,vd=0;vd<Sb.length;vd++){this.Gj.ENf(La.tokens,Sb.length);var oe=Sb[vd],ef=oe;if(ef&&ef.Name){this.Gj.incrementCounter(ef.Name);var Nf=oe;Nf&&Nf.Value?(yc.a(39408128,306,100,"Received token with name: {0}",Nf.Name),qa.add(Nf),this.jTb.add(Nf),this.Gj.z$a(La.status,La.success)):(yc.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
ef.Name,JSON.stringify(oe),this.Pea),rb.add(oe),this.zR.add(oe),Uc=oe,this.Gj.z$a(La.error,JSON.stringify(oe)),this.Gj.z$a(La.status,La.failed))}}0<rb.count&&Uc?(Sb=Object.assign(new wg.a,{extendedProperties:new Map}),Sb.extendedProperties.set("Errors",this.OJh(Uc)),Vf.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Sb)):Vf.Health.instance.recordKpiSuccess("WACTokenRefresh",null);yc.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
qa.count,rb.count,O.CorrelationId,this.Pea);0<rb.count&&!this.Gcc(rb)?(O=this.R7.VGh(rb),O!==this.R7.CEd&&(this.Gj.ENf(La.y_i,O),this.fe.fla(this.Fi,O))):(this.Gj.flush(),this.Fi&&(yc.a(39408131,306,100,"Deleting task {0} from task manager",this.Fi.name),this.fe.cp(this.Fi)),this.Hl&&!this.Hl.task.isCompleted&&this.Hl.setResult(new ma(qa,rb)))}};ca.prototype.requestTokensOnce=function(){this.LHf()};ca.prototype.LHf=function(){Bd.AFrameworkApplication.ifc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");
this.hpa>=this.R7.dhi?(yc.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Pea),this.qve(this.Hl,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Vf.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.i4i())};ca.prototype.i4i=function(){var O={};O[za.a.LMf]=this.R7.tokens;var qa=Ff.a.create().toString();yc.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",
JSON.stringify(this.R7.tokens),this.hpa+1,qa,this.Pea);this.$6d.execute(function(rb){rb.Vj(Nb.a.fie,O,qa)});this.hpa++;this.Gj.incrementCounter(La.requests)};ca.prototype.qve=function(O,qa,rb){for(var Sb=new Cf.a,Uc=0;Uc<this.R7.tokens.length;Uc++){var vd=Object.assign(new xa,{Name:this.R7.tokens[Uc],Errors:[Object.assign(new ib,{Id:qa,Details:rb})]});Sb.add(vd);this.zR.add(vd)}this.fe.cp(this.Fi);this.Gj.z$a(La.Q9g,JSON.stringify(this.zR));this.Gj.z$a(La.status,La.failed);O&&!O.task.isCompleted&&
O.setResult(new ma(new Cf.a,this.zR))};ca.prototype.FPi=function(O,qa){var rb=this;qa=void 0===qa?null:qa;this.Gae.start();this.EPb=O;this.Pea=Ff.a.create().toString();yc.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Pea,this.EPb);this.hpa=0;this.zR.clear();this.jTb.clear();var Sb=new bf.a;this.Hl=Sb;qa&&qa.R(function(){var Uc=!!Sb&&!Sb.task.isCompleted;yc.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",
rb.Pea,rb.EPb,Uc);Uc&&rb.qve(Sb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Fi=new kc.a(this.R7.priority,2,this.R7.CEd,Object(bd.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Nb.a.fie,!0);this.gjg&&this.LHf();this.fe.kh(this.Fi);return this.Hl.task};ca.prototype.VJi=function(O){this.Gae.stop();var qa=this.bQh(O.result.errors);Tc.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!qa,this.Pea,this.EPb,this.hpa,this.zR.count,0<O.result.errors.count?O.result.errors.oa(0).Name:"",0<O.result.errors.count&&0<O.result.errors.oa(0).Errors.length?O.result.errors.oa(0).Errors[0].Id:"",0<O.result.errors.count&&0<O.result.errors.oa(0).Errors.length?O.result.errors.oa(0).Errors[0].Details:"");return qa?!1:this.UJi(O.result.tokens)};ca.prototype.Gcc=function(O){return this.R7.Gcc(O)};ca.prototype.UJi=function(O){for(var qa=0;qa<O.count;qa++){var rb=O.oa(qa);if(rb.Name===za.a.accessToken){var Sb=
(new Date).getTime();if(rb.Expiry>Bd.AFrameworkApplication.jk){var Uc={};Tc.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(Uc.AccessTokenTtl=rb.Expiry,Uc.NowGetTime=Sb,Uc.BootTime=Bd.AFrameworkApplication.Pfa,Uc),"PreviousAccessTokenTtl",Bd.AFrameworkApplication.jk);Bd.AFrameworkApplication.accessToken=rb.Value;Bd.AFrameworkApplication.jk=Math.floor(rb.Expiry);Bd.AFrameworkApplication.TSd=Sb;Bd.AFrameworkApplication.qVa=Math.floor(rb.Expiry)}else Uc={},Tc.ULS.sendTraceTag(39706828,
217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(Uc.AccessTokenTtl=rb.Expiry,Uc.NowGetTime=Sb,Uc.BootTime=Bd.AFrameworkApplication.Pfa,Uc),"PreviousAccessTokenTtl",Bd.AFrameworkApplication.jk)}}return!0};ca.prototype.bQh=function(O){for(var qa=!1,rb=0;rb<O.count;rb++){qa=!0;var Sb=O.oa(rb);Tc.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Sb.Name,JSON.stringify(Sb.Errors),this.Pea)}return qa};ca.prototype.OJh=function(O){var qa=
new Cf.a;O=Ol(O.Errors);for(var rb=O.next();!rb.done;rb=O.next()){rb=rb.value;var Sb={};Sb.Id=rb.Id;Sb.Details=rb.Details;qa.add(Sb)}return JSON.stringify(qa)};Object(Oe.a)(ca,"TokenRefreshManager",null,[384]);Z.prototype.Gcc=function(O){O=JSON.stringify(O);if(this.vNc&&0<this.vNc.length)for(var qa=Ol(this.vNc),rb=qa.next();!rb.done;rb=qa.next())if(rb=rb.value,0<rb.length&&0<=O.indexOf(rb))return!0;return!1};Z.prototype.VGh=function(O){try{if(O)for(var qa=Ol(O),rb=qa.next();!rb.done;rb=qa.next()){var Sb=
rb.value;if(Sb.Errors)for(var Uc=Ol(Sb.Errors),vd=Uc.next();!vd.done;vd=Uc.next()){var oe=vd.value;if(oe.Id in this.p8d)return Number.parseInvariant(this.p8d[oe.Id].toString());if(this.JFc)try{if(500<=Number.parseInvariant(oe.Id))return Bd.AFrameworkApplication.ifc("RetryIntervalOverrideOnServerError;RetryIntervalOverrideOnServerErrorcf"),this.s8d}catch(ef){Tc.ULS.sendTraceTag(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",ef.toString(),oe.Id)}}}}catch(ef){Tc.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",ef.toString())}return this.CEd};Z.prototype.O9i=function(){var O={};try{if(!Bd.AFrameworkApplication.d9b()||0>=Bd.AFrameworkApplication.d9b().length||""===Bd.AFrameworkApplication.d9b()[0])return O;for(var qa=Ol(Bd.AFrameworkApplication.d9b()),rb=qa.next();!rb.done;rb=qa.next()){var Sb=rb.value;0<Sb.length&&(O[Sb]=Bd.AFrameworkApplication.WCj)}}catch(Uc){Tc.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
Uc.toString())}return O};Object(Oe.a)(Z,"TokenRefreshPolicy",null,[380]);var Eb=xf.a;Em(U,Eb);U.prototype.create=function(){Bd.AFrameworkApplication.lM("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");Bd.AFrameworkApplication.ha.sa("RefreshAccessTokenSilently")?this.Eb(this.TTg()):this.Eb(this.$.ea.Ba(38)||this.$.ea.Ia(38,new xb(this.$)))};U.prototype.TTg=function(){var O=this.$.ea.Ba(38);if(O)return O;O=new ca(Bd.AFrameworkApplication.sj,Bd.AFrameworkApplication.yY(),
new Z);return this.$.ea.Ia(38,new na(this.$,O))};U.ja=function(O){O.ea.Ia(39,new U(O))};Object(Oe.a)(U,"AccessTokenExpirationManagerFactory",xf.a,[]);var vc=pa.a;Em(da,vc);da.prototype.Iug=function(O){this.addHandler("TAF",O)};da.prototype.bWi=function(O){this.removeHandler("TAF",O)};da.prototype.ELi=function(){this.raiseEvent("TAF")};Object(Oe.a)(da,"GridHighlightBehaviorEventManager",pa.a,[381,6]);var gd=xf.a;Em(V,gd);V.prototype.create=function(){this.Eb(this.$.ea.Ba(376)||new da(this.$))};V.ja=
function(O){O.ea.Ia(377,new V(O))};Object(Oe.a)(V,"GridHighlightBehaviorEventManagerFactory",xf.a,[]);var Cd=b(119),Fd=Sys.EventArgs;Em(Y,Fd);Object(Oe.a)(Y,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var $d=pa.a;Em(N,$d);N.prototype.ftg=function(O){this.addHandler("mrek",O)};N.prototype.rV=function(O,qa,rb){for(var Sb=Ol(this.gridView.ao),Uc=Sb.next();!Uc.done;Uc=Sb.next())Ud.a.instance.pa(ed.a.Ch,Uc.value.domElement,O);Ud.a.instance.pa(ed.a.Ud,document.documentElement,qa);this.gridView.uc.q3b(!0);
rb&&Ud.a.instance.pa(ed.a.Hy,this.gridView.Gi,qa)};N.prototype.cQd=function(O,qa,rb){for(var Sb=Ol(this.gridView.ao),Uc=Sb.next();!Uc.done;Uc=Sb.next())Ud.a.instance.za(ed.a.Ch,Uc.value.domElement,O);Ud.a.instance.za(ed.a.Ud,document.documentElement,qa);this.gridView.uc.q3b(!1);rb&&Ud.a.instance.za(ed.a.Hy,this.gridView.Gi,qa)};N.prototype.tQi=function(O,qa){for(var rb=Ol(this.gridView.ao),Sb=rb.next();!Sb.done;Sb=rb.next())xd.a.instance.pa(ed.a.Gg,Sb.value.domElement,O);xd.a.instance.pa(ed.a.ye,
document.documentElement,qa)};N.prototype.Zuj=function(O,qa){for(var rb=Ol(this.gridView.ao),Sb=rb.next();!Sb.done;Sb=rb.next())xd.a.instance.za(ed.a.Gg,Sb.value.domElement,O);xd.a.instance.za(ed.a.ye,document.documentElement,qa)};N.prototype.mve=function(O,qa,rb,Sb){var Uc=document.createElement("div");Uc.className=qa;qa=Ol(rb);for(rb=qa.next();!rb.done;rb=qa.next())Uc.classList.add(rb.value);O.appendChild(Uc);Ud.a.instance.pa(ed.a.pointerDown,Uc,Sb);return Uc};N.prototype.mUe=function(O){O=O.Sb.parentNode;
if(!O)return Tc.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;O=parseInt(O.getAttribute(Ue.a.zub));return isNaN(O)?(Tc.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Kb.hJ(3,1,O)};N.prototype.DGb=function(O,qa,rb){O=(void 0===rb?!0:rb)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.y3h(O);
qa=Ol(qa);for(rb=qa.next();!rb.done;rb=qa.next())mf.DOMElementExtensions.setVisible(rb.value,O)};N.prototype.Q7c=function(){return this.gridView.nj?Cd.a(this.gridView.$):this.gridView.Gc};N.prototype.OBf=function(){var O=this.Q7c();O&&this.coloredReferencesManager?this.coloredReferencesManager.iW(O,null):(Tc.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Kb.mk(this.Ref),this.gridView.Kb.Ek(null,
this.Ref))};N.prototype.oAf=function(O,qa){this.raiseEvent("mrek",new Y(O,qa))};Ll.Object.defineProperties(N.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var O=this.gridView.$.ea.Ba(281);O||Tc.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return O}}});Object(Oe.a)(N,
"BehaviorHelperMethods",pa.a,[]);var Ae=Lg.a;Em(G,Ae);G.prototype.iWa=function(){};Object(Oe.a)(G,"HighlightFlyweightBehavior",Lg.a,[]);var $e=b(456),qg=b(118),Tg=b(10),jg=b(76),vf=te.a;Em(W,vf);W.prototype.Afe=function(O){this.addHandler("GrDrag",O)};W.prototype.nFf=function(O){this.removeHandler("GrDrag",O)};W.prototype.zfe=function(O){this.addHandler("GrContxt",O)};W.prototype.mFf=function(O){this.removeHandler("GrContxt",O)};W.prototype.Bfe=function(O){this.addHandler("GrPointerUp",O)};W.prototype.oFf=
function(O){this.removeHandler("GrPointerUp",O)};W.prototype.dispose=function(){af.a.Vka(this.domElement);vf.prototype.dispose.call(this)};W.prototype.X2f=function(O){this.domElement.parentNode.removeChild(this.domElement);O.appendChild(this.domElement)};W.prototype.bNf=function(){this.domElement.classList.remove(jg.a.o4b);this.RIa.classList.remove(jg.a.n4b);this.RIa.classList.add(jg.a.cIe)};W.prototype.m1f=function(){this.RIa.classList.remove(jg.a.cIe);this.RIa.classList.add(jg.a.n4b);this.domElement.classList.add(jg.a.o4b)};
W.prototype.onPointerDown=function(O){O=Hg.a(this.$)?Hg.a(this.$).He(O):O;this.UKb=!1;if(3===(Zd.a.Tb=O.yb)){var qa=O.Ea.rawEvent,rb=qa.srcElement||qa.target;mf.DOMElementExtensions.Ue(this.domElement,rb)&&mf.DOMElementExtensions.Ue(qa.currentTarget,rb)&&(this.UKb=!0,this.Z0b=O.clientPoint)}return!1};W.prototype.Ah=function(O){O=Hg.a(this.$)?Hg.a(this.$).He(O):O;this.raiseEvent("GrPointerUp",O);return this.UKb=!1};W.prototype.pk=function(O){O=Hg.a(this.$)?Hg.a(this.$).He(O):O;3===O.yb&&this.UKb&&
this.pQh(O.clientPoint)&&(this.raiseEvent("GrDrag"),this.UKb=!1);return!1};W.prototype.Rc=function(O){Hg.a(this.$)&&Hg.a(this.$).He(O);return!0};W.prototype.pQh=function(O){return!!this.Z0b&&(3<Math.abs(O.x-this.Z0b.x)||3<Math.abs(O.y-this.Z0b.y))};W.Krb=function(O){var qa=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),rb=zf.a.jf;return qa&&!rb?(O=Hg.a(O.$)?Hg.a(O.$).zoom:Tg.a.Haa,Math.round(9/Math.max(O,1))):9};W.Zod=0;Object(Oe.a)(W,"TouchGrippie",te.a,[]);Em(fa,G);fa.prototype.dispose=
function(){If.a.mc([this.xN,this.cL]);this.xN.nFf(Object(bd.a)(this,this.Htf,"onTopGrippieDrag"));this.xN.mFf(Object(bd.a)(this,this.lic,"onGrippieContextMenu"));this.xN.oFf(Object(bd.a)(this,this.mic,"onGrippiePointerUp"));this.cL.nFf(Object(bd.a)(this,this.kkf,"onBottomGrippieDrag"));this.cL.mFf(Object(bd.a)(this,this.lic,"onGrippieContextMenu"));this.cL.oFf(Object(bd.a)(this,this.mic,"onGrippiePointerUp"));for(var O=Ol(this.gridView.ao),qa=O.next();!qa.done;qa=O.next())qa=qa.value,xd.a.instance.za(ed.a.yf,
qa.domElement,Object(bd.a)(this,this.Vnf,"onGridViewTouchStart")),xd.a.instance.za(ed.a.ye,qa.domElement,Object(bd.a)(this,this.Unf,"onGridViewTouchEnd"));this.gridView.view.Gr(Object(bd.a)(this,this.Mv,"onVisibleAreaChanged"));this.gridView.Gc.ym(Object(bd.a)(this,this.NBe,"editStarted"));this.gridView.Kb.oEb(Object(bd.a)(this,this.Lwa,"onSelectionHighlightChanged"));this.gridView.ZDb(Object(bd.a)(this,this.akf,"onBeforeActiveItemCleanUp"));this.gridView.$.oH(Object(bd.a)(this,this.Nlc,"reDrawGrippies"));
this.gridView.Cs(Object(bd.a)(this,this.Nlc,"reDrawGrippies"));this.ga.WZ(Object(bd.a)(this,this.Bh,"onSelectionEnded"));this.ga.Oba(Object(bd.a)(this,this.hq,"onSelectionStarted"));this.gridView.AE(Object(bd.a)(this,this.Ho,"onCurrentSelectionModeChanged"));this.ga.Xmc(Object(bd.a)(this,this.Mnf,"onGridContextMenu"));Zd.a.wFf(Object(bd.a)(this,this.wAb,"onLastInputMethodChanged"));this.S$&&Tc.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(O=this.gridView.$.ea.Ba(376))&&
O.bWi(Object(bd.a)(this,this.Itf,"onTouchAutoFillModeSet"));G.prototype.dispose.call(this)};fa.prototype.FPa=function(){if(!this.z$.range||!this.z$.range.equals(this.$9a))return!1;var O=!this.gridView.vKa();return this.gridView.isEditing&&O&&(this.$9a.isRow||this.$9a.Fh)?!1:this.S$?!0:3===Zd.a.Tb};fa.prototype.x3=function(){this.elb&&(this.xN.set_visible(!1),this.cL.set_visible(!1),this.elb=!1)};fa.prototype.$la=function(){if(this.FPa()){this.qyj();var O=mf.DOMElementExtensions.getBoundingClientRect(this.vXa);
O||Tc.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.gridView.$.fa.isNamedObjectViewMode,this.Kid,this.xWb,this.gridView.Gi,this.gridView.Wa.Mi);var qa=mf.DOMElementExtensions.getBoundingClientRect(this.O3i),rb=new Sys.UI.Bounds(qa.x-O.x,qa.y-O.y,qa.width,qa.height),Sb=this.$9a,Uc=Sb.topLeft,vd=Sb.bottomRight,oe=Sb.isRow||Sb.Fh;if(Sb.Fh){var ef=this.zmh();
Sb=rb.x-2*W.Krb(this.gridView);var Nf=ef;var kh=rb.x+qa.width}else Sb.isRow?(Sb=kh=this.ymh(),Nf=rb.y-2*W.Krb(this.gridView),ef=rb.y+qa.height):(Nf=rb.y,ef=rb.y+qa.height,this.gridView.rtl?(Sb=rb.x+qa.width,kh=rb.x):(Sb=rb.x,kh=rb.x+qa.width));qa=W.Zod+(oe?0:W.Krb(this.gridView));this.xN.style.left=ue.HelperMethods.Pb(Sb-qa);this.xN.style.top=ue.HelperMethods.Pb(Nf-qa);this.cL.style.left=ue.HelperMethods.Pb(kh-qa);this.cL.style.top=ue.HelperMethods.Pb(ef-qa);this.xN.set_visible(this.q5e(Nf,Sb,Uc,
oe,O));this.cL.set_visible(this.q5e(ef,kh,vd,oe,O));this.elb=!0}};fa.prototype.q5e=function(O,qa,rb,Sb,Uc){var vd=mf.DOMElementExtensions.getBoundingClientRect(this.gridView.Mf(this.paneType).domElement);Uc=new Sys.UI.Bounds(vd.x-Uc.x-3,vd.y-Uc.y-3,vd.width+6,vd.height+6);return(this.gridView.Wa.Bj(rb)===this.paneType||Sb)&&Le.a.dA(Uc,new Sys.UI.Point(qa,O))};fa.prototype.qyj=function(){if(this.Kid!==this.xWb){this.vXa=null;var O=this.U5c();this.xN.X2f(O);this.cL.X2f(O)}};fa.prototype.zmh=function(){return(this.gridView.view.visibleArea.height+
this.gridView.Wa.height+W.Zod-W.Krb(this.gridView))/2};fa.prototype.ymh=function(){return(this.gridView.view.visibleArea.width+this.gridView.Wa.width+W.Zod-W.Krb(this.gridView))/2};fa.prototype.Mv=function(){this.elb&&this.Dkd?this.$la():this.x3()};fa.prototype.Unf=function(O){3===O.yb&&(this.Dkd=!0,this.$la());return!1};fa.prototype.Vnf=function(O){if(3===O.yb){if(!O.Sb||this.y1h(O))return!1;this.Dkd=!1;this.x3()}return!1};fa.prototype.Prf=function(){this.$la()};fa.prototype.y1h=function(O){return mf.DOMElementExtensions.jFb(O.Sb,
hb.a.lr)&&(this.u2h(O)||this.v2h(O))};fa.prototype.v2h=function(O){if(this.gridView.rtl)O=O.clientPoint.x;else{var qa=mf.DOMElementExtensions.getBoundingClientRect(O.Sb);O=O.clientPoint.x-(qa.x+qa.width-qg.a.yp)}return 0<O&&O<=qg.a.yp};fa.prototype.u2h=function(O){var qa=mf.DOMElementExtensions.getBoundingClientRect(O.Sb);O=O.clientPoint.y-(qa.y+qa.height-qg.a.yp);return 0<O&&O<=qg.a.yp};fa.prototype.Bh=function(){this.S$&&this.hQd();this.$la();this.Fkd=!1};fa.prototype.hq=function(){this.x3();this.Fkd=
!0};fa.prototype.Lwa=function(O,qa){qa.B3===this.B3&&(qa.visible?this.Fkd||this.$la():this.x3())};fa.prototype.Htf=function(){this.Wnf(this.xN.domElement,!1)};fa.prototype.kkf=function(){this.Wnf(this.cL.domElement,!0)};fa.prototype.lic=function(O,qa){this.ga.xxa(qa)};fa.prototype.Wnf=function(O,qa){this.S$&&Tc.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ga.yUc(O,qa,this.S$);this.x3()};fa.prototype.mic=function(O,qa){this.ga.xxa($e.b(qa))};
fa.prototype.wAb=function(){3===Zd.a.Tb?this.$la():this.x3();this.S$&&1===Zd.a.Tb&&this.hQd()};fa.prototype.Itf=function(){this.n6i()};fa.prototype.n6i=function(){this.S$||(Tc.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.S$=!0,this.xN.bNf(),this.cL.bNf(),this.gridView.ga.sourceRange=this.gridView.ga.wa.Nd,this.$la())};fa.prototype.hQd=function(){this.S$&&(Tc.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.S$=
!1,this.xN.m1f(),this.cL.m1f())};fa.prototype.U5c=function(){if(!this.vXa){this.xWb=!1;if(this.Kid){var O=this.gridView.$.ea.Ba(22);if(O)return this.xWb=!0,this.vXa=O.Tw}this.vXa=this.gridView.Gi}return this.vXa};fa.prototype.NBe=function(){this.x3()};fa.prototype.Ho=function(){this.ga.Pa.kc&&this.x3()};fa.prototype.akf=function(){this.x3()};fa.prototype.Mnf=function(O,qa){this.hQd();3===qa.yb?this.$la():this.x3()};fa.prototype.Nlc=function(){this.elb&&(this.x3(),this.$la())};Ll.Object.defineProperties(fa.prototype,
{gridView:{configurable:!0,enumerable:!0,get:function(){return this.Ix}}});Object(Oe.a)(fa,"SelectionTouchGrippiesBehaviorBase",G,[]);Em(aa,fa);aa.prototype.FPa=function(){var O=this.gridView.li||this.gridView.isEditing;return!this.gridView.ga.wa.xh&&!O&&fa.prototype.FPa.call(this)};Ll.Object.defineProperties(aa.prototype,{B3:{configurable:!0,enumerable:!0,get:function(){return 19}},$9a:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.wa.activeRange}}});Object(Oe.a)(aa,"DiscontinuousSelectionTouchGrippiesBehavior",
fa,[]);var Xg=b(306);Em(L,G);Object(Oe.a)(L,"SelectionBorderBehavior",G,[]);Q.vhh="ewr-selection-draghandle";Q.Dhh="ewr-selection-draghandle-top-ie";Q.Chh="ewr-selection-draghandle-top";Q.xhh="ewr-selection-draghandle-bottom-ie";Q.whh="ewr-selection-draghandle-bottom";Q.zhh="ewr-selection-draghandle-left-ie";Q.yhh="ewr-selection-draghandle-left";Q.Bhh="ewr-selection-draghandle-right-ie";Q.Ahh="ewr-selection-draghandle-right";Q.Ehh="ewr-selection-dragtooltip";Q.Fhh="ewr-selection-dragtooltip-updated";
Q.Qhh="ewr_selection_rearrangeleft";Q.Rhh="ewr_selection_rearrangeright";Q.Shh="ewr_selection_rearrangetop";Q.Phh="ewr_selection_rearrangebottom";Q.selecting="selecting";Q.Thh="ewr-selection-resizemarqueehandle";Q.Whh="ewr-selection-resizemarqueehandle-topleft";Q.Xhh="ewr-selection-resizemarqueehandle-topright";Q.Uhh="ewr-selection-resizemarqueehandle-bottomleft";Q.Vhh="ewr-selection-resizemarqueehandle-bottomright";Q.lhh="ewr-marquee-thick";Q.phh="ewr-resizemarqueehandle-thick";Object(Oe.a)(Q,"CssClassNames",
null,[]);Em(S,L);S.prototype.dispose=function(){var O=this;this.MB.forEach(function(qa){Ud.a.instance.za(ed.a.pointerDown,qa,Object(bd.a)(O,O.onPointerDown,"onPointerDown"))});Array.clear(this.MB);this.Kka=this.sourceRange=this.Zc=null;Tc.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.Mpa,!this.$);this.$&&(this.$.dl(Object(bd.a)(this,this.jd,"onWorkbookOpened")),1===this.Mpa&&(Tc.ULS.sendTraceTag(537159380,0,15,
"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.jL(this.Ece,this.Fce,!1)));L.prototype.dispose.call(this)};S.prototype.Ah=function(O){O=Hg.a(this.$).He(O);return this.zqf(O)};S.prototype.zqf=function(O){if(5!==this.au)return!1;(O=this.O6a(O))||this.N4b(!1);hg.b(this.$,!1);return O};S.prototype.onPointerDown=function(O){O=Hg.a(this.$).He(O);if(2===O.yb&&!O.Xn&&!this.iQa){var qa=this.vad(O);if(!qa)return Tc.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),
!1;this.Zc=qa.clone();this.sourceRange=this.Zc.clone();this.Kka=this.Zc;if(qa=this.vDh(O))this.au=5,this.nSd=qa.top-this.sourceRange.top,this.Gdd=qa.left-this.sourceRange.left,Hf.g(this.$).wi.wA(S.G1c),this.pqf(O),this.iQa=!0,hg.b(this.$,!0)}return!1};S.prototype.pk=function(O){O=Hg.a(this.$).He(O);if(this.Y0h&&this.xqf(O))return!0;if(O=this.ga.Br(O.clientPoint,O.Sb,5,void 0,void 0,!0)){O=this.vmb(O);if(this.Zc.equals(O))return!0;this.Zc=O;if(!this.A6())return Tc.ULS.shipAssertTag(537159378,0,!1,
"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.N4b(!0),!1}return!0};S.prototype.rV=function(O,qa){Tc.ULS.shipAssertTag(537159377,0,!this.Mpa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Mpa+=1;this.Ece=O;this.Fce=qa;this.Xo.rV(O,qa,this.fPd())};S.prototype.vmb=function(O){if(!O||!this.Zc)return Tc.ULS.shipAssertTag(537159376,0,!!O,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),
Tc.ULS.shipAssertTag(537159375,0,!!this.Zc,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var qa=this.Zc.clone();1!==this.X1&&(qa.left=Math.max(O.left-this.Gdd,1),qa.right=qa.left+this.sourceRange.width-1);2!==this.X1&&(qa.top=Math.max(O.top-this.nSd,1),qa.bottom=qa.top+this.sourceRange.height-1);return this.IVb(qa)};S.prototype.jL=function(O,qa,rb,Sb){rb=void 0===rb?!0:rb;Sb=void 0===Sb?!0:Sb;Tc.ULS.shipAssertTag(537159374,0,1===this.Mpa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");
--this.Mpa;Hf.g(this.$).wi.wA(Ue.a.Ota);this.Xo.cQd(O,qa,this.fPd());rb&&this.oqe(Sb);this.X1=0;this.iQa=!1};S.prototype.IVb=function(O){var qa=Hf.g(this.$),rb=O;if(qa.Wa.t3){if(!qa.tc(O.topLeft)){qa=qa.mm("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",qa.aJ,this.Kka.top!==O.top?1:2);try{qa.Lk=this.Kka.top<O.top||this.Kka.left<O.left,qa.uu(O.topLeft),rb=qa.$$cu().range}finally{qa&&qa.dispose()}}rb.right=rb.left+O.width-1;rb.bottom=rb.top+O.height-1}return this.Kka=rb};S.prototype.nHd=function(O){this.MB.forEach(function(qa){mf.DOMElementExtensions.setVisible(qa,
O)})};S.prototype.jd=function(O,qa){qa.wJ||this.nHd(this.$.isEditMode)};S.prototype.vDh=function(O){var qa=O.Sb;O=O.clientPoint;if(!qa||!O)return Tc.ULS.shipAssertTag(537159373,0,!!qa,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),Tc.ULS.shipAssertTag(537159372,0,!!O,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;O.y+=qa===this.MB[S.S2b]?2:qa===this.MB[S.nBe]?-2:0;O.x+=qa===this.MB[S.pBe]?2:qa===this.MB[S.R2b]?-2:0;return this.ga.Br(O,qa,5,void 0,
void 0,!0)};Ll.Object.defineProperties(S.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return Hf.g(this.$).Kb}},au:{configurable:!0,enumerable:!0,get:function(){return this.ga.selectionType},set:function(O){this.ga.selectionType=O}}});S.G1c="move";S.S2b=0;S.nBe=1;S.pBe=2;S.R2b=3;Object(Oe.a)(S,"DragSelectionClickBehaviorBase",L,[]);Em(H,S);H.prototype.iWa=function(O){this.Xo.DGb(O,this.MB);this.ex.Zxa()};H.prototype.pqf=function(O){Tc.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");
this.gridView.tJa=!0;this.pb.oD(!1);this.au=5;this.ex.rBe(O.Sb);this.pb.textBox.removeSelection();this.pb.jVb(Object(bd.a)(this,this.SXe,"handleKeyDownDuringDrag"));this.rV(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"));this.X1=this.sourceRange.isRow?1:this.sourceRange.Fh?2:0};H.prototype.O6a=function(){var O=this.kca();this.au=-1;this.jL(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"));return O};H.prototype.oqe=function(){this.gridView.tJa=
!1;this.ex.sBe(this.MB[0]);this.pb.textBox.setCaretPositionToEnd();this.pb.fnc(Object(bd.a)(this,this.SXe,"handleKeyDownDuringDrag"));this.Xo.OBf()};H.prototype.SXe=function(){this.N4b(!0)};H.prototype.N4b=function(O){Tc.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");O&&this.jL(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"))};H.prototype.vad=function(O){this.pb=
this.Xo.Q7c();this.hK=this.Xo.mUe(O);return this.pb&&this.hK&&this.hK.range?this.hK.range:(Tc.ULS.shipAssertTag(537159388,0,!!this.pb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),Tc.ULS.shipAssertTag(537159387,0,!!this.hK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),Tc.ULS.shipAssertTag(537159386,0,!!this.hK.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};H.prototype.kca=function(){return this.hK?
this.coloredReferencesManager.ygf(this.pb,this.hK,this.Zc):(Tc.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};H.prototype.A6=function(){return this.kca()};H.prototype.fPd=function(){return!0};H.prototype.xqf=function(){return!1};Object(Oe.a)(H,"DragMarqueeClickBehavior",S,[]);var bh=b(893),Fh=b(815),gh=b(126);Object(Oe.a)(A,"MacroRecorderTableRowColumnRearrangedPayload",
null,[115]);Em(E,S);E.prototype.dispose=function(){this.ga&&(this.ga.Oba(Object(bd.a)(this,this.hq,"onSelectionStarted")),this.ga.WZ(Object(bd.a)(this,this.Bh,"onSelectionEnded")),this.ga.NFf(Object(bd.a)(this,this.esf,"onSelectionAbort")),this.ga.aK(Object(bd.a)(this,this.$c,"onSelectionChanged")));if(this.ho)for(var O=1;4>=O;O++)mf.DOMElementExtensions.ig(this.ho[O.toString()]);this.ho=this.$t=null;this.NY&&this.tvc();this.Ev&&this.OY&&this.tvc(1);S.prototype.dispose.call(this)};E.prototype.pqf=
function(O){this.Ev&&(this.kba=O,this.rca=null,this.XP=this.isRow=this.Fh=this.YP=!1,de.KeyInputManager.instance.pa(ed.a.Qb,this.domElement.ownerDocument.body,Object(bd.a)(this,this.onKeyDown,"onKeyDown")));this.FG=!0;this.tableRange=this.XGg(this.tableManager.zo(this.sourceRange.topLeft));Hf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Ev?(this.rca=this.tableRange,this.MI=1,this.$t=(this.XP=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?
[11]:[12],this.au=6,this.rV(Object(bd.a)(this,this.M6a,"onPointerMoveRearrange"),Object(bd.a)(this,this.P6a,"onPointerUpRearrange")),this.DGa=this.T2b,this.zPa=this.qrc,this.Ola(O.clientPoint,O.Sb,this.XP?11:12,!0,!0),this.dRa(!0)):(this.$t=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.au=6,this.rV(Object(bd.a)(this,this.M6a,"onPointerMoveRearrange"),Object(bd.a)(this,this.P6a,"onPointerUpRearrange")),this.Ola(O.clientPoint,
O.Sb,this.isRow?11:12,!0)):(this.tableRange=null,this.Ev?(this.isRow=this.sourceRange.isRow,this.Fh=this.sourceRange.Fh,this.isRow||this.Fh?(this.MI=3,this.X1=this.isRow?1:2,this.au=6,this.$t=this.isRow?[11]:[12],this.rV(Object(bd.a)(this,this.QAb,"onPointerMoveDragInsert"),Object(bd.a)(this,this.RAb,"onPointerUpDragInsert")),this.DGa=this.T2b,this.zPa=this.qrc,this.Ola(O.clientPoint,O.Sb,this.isRow?11:12,!0,!0),this.dRa(!0)):(this.MI=2,this.X1=0,this.rV(Object(bd.a)(this,this.pk,"onPointerMove"),
Object(bd.a)(this,this.Ah,"onPointerUp")),this.DGa=this.tBe,this.zPa=this.aRf,this.Ola(O.clientPoint,O.Sb,this.t7b(),!1,!0),this.A6(!0))):(this.rV(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp")),de.KeyInputManager.instance.pa(ed.a.Qb,this.domElement.ownerDocument.body,Object(bd.a)(this,this.onKeyDown,"onKeyDown")),this.X1=this.sourceRange.isRow?1:this.sourceRange.Fh?2:0,this.Ola(O.clientPoint,O.Sb,this.t7b(),!1),this.A6()))};E.prototype.onKeyDown=function(O){if(this.Ev){if(this.sbc(O)||
O.Ea.keyCode===Xf.a.pcb)return this.fid||(de.KeyInputManager.instance.pa(ed.a.Xd,this.domElement.ownerDocument.body,Object(bd.a)(this,this.onKeyUp,"onKeyUp")),this.fid=!0),!this.NY&&this.sbc(O)&&(Hf.g(this.$).wi.wA(E.lue),this.NY=!0),this.OY||O.Ea.keyCode!==Xf.a.pcb||(this.OY=!0,2===this.MI?(this.Rqa(!1),this.X1=0,this.$t=this.XP?[11]:[12],this.YP=this.XP,this.NAd(),this.dRa()):3===this.MI?(this.Smb(!1),this.X1=this.isRow?1:2,this.ADb(),this.A6()):1===this.MI&&(this.EVc(!1),this.ADb(),this.A6())),
!0}else if(!this.NY&&(O.Ea.keyCode===Xf.a.Rza||zf.a.isMac&&O.Ea.keyCode===Xf.a.ocb))return de.KeyInputManager.instance.pa(ed.a.Xd,this.domElement.ownerDocument.body,Object(bd.a)(this,this.onKeyUp,"onKeyUp")),Hf.g(this.$).wi.wA(E.lue),this.NY=!0;return!1};E.prototype.onKeyUp=function(O){if(this.Ev){if(this.sbc(O)||O.Ea.keyCode===Xf.a.pcb)return this.sbc(O)?(this.Eld=0,this.FG&&Hf.g(this.$).wi.wA(S.G1c)):O.Ea.keyCode===Xf.a.pcb&&(this.Eld=1,2===this.MI?(this.Smb(!1),this.X1=0,this.ADb(!0),this.A6(!0)):
3===this.MI?(this.Rqa(!1),this.X1=this.isRow?1:2,this.$t=this.isRow?[11]:[12],this.NAd(!0),this.dRa(!0)):1===this.MI&&(this.Rqa(!1),this.$t=this.XP?[11]:[12],this.oDf(!0),this.dRa(!0))),this.tvc(this.Eld),!0}else if(O.Ea.keyCode===Xf.a.Rza||zf.a.isMac&&O.Ea.keyCode===Xf.a.ocb)return this.tvc(),this.FG&&Hf.g(this.$).wi.wA(S.G1c),!0;return!1};E.prototype.O6a=function(){this.FG=!1;this.Ev&&(this.MI=0);this.Kb.mk(this.Uha());if(!this.$.Xs([this.Zc],!1))return this.jL(Object(bd.a)(this,this.pk,"onPointerMove"),
Object(bd.a)(this,this.Ah,"onPointerUp")),this.au=-1,!0;if(this.ga.wa.Nd.equals(this.Zc)||this.Fac(this.Zc)||this.Fac(this.sourceRange))this.au=-1;else{this.kca();this.ga.sourceRange=this.sourceRange.clone();var O=this.ga.sourceRange,qa=this.ga.wa.Nd;if(this.Ev){var rb={};this.$.De(-694765314,2,30,(rb.DragDropForceIsCopy=this.NY,rb.DragDropSourceRange=O,rb.DragDropDestinationRange=qa,rb.DragDropIsShiftDown=this.OY,rb))}else rb={},this.$.De(-694765314,2,30,(rb.DragDropForceIsCopy=this.NY,rb.DragDropSourceRange=
O,rb.DragDropDestinationRange=qa,rb))}!this.Ev&&this.tableRange||this.jL(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"));return!0};E.prototype.oqe=function(O){O&&(de.KeyInputManager.instance.za(ed.a.Qb,this.domElement.ownerDocument.body,Object(bd.a)(this,this.onKeyDown,"onKeyDown")),this.FG=!1);for(O=1;4>=O;O++){var qa=this.ho[O.toString()];qa&&qa.parentNode.removeChild(qa);this.ho[O.toString()]=null}this.$t=null};E.prototype.P6a=function(O){O=Hg.a(this.$).He(O);
5===this.au?this.zqf(O):(this.FG=!1,this.Kb.mk(this.$t),!this.$.Xs([this.Zc],!1)||this.rOi()||this.J6e()||(this.ga.sourceRange=this.sourceRange.clone(),this.Ev?this.MJi():this.RIe(),this.e4()?this.Zc.top>this.sourceRange.top&&(O=this.Zc.height,this.Zc.top-=O,this.Zc.bottom-=O):this.Zc.left>this.sourceRange.left&&(O=this.Zc.width,this.Zc.left-=O,this.Zc.right-=O),this.kca()));this.jL(Object(bd.a)(this,this.M6a,"onPointerMoveRearrange"),Object(bd.a)(this,this.P6a,"onPointerUpRearrange"));this.tableRange=
null;this.au=-1;this.Ev&&(this.rca=null,this.MI=0);return!0};E.prototype.RAb=function(){this.FG=!1;this.MI=0;this.Kb.mk(this.$t);if(!this.$.Xs([this.Zc],!1))return this.jL(Object(bd.a)(this,this.QAb,"onPointerMoveDragInsert"),Object(bd.a)(this,this.RAb,"onPointerUpDragInsert")),this.au=-1,!0;if(!(this.ga.wa.Nd.equals(this.Zc)||this.Fac(this.Zc)||this.Fac(this.sourceRange)||this.J6e())){this.kca();this.ga.sourceRange=this.sourceRange.clone();var O=this.ga.sourceRange,qa=this.ga.wa.Nd,rb={};this.$.De(-694765314,
2,30,(rb.DragDropForceIsCopy=this.NY,rb.DragDropForceIsInsert=!0,rb.DragInsertIsVertical=this.YP,rb.DragDropSourceRange=O,rb.DragDropDestinationRange=qa,rb.DragDropIsShiftDown=this.OY,rb));this.NY||(this.Zc.top>this.sourceRange.top&&(this.isRow||this.Zc.left===this.sourceRange.left&&this.YP)?(O=this.Zc.height,this.Zc.top-=O,this.Zc.bottom-=O):this.Zc.left>this.sourceRange.left&&(this.Fh||this.Zc.top===this.sourceRange.top&&!this.YP)&&(O=this.Zc.width,this.Zc.left-=O,this.Zc.right-=O),this.kca())}this.jL(Object(bd.a)(this,
this.QAb,"onPointerMoveDragInsert"),Object(bd.a)(this,this.RAb,"onPointerUpDragInsert"));this.rca=this.tableRange=null;this.au=-1;this.YP=!1;return!0};E.prototype.xqf=function(O){var qa=this.ga.Br(O.clientPoint,O.Sb,5,void 0,void 0,!0);this.kba=O;return this.WYe(qa)?(this.Zc=this.OTc(qa),this.tXe(!0),!0):this.XPh(qa)?(this.Zc=this.vmb(qa),this.uXe(!0),!0):!1};E.prototype.M6a=function(O){var qa=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");qa&&(O=Hg.a(this.$).He(O));
var rb=O.clientPoint;qa||(O=Hg.a(this.$).He(O));this.Ev&&(this.kba=O);if(O=this.ga.Br(rb,O.Sb,5,void 0,void 0,!0)){if(this.tableRange.contains(O.topLeft)){qa=Hf.g(this.$);var Sb=qa.Eg(O),Uc=qa.Mf(this.paneType);rb=Fh.a.Kt(Uc.view.Mg,this.domElement.parentNode,rb,qa.rtl);Uc=!1;var vd=2;this.e4()&&rb.y-Sb.topLeft.y>Sb.height/2?(Uc=!0,vd=1):!this.e4()&&rb.x-Sb.topLeft.x>Sb.width/2&&(Uc=!0);if(Uc){qa=qa.mm("DragSelectionClickBehavior.OnPointerMoveRearrange",qa.aJ,vd);try{qa.uu(O),qa.$$mn(),O=qa.$$cu().range}finally{qa&&
qa.dispose()}}this.Zc=this.OTc(O);this.ga.sourceRange=this.Zc;this.Kb.Ek(this.Zc,this.$t);this.Kb.Jr(this.$t);this.Kb.mk(this.Uha());if(6!==this.au){for(O=1;4>=O;O++)qa=this.ho[O.toString()],qa.parentNode.removeChild(qa),this.Kb.hJ(this.e4()?11:12,O).Rm.appendChild(qa);this.au=6}}else if(this.Zc=this.vmb(O),this.Ev)this.uXe(!1);else if(this.Kb.Ek(this.Zc,this.Uha()),this.Kb.Jr(this.Uha()),this.Kb.mk(this.$t),5!==this.au){for(O=1;4>=O;O++)qa=this.ho[O.toString()],qa.parentNode.removeChild(qa),this.Kb.hJ(this.t7b(),
O).Rm.appendChild(qa);this.au=5}this.VV()}return!0};E.prototype.QAb=function(O){var qa=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");qa&&(O=Hg.a(this.$).He(O));var rb=O.clientPoint;qa||(O=Hg.a(this.$).He(O));this.kba=O;if(qa=this.ga.Br(rb,O.Sb,5,void 0,void 0,!0)){if(this.WYe(qa))return this.Zc=this.vmb(qa),this.tXe(!1),!0;var Sb=Hf.g(this.$),Uc=Sb.Eg(qa),vd=Sb.Mf(this.paneType);rb=Fh.a.Kt(vd.view.Mg,this.domElement.parentNode,rb,Sb.rtl);vd=!1;var oe=2;this.YP=
!1;if(this.isRow||this.Fh){this.isRow&&rb.y-Uc.topLeft.y>Uc.height/2?(vd=!0,oe=1):this.Fh&&rb.x-Uc.topLeft.x>Uc.width/2&&(vd=!0);if(vd){O=Sb.mm("DragSelectionClickBehavior.OnPointerMoveDragInsert",Sb.aJ,oe);try{O.uu(qa),O.$$mn(),qa=O.$$cu().range}finally{O&&O.dispose()}}this.Zc=this.vmb(qa)}else{rb.x-Uc.topLeft.x===Uc.width?(this.YP=!1,vd=!0):rb.y-Uc.topLeft.y>Uc.height/2&&(this.YP=vd=!0,oe=1);this.rca&&(this.YP=this.XP);if(vd){Sb=Sb.mm("DragSelectionClickBehavior.OnPointerMoveDragInsert",Sb.aJ,oe);
try{Sb.uu(qa),Sb.$$mn(),qa=Sb.$$cu().range}finally{Sb&&Sb.dispose()}}this.Kb.mk(this.$t);this.$t=this.YP?[11]:[12];for(Sb=1;4>=Sb;Sb++)(Uc=this.ho[Sb.toString()])&&Uc.parentNode.removeChild(Uc),this.ho[Sb.toString()]=null;this.Ola(O.clientPoint,O.Sb,this.YP?11:12,!0);this.Zc=this.OTc(qa)}this.ga.sourceRange=this.Zc;this.Kb.Ek(this.Zc,this.$t);this.Kb.Jr(this.$t);this.Kb.mk(this.Uha());if(6!==this.au){for(O=1;4>=O;O++)qa=this.ho[O.toString()],qa.parentNode.removeChild(qa),this.Kb.hJ(this.isRow||this.YP?
11:12,O).Rm.appendChild(qa);this.au=6}this.VV()}return!0};E.prototype.WYe=function(O){return!!this.rca&&1!==this.MI&&!!O&&this.rca.contains(O.topLeft)};E.prototype.XPh=function(O){return!!this.rca&&1===this.MI&&!!O&&!this.rca.contains(O.topLeft)};E.prototype.tXe=function(O){this.tableRange=this.rca;this.MI=1;var qa=!this.OY;O?(this.Rqa(!1),this.$t=this.XP?[11]:[12],this.oDf(qa),this.dRa(qa)):(this.Smb(!1),this.ADb(qa),this.A6(qa))};E.prototype.uXe=function(O){this.tableRange=null;this.MI=2;var qa=
!this.OY;O?(this.Rqa(!1),this.$t=this.XP?[11]:[12],this.YP=this.XP,this.NAd(qa),this.dRa(qa)):(this.EVc(!1),this.ADb(qa),this.A6(qa))};E.prototype.vad=function(){return this.ga.wa.Nd};E.prototype.kca=function(){this.ga.updateSelection(this.Zc,this.Zc.topLeft,0);return!0};E.prototype.A6=function(O){O=void 0===O?!1:O;this.Kb.Ek(this.Zc,this.Uha());this.Kb.Jr(this.Uha());this.VV(O);return!0};E.prototype.dRa=function(O){O=void 0===O?!1:O;this.Kb.Ek(this.Zc,this.$t);this.Kb.Jr(this.$t);this.VV(O)};E.prototype.Bh=
function(){this.domElement.classList.remove(Q.selecting)};E.prototype.hq=function(){this.domElement.classList.add(Q.selecting)};E.prototype.$c=function(){if(this.$.isEditMode){var O=this.vej();this.nHd(O)}};E.prototype.esf=function(){this.Ev?this.FG&&5<=this.au&&(this.tableRange?this.OY?this.Rqa(!0):this.EVc(!0):this.OY?this.isRow||this.Fh?this.Rqa(!0):this.Smb(!0):this.isRow||this.Fh?this.Smb(!0):this.Rqa(!0)):this.FG&&5<=this.au&&(this.tableRange?(this.Kb.mk(this.$t),this.jL(Object(bd.a)(this,this.M6a,
"onPointerMoveRearrange"),Object(bd.a)(this,this.P6a,"onPointerUpRearrange"))):(this.Kb.mk(this.Uha()),this.jL(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"))))};E.prototype.N4b=function(){Tc.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};E.prototype.fPd=function(){return!1};E.prototype.vej=function(){if(!Hf.g(this.$).ga.wa.xh)return!1;var O=Hf.g(this.$).getRangeInformation(this.ga.wa.Nd);
O=Ol(O);for(var qa=O.next();!qa.done;qa=O.next())if(Object(Bc.a)(bc.PivotTableRange,qa.value))return!1;return!0};E.prototype.XGg=function(O){if(O&&O.contains(this.sourceRange)&&!O.equals(this.sourceRange)){if(O.bua&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===O.top){var qa=new yf.Range(this.sourceRange.top,this.sourceRange.left,O.bottom,this.sourceRange.right,!1,!1);if(!qa.equals(O))return this.sourceRange=qa,this.ga.updateSelection(this.sourceRange,this.sourceRange.topLeft,
0),O}this.Ev?this.XP=O.left===this.sourceRange.left&&O.right===this.sourceRange.right:this.isRow=O.left===this.sourceRange.left&&O.right===this.sourceRange.right;if(O.top===this.sourceRange.top&&O.bottom===this.sourceRange.bottom||this.e4())return O}return null};E.prototype.OTc=function(O){var qa=O.clone();this.e4()?qa.left=Math.max(O.left-this.Gdd,1):qa.top=Math.max(O.top-this.nSd,1);qa.right=qa.left+this.sourceRange.width-1;qa.bottom=qa.top+this.sourceRange.height-1;return this.IVb(qa)};E.prototype.J6e=
function(){var O=this.Zc.topLeft.$d(this.sourceRange);return O||this.Ev&&!this.tableRange?O:this.e4()?this.Zc.top===this.sourceRange.bottom+1:this.Zc.left===this.sourceRange.right+1};E.prototype.rOi=function(){if(this.e4()&&this.Zc.left!==this.tableRange.left||!this.e4()&&this.Zc.top!==this.tableRange.top){var O=eg.a.gd(1,1,0,865,0,2065438552,"RearrangeInvalidDest");cf.a(this.$).Gs([O]);return!0}return!1};E.prototype.MJi=function(){var O=this,qa=this.$.Vb.Dc("UserAction","RearrangeRowColumnClientSide"),
rb={},Sb=(rb.CopyPasteTargetType=1,rb.OperationId=Ff.a.create().toString(),rb.Stopwatch=qa,rb.DragDropIsShiftKeyDown=this.OY,rb.EncounteredDeploymentErrors=!1,rb),Uc=this.NY?2:1,vd=this.$.ea.Ba(254);(new Promise(function(oe,ef){O.RIe(function(Nf){Nf.Errors&&0<Nf.Errors.length?ef(new bh.a(22,Nf.Errors)):oe(!0)},function(Nf){Nf=gh.a.xg(Nf.data);ef(new bh.a(22,Nf))})})).then(function(){Tc.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);vd&&vd.Ldi(Sb,Uc,O.sourceRange,O.Zc);return Promise.resolve(!0)},function(oe){Tc.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',oe?copyPasteInfra.getStringifiedError(oe):"null",1);return vd?vd.Pxi(oe,Sb,Uc,O.sourceRange,O.Zc):Promise.reject(oe)})};E.prototype.RIe=function(O,qa){function rb(){return new A(oe,vd)}function Sb(ef,Nf,kh){var Md=Uc.$.ra.ua;ef=O?Rf.b(ef,O):ef;Nf=qa?Rf.a(Nf,qa):Nf;var Je=Md.Na(41,null);Je.sourceRange=oe;
Je.destinationRange=vd;return Ih.i(Md,"RearrangeRowColumn",Je,ef,Nf,kh,null,0)}var Uc=this;O=void 0===O?null:O;qa=void 0===qa?null:qa;var vd={};this.e4()?(vd.FirstRow=this.Zc.top-1,vd.FirstColumn=0,vd.DeltaColumn=0,vd.DeltaRow=this.Zc.bottom-this.Zc.top+1):(vd.FirstRow=0,vd.FirstColumn=this.Zc.left-1,vd.DeltaColumn=this.Zc.right-this.Zc.left+1,vd.DeltaRow=0);vd.LastRow=Tg.a.zy;vd.LastColumn=Tg.a.Iv;vd.SheetName=this.$.va.qa?this.$.va.qa.name:this.$.wb.getItemByName(this.$.wb.qa.name).sheetName;var oe=
Bf.v(this.sourceRange,this.$);he.EwaSettings.pc()?this.$.userOperationManager.jc(new Of.a(514,0,Sb,64,rb),null):this.$.userOperationManager.jc(new be.a(514,0,Sb,void 0,rb),null)};E.prototype.Fac=function(O){O=Hf.g(this.$).getRangeInformation(O);for(var qa=0,rb=O.length;qa<rb;++qa)if(Object(Bc.a)(bc.PivotTableRange,O[qa]))return O=eg.a.gd(1,0,0,860,0,2105176604,"InsDelCellsPivotTable"),cf.a(this.$).Gs([O]),!0;return!1};E.prototype.Ola=function(O,qa,rb,Sb,Uc){Uc=void 0===Uc?!1:Uc;var vd=mf.DOMElementExtensions.getBoundingClientRect(qa),
oe=qa===this.MB[S.S2b]||qa===this.MB[S.nBe];if(this.Ev){var ef=qa===this.MB[S.pBe]||qa===this.MB[S.R2b];this.isRow&&ef||this.Fh&&oe?ef="100px":(oe=this.isRow||oe,ef=(oe?Uc?E.drj:E.irj:Uc?E.crj:E.frj)+"px");qa=oe?qa===this.MB[S.S2b]?"top":"bottom":qa===this.MB[S.R2b]?"right":"left";O=100*(oe?O.x-vd.x:O.y-vd.y)/(oe?vd.width:vd.height);for(vd=1;4>=vd;vd++){Sb=document.createElement("div");var Nf=document.createElement("div"),kh=document.createElement("div");Sb.appendChild(Nf);Sb.appendChild(kh);Uc&&
(Nf=document.createElement("div"),Sb.appendChild(Nf),mf.DOMElementExtensions.yqc(Sb,E.Ajh),kh.style.fontWeight="bold");Sb.className=Q.Fhh;this.ho[vd.toString()]=Sb;this.Kb.hJ(rb,vd).Rm.appendChild(Sb);Sb=this.ho[vd.toString()];Sb.style[qa]=ef;Sb.style[oe?"left":"top"]=O+"%"}}else for(Uc=(oe?-E.hrj:-E.erj)+"px",ef=oe?qa===this.MB[S.S2b]?"top":"bottom":qa===this.MB[S.R2b]||Sb?"right":"left",qa=100*(oe?Sb?0:O.x-vd.x:O.y-vd.y)/(oe?vd.width:vd.height),O=1;4>=O;O++)vd=document.createElement("div"),vd.className=
Q.Ehh,this.ho[O.toString()]=vd,this.Kb.hJ(rb,O).Rm.appendChild(vd),vd=this.ho[O.toString()],vd.style[ef]=Uc,vd.style[oe?"left":"top"]=qa+"%"};E.prototype.VV=function(O){O=void 0===O?!1:O;var qa=this.Zc.toString();if(this.Ev)for(var rb=1;4>=rb;rb++)this.ho[rb.toString()].childNodes[0].innerText=qa,this.ho[rb.toString()].childNodes[1].innerText=this.DGa,O&&(this.ho[rb.toString()].childNodes[2].innerText=this.zPa);else for(O=1;4>=O;O++)this.ho[O.toString()].innerText=qa};E.prototype.tvc=function(O){O=
void 0===O?0:O;O?1===O&&(this.OY=!1):this.NY=!1;this.Ev&&(this.NY||this.OY)||(de.KeyInputManager.instance.za(ed.a.Xd,this.domElement.ownerDocument.body,Object(bd.a)(this,this.onKeyUp,"onKeyUp")),this.fid=!1)};E.prototype.Rqa=function(O){this.Kb.mk(this.Uha());this.jL(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"),void 0,O)};E.prototype.Smb=function(O){this.Kb.mk(this.$t);this.jL(Object(bd.a)(this,this.QAb,"onPointerMoveDragInsert"),Object(bd.a)(this,this.RAb,"onPointerUpDragInsert"),
void 0,O)};E.prototype.EVc=function(O){this.Kb.mk(this.$t);this.jL(Object(bd.a)(this,this.M6a,"onPointerMoveRearrange"),Object(bd.a)(this,this.P6a,"onPointerUpRearrange"),void 0,O)};E.prototype.ADb=function(O){O=void 0===O?!1:O;this.au=5;this.rV(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"));this.DGa=this.tBe;this.zPa=this.aRf;this.Ola(this.kba.clientPoint,this.kba.Sb,this.t7b(),!1,O)};E.prototype.NAd=function(O){O=void 0===O?!1:O;this.au=6;this.rV(Object(bd.a)(this,
this.QAb,"onPointerMoveDragInsert"),Object(bd.a)(this,this.RAb,"onPointerUpDragInsert"));this.DGa=this.T2b;this.zPa=this.qrc;this.Ola(this.kba.clientPoint,this.kba.Sb,this.isRow||this.XP?11:12,!0,O)};E.prototype.oDf=function(O){O=void 0===O?!1:O;this.au=6;this.rV(Object(bd.a)(this,this.M6a,"onPointerMoveRearrange"),Object(bd.a)(this,this.P6a,"onPointerUpRearrange"));this.DGa=this.T2b;this.zPa=this.qrc;this.Ola(this.kba.clientPoint,this.kba.Sb,this.e4()?11:12,!0,O)};E.prototype.sbc=function(O){return O.Ea.keyCode===
Xf.a.Rza||zf.a.isMac&&O.Ea.keyCode===Xf.a.ocb};E.prototype.e4=function(){return!this.Ev&&this.isRow||this.Ev&&this.XP};E.prototype.t7b=function(){return this.Ev?41:6};E.prototype.Uha=function(){return this.Ev?E.s5g:E.w5g};E.erj=50;E.hrj=25;E.frj=-85;E.irj=-40;E.crj=-120;E.drj=-50;E.Ajh=41;E.lue="copy";E.w5g=[6];E.s5g=[41];Object(Oe.a)(E,"DragSelectionClickBehavior",S,[]);Em(J,L);J.prototype.dispose=function(){Ud.a.instance.za(ed.a.pointerDown,this.S9,Object(bd.a)(this,this.onPointerDown,"onPointerDown"));
Tf.a.instance.za(ed.a.zj,this.S9,Object(bd.a)(this,this.Paa,"onDblClick"));this.gridView.$&&(this.gridView.ga.Oba(Object(bd.a)(this,this.hq,"onSelectionStarted")),this.gridView.ga.WZ(Object(bd.a)(this,this.Bh,"onSelectionEnded")),this.gridView.$.dl(Object(bd.a)(this,this.jd,"onWorkbookOpened")),this.gridView.$.zb.tnc(Object(bd.a)(this,this.e5,"onWacDialogOpened")),this.gridView.$.zb.snc(Object(bd.a)(this,this.d5,"onWacDialogClosed")),he.EwaSettings.isChangeGateEnabled("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&
(this.gridView.VEf(Object(bd.a)(this,this.Wzb,"onComponentRangePickerActiveStateChanged")),this.gridView.uc.ym(Object(bd.a)(this,this.Onf,"onGridEditStarted")),this.gridView.uc.Fr(Object(bd.a)(this,this.Nnf,"onGridEditEnded"))));L.prototype.dispose.call(this)};J.prototype.Bh=function(){this.domElement.classList.remove(Q.selecting);uf.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};J.prototype.hq=function(){this.domElement.classList.add(Q.selecting)};J.prototype.onPointerDown=function(O){2!==
O.yb||O.Xn||(this.gridView.ga.selectionType=4,this.gridView.ga.sourceRange=this.gridView.ga.wa.Nd,uf.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};J.prototype.Paa=function(){this.gridView.$.De(1983983164,2,30,null);return!0};J.prototype.jd=function(){mf.DOMElementExtensions.setVisible(this.S9,this.gridView.$.isEditMode)};J.prototype.e5=function(){mf.DOMElementExtensions.setVisible(this.S9,!1)};J.prototype.d5=function(){mf.DOMElementExtensions.setVisible(this.S9,!0)};
J.prototype.Onf=function(){mf.DOMElementExtensions.setVisible(this.S9,!1)};J.prototype.Nnf=function(){mf.DOMElementExtensions.setVisible(this.S9,!0)};J.prototype.Wzb=function(O,qa){mf.DOMElementExtensions.setVisible(this.S9,!qa.Ice)};Object(Oe.a)(J,"FillHandleClickBehavior",L,[]);Em(y,G);y.prototype.czi=function(O){var qa=ue.HelperMethods.om(O),rb=this.Nta.rSd(O.clientPoint);if(!rb)return!1;var Sb=rb.jg,Uc=this.Nta.Ca.M0a(Sb.hashCode).Kha(rb.VH);if(!Uc)return!1;O=Sb.ij.domElement;rb=ue.HelperMethods.oee(ue.HelperMethods.uIa(Sb.domElement,
O),rb.VH);Sb=0;Uc=this.Nta.tc(Uc.getRange());for(var vd=0,oe=y.bpe.length;vd<oe;++vd){var ef=y.bpe[vd];if(128!==ef&&64!==ef||!this.Nta.$.isEditMode){var Nf=Uc.pIa(ef);if(Nf&&Nf.I2a&&"none"!==Nf.I2a.style.display){Nf=Nf.I2a;var kh=ue.HelperMethods.uIa(Nf,O);Nf=new Sys.UI.Bounds(kh.x,kh.y,Nf.offsetWidth,Nf.offsetHeight);if(Le.a.dA(Nf,rb)){Sb=ef;break}}}}return Sb?(Uc.invoke(Sb,qa),!0):!1};Ll.Object.defineProperties(y.prototype,{Nta:{configurable:!0,enumerable:!0,get:function(){return this.ndg}}});y.bpe=
[1,2,32,256,128,64];Object(Oe.a)(y,"IPadSelectionClickThroughBehavior",G,[]);x.prototype.dispose=function(){this.gridView.ga.Oba(Object(bd.a)(this,this.hq,"onSelectionStarted"));this.gridView.ga.WZ(Object(bd.a)(this,this.Bh,"onSelectionEnded"));this.gridView.ga.NFf(Object(bd.a)(this,this.Bh,"onSelectionEnded"))};x.prototype.Zxa=function(){this.k2a=0;this.Xbc=!1;this.j4=Number.NaN};x.prototype.V_e=function(O){this.Pvc(O.Sb,1);return!0};x.prototype.W_e=function(O){this.Pvc(O.Sb,-1);return!0};x.prototype.rBe=
function(O){this.Xbc=!0;this.Pvc(O,1)};x.prototype.sBe=function(O){this.Xbc=!1;this.Pvc(O,-1)};x.prototype.Pvc=function(O,qa){if(O)if(O.parentNode)if(this.Yhd)isNaN(this.j4)||(this.awc(this.j4,!1),this.j4=Number.NaN);else if(O=parseInt(O.parentNode.getAttribute(Ue.a.zub)),isNaN(O))Tc.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.j4)&&O!==this.j4){if(this.Xbc)return;this.awc(this.j4,!1)}if(isNaN(this.j4)||
O!==this.j4)this.j4=O,this.k2a=0;!this.k2a&&0<qa&&this.awc(O,!0);this.k2a=Math.max(this.k2a+qa,0);!this.k2a&&0>qa&&(this.awc(O,!1),this.j4=Number.NaN)}else Tc.ULS.shipAssertTag(537159367,0,!!O.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else Tc.ULS.shipAssertTag(537159368,0,!!O,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};x.prototype.awc=function(O,qa){for(var rb=1;4>=rb;rb++){var Sb=this.gridView.Kb.hJ(3,rb,O).Rm;mf.DOMElementExtensions.toggleCssClass(Sb,
Q.lhh,qa);for(Sb=Sb.firstChild;Sb;Sb=Sb.nextSibling)Yd.a.contains(Sb.className,"resizemarqueehandle",!0)&&mf.DOMElementExtensions.toggleCssClass(Sb,Q.phh,qa)}};x.prototype.Bh=function(){this.Yhd=!1};x.prototype.hq=function(){this.Yhd=!0};Object(Oe.a)(x,"MarqueeHoveringManager",null,[]);var ud=b(946),Jh=b(1233);Em(z,G);z.prototype.dispose=function(){Ud.a.instance.za(ed.a.cV,this.oJ,Object(bd.a)(this,this.tqf,"onPointerEnter"));Ud.a.instance.za(ed.a.Hy,this.oJ,Object(bd.a)(this,this.Iwa,"onPointerLeave"));
Ud.a.instance.za(ed.a.pointerDown,this.oJ,Object(bd.a)(this,this.onPointerDown,"onPointerDown"));rg.a.instance.za(ed.a.click,this.oJ,Object(bd.a)(this,this.CAb,"onMouseClick"));rg.a.instance.za(ed.a.zj,this.oJ,Object(bd.a)(this,this.onDoubleClick,"onDoubleClick"));mf.DOMElementExtensions.ig(this.xG);this.xG=null;mf.DOMElementExtensions.ig(this.oJ);this.mu=this.oJ=null;G.prototype.dispose.call(this)};z.prototype.iWa=function(O){this.mu=Object(nf.a)(Jh.a,O.metadata)};z.prototype.tqf=function(){if(!this.mu)return Tc.ULS.shipAssertTag(537159364,
0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.mu.FAf(this.xG,!1);this.mu.eDe(this.xG,!1);if(3===this.mu.model.state)return!0;this.mu.R_e(!0);return!0};z.prototype.Iwa=function(){if(!this.mu)return!1;this.mu.zLi();this.mu.UDd(this.xG,!1);if(3===this.mu.model.state)return!0;this.mu.R_e(!1);return!0};z.prototype.onPointerDown=function(O){return this.mu?2!==O.yb||O.Xn?!1:!0:!1};z.prototype.CAb=function(){if(!this.mu)return!1;this.mu.UDd(this.xG,!0);
this.mu.FAf(this.xG,!0);this.mu.eDe(this.xG,!0);this.mu.KFb(!0);return!0};z.prototype.onDoubleClick=function(O){if(O.Ea)return O.Ea.stopPropagation(),!0;Tc.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};Object(Oe.a)(z,"RangeCatchUpActivityHighlightBehavior",G,[]);Em(B,fa);B.prototype.FPa=function(){return(this.gridView.inRangePicker||this.gridView.li)&&fa.prototype.FPa.call(this)};Ll.Object.defineProperties(B.prototype,
{B3:{configurable:!0,enumerable:!0,get:function(){return 16}},$9a:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.rangePicker.S7c(!1)}}});Object(Oe.a)(B,"RangePickerTouchGrippiesBehavior",fa,[]);Em(t,G);Object(Oe.a)(t,"RearrangeHighlightBehavior",G,[]);var bg;(function(O){O[O.topLeft=0]="topLeft";O[O.topRight=1]="topRight";O[O.bottomLeft=2]="bottomLeft";O[O.bottomRight=3]="bottomRight";O[O.error=4]="error"})(bg||(bg={}));Object(Oe.b)("Corner",bg);Em(w,G);w.prototype.dispose=
function(){var O=this;this.eK.forEach(function(qa){Ud.a.instance.za(ed.a.pointerDown,qa,Object(bd.a)(O,O.onPointerDown,"onPointerDown"))});Array.clear(this.eK);G.prototype.dispose.call(this)};w.prototype.iWa=function(O){this.z$=O;this.Vge(O);this.Xo.DGb(O,this.eK,this.YJd());this.ex.Zxa()};w.prototype.onPointerDown=function(O){O=Hg.a(this.$).He(O);if(this.DRf(O)&&!this.iQa){this.Rcf();this.pb=this.Xo.Q7c();this.hK=this.Xo.mUe(O);if(!this.pb||!this.hK||!this.hK.range)return Tc.ULS.shipAssertTag(537159361,
0,!!this.pb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),Tc.ULS.shipAssertTag(537159360,0,!!this.hK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),Tc.ULS.shipAssertTag(537159331,0,!!this.hK.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Zc=this.hK.range.clone();this.sourceRange=this.Zc.clone();this.k2=this.BQe(O);if(4===this.k2)return Tc.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;var qa=this.kSe(O,!0);if(!qa)return Tc.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.Uve(qa))return Tc.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.tJa=!0;this.pb.oD(!1);this.ex.rBe(O.Sb);this.Xo.oAf(!0,this.z$.Z8);this.pb.textBox.removeSelection();this.pb.jVb(Object(bd.a)(this,this.TXe,"handleKeyDownDuringResize"));
this.kDf();this.iQa=!0;hg.b(this.$,!0)}return!0};w.prototype.pk=function(O){O=Hg.a(this.$).He(O);O=this.kSe(O,!1);if(!O)return!0;O=this.Uve(O);if(!O)return Tc.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.q5b(!0),!1;if(this.Zc.equals(O))return!0;this.Zc=O;O=this.A6();O||(Tc.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.q5b(!0));return O};w.prototype.Ah=function(O){var qa=this;
O=Hg.a(this.$).He(O);O=this.kca();Tc.ULS.shipAssertTag(537159325,0,O,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");zf.a.aA&&(this.ga.O$b(!0),window.setTimeout(function(){qa.ga.O$b(!1)},100));this.q5b(!O);return O};w.prototype.kSe=function(O,qa){var rb=O.Sb;O=O.clientPoint;if(!rb||!O)return Tc.ULS.shipAssertTag(537159324,0,!!rb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),Tc.ULS.shipAssertTag(537159323,0,!!O,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),
null;qa&&(O=this.Agf(O));qa=this.ga.Br(O,rb,0,!0,!1,!0);qa||(O=this.Agf(O),qa=this.ga.Br(O,rb,0,!0,!1,!0));return qa};w.prototype.Agf=function(O){O.y+=this.k2&&1!==this.k2?-2:2;O.x+=this.k2&&2!==this.k2?-2:2;return O};w.prototype.Uve=function(O){if(!O||!this.sourceRange)return Tc.ULS.shipAssertTag(537159322,0,!!O,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),Tc.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(this.k2){if(1===
this.k2)return new yf.Range(O.top,this.sourceRange.left,this.sourceRange.bottom,O.right,!0,!1);if(2===this.k2)return new yf.Range(this.sourceRange.top,O.left,O.bottom,this.sourceRange.right,!0,!1);if(3===this.k2)return new yf.Range(this.sourceRange.top,this.sourceRange.left,O.bottom,O.right,!0,!1)}else return new yf.Range(O.top,O.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);Tc.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",
bg[this.k2]);return null};w.prototype.kca=function(){return this.coloredReferencesManager.ygf(this.pb,this.hK,this.Zc)};w.prototype.A6=function(){return this.kca()};w.prototype.TXe=function(){this.q5b(!0)};w.prototype.q5b=function(O){O&&Tc.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.ex.sBe(this.eK[0]);this.Xo.oAf(!1,this.z$.Z8);this.pb.textBox.setCaretPositionToEnd();this.pb.fnc(Object(bd.a)(this,
this.TXe,"handleKeyDownDuringResize"));this.g1f();this.iQa=this.gridView.tJa=!1;hg.b(this.$,!1);this.Xo.OBf()};Object(Oe.a)(w,"ResizeMarqueeBehaviorBase",G,[]);Em(v,w);v.prototype.lIf=function(){return[Q.Whh,Q.Xhh,Q.Uhh,Q.Vhh]};v.prototype.Lge=function(){return[Q.Thh]};v.prototype.BQe=function(O){O=O.Sb;if(O===this.eK[0])return 0;if(O===this.eK[1])return 1;if(O===this.eK[2])return 2;if(O===this.eK[3])return 3;Tc.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4};v.prototype.kDf=function(){this.Xo.rV(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"),!0)};v.prototype.g1f=function(){this.Xo.cQd(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"),!0)};v.prototype.DRf=function(O){return 2===(Zd.a.Tb=O.yb)&&!O.Xn};v.prototype.YJd=function(){return!0};v.prototype.Rcf=function(){Tc.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};
v.prototype.Vge=function(O){for(var qa=Ol(this.eK),rb=qa.next();!rb.done;rb=qa.next())rb.value.style.backgroundColor=O.Rm.style.borderColor};Object(Oe.a)(v,"ResizeMarqueeMouseBehavior",w,[]);Em(h,w);h.prototype.dispose=function(){Zd.a.wFf(Object(bd.a)(this,this.wAb,"onLastInputMethodChanged"));w.prototype.dispose.call(this)};h.prototype.lIf=function(){return[jg.a.ehh,jg.a.dhh]};h.prototype.Lge=function(){var O=he.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),qa=zf.a.jf;O=!O||
qa;return[O?jg.a.bIe:jg.a.aIe,jg.a.o4b,O?jg.a.chh:jg.a.n4b]};h.prototype.BQe=function(O){O=O.Sb;if(O===this.eK[0])return 0;if(O===this.eK[1])return 3;Tc.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};h.prototype.kDf=function(){zf.a.pu?this.Xo.rV(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"),!1):this.Xo.tQi(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"))};
h.prototype.g1f=function(){zf.a.pu?this.Xo.cQd(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"),!1):this.Xo.Zuj(Object(bd.a)(this,this.pk,"onPointerMove"),Object(bd.a)(this,this.Ah,"onPointerUp"))};h.prototype.DRf=function(O){return 3===(Zd.a.Tb=O.yb)};h.prototype.YJd=function(){return 3===Zd.a.Tb};h.prototype.Rcf=function(){Tc.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};h.prototype.Vge=
function(){};h.prototype.wAb=function(){var O=3===Zd.a.Tb;this.Nld&&!O?this.Xo.DGb(this.z$,this.eK,!1):!this.Nld&&O&&this.Xo.DGb(this.z$,this.eK,!0);this.Nld=O};h.prototype.kyi=function(O,qa){qa.zub===this.z$.Z8&&this.Xo.DGb(this.z$,this.eK,!qa.start&&this.YJd())};Object(Oe.a)(h,"ResizeMarqueeTouchBehavior",w,[]);Em(r,G);r.Znb=function(O,qa){var rb=document.createElement("div");rb.className=qa;O.appendChild(rb)};Object(Oe.a)(r,"SelectionCutCopyBehavior",G,[]);Em(n,G);Object(Oe.a)(n,"SelectionPasteBehavior",
G,[]);Em(l,G);l.nob=function(O,qa){var rb=document.createElement("div");rb.className=qa;O.appendChild(rb)};Object(Oe.a)(l,"SelectionRangePickerBehavior",G,[]);Em(d,fa);d.prototype.FPa=function(){var O=this.gridView.li||this.gridView.isEditing;return this.gridView.ga.wa.xh&&!O&&fa.prototype.FPa.call(this)};Ll.Object.defineProperties(d.prototype,{B3:{configurable:!0,enumerable:!0,get:function(){return 0}},$9a:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.wa.Nd}}});Object(Oe.a)(d,
"SelectionTouchGrippiesBehavior",fa,[]);var xj=zc.a;Em(e,xj);e.prototype.dispose=function(){this.gridView.Kb.oUi(Object(bd.a)(this,this.wlb,"attachBehavior"));this.ex&&(this.ex.dispose(),this.ex=null);xj.prototype.dispose.call(this)};e.prototype.wlb=function(O,qa){O=qa.B3;var rb=this.gridView;qa=qa.VRh;var Sb=qa.Rm,Uc=qa.J8;zf.a.ah&&Array.add(Uc,new y(Sb,rb));switch(O){case 24:Array.add(qa.J8,new z(Sb,qa));break;case 0:Array.add(qa.J8,new J(Sb,rb));zf.a.tr||Array.add(Uc,new E(Sb,this.gridView.$,qa.paneType,
this.tableManager,this.Xo));Array.add(Uc,new d(qa,Sb,rb,qa.paneType));break;case 3:Array.add(Uc,new L(Sb));zf.a.tr||(Array.add(Uc,new H(Sb,this.gridView.$,qa.paneType,this.ex,this.Xo,qa)),Array.add(Uc,new v(Sb,this.gridView,this.ex,this.Xo,qa)),Array.add(Uc,new h(Sb,this.gridView,this.ex,this.Xo,qa)));break;case 4:case 5:Array.add(Uc,new r(Sb));break;case 30:Array.add(Uc,new n(Sb));break;case 16:Array.add(Uc,new l(Sb));Array.add(Uc,new B(qa,Sb,rb,qa.paneType));break;case 11:case 12:Array.add(Uc,new t(Sb,
11===O));break;case 17:Array.add(Uc,new L(Sb));break;case 19:Array.add(Uc,new L(Sb)),Array.add(Uc,new aa(qa,Sb,rb,qa.paneType))}qa.oXb=!0};Object(Oe.a)(e,"GridHighlightsBehaviorManager",zc.a,[]);var xi=xf.a;Em(a,xi);a.prototype.create=function(){var O=this;sg.TaskExtensions.Aa(ig.GetServiceTaskFactory.create(this.$.ea,134,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),function(qa){O.Eb(O.$.ea.Ba(64)||new e(O.$,qa.result))},this.la,3)};a.ja=function(O){O.ea.Ia(149,new a(O))};
Object(Oe.a)(a,"GridHighlightsBehaviorManagerFactory",xf.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");Wd.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.NewAndOpen.Core");Ob.a.instance.ej(new fc);Ef.a.Li('.ewr-selection-draghandle{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-top-ie{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-ie{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-ie{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-ie{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:27px;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
Ef.a.Li('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{height:14px;top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
Ef.a.Li(".ewa-svg-icon{height:100%;width:100%}");Ef.a.Li(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
je.a.Ga(lf.ja);og.a.Ji.Ia(141,new Ee);je.a.Ga(Vc.ja);(function(){je.a.Ga(function(O){Id.ja(O);he.EwaSettings.GG()?Pc.ja(O):rd.ja(O);Lb.ja(O);yd.ja(O)})})();je.a.Ga(gc.ja);je.a.Ga(Qa.ja);(function(){je.a.Ga(function(O){O.ea.Ia(134,new Hb(O));O.ea.Ia(330,new $a(O))})})();je.a.Ga(zb.ja);(function(){je.a.Ga(function(O){ab.ja(O);Yb.ja(O)})})();Type.registerNamespace("Common.App.SessionExpiration");je.a.Ga(U.ja);je.a.Ga(a.ja);je.a.Ga(V.ja)}}]);

//# sourceMappingURL=EwaDS.acc.js.map