(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1072:function(C,F,b){function a(y,J){this.$=J;this.zfc=y;this.fa=J.fa;this.fa.Yj(Object(l.a)(this,this.Vc,"onSessionIdChanged"));this.R9=z.a.uke(this.$)}function e(y){this.Ui=this.Pxc=null;this._state=0;this.sf=y;this.Rt=this.xK;this.moveNext()}b.r(F);C=b(0);var d=b(15),l=b(37),n=b(35),r=b(195),h=b(126),v=b(32),w=b(1),t=b(64),B=b(51);e.prototype.xK=function(){this.Pxc=this.sf.$.Vb.Dc("LoadResource","DownloadACopyOperation");
return this.vTd};e.prototype.vTd=function(){var y=b(1072).DownloadACopyOperation;if(this.sf.R9.o0e||!(this.Pxc.Cc<y.Ufc))return this.J6f;this.Ui=B.Task.delay(y.gBe).g();this.Ui.isCompleted||(this._state=2,this.Ui.xM(Object(l.a)(this,this.moveNext,"moveNext")));return this.Hcb};e.prototype.J6f=function(){var y=b(1072).DownloadACopyOperation;this.Pxc.Cc>=y.Ufc&&d.ULS.sendTraceTag(537154819,0,15,"Download did not complete after 10 seconds.");t.a(this.sf.$).fd.GI();this._state=3};e.prototype.Hcb=function(){this.Ui.oy();
return this.vTd};e.prototype.dispose=function(){};e.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.Rt=this.Rt()}catch(y){this.dispose(),this._state=3}};Object(C.a)(e,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[6]);var z=b(1165),x=b(133);b.d(F,"DownloadACopyOperation",function(){return a});a.prototype.o5g=function(){var y=this,J=this.pFg(this.$),E=this.$.userOperationManager.operationCount;0<E&&d.ULS.sendTraceTag(537154822,
0,15,"flushing queue in downloadcopy. Queue is {0}",E);this.$.userOperationManager.Z9("DownloadACopyOperation.DownloadForkedFile");this.zfc&&d.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.R9.downloadFile(J,-21742208);w.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?n.TaskExtensions.Aa(B.Task.delay(1),function(){y.n0e()},this.R9.la,3):n.TaskExtensions.Aa(B.Task.delay(1),function(){y.XSh()},
this.R9.la,3)};a.prototype.dispose=function(){this.fa&&this.fa.qk(Object(l.a)(this,this.Vc,"onSessionIdChanged"));this.$=this.fa=null};a.prototype.n0e=function(y){var J=this;(y=void 0===y?null:y)||(y=this.$.Vb.Dc("LoadResource","DownloadACopyOperation"));!this.R9.o0e&&y.Cc<a.Ufc?window.setTimeout(function(){J.n0e(y)},a.gBe):(y.Cc>=a.Ufc&&d.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),t.a(this.$).fd.GI())};a.prototype.XSh=function(){new e(this)};a.prototype.pFg=function(y){var J=
new Sys.StringBuilder,E=y.workbookContext,A=y.ya;J.append(y.gca);J.append(A.FileHandlerRelativeUri);J.append("?id=");J.append(encodeURIComponent(r.a.WDb(E.WorkbookUri,"sc")));y.fa.lc&&(J.append("&sessionId="),J.append(encodeURIComponent(y.fa.sessionId)));J.append("&workbookType=FullForkedWorkbook");J.append("&dataloss=");J.append(this.zfc?"true":"false");h.a.dEa(J,A);return J.toString()};a.prototype.Vc=function(){v.a.rg(t.a(this.$).fd.activityState,x.a.ksd)||this.R9.reset()};a.Ufc=1E5;a.gBe=100;Object(C.a)(a,
"DownloadACopyOperation",null,[6])},1157:function(C,F,b){function a(r,h){r=n.call(this,r,h)||this;e.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");r.title="";r.message=a.Nva;r.VIa=!0;return r}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(48),l=b(78);b=b(812);var n=b.a;Em(a,n);a.prototype.nka=function(r){n.prototype.nka.call(this,r);d.a.openWindow(4,l.a.lG(a.gef))};a.prototype.NJ=function(r){n.prototype.NJ.call(this,r);a.xod&&a.xod(null)};
a.initialize=function(r,h,v,w){e.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");a.Nva=r;a.hef=h;a.gef=v;a.xod=w};Ll.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.hef}}});a.Nva=null;a.hef=null;a.gef=null;a.xod=null;Object(C.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1158:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);a.r$g="ewa-bb";a.t$g="ewa-bb-entry";a.u$g="ewa-bb-entry-body";a.A$g=
"ewa-bb-icon";a.w$g="ewa-bb-entry-icon";a.z$g="ewa-bb-entry-title";a.y$g="ewa-bb-entry-message";a.tEe="ewa-bb-entry-button";a.x$g="ewa-bb-entry-link";a.v$g="ewa-bb-entry-close";a.uEe="ewa-bb-entry-button-holder";a.G3c="ewa-nov2-ltr";a.s$g="ewa-bb-content";a.I3c="ewa-nov2-rtl";Object(C.a)(a,"CssClassNames",null,[])},1159:function(C,F,b){function a(d,l){d=e.call(this,d,l)||this;d.tG=!0;d.title=a.jna;d.message=a.hna;return d}b.d(F,"a",function(){return a});C=b(0);b=b(812);var e=b.a;Em(a,e);a.prototype.cq=
function(d){e.prototype.cq.call(this,d);(d=a.ina)&&d(null)};a.initialize=function(d,l,n,r){a.jna=d;a.hna=l;a.gna=n;a.ina=r};Ll.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.gna}}});a.jna=null;a.hna=null;a.gna=null;a.ina=null;Object(C.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1160:function(C,F,b){function a(d,l){d=e.call(this,d,l)||this;d.tG=!0;d.title=a.jna;d.message=a.hna;return d}b.d(F,"a",function(){return a});C=b(0);b=
b(812);var e=b.a;Em(a,e);a.prototype.cq=function(d){e.prototype.cq.call(this,d);(d=a.ina)&&d(null)};a.initialize=function(d,l,n,r){a.jna=d;a.hna=l;a.gna=n;a.ina=r};Ll.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.gna}}});a.jna=null;a.hna=null;a.gna=null;a.ina=null;Object(C.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1161:function(C,F,b){function a(d,l){d=e.call(this,d,l)||this;d.tG=!0;d.title=a.jna;d.message=a.hna;return d}
b.d(F,"a",function(){return a});C=b(0);b=b(812);var e=b.a;Em(a,e);a.prototype.cq=function(d){e.prototype.cq.call(this,d);(d=a.ina)&&d(null)};a.initialize=function(d,l,n,r){a.jna=d;a.hna=l;a.gna=n;a.ina=r};Ll.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.gna}}});a.jna=null;a.hna=null;a.gna=null;a.ina=null;Object(C.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1162:function(C,F,b){function a(d,l){d=e.call(this,d,l)||this;d.tG=!0;
d.title=a.qyb;d.message=a.Nva;return d}b.d(F,"a",function(){return a});C=b(0);b=b(812);var e=b.a;Em(a,e);a.prototype.cq=function(d){e.prototype.cq.call(this,d);a.Pva&&a.Pva(null)};a.initialize=function(d,l,n,r){a.qyb=d;a.Nva=l;a.n5a=n;a.Pva=r};Ll.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.n5a}}});a.qyb=null;a.Nva=null;a.n5a=null;a.Pva=null;Object(C.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1163:function(C,
F,b){function a(d,l){d=e.call(this,d,l)||this;a.n5a&&a.Pva&&(d.tG=!0);d.title=a.qyb;d.message=a.Nva;return d}b.d(F,"a",function(){return a});C=b(0);b=b(812);var e=b.a;Em(a,e);a.prototype.cq=function(d){e.prototype.cq.call(this,d);a.Pva&&a.Pva(null)};a.initialize=function(d,l,n,r){a.qyb=d;a.Nva=l;a.n5a=n;a.Pva=r};Ll.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.n5a}}});a.qyb=null;a.Nva=null;a.n5a=null;a.Pva=null;Object(C.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",
b.a,[])},1164:function(C,F,b){function a(r,h,v,w,t,B){this.WW=r;this.XW=h;this.gEc=v;this.TC=w;this.LNb=t;this.jSa=B}b.d(F,"a",function(){return a});C=b(0);var e=b(1221),d=b(5),l=b(50),n=b(88);a.prototype.mNi=function(r){this.ljf(r)};a.prototype.fai=function(r){this.ljf(r)};a.prototype.ljf=function(r){var h=10;1===r?(n.a.instance.resolve("Common.IOfficeTrialExperience").xec(this.jSa),h=3):2===r&&((!this.gEc||this.gEc(this.TC))&&this.XW&&e.a.instance.XVg(this.XW,this.WW,this.TC),h=5);r&&1!==r||this.WW&&
this.WW(this.TC);d.AFrameworkApplication.Jnc(l.a.Auf,this.LNb,h);this.dispose()};a.prototype.dispose=function(){this.TC=this.XW=this.WW=null};Ll.Object.defineProperties(a.prototype,{hTf:{configurable:!0,enumerable:!0,get:function(){return!this.XW&&!this.gEc}},Uif:{configurable:!0,enumerable:!0,get:function(){return 2===this.jSa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},UDe:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},c0e:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},cua:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},QZe:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},TTb:{configurable:!0,enumerable:!0,get:function(){return 2===this.jSa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:
CommonUIStrings.l_OICErrorC2RInstallButton}},Kn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(C.a)(a,"AOICErrorDialogWithTrial",null,[6])},1165:function(C,F,b){function a(z,x){var y=B.call(this,z)||this;y.Tzj=["id","sessionId","workbookType","workbookFileType","dataloss"];y.command=0;y.iframe=z;y.$=x;y.rc.ja("load",Object(l.a)(y,y.nAb,"onFrameLoad"));return y}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(48),l=b(37);F=b(230);var n=b(195),
r=b(39),h=b(6),v=b(33),w=b(64),t=b(602),B=F.a;Em(a,B);a.prototype.downloadFile=function(z,x){var y={};(z=this.bkh(z,y))&&d.a.Rkc("dlfr",z,y);this.command=x};a.prototype.bkh=function(z,x){var y=z.split("?");if(2!==y.length)return z=null,e.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),z;y=y[1].split("&");y=Ol(y);for(var J=y.next();!J.done;J=y.next()){var E=J.value.split("=",2);if(2!==E.length){z=null;e.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}J=E[0];Array.contains(this.Tzj,J)&&(E=decodeURIComponent(E[1]),x[J]=E,z=n.a.WDb(z,J))}return z};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.nAb=function(){var z=this.izh();if(z){this.$.mH(!0);if(-2028960985!==this.command&&1461300262!==this.command){var x=w.a(this.$).fd.activityState;x[v.a.CVa]=h.a.download;x[t.a.hOc]=
this.command}r.a(this.$).Gs(z.Errors)}};a.prototype.izh=function(){try{return this.iframe.contentWindow.ewaResult}catch(x){if(!this.$.fa.ic.isDivSyndicated){var z=window.document.referrer.match(RegExp("://(.[^/]+)/"));e.ULS.sendTraceTag(537154785,0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<z.length?z[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.Hua);throw x;}return null}};a.uke=
function(z){var x=document.createElement("iframe");x.id="ewaFileLoader";x.style.cssText="height:0;width:0;display:none";x.src="about:blank";x.setAttribute("name","dlfr");x=z.domElement.appendChild(x);return new a(x,z)};Ll.Object.defineProperties(a.prototype,{o0e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(C.a)(a,"FileLoader",F.a,[])},1166:function(C,F,b){function a(){this.BaseDocQuerySignature=
null;this.RoamingApp=0}b.d(F,"a",function(){return a});C=b(0);var e=b(1323),d=b(5),l=b(41),n=b(78);a.prototype.IGd=function(){return l.c([this.Mha(),this])};a.prototype.execute=function(r,h,v){var w="RoamingAppsHandler.ashx";e.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=n.a.$k(w,"wdEnableRoaming","1"));d.AFrameworkApplication.Cd.Jl(w,2,this.IGd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.b1a(),r,h,v,void 0,void 0,void 0,void 0,"6")};
Object(C.a)(a,"ARoamingAppsRequest",null,[])},1169:function(C,F,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}b.d(F,"a",function(){return a});C=b(0);Object(C.a)(a,"PrintPreviewPaneProps",null,[])},1214:function(C,F,b){function a(lc,Ec){Ec=P.call(this,Ec)||this;Ec.Moh=N.DOMElementExtensions.gp+",div";Ec.j2=Array(64);
Ec.hm=!1;Ec.ub=lc;Ec.set_visible(!1);Ec.addCssClass(V.a.r$g);S.KeyInputManager.instance.pa(Q.a.Qb,Ec.Ib,Object(G.a)(Ec,Ec.TU,"onKeyEvent"));U.a(lc).Og(Ec);return Ec}function e(lc,Ec){lc=uc.call(this,lc,Ec)||this;lc.message="";return lc}function d(lc,Ec){lc=lb.call(this,lc,Ec)||this;lc.jAa=ha.a.B0b();lc.tG=!0;lc.Wta=lc.jAa.bAj;lc.title=lc.jAa.title;lc.message=lc.jAa.message;return lc}function l(lc,Ec){lc=kb.call(this,lc,Ec)||this;lc.tG=!0;lc.title="";return lc}function n(lc,Ec){Ec=Ha.call(this,lc,
Ec)||this;Ec.policyManager=lc.$.ea.Ba(274);if(!Ec.policyManager)return H.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),Ec;Ec.message=Ec.policyManager.Ekc;Ec.title=Ec.policyManager.title;Ec.VIa=!0;return Ec}function r(lc,Ec){lc=Ka.call(this,lc,Ec)||this;lc.tG=!0;lc.Wta=!0;return lc}function h(lc,Ec,tc,cc){lc=ta.call(this,lc,Ec)||this;lc.Rtb=tc;lc.command=cc;lc.VIa=!0;lc.tG=!0;return lc}function v(lc,Ec,tc){lc=ea.call(this,
lc,Ec)||this;lc.Rtb=tc;lc.VIa=!0;return lc}function w(lc,Ec,tc){lc=ab.call(this,lc,Ec)||this;lc.Rtb=tc;lc.tG=!0;return lc}function t(lc,Ec){lc=xb.call(this,lc,Ec)||this;lc.tG=!0;lc.Wta=!1;return lc}function B(lc,Ec){lc=pb.call(this,lc,Ec)||this;lc.tG=!0;lc.Wta=!0;return lc}function z(lc,Ec,tc,cc,Zb,Aa,Ia){return x.call(this,lc,0,Ec,tc,cc,Zb,Aa,Ia)||this}function x(lc,Ec,tc,cc,Zb,Aa,Ia,qb){this.hI=this.P6=this.uW=0;this.D$f=lc;this.rqj=Ec;this.ZN=tc;this.Ndg=Ia;this.Hfb=W.a.jv(qb);this.Sbg=qb;cc&&
(this.uW=cc);Zb&&(this.P6=Zb);Aa&&(this.hI=Aa)}function y(lc,Ec,tc,cc,Zb){lc=J.call(this,lc,Ec,tc,cc)||this;lc.command=Zb;lc.Wta=!0;return lc}function J(lc,Ec,tc,cc){lc=xa.call(this,lc,Ec)||this;lc.error=tc;lc.options=cc;lc.error&&lc.options&2&&(lc.message=lc.error.Description);lc.error&&lc.options&1&&(lc.title=lc.error.Caption);lc.tG=!(cc&4);return lc}function E(lc,Ec,tc){return A.call(this,lc,Ec,tc)||this}function A(lc,Ec,tc){lc=na.call(this,lc,Ec)||this;lc.tG=!0;lc.command=tc;return lc}b.r(F);
C=b(0);var H=b(15),S=b(117),Q=b(13),L=b(90),aa=b(86),fa=b(50),W=b(30),G=b(37),N=b(11),Y=b(230),V=b(1158),da=b(4),U=b(257),Z=b(1159),ca=b(812),ra=b(1239),La=b(92),na=ca.a;Em(A,na);A.prototype.cq=function(lc){na.prototype.cq.call(this,lc);this.businessBar.$.Ka.Ub(new La.a(this.command,lc,this.businessBar.$.dd,10,null))};Object(C.a)(A,"CommandActionBusinessBarEntry",ca.a,[]);Em(E,A);E.prototype.NJ=function(lc){A.prototype.NJ.call(this,lc)};Object(C.a)(E,"EditAttemptReadOnlyBusinessBarEntry",A,[]);var ma=
b(39),xa=ca.a;Em(J,xa);J.prototype.cq=function(lc){xa.prototype.cq.call(this,lc);this.error.Appearance&=-33;ma.a(this.businessBar.$).Gs([this.error])};Object(C.a)(J,"ErrorBusinessBarEntry",ca.a,[]);Em(y,J);y.prototype.fka=function(lc){J.prototype.fka.call(this,lc);this.businessBar.$.Ka.Ub(new La.a(this.command,lc,this.businessBar.$.dd,10,null))};Object(C.a)(y,"ErrorAndCommandBusinessBarEntry",J,[]);var Pa=b(16);x.da=function(lc){return Pa.a.instance.da(lc)};Ll.Object.defineProperties(x.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return x.da(this.rqj)}},message:{configurable:!0,enumerable:!0,get:function(){return x.da(this.ZN)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.ZN}},dmb:{configurable:!0,enumerable:!0,get:function(){return this.D$f}},actionButton:{configurable:!0,enumerable:!0,get:function(){return x.da(this.uW)}},aWb:{configurable:!0,enumerable:!0,get:function(){return x.da(this.P6)}},link:{configurable:!0,enumerable:!0,get:function(){return x.da(this.hI)}},
Nj:{configurable:!0,enumerable:!0,get:function(){return this.Ndg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.Hfb}},alt:{configurable:!0,enumerable:!0,get:function(){var lc=b(1214).BusinessBarControl;switch(this.Nj){case lc.TGa:return x.da(26);case lc.gF:return x.da(25);case lc.dk:return x.da(24);default:return x.da(0)}}},Z2c:{configurable:!0,enumerable:!0,get:function(){return this.Sbg}}});Object(C.a)(x,"EwaBusinessBarEntry",null,[]);Em(z,x);Ll.Object.defineProperties(z.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(C.a)(z,"EwaNoTitleBusinessBarEntry",x,[]);var ib=b(68),pb=ca.a;Em(B,pb);B.prototype.cq=function(lc){pb.prototype.cq.call(this,lc);this.set_visible(!1);this.businessBar.$.qH();this.businessBar.$.Ka.Ub(new La.a(1038998010,lc,this.businessBar.$.dd,10,null))};B.prototype.fka=function(lc){pb.prototype.fka.call(this,lc);this.businessBar.$.Ka.Ub(new La.a(-722953877,lc,this.businessBar.$.dd,10,null))};B.prototype.NJ=function(lc){this.businessBar.removeEntry(53);
ib.g(lc)};Object(C.a)(B,"ExternalLinksEnableContentBusinessBarEntry",ca.a,[]);var xb=ca.a;Em(t,xb);t.prototype.cq=function(lc){xb.prototype.cq.call(this,lc);this.businessBar.$.Ka.Ub(new La.a(-722953877,lc,this.businessBar.$.dd,10,null))};t.prototype.NJ=function(lc){this.businessBar.removeEntry(5);ib.g(lc)};Object(C.a)(t,"ExternalLinksShowErrorBusinessBarEntry",ca.a,[]);var Ya=b(9),ab=ca.a;Em(w,ab);w.prototype.cq=function(lc){ab.prototype.cq.call(this,lc);Ya.HelperMethods.$aa(this.businessBar.$.QH,
this.Rtb,this.businessBar.$.nW)};Object(C.a)(w,"HelpButtonBusinessBarEntry",ca.a,[]);var ea=ca.a;Em(v,ea);v.prototype.nka=function(lc){ea.prototype.nka.call(this,lc);Ya.HelperMethods.$aa(this.businessBar.$.QH,this.Rtb,this.businessBar.$.nW)};Object(C.a)(v,"HelpTextBusinessBarEntry",ca.a,[]);var ta=ca.a;Em(h,ta);h.prototype.cq=function(lc){ta.prototype.cq.call(this,lc);this.businessBar.$.Ka.Ub(new La.a(this.command,lc,this.businessBar.$.dd,10,null))};h.prototype.nka=function(lc){ta.prototype.nka.call(this,
lc);var Ec=new La.a(-859308420,lc,this.businessBar.$.dd,12,null),tc={};lc=(tc.CommandValueId="HelpID="+this.Rtb,tc.InputMethod=lc,tc.MenuItemId=da.a.AY,tc.EnabledInViewMode=!0,tc);this.businessBar.$.Ka.Ub(Ec,lc)};Object(C.a)(h,"HelpTextTaskPaneAndCommandBusinessBarEntry",ca.a,[]);var Ka=ca.a;Em(r,Ka);r.prototype.cq=function(lc){Ka.prototype.cq.call(this,lc);this.set_visible(!1);this.businessBar.$.qH();this.businessBar.$.Ka.Ub(new La.a(-1081442996,lc,this.businessBar.$.dd,10,null))};r.prototype.fka=
function(lc){Ka.prototype.fka.call(this,lc);this.businessBar.$.Ka.Ub(new La.a(1702917262,lc,this.businessBar.$.dd,10,null))};r.prototype.NJ=function(lc){this.businessBar.removeEntry(57);ib.g(lc)};Object(C.a)(r,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ca.a,[]);var mb=b(1161),Ha=ca.a;Em(n,Ha);n.prototype.nka=function(lc){Ha.prototype.nka.call(this,lc);(lc=this.policyManager.Evi)&&lc(null)};Ll.Object.defineProperties(n.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});
Object(C.a)(n,"PolicyBusinessBarEntry",ca.a,[]);var Ga=b(1160),Fa=b(1163),eb=b(1162);b(405);var db=b(174),Na=b(28),kb=ca.a;Em(l,kb);l.prototype.cq=function(lc){kb.prototype.cq.call(this,lc);db.c(Na.a.Dki);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(C.a)(l,"UnsupportedBrowserBusinessBarEntry",ca.a,[]);var Tb=b(1157),ha=b(1255),lb=ca.a;Em(d,lb);d.prototype.cq=function(lc){lb.prototype.cq.call(this,lc);this.jAa.okf(null)};d.prototype.fka=function(lc){lb.prototype.fka.call(this,
lc);this.jAa.rkf(null)};d.prototype.NJ=function(lc){lb.prototype.NJ.call(this,lc);this.jAa.Xze(null)};Ll.Object.defineProperties(d.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.jAa.$me}},aWb:{configurable:!0,enumerable:!0,get:function(){return this.jAa.bne}}});Object(C.a)(d,"WildFireMobileAppBusinessBarEntry",ca.a,[]);var Wa=b(245),Ra=b(7),Yb=b(238),oc=b(165),zb=b(47),uc=ca.a;Em(e,uc);Object(C.a)(e,"OfficeScriptsRunningBusinessBarEntry",ca.a,[]);b.d(F,"BusinessBarControl",
function(){return a});var P=Y.a;Em(a,P);a.prototype.TU=function(lc){if(lc.Ea.keyCode===L.a.PC){var Ec=this.Ib.querySelectorAll(this.Moh),tc=N.DOMElementExtensions.ql(Ec);Ec=N.DOMElementExtensions.ny(Ec);return N.DOMElementExtensions.ica(lc.Ea,tc,Ec)}return!1};a.prototype.Le=function(lc,Ec){Ec||N.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Ec};a.prototype.rh=function(lc){return N.DOMElementExtensions.Ue(this.Ib,lc)};a.prototype.Uh=function(){};a.prototype.Nh=function(){};a.prototype.dispose=
function(){this.hm||(S.KeyInputManager.instance.za(Q.a.Qb,this.Ib,Object(G.a)(this,this.TU,"onKeyEvent")),aa.a.mc(this.j2),this.j2=Array(64),this.ub=null,P.prototype.dispose.call(this),this.hm=!0)};a.prototype.bKa=function(lc){if(!this.get_visible())return!1;lc=this.j2[lc];return!!lc&&lc.isVisible};a.prototype.tD=function(lc){return!!this.j2[lc]};a.prototype.fD=function(lc,Ec,tc){tc=void 0===tc?null:tc;var cc=!1;if(this.tD(lc))tc=this.j2[lc].get_visible();else{this.set_visible(!0);var Zb=a.jWe()[lc];
this.j2[lc]=this.n9(lc,Ec,tc);tc=!1;cc=!0;var Aa="",Ia=0;Ec&&(Aa=Ec.MessageIdName,Ia=Ec.MessageId);var qb=Zb.Z2c;H.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",lc,zb.PageLoadTrackingInfo.instance.Eta(new Date));oc.a(this.$).hDd(Zb.hash,Aa,Ia,fa.a.nvc,!0,1,Ec,qb)}tc||!Array.contains(ra.a.Y8b(),lc)&&!cc||(this.j2[lc].set_visible(!0),this.$.qH())};a.prototype.removeEntry=function(lc){return this.lSi(lc)};a.prototype.lBd=function(){aa.a.mc(this.j2);
this.j2=Array(64);this.set_visible(!1)};a.prototype.lSi=function(lc){if(!this.tD(lc))return!1;aa.a.Fa(this.j2[lc]);this.j2[lc]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.qH();return!0};a.prototype.n9=function(lc,Ec,tc){tc=void 0===tc?null:tc;var cc=a.jWe()[lc],Zb=!!(this.$.zd&64);switch(lc){case 2:case 4:case 23:case 25:case 26:case 35:case 34:lc=new ca.a(this,cc);break;case 12:case 29:case 30:case 31:case 32:case 55:lc=Zb?new A(this,cc,-8805455):new ca.a(this,cc);break;case 22:lc=
new E(this,cc,-8805455);break;case 44:case 43:lc=Zb?new y(this,cc,Ec,0,-8805455):new J(this,cc,Ec,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:lc=new J(this,cc,Ec,0);break;case 19:lc=new ca.a(this,cc);break;case 45:lc=new J(this,cc,Ec,0);break;case 6:case 14:lc=new w(this,cc,Ec.HelpTopicId);break;case 36:lc=new v(this,cc,da.a.e_g);break;case 16:lc=new ca.a(this,cc);lc.title=W.a.Xf(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);lc.message=W.a.Xf(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);
break;case 18:lc=new A(this,cc,-1762562205);lc.e$b=!0;break;case 20:lc=new d(this,cc);break;case 21:case 54:lc=new ca.a(this,cc);break;case 28:lc=new ca.a(this,cc);break;case 24:lc=new l(this,cc);break;case 27:lc=new n(this,cc);break;case 37:lc=new Tb.a(this,cc);break;case 38:lc=new Z.a(this,cc);break;case 39:lc=new Ga.a(this,cc);break;case 40:lc=new mb.a(this,cc);break;case 46:lc=new ca.a(this,cc);break;case 47:lc=new ca.a(this,cc);break;case 48:lc=new ca.a(this,cc);break;case 49:lc=new ca.a(this,
cc);break;case 50:lc=new ca.a(this,cc);break;case 51:lc=new eb.a(this,cc);break;case 52:lc=new Fa.a(this,cc);break;case 53:lc=new B(this,cc);break;case 5:lc=new t(this,cc);break;case 56:lc=new A(this,cc,-1753056834);Ec?(Ec=Ec.Directive,Ra.a.nn(Ec)||"&nbsp;"===Ec||(lc.message=Ec)):Ra.a.ma(tc)||(lc.message=tc);break;case 57:lc=new r(this,cc);break;case 58:lc=new ca.a(this,cc);break;case 59:case 62:lc=new v(this,cc,da.a.omi);break;case 60:lc=new h(this,cc,da.a.SAg,-8805455);break;case 61:lc=new A(this,
cc,515196233);break;case 63:lc=new e(this,cc);break;default:lc=new J(this,cc,Ec,7)}lc.LYc();return lc};a.jWe=function(){var lc=Yb.a.s3a()?247:246;return a.Rme||(a.Rme=[new x(0,262,263,264,0,0,a.TGa,"BB_UnableToRefreshLock"),new x(1,262,263,264,0,0,a.TGa,"BB_UnableToRefreshLockExpected"),new x(2,254,255,0,0,0,a.gF,"BB_WorkbookAlmostTooLarge"),new x(3,256,257,258,0,0,a.TGa,"BB_WorkbookTooLarge"),new x(4,245,lc,0,0,0,a.gF,"BB_ExternalWorkbookLinksDisabled"),new x(5,249,248,250,0,0,a.TGa,"BB_ExternalWorkbookLinksShowError"),
new x(6,251,252,253,0,0,a.dk,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new x(7,237,238,239,0,0,a.dk,"BB_UnsupportedFeatures"),new x(8,0,0,0,0,0,a.dk,"BB_CollabDataAndDataStringsLocaleMismatch"),new x(9,0,0,0,0,0,a.dk,"BB_CollabDataStringsLocaleMismatch"),new x(10,0,0,0,0,0,a.dk,"BB_CollabDataLocaleMismatch"),new x(11,265,266,267,0,0,a.TGa,"BB_LastGenericStatusError"),new x(12,268,269,270,0,0,a.gF,"BB_ScratchPadWarning"),new x(13,271,272,273,0,0,a.TGa,"BB_AuthenticationLost"),new x(14,274,275,276,
0,0,a.gF,"BB_OdfCompatibilityIssues"),new x(15,0,553,0,0,0,a.gF,"BB_PivotChartInteractivityMissingWarning"),new x(16,0,0,0,0,0,a.dk,"BB_WorkbookIsIrmProtected"),new x(17,0,0,0,0,0,a.dk,"BB_BIFeatureNotAvailable"),new x(18,277,278,273,0,0,a.gF,"BB_AnonymousCreateMode"),new x(19,240,241,0,0,0,a.gF,"BB_UnsupportedInteractiveReportEditing"),new x(20,0,0,0,0,0,a.dk,"BB_MobileAppCampaignBizBar"),new x(21,283,284,0,0,0,a.dk,"BB_TransientServerCommunicationFailures"),new x(22,1572,1583,1584,0,0,a.dk,"BB_EditAttemptInReadOnly"),
new x(23,1572,1583,0,0,0,a.dk,"BB_EditAttemptInReadOnlyNoEditPermissions"),new x(24,0,Ya.HelperMethods.Evj(),1561,0,0,a.dk,"BB_UnsupportedBrowser"),new x(25,286,287,0,0,0,a.dk,"BB_ReadOnlyPermissions"),new x(26,288,289,0,0,0,a.dk,"BB_DocumentIsIrmProtectedWarning"),new x(27,0,0,0,0,0,a.gF,"BB_PolicyWarningMessage"),new x(28,1220,285,0,0,0,a.dk,"BB_WorkingOnIt"),new x(29,1572,1570,1571,0,0,a.dk,"BB_PasswordProtectedWorkbookLockedForEdit"),new x(30,1585,1586,1587,0,0,a.dk,"BB_WorkbookIsReadOnlyRecommended"),
new x(31,1572,1588,1589,0,0,a.dk,"BB_WorkbookHasPasswordToModify"),new x(32,1572,1590,1593,0,0,a.dk,"BB_LegacySharedWorkbookEditWarning"),new x(33,1580,1591,239,0,0,a.dk,"BB_LegacyConnectionsWarning"),new x(34,1581,1582,0,0,0,a.dk,"BB_GroupedSlicers"),new x(35,299,300,0,0,0,a.gF,"BB_ThirdPartyAddinDisabled"),new x(36,1713,1714,0,0,1715,a.dk,"BB_FinanceLinkedEntityDisclaimerBar"),new x(37,0,0,0,0,0,a.dk,"BB_WacGdprNotice"),new x(38,0,0,0,0,0,a.dk,"BB_AutomaticSensitivityLabel"),new x(39,0,0,0,0,0,
a.dk,"BB_RecommendedSensitivityLabel"),new x(40,0,0,0,0,0,a.dk,"BB_MandatorySensitivityLabel"),new x(41,301,302,303,0,0,a.dk,"BB_LocalStorageDisabled"),new x(42,610,611,0,0,0,a.dk,"BB_AutoRefreshDisabled"),new x(43,961,959,963,1249,0,a.dk,"BB_CorruptedFileRepaired"),new x(44,962,960,963,1249,0,a.dk,"CorruptedOdsFileRepaired"),new x(45,259,260,261,0,0,a.gF,"BB_MinorVersionLimitReached"),new x(46,290,291,0,0,0,a.gF,"BB_SensitivityApplicationGenericError"),new x(47,292,294,0,0,0,a.gF,"BB_SensitivityApplicationTooLargeFileError"),
new x(48,293,294,0,0,0,a.gF,"BB_SensitivityApplicationLabelNotSupportedError"),new x(49,295,296,0,0,0,a.gF,"BB_SensitivityApplicationLabelDisabledError"),new x(50,297,298,0,0,0,a.gF,"BB_SensitivityApplicationMandatoryConflictError"),new x(51,0,0,0,0,0,a.gF,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new x(52,0,0,0,0,0,a.gF,"BB_SensitivityApplicationSetLabelError"),new x(53,2027,2028,2029,2032,0,a.dk,"BB_ExternalWorkbookLinksPromptEnableContent"),new x(54,283,284,0,0,0,a.dk,"BB_NetworkDown"),
new x(55,304,305,306,0,0,a.dk,"BB_DefaultToViewDueToCogs"),new x(56,1739,1740,1741,0,0,a.dk,"BB_RefreshLinkedEntityErrorBar"),new x(57,1716,1717,1718,1719,0,a.dk,"BB_LinkedEntitiesUntrustedImagesDisabled"),new z(58,236,0,0,0,a.dk,"BB_CanvasHealth"),new x(59,307,308,0,0,309,a.dk,"BB_NovModeDepreciation"),new x(60,964,965,1249,0,966,a.dk,"BB_MismatchedFileFormatConverted"),new x(61,2131,2132,2133,0,0,a.dk,"BB_OptimizeWorkbook"),new x(62,310,311,0,0,312,a.dk,"BB_NovModePostDepreciation"),new x(63,2169,
0,0,0,0,a.dk,"BB_OfficeScriptsRunning")])};Ll.Object.defineProperties(a.prototype,{Vd:{configurable:!0,enumerable:!0,get:function(){return Wa.a.mTc}},Ib:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.ub}}});a.TGa="ewa-mb-error";a.gF="ewa-mb-warning";a.dk="ewa-mb-info";a.Rme=null;Object(C.a)(a,"BusinessBarControl",Y.a,[120])},
1221:function(C,F,b){function a(){this.ggb=!!t.AFrameworkApplication.xa&&t.AFrameworkApplication.xa.Xa.qu}function e(A,H,S){var Q=n.call(this,A,H,S)||this;A={};A=(A.errorMessage=Q.VDe,A.errorFileDownloadOffer=Q.aqb,A);H={};A.helpLink=(H.type="AppLinkProps",H.id="helpLink",H.text=Q.cua,H.onExecute=function(L){Q.iMa(L)},H);H=new E.a(!1,!1,!0);H.hc=1;H.yc(1,Q.bqb);H.Ie=Q.id;S={};A=(S.id=Q.id,S.dialogIcon=Q.icon,S.bodyControls=A,S);H.initializeAndShow(Q.Kn,Object(v.a)(Q,Q.Bzd,"reactOICErrorDialogHandler"),
A);return Q}function d(A,H,S,Q){var L=h.call(this,A,H,S,Q)||this;A={};A=(A.errorMessage=L.errorMessage,A);H={};A.helpLink=(H.type="AppLinkProps",H.id="helpLink",H.text=L.cua,H.onExecute=function(aa){L.iMa(aa)},H);L.Hrc?(A.macOfficePreLinkText=L.Cef,H={},A.macOfficeLink=(H.type="AppLinkProps",H.id="macOfficeLink",H.text=L.zef,H.onExecute=function(aa){L.lsd(aa)},H),A.macOfficePostText=L.Bef):L.s_b&&(A.errorFileDownloadOffer=L.aqb);H=new E.a(!1,!1,!0);L.s_b?(H.hc=1,H.yc(1,L.bqb)):H.hc=0;H.Ie=L.id;S=
{};A=(S.id=L.id,S.dialogIcon=L.icon,S.bodyControls=A,S);H.initializeAndShow(L.Kn,Object(v.a)(L,L.Bzd,"reactOICErrorDialogHandler"),A);return L}function l(A,H,S){A=n.call(this,A,H,S)||this;A.Fl=null;H=document.createElement("span");H.id="errorMessageText";H.innerText=A.VDe;H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));A.Fl=document.createElement("a");A.Fl.href="#";A.Fl.innerText=A.cua;H.appendChild(A.Fl);y.a.addHandler(A.Fl,"click",Object(v.a)(A,A.iMa,"oicErrorHelpLinkHandler"));
H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));S=document.createElement("span");S.innerText=A.aqb;H.appendChild(S);S=new J.StandardDialog;S.Ie=A.id;S.hc=1;S.yc(1,A.bqb);S.ul(A.Kn,null,A.icon,Object(v.a)(A,A.Dmd,"legacyOICErrorDialogHandler"),H);S.OV("errorMessageText");return A}function n(A,H,S){this.WW=H;this.XW=A;this.TC=S}function r(A,H,S,Q){A=h.call(this,A,H,S,Q)||this;A.Fl=null;A.Eoa=null;H=document.createElement("span");H.id="errorMessageText";H.innerText=
A.errorMessage;H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));A.Fl=document.createElement("a");A.Fl.href="#";A.Fl.innerText=A.cua;H.appendChild(A.Fl);y.a.addHandler(A.Fl,"click",Object(v.a)(A,A.iMa,"oicErrorHelpLinkHandler"));S=new J.StandardDialog;S.Ie=A.id;if(A.Hrc){Q=document.createElement("span");var L=document.createElement("span");Q.innerText=A.Cef;L.innerText=A.Bef;A.Eoa=document.createElement("a");A.Eoa.href="#";A.Eoa.innerText=A.zef;H.appendChild(document.createElement("br"));
H.appendChild(Q);H.appendChild(A.Eoa);H.appendChild(L);y.a.addHandler(A.Eoa,"click",Object(v.a)(A,A.lsd,"oicErrorMacOfferLinkHandler"))}else A.s_b&&(H.appendChild(document.createElement("br")),H.appendChild(document.createElement("br")),Q=document.createElement("span"),Q.innerText=A.aqb,H.appendChild(Q));A.s_b?(S.hc=1,S.yc(1,A.bqb)):S.hc=0;S.ul(A.Kn,null,A.icon,Object(v.a)(A,A.Dmd,"legacyOICErrorDialogHandler"),H);S.OV("errorMessageText");return A}function h(A,H,S,Q){this.qHc=null;this.LNb=Q;this.WW=
A;this.XW=H;this.TC=S;this.b$d=this.Aef.Idj;A=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Ufg=A[0];this.Tfg=A[1]}C=b(0);var v=b(37),w=b(15),t=b(5),B=b(50),z=b(405),x=b(88);h.prototype.Bzd=function(A){this.Hzb(A)};h.prototype.Dmd=function(A){this.Hzb(A)};h.prototype.Hzb=function(A){var H=10;this.XW&&1===A&&(this.XW(this.TC),H=1);this.WW&&this.WW(this.TC);this.FE(H)};h.prototype.iMa=function(){z.Redirect.showHelp("OICFailure");this.FE(2)};h.prototype.lsd=function(){this.Aef.Baf();this.FE(4)};
h.prototype.FE=function(A){w.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.LNb,A);t.AFrameworkApplication.Jnc(B.a.yuf,this.LNb,A)};h.prototype.dispose=function(){this.TC=this.WW=this.XW=null};Ll.Object.defineProperties(h.prototype,{Aef:{configurable:!0,enumerable:!0,get:function(){return this.qHc||(this.qHc=x.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},cua:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Hrc:{configurable:!0,enumerable:!0,get:function(){return this.b$d}},Cef:{configurable:!0,enumerable:!0,get:function(){return this.Ufg}},Bef:{configurable:!0,enumerable:!0,get:function(){return this.Tfg}},zef:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,
get:function(){return this.b$d?3:2}},aqb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},s_b:{configurable:!0,enumerable:!0,get:function(){return!!this.XW}},bqb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},Kn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(C.a)(h,"AOICErrorDialog",null,[6]);var y=b(40),J=b(128);Em(r,h);r.prototype.dispose=
function(){this.Fl&&(y.a.removeHandler(this.Fl,"click",Object(v.a)(this,this.iMa,"oicErrorHelpLinkHandler")),this.Fl=null);this.Eoa&&(y.a.removeHandler(this.Eoa,"click",Object(v.a)(this,this.lsd,"oicErrorMacOfferLinkHandler")),this.Eoa=null);h.prototype.dispose.call(this)};Object(C.a)(r,"OICErrorDialog",h,[]);n.prototype.Bzd=function(A){this.Hzb(A)};n.prototype.Dmd=function(A){this.Hzb(A)};n.prototype.Hzb=function(A){var H=10;1===A&&(this.XW(this.TC),H=1);this.WW&&this.WW(this.TC);this.FE(H)};n.prototype.iMa=
function(){z.Redirect.showHelp("OICFailure");this.FE(2)};n.prototype.FE=function(A){t.AFrameworkApplication.Jnc(B.a.zuf,3,A)};n.prototype.dispose=function(){this.TC=this.XW=this.WW=null};Ll.Object.defineProperties(n.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},VDe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},cua:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
aqb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},bqb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},Kn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(C.a)(n,"AOICErrorDialogWithDownload",null,[6]);Em(l,n);l.prototype.dispose=function(){this.Fl&&(y.a.removeHandler(this.Fl,"click",
Object(v.a)(this,this.iMa,"oicErrorHelpLinkHandler")),this.Fl=null);n.prototype.dispose.call(this)};Object(C.a)(l,"OICErrorDialogWithDownload",n,[]);var E=b(140);Em(d,h);Object(C.a)(d,"ReactOICErrorDialog",h,[]);Em(e,n);Object(C.a)(e,"ReactOICErrorDialogWithDownload",n,[]);b.d(F,"a",function(){return a});a.prototype.WVg=function(A,H,S){this.ggb?new d(A,H,null,S):new r(A,H,null,S)};a.prototype.XVg=function(A,H,S){this.ggb?new e(A,H,S):new l(A,H,S)};a.prototype.YVg=function(A,H,S,Q,L){var aa=b(1297).ReactOICErrorDialogWithTrial,
fa=b(1298).OICErrorDialogWithTrial;this.ggb?new aa(A,H,S,null,Q,L):new fa(A,H,S,null,Q,L)};Ll.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma||(a.Ma=new a)}}});a.Ma=null;Object(C.a)(a,"OICErrorDialogFactory",null,[838])},1239:function(C,F,b){function a(na,ma){var xa=La.call(this)||this;xa.Oa=new w.a;xa.z1=null;xa.cCc=[];xa.$=na;xa.nWa=ma;xa.fzg();l.AFrameworkApplication.Cd&&l.AFrameworkApplication.Cd.MOc(xa);xa.Ijb=Array(64);for(var Pa=0;64>Pa;Pa++)xa.Ijb[Pa]=
null;xa.Kg=W.EcmaDateClock.instance;xa.u$e=xa.Kg.Gb;ma&&(ma=na.ra,Pa=ma.qf,ma.lB(Object(v.a)(xa,xa.Io,"onWebMethodError")),ma.Yr(Object(v.a)(xa,xa.Oh,"onWebMethodSuccess")),ma.gkb(Object(v.a)(xa,xa.Dhc,"onAuthenticationChanged")),ma.RVa(Object(v.a)(xa,xa.Dhc,"onAuthenticationChanged")),N.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(Pa.ntg(Object(v.a)(xa,xa.HAb,"onNetworkDownEvent")),Pa.vkb(Object(v.a)(xa,xa.Gwa,"onNetworkResumed"))),na.fa.Yj(Object(v.a)(xa,xa.Vc,"onSessionIdChanged")),
na.fa.Vs(Object(v.a)(xa,xa.Gf,"onWorkbookMetadataChanged")),na.Jk(Object(v.a)(xa,xa.jd,"onWorkbookOpened")),na.dn(Object(v.a)(xa,xa.Pd,"onWorkbookClosing")),na.fa.j1(Object(v.a)(xa,xa.BM,"onModeChanged")),na.userOperationManager.jB(Object(v.a)(xa,xa.tBb,"onUserOperationQueued")),N.EwaSettings.ka(170)&&na.fa.$g.get(45)&&l.AFrameworkApplication.ha.sa("SupportsPolicies")||xa.YXe(),xa.a1e(U.c(na)));na.ea.Ia(5,xa);return xa}function e(na,ma,xa){xa=void 0===xa?null:xa;var Pa=y.call(this)||this;Pa.dmb=na;
Pa.k1c=ma;Pa.data=xa;return Pa}C=b(0);var d=b(15),l=b(5),n=b(86),r=b(23),h=b(135),v=b(37),w=b(36),t=b(74),B;(function(na){na[na.unableToRefreshLock=0]="unableToRefreshLock";na[na.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";na[na.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";na[na.workbookTooLarge=3]="workbookTooLarge";na[na.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";na[na.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";na[na.editAndRefreshDisabledOnBIAHostedFiles=
6]="editAndRefreshDisabledOnBIAHostedFiles";na[na.unsupportedFeatures=7]="unsupportedFeatures";na[na.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";na[na.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";na[na.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";na[na.lastGenericStatusError=11]="lastGenericStatusError";na[na.scratchPadWarning=12]="scratchPadWarning";na[na.authenticationLost=13]="authenticationLost";na[na.odfCompatibilityIssues=
14]="odfCompatibilityIssues";na[na.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";na[na.workbookIsIrmProtected=16]="workbookIsIrmProtected";na[na.biFeatureNotAvailable=17]="biFeatureNotAvailable";na[na.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";na[na.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";na[na.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";na[na.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";
na[na.editAttemptInReadOnly=22]="editAttemptInReadOnly";na[na.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";na[na.unsupportedBrowser=24]="unsupportedBrowser";na[na.readOnlyPermissions=25]="readOnlyPermissions";na[na.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";na[na.policyWarningMessage=27]="policyWarningMessage";na[na.workingOnIt=28]="workingOnIt";na[na.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";na[na.workbookIsReadOnlyRecommended=
30]="workbookIsReadOnlyRecommended";na[na.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";na[na.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";na[na.legacyConnectionsBB=33]="legacyConnectionsBB";na[na.groupedSlicersBB=34]="groupedSlicersBB";na[na.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";na[na.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";na[na.wacGdprNotice=37]="wacGdprNotice";na[na.automaticSensitivityLabel=38]="automaticSensitivityLabel";
na[na.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";na[na.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";na[na.localStorageDisabled=41]="localStorageDisabled";na[na.autoRefreshDisabled=42]="autoRefreshDisabled";na[na.corruptedFileRepaired=43]="corruptedFileRepaired";na[na.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";na[na.minorVersionLimitReached=45]="minorVersionLimitReached";na[na.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";na[na.sensitivityApplicationTooLargeFileError=
47]="sensitivityApplicationTooLargeFileError";na[na.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";na[na.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";na[na.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";na[na.sensitivityApplicationMinorVersionLimitReachedError=51]="sensitivityApplicationMinorVersionLimitReachedError";na[na.sensitivityApplicationSetLabelError=
52]="sensitivityApplicationSetLabelError";na[na.promptEnableExternalLinks=53]="promptEnableExternalLinks";na[na.networkDown=54]="networkDown";na[na.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";na[na.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";na[na.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";na[na.canvasHealth=58]="canvasHealth";na[na.novModeDepreciation=59]="novModeDepreciation";na[na.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";
na[na.optimizeWorkbook=61]="optimizeWorkbook";na[na.novModePostDepreciation=62]="novModePostDepreciation";na[na.officeScriptsRunning=63]="officeScriptsRunning";na[na.count=64]="count"})(B||(B={}));Object(C.b)("EwaBusinessBarEntryType",B);var z=b(4),x=b(1159),y=Sys.EventArgs;Em(e,y);Object(C.a)(e,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var J=b(1161),E=b(1160),A=b(1163),H=b(1162),S=b(1157),Q=b(471),L=b(58),aa=b(215),fa=b(35),W=b(680),G=b(27),N=b(1),Y=b(9),V=b(7),da=b(20),U=b(53),
Z=b(64),ca=b(959),ra=b(174);b.d(F,"a",function(){return a});var La=t.a;Em(a,La);a.prototype.YXe=function(){G.a.vq(this.$.fa.tE)&&this.Io(this,new Q.a(this.$.fa.tE,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.rrg=function(na){this.Oa.addHandler("bBarAttachedOrDetached",na)};a.prototype.dispose=function(){if(this.$){var na=this.$,ma=na.ra,xa=ma.qf;ma.BC(Object(v.a)(this,this.Io,"onWebMethodError"));ma.yt(Object(v.a)(this,this.Oh,"onWebMethodSuccess"));ma.Umc(Object(v.a)(this,this.Dhc,"onAuthenticationChanged"));
ma.YDb(Object(v.a)(this,this.Dhc,"onAuthenticationChanged"));xa.kEb(Object(v.a)(this,this.Gwa,"onNetworkResumed"));xa.UUi(Object(v.a)(this,this.HAb,"onNetworkDownEvent"));na.fa.qk(Object(v.a)(this,this.Vc,"onSessionIdChanged"));na.fa.Qv(Object(v.a)(this,this.Gf,"onWorkbookMetadataChanged"));na.dl(Object(v.a)(this,this.jd,"onWorkbookOpened"));na.Lo(Object(v.a)(this,this.Pd,"onWorkbookClosing"));na.fa.J5(Object(v.a)(this,this.BM,"onModeChanged"));na.userOperationManager.zC(Object(v.a)(this,this.tBb,
"onUserOperationQueued"));da.g(na).Gc.ym(Object(v.a)(this,this.Pnf,"onGridEditingStarted"))}n.a.Fa(this.z1);this.$=this.z1=null;La.prototype.dispose.call(this)};a.prototype.E_h=function(na){switch(na){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return N.EwaSettings.ka(695);default:return!1}};a.prototype.eg=function(na,ma,xa,Pa){xa=void 0===xa?null:xa;Pa=void 0===Pa?null:Pa;if(!this.$.isMobileMode||this.E_h(na))this.nWa&&!this.tD(na)&&(N.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
d.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(B,na)),this.Ijb[na]=this.Kg.Gb,this.z1.fD(na,ma,Pa),this.Oa.raiseEvent("bBarAttachedOrDetached",new e(na,!0,xa))),ma&&32===ma.Appearance&&Z.a(this.$).fd.Jja(ma)};a.prototype.xgj=function(na,ma,xa,Pa){d.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");S.a.initialize(na,ma,xa,Pa);this.eg(37,null)};a.prototype.yfj=function(na,ma,xa,Pa){x.a.initialize(na,ma,xa,Pa);this.eg(38,null)};a.prototype.Lhj=function(na,
ma,xa,Pa){E.a.initialize(na,ma,xa,Pa);this.eg(39,null)};a.prototype.$gj=function(na,ma,xa,Pa){J.a.initialize(na,ma,xa,Pa);this.eg(40,null)};a.prototype.Vhj=function(na,ma,xa,Pa){H.a.initialize(na,ma,xa,Pa);this.eg(51,null)};a.prototype.Uhj=function(na,ma,xa,Pa){A.a.initialize(na,ma,xa,Pa);this.eg(52,null)};a.prototype.removeEntry=function(na){this.nWa&&(N.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(B,
na)),this.Ijb[na]=null,this.z1.removeEntry(na)&&this.Oa.raiseEvent("bBarAttachedOrDetached",new e(na,!1)))};a.prototype.bKa=function(na){return this.nWa?this.z1.bKa(na):!1};a.prototype.tD=function(na){return this.nWa?this.z1.tD(na):!1};a.prototype.czb=function(){d.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.Rgc=function(){d.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");
this.removeEntry(21)};a.prototype.fzg=function(){var na=b(1214).BusinessBarControl;if(this.nWa&&!this.z1){da.g(this.$).Gc.Jm(Object(v.a)(this,this.Pnf,"onGridEditingStarted"));var ma=document.getElementById(this.$.Jb+z.a.xFg);this.z1=new na(this.$,ma)}};a.prototype.lBd=function(){this.nWa&&this.z1.lBd()};a.prototype.Dhc=function(){this.$.ra.OJa?this.removeEntry(13):this.eg(13,null)};a.prototype.Gwa=function(){N.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170243,
0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");this.removeEntry(21);this.tD(54)&&(d.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),this.removeEntry(54));this.KGf("OnNetworkResumed")};a.prototype.KGf=function(na){if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var ma=this.Kg.Gb;if(3E5<=+ma-+this.u$e){this.u$e=ma;for(var xa=0;64>xa;xa++){var Pa=this.Ijb[xa];Pa&&(Pa=+ma-+Pa,3E5<=Pa&&d.ULS.sendTraceTag(537170241,
0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",na,Enum.toString(B,xa),Pa))}}}};a.prototype.Oh=function(na,ma){na=0;for(var xa=a.Y8b().length;na<xa;na++){var Pa=a.Y8b()[na];this.removeEntry(Pa)}ma.context&&0<ma.context.communicationErrorRetryCount&&(d.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.KGf("OnWebMethodSuccess")};
a.prototype.Io=function(na,ma){na=this.Llh(ma.errors);for(var xa=[],Pa=0,ib=na.length;Pa<ib;++Pa){var pb=na[Pa];if(1===pb.Type&&pb.Appearance&32)xa=this.dPh(pb,xa);else if(ma.F5i){d.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var xb=ma.context&&ma.context.stopwatch?ma.context.stopwatch.Cc:-1;5E3>xb?d.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",
xb):l.AFrameworkApplication.lkd()||this.Oqg(pb,ma.context.methodName)}var Ya=void 0;xb=(Ya=[]).concat.apply(Ya,a.Y8b());Ya=0;for(var ab=xa.length;Ya<ab;++Ya){var ea=xa[Ya];this.eg(ea,pb);Array.remove(xb,ea)}pb=0;for(Ya=xb.length;pb<Ya;++pb)this.removeEntry(xb[pb])}};a.prototype.Llh=function(na){for(var ma=[],xa=Ol(na),Pa=xa.next();!Pa.done;Pa=xa.next())switch(Pa.value.MessageId){case -113742550:Pa=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.fa.isNamedObjectViewMode||
G.a.Yg(na,Pa))&&Array.add(ma,-113742550)}return G.a.yE(na,ma)};a.prototype.HAb=function(na,ma){na=0;for(var xa=ma.errors.length;na<xa;++na){var Pa=ma.errors[na];l.AFrameworkApplication.lkd()||(N.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),this.eg(54,Pa))}};a.prototype.dPh=function(na,ma){switch(na.MessageId){case 2113407564:for(var xa=G.a.nXa([1821390342,-943219229,-502303485,
1437034227]),Pa=0;Pa<xa.length;Pa++)xa[Pa].HelpTopicId=na.HelpTopicId,xa[Pa].HelpDescription=na.HelpDescription,Array.add(this.cCc,xa[Pa])}switch(na.MessageId){case -395951567:this.eg(6,na);break;case 1643490758:this.eg(4,na);break;case -907264831:this.eg(5,na);break;case 757111532:case 2113407564:this.eg(7,na);break;case 2010656511:this.eg(15,na);break;case 1321660996:this.$.O_c=!0;this.eg(8,na);break;case 526339737:this.$.O_c=!0;this.eg(9,na);break;case -407088521:this.eg(10,na);break;case 1756116017:this.eg(14,
na);break;case -1703455218:this.eg(17,na);break;case 1393475740:this.eg(25,na);break;case -949523941:this.eg(26,na);break;case 1779381952:this.eg(42,na);break;case 1421575100:this.eg(43,na);break;case 613676060:this.eg(44,na);break;case 1233668252:this.eg(60,na);break;case 1911608588:na=!!(this.$.zd&64);!this.$.fa.Rg()&&na&&Array.add(ma,29);break;case 1544494907:break;case -655555355:Array.add(ma,this.Ckd()?1:0);break;case -1221382671:Array.add(ma,2);break;case 1662282929:Array.add(ma,3);break;case 104919273:this.$.fa.Rg()||
Array.add(ma,30);break;case -689453604:na=!!(this.$.zd&64);this.$.fa.iZe=!0;!this.$.fa.Rg()&&na&&Array.add(ma,31);break;case 157762400:this.$.fa.fcc=!0;!this.$.fa.Rg()&&this.$.zd&64&&!this.$.isEditMode&&Array.add(ma,32);break;case -73730134:N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableEditingOfFilesWithLegacyConnections",!1)&&!this.$.fa.Rg()&&this.$.zd&64&&Array.add(ma,33);break;case -37299333:break;case 136737622:Array.add(ma,45);break;case -1780327030:this.eg(53,na);break;case -113742550:this.eg(55,
na);break;default:this.eg(11,na)}return ma};a.prototype.Vc=function(na,ma){this.Pd(na,ma)};a.prototype.Pd=function(){var na=this.$.fa;na.lc||na.Rg()||(this.lBd(),Array.clear(this.cCc))};a.prototype.dVh=function(){var na=this;if(l.AFrameworkApplication.ha.sa("WildFireExcelBizBar")&&!ca.a.qid(ca.a.h8c(1))&&(r.a.lp||r.a.ah)){var ma=L.GetServiceTaskFactory.create(this.$.ea,155,this.$.la,1,"System.Dictionary");fa.TaskExtensions.Aa(ma,function(){na.eg(20,null)},this.la,3)}};a.prototype.aVh=function(){var na=
N.EwaSettings.ka(73),ma=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",!1),xa=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);Y.HelperMethods.cKd(xa||ma,na)&&(ra.a("NewBrowserSuggestionShown"),xa||h.a.Uv("NewBrowserSuggestionShown","true",7),this.eg(24,null))};a.prototype.wUh=function(na){!na&&aa.g(this.$)&&this.eg(59,null)};a.prototype.xUh=function(na){!na&&aa.h(this.$)&&this.eg(62,null)};a.prototype.jd=
function(na,ma){this.$.fa.Rg()&&!ma.SP||this.a1e(ma.SP)};a.prototype.a1e=function(na){(na||this.$.printingEnabled)&&!this.$.Qf.get(1)||V.a.ma(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription)||(d.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.eg(16,null));this.dVh();this.aVh();this.Dpe();this.oTf();this.wUh(na);this.xUh(na)};a.prototype.tBb=function(){var na=this.$.userOperationManager.L8b();na&&na.operation.flags&1&&this.gTf()};
a.prototype.Pnf=function(){this.gTf()};a.prototype.Gf=function(){this.Dpe();this.oTf()};a.prototype.Dpe=function(){this.$.workbookContext.Options&32768&&this.kgj()};a.prototype.kgj=function(){N.EwaSettings.isChangeGateEnabled("OfficeVSO:5776164_DoNotShowFinanceBizBarOnColumnResize")&&this.Ijb[36]||this.eg(36,null)};a.prototype.oTf=function(){N.EwaSettings.ka(695)&&this.$.workbookContext.Options&524288&&this.eg(57,null)};a.prototype.MTf=function(na,ma){this.eg(56,na,null,ma)};a.prototype.gTf=function(){this.$.zd&
8&&this.eg(12,null)};a.prototype.Ckd=function(){var na=this.$.ea.Ba(38);return na?na.tokenExpired:!1};a.prototype.Oqg=function(na,ma){if(!this.tD(21)&&-1387426400!==na.MessageId){d.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var xa={};xa.FailedMethod=ma;this.eg(21,na,xa)}};a.prototype.BM=function(){if(this.$.X3&&this.$.fa.Rg()&&this.$.fa.lc)if(this.$.fa.isEditMode)this.removeEntry(43),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),
this.removeEntry(31),this.removeEntry(32),this.removeEntry(22),this.removeEntry(55);else{var na=this.$.ea.Ba(331);na&&na.mHa||this.removeEntry(53);this.removeEntry(5)}};a.Y8b=function(){return a.qhe||(a.qhe=[0,1,2,3])};Ll.Object.defineProperties(a.prototype,{k2c:{configurable:!0,enumerable:!0,get:function(){return this.cCc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.z1?this.z1.domElement:null}}});a.qhe=null;Object(C.a)(a,"BusinessBarManager",t.a,[669,6,116])},1255:function(C,
F,b){function a(B,z,x,y,J,E){this.BIc=null;this._id=B;this.iJc=z;this.gdg=void 0===J?null:J;this.agb=y;this.pib=void 0===E?null:E;this.una=null;this.jVa=x;this.Nib=e.instance.QIh(z,B)}function e(){this.gzc=new h.a;this.ezc=new h.a;this.dzc=new h.a;this.YCg(this.gzc);this.XCg(this.ezc);this.WCg(this.dzc);this.jEc=new h.a;this.iEc=new h.a;this.hEc=new h.a;this.sFg(this.jEc);this.rFg(this.iEc);this.qFg(this.hEc);this.vAc=new h.a;this.qDg(this.vAc);this.DDa(this.vAc);this.DDa(this.dzc);this.DDa(this.ezc);
this.DDa(this.gzc);this.DDa(this.iEc);this.DDa(this.jEc);this.DDa(this.hEc)}C=b(0);var d=b(15),l=b(37),n=b(975),r=b(959),h=b(1234);e.prototype.QIh=function(B,z){switch(B){case 1:return this.VLh(z);case 2:return this.Rth(z)}return r.a.Vrc?this.vAc:null};e.prototype.YCg=function(B){B.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};e.prototype.XCg=
function(B){B.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};e.prototype.WCg=function(B){B.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};e.prototype.sFg=function(B){B.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);B.add("OverlayBig","Get the Word app");B.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");B.add("OverlaySmallSplit1",
"Discover Word");B.add("OverlaySmallSplit2","designed for the iPad.");B.add("SkipButton","Skip for now")};e.prototype.qDg=function(B){B.add("Headline","Get the Office Online extension for Chrome");B.add("UseAppButton","Get the extension");B.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};e.prototype.rFg=function(B){B.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);B.add("OverlayBig","Get the PowerPoint app");B.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");B.add("OverlaySmallSplit1","Discover PowerPoint");B.add("OverlaySmallSplit2","designed for the iPad.");B.add("SkipButton","Skip for now")};e.prototype.qFg=function(B){B.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};e.prototype.DDa=function(B){B.add("Corporation","Microsoft Corporation")};e.prototype.VLh=function(B){switch(B){case 3:return this.jEc;case 2:return this.iEc;case 1:return this.hEc}return null};
e.prototype.Rth=function(B){switch(B){case 3:return this.gzc;case 2:return this.ezc;case 1:return this.dzc}return null};Ll.Object.defineProperties(e,{instance:{configurable:!0,enumerable:!0,get:function(){e.Ma||(e.Ma=new e);return e.Ma}}});e.Ma=null;Object(C.a)(e,"WildFireStringFactory",null,[]);var v=b(5),w=b(48),t=b(23);b.d(F,"a",function(){return a});a.prototype.LYc=function(){this.una=new n.a(this.title,this.message,null);this.una.addButton(this.$me,Object(l.a)(this,this.okf,"onButtonOneClick"),
"");this.jVa&&this.una.bqg(this.bne,Object(l.a)(this,this.rkf,"onButtonTwoClick"));this.una.X8=Object(l.a)(this,this.Xze,"dismissBar");this.una.image=3;this.una.id=16;this.una.closeable=!0};a.prototype.okf=function(){this.jVa?this.UXh():this.Uzj()};a.prototype.rkf=function(){this.jVa&&this.fCi()};a.prototype.UXh=function(){d.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.agb&&this.pib&&this.pib();r.a.tCf(this._id,this.iJc)};a.prototype.fCi=function(){this.openUrl&&
(d.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.agb&&this.pib&&this.pib(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(r.a.kie(this._id),this.openUrl,0,!1))};a.prototype.Uzj=function(){r.a.Vrc?this.zFg():(d.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),r.a.mId("BizBarClicked"),1!==this.iJc&&2!==this.iJc||r.a.SLg(this.openUrl,this.agb,this._id,this.pib))};a.prototype.zFg=function(){this.agb?d.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):
d.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");w.a.lY(v.AFrameworkApplication.ha.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.q3g=function(){this.agb?d.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):d.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");r.a.mId(r.a.eqe)};a.prototype.Xze=function(){r.a.Vrc?this.q3g():(r.a.mId(r.a.h8c(this._id)),d.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.B0b=function(){var B=v.AFrameworkApplication.xa.Xa,
z=new a(B.Tk,r.a.W8b(),8<t.a.n2a,1===B.dMa,function(){return B.rB},B.aKf());d.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return z};Ll.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Nib.oa("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.Nib.oa("CallToAction")}},bAj:{configurable:!0,enumerable:!0,get:function(){return this.jVa}},$me:{configurable:!0,enumerable:!0,get:function(){return this.jVa?this.Nib.oa("InstallButton"):
this.Nib.oa("UseAppButton")}},bne:{configurable:!0,enumerable:!0,get:function(){return this.jVa?this.Nib.oa("OpenAppButton"):""}},vFg:{configurable:!0,enumerable:!0,get:function(){return this.una}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.BIc||(this.BIc=this.gdg());return this.BIc}}});Object(C.a)(a,"WildFireBusinessBar",null,[])},1297:function(C,F,b){function a(r,h,v,w,t,B){var z=n.call(this,r,h,v,w,t,B)||this;r={};h=(r.errorMessage=z.UDe,r.offerString=z.Uif,r);r=new l.a(!1,!1,!0);
z.hTf?(r.hc=1,v={},h.helpLink=(v.type="AppLinkProps",v.id="helpLink",v.text=z.cua,v.onExecute=function(){d.Redirect.showHelp(z.QZe)},v)):(r.hc=4,r.yc(2,z.c0e));r.yc(1,z.TTb);r.Ie=z.id;v={};h=(v.id=z.id,v.dialogIcon=z.icon,v.bodyControls=h,v);r.initializeAndShow(z.Kn,Object(e.a)(z,z.mNi,"reactOICErrorDialogWithTrialHandler"),h);return z}b.r(F);b.d(F,"ReactOICErrorDialogWithTrial",function(){return a});C=b(0);var e=b(37);F=b(1164);var d=b(405),l=b(140),n=F.a;Em(a,n);Object(C.a)(a,"ReactOICErrorDialogWithTrial",
F.a,[])},1298:function(C,F,b){function a(n,r,h,v,w,t){n=l.call(this,n,r,h,v,w,t)||this;r=document.createElement("span");r.innerText=n.UDe;r.appendChild(document.createElement("br"));r.appendChild(document.createElement("br"));h=document.createElement("span");h.innerText=n.Uif;r.appendChild(h);h=new d.StandardDialog;n.hTf?(h.hc=1,h.Vde(n.cua,n.QZe)):(h.hc=4,h.yc(2,n.c0e));h.yc(1,n.TTb);h.Ie=n.id;h.ul(n.Kn,null,n.icon,Object(e.a)(n,n.fai,"legacyOICErrorDialogWithTrialHandler"),r);return n}b.r(F);b.d(F,
"OICErrorDialogWithTrial",function(){return a});C=b(0);var e=b(37);F=b(1164);var d=b(128),l=F.a;Em(a,l);Object(C.a)(a,"OICErrorDialogWithTrial",F.a,[])},1299:function(C,F,b){function a(){return e.call(this)||this}b.r(F);b.d(F,"CheckRoamingRightsRequest",function(){return a});C=b(0);b=b(1166);var e=b.a;Em(a,e);a.prototype.b1a=function(){return 2};a.prototype.Mha=function(){return 1};Object(C.a)(a,"CheckRoamingRightsRequest",b.a,[])},1300:function(C,F,b){function a(){return e.call(this)||this}b.r(F);
b.d(F,"GetRoamingLauncherRequest",function(){return a});C=b(0);b=b(1166);var e=b.a;Em(a,e);a.prototype.b1a=function(){return 0};a.prototype.Mha=function(){return 2};Object(C.a)(a,"GetRoamingLauncherRequest",b.a,[])},1323:function(C,F,b){function a(v){this.tAc=!1;this.BUa=a.nac;this.kKc=this.pIc=0;this.platform=null;this.Kig=v;this.lbe=this.lKc=!1}function e(){this.state=this.callback=null;this.Ahd=!1}function d(){this.classId=0}C=b(0);var l=b(37),n=b(41);d.iGa=function(v){try{return n.a(v)}catch(w){}return null};
Object(C.a)(d,"ARoamingAppsResponse",null,[]);Object(C.a)(e,"GetRoamingAppsLauncherContext",null,[]);var r=b(5),h=b(109);b.d(F,"a",function(){return a});a.prototype.rKg=function(){r.AFrameworkApplication.ycc&&this.roamingAppsAreEnabled&&!this.lKc&&!this.tAc&&(this.kKc=1,this.tAc=!0,this.iZi(),this.GIe())};a.prototype.iZi=function(){this.BUa=a.nac;this.pIc=0};a.prototype.getRoamingAppsLauncher=function(v,w,t){this.lAj?(v=new e,v.callback=w,v.state=t,v.Ahd=!0,this.LIe(v)):w(!1,"",t)};a.prototype.GIe=
function(){var v=new (b(1299).CheckRoamingRightsRequest);v.RoamingApp=this.kKc;v.BaseDocQuerySignature=r.AFrameworkApplication.Xi;v.execute(Object(l.a)(this,this.tKg,"checkUserRoamingRightsSucceeded"),Object(l.a)(this,this.sKg,"checkUserRoamingRightsFailed"),null)};a.prototype.tKg=function(v){r.AFrameworkApplication.Fg||((v=d.iGa(v.data.ae))?this.oId(v.HasRights):this.oId(!1))};a.prototype.sKg=function(){if(!r.AFrameworkApplication.Fg)if(this.pIc>=a.Ugi)this.oId(!1);else{var v=new h.a(2,1,this.BUa,
Object(l.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);r.AFrameworkApplication.sj.kh(v);this.pIc++;this.BUa*=a.t_i;this.BUa>a.mff&&(this.BUa=a.mff)}};a.prototype.oId=function(v){this.lbe=v;this.lKc=!0;this.tAc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.GIe()};a.prototype.LIe=function(v){var w=new (b(1300).GetRoamingLauncherRequest);w.RoamingApp=this.kKc;w.BaseDocQuerySignature=r.AFrameworkApplication.Xi;w.execute(Object(l.a)(this,this.eHh,"getRoamingAppsLauncherSucceeded"),
Object(l.a)(this,this.dHh,"getRoamingAppsLauncherFailed"),v)};a.prototype.eHh=function(v){if(!r.AFrameworkApplication.Fg){var w=d.iGa(v.data.ae);v=v.data.state;w?(this.platform=w.Platform,v.callback(!0,w.Launcher,v.state)):v.callback(!1,"",v.state)}};a.prototype.dHh=function(v){if(!r.AFrameworkApplication.Fg){var w=v.data.state;5===v.data.status&&w.Ahd?(w.Ahd=!1,this.LIe(w)):w.callback(!1,"",w.state)}};Ll.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Kig}},
lAj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.lKc?this.lbe:!1}}});Ll.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.dB||(a.dB=new a(r.AFrameworkApplication.zyg))}}});a.nac=1E3;a.t_i=5;a.mff=12E5;a.Ugi=5;a.dB=null;Object(C.a)(a,"RoamingAppsManager",null,[])},1357:function(C,F,b){function a(c){return al.call(this,c)||this}function e(c,k,D){this.ignorePrintArea=!1;this.$=c;this.fa=c.fa;this.Qga=k;this.KM=new G(1,
this.ignorePrintArea);this.tC=k=new d(c,k,wd.AFrameworkApplication.Cd,D);this.$.ea.Ia(418,k);this.qyf=new E(c);this.$.ea.Ia(384,this);this.jLc=!1}function d(c,k,D,ba){this.activeCell=this.selectedRange=this.$f=this.graphServiceEndpoint=null;this.KZ=0;this.um=this.yu=null;this.yG=new J;this.kk=new J;this.saa=0;this.K4a=null;this.FIb=!1;this.b0a=this.OBb=null;this.kjd=!1;this.J3a=this.bwb=this.Ccc=!0;this.yka=this.Zwa=this.aLa=null;this.mvb=!1;this.I4a=null;this.d3a=this.EFc=!1;this.$=c;this.Qga=k;
this.R1=D;this.asd=ba;this.nDd=gd.HelperMethods.TY;this.Oa=new Ch.a;this.fyd=this.$.ya.PrintPreviewerPaginationRange;this.Yua=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);this.q7e=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintGridlines",!1);this.p7e=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintAlignmentsAndHeadings",!1);this.lcc=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",!1);this.useMSPdfViewer=
this.hfj();this.hWh();this.q_h=this.PJg();this.jjd=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!ba&&ba.NJa()&&zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Qf.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint}function l(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function n(){this.onBackToSheet=
null}function r(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function h(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function v(){this.onDropdownSettingsFocus=
this.onPrint=this.onSettingChange=null}function w(c,k,D,ba,Ba,nb){Ba=B.call(this,Ba)||this;Ba.Bd=!1;Ba.BUf=!1;Ba.tC=c;Ba.KM=D;Ba.$=k;Ba.sheetName=ba;Ba.locale=window.navigator.browserLanguage||window.navigator.language||Ba.$.ya.UICultureTag;Ba.NDi=Ba.FQg();Ba.$.userOperationManager.jB(Object(qe.a)(Ba,Ba.OJ,"onQueueChanged"));Ba.TJ=new fi.a;Ba.Yua=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);Ba.isUniversalPrintEnabled=nb;return Ba}function t(c,k){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=c;this.sheetPrintOptions=k}function B(c){this.lli=[.75,.75,.7,.7,.3,.3];this.aki=[.75,.75,.25,.25,.3,.3];this.QCj=[1,1,1,1,.5,.5];this.$3d=this.e9d=this.u6d=this.d6d=this.Jbe=this.l5=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Bm=c;this.uWh();this.BWh()}function z(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function x(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function y(){this.marginValue=
this.printSettingOption=null}function J(){this.margin=this.d_=this.bba=this.orientation=this.Pu=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.FZa=!1;this.NoColor=null}function E(c){this.ribbonCommandInfo=this.BBb=null;this.$=c;this.hHf=gd.HelperMethods.TY&&zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5140883_ReportPrintAreaPageBreaksQosError");this.NIa=new Ck.a;this.Pta=new Ck.a;this.Pta.add(78661008,12);this.Pta.add(275604654,13);this.Pta.add(-13332329,14);this.Pta.add(-837651977,9);
this.Pta.add(-1778266776,10);this.Pta.add(845325699,11);this.jjd=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function A(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function H(){this.Max=this.Min=this.Index=0}function S(){this.Col=this.Row=null}function Q(c){this.sheetName=null;this.sheetName=c}function L(c){this.sheetName=null;this.sheetName=c}function aa(c){this.sharedSheetCell=null;this.sharedSheetCell=c}function fa(c){this.sharedSheetCell=
null;this.sharedSheetCell=c}function W(c,k){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=c;this.addToPrintArea=k}function G(c,k){this.n5=0;this.o0d=!1;this.Pu=c;this.ignorePrintArea=k}function N(c,k,D,ba,Ba,nb,Rb,Ic){c=ra.call(this,c,k,D,ba,Ba,zg.EwaSettings.ka(410))||this;c.qba=null;c.G9=null;c.T$b=null;c.BLd=!1;c.uva=null;c.J7a=null;c.axa=null;c.jya=null;c.t2a=null;c.rxa=1;c.Lka=1;c.JZ=0;c.n5=1;c.KCb=!1;c.Ar=null;c.wFb=0;c.vFb=0;c.bxa=null;c.kya=null;c.selectedRange=null;c.KZ=0;c.Qga=
nb;c.activeCell=c.$.qa.activeCell.toString();c.um.SelectedRanges&&c.um.SelectedRanges.Ranges&&0<c.um.SelectedRanges.Ranges.length&&c.um.SelectedRanges.Ranges[0]&&(c.selectedRange=Sb.B(c.um.SelectedRanges.Ranges[0]).toString());c.sheetName=Rb;c.KM=Ic;c.Qvd={};nb=0;for(Rb=N.paperSizeOptions.length;nb<Rb;++nb)c.Qvd[N.paperSizeOptions[nb].toString()]=nb;c.locale=window.navigator.browserLanguage||window.navigator.language||c.$.ya.UICultureTag;c.d6=zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");
return c}function Y(c,k){this.printSettings=this.sheetName=null;this.sheetName=c;this.printSettings=k}function V(){}function da(c,k,D,ba,Ba){c=ra.call(this,c,k,D,ba,Ba)||this;c.Wpb=null;return c}function U(c,k,D,ba,Ba,nb,Rb,Ic){Ic=c.Na(1,void 0===Ic?null:Ic);Ic.sheetName=k;Ic.locale=D;return Af.i(c,"GetPrintSettings",Ic,ba,Ba,nb,Rb,4)}function Z(c,k,D,ba,Ba,nb,Rb){Rb=c.Na(1,void 0===Rb?null:Rb);Rb.ConvertInParameters=k;return Af.i(c,"ConvertWorkbookToPrintPdf",Rb,D,ba,Ba,nb,4)}function ca(c,k,D,ba,
Ba,nb,Rb,Ic){Ic=c.Na(9,void 0===Ic?null:Ic);Ic.sheetName=k;Ic.printSettings=D;return Af.i(c,"SetSheetPrintSettings",Ic,ba,Ba,nb,Rb,0)}function ra(c,k,D,ba,Ba,nb){c=hk.call(this,c,k,D,void 0===nb?!1:nb)||this;c.qv=null;c.um=ba;c.bNb=Ba;return c}function La(){this.wYd=this.Za=null}function na(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd){this.yTb=null;this.ubg=c;this.ehb=k;this.ZHc=D;this.Aeg=ba;this.ffg=Ba;this.vJc=new Kf.a(Object(qe.a)(this,this.KFh,"getProbeResults"));this.OSa=nb;this.o3d=Wc;this.pkg=Rb;this.gfg=
Ic;this.mfg=Rd}function ma(c,k){this.dXf=c;this.sQa=k}function xa(c){this.isEnabled=Boolean.parse(c.DirectPrintIsEnabled||"false");Boolean.parse(c.DirectPrintProbeIsEnabled||"false");this.Y2h=Boolean.parse(c.DirectPrintEnabledForInternetExplorer||"false");this.rQa=(c.DirectPrintSupportedMimeTypes||"").split(xa.Z0c);this.sQa=(c.DirectPrintSupportedPlugins||"").split(xa.Z0c);this.qTh=(c.DirectPrintImmersivePreviewPlugins||"").split(xa.Z0c);this.x4e=Boolean.parse(c.DirectPrintEnabledForEdge||"false");
this.Y_h=Boolean.parse(c.ChromePrintLayoutFixIsEnabled||"false");this.EKg=parseInt(c.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Ppd=14;this.cgf=14394;if(c=c.DirectPrintMinimalSupportedEdgeVersion){var k=c.split(".");2===k.length?(this.Ppd=parseInt(k[0]),this.cgf=parseInt(k[1])):nd.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",c)}else nd.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}
function Pa(c,k,D,ba,Ba){D=void 0===D?null:D;ba=void 0===ba?!0:ba;Ba=void 0===Ba?!1:Ba;k=Eg.call(this,c,!0,!(Pa.lRa&&ba),new ig(c,k),D,Ba)||this;Pa.lRa=Pa.lRa&&ba;if(Pa.lRa){ba=document.createElement("iframe");Ba=null;var nb=k.A2g;ba.name="pdfObjectFrame";ba.id="pdfObjectIFrame";if(D&&0<D.count){var Rb=xe.a.R$c(c,D);c=xe.a.JBd(c,D);Ba=document.createElement("form");Ba.id="printPreviewPostForm";Ba.method="POST";Ba.target=ba.name;Ba.action=c;c=Ol(Rb);for(D=c.next();!D.done;D=c.next())D=D.value,Rb=document.createElement("input"),
Rb.type="hidden",Rb.name=D.key,Rb.value=D.value,Ba.appendChild(Rb)}else ba.src=c;nb.appendChild(ba);Ba&&(nb.appendChild(Ba),Ba.submit());Sys.UI.DomElement.addCssClass(ba,"DirectPrintPdfObjectHidden");Bh.a.oh(ba,Bh.a.mB,Bh.a.hj)}return k}function ib(c){this.$N=c}function pb(c,k,D,ba){ba=void 0===ba?null:ba;var Ba=hj.call(this)||this;Ba.aoa=null;Ba.Gl=null;Ba.dO=null;Ba.Im=[];Ba.RQb=k;Ba.$N=c;Ba.zdg=D;Ba.fSb=ba;Ba.Mib=new Hj.a("LoadResource","LoadPrintablePdf");return Ba}function xb(c){var k=pi.call(this)||
this;k.$=c;k.Yb();return k}function Ya(c){this.stopwatch=this.fWb=this.cuc=this.MNd=null;this.bYf=0;this.$=c;(this.hRc=zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||c.ea.Ia(322,this)}function ab(c){this.rae=0;this.cYf=c}function ea(c,k,D,ba,Ba,nb,Rb){this.title=c;this.body=k;this.PIi=D;this.primaryButtonAction=ba;this.secondaryButtonAction=nb;this.zLf=Ba;this.targetObject=Rb}function ta(c){var k=Uh.call(this)||this;k.$=c;k.Yb();return k}function Ka(c){this.$=c;c.ea.Ia(309,this)}
function mb(c){c=yi.call(this,c)||this;c.xo=null;c.stopwatch=null;return c}function Ha(){}function Ga(c){return Sh.call(this,c)||this}function Fa(c){this.pi=c}function eb(c){var k=Oi.call(this)||this;k.$=c;k.Yb();return k}function db(c){c.ea.Ia(446,this)}function Na(c){return Di.call(this,c)||this}function kb(c,k){this.sortOptions=this.Rsc=this.selectedRange=null;this.S3e=!1;this.activeCell=this.Rf=this.xb=this.Tc=null;this.$=c;this.kaf="";this.namedSheetViewPublic=k;this.gridView=$d.g(this.$);this.$.Vb.yi("LoadResource",
"LoadDialogControlsStopwatch")}function Tb(c,k,D,ba,Ba,nb,Rb){Rb=c.Na(41,void 0===Rb?null:Rb);Rb.options=k;return Af.i(c,"Sort",Rb,D,ba,Ba,nb,0)}function ha(c){this.filterRange=null;this.filterRange=c}function lb(c){this.selection=null;this.selection=c}function Wa(c){this.selection=null;this.selection=c}function Ra(c,k,D,ba){c=li.call(this,c)||this;c.TJd=!1;c.Zgd=!1;c.i5=[];nd.ULS.shipAssertTag(529105669,0,!!k.ActiveCell);nd.ULS.shipAssertTag(529105668,0,!!k.SelectedRange);nd.ULS.shipAssertTag(529105667,
0,Sb.D(k.SelectedRange).contains(Sb.C(k.ActiveCell)));nd.ULS.shipAssertTag(529105666,0,Cd.a.equals(k.SelectedRange.SheetName,k.ActiveCell.SheetName,!0));c.selectedRange=k.SelectedRange;c.Kjc=k.ActiveCell;c.qHg=k.ExpandSelection;c.namedSheetViewPublic=D;c.PQa=ba;c.initializeAndShow(Ff.a.instance.da(177),Object(qe.a)(c,c.T0c,"dialogResultHandler"),c.ora(k));return c}function Yb(c,k){c=fh.call(this,c,k)||this;c.Jyb=c.F7c();c.Lq();return c}function oc(c,k){var D=c.SortRange;c=c.SortTopToBottom?D.LastColumn-
D.FirstColumn:D.LastRow-D.FirstRow;return 0<=k&&k<=c}function zb(c,k){if(!c.SortColumnInfoItems)return nd.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var D=new fi.a,ba=Ol(c.SortColumnInfoItems),Ba=ba.next();!Ba.done;Ba=ba.next()){Ba=Ba.value;if(!oc(c,Ba.ColumnOffset))return nd.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",Ba.ColumnOffset,c.SortRange),
!1;if(Cd.a.ma(Ba.Name))return nd.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",Ba.ColumnOffset),!1;if(Ba.CellColors&&!Ba.CellColors.length)return nd.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",Ba.CellColors.length),!1;if(Ba.TextColors&&!Ba.TextColors.length)return nd.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",
Ba.TextColors.length),!1;if(Ba.Icons&&!Ba.Icons.length)return nd.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",Ba.Icons.length),!1;D.add(Ba.ColumnOffset)}if(c.SortConditions)for(ba=Ol(c.SortConditions),Ba=ba.next();!Ba.done;Ba=ba.next())if(Ba=Ba.value,!D.contains(Ba.RowColOffset))return nd.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",Ba.RowColOffset),
!1;if(c.HeaderColumnInfoItems){if(c.HeaderColumnInfoItems.length!==c.SortColumnInfoItems.length)return nd.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(D=0;D<c.HeaderColumnInfoItems.length;++D){ba=c.HeaderColumnInfoItems[D];if(k&&ba.ColumnOffset!==c.SortColumnInfoItems[D].ColumnOffset)return nd.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),
!1;if(ba.CellColors&&1<ba.CellColors.length)return nd.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(ba.TextColors&&1<ba.TextColors.length)return nd.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(ba.Icons&&1<ba.Icons.length)return nd.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0}function uc(c){if(!c.SortConditions)return!0;for(var k=Ol(c.SortConditions),D=k.next();!D.done;D=k.next()){D=D.value;if(!oc(c,D.RowColOffset))return nd.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",D.RowColOffset,c.SortRange),!1;if(1===D.SortConditionType&&D.FillGradient&&!lc.isValid(D.FillGradient))return nd.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),
!1}return!0}function P(c){return c.SortRange?4===c.SortRangeType?(nd.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",c.SortRangeType),!1):2===c.SortRangeType&&c.SortTopToBottom&&(null==c.HeaderRowSize||0>c.HeaderRowSize)?(nd.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(nd.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),
!1)}function lc(){}function Ec(c,k,D,ba){new Sys.UI.Point(c,k);new Sys.UI.Point(D,ba)}function tc(){}function cc(c,k,D,ba){c=c.HeaderColumnInfo;return ba||c?2===k&&D?c.CellColors&&1!==c.CellColors.length?(nd.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):c.TextColors&&1!==c.TextColors.length?(nd.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):c.Icons&&1!==c.Icons.length?(nd.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:c?(nd.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",D),!1):!0:!0}function Zb(c,k){c=c.ColumnInfo;switch(k){case 1:return c.CellColors&&
c.CellColors.length?!0:(nd.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return c.TextColors&&c.TextColors.length?!0:(nd.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return c.Icons&&c.Icons.length?
!0:(nd.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return nd.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function Aa(c){this.UIe=c}function Ia(c,k,D,ba,Ba,nb,Rb){Rb=c.Na(41,void 0===Rb?null:Rb);Rb.filterRange=k;return Af.i(c,"ReapplyAutoFilter",Rb,D,ba,Ba,nb,0)}function qb(c,
k,D,ba,Ba,nb,Rb){Rb=c.Na(41,void 0===Rb?null:Rb);Rb.filterRange=k;return Af.i(c,"ToggleAutoFilter",Rb,D,ba,Ba,nb,0)}function wb(c){this.options=null;this.options=c}function ic(c){return Cg.call(this,c)||this}function Jb(c,k,D){var ba=Df.call(this)||this;ba.Une=!1;ba.Tne=!1;ba.$=c;ba.Sa=k;ba.gJ=D;xi.a(ba.$).HAd(new zd.a(vf.a.x1f,vf.a.idle,Jb.lJg),new fk.a(vf.a.sre,vf.a.tZ,null,vf.a.zN,vf.a.idle));return ba}function Ua(c){c=cd.call(this,c,Ff.a.instance.da(1206))||this;c.textBox=null;c.IOa=null;c.ZQa=
null;return c}function $a(c,k,D,ba,Ba,nb){nb=void 0===nb?0:nb;c=Cc.call(this,c,Ff.a.instance.da(k),!1)||this;c.message=D;c.Cni=ba;c.ISd=Ba;c.operationFlags=nb;return c}function ua(c,k,D){c=Hb.call(this,c,new Sys.UI.Point(ua.z0g,ua.b0g),Ff.a.instance.da(k?1204:1203))||this;c.QYa=null;c.vFc=!1;c.V1d=k;c.Zd=D;return c}function Ca(){this.qG=null;this.cxd=1461300262}function Sa(){}function Qb(c){c=Hb.call(this,c,new Sys.UI.Point(960,680),Ff.a.instance.da(1199))||this;c.name=Ac.a.yCe;return c}function Hb(c,
k,D,ba){c=gk.call(this,c,D,2,void 0===ba?null:ba)||this;c.eEc=null;c.sye=k;c.$.hD(Object(qe.a)(c,c.onResize,"onResize"));c.d$b();return c}function Db(c){return Ii.call(this,c)||this}function jc(c){this.$=c}function sb(c,k,D,ba,Ba,nb,Rb,Ic){Ic=c.Na(9,void 0===Ic?null:Ic);Ic.sheetName=k;Ic.directionRtl=D;return Af.i(c,"ChangeSheetDirection",Ic,ba,Ba,nb,Rb,0)}function fb(c,k,D,ba,Ba,nb,Rb,Ic){Ic=c.Na(9,void 0===Ic?null:Ic);Ic.sheetName=k;Ic.show=D;return Af.i(c,"ShowHeadings",Ic,ba,Ba,nb,Rb,0)}function Qa(c,
k,D,ba,Ba,nb,Rb,Ic){Ic=c.Na(9,void 0===Ic?null:Ic);Ic.sheetName=k;Ic.show=D;return Af.i(c,"ShowGridlines",Ic,ba,Ba,nb,Rb,0)}function cb(c,k){this.sheetName=null;this.value=!1;this.sheetName=c;this.value=k}function Ab(c,k){var D=Ak.call(this)||this;D.activityName=c;D.kT=k;D.Yb();return D}function gc(c,k,D,ba,Ba){c=rk.call(this,c,k)||this;gc.Nod=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];gc.Mod=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
gc.uef=[-1468309555,611268539,-1750576502,61029505];gc.tef=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];c.Asc=D;c.xij=ba;c.trj=Ba;return c}function Lc(){var c=zk.call(this)||this;c.Yb();return c}function Nc(c,k){return Gj.call(this,c,k)||this}function yd(c){var k=dk.call(this)||this;k.$=c;k.Yb();return k}function Od(c,k){this.$=c;this.pi=k;this.$.ea.Ia(393,this)}function sa(c){return qk.call(this,c)||this}function vb(c,k){this.$=c;this.pi=k}function Lb(c){return Fj.call(this,
c)||this}function rc(c,k){this.$=c;this.ji=k}function Oc(c,k){c=Tj.call(this,c)||this;c.isRow=2040891415===k.command;c.gridView=$d.g(c.$);c.foc=new Id(c.$.workbookContext.DxDigitNormal);c.dfd=c.NGg();k=c.QQg(c.dfd);var D=c.SQg(c.dfd);c.Kn=Ff.a.instance.da(c.isRow?455:456);k=c.k3(k,D);c.initializeAndShow(c.Kn,Object(qe.a)(c,c.wZi,"resizeHeadersDialogHandler"),k);nd.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",c.isRow);return c}function Bb(c){this.resizeParameters=
null;this.resizeParameters=c}function hc(c,k){this.isRow=!1;this.autoFitRange=null;this.isRow=c;this.autoFitRange=k}function Pc(){var c=lk.call(this)||this;c.Yb();return c}function rd(c,k){var D=pk.call(this,k.domElement)||this;D.pIf=!1;D.caa=!1;D.nIb=null;D.cxb=null;D.er=null;D.offset=0;D.Ol=0;D.uFb=0;D.A_=null;D.gOa=null;D.VL=null;D.TQh="headerResizeTooltip";D.Nnd=null;D.cF=null;D.B9a=!1;D.KTa=!1;D.ZRc=!1;D.jg=k;D.isRow=k.isRow;D.rtl=k.ij.rtl;D.grid=c;D.$ef=D.isRow?oe.a.mpd:oe.a.Rfc;D.PQh=Ff.a.instance.da(414);
D.YQh=Ff.a.instance.da(413);D.SQh=Ff.a.instance.da(415);Qi.a(D.grid.$,function(ba){D.Nnd=ba.UO(Qh.a.CZi,!1)});lh.a.instance.pa(Sf.a.zj,D.domElement,Object(qe.a)(D,D.Paa,"onDblClick"));Qj.a.instance.pa(Sf.a.Ud,D.domElement.ownerDocument.body,Object(qe.a)(D,D.Yhc,"onDocumentMouseUp"));bk.a.instance.pa(Sf.a.ye,D.domElement.ownerDocument.body,Object(qe.a)(D,D.Yhc,"onDocumentMouseUp"));af.a.tr||(Qj.a.instance.pa(Sf.a.pointerDown,D.domElement,Object(qe.a)(D,D.CM,"onMouseDown")),Qj.a.instance.pa(Sf.a.Ch,
D.domElement,Object(qe.a)(D,D.qQ,"onMouseMove")));D.grid.ga.o1(Object(qe.a)(D,D.Bh,"onSelectionEnded"));D.grid.ga.p8(Object(qe.a)(D,D.hq,"onSelectionStarted"));D.grid.uq(Object(qe.a)(D,D.Bh,"onSelectionEnded"));Ae.a(D.grid.$).pg.qfa(Object(qe.a)(D,D.qE,"onPartialInteractivityStatusChanged"));return D}function Id(c){this.Q1c=c}function Vd(c,k,D,ba,Ba,nb,Rb){this.Zta=c;this.Pyb=k;this.hMa=D;this.Zcd=ba;this.D9a=Ba;this.i9e=nb;this.YPh=Rb}function He(){}function Nd(c){var k=di.call(this)||this;k.$=c;
k.Yb();return k}function Vc(c){this.Dma=this.BMe=this.CCb=this.m_a=this.clc=this.oba=this.mNa=null;this.Qjd=this.bKb=this.EEd=!1;this.rHb=!0;this.Lua=!1;this.RKd=!0;this.aKb=this.ZYa=this.Ate=0;this.xpc={};this.Vjc={};this.Ujc={};this.Pxf=0;this.f4a=this.U1d=!1;this.$=c;this.gridView=$d.g(this.$);this.q2i=c.ya.PresentModeRenderUpdateTimeout;this.initialize(c)}function fe(){}function Ee(c,k){c=Kj.call(this,c)||this;c.oba=k;c.domElement.classList.add("ewr-presentMode-on");k={};k=(k.id=c.sc,k);c.hc=
0;c.initializeAndShow("",Object(qe.a)(c,c.xIi,"presentModeWelcomeDialogHandler"),k);return c}function lf(c){this.xXa=this.Exd=null;this.$=c;this.gridView=$d.g(this.$)}function Da(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function fc(){this.height=this.width=0}function Ib(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function Ta(c){this.lke=this.kNa=this.Cxd=this.Dxd=this.nba=this.ewaAccessibilityManager=null;this.isInitialized=
!1;this.Ikc={};this.Hkc={};this.fNa=null;this.Jwf=0;this.$=c}function kd(){}function ce(c){return gf.call(this,c)||this}function dc(c,k){this.$=c;this.presentModeManager=k}function ub(c,k,D,ba){var Ba=jf.call(this)||this;Ba.activityName=c;Ba.kT=k;Ba.SI=D;Ba.$=ba;Ba.Yb();return Ba}function pc(c,k,D){c=Be.call(this,c,k)||this;c.Sh=null;c.y1b=k;c.SI=D;return c}function xc(c,k){c=dd.call(this,c,k)||this;c.Pna=0;c.Lq();return c}function hd(c,k,D,ba){var Ba=Mb.call(this)||this;Ba.activityName=c;Ba.kT=k;
Ba.SI=D;Ba.$=ba;Ba.Yb();return Ba}function Rc(c,k,D){return se.call(this,c,k,D)||this}function ld(c,k){c=Ad.call(this,c)||this;c.password=null;c.F9e=k;c.Eh();return c}function Wd(c,k,D,ba){var Ba=Gh.call(this)||this;Ba.activityName=c;Ba.kT=k;Ba.SI=D;Ba.$=ba;Ba.Yb();return Ba}function ee(c,k,D){return se.call(this,c,k,D)||this}function ne(c){c=Ad.call(this,c)||this;c.wEd=5;c.S1d=!1;c.passwordToModify=null;c.Eh();c.$.Jk(Object(qe.a)(c,c.Lvf,"passwordToModifyWorkbookOpenedinEdit"));return c}function Ad(c){c=
ni.call(this,c)||this;c.Pna=0;return c}function se(c,k,D){c=sd.call(this,c,k)||this;c.Sh=null;c.bwd=null;c.y1b=k;c.SI=D;return c}function Ve(c){var k=Nj.call(this)||this;k.$=c;c.ea.Ia(56,new Pf(c));k.Yb();return k}function Zf(c,k){return wh.call(this,c,k)||this}function Pf(c){var k=Yj.call(this)||this;k.$=c;k.Yb();Pf.WOg();return k}function Fe(c,k,D){var ba=me.call(this,!0)||this;ba.Oa=new Ch.a;ba.$Le=!1;ba.E1c=!1;ba.Ere=null;ba.lm=null;ba.a_b=null;ba.$=c;ba.fa=c.fa;ba.gJ=k;ba.businessBar=D;ba.fa.Yj(Object(qe.a)(ba,
ba.Vc,"onSessionIdChanged"));ba.R9=bj.a.uke(ba.$);ba.XOg();c.ea.Ia(55,ba);return ba}function me(c){this.pea=this.LYd=this.xSa=null;this.sfb=!1;this.qHc=this.E5d=null;this.application=this.YA=0;this.snj=this.eNd=!1;this.Wzj=c&&wd.AFrameworkApplication.ha.sa("OICLaunchDialogIsEnabled");wd.AFrameworkApplication.Hb.Jha(eg.a.nOa)||wd.AFrameworkApplication.Hb.Xb(eg.a.nOa,ih.a.frame,Object(qe.a)(this,this.x_i,"retryOpenInClientAction"));this.qUf=!!wd.AFrameworkApplication.ha&&wd.AFrameworkApplication.ha.sa("SilentExternalHandler")}
function ng(){}function Oe(){}function bd(c){var k=Wj.call(this)||this;k.Fp=c;k.Ie="ProtocolLaunchingDialog";wd.AFrameworkApplication.sj.W1a&&wd.AFrameworkApplication.sj.joc();wd.AFrameworkApplication.xa.Xa.Ibd&&k.Ode(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(qe.a)(k,k.jic,"onGiveFeedbackClick"));bd.KYe?(k.hc=12,k.yc(1,CommonUIStrings.l_CloseFile),k.yc(2,CommonUIStrings.l_OICDialogContinueHere),k.yc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(k.hc=4,k.yc(1,CommonUIStrings.l_OICDialogContinueHere),
k.yc(2,CommonUIStrings.l_OICDialogLaunchAgain));k.Kyb(CommonUIStrings.l_OICDialog2ndTitle,5===k.Fp.vuf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(qe.a)(k,k.Hyd,"protocolLaunchingDialogResultHandler"),null);return k}function ac(c){var k=Gi.call(this)||this;k.sda=null;k.qSa=null;k.Rna=!1;k.yna=null;k.Fp=c;k.tf=Fc.tf;k.$Rc=!0;k.hc=5;k.Ie="ProtocolLaunchingDialog";k.sBc="OICRetryDialog";wd.AFrameworkApplication.sj.W1a&&wd.AFrameworkApplication.sj.joc();
wd.AFrameworkApplication.sj.kh(new Xh.a(2,1,5E3,function(){k.switchToBackupMode()},101));k.showDialog("",Object(qe.a)(k,k.Hyd,"protocolLaunchingDialogResultHandler"));k.JOf();k.OV("Issues");k.OLe();nd.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return k}function Fc(){}function Zc(c){var k=nj.call(this)||this;k.JAa=null;k.rSa=null;k.Rna=!1;k.Fp=c;k.tf=pd.tf;k.$Rc=!0;k.hc=5;k.Ie="OICLaunchDialog";k.showDialog("",Object(qe.a)(k,
k.Ani,"oicLaunchDialogResultHandler"));k.JOf();k.OV("ProtocolLaunchingDialogTitle");4!==wd.AFrameworkApplication.xa.Xa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);k.Ny(k.JAa);nd.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return k}function pd(){}function bf(c,k,D,ba,Ba){var nb=document.createElement("img");nb.alt=c;nb.className=mj.getImageClassWithCluster(D,
ba);nb.src=k;nb.setAttribute(Bh.a.Od,Bh.a.Zr);c=document.createElement("span");c.className="ProtocolLaunchingDialogImg32Container";c.appendChild(nb);nb=document.createElement("span");nb.className="ProtocolLaunchingDialogIconContainer";nb.appendChild(c);Ba.appendChild(nb)}function Bd(c,k,D,ba,Ba,nb,Rb){var Ic=document.createElement("a");Ic.className="ProtocolLaunchingDialogButtonAnchor";Ic.className+=" OICDialog";Ic.id=c;Ic.setAttribute(Bh.a.Od,Bh.a.Zq);Ic.style.padding="0";Ic.style.margin="0";ba&&
bf(Ba,k,D,ba,Ic);c=document.createElement("span");c.className="ProtocolLaunchingDialogButtonLabel";c.innerText=Ba;Ic.appendChild(c);Ic.tabIndex=0;nb&&lh.a.instance.pa(Sf.a.click,Ic,nb);Rb&&Oh.KeyInputManager.instance.pa(Sf.a.Xd,Ic,Rb);return Ic}function Qe(c){return c.Ea.keyCode===Zg.a.Ph||c.Ea.keyCode===Zg.a.Vza?(c.Sb.click(),!0):!1}function Ob(c){for(var k=0;k<c.children.length;k++){var D=c.children[k];D.style.position="relative";D.style.top=(D.parentNode.offsetHeight-D.offsetHeight)/2+"px"}}function yc(){}
function id(c,k,D){var ba=this;this.La=c;this.Neg=k;this.qzc=null;(this.vTb=wd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Hc.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ba){ba.qzc=Ba});this.E0=D}function Tc(c,k,D){this.La=c;this.Jeg=k;this.E0=D}function od(c){var k=Ui.call(this)||this;k.$=c;k.Yb();return k}function mc(c){var k=of.call(this)||this;k.$=c;k.Yb();
return k}function Le(c,k,D){D=void 0===D?!1:D;c=ii.call(this,c,k)||this;c.myb=null;c.zfc=D;return c}function we(c){return mi.call(this,c)||this}function za(c,k){this.pi=k;this.$=c}function Nb(c){var k=$f.call(this)||this;k.$=c;k.Yb();return k}function bb(c){return ej.call(this,c)||this}function Ub(c){this.Mn="Excel";this.$=c;this.JT=Je.a.current}function kc(c,k,D,ba,Ba,nb,Rb){Rb=c.Na(9,void 0===Rb?null:Rb);Rb.sheetName=k;Rb.confirmationChoice=!0;return Af.i(c,"DeleteSheet",Rb,D,ba,Ba,nb,0)}function ad(){}
function Qd(c){var k=qf.call(this)||this;k.wTd=null;k.yTd=0;k.Ui=null;k._state=0;k.sf=c;k.Rt=k.xK;k.moveNext();return k}function We(){}function Ke(c){return Md.call(this,c)||this}function nf(c,k){this.$=c;this.gridView=k}function Pe(c,k,D){var ba=kh.call(this,c)||this;ba.Jjb=0;ba.uvb=!1;ba.yZa=null;ba.Ize=!1;ba.Onb=!0;ba.aOc=null;ba.Kn=null;ba.Zqd=0;ba.$qd=null;ba.Yqd=null;ba.removeHyperLink=!1;ba.cellValue=null;ba.location=null;ba.selectedRange=k;ba.WK=D;ba.fa=c.fa;ba.sheetName=k.SheetName;ba.xJa();
ba.Zl();ba.hc=ba.uvb?9:1;ba.yc(1,Ff.a.instance.da(4));ba.uvb&&ba.yc(2,Ff.a.instance.da(733));c={};c=(c.disableDisplayText=ba.Ize,c.displayTextValue=ba.yZa,c.activeLinkOption=ba.Jjb,c.activeLinkValue=ba.aOc,c.copyLinkValueToDisplay=ba.Onb,c);k={};c=(k.id=ba.sc,k.validateLinkValues=Object(qe.a)(ba,ba.$Aj,"validateLinkValues"),k.bodyProps=c,k);ba.initializeAndShow(ba.Kn,Object(qe.a)(ba,ba.wSh,"hyperLinkDialogHandler"),c);return ba}function hf(c){return rb.call(this,c)||this}function Vf(c,k,D,ba){var Ba=
O.call(this)||this;Ba.$=c;Ba.businessBar=ba;Ba.openInExcelOperation=k;Ba.gJ=D;return Ba}function Sg(){}function wg(c){c=T.call(this,c)||this;c.XG=null;if(1!==wd.AFrameworkApplication.xa.Xa.Tk)return c;c.rB=c.$.workbookContext.ClientUrl;c.d6a="ms-excel:ofe|u|"+c.rB;c.Gt=wd.AFrameworkApplication.ha.Ta("AppUrl");af.a.cja?c.Gt="itms-apps://"+wd.AFrameworkApplication.ha.Ta("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":af.a.lp&&(zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",
!1)&&c.$.ya.IsMeetingLiveSession?(nd.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),c.Gt=wd.AFrameworkApplication.ha.Ta("WildFireMarketUrlExcelAndroid")):af.a.jcc?c.Gt=wd.AFrameworkApplication.ha.Ta("WildFireUrlChinaStoreAndroid"):4<af.a.Jhe.tyb&&(c.Gt=wd.AFrameworkApplication.ha.Ta("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return c}function Ef(){}function Fg(c){this.calculateType=0;this.calculateType=c}function xf(c){this.calculationMode=
0;this.calculationMode=c}function Uf(c,k){this.dialog=null;this.Bni=c;this.zb=k;this.zb.nkb(Object(qe.a)(this,this.Ylf,"onDownloadError"))}function Gg(c,k){return Eg.call(this,c,void 0,void 0,k)||this}function Eg(c,k,D,ba,Ba,nb){k=void 0===k?!0:k;D=void 0===D?!1:D;ba=void 0===ba?null:ba;Ba=void 0===Ba?null:Ba;nb=void 0===nb?!1:nb;var Rb=vh.call(this)||this;Rb.UW=null;Rb.Gl=null;Rb.mTa=null;Rb.nTa=null;var Ic=Rb.tOd?Rb.tOd:CommonUIStrings.l_DefaultDialogTitle;Eg.Vtb=nb;Rb.SNb=ba||new ig(c,!0);Rb.SNb.rke(Rb);
var Wc=[],Rd=[];Eg.Cx&&(Rb.lQc&&Rb.lQc.forEach(function(Pg){Array.add(Wc,Pg)}),Rb.Nge&&Rb.Nge.forEach(function(Pg){Array.add(Rd,Pg)}));k?D?(Rb.hc=4,Rb.yc(1,Rb.buttonText),Rb.yc(2,CommonUIStrings.l_DialogClose)):(Rb.hc=6,Rb.yc(0,CommonUIStrings.l_DialogClose)):Rb.hc=5;nb=document.createElement("span");Rb.d_c&&(nb.className=Rb.d_c);ba=document.createElement("a");ba.innerText=Rb.Gec;ba.href=c;ba.target="_blank";ba.id=Rb.Fec;ba.className=jh.AFrame.rhe;var Ge=!af.a.$z&&!!Ba&&0<Ba.count;if(Ge){var df=xe.a.R$c(c,
Ba);Ba=xe.a.JBd(c,Ba);ba.href="#";ba.target="_self";Rb.Gl=document.createElement("form");Rb.Gl.id="printPreviewPostForm1";Rb.Gl.method="post";Rb.Gl.target="_blank";Rb.Gl.action=Ba;Ba=Ol(df);for(df=Ba.next();!df.done;df=Ba.next()){df=df.value;var Wf=document.createElement("input");Wf.type="hidden";Wf.name=df.key;Wf.value=df.value;Rb.Gl.appendChild(Wf)}}else Rb.Gl=null;Rb.Gl||Eg.Vtb?Eg.Vtb||(c={},Array.add(Rd,(c.type="AppLinkProps",c.id=Rb.Fec,c.text=Rb.Gec,c.onExecute=function(){Rb.eBf()},c))):(Ba=
{},df={},Array.add(Rd,(df.type="AppLinkProps",df.id=Rb.Fec,df.text=Rb.Gec,df.handler=(Ba.href=Ge?"#":c,Ba.target=Ge?"_self":"_blank",Ba),df)));Rb.OLa&&Array.add(Wc,Rb.OLa);D?(c=document.createElement("span"),c.innerText=Rb.OLa.replace("{0}",""),nb.appendChild(c)):Rb.Xff?(c=document.createElement("span"),c.id=Rb.Yh("message"),Ge=document.createElement("span"),Ba=document.createElement("span"),df=Rb.OLa.split("{0}"),Ge.innerText=df[0],Ba.innerText=df[1],c.appendChild(Ge),c.appendChild(ba),c.appendChild(Ba),
nb.appendChild(c)):(c=document.createElement("span"),c.innerText=Rb.OLa,nb.appendChild(c),nb.appendChild(document.createElement("br")),nb.appendChild(document.createElement("br")),nb.appendChild(ba),Eg.Vtb||Array.add(Wc,"{0}"));Rb.Gl&&nb.appendChild(Rb.Gl);Eg.Cx&&(Rb.V4a&&(Rb.Exb?Rb.Nde(Rb.V4a,Rb.Exb):(Array.add(Wc,"{0}"),c={},Array.add(Rd,(c.type="AppLinkProps",c.id="LearnMoreLinkId",c.text=Rb.V4a,c.onExecute=function(){Rb.zec()},c)))),Rb.Ppa(Wc,Rd));Rb.Kyb(Ic,null,Rb.j0e,null,Object(qe.a)(Rb,Rb.sv,
"dialogHandler"),Eg.Cx?null:nb);Rb.OV(Rb.Yh("message"));!Eg.Cx&&Rb.Exb&&Rb.V4a&&(Ic=document.createElement("div"),Ic.className="WACDialogLearnMoreLinkContainer",Rb.UW=document.createElement("a"),Rb.UW.innerText=Rb.V4a,Rb.UW.href=Rb.Exb,Rb.UW.target="_blank",Rb.UW.id=Rb.Yh("LearnMoreLinkId"),Rb.UW.className=jh.AFrame.rhe,Ic.appendChild(Rb.UW),k?Rb.Lb.insertBefore(Ic,Rb.Lb.lastChild):Rb.Lb.appendChild(Ic),Rb.OV(String.format("{0} {1}",Rb.Yh("message"),Rb.Yh("LearnMoreLinkId"))));Rb.Qeb=ba;D?Rb.Ny(Rb.QA):
Rb.Ny(Rb.Qeb);Rb.hcf();wd.AFrameworkApplication.xa.bW.pa(Sf.a.click,Rb.Qeb,Object(qe.a)(Rb,Rb.aBe,"downloadLinkClicked"),null);Rb.UW&&wd.AFrameworkApplication.xa.bW.pa(Sf.a.click,Rb.UW,Object(qe.a)(Rb,Rb.zec,"learnMoreLinkClicked"),null);Rb.RNb=!1;return Rb}function ig(c,k){this._url=c;this.Vgg=k}function sg(c){return m.call(this,c)||this}function yg(c){this.pi=c}function Yd(c){var k=tg.call(this)||this;k.$=c;k.Yb();return k}function Sc(){}function Ag(){this.Za=null}function Jg(c){this.kJa=this.e8a=
null;this._initialized=!1;this.Qdd=c}function je(){this.Za=null}function dg(c,k,D,ba,Ba,nb){k=zc.call(this,k,D,ba,Ba,nb)||this;k.La=c;return k}function ke(c,k,D,ba,Ba,nb,Rb){k=mf.call(this,k,D,ba,Ba,nb,Rb)||this;k.ocg=c;return k}function Qf(c,k,D,ba){c=Ue.call(this,c,k,D,ba)||this;c.Qgg=k;return c}function og(c){var k=$c.call(this)||this;k.hc=1;k.yc(1,CommonUIStrings.l_RetryButtonLabel);k.yc(0,CommonUIStrings.l_DialogClose);k.La=c;return k}function Cf(c,k,D){this.La=c;this.xW=k;this.jjb=D}function Ea(c,
k,D,ba){var Ba=ec.call(this)||this;Ba.n7=null;Ba.AOb=null;Ba.La=c;Ba.xW=k;Ba.jjb=D;Ba.yc(1,CommonUIStrings.l_SaveButtonLabel);Ba.tf=ob.tf;Ba.Ie="FileNameDialog-SaveACopy";Ba.qh=ba;return Ba}function ob(){}function wc(){this.Za=null}function zc(c,k,D,ba,Ba){this.n7=this.jm=this.NAa=null;this.xBa=!1;this.qh=this.Wea=null;this.XMc=c;this.Phb=k;this.Qr=D;this.Ce=ba;this.jh=Ba}function Hd(c){this.vb=c;this.rDa=c.appSettings.SkyDriveUploadWebServiceBase;this.kz=c.appSettings.FileName;this.Tda=c.Ta("SkyDriveUploadHandler")||
"skydriveuploadhandler.ashx"}function Kd(c,k,D,ba,Ba,nb,Rb){this.qDa=c;this.kz=k;this.fTa=D;this.AOb=ba;this.CJc=Ba;this.Tda=nb;this.qh=Rb}function he(c,k,D){this.La=c;this.N0=k;this.xW=D}function Se(c,k,D){var ba=hb.call(this)||this;ba.La=c;ba.N0=k;ba.xW=D;ba.Qt=!1;ba.hc=1;ba.Ela(1);ba.yc(1,CommonUIStrings.l_SignIn);ba.yc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return ba}function Ue(c,k,D,ba){this.MRb=null;this.Xig=c;this.vb=D;this.W5d=k;this.x3d=new ff.a;this.jh=ba}function mf(c,k,D,
ba,Ba,nb){this.qh=null;this.Vjg=c;this.N0=k;this.jjb=D;this.vb=ba;this.sMb=Ba;this.Qr=nb}function Vg(){}function Hf(){var c=Fi.call(this)||this;c.hc=0;c.yc(1,CommonUIStrings.l_DialogClose);return c}function Rg(){this.Jea=this.oQb=this.mQb=this.Za=null}function zf(c,k,D,ba,Ba){this.jm=this.NAa=null;this.Zyc=!1;this.CKc=this.n7=null;this.XMc=k;this.Phb=D;this.Qr=ba;this.Ce=Ba;this.La=c}function gg(c){this.rDa=c.appSettings.SaveAsToHostWebServiceBase;this.kz=c.appSettings.FileName;this.Tda=c.Ta("SharePointSaveAsHandler")||
"sharepointsaveashandler.ashx"}function Xe(c,k,D,ba,Ba,nb,Rb,Ic){this.qDa=c;this.kz=k;this.fTa=ba;this.CJc=nb;this.n7=D;this.bkg=Ba;this.Tda=Rb;this.qh=Ic}function If(c,k,D,ba){this.qh=this.Z4d=null;this.kDa=c;this.Qr=k;this.zIc=D;this.Ce=ba}function yf(c,k,D,ba,Ba,nb,Rb){this.vb=c;this.DCc=D;this.La=k;this.sib=ba;this.lfb=Ba;this.zIc=nb;this.T$f=Rb}function Bf(){return mg.call(this)||this}function Vb(c,k,D,ba){var Ba=this;this.io=this.ohb=null;this.lfb=c;this.Ce=D;this.shg=ba;this.IBa=new Kf.a(function(){return new Qg.a(k.value,
Object(qe.a)(Ba,Ba.ssb,"getMoreInfoEventReceived"))})}function Qc(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd){this.La=k;this.vb=c;this.xW=ba;this.Xea=nb;this.Qr=Ba;this.Ce=D;this.$8d=Rb;this.yfg=void 0===Ic?null:Ic;this.kDa=void 0===Wc?null:Wc;this.RUa=void 0===Rd?null:Rd}function md(c,k,D,ba,Ba,nb,Rb,Ic,Wc){this.NGc=null;this.kz="";this.sib=c;this.Qr=k;this.qh=Wc;this.Xea=D;this.Ce=Ba;this.Vu=ba;this.kDa=Rb;this.RUa=Ic;nb&&(this.NGc=new Kf.a(function(){return new Qg.a(nb.value,null)}))}function Ce(){this.properties=
this.friendlyPath=this.folderName=null}function le(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function Zd(c,k,D,ba,Ba,nb,Rb,Ic){c=ye.call(this,c,k,D,ba,Ba,nb,Ic)||this;c.Kx=null;c.GKc=null;c.ioa=null;c.MFg=CommonUIStrings.l_SaveToAnotherFolder;c.tf=fg.tf;c.Ie="FileNameDialog-SaveToSharePoint";c.sib=Rb;c.Xgg=Ic;return c}function fg(){}function Kg(){var c=ph.call(this)||this;c.hc=0;c.yc(1,CommonUIStrings.l_DialogClose);return c}function $g(){this.Za=
null}function pa(c,k,D,ba,Ba,nb,Rb,Ic){this.jm=null;this.lUa=this.xBa=!1;this.Wea=this.qh=this.kz=null;this.vb=k;this.qDa=this.vb.appSettings.SaveAsToHostWebServiceBase;this.Y0d=ba;this.Phb=Ba;this.Ng=D;this.Qr=nb;this.jh=Ic;this.Ce=Rb;this.La=c;this.Tda=k.Ta("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function tb(c,k,D){this.Xea=D;this.DCc=k;this.vb=c}function qc(c,k,D,ba,Ba,nb){this.La=k;this.vb=c;this.xW=ba;this.Xea=nb;this.Qr=Ba;this.Ce=D}function jd(c,k,D,ba,Ba,nb){c=ye.call(this,
c,k,D,ba,Ba,nb)||this;c.tf=Sd.tf;c.Ie="FileNameDialog-SaveAsToHost";return c}function Sd(){}function ye(c,k,D,ba,Ba,nb,Rb){Rb=void 0===Rb?null:Rb;var Ic=Dd.call(this)||this;Ic.dI=null;Ic.La=k;Ic.xW=ba;Ic.Xea=nb;Ic.vb=c;Ic.Qr=Ba;Ic.Ce=D;Ic.ffb=Ic.vb.sa("SaveToHostWithExtraCharsInFileName");Ic.qh=Rb;Ic.yc(1,CommonUIStrings.l_SaveButtonLabel);return Ic}function Ye(c,k){this.vb=c;this.La=k;this.ffb=this.vb.sa("SaveToHostWithExtraCharsInFileName")}function wf(c,k){var D=ya.call(this)||this;D.lUa=!1;D.kz=
null;D.La=c;D.ffb=k;D.QPa=!1;return D}function Ma(){this.Za=null}function gb(c){this.Hl=null;this.Ng=c;this.cKc=3}function Wb(c,k,D,ba){k=Bc.call(this,c,k,D,ba)||this;k.options.advanced.filter=c.Ta("OneDriveApiV72Filter")||"folder,photo";k.options.advanced.linkType="download";k.options.multiSelect=wd.AFrameworkApplication.iie;c.sa("OneDriveApiV72CommandModeEnabled")&&(k.options.commandMode=c.Ta("OneDriveApiV72CommandMode")||"none");c.sa("OneDriveApiV72QosExtraDataEnabled")&&(k.options.qosExtradata=
new Kc(wd.AFrameworkApplication.userSessionId));return k}function Kc(c){this.olsSessionId=this.value=this.key=null;this.olsSessionId=c}function Bc(c,k,D,ba){k=ge.call(this,c,k,D,ba)||this;k.K9f=c;k.options={};k.options.advanced={};k.options.action="query";k.options.clientId=k.ha.Ta("OneDriveApiV72ClientId");k.options.advanced.trapFocus=!0;return k}function Fb(c,k,D,ba,Ba){c=ge.call(this,c,k,D,ba)||this;c.V5d=null;c.NOb=null;c.Pbg=Ba;c.options={};c.options.clientId=c.ha.Ta("OneDriveApiV7ClientId");
c.options.cancel=Object(qe.a)(c,c.Fuc,"toggleHostDivVisibility");return c}function bc(c,k,D,ba,Ba,nb){k=ge.call(this,k,D,ba,nb)||this;k.qh=null;k.N0=c;k.Pjg=Ba;return k}function ge(c,k,D,ba){this.yCa=this.V4=null;this.ZKc=this.aLc=!1;this.kUa=null;this.vb=c;this.sMb=k;this.eCa=D;this.Qr=ba}function Jd(){}function ue(){var c=Re.call(this)||this;c.hc=0;c.yc(1,CommonUIStrings.l_DialogClose);return c}function qd(){}function Ud(c,k,D,ba){this.kfb=c;this.Moa=k;this.H0=D;this.bdg=ba}function ed(c,k,D,ba,
Ba,nb,Rb){var Ic=this;this.io=null;this.m9d=!1;this.coa=this.aWd=0;this.sgg=c;this.iUa=k;this.rQb=D;this.kfb=ba;this.Moa=Ba;this.H0=nb;this.IBa=new Kf.a(function(){return new Qg.a(Rb.value,Object(qe.a)(Ic,Ic.ssb,"getMoreInfoEventReceived"))})}function xd(c,k,D,ba,Ba,nb,Rb,Ic){var Wc=this;this.cAc=null;this.pNc=!0;this.KMb="";this.rlg=0;this.UTa=null;this.xGc=3;this.vb=Ic;this.H0=c;this.Wi=k;this.pcg=D;this.w$f=ba;this.v$f=Ba;this.IBa=new Kf.a(function(){return new Qg.a(nb.value,null)});this.cdg=new Kf.a(function(){return new Qg.a(Rb.value,
Object(qe.a)(Wc,Wc.uji,"mruEventResultReceived"))});this.vb.sa("WacInTabOpenMRUIsEnabledForUiHost");this.vb.sa("UiHostSupportsDocRebootFeatures")}function Lg(){return Hh.call(this)||this}function hg(c,k,D,ba,Ba,nb){var Rb=this;this.qMc=this.io=this.LMb=null;this.ESb=this.wLc=!1;this.n4d=0;this.kLc=this.FFc=!1;this.H0=c;this.kfb=k;this.IBa=new Kf.a(function(){return new Qg.a(D.value,Object(qe.a)(Rb,Rb.ssb,"getMoreInfoEventReceived"))});this.jgg=ba;this.Moa=Ba;this.Gjg=nb;this.Bib=this.Trc;2===this.LJ.Faa&&
(this.kLc=!0)}function Dg(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function cf(){}function Hg(){}b.r(F);var uh=b(509),te=b(0),Wg=b(276);Hg.prototype.Qh=function(){};Hg.prototype.init=function(){};Hg.prototype.dispose=function(){};Hg.main=function(){Wg.a.instance.ej(new Hg)};Ll.Object.defineProperties(Hg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(te.a)(Hg,"CommonAppDialogWithLinkToResourcePackage",null,
[8,9]);var Kf=b(675),nd=b(15),qe=b(37),Qg=b(924),ae=b(30),Nh=b(124);cf.n8g=function(c){return cf.Nme("New",c)};cf.o8g=function(c){return cf.Nme("Open",c)};cf.wme=function(c,k){return cf.Tfa("LoadingMenuSection",cf.zbi,c,cf.amb("lblLoading",k))};cf.bmb=function(c,k,D,ba){return cf.Tfa("MessageMenuSection",cf.Fgf,k,cf.amb("lblMessage",c,void 0===D?null:D,void 0===ba?null:ba))};cf.hEg=function(c){return cf.wme(c,CommonUIStrings.l_VoicedLoadingText)};cf.iEg=function(c,k){return cf.bmb(CommonUIStrings.l_NewCreationLocationMessage,
c.Qi,k.$U,k.$ya)};cf.gEg=function(c,k){return cf.bmb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,k.$ya,"\n\n"),c.Qi)};cf.yme=function(c){return cf.bmb(CommonUIStrings.l_NewGenericErrorMessage,c.Qi)};cf.eEg=function(c,k,D){return cf.Tfa("menuNewBlank",cf.MQh,D?c.Qi:null,cf.Wlb(c.BZe,c.CZe,c.DZe,null,c.Dia,c.iub,k,"blank"))};cf.eFg=function(){return cf.amb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};cf.Ime=function(){return cf.amb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};
cf.fFg=function(c,k){return cf.Tfa("menuNewTemplates",c,null,k)};cf.cEg=function(c,k){return cf.Tfa("menuNewMoreTemplates",cf.YLe,null,cf.Wlb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,c,k))};cf.iDg=function(c,k,D){var ba="";D&&k&&(ba=cf.Tfa("BrowseMoreMenuSection",cf.YLe,null,cf.Wlb("btnBrowseMore",k,k,null,null,null,c||"1959943459",D)));return ba};cf.amb=function(c,k,D,ba){D=void 0===D?null:D;var Ba=ba=void 0===ba?null:ba;k&&
0<k.length&&(Ba=cf.vhf.ukc(k).trimEnd(),Ba=0<=Ba.indexOf("{0}")?String.format(Ba,ba):String.format("{0} {1}",Ba,ba));D=D&&ba?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',ae.a.If(D),ae.a.If(ba),ae.a.If(Ba)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',ae.a.If(c||""),cf.vhf.ukc(ae.a.If(k||"")),D)};cf.Wlb=function(c,k,D,ba,Ba,nb,Rb,Ic){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
ae.a.If(c||""),ae.a.If(k||""),ae.a.If(D||""),ba||"32by32",ae.a.If(Ba||""),ae.a.If(nb||""),Rb,ae.a.If(Ic||""))};cf.Nme=function(c,k){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',c,k)};cf.Tfa=function(c,k,D,ba){D=D?String.format('Title="{0}"',ae.a.If(D)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
ae.a.If(c||""),ae.a.If(k||""),D,ba)};cf.Fgf="MenuMru";cf.zbi="MenuLoading";cf.MQh="MenuHeader";cf.YLe="MenuFooter";cf.vhf=Nh.a.Gw("\n","&#10;");Object(te.a)(cf,"NewAndOpenXmlUtilities",null,[]);var wd=b(5),ze=b(93),Ah=b(213);Object(te.a)(Dg,"HostInformation",null,[]);var Xh=b(109),pg=b(48),vg=b(519),Ih=b(178),Eh=b(678),Zh=b(590),ih=b(108),eg=b(28);hg.prototype.Lg=function(){var c=this.LJ.Q5a;c.Xb(eg.a.newDocument,ih.a.frame,Object(qe.a)(this,this.newDocument,"newDocument"));c.Af(eg.a.Lkc,ih.a.frame,
Object(qe.a)(this,this.Lkc,"populateNewMenu"),96)};hg.prototype.newDocument=function(c,k,D,ba,Ba){return 1===D?32:2===D&&Ba&&Ba.MenuItemId&&Ba.SourceControlId?this.HYa(Ba.MenuItemId,Ba.SourceControlId):8};hg.prototype.HYa=function(c,k){var D=this.Ugc.zZc;if(null===D)return 8;var ba=wd.AFrameworkApplication.ha.sa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(wd.AFrameworkApplication.pja&&ba){nd.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var Ba={};Ba[vg.a.VIb]=c;Ba[vg.a.pO]=this.pO;Ba[vg.a.lcid]=wd.AFrameworkApplication.lcid.toString();Ba[vg.a.reason]=Eh.a.createNew;wd.AFrameworkApplication.yY().execute(function(nb){nb.Vj(Ih.a.HYa,Ba)})}else ba=(new Date).getTime(),k=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",D,ae.a.ff(this.Vja),ae.a.ff(c),ae.a.ff(this.pO),ae.a.ff(wd.AFrameworkApplication.lcid.toString()),ae.a.ff(ba.toString()),ae.a.ff(k),ae.a.ff(wd.AFrameworkApplication.canary),
wd.AFrameworkApplication.Xi),(D=wd.AFrameworkApplication.ha.Ta("ScenarioId"))&&""!==D&&(k+="&wdscenarioid="+ae.a.ff(D)),k+="&"+wd.AFrameworkApplication.D8b(),wd.AFrameworkApplication.Rua&&(k+="&"+wd.AFrameworkApplication.Y7b()),(D=this.io?this.io.$U:null)&&(k+="&DestinationUrl="+ae.a.ff(D)),pg.a.lf(k,"_blank",void 0,"CreateNewDocument");2===this.LJ.Faa&&(k={},nd.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(k.AppType=Zh.a[this.LJ.Faa],k.Template=c,k)));return 32};hg.prototype.mei=
function(c){var k=Number.MAX_VALUE,D=Number.MIN_VALUE,ba=window.performance;if(ba&&"undefined"!==typeof ba.getEntriesByName){for(var Ba=0;Ba<c.length;Ba++){var nb=ba.getEntriesByName(c[Ba]);nb&&0<nb.length&&(nb=nb[0],k=Math.min(parseInt(String(nb.fetchStart)),k),D=Math.max(parseInt(String(nb.responseEnd)),D))}D>k&&(c={},nd.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(c.TotalElapsedMs=D-k,c.MinFetchStart=k,c.MaxResponseEnd=D,c)))}};hg.prototype.Lkc=function(c,k,
D,ba,Ba){if(1===D)return this.kLc&&(wd.AFrameworkApplication.lM("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.kLc=!1),32;2!==D||this.FFc||(this.n4d=(new Date).getTime(),c={},nd.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(c.ShouldShowTemplates=this.Trc,c.CachedNewMenuXmlExists=!!this.LMb,c.ShouldCallGetMoreInfo=this.LJ.supportsGetMoreInfoForPersonalStorage,c)));return this.KGi(Ba)};hg.prototype.KGi=function(c){c&&(this.LMb?c.PopulationXML=
this.LMb:(this.LJ.supportsGetMoreInfoForPersonalStorage&&!this.io&&this.Mki.oy("Opened New menu",!0),c.PopulationXML=this.Msh(this.getTemplateListJson())));return 32};hg.prototype.J7e=function(){return!this.LJ.supportsGetMoreInfoForPersonalStorage||!!this.io&&3===this.io.state&&!!this.io.$ya&&!!this.io.$U};hg.prototype.i5h=function(){return wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.xa.Xa.YY?!0:this.J7e()};hg.prototype.getTemplateListJson=function(){var c=this;if(!this.Trc||!this.i5h())return null;
if(this.Bib&&!this.ESb){var k="9",D=wd.AFrameworkApplication.ha.appSettings;"NumberOfTemplatesInBackstage"in D&&(k=D.NumberOfTemplatesInBackstage);var ba=this.pO;"TemplateCollectionId"in D&&(ba=D.TemplateCollectionId);k=String.format(this.LJ.vZ+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",ae.a.ff(wd.AFrameworkApplication.lcid.toString()),ae.a.ff(ba),k);Boolean.parse(D.AppendOriginQueryParam||"false")&&(k+="&org=backstage");k+="&"+wd.AFrameworkApplication.D8b();wd.AFrameworkApplication.Rua&&
(k+="&"+wd.AFrameworkApplication.Y7b());this.LJ.dzb.Jl(k,1,null,null,!1,2,function(Ba){c.LJ.xLa("CreateNewActor.GetTemplateListJson",Ba.data);c.Noj(Ba.data.ae)},function(Ba){c.LJ.xLa("CreateNewActor.GetTemplateListJson",Ba.data);c.Moj()},null,void 0,void 0,void 0,void 0,"5");this.Bib=!1}return this.qMc};hg.prototype.Noj=function(c){this.qMc=c;this.Bib=!1;this.xDb();if(wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.xa.Xa.YY&&Ah.appChromeAlreadyLoaded()){c=wd.AFrameworkApplication.ha.sa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var k=wd.AFrameworkApplication.pja;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.qMc,!0,c&&k))}};hg.prototype.Moj=function(){this.ESb=this.Bib=!0;this.xDb();wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.xa.Xa.YY&&Ah.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));ze.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};hg.prototype.HJh=function(c){for(var k=
0,D=0;D<c.length;D++)if("ST"===c[D].ImageType){k=D;break}var ba=c.length?c[k]:null;c=ba?ba.Url||"":"";var Ba,nb=D=k=!1;if(ba&&(Ba=ba.AspectRatio))Ba=parseFloat(Ba),1>Ba?k=!0:1.5<Ba?D=!0:1===Ba&&(nb=!0);else switch(Ba={},nd.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(Ba.Url=c,Ba)),this.LJ.Faa){case 3:k=!0;break;case 2:D=!0;break;case 5:nb=!0}return{returnValue:c,kTh:k?"95by123":D?"123by69":nb?"100by100":"123by95"}};hg.prototype.Msh=function(c){var k=this.fEg(c,this.Ugc,this.Ugc.xEa||
"1056925771");c=k.returnValue;if(k.rrc){this.LMb=c;k=(new Date).getTime()-this.n4d;var D={};nd.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(D.ElapsedMsSinceMenuOpened=k,D))}return c};hg.prototype.ssb=function(c,k){nd.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.io||3!==c.state?2===c.state&&(nd.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.wLc=!0,this.xDb()):(this.io=c,k||this.xDb(),wd.AFrameworkApplication.xa&&
wd.AFrameworkApplication.xa.Xa.YY&&Ah.appChromeAlreadyLoaded()&&Ah.appChromeContainsAction("setFileMenuHostInformation")&&(c=Object.assign(new Dg,{hostUrl:this.io.$U,hostName:this.io.$ya,folderUrl:wd.AFrameworkApplication.breadcrumbFolderUrl,folderName:wd.AFrameworkApplication.breadcrumbFolderName}),nd.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(c))))};hg.prototype.fEg=function(c,k,D){var ba=!1;var Ba=
this.J7e(),nb="";if(this.LJ.supportsGetMoreInfoForPersonalStorage)if(this.wLc)nb=cf.yme(k),this.wLc=!1,nd.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.io)if(Ba)nb=cf.iEg(k,this.io);else if(this.io.eYh)ba=!0,this.Bib=!1,nb=cf.gEg(k,this.io),nd.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{ba=!0;nb=cf.yme(k);var Rb={};nd.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
(Rb.PersonalFileStorageUrlIsSet=!!this.io.$U,Rb.StorageServiceDisplayNameIsSet=!!this.io.$ya,Rb))}else nb=cf.hEg(k.Qi),nd.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");Ba&&(Ba=nb,k=cf.eEg(k,D,!nb),c=this.dFg(c,D),ba=c.rrc,nb=Ba+(k+c.returnValue));return{returnValue:cf.n8g(nb),rrc:ba}};hg.prototype.dFg=function(c,k){var D=!1;if(!this.Trc)return D=!0,nd.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",rrc:D};var ba=
"",Ba="",nb="MenuTemplate";if(this.ESb)ba=cf.Ime(),this.ESb=!1,nd.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(c){try{var Rb=Sys.Serialization.JavaScriptSerializer.deserialize(c,!0);ba=this.cFg(Rb,k);nd.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");wd.AFrameworkApplication.whf&&"OneDrive"===this.Vja&&(Ba=cf.cEg(this.Nki,wd.AFrameworkApplication.whf))}catch(Ic){k={},nd.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
(k.JsonToConvert=c,k)),ba=cf.Ime()}D=!0}else nb="MenuLoading",ba=cf.eFg(),nd.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:cf.fFg(nb,ba)+Ba,rrc:D}};hg.prototype.cFg=function(c,k){for(var D=this,ba="",Ba=[],nb=0;nb<c.length;nb++){var Rb=c[nb],Ic="";if(Rb){var Wc=Rb.Title,Rd=Rb.AssetId,Ge=Rb.Thumbnails;Rd&&Wc&&Ge&&(Rb=void 0,Ic=this.HJh(Ge),Rb=Ic.kTh,Ic=Ic.returnValue,ba+=cf.Wlb("jbtnNewTemplate"+nb,Wc,null,Rb,null,Ic,k,Rd))}Ba[nb]=Ic}c=new Xh.a(4,
1,5E3,function(){D.mei(Ba)},106);this.LJ.Sgc.kh(c);return ba};hg.prototype.xDb=function(){this.FFc=!0;this.LJ.ohf.Yv(this.Ugc.Sqb);this.FFc=!1};Ll.Object.defineProperties(hg.prototype,{pO:{configurable:!0,enumerable:!0,get:function(){switch(this.LJ.Faa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},LJ:{configurable:!0,enumerable:!0,get:function(){return this.H0.value}},Ugc:{configurable:!0,enumerable:!0,get:function(){return this.kfb.value}},
Mki:{configurable:!0,enumerable:!0,get:function(){return this.IBa.value}},Nki:{configurable:!0,enumerable:!0,get:function(){return this.jgg.value}},Vja:{configurable:!0,enumerable:!0,get:function(){return this.Moa.value}},Trc:{configurable:!0,enumerable:!0,get:function(){return this.Gjg.value}}});Object(te.a)(hg,"CreateNewActor",null,[]);var oh=b(1296),Hh=oh.a;Em(Lg,Hh);Lg.prototype.Fee=function(){this.nS(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.nS(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.nS(2,CommonUIStrings.l_Open);this.nS(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.nS(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.nS(5,CommonUIStrings.l_VoicedLoadingText)};Lg.zCi=function(c){return Lg.instance.da(c)};Ll.Object.defineProperties(Lg,{instance:{configurable:!0,enumerable:!0,get:function(){return Lg.Ma||(Lg.Ma=new Lg)}}});Lg.Ma=null;Object(te.a)(Lg,"MruActorIntlHelper",oh.a,[]);var X;(function(c){c[c.success=0]="success";c[c.failure=1]="failure";c[c.spinner=2]="spinner";c[c.none=
3]="none"})(X||(X={}));Object(te.b)("DisplayState",X);var Xa=b(41);xd.prototype.uji=function(c,k){this.UTa=c;k||this.LCf()};xd.prototype.$Qi=function(){this.jC.Q5a.Af(eg.a.Kkc,ih.a.frame,Object(qe.a)(this,this.Kkc,"populateMruMenu"),96)};xd.prototype.Kkc=function(c,k,D,ba,Ba){return 1!==D&&Ba?this.GGi(Ba):32};xd.prototype.GGi=function(c){this.S8g();this.R8g();c.PopulationXML=cf.o8g(this.KMb+this.cAc);return 32};xd.prototype.S8g=function(){var c=3,k=!1;if(this.KMb&&this.rlg===this.UTa.oqj)c={},nd.ULS.sendTraceTag(5849627,
202,50,"Open menu MRU entries to XML conversion not required {0}",(c.CacheRefresh="Not Dirty",c)),c=this.xGc;else{var D={};nd.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(D.CacheRefresh="Starting",D));D=this.jC.wv();this.UTa=this.tji.oy("File Open opened",!0);if(this.KMb&&2!==this.xGc&&3!==this.UTa.state)k=!0;else{c=this.KHh(this.UTa);wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.xa.Xa.YY&&Ah.appChromeAlreadyLoaded()&&c&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(c,
!0));var ba=this.Nsh(this.UTa);c=ba.Eki;this.KMb=ba.returnValue}D=this.jC.wv()-D;ba={};nd.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(ba.CacheRefresh="Complete",ba.ElapsedMs=D,ba))}2!==c&&(D={},D=(D.DisplayState=X[c],D),1!==c&&(D.IsStale=k),nd.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",D));this.xGc=c};xd.prototype.KHh=function(c){try{var k=Xa.c(c.mqd)}catch(D){k=null,nd.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
D)}return k};xd.prototype.R8g=function(){if(this.pNc){nd.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var c=this.Afi();this.pNc=c.yCj;this.cAc=c.returnValue}else nd.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");c={};nd.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(c.WaitingOnLinkInfo=this.pNc,c.NotDisplayingLink=!this.cAc,c))};xd.prototype.Nsh=function(c){if(1!==c.state&&c.state)if(3===c.state&&c.mqd){var k=
this.dEg(c.mqd);c=0}else c={},nd.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(c.Display="Server Error",c)),k=cf.bmb(this.lia(1),this.lia(2)),c=1;else c={},nd.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",(c.Display="Spinner",c)),c=2,k=cf.wme(this.lia(2),this.lia(5));return{returnValue:k,Eki:c}};xd.prototype.dEg=function(c){var k=this.Fyb.xEa||"2155708348";if(c.length){var D=cf.amb("lblRecentDocuments",this.lia(3));for(var ba=0,Ba=0;Ba<c.length;Ba++){var nb=c[Ba];"FileName"in
nb&&"DocumentUrl"in nb&&"Path"in nb&&(D+=cf.Wlb("MruButton"+Ba,nb.FileName.toString(),nb.Path.toString(),null,this.Fyb.Dia,this.Fyb.iub,k,nb.DocumentUrl.toString()),nb.IsPinned&&ba++)}D=cf.Tfa("RecentDocumentsMenuSection",cf.Fgf,this.lia(2),D);k={};nd.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(k.Display="MRU List",k.TotalDocuments=c.length,k.NumPinnedDocuments=ba,k))}else D=cf.bmb(this.lia(0),this.lia(2)),c={},nd.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",(c.Display=
"Empty MRU",c));return D};xd.prototype.Afi=function(){var c=!0;var k=this.BCg,D=this.ACg;if(k&&D||!this.jC.supportsGetMoreInfoForPersonalStorage)c=!1;else{var ba=this.i8b.oy("File Open",!1);3===ba.state&&(k=ba.$U,D=ba.$ya,c=!1)}D=D?String.format(this.lia(4),D):null;return{returnValue:cf.iDg(this.Fyb.xEa,D,k),yCj:c}};xd.prototype.LCf=function(){this.jC.ohf.Yv(this.Fyb.Sqb)};Ll.Object.defineProperties(xd.prototype,{jC:{configurable:!0,enumerable:!0,get:function(){return this.H0.value}},lia:{configurable:!0,
enumerable:!0,get:function(){return this.Wi.value}},Fyb:{configurable:!0,enumerable:!0,get:function(){return this.pcg.value}},BCg:{configurable:!0,enumerable:!0,get:function(){return this.w$f.value}},ACg:{configurable:!0,enumerable:!0,get:function(){return this.v$f.value}},i8b:{configurable:!0,enumerable:!0,get:function(){return this.IBa.value}},tji:{configurable:!0,enumerable:!0,get:function(){return this.cdg.value}}});Object(te.a)(xd,"MruRenderer",null,[]);var Pb=b(231),Gc=b(879);ed.prototype.HYa=
function(){!this.io&&this.Wqd.supportsGetMoreInfoForPersonalStorage?this.i8b.oy("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};ed.prototype.ssb=function(c){if(!this.io&&3===c.state)this.io=c;else if(2===c.state){this.m9d?nd.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.i8b.oy("NewDocumentFromStream",!0),this.m9d=!0);return}this.createNewDocumentFromStream()};ed.prototype.createNewDocumentFromStream=function(){this.aWd=(new Date).getTime();var c=
this.glh.zZc;if(null===c)this.iUa(null);else{var k=this.rQb.menuItemId,D=this.rQb.EH,ba=this.rQb.wmj,Ba=this.rQb.klh;this.coa="streamBase64"===ba?Ba.length/1024:0;nd.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.pO,this.coa);var nb=(new Date).getTime();c=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",c,ae.a.ff(this.Vja),ae.a.ff(k),ae.a.ff(this.pO),ae.a.ff(wd.AFrameworkApplication.lcid.toString()),ae.a.ff(nb.toString()),
ae.a.ff(D),ae.a.ff(wd.AFrameworkApplication.canary),wd.AFrameworkApplication.Xi,ae.a.ff(ba));c+="&"+wd.AFrameworkApplication.D8b();wd.AFrameworkApplication.Rua&&(c+="&"+wd.AFrameworkApplication.Y7b());(k=this.io?this.io.$U:null)&&(c+="&DestinationUrl="+ae.a.ff(k));this.Wqd.dzb.Jl(c,2,Ba,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(qe.a)(this,this.Hki,"newDocumentFromStreamSuccessHandler"),Object(qe.a)(this,this.Gki,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,
void 0,"31")}};ed.prototype.Hki=function(c){if(c&&c.data&&c.data.ae){var k=Xa.d(c.data.ae);var D=k.eu;k.returnValue?D.StatusCode!==Pb.a.JN&&D.StatusCode!==Pb.a.tob?(nd.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.pO,this.coa,D.StatusCode),this.iUa(null)):D.NewDocumentUrl&&""!==D.NewDocumentUrl?(c=(new Date).getTime()-this.aWd,nd.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.pO,this.coa,
c),this.sgg(D.NewDocumentUrl)):(nd.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.pO,this.coa),this.iUa(null)):(D={},nd.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.pO,this.coa,(D.ResponseData=Gc.a.Ebb(c.data.ae),D)),this.iUa(null))}else nd.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.pO,this.coa),this.iUa(null)};ed.prototype.Gki=function(c){c&&c.data&&nd.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.pO,this.coa,c.data.status);this.iUa(null)};Ll.Object.defineProperties(ed.prototype,{pO:{configurable:!0,enumerable:!0,get:function(){switch(this.Wqd.Faa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},glh:{configurable:!0,enumerable:!0,
get:function(){return this.kfb.value}},Vja:{configurable:!0,enumerable:!0,get:function(){return this.Moa.value}},Wqd:{configurable:!0,enumerable:!0,get:function(){return this.H0.value}},i8b:{configurable:!0,enumerable:!0,get:function(){return this.IBa.value}}});Object(te.a)(ed,"NewDocumentFromStreamOperation",null,[]);Ud.prototype.create=function(c,k,D){return new ed(c,k,D,this.kfb,this.Moa,this.H0,this.bdg)};Object(te.a)(Ud,"NewDocumentFromStreamOperationFactory",null,[700]);var Hc=b(88),Ld=b(520),
Ie=b(51);qd.prototype.Qh=function(c){c.register(Ud,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").wc().Fc(function(){return new Ud(new Kf.a(function(){return wd.AFrameworkApplication.xa.Xa.q9c()}),new Kf.a(function(){return wd.AFrameworkApplication.Vja}),new Kf.a(function(){return c.Mh("Common.INewAndOpenCommonHelpers")}),new Kf.a(function(){return c.Mh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
qd.prototype.init=function(){var c=this;wd.AFrameworkApplication.ha.Dv(function(){c.Cub()})};qd.prototype.Cub=function(){var c=Ld.a.mq(Hc.a.instance.oc("Common.INewAndOpenCommonHelpers")),k=Ld.a.mq(Hc.a.instance.oc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));wd.AFrameworkApplication.Vja&&Ie.Task.WAA.call(null,c,k).continueWith(function(){var ba=new hg(new Kf.a(function(){return c.result}),new Kf.a(function(){return wd.AFrameworkApplication.xa.Xa.q9c()}),new Kf.a(function(){return k.result}),
new Kf.a(function(){return wd.AFrameworkApplication.xa.Xa.r9c().xEa||"1959943459"}),new Kf.a(function(){return wd.AFrameworkApplication.Vja}),new Kf.a(function(){return wd.AFrameworkApplication.W3h}));ba.Lg();ba.xDb()});if(wd.AFrameworkApplication.zBf){var D=Ld.a.mq(Hc.a.instance.oc("Common.IEventEmitter<Common.IMruResult>"));Ie.Task.WAA.call(null,c,k,D).continueWith(function(){var ba=new xd(new Kf.a(function(){return c.result}),new Kf.a(function(){return Lg.zCi}),new Kf.a(function(){return wd.AFrameworkApplication.xa.Xa.r9c()}),
new Kf.a(function(){return wd.AFrameworkApplication.yCi}),new Kf.a(function(){return wd.AFrameworkApplication.xCi}),new Kf.a(function(){return k.result}),new Kf.a(function(){return D.result}),wd.AFrameworkApplication.ha);ba.$Qi();ba.LCf()})}};qd.prototype.dispose=function(){};Ll.Object.defineProperties(qd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(te.a)(qd,"UXPackageManager",null,[8,9,6]);var Td=b(128),Re=Td.StandardDialog;Em(ue,Re);ue.prototype.displayError=
function(c){this.Qy(c,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};ue.prototype.j1c=function(c){this.Qy(c,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(te.a)(ue,"ErrorDialog",Td.StandardDialog,[771]);var ff=b(139);Jd.prototype.YNe=function(){nd.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var c=new ff.a;c.setResult("api.onedrive.com");return c.task};Object(te.a)(Jd,"OneDriveConsumerEndpointHelper",
null,[655]);var Of=b(50),kg=b(369),Rf=b(219);ge.prototype.U0a=function(){this.kUa||(this.kUa=this.a7a?Rf.a.create(this.a7a,null,null,null,!1):null);return this.kUa};ge.prototype.setup=function(c){var k=this;this.yCa=c;this.aLc||this.ZKc?this.aLc&&this.yCa&&this.yCa(!0):(c=this.U0a())?(this.ZKc=!0,c.a5a.continueWith(function(D){k.Ywi(D)}),kg.a.Zga(c)):(nd.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.yCa(!1))};ge.prototype.Std=function(c){nd.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",c.Cg?c.Cg.toString():"No error detail.")};ge.prototype.Ywi=function(c){this.ZKc=!1;if(c.gg)this.Std(c),this.yCa(!1);else try{this.aLc=!0,nd.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.ifd(),nd.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.yCa(!0)}catch(k){nd.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",k.toString()),this.yCa(!1)}};ge.prototype.startPicker=function(c){this.V4=
c;this.eCa?nd.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(nd.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(qe.a)(this,this.xsd,"onApiReady")))};ge.prototype.xsd=function(c){c?this.wec():this.ai()};ge.prototype.ai=function(){this.Qr().displayError(Of.a.$Bi)};ge.prototype.onSuccess=function(c){nd.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.V4&&this.V4(!0,c)};
ge.prototype.dispose=function(){this.kUa&&this.kUa.dispose()};Ll.Object.defineProperties(ge.prototype,{bie:{configurable:!0,enumerable:!0,get:function(){return this.sMb}},ha:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(te.a)(ge,"AOneDriveFilePickerApiManager",null,[714,6]);Em(bc,ge);bc.prototype.start=function(c,k){this.qh=c;this.startPicker(k)};bc.prototype.ifd=function(){var c={},k={};c=1===this.bie||2===this.bie?(c.client_id=this.ha.appSettings.UploadToSkyDriveClientId,
c):(k.client_id=this.ha.appSettings.UploadToSkyDriveClientId,k.env="INT",k);WL.init(c)};bc.prototype.startPicker=function(c){this.V4=c;!this.eCa&&this.N0.OJa?(nd.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(qe.a)(this,this.xsd,"onApiReady"))):(nd.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Pjg())};bc.prototype.wec=function(){try{nd.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.qh).then(Object(qe.a)(this,
this.onSuccess,"onSuccess"),Object(qe.a)(this,this.U4,"onFailure"))}catch(c){nd.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",c,c.stack),this.ai()}};bc.prototype.U4=function(c){if(c&&c.error){if("user_canceled"===c.error.code){nd.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}nd.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",c.error.code,c.error.message)}else nd.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.V4&&this.V4(!1,c);this.ai()};Ll.Object.defineProperties(bc.prototype,{a7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Ta("OneDriveApiUrl")}}});Object(te.a)(bc,"OneDriveFilePickerApiManagerV5",ge,[]);Em(Fb,ge);Fb.prototype.start=function(c,k){var D=this;this.NOb=k;var ba=this.Pbg.YNe();ba.continueWith(function(){nd.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");D.V5d=ba.result;D.startPicker(function(Ba,
nb){D.Fuc();c(Ba,nb)})},3);ba.continueWith(function(){nd.ULS.sendTraceTag(24134242,352,15,ba.Cg.message);D.Fuc()},5)};Fb.prototype.ifd=function(){var c=this;this.options.success=function(k){var D={};D.data=k;c.onSuccess(D)};this.options.error=function(k){var D={};D.error=k;c.U4(D)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.V5d;this.options.advanced.iframeParentDiv=this.NOb};Fb.prototype.wec=function(){try{nd.ULS.sendTraceTag(22090007,352,
50,"Launching OneDrive file picker dialog"),this.Fuc(),OneDrive.open(this.options)}catch(c){nd.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",c.message),this.ai()}};Fb.prototype.U4=function(c){this.V4&&this.V4(!1,c);this.ai()};Fb.prototype.Fuc=function(){this.NOb.style.visibility="hidden"===this.NOb.style.visibility?"":"hidden"};Ll.Object.defineProperties(Fb.prototype,{a7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Ta("OneDriveApiV72Url")}}});
Object(te.a)(Fb,"OneDriveFilePickerApiManagerV7",ge,[]);Em(Bc,ge);Bc.prototype.start=function(c,k,D,ba){this.options.advanced.iframeParentDiv=D;this.options.advanced.endpointHint=ba;this.options.cancel=k;this.K9f.sa("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(c)};Bc.prototype.startPicker=
function(c){this.V4=c;this.eCa?nd.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(nd.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(qe.a)(this,this.xsd,"onApiReady")))};Bc.prototype.ifd=function(){var c=this;this.options.success=function(k){var D={};D.data=k;c.onSuccess(D)};this.options.error=function(k){var D={};D.error=k;c.U4(D)}};Bc.prototype.wec=function(){try{nd.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),
OneDrive.save(this.options)}catch(c){nd.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",c.message,c.stack),this.ai()}};Bc.prototype.Std=function(c){nd.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",c.Cg?c.Cg.toString():"No error detail.");kg.a.QSi(this.a7a);this.kUa=null};Bc.prototype.ai=function(){this.Qr().j1c(Of.a.j1i)};Bc.prototype.U4=function(c){this.V4&&this.V4(!1,c)};Ll.Object.defineProperties(Bc.prototype,
{a7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Ta("OneDriveApiV72Url")}}});Object(te.a)(Bc,"OneDriveFilePickerApiManagerV72",ge,[]);Object(te.a)(Kc,"IExtraData",null,[]);Em(Wb,Bc);Wb.prototype.wec=function(){try{nd.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",wd.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(c){nd.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",c.message,c.stack),this.ai()}};Ll.Object.defineProperties(Wb.prototype,{a7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Ta("OneDriveApiV72Url")}}});Object(te.a)(Wb,"OneDriveFilePickerApiOpenManagerV72",Bc,[]);gb.prototype.YNe=function(){this.Hl=new ff.a;nd.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");
this.wGd();return this.Hl.task};gb.prototype.wGd=function(c){c=void 0===c?null:c;var k=String.format("GetMoreInfoHandler.ashx?{0}",wd.AFrameworkApplication.LFa);this.Ng.l8(k,1,null,c,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(qe.a)(this,this.uDh,"getMoreInfoSucceeded"),Object(qe.a)(this,this.sDh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};gb.prototype.sDh=function(c){if(c.data.httpStatus===Pb.a.yCb&&"X-NewKey"in c.data.responseHeaders){nd.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");
var k={};k["X-Key"]=c.data.responseHeaders["X-NewKey"];this.wGd(k)}else 0<this.cKc?(nd.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.cKc),this.cKc--,this.wGd()):(nd.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Hl.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};gb.prototype.uDh=function(c){"PersonalFileStorageUrl"in c.data.responseHeaders&&
""!==c.data.responseHeaders.PersonalFileStorageUrl?(nd.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Hl.setResult(c.data.responseHeaders.PersonalFileStorageUrl)):(nd.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Hl.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(te.a)(gb,"OneDriveForBusinessEndpointHelper",null,[655]);var Ig=b(577);Ma.prototype.init=function(){};
Ma.prototype.dispose=function(){};Ma.prototype.Qh=function(c){var k=this;this.Za=c;this.Za.register(bc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").wc().Fc(function(){return new bc(Ig.a.instance,wd.AFrameworkApplication.ha,wd.AFrameworkApplication.b_a,wd.AFrameworkApplication.limitedEdit,wd.AFrameworkApplication.PTf,function(){return new ue})});wd.AFrameworkApplication.B8e?this.Za.register(655,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").wc().Fc(function(){return new Jd}):
this.Za.register(655,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").wc().Fc(function(){return new gb(wd.AFrameworkApplication.Cd)});this.Za.register(Fb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").wc().Fc(function(){return new Fb(wd.AFrameworkApplication.ha,wd.AFrameworkApplication.b_a,wd.AFrameworkApplication.limitedEdit,function(){return new ue},k.Za.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.Za.register(Bc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").wc().Fc(function(){return new Bc(wd.AFrameworkApplication.ha,
wd.AFrameworkApplication.b_a,wd.AFrameworkApplication.limitedEdit,function(){return new ue})});this.Za.register(Wb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").wc().Fc(function(){return new Wb(wd.AFrameworkApplication.ha,wd.AFrameworkApplication.b_a,wd.AFrameworkApplication.limitedEdit,function(){return new ue})})};Ma.main=function(){Wg.a.instance.ej(new Ma)};Ll.Object.defineProperties(Ma.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});
Object(te.a)(Ma,"PackageManager",null,[8,9]);var ya=Td.StandardDialog;Em(wf,ya);wf.prototype.displayError=function(c,k,D){this.kz=k;this.lUa=D;nd.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",c,D);(c=this.rVc(c))?(this.hc=0,this.yc(1,CommonUIStrings.l_DialogClose)):(this.hc=6,this.yc(0,CommonUIStrings.l_DialogClose));c||nd.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Qy(Of.a.i1i,this.Y8c(c),this.iyh(c,k),Object(qe.a)(this,this.BEd,"retryDialogHandler"),
!0)};wf.prototype.BEd=function(c){1===c?(nd.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.kz?this.La.Ge(eg.a.oFb,2,[this.kz,this.lUa]):this.La.processAction(eg.a.oFb,2)):nd.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};wf.prototype.rVc=function(c){return 0>c||6<c?(nd.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",c),0):c};wf.prototype.iyh=function(c,k){c=this.rVc(c);return this.ffb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,k),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][c]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,k),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][c]};wf.prototype.Y8c=
function(c){c=this.rVc(c);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][c]};Object(te.a)(wf,"ErrorRetryDialog",Td.StandardDialog,[710]);Ye.prototype.create=function(){return new wf(this.La,this.ffb)};Object(te.a)(Ye,"ErrorRetryDialogFactory",null,[677]);var oa=b(140),yb=b(40),Dd=oa.a;Em(ye,
Dd);ye.prototype.Pze=function(c,k){this.kK(1,!!c&&c!==k);this.dI=document.getElementById(ye.dKe);yb.a.addHandler(this.dI,"change",Object(qe.a)(this,this.dic,"onFileNameChange"));yb.a.addHandler(this.dI,"input",Object(qe.a)(this,this.dic,"onFileNameChange"));this.dI.focus()};ye.prototype.a5b=function(c){return this.ffb?(new RegExp("["+this.O3b('\\/:*?"<>|')+"]")).test(c):(new RegExp("["+this.O3b('\\/:*?"<>|#{}%~&')+"]")).test(c)};ye.prototype.O3b=function(c){return c.replace(RegExp("[.*+?|()\\[\\]{}\\\\]",
"g"),"\\\\$&")};ye.prototype.hcd=function(){var c=ae.a.Bq(wd.AFrameworkApplication.nl.fn);this.kK(1,!!this.dI&&""!==this.dI.value&&this.dI.value!==c)};ye.prototype.dic=function(){var c=this;this.dI&&window.setTimeout(function(){c.hcd()},0)};ye.prototype.$4b=function(c,k){if(1!==c)nd.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{c=k[ye.dKe];k=ye.Wuf in k?k[ye.Wuf]:!1;nd.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",
ae.a.cmc(c),k);var D=ae.a.g3(wd.AFrameworkApplication.fileName);(c=c?c.trim():null)&&""!==c&&""!==D||1===this.xa.state?this.a5b(c)?this.Qr.create().displayError(1,c,k):this.Xea.jma(c+D,k,this.qh):this.Qr.create().displayError(2,c,k)}};ye.prototype.dispose=function(){this.dI&&(yb.a.removeHandler(this.dI,"change",Object(qe.a)(this,this.dic,"onFileNameChange")),yb.a.removeHandler(this.dI,"input",Object(qe.a)(this,this.dic,"onFileNameChange")),this.dI=null);Dd.prototype.dispose.call(this)};Ll.Object.defineProperties(ye.prototype,
{xa:{configurable:!0,enumerable:!0,get:function(){return this.Ce}}});ye.dKe="txtFileName";ye.Wuf="chkOverwrite";Object(te.a)(ye,"FileNameDialogBase",oa.a,[]);Ll.Object.defineProperties(Sd,{tf:{configurable:!0,enumerable:!0,get:function(){return oa.a.$i(Sd.Jj,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Sd.Jj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(te.a)(Sd,"FileNameDialogHtml",null,[]);Em(jd,ye);jd.prototype.dP=function(c,k){var D=ae.a.Bq(wd.AFrameworkApplication.nl.fn),ba={};k=(ba.txtFileName=c||D,ba.lblFolderName=CommonUIStrings.l_ToCurrentFolder,ba.chkOverwrite=k,ba);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(qe.a)(this,this.$4b,"fileNameDialogHandler"),k);this.Pze(c,D)};Object(te.a)(jd,"FileNameDialog",ye,[707]);qc.prototype.create=function(){return new jd(this.vb,this.La,this.Ce,this.xW,this.Qr,this.Xea)};Object(te.a)(qc,
"FileNameDialogFactory",null,[676]);var ie=b(677);tb.prototype.Lg=function(){2===wd.AFrameworkApplication.xa.Xa.Tk?wd.AFrameworkApplication.Hb.Af(eg.a.oFb,ih.a.frame,Object(qe.a)(this,this.hKf,"saveAsToHostActionDispatcher"),4):wd.AFrameworkApplication.Hb.Xb(eg.a.oFb,ih.a.frame,Object(qe.a)(this,this.hKf,"saveAsToHostActionDispatcher"))};tb.prototype.hKf=function(c,k,D,ba,Ba){return k.contextId!==ih.a.frame||c!==eg.a.oFb?2:this.vb.sa("SaveAsToHostBrsIsEnabled")?1===D?ie.SessionStatusManager.instance.utb||
wd.AFrameworkApplication.nU?8:32:2===D?(nd.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),c=this.DCc.create(),Ba&&Object.getType(Ba)===Array&&2===Ba.length?c.dP(Ba[0],!!Ba[1]):c.dP(null,!1),32):8:8};Object(te.a)(tb,"SaveAsToHostActor",null,[]);var xe=b(78);pa.prototype.PHb=function(){1!==this.Ce.state&&(this.jm=this.Phb(),this.jm.message=CommonUIStrings.l_CommentProgressTooltip,this.jm.hc=5,this.jm.lu=!1,this.jm.Qya(CommonUIStrings.l_DefaultDialogTitle,
null,null))};pa.prototype.UQ=function(c){c=void 0===c?0:c;1!==this.Ce.state&&this.Qr.create().displayError(c,ae.a.Bq(this.kz),this.lUa)};pa.prototype.LNa=function(){var c=this.vb.appSettings.BreadcrumbFolderUrl;nd.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");pg.a.lf(c,pg.a.pW(3),void 0,"UploadToHostManager.RedirectToFolder")};pa.prototype.KNa=function(c){var k=!1,D=!1;this.vb&&(k=this.vb.sa("SaveACopyIsEnabledForUiHost"),D=this.vb.sa("UiHostSupportsDocRebootFeatures"));
nd.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",c,k,D);if(k&&D){nd.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var ba={};ba[vg.a.GNa]="1";ba[vg.a.documentUrl]=c;ba[vg.a.reason]=Eh.a.saveAs;wd.AFrameworkApplication.yY().execute(function(Ba){Ba.Vj(Ih.a.Vra,ba)})}else k&&!D&&wd.AFrameworkApplication.q6e?pg.a.lf(c,pg.a.pW(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
pg.a.lf(c,pg.a.pW(3),void 0,"UploadToHostManager.RedirectToEditUrl")};pa.prototype.jma=function(c,k,D){D=void 0===D?null:D;nd.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Y0d&&!this.Y0d()&&this.Ng&&(this.jh&&(this.Wea=this.jh.Dc("DialogShown","SaveAsToHostUploadTime")),this.PHb(),this.lUa=k,this.kz=c,(this.qh=D)&&"true"===this.qh.SkipSaveToHost?this.u4b():this.mP())};pa.prototype.mP=function(){var c=this;32!==this.La.processAction(eg.a.BOa,1)?(nd.ULS.sendTraceTag(18989378,219,15,
"The save file change is not supported, this operation may exist data losting."),this.u4b()):this.La.Ge(eg.a.BOa,2,[function(){nd.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");c.u4b()},function(k,D){nd.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");c.UQ(D)}])};pa.prototype.oBi=function(c){this.vGa();this.xBa=!1;if(c&&c.data&&c.data.ae){var k=Xa.d(c.data.ae);var D=k.eu;if(k.returnValue)if(D.StatusCode!==
Pb.a.JN&&D.StatusCode!==Pb.a.tob)nd.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),c={},c.FailureReason=D.StatusCode.toString(),c.ExtraInfo=D.ExtraInfo,this.Qba(c),this.UQ(parseInt(D.ExtraInfo));else{nd.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.uDd();try{D.NewDocumentUrl&&""!==D.NewDocumentUrl?this.KNa(D.NewDocumentUrl):this.LNa()}catch(ba){nd.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ba.toString())}this.dCb()}else D=
{},nd.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(D.ResponseData=Gc.a.Ebb(c.data.ae),D)),c={},this.Qba((c.FailureReason="Failed to deserialize response",c)),this.UQ()}else nd.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),c={},this.Qba((c.FailureReason="null response",c)),this.UQ()};pa.prototype.nBi=function(c){if(5!==c.data.status&&12!==c.data.status||this.xBa){var k={};nd.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(k.Status=c.data.status,k.HttpStatus=c.data.httpStatus,k));k={};this.Qba((k.FailureReason=c.data.httpStatus.toString(),k));this.vGa();this.UQ();this.dCb()}else nd.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.xBa=!0,this.qh&&"true"===this.qh.SkipSaveToHost?this.u4b():this.mP()};pa.prototype.vGa=function(){this.jm&&(this.jm.close(),this.jm=null)};pa.prototype.dCb=function(){this.Wea&&(this.Wea.stop(),this.Wea=null)};pa.prototype.uDd=function(){this.qh&&"VersionHistory"===
this.qh.SaveEntryPoint&&this.La.processAction(eg.a.Rnc,2)};pa.prototype.Qba=function(c){this.qh&&"VersionHistory"===this.qh.SaveEntryPoint&&this.La.Ge(eg.a.vDd,2,c)};pa.prototype.u4b=function(){var c=this.qDa+this.Tda;c=xe.a.$k(c,"qs",ae.a.ff(wd.AFrameworkApplication.Xi));c=xe.a.$k(c,"n",ae.a.ff((new Date).getTime().toString()));c=xe.a.$k(c,"ov",ae.a.ff(this.lUa.toString()));c=xe.a.$k(c,"fn",ae.a.ff(this.kz));this.qh&&this.qh.FileDownloadUrl&&(c=xe.a.$k(c,"furl",ae.a.ff(this.qh.FileDownloadUrl)));
this.Ng.Jl(c,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(qe.a)(this,this.oBi,"onUploadFinished"),Object(qe.a)(this,this.nBi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(te.a)(pa,"UploadToHostManager",null,[674]);var Lf=b(891);$g.prototype.init=function(){wd.AFrameworkApplication.ha.Dv(Object(qe.a)(this,this.mA,"onFullAppSettingsReady"))};$g.prototype.mA=function(){wd.AFrameworkApplication.ha.sa("SaveAsToHostBrsIsEnabled")&&this.Za.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Lg()};
$g.prototype.Qh=function(c){this.Za=c;this.Za.register(Ye,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Fc(function(){return new Ye(wd.AFrameworkApplication.ha,wd.AFrameworkApplication.Hb)}).wc();this.Za.register(pa,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Fc(function(){return new pa(wd.AFrameworkApplication.Hb,wd.AFrameworkApplication.ha,wd.AFrameworkApplication.Cd,function(){return wd.AFrameworkApplication.Fg},
function(){return(new Lf.a).create()},c.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),wd.AFrameworkApplication.xa,wd.AFrameworkApplication.xa.MC)}).wc();this.Za.register(qc,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Fc(function(){return new qc(wd.AFrameworkApplication.ha,wd.AFrameworkApplication.Hb,wd.AFrameworkApplication.xa,wd.AFrameworkApplication.xa.Xa,c.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),c.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).wc();
this.Za.register(tb,"Common.App.SaveAsToHost.SaveAsToHostActor").Fc(function(){return new tb(wd.AFrameworkApplication.ha,c.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),c.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).wc()};$g.prototype.dispose=function(){};$g.main=function(){Wg.a.instance.ej(new $g)};Ll.Object.defineProperties($g.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(te.a)($g,"SaveAsToHostPackage",null,[8,9]);
var ph=Td.StandardDialog;Em(Kg,ph);Kg.prototype.displayError=function(c,k){this.iAe(c,k,Of.a.k1i)};Kg.prototype.iAe=function(c,k,D){nd.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",D);this.Qy(D,c,k,null)};Kg.prototype.j1c=function(c,k){nd.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Qy(Of.a.m1i,c,k,null,!0)};Object(te.a)(Kg,"ErrorDialog",Td.StandardDialog,[681]);Ll.Object.defineProperties(fg,{tf:{configurable:!0,enumerable:!0,
get:function(){return oa.a.$i(fg.Jj,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});fg.Jj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(te.a)(fg,"FileNameDialogHtml",null,[]);var Sf=b(13),Zg=b(90),Bh=b(87);Em(Zd,ye);Zd.prototype.dP=function(c){var k=ae.a.Bq(wd.AFrameworkApplication.nl.fn),D=wd.AFrameworkApplication.breadcrumbFolderName,ba=wd.AFrameworkApplication.breadcrumbBrandName,Ba={};Ba=(Ba.txtFileName=c||k,Ba);var nb=CommonUIStrings.L_SaveAs;2===wd.AFrameworkApplication.xa.Xa.Tk&&(nb=CommonUIStrings.L_SaveACopy);this.initializeAndShow(nb,Object(qe.a)(this,this.$4b,"fileNameDialogHandler"),Ba);this.Pze(c,k);this.mGa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");wd.AFrameworkApplication.ha.sa("HideSaveToAnotherFolderButtonforUIHost")||(this.Kx=document.getElementById("anotherFolder"),c=document.getElementById("folderLocation"),this.GKc=Bh.a.uie(c,this.Kx,"anotherFolderDescribedBy"),this.Kx.className="WACButton WACDialogButtonNormal",c=!1,D&&D.length?(this.ude(this.Kx,this.GKc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,ba,D)),c=this.Tng(ba,
D)):this.ude(this.Kx,this.GKc,CommonUIStrings.l_CurrentOnlineFolder),this.Pog(this.Kx),this.Vng(this.Kx),c?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Kx,"SaveToAnotherLocationTwo"),nd.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Kx,"SaveToAnotherLocationOne"),yb.a.addHandler(this.Kx,Sf.a.click,Object(qe.a)(this,this.Bud,"onSaveToAnotherLocationClick")),yb.a.addHandler(this.Kx,
Sf.a.Qb,Object(qe.a)(this,this.Irf,"onSaveToAnotherLocationKeyDown")))};Zd.prototype.Tng=function(c,k){var D=!1;var ba=document.getElementById("currentLocation");ba.innerText="";var Ba=this.mSe(ba,c),nb=this.mSe(ba,k),Rb=255,Ic=255;255<Ba+nb&&(Rb=Math.max(238,408-Ba),Ic=Math.max(170,408-nb),D=!0);this.kqg(ba,c,Ic,k,Rb);return D};Zd.prototype.mSe=function(c,k){var D=document.createElement("div");D.innerText=k;D.style.visibility="hidden";c.appendChild(D);k=D.clientWidth;c.removeChild(D);return k};Zd.prototype.kqg=
function(c,k,D,ba,Ba){k&&(this.sde(c,k,D),this.dqg(c));ba&&this.sde(c,ba,Ba)};Zd.prototype.sde=function(c,k,D){var ba=document.createElement("div");ba.innerText=k;ba.title=k;ba.className="SaveToAnotherFolderBreadcrumb";ba.style.maxWidth=D.toString()+"px";c.appendChild(ba)};Zd.prototype.dqg=function(c){var k=document.createElement("span");k.id="FolderSeparator";var D=document.createElementNS("http://www.w3.org/2000/svg","svg");D.setAttribute("class","SeparatorCaret");var ba=document.createElementNS("http://www.w3.org/2000/svg",
"polygon");ba.setAttribute("points","1 4 1 11 5 7.5");D.appendChild(ba);k.appendChild(D);c.appendChild(k)};Zd.prototype.ude=function(c,k,D){D=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,D);k&&(k.innerText=D);c.tabIndex=0;c.setAttribute(Bh.a.Od,Bh.a.Zq)};Zd.prototype.Vng=function(c){var k=document.createElement("span");k.id="anotherFolderText";k.innerText=this.MFg;k.className="AnotherFolderTextSpan";c.appendChild(k)};Zd.prototype.Pog=function(c){var k=document.createElement("span");
k.className="cui-img-cont-float cui-img-16by16 ";this.ioa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.ioa.setAttribute("class","FolderIconSVG");var D=document.createElementNS("http://www.w3.org/2000/svg","path");D.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.ioa.appendChild(D);k.appendChild(this.ioa);c.appendChild(k)};Zd.prototype.Irf=function(c){!c||c.keyCode!==Zg.a.Ph&&c.keyCode!==
Zg.a.W_||this.Bud(c)};Zd.prototype.Bud=function(){if(this.dI){var c=ae.a.g3(wd.AFrameworkApplication.fileName),k=this.dI.value;this.hide();k&&""!==k&&""!==c||1===this.xa.state?(""!==c&&(k+=c),this.a5b(k)?this.Qr.create().displayError(1,k,!1):this.sib.start(k,this.Xgg)):this.Qr.create().displayError(2,k,!1)}};Zd.prototype.sJg=function(c){this.Kx&&this.ioa&&(c?(this.Kx.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Kx,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.ioa,"DisabledFolderIconSVG")):
(this.Kx.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Kx,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.ioa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Kx,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.ioa,"DisabledFolderIconSVG"))))};Zd.prototype.hcd=function(){ye.prototype.hcd.call(this);this.sJg(!!this.dI&&""!==this.dI.value)};Zd.prototype.dispose=function(){this.Kx&&(yb.a.removeHandler(this.Kx,Sf.a.click,Object(qe.a)(this,this.Bud,"onSaveToAnotherLocationClick")),
yb.a.removeHandler(this.Kx,Sf.a.Qb,Object(qe.a)(this,this.Irf,"onSaveToAnotherLocationKeyDown")),this.Kx=null);ye.prototype.dispose.call(this)};Object(te.a)(Zd,"FileNameDialog",ye,[81]);var ti=b(797),ci=b(786),fi=b(211),$h=b(1028);Object(te.a)(le,"SaveAsDialogInput",null,[]);Object(te.a)(Ce,"SaveLocation",null,[]);var Th=b(177);md.prototype.qxh=function(){var c=new ti.a(ci.a.rl());c.ia("type","currentHost");return Object.assign(new Ce,{folderName:this.Vu.breadcrumbFolderName,friendlyPath:this.Vu.breadcrumbBrandName,
properties:c})};md.prototype.r6h=function(c){return!!c&&"ClassicMru"===c.type&&!!c.service_info&&!!c.service_info.service_id&&-1!==c.service_info.service_id.indexOf("SHAREPOINT")};md.prototype.aIh=function(){if(!this.NGc||!this.kDa)return null;var c=this.NGc.value.oy("SaveAsToSharePointDialog",!1);if(!c||3!==c.state||!c.Ggf)return null;c=c.Ggf;for(var k=new fi.a,D=0,ba=0,Ba=0;Ba<c.length;Ba++){var nb=c[Ba];if(this.r6h(nb)&&(D++,nb.sharepoint_info)){var Rb=nb.url,Ic=nb.sharepoint_info.site_url,Wc=
nb.title;nb=$h.b(nb,wd.AFrameworkApplication.isRtl);if(Rb&&Ic&&Wc&&nb){ba++;var Rd=new ti.a(ci.a.rl());Rd.ia("type","SharePoint");Rd.ia("siteUrl",Ic);Rd.ia("folderUrl",Rb);ba++;k.add(Object.assign(new Ce,{folderName:Wc,friendlyPath:nb,properties:Rd}))}}}Ba=new Map;Ba.set("NumPlaces",c.length.toString());Ba.set("NumSharepointPlaces",D.toString());Ba.set("placesWithMetadata",ba.toString());ze.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Ba);0<D&&(ba?.5>1*ba/D&&ze.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):ze.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return k};md.prototype.hyh=function(){var c=new fi.a;c.add(this.qxh());var k=this.aIh();k&&c.addRange(k);return Object.assign(new le,{enableMoreLocations:!wd.AFrameworkApplication.ha.sa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.kz,extension:ae.a.g3(this.Vu.fn),saveLocations:c.toArray(),scenario:"SaveToSharePoint"})};md.prototype.eyh=function(){return{inputPropsCallback:Object(qe.a)(this,
this.hyh,"getDialogInput")}};md.prototype.dP=function(c){this.kz=c;this.kz||(this.kz=String.format(CommonUIStrings.l_SaveACopy_Filename,ae.a.Bq(this.Vu.fn)));c={};c=(c.id="SaveAsDialog",c.bodyControls=this.eyh(),c);var k=CommonUIStrings.L_SaveAs;2===this.Ce.Xa.Tk&&(k=CommonUIStrings.L_SaveACopy);var D=new oa.a(!1,!1,!0);D.hc=1;D.Ie="SaveAsDialog";D.yc(1,CommonUIStrings.l_SaveButtonLabel);D.initializeAndShow(k,Object(qe.a)(this,this.g1i,"saveAsDialogHandler"),c)};md.prototype.chj=function(c,k){c&&
""!==c&&""!==k||1===this.Ce.state?this.q6h()?this.qbi(c,k):(""!==k&&(c+=k),this.sib.start(c,this.qh)):(nd.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Qr.create().displayError(2,c,!1))};md.prototype.qbi=function(c,k){var D=this;ze.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);this.RUa.D7b(this.RUa.eZc(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2)).then(function(ba){if(ba&&
0<ba.length){var Ba=ba[0][vg.a.AFi];ba=ba[0][vg.a.ywd];if(""!==Ba&&""!==ba)D.kDa.jma(ba,c+k,Ba,D.qh),ze.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{D.Qr.create().displayError(0,c,!1);var nb=D.fs();nb&&(nb.set("SiteUrlAvailable",""===Ba?"false":"true"),nb.set("FolderUrlAvailable",""===ba?"false":"true"));ze.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Th.a,{extendedProperties:nb}))}}else D.Qr.create().displayError(0,
c,!1),ze.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(ba){"Canceled"===ba?((ba=D.fs())&&ba.set("IsCanceled","true"),ze.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Th.a,{extendedProperties:ba}))):ze.Health.instance.recordKpiFailure("SaveACopySFP",ba,!1,!1,null)})};md.prototype.q6h=function(){return this.RUa?this.RUa.Xjd()&&wd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1):(nd.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};md.prototype.fs=function(){try{return new Map}catch(c){return null}};md.prototype.g1i=function(c,k){if(k&&1===c){c=k.fileName;var D=ae.a.g3(this.Vu.fn);k.moreLocationsSelected&&this.chj(c,D);if(k.locationCallback){var ba=k.locationCallback();ba?ba.properties&&"currentHost"===ba.properties.oa("type")?this.Xea.jma(c+D,!1,this.qh):ba.properties&&"SharePoint"===ba.properties.oa("type")?(k=ba.properties.oa("siteUrl"),ba=
ba.properties.oa("folderUrl"),this.kDa.jma(ba,c+D,k,this.qh)):nd.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):nd.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else nd.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(te.a)(md,"ReactSaveAsDialog",null,[81]);Qc.prototype.create=function(c){return this.Ce&&this.Ce.Xa.qu?new md(this.$8d,this.Qr,this.Xea,wd.AFrameworkApplication.nl,this.Ce,this.yfg,this.kDa,this.RUa,c):new Zd(this.vb,this.La,
this.Ce,this.xW,this.Qr,this.Xea,this.$8d,c)};Object(te.a)(Qc,"FileNameDialogFactory",null,[47]);Vb.prototype.start=function(c){var k=this;if(!this.muf)if(wd.AFrameworkApplication.breadcrumbFolderUrl&&wd.AFrameworkApplication.breadcrumbFolderUrl.length)this.ohb=wd.AFrameworkApplication.breadcrumbFolderUrl;else return nd.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.io),
!1;var D=this.shg();D.whj();var ba=D.UEh();if(!ba)return nd.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.lfb.start(function(Ba,nb){D.hide();c(Ba,nb)},function(){k.Lsd(D)},ba,this.ohb);return!0};Vb.prototype.Lsd=function(c){c.hide();nd.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};Vb.prototype.oEh=function(c){c=c.toLowerCase();c.endsWith("/")||(c+="/");var k=c.indexOf("/documents/");return-1!==k?c.substring(0,k+1)+"_layouts/15/onedrive.aspx":
""};Vb.prototype.ssb=function(c){this.io||3!==c.state||(this.io=c)};Ll.Object.defineProperties(Vb.prototype,{muf:{configurable:!0,enumerable:!0,get:function(){this.ohb||(this.IBa.value.oy("Save As",!0),this.io&&this.io.$U&&this.io.$U.length&&(this.ohb=this.oEh(this.io.$U)));return this.ohb}}});Object(te.a)(Vb,"OneDriveFilePickerHelper",null,[48]);var mg=oa.a;Em(Bf,mg);Bf.prototype.whj=function(){this.sBc="FilePickerDialog";this.tf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ie="PickerDialog-MsoSp";
this.showDialog("",null)};Bf.prototype.UEh=function(){return document.getElementById("FilePickerDiv")};Bf.prototype.mN=function(){};Bf.prototype.zNa=function(){};Object(te.a)(Bf,"PickerDialog",oa.a,[679]);var rg=b(958),af=b(23);yf.prototype.Lg=function(){var c=this,k=this.lfb.U0a();k?af.a.aA||this.vb.sa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Af(eg.a.saveToSharePoint,ih.a.frame,Object(qe.a)(this,this.AKf,"saveToSharePointActionDispatcher"),64):(k.a5a.continueWith(function(D){D.gg&&
c.lfb.Std(D)}),this.kYb()):nd.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};yf.prototype.kYb=function(){kg.a.LAd(Object(qe.a)(this,this.AKf,"saveToSharePointActionDispatcher"));kg.a.F2c([new rg.a(eg.a.saveToSharePoint,ih.a.frame,0)],this.lfb.U0a())};yf.prototype.AKf=function(c,k,D,ba,Ba){return k.contextId!==ih.a.frame||c!==eg.a.saveToSharePoint?2:this.r4a&&(this.zIc.muf||this.eoe)?1===D?ie.SessionStatusManager.instance.utb||wd.AFrameworkApplication.nU?
8:this.T$f()?32:8:2===D?(nd.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Ba&&Ba.SaveEntryPoint&&"VersionHistory"===Ba.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.eoe?(nd.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.DCc.create(Ba).dP(null)):(nd.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.sib.start(null,Ba)),32):8:8};Ll.Object.defineProperties(yf.prototype,
{r4a:{configurable:!0,enumerable:!0,get:function(){return this.vb.sa("SaveToAnotherFolderBrsIsEnabled")}},eoe:{configurable:!0,enumerable:!0,get:function(){return this.vb.sa("UserCanWriteRelative")}}});Object(te.a)(yf,"SaveToSharePointActor",null,[]);If.prototype.start=function(c,k){var D=this;nd.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Z4d=c;this.qh=k;this.zIc.start(function(ba,Ba){D.OJi(ba,Ba)})||this.NKd()};If.prototype.OJi=function(c,k){if(c)this.onSuccess(k);else this.U4(k)};
If.prototype.NKd=function(){1!==this.Ce.state&&this.Qr().j1c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};If.prototype.onSuccess=function(c){nd.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(c&&c.data&&c.data.value&&c.data.value.length&&c.data.value[0].sharePoint){var k=c.data.value[0].sharePoint.url;c=c.data.value[0].sharePoint.listUrl;var D=null;if(k&&(D=c?this.tIh(c):this.sIh(k))){this.kDa.jma(k,
this.Z4d,D,this.qh);return}nd.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!k,!D)}nd.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.NKd()};If.prototype.sIh=function(c){c.endsWith("/")||(c+="/");for(var k=0,D=0;D<c.length;D++)if("/"===c.charAt(D)&&5===++k)return c.substr(0,D);return null};If.prototype.tIh=function(c){c.endsWith("/")&&(c=c.substring(0,c.length-1));var k=c.lastIndexOf("/");
return-1!==k?c.substring(0,k):null};If.prototype.U4=function(c){nd.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");c&&c.error?nd.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",c.error.errorCode,c.error.message):nd.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.NKd()};Object(te.a)(If,"SaveToSharePointManager",null,[680]);Xe.prototype.execute=function(c,k){if(!wd.AFrameworkApplication.Fg&&wd.AFrameworkApplication.Cd){var D=
this.qDa+this.Tda;D=xe.a.$k(D,"fu",ae.a.ff(this.n7));D=xe.a.$k(D,"su",ae.a.ff(this.bkg));D=xe.a.$k(D,"fn",ae.a.ff(this.kz));D=xe.a.$k(D,"n",ae.a.ff((new Date).getTime().toString()));this.qh&&this.qh.FileDownloadUrl&&(D=xe.a.$k(D,"furl",ae.a.ff(this.qh.FileDownloadUrl)));D=D+"&"+this.CJc;this.fTa&&this.fTa.length?D=xe.a.$k(D,"fnn",ae.a.ff(this.fTa)):nd.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");nd.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
wd.AFrameworkApplication.Cd.Jl(D,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,c,k,null,void 0,void 0,void 0,void 0,"9")}};Object(te.a)(Xe,"SharePointSaveAsCaller",null,[711]);gg.prototype.create=function(c,k,D,ba){return new Xe(this.rDa,this.kz,c,k,D,wd.AFrameworkApplication.Xi,this.Tda,ba)};Object(te.a)(gg,"SharePointUploadCallerFactory",null,[678]);var de=b(789);zf.prototype.jma=function(c,k,D,ba){this.Zyc=!1;nd.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.PHb();this.n7=c;ba&&ba.SaveEntryPoint&&(this.CKc=ba.SaveEntryPoint);this.NAa=this.XMc.create(c,k,D,ba);ba&&"true"===ba.SkipSaveToHost?this.mP():this.Uoh()};zf.prototype.Uoh=function(){function c(){nd.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");k.mP()}var k=this;32!==this.La.Ge(eg.a.BOa,2,[function(){nd.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");k.mP()},c])&&c()};zf.prototype.mP=function(){nd.ULS.sendTraceTag(23881924,
216,50,"Send SharePointSaveAsHandler.ashx request.");this.NAa.execute(Object(qe.a)(this,this.Nyi,"onSaveToSharePointUploadFinished"),Object(qe.a)(this,this.Myi,"onSaveToSharePointUploadFailed"))};zf.prototype.Nyi=function(c){if(c&&c.data&&c.data.ae){var k=Xa.d(c.data.ae);var D=k.eu;if(k.returnValue)if(D.StatusCode!==Pb.a.JN&&D.StatusCode!==Pb.a.tob)nd.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",c.data.status,D.StatusCode),D.StatusCode!==
Pb.a.CHf&&this.IAe(c.data.status)||(this.Qba(D.StatusCode.toString()),this.cgj(D.StatusCode));else{nd.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.uDd();try{D.NewDocumentUrl?this.KNa(D.NewDocumentUrl):this.LNa()}catch(ba){nd.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ba.toString())}}else D={},nd.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(D.ResponseData=Gc.a.Ebb(c.data.ae),D)),this.H2b()||(this.Qba("Failed to deserialize response"),
this.NHb())}else nd.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.H2b()||(this.Qba("Unknown"),this.NHb())};zf.prototype.Myi=function(c){c&&c.data?this.IAe(c.data.status)||(nd.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Qba(de.a[c.data.status]),this.NHb()):(nd.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.H2b()||(this.Qba("Unknown"),this.NHb()))};zf.prototype.H2b=function(){if(!this.Zyc)return nd.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.Zyc=!0,this.mP(),!0;nd.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};zf.prototype.IAe=function(c){nd.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",c);return this.H2b()};zf.prototype.LNa=function(){nd.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");pg.a.lf(this.n7,pg.a.pW(3),void 0,"UploadToSharePointManager.RedirectToFolder")};zf.prototype.KNa=function(c){var k=!1,D=!1;wd.AFrameworkApplication.ha&&
(k=wd.AFrameworkApplication.ha.sa("SaveACopyIsEnabledForUiHost"),D=wd.AFrameworkApplication.ha.sa("UiHostSupportsDocRebootFeatures"));nd.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",c,k);if(k&&D){nd.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var ba={};ba[vg.a.GNa]="1";ba[vg.a.documentUrl]=c;ba[vg.a.reason]=Eh.a.saveAs;wd.AFrameworkApplication.yY().execute(function(Ba){Ba.Vj(Ih.a.Vra,
ba)})}else pg.a.lf(c,pg.a.pW(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};zf.prototype.PHb=function(){this.Ce&&1===this.Ce.state||(this.jm=this.Phb(),this.jm.message=CommonUIStrings.l_CommentProgressTooltip,this.jm.hc=5,this.jm.lu=!1,this.jm.Qya(CommonUIStrings.l_DefaultDialogTitle,null,null))};zf.prototype.vGa=function(){this.jm&&(this.jm.close(),this.jm=null)};zf.prototype.NHb=function(){this.ai(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)};zf.prototype.ghj=
function(){this.ai(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};zf.prototype.igj=function(){var c=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.ai(CommonUIStrings.l_SaveAsFileTooLargeTitle,c,Of.a.h1i)};zf.prototype.ai=function(c,k,D){D=void 0===D?Of.a.l1i:D;nd.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",c,k);this.vGa();1!==this.Ce.state&&this.Qr().iAe(c,k,D)};zf.prototype.cgj=function(c){nd.ULS.sendTraceTag(25180166,
216,50,"Upload fail with status code: {0}.",c);switch(c){case Pb.a.D0f:this.ghj();break;case Pb.a.CHf:this.igj();break;default:this.NHb()}};zf.prototype.uDd=function(){"VersionHistory"===this.CKc&&this.La.processAction(eg.a.Rnc,2)};zf.prototype.Qba=function(c){if("VersionHistory"===this.CKc){var k={};this.La.Ge(eg.a.vDd,2,(k.FailureReason=c,k))}};Object(te.a)(zf,"UploadToSharePointManager",null,[673]);Rg.prototype.init=function(){};Rg.prototype.dispose=function(){};Rg.prototype.Qh=function(c){var k=
this;this.Za=c;this.mQb=Ld.a.mq(c.oc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.oQb=Ld.a.mq(c.oc("Common.IEventEmitter<Common.IMruResult>"));wd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1)?(this.Jea=Ld.a.mq(c.oc("Common.App.SharedFilePicker.ISharedFilePicker")),Ie.Task.WAA.call(null,this.mQb,this.oQb,this.Jea).continueWith(function(){k.WCf()})):(this.Jea=null,Ie.Task.WAA.call(null,this.mQb,this.oQb).continueWith(function(){k.WCf()}))};
Rg.prototype.WCf=function(){var c=this;this.Za.register(gg,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Fc(function(){return new gg(wd.AFrameworkApplication.ha)}).wc();this.Za.register(zf,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Fc(function(){return new zf(wd.AFrameworkApplication.Hb,c.Za.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),
function(){return(new Lf.a).create()},function(){return new Kg},wd.AFrameworkApplication.xa)}).wc();this.Za.register(If,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Fc(function(){return new If(c.Za.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),function(){return new Kg},c.Za.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),wd.AFrameworkApplication.xa)}).wc();this.Za.register(Vb,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Fc(function(){return new Vb(c.Za.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
new Kf.a(function(){return c.mQb.result}),wd.AFrameworkApplication.xa,function(){return new Bf})}).wc();this.Za.register(Qc,"Common.App.SaveToSharePoint.FileNameDialogFactory").Fc(function(){return new Qc(wd.AFrameworkApplication.ha,wd.AFrameworkApplication.Hb,wd.AFrameworkApplication.xa,wd.AFrameworkApplication.xa.Xa,c.Za.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),c.Za.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),c.Za.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Kf.a(function(){return c.oQb.result}),c.Za.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),c.Jea?c.Jea.result:null)}).wc();this.Za.register(yf,"Common.App.SaveToSharePoint.SaveToSharePointActor").Fc(function(){return new yf(wd.AFrameworkApplication.ha,wd.AFrameworkApplication.Hb,c.Za.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),c.Za.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),c.Za.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
c.Za.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return wd.AFrameworkApplication.xa.LHg})}).wc();wd.AFrameworkApplication.ha.sa("SaveToAnotherFolderBrsIsEnabled")&&this.Za.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Lg()};Rg.main=function(){Wg.a.instance.ej(new Rg)};Ll.Object.defineProperties(Rg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(te.a)(Rg,"PackageManager",null,[8,9]);var Fi=Td.StandardDialog;
Em(Hf,Fi);Hf.prototype.displayError=function(c){this.Qy(c,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)};Object(te.a)(Hf,"ErrorDialog",Td.StandardDialog,[773]);Vg.default=0;Object(te.a)(Vg,"SaveToCloudErrorCodes",null,[]);mf.prototype.start=function(c){this.qh=c;if("SharePointOnlineConsumer"===this.vb.Ta("FileSource")){var k=Hc.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(k){k.start(null,c);return}}this.N0.OJa?(nd.ULS.sendTraceTag(6590559,
216,50,"User is signed in. We will show file picker."),this.hHg()):(nd.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())};mf.prototype.showSignInDialog=function(){this.Vjg.create().dP()};mf.prototype.ai=function(){this.Qr().displayError(Vg.default)};mf.prototype.hHg=function(){try{nd.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var c={},k=(c.client_id=this.vb.appSettings.UploadToSkyDriveClientId,c.env="INT",c);if(1===this.sMb||
2===this.sMb)c={},k=(c.client_id=this.vb.appSettings.UploadToSkyDriveClientId,c);c={};var D=(c.mode="save",c.lightbox="grey",c);WL.init(k);nd.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(D).then(Object(qe.a)(this,this.onSuccess,"onSuccess"),Object(qe.a)(this,this.U4,"onFailure"))}catch(ba){nd.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",ba,ba.stack),this.ai()}};mf.prototype.onSuccess=function(c){nd.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");c&&c.data&&c.data.folders&&this.jjb.jma(c.data.folders[0].id,c.data.folders[0].urls.viewInBrowser,null,this.qh)};mf.prototype.U4=function(c){if(c&&c.error){if("user_canceled"===c.error.code){nd.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}nd.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",c.error.code,c.error.message)}else nd.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.ai()};Object(te.a)(mf,"SaveToCloudManager",null,[701]);Ue.prototype.r4a=function(){return this.vb.sa("SaveToCloudStorageUIIsEnabled")};Ue.prototype.ENe=function(){return eg.a.saveToCloudStorage};Ue.prototype.kYb=function(){kg.a.LAd(Object(qe.a)(this,this.yKf,"saveToCloudActionDispatcher"));kg.a.F2c([new rg.a(eg.a.saveToCloudStorage,ih.a.frame,0)],this.W5d.U0a())};Ue.prototype.Lg=function(){var c=this,k=this.W5d.U0a();k?(k.o8(function(){c.x3d.setResult(!0)}),
this.kYb()):nd.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};Ue.prototype.iCf=function(){nd.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")};Ue.prototype.yKf=function(c,k,D,ba,Ba){var nb=this;return k.contextId!==ih.a.frame||c!==this.ENe()?2:this.r4a()?1===D?ie.SessionStatusManager.instance.utb||wd.AFrameworkApplication.nU?8:32:2===D?(this.iCf(),Ba&&Ba.FileDownloadUrl&&nd.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),
this.jh&&(this.MRb=this.jh.Dc("DialogShown","SaveToOneDriveReponseTime")),this.x3d.task.continueWith(function(){nb.MRb&&(nb.MRb.stop(),nb.MRb=null);nb.Xig.start(Ba)}),32):8:8};Object(te.a)(Ue,"SaveToCloudStorageActor",null,[774]);var f=b(279),hb=Td.StandardDialog;Em(Se,hb);Se.prototype.dP=function(){this.N0.RVa(Object(qe.a)(this,this.Gsf,"onSignIn"));this.ul(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(qe.a)(this,this.vXh,"inputHandler"))};Se.prototype.vXh=
function(c){c?this.j5():(nd.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide())};Se.prototype.NJg=function(){var c="2";if(this.xW)switch(this.xW.Tk){case 3:c="0";break;case 2:c="3";break;case 1:c="1"}return c};Se.prototype.hide=function(){this.N0.YDb(Object(qe.a)(this,this.Gsf,"onSignIn"));hb.prototype.hide.call(this)};Se.prototype.j5=function(){var c=new f.QueryStringBuilder("Signin.aspx");c.Xj("prompt","1");c.Xj("cbcxt",this.NJg());wd.AFrameworkApplication.Ujb(c);pg.a.lf(c.toString(),
"LoginWindow",void 0,"SignInDialog")};Se.prototype.Gsf=function(){this.us&&this.hide();nd.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(eg.a.saveToCloudStorage,2)};Object(te.a)(Se,"SignInDialog",Td.StandardDialog,[786]);he.prototype.create=function(){return new Se(this.La,this.N0,this.xW)};Object(te.a)(he,"SignInDialogFactory",null,[772]);Kd.prototype.execute=function(c,k){if(!wd.AFrameworkApplication.Fg&&wd.AFrameworkApplication.Cd){var D=
this.qDa+this.Tda;D=xe.a.$k(D,"fo",ae.a.ff(this.AOb));D=xe.a.$k(D,"fn",ae.a.ff(this.kz));D=xe.a.$k(D,"qs",ae.a.ff(this.CJc));D=xe.a.$k(D,"n",ae.a.ff((new Date).getTime().toString()));this.qh&&this.qh.FileDownloadUrl&&(D=xe.a.$k(D,"furl",ae.a.ff(this.qh.FileDownloadUrl)));this.fTa&&(D=xe.a.$k(D,"fnn",ae.a.ff(this.fTa)));wd.AFrameworkApplication.Cd.Jl(D,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,c,k,null)}};Object(te.a)(Kd,"SkyDriveUploadCaller",null,[702]);Hd.prototype.create=function(c,
k,D){return new Kd(this.rDa,this.kz,k,c,wd.AFrameworkApplication.Xi,this.Tda,D)};Object(te.a)(Hd,"SkydriveUploadCallerFactory",null,[672]);zc.prototype.PHb=function(){this.Ce&&1===this.Ce.state||(this.jm=this.Phb(),this.jm.message=CommonUIStrings.l_CommentProgressTooltip,this.jm.hc=5,this.jm.lu=!1,this.jm.Qya(CommonUIStrings.l_DefaultDialogTitle,null,null))};zc.prototype.vGa=function(){this.jm&&(this.jm.close(),this.jm=null)};zc.prototype.UQ=function(){1!==wd.AFrameworkApplication.xa.state&&this.Qr().displayError(Vg.default)};
zc.prototype.LNa=function(){nd.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");pg.a.lf(this.n7,pg.a.pW(3),void 0,"UploadToCloudManager.RedirectToFolder")};zc.prototype.KNa=function(c){var k=!1,D=!1;wd.AFrameworkApplication.ha&&(k=wd.AFrameworkApplication.ha.sa("SaveACopyIsEnabledForUiHost"),D=wd.AFrameworkApplication.ha.sa("UiHostSupportsDocRebootFeatures"));nd.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",c,k);if(k&&D){nd.ULS.sendTraceTag(594929733,
216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var ba={};ba[vg.a.GNa]="1";ba[vg.a.documentUrl]=c;wd.AFrameworkApplication.yY().execute(function(Ba){Ba.Vj(Ih.a.Vra,ba)})}else pg.a.lf(c,pg.a.pW(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};zc.prototype.jma=function(c,k,D,ba){D=void 0===D?null:D;ba=void 0===ba?null:ba;nd.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.jh&&(this.Wea=this.jh.Dc("DialogShown","SaveToOneDriveUploadTime"));this.PHb();
this.n7=k;this.NAa=this.XMc.create(c,D,ba);this.qh=ba;this.mP()};zc.prototype.mP=function(){nd.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.NAa.execute(Object(qe.a)(this,this.Lyi,"onSaveToCloudUploadFinished"),Object(qe.a)(this,this.Kyi,"onSaveToCloudUploadFailed"))};zc.prototype.Lyi=function(c){this.vGa();this.xBa=!1;if(c&&c.data&&c.data.ae){var k=Xa.d(c.data.ae);var D=k.eu;if(k.returnValue)if(D.StatusCode!==Pb.a.JN&&D.StatusCode!==Pb.a.tob)nd.ULS.sendTraceTag(6590602,216,
10,"UploadToCloudManager upload failure. Response data is not JSON."),this.UQ();else{nd.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{D.NewDocumentUrl&&""!==D.NewDocumentUrl?this.KNa(D.NewDocumentUrl):this.LNa()}catch(ba){nd.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ba.toString())}this.dCb()}else D={},nd.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(D.ResponseData=Gc.a.Ebb(c.data.ae),D)),this.UQ()}else nd.ULS.sendTraceTag(6590601,
216,10,"UploadToCloudManager upload failure. Response data is null"),this.UQ()};zc.prototype.Kyi=function(c){5!==c.data.status&&12!==c.data.status||this.xBa?(nd.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",c.data.status),this.vGa(),this.UQ(),this.dCb()):(nd.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.xBa=!0,this.mP())};zc.prototype.dCb=function(){this.Wea&&(this.Wea.stop(),this.Wea=null)};Object(te.a)(zc,"UploadToCloudManager",
null,[671]);wc.prototype.init=function(){wd.AFrameworkApplication.ha.sa("SaveToCloudStorageUIIsEnabled")&&this.Za.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Lg()};wc.prototype.dispose=function(){};wc.prototype.Qh=function(c){this.Za=c;this.Za.register(he,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Fc(function(){return new he(wd.AFrameworkApplication.Hb,Ig.a.instance,wd.AFrameworkApplication.xa.Xa)}).wc();this.Za.register(Hd,
"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Fc(function(){return new Hd(wd.AFrameworkApplication.ha)}).wc();this.Za.register(Ue,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fc(function(){return new Ue(c.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),c.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),wd.AFrameworkApplication.ha,wd.AFrameworkApplication.xa.MC)}).wc();this.Za.register(zc,
"Common.App.SaveToCloudStorage.UploadToCloudManager").Fc(function(){return new zc(c.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new Lf.a).create()},function(){return new Hf},wd.AFrameworkApplication.xa,wd.AFrameworkApplication.xa.MC)}).wc();this.Za.register(mf,"Common.App.SaveToCloudStorage.SaveToCloudManager").Fc(function(){return new mf(c.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Ig.a.instance,c.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
wd.AFrameworkApplication.ha,wd.AFrameworkApplication.b_a,function(){return new Hf})}).wc()};wc.main=function(){Wg.a.instance.ej(new wc)};Ll.Object.defineProperties(wc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(te.a)(wc,"PackageManager",null,[8,9]);Ll.Object.defineProperties(ob,{tf:{configurable:!0,enumerable:!0,get:function(){return oa.a.$i(ob.Jj,CommonUIStrings.l_SaveACopyFileName)}}});ob.Jj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(te.a)(ob,"FileNameDialogHtml",null,[]);var ec=oa.a;Em(Ea,ec);Ea.prototype.dP=function(c,k,D){this.AOb=c;this.n7=D;c={};k=(c.txtFileName=ae.a.Bq(wd.AFrameworkApplication.nl.fn),c.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,k),c);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(qe.a)(this,this.$4b,"fileNameDialogHandler"),k);nd.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};Ea.prototype.$4b=
function(c,k){1!==c?nd.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(c=k.txtFileName.trim(),nd.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),k=ae.a.g3(wd.AFrameworkApplication.fileName),c&&""!==c&&""!==k&&(c+=k),this.jjb.jma(this.AOb,this.n7,c,this.qh))};Object(te.a)(Ea,"FileNameDialog",oa.a,[790]);Cf.prototype.create=function(c){return new Ea(this.La,this.xW,this.jjb,c)};Object(te.a)(Cf,"FileNameDialogFactory",
null,[775]);var $c=Td.StandardDialog;Em(og,$c);og.prototype.displayError=function(c){nd.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",c);this.Qy(c,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(qe.a)(this,this.BEd,"retryDialogHandler"))};og.prototype.BEd=function(c){1===c?(nd.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(eg.a.saveACopy,2)):nd.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(te.a)(og,"RetryDialog",Td.StandardDialog,[773]);Em(Qf,Ue);Qf.prototype.r4a=function(){return this.vb.sa("SaveACopyBrsIsEnabled")};Qf.prototype.ENe=function(){return eg.a.saveACopy};Qf.prototype.kYb=function(){kg.a.LAd(Object(qe.a)(this,this.yKf,"saveToCloudActionDispatcher"));kg.a.F2c([new rg.a(eg.a.saveACopy,ih.a.frame,0)],this.Qgg.U0a())};Qf.prototype.iCf=function(){nd.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(te.a)(Qf,"SaveACopyActor",Ue,
[]);Em(ke,mf);ke.prototype.onSuccess=function(c){c&&c.data&&c.data.folders?(nd.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.ocg.create(this.qh).dP(c.data.folders[0].id,c.data.folders[0].name,c.data.folders[0].urls.viewInBrowser)):(nd.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.ai())};ke.prototype.U4=function(c){c&&c.error&&"user_canceled"===c.error.code&&nd.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
mf.prototype.U4.call(this,c)};ke.prototype.ai=function(){nd.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");mf.prototype.ai.call(this)};Object(te.a)(ke,"SaveACopyManager",mf,[]);Em(dg,zc);dg.prototype.Ijd=function(){return!!this.qh&&!!this.qh.SaveEntryPoint&&"VersionHistory"===this.qh.SaveEntryPoint.toString()};dg.prototype.UQ=function(){nd.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.Ijd()){var c={};this.La.Ge(eg.a.vDd,2,(c.FailureReason="Unknown",
c))}zc.prototype.UQ.call(this)};dg.prototype.LNa=function(){nd.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Ijd()&&this.La.processAction(eg.a.Rnc,2);zc.prototype.LNa.call(this)};dg.prototype.KNa=function(c){nd.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",c);this.Ijd()&&this.La.processAction(eg.a.Rnc,2);zc.prototype.KNa.call(this,c)};dg.prototype.mP=function(){var c=this;this.qh&&"true"===this.qh.SkipSaveToHost?zc.prototype.mP.call(this):
32!==this.La.processAction(eg.a.BOa,1)?(nd.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),zc.prototype.mP.call(this)):this.La.Ge(eg.a.BOa,2,[function(){nd.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");zc.prototype.mP.call(c)},function(){nd.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");c.UQ()}])};Object(te.a)(dg,"SaveACopyUploadToCloudManager",
zc,[]);je.prototype.init=function(){wd.AFrameworkApplication.ha.Dv(Object(qe.a)(this,this.mA,"onFullAppSettingsReady"))};je.prototype.mA=function(){wd.AFrameworkApplication.ha.sa("SaveACopyBrsIsEnabled")&&this.Za.resolve("Common.App.SaveACopy.SaveACopyActor").Lg()};je.prototype.dispose=function(){};je.prototype.Qh=function(c){this.Za=c;this.Za.register(dg,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Fc(function(){return new dg(wd.AFrameworkApplication.Hb,c.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new Lf.a).create()},function(){return new og(wd.AFrameworkApplication.Hb)},wd.AFrameworkApplication.xa,wd.AFrameworkApplication.xa.MC)}).wc();this.Za.register(Cf,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Fc(function(){return new Cf(wd.AFrameworkApplication.Hb,wd.AFrameworkApplication.xa.Xa,c.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).wc();this.Za.register(Qf,"Common.App.SaveACopy.SaveACopyActor").Fc(function(){return new Qf(c.resolve("Common.App.SaveACopy.SaveACopyManager"),
c.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),wd.AFrameworkApplication.ha,wd.AFrameworkApplication.xa.MC)}).wc();this.Za.register(ke,"Common.App.SaveACopy.SaveACopyManager").Fc(function(){return new ke(c.resolve("Common.App.SaveACopy.FileNameDialogFactory"),c.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Ig.a.instance,c.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),wd.AFrameworkApplication.ha,wd.AFrameworkApplication.b_a,function(){return new og(wd.AFrameworkApplication.Hb)})}).wc()};
je.main=function(){Wg.a.instance.ej(new je)};Ll.Object.defineProperties(je.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(te.a)(je,"PackageManager",null,[8,9]);var be;(function(c){c[c.myFiles=0]="myFiles";c[c.recent=1]="recent";c[c.currentFolder=2]="currentFolder";c[c.yourPhone=3]="yourPhone"})(be||(be={}));Object(te.b)("SharedFilePickerLandingLocation",be);Jg.prototype.XZa=function(c){this._initialized||(c.En(Ih.a.QBf),c.xm(Ih.a.QBf,Object(qe.a)(this,
this.Sxi,"onReceivedPickerResponse")),this._initialized=!0)};Jg.prototype.D7b=function(c){var k=this;return this.kJa=new Promise(function(D,ba){var Ba={};Ba[vg.a.zFi]=c;k.e8a=function(nb,Rb){""===Rb?(nd.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),D(nb)):("Canceled"===Rb?nd.ULS.sendTraceTag(572548164,306,50,Rb):nd.ULS.sendTraceTag(556901065,306,10,Rb),ba(Rb))};k.Qdd.execute(function(nb){k.XZa(nb);nb.Vj(Ih.a.CCi,Ba)})})};Jg.prototype.Sxi=function(c){this.e8a(c.Values[vg.a.G3i],
void 0===c.Values[vg.a.xwd]||null===c.Values[vg.a.xwd]?"":c.Values[vg.a.xwd])};Jg.prototype.Xjd=function(){return wd.AFrameworkApplication.ha.sa("UiHostCommonFilePicker")};Jg.prototype.eZc=function(c,k,D,ba,Ba,nb,Rb){var Ic=void 0===Ic?null:Ic;var Wc={};Wc[vg.a.t3i]=c;Wc[vg.a.titleText]=k;Wc[vg.a.twg]=D;Wc[vg.a.uwg]=ba;Wc[vg.a.vwg]=!1;Wc[vg.a.G3g]=!0;Wc[vg.a.rlh]=Ba;Wc[vg.a.CFi]=nb;Wc[vg.a.BFi]=be[Rb];Ic&&(null!=Ic.EQc&&(Wc[vg.a.EQc]=Ic.EQc),null!=Ic.Ged&&(Wc[vg.a.Ged]=Ic.Ged));return Wc};Object(te.a)(Jg,
"SharedFilePickerManager",null,[670]);Ag.prototype.Qh=function(c){this.Za=c;c.register(Jg,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").wc().Fc(function(){return new Jg(c.oc("Postmessage.IHostPostmessenger"))})};Ag.prototype.init=function(){var c=this;wd.AFrameworkApplication.ha.Dv(function(){c.Cub()})};Ag.prototype.Cub=function(){this.Za.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};Ag.prototype.dispose=function(){};Ag.main=
function(){Wg.a.instance.ej(new Ag)};Ll.Object.defineProperties(Ag.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(te.a)(Ag,"SharedFilePickerPackage",null,[8,9]);var ve=b(1255),De=b(959);Sc.prototype.tde=function(c){var k=!1;c&&(c.LYc(),c.vFg&&(k=!1));return k};Sc.prototype.KSg=function(){var c=wd.AFrameworkApplication.xa.Xa;c=new ve.a(c.Tk,De.a.W8b(),!1,1===c.dMa);this.tde(c)&&nd.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")};
Sc.prototype.B0b=function(c,k,D,ba,Ba,nb){c=new ve.a(c,D,ba,k,Ba,nb);this.tde(c)&&nd.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};Sc.prototype.UYg=function(){var c=wd.AFrameworkApplication.xa.Xa,k=wd.AFrameworkApplication.ha,D=c.Tk,ba=1===c.dMa;if(k.sa(De.a.kLh(D))){var Ba=De.a.W8b(),nb=8<af.a.n2a;if(2!==D||2!==Ba||!ba){k=k.sa(De.a.lLh(D));var Rb=c.aKf(),Ic=function(){return c.rB};k&&!De.a.qid(De.a.h8c(D))&&this.B0b(D,ba,Ba,nb,Ic,Rb)}}};Sc.prototype.init=function(){var c=wd.AFrameworkApplication.ha,
k=c.sa("WildFireChromeExtensionEnabled");c=c.sa("WildFireChromeExtensionBar")&&k;De.a.Vrc&&c&&!De.a.qid(De.a.eqe)?this.KSg():(document.body&&De.a.Iej&&this.UYg(),wd.AFrameworkApplication.Hb.Xb(eg.a.umd,ih.a.frame,Object(qe.a)(this,this.umd,"launchWildFireBusinessBar")))};Sc.prototype.umd=function(c,k,D,ba,Ba){if(1===D)return 32;if(!Ba)return 8;this.B0b(Ba.app,Ba.mode,Ba.platform,Ba.useTwoButton,null,null);return 32};Sc.prototype.dispose=function(){};Sc.prototype.Qh=function(){};Sc.main=function(){Wg.a.instance.ej(new Sc)};
Ll.Object.defineProperties(Sc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(te.a)(Sc,"PackageManager",null,[8,9]);var Me=b(212),sf=b(1239),tg=Me.a;Em(Yd,tg);Yd.prototype.create=function(){this.Eb(this.$.ea.Ba(5)||new sf.a(this.$,!this.$.D$))};Yd.ja=function(c){c.ea.Ia(4,new Yd(c))};Object(te.a)(Yd,"BusinessBarManagerFactory",Me.a,[]);var uf=b(12),Og;"undefined"==typeof Og&&(Og={});window.MSOJS=Og;Og.jdb=function(){function c(){return Rb()&&(Bg()||
3<=(df()?qh("version/"):0))}function k(){return 0<=window.navigator.userAgent.indexOf("Windows")}function D(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function ba(){pl||(pl=!0,ml=Ba("Windows Phone"))}function Ba(Mf){Mf=(new RegExp(Mf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var hh=-1;return null!=Mf&&2<=Mf.length&&(hh=parseFloat(Mf[1]),isNaN(hh)&&(hh=-1)),hh}function nb(){return"function"==typeof navigator.msLaunchUri&&!D()&&!Pg()&&!Ic()}function Rb(){return 0<=
window.navigator.userAgent.indexOf("Macintosh")}function Ic(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Wc(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Rd(){return Wc()?8==window.document.documentMode:!1}function Ge(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function df(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Wf(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}
function Pg(){var Mf=window.navigator.userAgent.toLowerCase();return 0<=Mf.indexOf("android")&&0<=Mf.indexOf("chrome")}function Bg(){return 3<=(Ge()?qh("firefox/"):0)}function qh(Mf){var hh=window.navigator.userAgent.toLowerCase(),Yh=hh.indexOf(Mf),Mh,zi;return 0<=Yh?(Mh=Yh+Mf.length,zi=hh.length,parseInt(hh.substring(Mh,zi))):0}function dj(Mf,hh,Yh,Mh,zi){if(Mh&&null!=hh)hh();else if(nb())navigator.msLaunchUri(Mf,hh,Yh);else if(!(Wf()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||
0<navigator.maxTouchPoints&&Rb())||Ic())$i(Mf,hh,Yh);else if(Wf()&&zi)a:{try{window.open(Mf,"_self")}catch(Mi){null!=Yh&&Yh();break a}null!=hh&&hh()}else vi(Mf,hh,Yh)}function vi(Mf,hh,Yh){var Mh=document.getElementById("OICLinkTag"),zi;null==Mh&&(Mh=document.createElement("a"),Mh.id="OICLinkTag",Mh.style.visibility="hidden",Mh.href="",Mh.target=0==(Dj.Options&nk.SupportsTopTargetNavigation)||Dj.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Mh),null!=Mh.addEventListener&&Mh.addEventListener("click",
function(Mi){null!=Mi.stopPropagation&&Mi.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(zi=function(Mi){var Ni=document.createEvent("MouseEvent");return Ni.initMouseEvent(Mi,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Ni},zi.prototype=Event.prototype,window.MouseEvent=zi),Mh.href=Mf,Mh.dispatchEvent(new MouseEvent("click"))}catch(Mi){null!=Yh&&Yh();return}null!=hh&&hh()}function $i(Mf,hh,Yh){var Mh=document.getElementById("OICFrame");null==Mh&&(Mh=document.createElement("iframe"),Mh.className=
"ObjectInDialog",Mh.style.visibility="hidden",Mh.src="about:blank",document.body.appendChild(Mh),Mh.id="OICFrame");try{Mh.contentWindow.location.href=Mf}catch(zi){null!=Yh&&Yh();return}null!=hh&&hh()}function jk(Mf){return 0!=(Mf.Options&nk.SkipProtocolHandler)||Rd()}function sk(Mf){return Mf===Uk.ReadOnly||Mf===Uk.ReadWrite}function Ek(Mf,hh,Yh,Mh){var zi,Mi;try{if(zi=new ActiveXObject(re),zi)return Mi=zi.ViewDocument3(window.self,Mf,hh,Mh),Mi?(Kb(Hk.O14ActiveX),Xi.None):Xi.Failed}catch(Ni){}if(nk.O14Only===
(Yh&nk.O14Only))return Dj.DescriptiveUnattemptedEnums?Xi.O14AttemptFailure:Xi.Unattempted;try{if(zi=new ActiveXObject(pf),zi)return Mi=zi.ViewDocument3(window.self,Mf,hh,Mh),Mi?(Kb(Hk.O12ActiveX),Xi.None):Xi.Failed}catch(Ni){}if(nk.O12UpOnly===(Yh&nk.O12UpOnly))return Dj.DescriptiveUnattemptedEnums?Xi.O12UpOnlyFail:Xi.Unattempted;try{if(zi=new ActiveXObject(Ze),zi)return Mi=sk(hh)?zi.ViewDocument2(window.self,Mf,Mh):zi.EditDocument2(window.self,Mf,Mh),Mi?(Kb(Hk.O11ActiveX),Xi.None):Xi.Failed}catch(Ni){}return Dj.DescriptiveUnattemptedEnums?
Xi.ActiveXUnattempted:Xi.Unattempted}function Xk(Mf,hh,Yh,Mh,zi){var Mi,Ni;Mf==lj.Visio&&Yh==Uk.ReadWrite&&(Yh=Uk.WriteOnly);Mf=zi;(Mh=Mh||D()&&!(ba(),8<=ml))||(Mi="",Mi+=sk(Yh)?Ti+ak:Ij,Mi+=Vj,Mf+=Kk(Mi));Mf+=Kk(hh);hh=window.location.href;Yh=kk;Mh=hh.toLowerCase().indexOf("&"+Yh+"=");var tk;Yh=-1==Mh?void 0:(Ni=Mh+(Yh.length+2),tk=hh.indexOf("&",Ni),-1==tk)?hh.substr(Ni):hh.substring(Ni,tk);if(null!=Yh&&"undefined"!=typeof Yh){Ni="";try{Ni=decodeURIComponent(Yh)}catch(Ej){}0<Ni.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ni)&&
(Mf+=Jj,Mf+=Ni)}return Mf}function Sk(Mf,hh,Yh,Mh,zi,Mi){var Ni=I(Mf),tk;return null==Ni?(nc(Dj.DescriptiveUnattemptedEnums?Xi.ProtocolHandlerIsNull:Xi.Unattempted,Dj.Application),!1):(tk=Xk(Mf,hh,Yh,Mh,Ni),dj(tk,gl,hl,zi,Mi),!0)}function Kk(Mf){if(Rb()&&Wf()){var hh="";try{hh=decodeURI(Mf)}catch(Yh){}if(hh==Mf)return encodeURI(Mf)}return Mf}function gl(){Kb(Hk.ProtocolHandler)}function hl(){Dj.Options|=nk.SkipProtocolHandler;Va(Dj,Gk,Yk)}function il(){null!=kl&&kl(Hk.RoamingProtocolHandler)}function jl(){null!=
ll&&ll(Xi.ControlNeeded)}function fl(){var Mf=document.getElementById(Ki),hh;if(null==Mf){if(hh=cg,Rb()&&3<=(df()?qh("version/"):0)&&Lk(Ug,!0)&&(hh=Ug),!Lk(hh,!0))if(Rb()&&Lk(nh,!0))hh=nh;else return null;Mf=document.createElement("object");Mf.id=Ki;Mf.type=hh;Mf.style.width="0px";Mf.style.height="0px";Mf.style.setProperty("visibility","hidden","");document.body.appendChild(Mf);Mf=document.getElementById(Ki)}return Mf}function Lk(Mf,hh){var Yh=window.navigator.mimeTypes,Mh;return null==Yh?!1:(Mh=
Yh[Mf],Mh)?hh&&!Mh.enabledPlugin?!1:!0:!1}function bl(Mf){try{if(null!=new ActiveXObject(Mf))return!0}catch(hh){}return!1}function cl(Mf){switch(Mf){case lj.OneNote:return si;default:return""}}function I(Mf){if(Mf!=lj.OneNote&&D()&&!(ba(),8<=ml))return"office:";switch(Mf){case lj.Excel:return"ms-excel:";case lj.OneNote:return"onenote:";case lj.PowerPoint:return"ms-powerpoint:";case lj.Visio:return"ms-visio:";case lj.Word:return"ms-word:";case lj.Project:return"ms-project:";case lj.Publisher:return"ms-publisher:";
case lj.Infopath:return"ms-infopath:";case lj.Access:return"ms-access:";default:return""}}function la(Mf){switch(Mf){case lj.Excel:return"root\\office15\\excel.exe";case lj.PowerPoint:return"root\\office15\\powerpnt.exe";case lj.Visio:return"root\\office15\\visio.exe";case lj.Word:return"root\\office15\\winword.exe";case lj.Project:return"root\\office15\\winproj.exe";case lj.Publisher:return"root\\office15\\mspub.exe";case lj.Infopath:return"root\\office15\\infopath.exe";case lj.Access:return"root\\office15\\msaccess.exe";
default:return null}}function Va(Mf,hh,Yh){if(Dj=Mf,Gk=hh,Yk=Yh,Mf.DocumentUrl){var Mh=Yh=hh=Mf.DocumentUrl;try{Mh=decodeURIComponent(Mf.DocumentUrl)}catch(Mk){}try{Yh=encodeURI(Mf.DocumentUrl)}catch(Mk){}hh=hh+""+Mf.CorrelationIdForWinClient;Mh+=Mf.CorrelationIdForWinClient;Yh+=Mf.CorrelationIdForWinClient;Mf.Mode===Uk.ReadWrite&&nk.CheckoutRequired===(Mf.Options&nk.CheckoutRequired)&&(Mf.Mode=Uk.ForceCheckout);nk.HostIsEditOnly===(Mf.Options&nk.HostIsEditOnly)&&(Mf.Mode=Uk.WriteOnly);if(jk(Mf)?
0:Rb()&&(Mf.Application==lj.OneNote||Lk(rh,!1)||Lk(Lh,!1))||nb()||Pg()||!(c()||Bg()||"ActiveXObject"in window&&!D()||Wf())||15<=Mc())Sk(Mf.Application,Mf.EncodeUrl?Yh:hh,Mf.Mode,Mf.Application==lj.OneNote,Mf.SilentExternalHandler,Mf.NavigateUsingWindowOpen);else{var zi;if(zi=Rd())a:{var Mi=Mf.EncodeUrl?hh:Mh,Ni=Mf.Mode,tk=cl(Mf.Application);try{zi=(new ActiveXObject(Ed)).ViewDocument3(window.self,Mi,Ni,tk);break a}catch(Mk){}zi=!1}if(zi)Kb(Hk.O15ActiveX);else{if(c()||Bg()){var Ej=Mf.EncodeUrl?hh:
Mh;Mh=Mf.Mode;zi=cl(Mf.Application);Mi=fl();if(null==Mi)Ej=Dj.DescriptiveUnattemptedEnums?Xi.PluginIsNull:Xi.Unattempted;else{Ni=!1;try{Ni=Mi.ViewDocument3(window.self,Ej,Mh,zi)}catch(Mk){}if(!Ni)try{Ni=sk(Mh)?Mi.ViewDocument2(window.self,Ej,zi):Mi.EditDocument2(window.self,Ej,zi)}catch(Mk){}Ej=Ni?(Kb(Hk.NpapiPlugin),Xi.None):Xi.Failed}}else{try{Ej=new ActiveXObject(Wh),null!=Ej&&Ej.SaveSSOCreds()}catch(Mk){}Ej=Ek(Mf.EncodeUrl?hh:Mh,Mf.Mode,Mf.Options,cl(Mf.Application))}if(Ej!=Xi.None){if(Mh=Mf.CouldUseRoamingApps)nl||
(nl=!0,ol=Ba("Windows NT")),Mh=6.1<=ol&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Wc()||Bg()||Wf());if(Mh&&Mf.Application!=lj.OneNote){if(!Og.jdb.YDj()){nc(Xi.ControlNeeded,Dj.Application);return}if(Mf.RoamingAppsLauncher){"undefined"==typeof Mf.RoamingAppsLauncher||null==Mf.RoamingAppsLauncher?nc(Dj.DescriptiveUnattemptedEnums?Xi.RoamingLauncherIsNull:Xi.Unattempted,Dj.Application):"undefined"==typeof Mf.RoamingBitsUrl||null==Mf.RoamingBitsUrl?Og.jdb.dEj(Mf.DocumentUrl,Mf.RoamingAppsLauncher,
Mf.Application,Mf.ApplicationParameters,Gk,Yk):Og.jdb.Y7f(Mf.DocumentUrl,Mf.RoamingAppsLauncher,Mf.RoamingApplicationExe,Mf.ApplicationParameters,Mf.RoamingPlatform,Mf.RoamingBitsUrl,Gk,Yk);return}if(!Mf.ContinueIfLauncherIsNull){nc(Xi.LauncherNeeded,Dj.Application);return}}nk.NoProtocolHandlerFallback==(Mf.Options&nk.NoProtocolHandlerFallback)||jk(Mf)||Wc()||Rb()&&!(Dj.DescriptiveUnattemptedEnums?Ej>=Xi.O14Unattempted&&Ej<=Xi.DocumentUrlIsNull:Ej==Xi.Unattempted)?nc(Ej,Dj.Application):Sk(Mf.Application,
Mf.EncodeUrl?Yh:hh,Mf.Mode,Mf.Application==lj.OneNote,Mf.SilentExternalHandler,Mf.NavigateUsingWindowOpen)}}}}else nc(Dj.DescriptiveUnattemptedEnums?Xi.DocumentUrlIsNull:Xi.Unattempted,Dj.Application)}function Kb(Mf){null!=Gk&&Gk(Mf)}function nc(Mf,hh){"undefined"==typeof hh&&(hh=null);null!=Yk&&Yk(Mf,hh)}function Mc(){var Mf=0;if(c()||Bg()||Wf()){var hh=fl();try{null!=hh&&(Mf=hh.GetOfficeVersion())}catch(Yh){}}else bl(Ed)?Mf=15:bl(re)?Mf=14:bl(pf)?Mf=12:bl(Ze)&&(Mf=11);return Mf}function Yc(){return Rb()&&
(Lk(cg,!0)||Lk(Ug,!0))}var Ed="SharePoint.OpenDocuments.5",re="SharePoint.OpenDocuments.4",pf="SharePoint.OpenDocuments.3",Ze="SharePoint.OpenDocuments.2",cg="application/x-sharepoint",Ug="application/x-sharepoint-webkit",rh="application/x-sharepoint-protocolhandler",Lh="application/x-sharepoint-webkit-protocolhandler",nh="application/officelive",Ki="npSharePointPlugin",Wh="IDBHO.IDBHOCtrl",si="OneNote.Notebook",Ti="ofv|",ak="ofc|",Ij="ofe|",Vj="u|",Jj="|f|",kk="wdlor",Tk="",dl="",el="",Gk,Yk,kl,
ll,Dj,nl,ol,pl,ml,Uk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},nk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Xi={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,
DocumentUrlIsNull:13},Hk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},lj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Uk,OpenDocumentOptions:nk,OpenDocumentFailureType:Xi,OpenDocumentControl:Hk,OfficeApplication:lj,EditDocumentInClient:Va,EditDocumentInClientParams:function(){this.DocumentUrl=
"";this.Options=this.Mode=0;this.Application=lj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1},OfficeVersionInstalled:Mc,IsO14MacPluginInstalled:Yc,OfferOfficeInDialog:function(){return k()&&
11>=Mc()},OfferOfficeNoIntrusive:function(){return k()&&15>Mc()},OfferMacOffice:function(){return Rb()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Yc()},InstallRoamingControl:function(){Ge()?window.InstallTrigger.install({Office:{URL:dl}}):$i(el,null,null)},CanUseRoamingControl:function(){var Mf,hh,Yh;if(nb())return!0;if(Wf())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Ge())return Mf=document.createElement("RoamingExtensionElement"),
document.documentElement.appendChild(Mf),hh=document.createEvent("Events"),hh.initEvent("RoamingOfficeInstalled",!0,!1),Mf.dispatchEvent(hh),!!Mf.getAttribute("installed");if(Wc())try{return Yh=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Yh.HrExists()}catch(Mh){}return!1},InitUrls:function(Mf,hh,Yh){Tk=Mf;dl=Yh;el=hh},LaunchRoamingApps:function(Mf,hh,Yh,Mh,zi,Mi){Og.jdb.Y7f(Mf,hh,la(Yh),Mh,"x86",Tk,zi,Mi)},LaunchRoamingApps2:function(Mf,hh,Yh,Mh,zi,Mi,Ni,tk){var Ej="",Mk;if(null!=Mh&&
(Ej+=" "+Mh),null!=Mf&&(Ej+=' "'+Mf+'"'),nb()||Wf())kl=Ni,ll=tk,Ni='office: "'+(Mi+'" "')+(Yh+'" "ROAMING"'),Ni+=' "'+hh+'"',Ni+=' "'+zi+'"',Ni+=" "+Ej,dj(Ni,il,jl,!1,!1);else if(Ge())Mf=document.createElement("RoamingExtensionElement"),Mf.setAttribute("cabUrl",Mi),Mf.setAttribute("app",Yh),Mf.setAttribute("licensingEntitlements",hh),Mf.setAttribute("platform",zi),Mf.setAttribute("args",Ej),document.documentElement.appendChild(Mf),hh=document.createEvent("Events"),hh.initEvent("RoamingOfficeLaunch",
!0,!1),Mf.dispatchEvent(hh),null!=Ni&&Ni(Hk.RoamingFFExtension);else if(Wc()){if(Mk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Mk)try{Mk.HrConfigureSingle(Mi,Yh,hh,zi,Ej),null!=Ni&&Ni(Hk.RoamingActiveX)}catch(ql){}}else null!=tk&&tk(Xi.Failed)},ShouldShowDialog:function(){return!D()},NavigateToUrlUsingClickingOnATag:vi,OpenDocumentWithProtocolHandler:Sk,OpenDocumentWithProtocolHandlerNoCallBack:function(Mf,hh,Yh,Mh){var zi=I(Mf),Mi;return null==zi?(nc(Dj.DescriptiveUnattemptedEnums?
Xi.ProtocolHandlerNoCallbackIsNull:Xi.Unattempted,Dj.Application),!1):(Mi=Xk(Mf,hh,Yh,Mh,zi),dj(Mi,null,null,!1,!1),!0)}}}();Og.ClientUtils=Og.jdb;var Tf=b(800),Xf=b(58),ia=b(35),u=b(173);yg.prototype.Wc=function(){return!1};yg.prototype.executeCommand=function(c,k,D){return 2!==this.pi.Ge(eg.a.newDocument,2,D)?Ie.Task.Ra(!0):u.a(k.command)};yg.prototype.Ec=function(c,k){return 1056925771===k.command};yg.prototype.Yc=function(c,k,D){c=!0;switch(k){case "PopulateNewMenu":this.pi&&this.pi.Ge(eg.a.Lkc,
2,D);break;default:c=!1}return c};Object(te.a)(yg,"CreateNewCommandHandler",null,[160]);var m=Tf.a;Em(sg,m);sg.prototype.Gd=function(){var c=this,k=Xf.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),D=Xf.GetServiceTaskFactory.create(this.$.ea,165,this.la,this.rb,"System.IDisposable");ia.TaskExtensions.Aa(ia.TaskExtensions.xe([k,D],this.la),function(){c.Ad([new yg(wd.AFrameworkApplication.Hb)])},this.la,3)};sg.ja=function(c){Tf.a.Yd(87,new sg(c))};Object(te.a)(sg,"CreateNewCommandHandlerFactory",
Tf.a,[]);var K=b(1235),ka=b(861),ja=b(371),Gb=b(189),$b=b(283),Ac=b(4),fd=b(149),Pd=b(96),Xd=b(79),Te=b(73),rf=b(364),Ne=b(161),Yf=b(57),Af=b(81),ch=b(314),lg=b(600);ig.prototype.rke=function(){};ig.prototype.r1c=function(){this.Vgg?pg.a.downloadFile(this._url):pg.a.lf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};ig.prototype.dispose=function(){};Object(te.a)(ig,"OpenUrlInTabDialogDownloadBehavior",null,[43,6]);var jh=b(277),vh=Td.StandardDialog;Em(Eg,vh);Eg.prototype.GRc=
function(){this.Gl&&(this.mTa||(this.mTa=Object(qe.a)(this,this.Lni,"onActionButtonClicked"),this.Ex.pa(Sf.a.click,this.QA,this.mTa)),this.nTa||(this.nTa=Object(qe.a)(this,this.Mni,"onActionButtonKeyUp"),this.de.pa(Sf.a.Xd,this.QA,this.nTa)));vh.prototype.GRc.call(this)};Eg.prototype.Lni=function(c){this.JIe(c);return!0};Eg.prototype.Mni=function(c){return this.n$e(c,Object(qe.a)(this,this.JIe,"executeDismissActionButtonFromArgs"))};Eg.prototype.JIe=function(c){this.Gl&&this.Gl.submit();this.Csa(c.Sb)};
Eg.prototype.rnd=function(){};Eg.prototype.aBe=function(){this.jcf();this.Gl?this.Gl.submit():this.SNb.r1c();return!0};Eg.prototype.zec=function(){return!1};Eg.prototype.dispose=function(){this.SNb.dispose();this.Qeb&&(wd.AFrameworkApplication.xa.bW.za(Sf.a.click,this.Qeb,Object(qe.a)(this,this.aBe,"downloadLinkClicked")),this.Qeb=null);this.UW&&(wd.AFrameworkApplication.xa.bW.za(Sf.a.click,this.UW,Object(qe.a)(this,this.zec,"learnMoreLinkClicked")),this.UW=null);this.Ex&&this.mTa&&(this.Ex.za(Sf.a.click,
this.QA,this.mTa),this.mTa=null);this.de&&this.nTa&&(this.de.za(Sf.a.Xd,this.QA,this.nTa),this.nTa=null);vh.prototype.dispose.call(this)};Eg.prototype.eBf=function(){this.Gl&&(document.body.appendChild(this.Gl),this.Gl.submit(),document.body.removeChild(this.Gl))};Eg.prototype.sv=function(c){1===c&&(this.rnd(),this.Gl?Eg.Cx&&this.eBf():this.SNb.r1c());this.dispose()};Ll.Object.defineProperties(Eg.prototype,{j0e:{configurable:!0,enumerable:!0,get:function(){return null}},tOd:{configurable:!0,enumerable:!0,
get:function(){return null}},OLa:{configurable:!0,enumerable:!0,get:function(){return null}},Exb:{configurable:!0,enumerable:!0,get:function(){return null}},V4a:{configurable:!0,enumerable:!0,get:function(){return null}},Xff:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},d_c:{configurable:!0,enumerable:!0,get:function(){return null}},lQc:{configurable:!0,enumerable:!0,get:function(){return null}},Nge:{configurable:!0,
enumerable:!0,get:function(){return null}}});Ll.Object.defineProperties(Eg,{Cx:{configurable:!0,enumerable:!0,get:function(){return wd.AFrameworkApplication.xa.Xa.qu&&wd.AFrameworkApplication.xa.Xa.D7e}},Vtb:{configurable:!0,enumerable:!0,get:function(){return Eg.V_d},set:function(c){Eg.V_d=c}}});Eg.V_d=!1;Object(te.a)(Eg,"ADialogWithLinkToResource",Td.StandardDialog,[]);var dh=b(405),xg=b(260),Ff=b(16);Em(Gg,Eg);Gg.prototype.hcf=function(){nd.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};
Gg.prototype.jcf=function(){nd.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};Gg.prototype.zec=function(){dh.Redirect.showHelp(xg.a.gni);return!0};Ll.Object.defineProperties(Gg.prototype,{OLa:{configurable:!0,enumerable:!0,get:function(){return Ff.a.instance.Ua(410)}},Gec:{configurable:!0,enumerable:!0,get:function(){return Ff.a.instance.Ua(411)}},Fec:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},Exb:{configurable:!0,
enumerable:!0,get:function(){return"#"}},V4a:{configurable:!0,enumerable:!0,get:function(){return Ff.a.instance.Ua(412)}},Xff:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(te.a)(Gg,"DownloadACopyAsOdsDialog",Eg,[]);Uf.prototype.rke=function(c){this.dialog=c};Uf.prototype.r1c=function(){this.Bni.ruf(-1059172980)};Uf.prototype.dispose=function(){this.zb.cEb(Object(qe.a)(this,this.Ylf,"onDownloadError"))};Uf.prototype.Ylf=function(){this.dialog&&this.dialog.hide()};Object(te.a)(Uf,
"DownloadACopyAsOdsDialogDownloadBehavior",null,[43,6]);Object(te.a)(xf,"MacroRecorderWorkbookCalculationModeSetPayload",null,[115]);Object(te.a)(Fg,"MacroRecorderWorkbookRecalculatedPayload",null,[115]);var Ai=b(203),Oh=b(117),zg=b(1),Bi=b(367);Ll.Object.defineProperties(Ef,{oCi:{configurable:!0,enumerable:!0,get:function(){return Ef.nCi}}});Ef.nCi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(te.a)(Ef,"OpenInAppDialogCopyHtml",null,[]);var mj=b(365),T=Bi.a;Em(wg,T);wg.prototype.openUrl=function(c,k){var D=document.getElementById("link");D||(D=document.createElement("a"),D.id="link",D.style.visibility="hidden",D.href="",document.body.appendChild(D));D.target=k;D.href=c;D.click()};wg.prototype.j8f=function(){var c=this;nd.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.Va(this.$.ea,21,137,1,"Postmessage.IHostPostmessenger"),
function(k){var D={};D.OpenInAppUrl=c.d6a;D.StoreUrl=c.Gt;k.result.Vj("UI_OpenInMobileApp",D)},this.$.la)};wg.prototype.Szb=function(){var c=this;nd.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.j8f(),!0;af.a.lp?(nd.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.rB&&this.rB.length||nd.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+
this.rB+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.Gt+";end","_top")):9<=af.a.ced?(nd.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.d6a,"_top"),window.setTimeout(function(){c.openUrl(c.Gt,"_blank")},9E3)):(nd.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),
this.openUrl(this.d6a,"_top"),window.setTimeout(function(){c.openUrl(c.Gt,"_blank")},500));return!0};wg.prototype.mka=function(c){return c.Ea.keyCode===Zg.a.Ph||c.Ea.keyCode===Zg.a.Vza?(nd.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),c.Sb.click(),!0):!1};wg.prototype.pCi=function(){nd.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};wg.prototype.Eh=function(){this.tf=oa.a.$i(Ef.oCi,Ff.a.instance.da(640),Ff.a.instance.da(641),wd.AFrameworkApplication.WB,
mj.getImageClass(wd.AFrameworkApplication.ha.Ta("AppIcon")),Ff.a.instance.da(642));this.Ie="OpenInAppDialog";this.hc=5;this.initializeAndShow("",this.pCi.bind(this),null);this.Ny(this.XG)};wg.prototype.Eu=function(c){T.prototype.Eu.call(this,c);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.XG=document.getElementById("LinkToInstall");Ai.a.instance.pa(Sf.a.click,this.XG,Object(qe.a)(this,this.Szb,"onClickHandler"));Oh.KeyInputManager.instance.pa(Sf.a.Xd,this.XG,Object(qe.a)(this,
this.mka,"onKeyUpHandler"))};wg.prototype.dispose=function(){this.XG&&(Ai.a.instance.za(Sf.a.click,this.XG,Object(qe.a)(this,this.Szb,"onClickHandler")),Oh.KeyInputManager.instance.za(Sf.a.Xd,this.XG,Object(qe.a)(this,this.mka,"onKeyUpHandler")),this.XG=null);T.prototype.dispose.call(this)};Ll.Object.defineProperties(wg.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(te.a)(wg,"OpenInAppDialogCopy",Bi.a,[]);var Oa=b(26),Eb=b(27),vc=b(348),gd=b(9),
Cd=b(7),Fd=b(275),$d=b(20),Ae=b(39),$e=b(246),qg=b(452),Tg=b(372),jg=b(49),vf=b(6),Xg=b(133),bh=b(1108),Fh=b(80),gh=b(33),ud=b(354),Jh=b(248);Sg.prototype.xP=function(c,k){c=Eb.a.gd(12,1,643,0,0,0,"Blank");c.Description=String.format(Ff.a.instance.da(644),k);return c};Sg.prototype.w6b=function(c){switch(c){case 1:case 2:return 0;default:return 2}};Object(te.a)(Sg,"ReloadCloseConfirmation",null,[166]);var bg=b(145),xj=b(601),xi=b(64),O=Gb.a;Em(Vf,O);Vf.prototype.Wc=function(){return!1};Vf.prototype.executeCommand=
function(c,k,D,ba){var Ba=this,nb=this.I2b,Rb=this.$,Ic=k.command,Wc=this.openInExcelOperation,Rd=this.$.Jb,Ge=D.SourceControlId;Rb.Ck.ree(Ic);c=null;switch(Ic){case 1455037301:this.$.X3?Wc.Ite():Wc.Hte();break;case -2044628748:case 2004484710:this.$.X3?Wc.Ite():Wc.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===Ge?(this.eyb("CellLongPress"),nd.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):
(this.eyb("PencilIcon"),nd.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case -2028960985:Wc.nVf();break;case -1059172980:new Gg(Wc.Mme(Ic),new Uf(Wc,Rb.zb));break;case -1285148982:this.clientWorkflow.fd.activityState[gh.a.jOc]=!0;this.Wuc(!1);break;case -75280711:this.Wuc(!1);break;case -455164169:this.Wuc(!0);break;case -1388494670:this.$.ea.$a(400,function(vi){vi.pgi();Ba.Wuc(!1)});
break;case 810888577:wd.AFrameworkApplication.jk=(new Date).getTime();nd.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",wd.AFrameworkApplication.jk);break;case -1804063550:case -974518828:k=0;Ac.a.jvd in D&&(k=D[Ac.a.jvd]);Wc.ruf(Ic,k);break;case -1339961039:k=!1;D&&Ac.a.IEd in D&&(k=D[Ac.a.IEd]);this.reloadWorkbook(!1,k);break;case -8805455:var df=this.workbookContext;Rb.isEditMode||(Vf.nre(Rb),c=ia.TaskExtensions.Aa(this.gJ.value,function(vi){vi=
vi.result;var $i=vi.isEnabled();$i&&lg.a(vi,Ih.a.copyAndEdit,Yf.a.Df.tPe(),Ba.$.fa.$g.get(2))?nd.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):$i&&wd.AFrameworkApplication.V3f?($i={},$i[K.a.$xd]=wd.AFrameworkApplication.userSessionId,$i[wd.AFrameworkApplication.Jii]=Oa.a.Qa.Gb.getTime().toString(),nd.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
vi.Vj(Ih.a.editMode,$i)):nb.CopyAndEditUrl?Ba.fRg():(Ba.ic.supportsEditing||df.EditUrl)&&Ba.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Rb.isEditMode&&(Vf.nre(Rb),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var Wf=Rb.ra.ua.Wb(),Pg=-1355155015===Ic?1:0,Bg=function(){return new Fg(Pg)};c=rf.a(this.$.userOperationManager,function(vi,$i,jk){return Af.U(Rb.ra.ua,Pg,null,vi,$i,jk,null,Wf)},function(vi){return new Ne.a(128,0,vi,void 0,Bg)},k);$d.g(Rb).wi.PF(!1);
break;case -1158102843:c=$d.g(Rb).wi.recalcSheet(k);$d.g(Rb).wi.PF(!1);break;case -988468372:if(zg.EwaSettings.ka(308))if(ba=parseInt(D[Xd.a.Md]),0<=ba&&3>ba)this.setCalculationMode(k,ba);else return nd.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",D[Xd.a.Md]),u.a(Ic);break;case 257398710:fd.a.ntw(nb.ReportAbuseUrl,Rb);break;case 1800405051:this.n1i();break;case -48469327:this.saveACopy();break;case 214430355:k=!1;D&&Ac.a.Z1c in D&&(k=D[Ac.a.Z1c]);if(!this.Rdj(k,
D))break;wd.AFrameworkApplication.nU?this.businessBar.eg(40,null):this.businessBar.eg(k?22:23,null);break;case 1389557314:c=ia.TaskExtensions.Aa(this.gJ.value,function(vi){lg.a(vi.result,Ih.a.slh,null,Ba.$.fa.$g.get(6))||fd.a.ntw(nb.FileVersionUrl,Rb)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:Ge===Rd+Ac.a.e$e?Wc.D$h():Wc.C$h();break;case 512141517:Ge===Rd+Ac.a.d$e?Wc.N$h():Wc.M$h();break;case -1224038235:var qh=ka.a.On in D?!D[ka.a.On]:Pd.j(Rb.fa.workbookContext.Options);
D[ka.a.Description]=qh?Ff.a.instance.da(549):Ff.a.instance.da(550);c=rf.a(this.$.userOperationManager,function(vi,$i,jk){var sk=Ba.$.ra.ua,Ek=sk.Na(9,null);Ek.isReadOnlyRecommended=!qh;return Af.i(sk,"SetReadOnlyRecommended",Ek,vi,$i,jk,null,0)},function(vi){return new Ne.a(129,0,vi)},k);break;case 1118926154:if(this.$.isEditMode){var dj=new ff.a;this.$.ea.$a(53,function(vi){vi?(vi.tn.x$h(Ba.$.Jb+Ac.a.kld),dj.setResult(!0)):nd.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});
c=dj.task}break;case -1698025133:Wc.openInBrowser();break;case 520859864:c=ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.Va(this.$.ea,393,394,ba.gia(),"Microsoft.Office.Excel.WebUI.Client.ISaveToHostManager"),function(vi){vi.result||nd.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:c=u.a(Ic)}return c||Ie.Task.Ra(!0)};Vf.prototype.eyb=function(c){if(zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(gd.HelperMethods.TY){var k=
new Map;k.set("EntryPoint",c);ze.Health.instance.recordKpiUsage(Tg.a.mCi,0,qg.a.rii,k)}else nd.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};Vf.prototype.showOpenInAppDialog=function(){wd.AFrameworkApplication.isMobileMode&&(zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(nd.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),
(new wg(this.$)).Eh()):(nd.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),wd.AFrameworkApplication.showOpenInAppDialog()))};Vf.prototype.Rdj=function(c,k){var D=this;return wd.AFrameworkApplication.isMobileMode&&!Te.a(this.$.ya,30)?(this.showOpenInAppDialog(),nd.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.eyb("CellDoubleTap"),nd.ULS.sendTraceTag(537162646,
0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):wd.AFrameworkApplication.vcc&&(c&&vc.c(this.workbookContext.WorkbookFileName)||Cd.a.ma(this.workbookContext.FullDocumentInfo.HostEditUrl))?(nd.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",vc.d(this.workbookContext.WorkbookFileName)?
"xls":"csv",Cd.a.ma(this.workbookContext.FullDocumentInfo.HostEditUrl)?"":"not "),!1):ja.a.any([25,26,30,31,55,32],function(ba){return D.businessBar.bKa(ba)})?(nd.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):k&&Ac.a.gKi in k&&!c?!1:!0};Vf.prototype.Ec=function(c,k){c=!1;switch(k.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:c=
!0;break;case 520859864:c=zg.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:c=zg.EwaSettings.ka(108);break;case -1388494670:c=zg.EwaSettings.ka(108);break;case 810888577:c=zg.EwaSettings.ka(274);break;case -1224038235:c=this.$.fa.amIAlone;break;case -988468372:c=zg.EwaSettings.ka(308);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:c=!0,nd.ULS.shipAssertTag(537162642,0,this.$.Q$,
"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return c};Vf.prototype.Yc=function(){return!1};Vf.prototype.n1i=function(){var c=this;if(this.lc){var k=this.$;Ae.a(k).zs(new $e.a(vf.a.ly,5,function(){k.mH(!1,!0);var D=c.clientWorkflow.fd.activityState;D[Jh.a.rq]=vf.a.Zba;D[Xg.a.iS]=2;D[gh.a.Wq]=k.isEditMode;D[Xg.a.cfa]=!1}))}};Vf.prototype.saveACopy=function(){var c=this;if(this.lc){var k=this.$;Ae.a(k).zs(new $e.a(vf.a.ly,5,function(){k.mH(!1,!1);var D=
c.clientWorkflow.fd,ba=D.activityState;ba[Jh.a.rq]=vf.a.ZJf;ba[xj.a.AUb]=c.ic.hasUnsupportedFeaturesForEdit;ba[Xg.a.cfa]=!1;D.Ss(Eb.a.N9(c.businessBar.k2c,[-502303485]))}))}};Vf.prototype.Wuc=function(c){var k=this;Ae.a(this.$).zs(new $e.a(vf.a.Bla,2,function(){k.$.mH(!0,!0);var D=xi.a(k.$).fd,ba=k.$.isEditMode;ba=Eb.a.gd(1,1,0,0,0,ba?-315732528:-2087635043,ba?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");ba.ForceVersionUpgrade=c;D.Ss([ba]);D=xi.a(k.$).fd.activityState;D[Jh.a.rq]=vf.a.Bla;
D[gh.a.Wq]=k.$.isEditMode;D[Xg.a.cfa]=!1}))};Vf.prototype.closeWorkbook=function(){var c=this;if(this.lc){var k=this.$;Yf.a.Df.urc("2145659238")?ia.TaskExtensions.Aa(this.gJ.value,function(D){D.result.Vj(Ih.a.ZJe,{})},this.la,3):Ae.a(k).zs(new $e.a(vf.a.ly,5,function(){k.mH(!0,!1);var D=c.clientWorkflow.fd.activityState;D[Xg.a.mX]=!1;D[Xg.a.cfa]=!1;c.ic.inViewerFromWebPart?(ch.a.Lyd(k,c.clientWorkflow.fd),k.Ck.Px("InViewerFromWebPart"),D[Jh.a.rq]=vf.a.tZ):(D[Jh.a.rq]=vf.a.vk,k.zd&32?D[Xg.a.iS]=0:
(D[Xg.a.iS]=1,D[Xg.a.pUb]=new bh.a),D[bg.a.Rce]=!0)}))}};Vf.prototype.fRg=function(){var c=this,k=this.ic.vbaRemovedDuringConversion;nd.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",k);var D=this.$;k?Ae.a(D).zs(new $e.a(vf.a.ly,5,function(){var ba=Eb.a.gd(3,0,0,1200,0,1069271157,"XLSMacroFailure");c.clientWorkflow.fd.Ss([ba]);c.clientWorkflow.fd.activityState[Jh.a.rq]=vf.a.tbb})):wd.AFrameworkApplication.hideHeader?gd.HelperMethods.lf(this.I2b.CopyAndEditUrl,
"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):fd.a.ntw(this.I2b.CopyAndEditUrl,D)};Vf.prototype.reloadWorkbookInEditMode=function(){var c=this;if(this.lc)if(zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&Yf.a.Df.sU&&Yf.a.Df.AAd(),wd.AFrameworkApplication.vcc&&!wd.AFrameworkApplication.pja)gd.HelperMethods.lf(this.$.$lb(!0),$b.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var k=this.$,D=!1,ba=this.ic.hasUnsupportedFeaturesForEdit,
Ba=this.workbookContext.FileWasRepaired;vc.d(this.workbookContext.WorkbookFileName)?(D=!0,nd.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",ba)):vc.a(this.workbookContext.WorkbookFileName)&&(D=!0,nd.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var nb=k.Qf.get(59);nb=!(k.fa.ic.supportsEditing&&nb);if(D&&!ba||nb&&(D||ba)){var Rb=nb?ba?-2066104278:
816071846:zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&Te.a(this.$.ya,25)&&!this.$.uwb?765011943:-213064907;D=function(){var Ic=Eb.a.nXa([Rb]);c.clientWorkflow.fd.Ss(Ic);c.clientWorkflow.fd.activityState[Jh.a.rq]=vf.a.tbb}}else D=function(){k.mH(!0,!1);var Ic=c.clientWorkflow.fd,Wc=Ic.activityState;Wc[Xg.a.iS]=1;Wc[ud.a.uUb]=Eh.a.qgc;Wc[gh.a.Wq]=!0;Wc[xj.a.AUb]=c.ic.hasUnsupportedFeaturesForEdit;Wc[Xg.a.cfa]=!!c.workbookContext.EditUrl;Wc[Fh.a.a1]=c.workbookContext.EditUrl;
if(!c.I2b.CopyAndEditUrl){var Rd=[zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&Te.a(c.$.ya,25)&&!c.$.uwb?-943219229:1821390342];Ic.Ss(Eb.a.N9(c.businessBar.k2c,Rd))}Ba&&!ba?(vc.b(c.workbookContext.WorkbookFileName)&&zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(Ic=Eb.a.nXa([-425642652]),nd.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Ic=Eb.a.nXa([108482388]),
c.clientWorkflow.fd.Ss(Ic),Wc[Jh.a.rq]=vf.a.mKf):zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5663121_PasswordToModify")&&c.$.fa.iZe?(nd.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),jg.b().mMd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Wc[Jh.a.rq]=vf.a.WBb):Wc[Jh.a.rq]=c.$.fa.fcc?vf.a.Ixb:vf.a.tbb};Ae.a(k).zs(new $e.a(vf.a.ly,5,D))}};
Vf.prototype.reloadWorkbookInViewMode=function(){var c=this;if(this.lc){zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&Yf.a.Df.sU&&Yf.a.Df.AAd();var k=this.$;af.a.ah&&$d.g(k).Gc.textBox.blur();Ae.a(k).zs(new $e.a(vf.a.ly,5,function(){k.mH(!k.fa.isNamedObjectViewMode,!1);var D=c.clientWorkflow.fd.activityState;D[Jh.a.rq]=vf.a.pga;D[Xg.a.iS]=1;D[Xg.a.mX]=!0;D[gh.a.Wq]=!1;D[gh.a.Njb]=!0;D[ud.a.uUb]=Eh.a.qgc}))}};Vf.prototype.reloadWorkbook=function(c,k){var D=
this;if(this.lc){var ba=this.$;ba.xL&65536&&Ae.a(ba).zs(new $e.a(vf.a.ly,5,function(){ba.mH(c,!0);var Ba=D.clientWorkflow.fd.activityState;Ba[Jh.a.rq]=vf.a.wk;Ba[gh.a.mOc]=D.workbookContext.NovMode;k||(Ba[Xg.a.iS]=1,Ba[Xg.a.pUb]=new Sg)}))}};Vf.prototype.setCalculationMode=function(c,k){function D(){return new xf(k)}var ba=this;nd.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",k);var Ba=this.$.fa.workbookContext.CalcMode;this.$.fa.workbookContext.CalcMode=k;return rf.a(this.$.userOperationManager,
function(nb,Rb,Ic){var Wc=ba.$.ra.ua;nb=Fd.b(nb,Vf.izi(ba.$,Ba));Rb=Fd.a(Rb,Vf.hzi(ba.$,Ba));var Rd=Wc.Na(9,null);Rd.calc_type=k;return Af.i(Wc,"SetCalculationOptions",Rd,nb,Rb,Ic,null,0)},function(nb){return new Ne.a(197,0,nb,void 0,D)},c)};Vf.nre=function(c){c.zb&&0<c.zb.tQ&&c.zb.H4c(function(k){k.Yt()})};Vf.izi=function(c,k){return function(D){Eb.a.Zg(D.Errors)&&(c.fa.workbookContext.CalcMode=k,nd.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
k,Eb.a.Uc(D.Errors)))}};Vf.hzi=function(c,k){return function(){c.fa.workbookContext.CalcMode=k;nd.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",k)}};Ll.Object.defineProperties(Vf.prototype,{lc:{configurable:!0,enumerable:!0,get:function(){return this.$.fa.lc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},I2b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return xi.a(this.$)}},ic:{configurable:!0,enumerable:!0,get:function(){return this.$.ic}}});Object(te.a)(Vf,"FileOperationsCommandHandler",Gb.a,[160]);var qa=b(147),rb=Tf.a;Em(hf,rb);hf.prototype.Gd=function(){var c=this,k=this.$,D=[],ba=Xf.GetServiceTaskFactory.create(k.ea,56,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IOpenInExcelOperation");D.push(ba);var Ba=Xf.GetServiceTaskFactory.Va(k.ea,5,4,this.rb,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");
D.push(Ba);ia.TaskExtensions.Aa(Ie.Task.WAA.apply(null,D),function(){qa.b(ba)&&c.Ad([new Vf(k,ba.result,new Kf.a(function(){return Xf.GetServiceTaskFactory.create(k.ea,137,c.la,c.rb,"Postmessage.IHostPostmessenger")}),Ba.result)])},this.la,0)};hf.ja=function(c){Tf.a.Yd(94,new hf(c))};Object(te.a)(hf,"FileOperationsCommandHandlerFactory",Tf.a,[]);var Sb=b(46),Uc;(function(c){c[c.url=0]="url";c[c.ref=1]="ref";c[c.mailto=2]="mailto"})(Uc||(Uc={}));Object(te.b)("HyperlinkSelectionState",Uc);var vd=b(883),
oe=b(10),ef=b(598),Nf=b(91),kh=vd.a;Em(Pe,kh);Pe.prototype.wSh=function(c,k){1===c||2===c?(nd.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===c?"OK":"Remove"),this.$qd=k[Pe.Aai],this.Zqd=k[Pe.E3i],this.Yqd=k[Pe.Q3g],2===c&&(this.removeHyperLink=!0),this.commit()):nd.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Pe.prototype.NRe=function(c,k){switch(k){case 2:return c.startsWith("mailto:")?c:"mailto:"+c;case 1:return String.format("{0}{1}",oe.a.mxf,this.BCh(c));default:return c}};
Pe.prototype.$Aj=function(c,k){return k&&c.length?1===k?this.lQe(Sb.y(c,this.fa.va)||this.Lji(c),730):this.lQe(ae.a.khd(c),732):null};Pe.prototype.vw=function(){var c=this,k=this.$;this.location=this.NRe(this.$qd,this.Zqd);try{this.location=Nf.a.yq(this.location)}catch(Ba){nd.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}nd.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",Uc[this.Zqd]);this.cellValue=this.Yqd.length?this.Yqd:this.$qd;k.Es();var D=k.ra.ua.Wb(),ba=Sb.s(this.selectedRange);
return function(Ba,nb,Rb){return Af.c(k.ra.ua,ba,c.cellValue,c.location,c.removeHyperLink,!1,123,Ba,nb,Rb,c.WK.range,D)}};Pe.prototype.Ll=function(){var c=this,k=Sb.s(this.selectedRange);return function(){return new ef.a(k,c.cellValue,c.location)}};Pe.prototype.akh=function(){var c=this.WK.cell.m2a;this.WK.cell.vtb?c&&c.startsWith("mailto:")?(this.Jjb=2,c=c.substr(7)):this.Jjb=0:this.Jjb=1;return c};Pe.prototype.xJa=function(){zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
this.uvb=this.WK.v$:this.uvb=!!this.WK.pIa(64)||!!this.WK.pIa(128)};Pe.prototype.Zl=function(){if(this.uvb){this.yZa=this.WK.text;var c=this.akh();c&&(this.aOc=c);this.Kn=Ff.a.instance.da(789);this.Onb=this.aOc===this.yZa}else this.WK.text?(this.yZa=this.WK.text,this.Onb=!1):(this.yZa="",this.Onb=!0),this.Jjb=0,this.Kn=Ff.a.instance.da(788);this.WK.mJ&&(this.Onb=!1,this.Ize=!0,zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.yZa=this.WK.formulaBarText))};Pe.prototype.Lji=
function(c){return this.fa.wb.Aj(c)};Pe.prototype.lQe=function(c,k){return c?null:Ff.a.instance.da(k)};Pe.prototype.BCh=function(c){var k=Sb.Y(c,this.fa.va);var D=k.sheetName;var ba=k.range;k.returnValue&&ba&&(c=Sb.x(ba,D||this.sheetName,!1));return c};Ll.Object.defineProperties(Pe.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},$v:{configurable:!0,enumerable:!0,get:function(){return 526}}});Pe.Aai="linkValue";Pe.E3i="selectedLink";Pe.Q3g="displayText";Object(te.a)(Pe,
"HyperlinkDialog",vd.a,[]);nf.prototype.Wc=function(){return!1};nf.prototype.Ec=function(c,k){return 1===c&&-1583422759===k.command};nf.prototype.Yc=function(){return!1};nf.prototype.executeCommand=function(){this.Jgj();return Ie.Task.Ra(!0)};nf.prototype.Jgj=function(){var c=Sb.v(this.gridView.ga.wa.Nd,this.$),k=$d.e(this.gridView);(!zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Xs([this.gridView.ga.wa.Nd],!0))&&k&&new Pe(this.$,
c,k)};Object(te.a)(nf,"ShowHyperlinkCommandHandler",null,[160]);var Md=Tf.a;Em(Ke,Md);Ke.prototype.Gd=function(){this.Ad([new nf(this.$,$d.g(this.$))])};Ke.ja=function(c){Tf.a.Yd(105,new Ke(c))};Object(te.a)(Ke,"ShowHyperlinkCommandHandlerFactory",Tf.a,[]);var Je=b(1127);We.create="Create";We.activate="Activate";We.close="Close";We.remove="Delete";We.duplicate="Duplicate";Object(te.a)(We,"Actions",null,[]);var qf=Ie.Task;Em(Qd,qf);Qd.prototype.xK=function(){this.wTd=Eb.a.gd(3,2,0,1596,0,-1244327602,
"MsFormDeleteConfirmation");this.Ui=Ae.a(this.sf.$).ai(this.wTd).G();this.Ui.isCompleted||(this._state=2,this.Ui.xM(Object(qe.a)(this,this.moveNext,"moveNext")));return this.Mxc};Qd.prototype.Mxc=function(){this.yTd=this.Ui.oy();this.yTd||(this.sf.$.workbookContext.Options=gd.HelperMethods.hN(!1,this.sf.$.workbookContext.Options,2048),this.sf.deleteMsFormMetaDataSheet());this._state=3;this.YOa(!0)};Qd.prototype.dispose=function(){};Qd.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.Rt=
this.Rt()}catch(c){this.dispose(),this.lca(c),this._state=3}};Object(te.a)(Qd,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",Ie.Task,[6]);ad.action="Action";ad.Inh="FlexPane";ad.Z5b="formId";ad.id="id";ad.title="Title";ad.dLb="XlWorkbookId";ad.Gph="Fragment";ad.host="Host";ad.rrj="TopView";ad.X0="auth_pvr";Object(te.a)(ad,"Parameters",null,[]);Ub.prototype.Wc=function(c,k){switch(k){case -105284469:return!Pd.i(this.$.kg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};
Ub.prototype.executeCommand=function(c,k){c=ia.TaskExtensions.dm();k=k.command;switch(k){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:c=this.deleteMsForm();break;default:c=u.a(k)}return c};Ub.prototype.Ec=function(c,k){if(!this.$.fa.$g.get(61))return!1;c=!1;switch(k.command){case -105284469:c=Pd.i(this.$.kg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:c=
this.hasMsForm}return c};Ub.prototype.Yc=function(){return!1};Ub.prototype.insertMsForm=function(){var c=ae.a.Bq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),k={},D={};k[ad.action]=We.create;k[ad.X0]=this.X0;D[ad.action]=We.create;D[ad.dLb]=encodeURIComponent(this.$Kb);D[ad.host]=this.Mn;D[ad.title]=encodeURIComponent(c);this.wyb(k,D);this.$.workbookContext.Options=gd.HelperMethods.hN(!1,this.$.workbookContext.Options,2048)};Ub.prototype.editMsForm=function(){var c={},k={};c[ad.X0]=
this.X0;k[ad.Z5b]=this.Dgc;k[ad.dLb]=encodeURIComponent(this.$Kb);k[ad.host]=this.Mn;this.wyb(c,k)};Ub.prototype.previewMsForm=function(){var c={},k={};c[ad.X0]=this.X0;k[ad.Z5b]=this.Dgc;k[ad.dLb]=encodeURIComponent(this.$Kb);k[ad.host]=this.Mn;k[ad.rrj]="Preview";this.wyb(c,k)};Ub.prototype.sendMsForm=function(){var c={},k={};c[ad.X0]=this.X0;k[ad.Z5b]=this.Dgc;k[ad.Inh]="SendForm";k[ad.dLb]=encodeURIComponent(this.$Kb);k[ad.host]=this.Mn;this.wyb(c,k)};Ub.prototype.deleteMsForm=function(){return new Qd(this)};
Ub.prototype.deleteMsFormMetaDataSheet=function(){var c=this;this.$.userOperationManager.ft(new Ne.a(158,0,function(k,D,ba){return kc(c.$.ra.Kv,c.JT.arb,Fd.b(k,function(){c.a1g()}),D,ba,null)}))};Ub.prototype.a1g=function(){var c={},k={};c[ad.action]=We.remove;c[ad.X0]=this.X0;k[ad.action]=We.remove;k[ad.host]=this.Mn;k[ad.Z5b]=encodeURIComponent(this.Dgc);k[ad.dLb]=encodeURIComponent(this.$Kb);this.wyb(c,k)};Ub.prototype.wyb=function(c,k){var D=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",ba=
"",Ba="";if(k){for(var nb in k){var Rb=nb,Ic=k[nb];Ba+=Ba.length?"&":"";Ba+=Rb+"="+Ic}c||(c={});c[ad.Gph]=encodeURIComponent(Ba)}if(c)for(var Wc in c)k=Wc,Ba=c[Wc],ba+=ba.length?"&":"?",ba+=k+"="+Ba;window.open(D+ba,"_blank")};Ll.Object.defineProperties(Ub.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return Pd.c(this.$.kg)}},Dgc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},$Kb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},
X0:{configurable:!0,enumerable:!0,get:function(){return Cd.a.contains(this.$.Ut.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(te.a)(Ub,"MsFormCommandHandler",null,[160]);var ej=Tf.a;Em(bb,ej);bb.prototype.Gd=function(){var c=this,k=Xf.GetServiceTaskFactory.create(this.$.ea,203,this.la,this.rb,"System.IDisposable");ia.TaskExtensions.Aa(ia.TaskExtensions.xe([k],this.la),function(){c.Ad([new Ub(c.$)])},this.la,3)};bb.ja=function(c){c.fa.$g.get(61)&&Tf.a.Yd(215,new bb(c))};Object(te.a)(bb,
"MsFormCommandHandlerFactory",Tf.a,[]);var $f=Me.a;Em(Nb,$f);Nb.prototype.create=function(){var c=this;ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.create(this.$.ea,164,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.NewAndOpen.INewAndOpenCoreManager"),function(){c.Eb(new qd)},this.la,3)};Object(te.a)(Nb,"NewAndOpenUXFactory",Me.a,[]);za.prototype.executeCommand=function(c,k,D){c=2;switch(k.command){case eg.a.openUrlInNewTab:c=this.pi.Ge(eg.a.openUrlInNewTab,2,D);break;case eg.a.JMa:c=this.pi.Ge(eg.a.JMa,
2,D)}return 2!==c?Ie.Task.Ra(!0):u.a(k.command)};za.prototype.Ec=function(c,k){return k.command===eg.a.openUrlInNewTab||k.command===eg.a.JMa};za.prototype.Yc=function(c,k,D){return"PopulateMruMenu"===k?(this.pi.Ge(eg.a.Kkc,2,D),!0):!1};za.prototype.Wc=function(){return!1};Object(te.a)(za,"OpenFromMruCommandHandler",null,[160]);var mi=Tf.a;Em(we,mi);we.prototype.Gd=function(){var c=this,k=Xf.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),D=Xf.GetServiceTaskFactory.create(this.$.ea,
165,this.la,this.rb,"System.IDisposable");ia.TaskExtensions.Aa(ia.TaskExtensions.xe([k,D],this.la),function(){c.Ad([new za(c.$,wd.AFrameworkApplication.Hb)])},this.la,3)};we.ja=function(c){Tf.a.Yd(88,new we(c))};Object(te.a)(we,"OpenFromMruCommandHandlerFactory",Tf.a,[]);var qj=b(86),yh=b(83),Li=b(240),aj=b(656),gi=b(1072),ii=Li.a;Em(Le,ii);Le.prototype.execute=function(c){var k=Object(yh.a)(10,c.Ae);if(!k.Q$)return nd.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),
this.Zfd(c),this.fh(vf.a.idle),1;this.myb||(this.myb=new gi.DownloadACopyOperation(this.zfc,k));this.myb.o5g();nd.ULS.shipAssertTag(537154817,0,3!==xi.a(k).gi.ht,"The current activity should not be closed.");return 1};Le.prototype.Zfd=function(c){var k=Object(yh.a)(10,c.Ae),D=new aj.a(k);this.subscribe(c,Object(qe.a)(this,this.tud,"onProtectedFileDataLeakErrorDialogDisposing"),function(ba){D.add_disposing(ba)});nd.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");
D.initialize();D.mf()};Le.prototype.tud=function(c){this.unsubscribe(function(k){c.remove_disposing(k)});this.fh(vf.a.vk);this.Go()};Le.prototype.dispose=function(){qj.a.Fa(this.myb);this.myb=null;ii.prototype.dispose.call(this)};Object(te.a)(Le,"DownloadAForkedCopyActivity",Li.a,[]);var of=Me.a;Em(mc,of);mc.prototype.create=function(){var c=this;ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),function(){c.Eb(new Le(vf.a.EZa,vf.a.vk,!0))},this.la)};
Object(te.a)(mc,"DownloadACopyPreDatalossActivityFactory",Me.a,[]);var Ui=Me.a;Em(od,Ui);od.prototype.create=function(){var c=this;ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),function(){c.Eb(new Le(vf.a.unmergeableDownloadCopy,vf.a.Jma))},this.la)};Object(te.a)(od,"DownloadAForkedCopyActivityFactory",Me.a,[]);Tc.prototype.Lg=function(){this.La.Xb(eg.a.tryMacOffice,ih.a.frame,Object(qe.a)(this,this.VAi,"onTryMacOffice"));this.La.Xb(eg.a.a0f,
ih.a.frame,Object(qe.a)(this,this.Ntf,"onTryMacOfficeFromViewer"));this.La.Xb(eg.a.$_f,ih.a.frame,Object(qe.a)(this,this.Ntf,"onTryMacOfficeFromViewer"))};Tc.prototype.VAi=function(c,k,D,ba,Ba){if(1===D)return 32;Ba?(c=Ba.SourceControlId,"btnjTryMacOfficeForWordEditor"===c?pg.a.lf(xe.a.sY(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===c&&pg.a.lf(xe.a.sY(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Baf();return 32};Tc.prototype.Ntf=function(c,
k,D){if(1===D)return 32;switch(c){case eg.a.a0f:pg.a.lf(xe.a.sY(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case eg.a.$_f:pg.a.lf(xe.a.sY(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};Tc.prototype.Baf=function(){var c=void 0===c?null:c;var k=0;c&&(k=c);pg.a.lf(2===k?"https://go.microsoft.com/fwlink/?LinkId=331579":Tc.qfi,"_blank",void 0,"LaunchMacTrialWindow")};Ll.Object.defineProperties(Tc.prototype,{Hrc:{configurable:!0,enumerable:!0,get:function(){return this.Jeg&&
af.a.isMac&&!af.a.E4h&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Idj:{configurable:!0,enumerable:!0,get:function(){return this.Hrc}}});Ll.Object.defineProperties(Tc,{qfi:{configurable:!0,enumerable:!0,get:function(){return xe.a.lG("522401")}}});Object(te.a)(Tc,"MacOfficeOffer",null,[834]);id.prototype.Lg=function(){this.La.Xb(eg.a.tryOffice,ih.a.frame,Object(qe.a)(this,this.WAi,"onTryOffice"));this.La.Xb(eg.a.tryOfficeThroughTellMe,ih.a.frame,Object(qe.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));
this.La.Xb(eg.a.d0f,ih.a.frame,Object(qe.a)(this,this.e0f,"tryOfficeThroughViewer"));this.La.Xb(eg.a.c0f,ih.a.frame,Object(qe.a)(this,this.e0f,"tryOfficeThroughViewer"))};id.prototype.WAi=function(c,k,D,ba,Ba){if(this.vTb&&1===D)return this.isFreemiumUpsellEnabled&&this.jHb?32:8;2===D&&(Ba?(c=Ba.SourceControlId,"btnjTryOfficeForWordEditor"===c?pg.a.lf(xe.a.sY(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===c?pg.a.lf(xe.a.sY(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):
this.xec()):this.xec());return 32};id.prototype.tryOfficeThroughTellMe=function(c,k,D,ba,Ba){if(this.vTb&&1===D)return this.isFreemiumUpsellEnabled&&this.jHb?32:8;2===D&&(Ba?(c=Ba.SourceControlId,pg.a.lf(xe.a.lG("862405")+this.MEh(c),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):pg.a.lf(xe.a.lG("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};id.prototype.e0f=function(c,k,D){if(this.vTb&&1===D)return this.isFreemiumUpsellEnabled&&this.jHb?32:8;if(2===D)switch(c){case eg.a.d0f:pg.a.lf(xe.a.sY(14),
"_blank",void 0,"TryOfficeThroughViewer.Word");break;case eg.a.c0f:pg.a.lf(xe.a.sY(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};id.prototype.xec=function(c){c=void 0===c?null:c;var k=0;c&&(k=c);pg.a.lf(id.CCh(k),"_blank",void 0,"LaunchOfficeOffer")};id.prototype.MEh=function(c){var k=0;switch(c){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":k=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":k=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":k=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":k=
4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":k=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":k=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":k=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":k=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":k=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":k=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":k=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":k=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":k=
18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":k=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":k=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":k=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":k=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":k=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":k=29}return k?String.format("&pc={0:D}",k):""};id.CCh=function(c){if(af.a.ah)switch(c){case 1:return xe.a.lG("393806");case 2:return xe.a.lG("393810");
case 3:return xe.a.lG("393809");case 5:return xe.a.lG("393805")}else if(af.a.lp)switch(c){case 1:return xe.a.lG("521979");case 3:return xe.a.lG("521980");case 5:return xe.a.lG("521978");case 2:return xe.a.lG("522490")}else{if(2===c)return xe.a.lG("517778");if(1===c)return xe.a.sY(30)}return xe.a.lG("522402")};Ll.Object.defineProperties(id.prototype,{Tif:{configurable:!0,enumerable:!0,get:function(){return this.jHb}},ini:{configurable:!0,enumerable:!0,get:function(){return this.jHb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},
jHb:{configurable:!0,enumerable:!0,get:function(){return this.Neg&&!af.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,enumerable:!0,get:function(){var c=!1;this.qzc&&(c=this.qzc.isFreemiumUpsellEnabled());return c}}});Object(te.a)(id,"OfficeTrialExperience",null,[833]);yc.prototype.Qh=function(c){c.register(id,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").wc().Fc(function(){return new id(wd.AFrameworkApplication.Hb,wd.AFrameworkApplication.Zvb,wd.AFrameworkApplication.lcid)});
c.register(Tc,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").wc().Fc(function(){return new Tc(wd.AFrameworkApplication.Hb,wd.AFrameworkApplication.mcc,wd.AFrameworkApplication.lcid)})};Object(te.a)(yc,"OpenInClientConfiguration",null,[9]);var fj=b(1323),Ch=b(36),Ji=b(1221),lh=b(278);Ll.Object.defineProperties(pd,{tf:{configurable:!0,enumerable:!0,get:function(){return oa.a.$i(pd.Jj,CommonUIStrings.l_OICLaunchDialogTitle)}}});pd.Jj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(te.a)(pd,"OICLaunchDialogHtml",null,[]);var nj=oa.a;Em(Zc,nj);Zc.prototype.x6a=function(){this.JAa=Bd("BtnRichClient",this.Fp.hpb,this.Fp.qub,this.Fp.ved,CommonUIStrings.l_OICLaunchRichClient,Object(qe.a)(this,this.Brf,"onRichClientButtonClick"),Qe);document.getElementById("OICLaunchRichClient").appendChild(this.JAa);Ob(this.JAa);this.rSa=Bd("BtnReturn",this.Fp.hpb,this.Fp.qub,this.Fp.C0e,CommonUIStrings.l_OICReturnToOnlineClient,Object(qe.a)(this,this.yrf,"onReturnButtonClick"),Qe);document.getElementById("OICReturnToApp").appendChild(this.rSa);
Ob(this.rSa)};Zc.prototype.yrf=function(){this.hide();this.Fp.G9a();return!0};Zc.prototype.Brf=function(){nd.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();wd.AFrameworkApplication.Hb.processAction(eg.a.nOa,2);return!0};Zc.prototype.Ani=function(){this.Fp.G9a()};Zc.prototype.dispose=function(){this.Rna||(this.JAa&&(lh.a.instance.za(Sf.a.click,this.JAa,Object(qe.a)(this,this.Brf,"onRichClientButtonClick")),Oh.KeyInputManager.instance.za(Sf.a.Xd,this.JAa,Qe)),this.rSa&&
(lh.a.instance.za(Sf.a.click,this.rSa,Object(qe.a)(this,this.yrf,"onReturnButtonClick")),Oh.KeyInputManager.instance.za(Sf.a.Xd,this.rSa,Qe)),nj.prototype.dispose.call(this),this.Rna=!0)};Object(te.a)(Zc,"OICLaunchDialog",oa.a,[]);Ll.Object.defineProperties(Fc,{tf:{configurable:!0,enumerable:!0,get:function(){return oa.a.$i(Fc.Jj,CommonUIStrings.l_OICDialogTitle)}}});Fc.Jj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(te.a)(Fc,"ProtocolLaunchingDialogV2Html",null,[]);var Gi=oa.a;Em(ac,Gi);ac.prototype.x6a=function(){var c=document.getElementById("Issues");if(c){bf("",this.Fp.hpb,this.Fp.qub,this.Fp.ved,c);var k=document.createElement("span");k.className="WACDialogSectionTitle";k.innerText=5===this.Fp.vuf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;c.appendChild(k);Ob(c);c.style.display="none"}wd.AFrameworkApplication.xa.Xa.Ibd?(this.qSa=Bd("GiveFeedback",this.Fp.hpb,this.Fp.qub,
"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(qe.a)(this,this.jic,"onGiveFeedbackClick"),Object(qe.a)(this,this.Inf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.qSa),Ob(this.qSa)):document.getElementById("ButtonGiveFeedback").style.display="none";wd.AFrameworkApplication.xa.Xa.editMode&&!wd.AFrameworkApplication.a3g?(this.sda=Bd("Edit",this.Fp.hpb,this.Fp.qub,"",2===wd.AFrameworkApplication.xa.Xa.Tk?4===wd.AFrameworkApplication.xa.Xa.editMode?
CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===wd.AFrameworkApplication.xa.Xa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(qe.a)(this,this.pmf,"onEditClick"),Object(qe.a)(this,this.smf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.sda),Ob(this.sda)):document.getElementById("ButtonEdit").style.display="none";wd.AFrameworkApplication.xa.Xa.editMode||wd.AFrameworkApplication.Zvb||
!c||(c.style.display="none")};ac.prototype.QLe=function(){return this.yna?(this.Ny(this.yna),!0):!1};ac.prototype.OLe=function(){return this.sda?(this.Ny(this.sda),!0):!1};ac.prototype.smf=function(c){return this.Isd(c,0)};ac.prototype.Inf=function(c){return this.Isd(c,2)};ac.prototype.wrf=function(c){return this.Isd(c,1)};ac.prototype.Isd=function(c,k){var D=!1;if(c.Ea.keyCode===Zg.a.Ph||c.Ea.keyCode===Zg.a.Vza)c.Sb.click(),D=!0;else if(c.Ea.keyCode===Sys.UI.Key.down||c.Ea.keyCode===Sys.UI.Key.up)switch(k){case 1:D=
this.OLe();break;case 0:D=this.QLe()}return D};ac.prototype.pmf=function(){this.hide();4===wd.AFrameworkApplication.xa.Xa.editMode?(nd.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Fp.G9a()):(nd.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Fp.fcd());return!0};ac.prototype.jic=function(){nd.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Fp.NXe();return!0};ac.prototype.cjc=function(){nd.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");
document.getElementById("WACDialogPanel").style.display="none";wd.AFrameworkApplication.Hb.processAction(eg.a.nOa,2);return!0};ac.prototype.Hyd=function(){this.Fp.G9a()};ac.prototype.switchToBackupMode=function(){var c=document.getElementById("ProtocolLaunchingDialogTitle");if(c){c.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(c=document.getElementById("Issues"))c.style.display="block";(c=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!c.children.length&&(this.yna=Bd("RetryOIC","",
"","",CommonUIStrings.l_OICDialogRetry,Object(qe.a)(this,this.cjc,"onRetryOICClick"),Object(qe.a)(this,this.wrf,"onRetryOICKeyUp")),c.appendChild(this.yna),Ob(this.yna),this.sda||this.QLe())}};ac.prototype.dispose=function(){this.Rna||(this.sda&&(lh.a.instance.za(Sf.a.click,this.sda,Object(qe.a)(this,this.pmf,"onEditClick")),Oh.KeyInputManager.instance.za(Sf.a.Xd,this.sda,Object(qe.a)(this,this.smf,"onEditKeyUp"))),this.qSa&&(lh.a.instance.za(Sf.a.click,this.qSa,Object(qe.a)(this,this.jic,"onGiveFeedbackClick")),
Oh.KeyInputManager.instance.za(Sf.a.Xd,this.qSa,Object(qe.a)(this,this.Inf,"onGiveFeedbackKeyUp"))),this.yna&&(lh.a.instance.za(Sf.a.click,this.yna,Object(qe.a)(this,this.cjc,"onRetryOICClick")),Oh.KeyInputManager.instance.za(Sf.a.Xd,this.yna,Object(qe.a)(this,this.wrf,"onRetryOICKeyUp"))),Gi.prototype.dispose.call(this),this.Rna=!0)};Object(te.a)(ac,"ProtocolLaunchingDialog",oa.a,[]);var Oj=b(468),Wj=Td.StandardDialog;Em(bd,Wj);bd.prototype.jic=function(c){nd.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.Hmf(c)};bd.prototype.cjc=function(){nd.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");wd.AFrameworkApplication.Hb.processAction(eg.a.nOa,2)};bd.prototype.Hyd=function(c){bd.KYe?3===c?this.LIf():2!==c&&c?1===c&&this.pMg():this.continueEditing():2===c?this.LIf():1!==c&&c||this.continueEditing()};bd.prototype.pMg=function(){nd.ULS.sendTraceTag(577783557,211,50,"Closing the document");wd.AFrameworkApplication.Hb.Ge(eg.a.close,2,Oj.a)};bd.prototype.LIf=function(){nd.ULS.sendTraceTag(593602691,
211,50,"OIC dialog retry");window.setTimeout(Object(qe.a)(this,this.cjc,"onRetryOICClick"),0)};bd.prototype.continueEditing=function(){4===wd.AFrameworkApplication.xa.Xa.editMode||wd.AFrameworkApplication.ha.sa("WordConsumptionViewToEditRedirectIsEnabled")&&1===wd.AFrameworkApplication.xa.mode?(nd.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Fp.G9a()):(nd.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Fp.fcd())};Ll.Object.defineProperties(bd,
{KYe:{configurable:!0,enumerable:!0,get:function(){return wd.AFrameworkApplication.ha.sa("OICDialogThreeActions")&&32===wd.AFrameworkApplication.Hb.processAction(eg.a.close,1)}}});Object(te.a)(bd,"StandardProtocolLaunchingDialog",Td.StandardDialog,[]);Object(te.a)(Oe,"EditDocumentInClientParams",null,[]);ng.b2c=function(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd,Ge,df){Rb=void 0===Rb?!1:Rb;Ic=void 0===Ic?!1:Ic;Wc=void 0===Wc?"":Wc;Rd=void 0===Rd?!1:Rd;Ge=void 0===Ge?!1:Ge;df=void 0===df?!1:df;var Wf=new Oe;Wf.DocumentUrl=
c;Wf.Mode=k;Wf.Options=D;Wf.Application=ba;Wf.SilentExternalHandler=Rb;Wf.EncodeUrl=Ic;Wf.CorrelationIdForWinClient=Wc;Wf.NavigateUsingWindowOpen=Rd;Wf.DescriptiveUnattemptedEnums=Ge;Wf.NoBrowserModalDialogs=df;MSOJS.ClientUtils.EditDocumentInClient(Wf,Ba,nb)};Object(te.a)(ng,"ClientUtils",null,[]);var ag=b(945);me.prototype.x_i=function(c,k,D){return k.contextId!==ih.a.frame?2:1===D?32:this.nOa()};me.prototype.pnj=function(){return!(2===this.application&&wd.AFrameworkApplication.ha.sa("IsEmbeddedScenario"))};
me.prototype.closeApplication=function(){this.eNd||this.Xih()};me.prototype.G9a=function(){this.snj||this.kjh()};me.prototype.LBf=function(c){this.Wzj&&af.a.ah?new Zc(this):this.$Zb(c)};me.prototype.$Zb=function(c){c=this.g$h(c);var k=c.returnValue;nd.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===k,c.xza);return k};me.prototype.rEa=function(c,k,D,ba,Ba,nb){this.xSa=c;this.LYd=k;this.pea=nb;this.application=D;this.YA=ba;wd.AFrameworkApplication.downloadCopyOnOpenInClient?this.yaf():
wd.AFrameworkApplication.limitedEdit&&!wd.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?wd.AFrameworkApplication.PTf():this.dBg(Ba)};me.prototype.nOa=function(){return this.$Zb(this.sfb)};me.prototype.oMf=function(){var c=new ag.a(Ih.a.openInClient);c.Values["ui-language"]=wd.AFrameworkApplication.lcid.toString();c.Values[K.a.q_c]=wd.AFrameworkApplication.userSessionId;return this.pea.value.send(c)?32:8};me.prototype.Y4i=function(c){var k=new ag.a(Ih.a.hCj);k.Values["ui-language"]=
wd.AFrameworkApplication.lcid.toString();k.Values[K.a.q_c]=wd.AFrameworkApplication.userSessionId;k.Values[vg.a.gCj]=c;this.pea.value.send(k)};me.prototype.g$h=function(c){this.sfb=c;this.Y4i(5===this.YA?me.rCi:me.tCi);return 5===this.YA?this.f$h():this.k$h()};me.prototype.f$h=function(){this.Eaf();return{returnValue:32,xza:"HostEditUrl,"}};me.prototype.k$h=function(){var c,k=c="";wd.AFrameworkApplication.Cee&&(k="|f|"+wd.AFrameworkApplication.userSessionId);var D=wd.AFrameworkApplication.ha.sa("IsAssignmentMode")&&
wd.AFrameworkApplication.ha.sa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||wd.AFrameworkApplication.isUnifiedHostMode||af.a.nja,ba=wd.AFrameworkApplication.ha.sa("UnattemptedEnumIsEnabled"),Ba=wd.AFrameworkApplication.ha.sa("NoBrowserModalDialogs");if(wd.AFrameworkApplication.sxf){c+="NewOrder,";var nb=8;this.pea&&this.pea.value&&this.pea.value.isEnabled()&&wd.AFrameworkApplication.ERd&&(c+="Post,",nb=this.oMf());if(32===nb)return{returnValue:nb,xza:c};nd.ULS.sendTraceTag(4994821,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return wd.AFrameworkApplication.nl.b7a?(nd.ULS.shipAssertTag(5566816,211,!!wd.AFrameworkApplication.nl.b7a),c+="HostUrl,",{returnValue:wd.AFrameworkApplication.xa.M5a(wd.AFrameworkApplication.nl.b7a),xza:c}):this.xSa?(nd.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",wd.AFrameworkApplication.userSessionId),c+="DocUrl,",ng.b2c(this.xSa,this.YA,this.options,this.application,Object(qe.a)(this,this.rmf,
"onEditInClientSuccess"),Object(qe.a)(this,this.qmf,"onEditInClientFailure"),this.qUf,wd.AFrameworkApplication.ha.sa("OICEncodeUrlIsEnabled"),k,D,ba,Ba),{returnValue:32,xza:c}):{returnValue:8,xza:c}}c+="OldOrder,";if(!this.xSa&&wd.AFrameworkApplication.nl.b7a)return this.pea&&this.pea.value&&this.pea.value.isEnabled()&&wd.AFrameworkApplication.ERd?(c+="Post,",k=this.oMf()):(nd.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),k=8),32!==k?(nd.ULS.shipAssertTag(22595484,
211,!!wd.AFrameworkApplication.nl.b7a),c+="HostUrl,",{returnValue:wd.AFrameworkApplication.xa.M5a(wd.AFrameworkApplication.nl.b7a),xza:c}):{returnValue:k,xza:c};nd.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",wd.AFrameworkApplication.userSessionId);c+="DocUrl,";ng.b2c(this.xSa,this.YA,this.options,this.application,Object(qe.a)(this,this.rmf,"onEditInClientSuccess"),Object(qe.a)(this,this.qmf,"onEditInClientFailure"),this.qUf,wd.AFrameworkApplication.ha.sa("OICEncodeUrlIsEnabled"),
k,D,ba,Ba);return{returnValue:32,xza:c}};me.prototype.OGf=function(c){wd.AFrameworkApplication.Cm.setDw(8981,c)};me.prototype.rmf=function(c){this.OGf(c);nd.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===c&&MSOJS.ClientUtils.ShouldShowDialog()?this.mXf||this.Eaf():this.eNd||this.closeApplication()};me.prototype.qmf=function(c,k){k=void 0===k?0:k;nd.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",c,k);if(5===c)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);
else{var D=!!this.LYd&&!this.sfb,ba=0;1===c&&(ba=2);6<=c&&13>=c&&(ba=1,1===k&&(this.eNd=!0));this.ouc.ini?(nd.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",ba),Ji.a.instance.YVg(this.sfb?Object(qe.a)(this,this.jjf,"oicErrorDialogHandlerCloseForced"):Object(qe.a)(this,this.kjf,"oicErrorDialogHandlerNoCloseForced"),D?Object(qe.a)(this,this.Jof,"onLaunchDownload"):null,this.Bze(!1)?Object(qe.a)(this,this.BSh,"iHaveOfficeButtonHandler"):null,ba,k)):(nd.ULS.sendTraceTag(18715409,
211,50,"Open OICErrorDialog. Dialog cause: {0}",ba),Ji.a.instance.WVg(this.sfb?Object(qe.a)(this,this.jjf,"oicErrorDialogHandlerCloseForced"):Object(qe.a)(this,this.kjf,"oicErrorDialogHandlerNoCloseForced"),D?Object(qe.a)(this,this.Jof,"onLaunchDownload"):null,ba))}};me.prototype.Eaf=function(){wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.xa.Xa.qu&&wd.AFrameworkApplication.ha.sa("StandardProtocolDialogIsEnabled")?new bd(this):new ac(this)};me.prototype.jjf=function(){this.closeApplication()};
me.prototype.kjf=function(){this.G9a()};me.prototype.Jof=function(){this.yaf()};me.prototype.BSh=function(){return this.Bze(!0)};me.prototype.Bze=function(c){var k=(af.a.bM||af.a.IG)&&!!wd.AFrameworkApplication.b2b;k&&c&&(pg.a.lf(wd.AFrameworkApplication.b2b,"_blank",void 0,"OpenInClient"),this.closeApplication());return k};Ll.Object.defineProperties(me.prototype,{vuf:{configurable:!0,enumerable:!0,get:function(){return this.YA}},options:{configurable:!0,enumerable:!0,get:function(){var c=0;wd.AFrameworkApplication.IYi&&
(c|=1);wd.AFrameworkApplication.openInClientEditOnly&&(c|=4);this.pnj()&&(c|=64);return c}},hpb:{configurable:!0,enumerable:!0,get:function(){return wd.AFrameworkApplication.WB}},qub:{configurable:!0,enumerable:!0,get:function(){return wd.AFrameworkApplication.kub}},C0e:{configurable:!0,enumerable:!0,get:function(){return""}},ved:{configurable:!0,enumerable:!0,get:function(){return""}},mXf:{configurable:!0,enumerable:!0,get:function(){return wd.AFrameworkApplication.ha.sa("OneNoteMobileViewerIsEnabled")}},
ouc:{configurable:!0,enumerable:!0,get:function(){return this.E5d||(this.E5d=Hc.a.instance.resolve("Common.IOfficeTrialExperience"))}}});me.tCi="OpenInDesktop";me.rCi="OpenInBrowser";Object(te.a)(me,"AOpenInClientOperation",null,[]);var Lj=b(191),Kh=b(195),qi=b(126),th=b(43),Aj=b(42),ok=b(179),Mj=b(92),Xj=b(32),gj=b(472),bj=b(1165),yj=b(602);Em(Fe,me);Fe.prototype.vOg=function(){this.LBf(this.$Le)};Fe.prototype.fQg=function(){var c=this,k=this.$;ia.TaskExtensions.Aa(this.gJ.value,function(D){c.rEa(k.workbookContext.ClientUrl,
wd.AFrameworkApplication.A2,1,k.isEditMode?2:0,!0,new Kf.a(function(){return D.result}))},this.la,3)};Fe.prototype.fcd=function(){Yf.a.Df.editMode&&(this.$.zb.xJ=!1)};Fe.prototype.NXe=function(){var c={};c[Ac.a.m5c]=!1;c[Ac.a.lha]="OpenInExcel";this.$.De(802602464,Xd.a.Tb,8,c)};Fe.prototype.Hte=function(){var c=this;if(this.fa.lc){var k=this.$;k.isEditMode&&ia.TaskExtensions.Aa(this.gJ.value,function(D){c.rEa(k.workbookContext.ClientUrl,wd.AFrameworkApplication.A2,1,2,!1,new Kf.a(function(){return D.result}))},
this.la,3)}};Fe.prototype.Ite=function(){var c=this;this.fa.lc&&ia.TaskExtensions.Aa(this.gJ.value,function(k){c.rEa(c.$.workbookContext.ClientUrl,wd.AFrameworkApplication.A2,1,c.$.isEditMode?2:0,!1,new Kf.a(function(){return k.result}))},this.la,3)};Fe.prototype.openInExcelClient=function(){var c=this;this.fa.lc&&(this.$.isEditMode||ia.TaskExtensions.Aa(this.gJ.value,function(k){c.rEa(c.$.workbookContext.ClientUrl,wd.AFrameworkApplication.A2,1,0,!1,new Kf.a(function(){return k.result}))},this.la,
3))};Fe.prototype.openInBrowser=function(){var c=this;this.fa.lc&&ia.TaskExtensions.Aa(this.gJ.value,function(k){c.rEa(c.$.workbookContext.ClientUrl,wd.AFrameworkApplication.A2,1,5,!1,new Kf.a(function(){return k.result}))},this.la,3)};Fe.prototype.downloadFile=function(c){var k=this.Mme(c);this.R9.downloadFile(k,c)};Fe.prototype.ruf=function(c,k){k=void 0===k?0:k;if(this.fa.lc){var D=this.$;xi.a(D).PJa?this.suf(c,D):0<k?this.plj(c,D,k):this.ESf(D)}};Fe.prototype.rEa=function(c,k,D,ba,Ba,nb){this.$.zb.xJ=
!zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.ic.inWebPart;this.$Le=Ba;this.a_b=null;this.E1c=!1;this.iBg(c,k,ba,Ba,nb)};Fe.prototype.$Zb=function(c){var k=this.$.ic;nd.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",k.inEmbedView,k.inWebPart,k.isDivSyndicated,this.$.isEditMode?Lj.a.edit:Lj.a.view);return Fe.D6e()?(this.AZb(),ng.b2c(this.xSa,this.YA,this.options,1,Object(qe.a)(this,
this.tri,"onEditInClientSuccessForWebPart"),Object(qe.a)(this,this.sri,"onEditInClientFailureForWebPart"),!1,wd.AFrameworkApplication.ha.sa("OICEncodeUrlIsEnabled")),32):me.prototype.$Zb.call(this,c)};Fe.prototype.Xih=function(){this.PHf();var c=this.$;if(!this.fa.ic.inWebPart&&this.fa.lc&&!c.isEditMode){var k=new Mj.a(2145659238,Xd.a.Tb,this.$.dd,0,null);this.Ere=th.a.instance.create(function(){c.Ka.Ub(k)},0,Aj.a.uCi)}};Fe.prototype.dispose=function(){this.fa&&this.fa.qk(Object(qe.a)(this,this.Vc,
"onSessionIdChanged"));qj.a.mc([this.Oa,this.Ere,this.lm]);this.$=this.fa=null};Fe.prototype.kjh=function(){this.PHf()};Fe.prototype.yaf=function(){var c=this;th.a.instance.create(function(){c.$.Ka.Ub(new Mj.a(-2028960985,Xd.a.Tb,0,30,null))},0,Aj.a.vCi,!0,!0)};Fe.prototype.dBg=function(c){var k=this.$,D=xi.a(this.$).fd.activityState;D[gj.a.Sce]=!0;k.isEditMode&&this.fa.lc?(this.AZb(),Ae.a(k).zs(new $e.a(vf.a.ly,5,function(){k.mH(!1);D[Jh.a.rq]=vf.a.CZb;D[gj.a.vng]=c;D[Xg.a.g6c]=!0;k.isEditMode&&
(D[Xg.a.iS]=1,D[Xg.a.mX]=!0,D[bg.a.yUb]=!0,D[bg.a.nOc]=!0);D[gj.a.Vce]=1455037301}))):this.LBf(c)};Fe.prototype.nVf=function(){var c=wd.AFrameworkApplication.A2;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.M5a(c,!0)){var k=this.$.fa.ic;nd.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",c,k.inEmbedView,k.inWebPart,k.isDivSyndicated,this.$.isEditMode?Lj.a.edit:Lj.a.view)}}else this.R9.downloadFile(c,-2028960985);this.E1c=!0;this.AZb()};
Fe.prototype.C$h=function(){this.ouc.Tif&&this.ouc.xec(1)};Fe.prototype.D$h=function(){this.ouc.Tif&&gd.HelperMethods.lf(xe.a.sY(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};Fe.prototype.M$h=function(){gd.HelperMethods.lf(xe.a.sY(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};Fe.prototype.N$h=function(){gd.HelperMethods.lf(xe.a.sY(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};Fe.prototype.Mme=function(c){var k=new Sys.StringBuilder,
D=this.$.workbookContext,ba=this.$.ya;k.append(this.$.gca);k.append(ba.FileHandlerRelativeUri);k.append("?id=");k.append(encodeURIComponent(Kh.a.WDb(D.WorkbookUri,"sc")));this.$.fa.lc&&(k.append("&sessionId="),k.append(encodeURIComponent(this.$.fa.sessionId)));switch(c){case -974518828:k.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:k.append("&workbookType=FullWorkbook");break;case -1059172980:k.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:k.clear()}qi.a.dEa(k,
ba);return k.toString()};Fe.prototype.XOg=function(){fj.a.instance.rKg();var c=this.$.ya;MSOJS.ClientUtils.InitUrls(c.RoamingAppsX86RootUrl,c.RoamingAppsControlInstallerUrl,c.RoamingAppsFirefoxExtensionUrl)};Fe.prototype.Vc=function(){Xj.a.rg(xi.a(this.$).fd.activityState,Xg.a.ksd)||this.R9.reset()};Fe.prototype.PHf=function(){var c=this.$;this.fa.lc||ch.a.Lyd(c,xi.a(c).fd);this.AZb();this.a_b&&this.a_b(this,this.E1c);c.frame.Uy.Nl(this.$.frame.h$());c.frame.bW.Nl(this.$.frame.h$());c.zb.xJ=!1;$d.g(c).focus()};
Fe.prototype.iBg=function(c,k,D,ba,Ba){var nb=this.$;wd.AFrameworkApplication.xa&&!Fe.D6e()&&(nb.frame.Uy.Sm(nb.frame.h$()),nb.frame.bW.Sm(nb.frame.h$()));me.prototype.rEa.call(this,c,k,1,D,ba,Ba)};Fe.prototype.AZb=function(){var c=this.$;xi.a(c).gi.activityName===vf.a.openInExcelClient&&xi.a(c).fd.GI()};Fe.prototype.egj=function(){var c=Eb.a.gd(1,0,653,654,0,1341525452,"OpenInExcelActiveXError");Ae.a(this.$).Gs([c])};Fe.prototype.tri=function(c){this.OGf(c)};Fe.prototype.sri=function(){this.egj()};
Fe.prototype.plj=function(c,k,D){var ba=this,Ba=null,nb=window.setTimeout(function(){xi.a(k).Zmc(Ba);ba.ESf(k)},D);Ba=function(){xi.a(k).PJa&&(xi.a(k).Zmc(Ba),window.clearTimeout(nb),ba.suf(c,k))};xi.a(k).pPc(Ba)};Fe.prototype.ESf=function(c){var k=Eb.a.gd(1,1,0,668,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");Ae.a(c).Gs([k])};Fe.prototype.suf=function(c,k){var D=this;Ae.a(k).zs(new $e.a(vf.a.ly,5,function(){k.mH(!1);var ba=xi.a(k).fd,Ba=ba.activityState;Ba[Jh.a.rq]=vf.a.$Ae;Ba[xj.a.AUb]=
k.fa.ic.hasUnsupportedFeaturesForEdit;Ba[yj.a.hOc]=c;ba.Ss(Eb.a.N9(D.businessBar.k2c,[1437034227]))}))};Fe.D6e=function(){return 1<Yf.a.getRegisteredEwaInstances().length};Ll.Object.defineProperties(Fe.prototype,{C0e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.lm=this.lm||new ok.a;return this.lm.token}},ved:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},mXf:{configurable:!0,enumerable:!0,
get:function(){return this.fa.ic.inWebPart}}});Object(te.a)(Fe,"OpenInExcelOperation",me,[791,6]);var Yj=Me.a;Em(Pf,Yj);Pf.prototype.create=function(){var c=this;if(this.$.ea.Ba(55))this.Eb(this.$.ea.Ba(55));else{var k=Xf.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),D=Xf.GetServiceTaskFactory.Va(this.$.ea,5,4,this.rb,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");ia.TaskExtensions.Aa(Ie.Task.WAA(k,D),function(){c.Eb(new Fe(c.$,new Kf.a(function(){return Xf.GetServiceTaskFactory.create(c.$.ea,
137,c.la,c.rb,"Postmessage.IHostPostmessenger")}),D.result))},this.la,3)}};Pf.WOg=function(){Pf.mjf||(Pf.mjf=!0,(new yc).Qh(Hc.a.instance),Hc.a.instance.resolve("Common.IOfficeTrialExperience").Lg(),Hc.a.instance.resolve("Common.IMacOfficeOffer").Lg())};Pf.mjf=!1;Object(te.a)(Pf,"OpenInClientFactory",Me.a,[]);var cj=b(111),wi=b(384),wh=cj.a;Em(Zf,wh);Zf.prototype.execute=function(c){var k=Object(yh.a)(10,c.Ae);ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.create(k.ea,56,k.la,0,"Microsoft.Office.Excel.WebUI.Client.IOpenInExcelOperation"),
function(D){k.downloadCopyOnOpenInClient?(c.activityState[wi.a.Tce]=!0,D.result.nVf()):D.result.fQg()},k.la,3);return 1};Object(te.a)(Zf,"OpenInExcelClientActivity",cj.a,[]);var Nj=Me.a;Em(Ve,Nj);Ve.prototype.create=function(){var c=this;ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),function(){c.Eb(new Zf(vf.a.openInExcelClient,vf.a.idle))},this.la)};Object(te.a)(Ve,"OpenInExcelClientActivityFactory",Me.a,[]);var sd=Li.a;Em(se,sd);se.prototype.initialize=
function(c){sd.prototype.initialize.call(this,c)};se.prototype.execute=function(c){this.Sh=c;c=Object(yh.a)(10,this.Sh.Ae);this.job(c);return 1};se.prototype.SH=function(c){sd.prototype.SH.call(this,c)};se.prototype.job=function(){var c=this;this.subscribe(this.Sh,Object(qe.a)(this,this.XBb,"passwordProtectedFilePasswordInputDialogDisposing"),function(k){c.bwd.add_disposing(k)})};se.prototype.XBb=function(c){this.unsubscribe(function(k){c.remove_disposing(k)});this.Sh.activityState[gh.a.b1]=0};Object(te.a)(se,
"PasswordProtectedFileActivity",Li.a,[]);var td=b(517),ni=td.a;Em(Ad,ni);Ad.prototype.s8a=function(c){this.Pna=c};Ad.prototype.f2=function(){var c={};c[td.a.description]=Ff.a.instance.da(1891);c[td.a.Dka]=Ff.a.instance.da(1887);c[td.a.Kvf]=Ff.a.instance.da(1909);c[td.a.Ivf]=Ff.a.instance.da(1910);c[td.a.Jvf]=Ff.a.instance.da(1888);c[td.a.Ied]=Ff.a.instance.da(1894);c[td.a.Ike]=Ff.a.instance.da(1595);c[td.a.uBj]=Ff.a.instance.Ua(25);c[td.a.S4f]=Object(qe.a)(this,this.xRa,"verifySubmittedPassword");
return c};Ad.prototype.ora=function(){var c={};c[Bi.a.W1b]=this.sc;c[td.a.Nle]=this.f2();return c};Ad.prototype.Eh=function(){this.hc=1;this.initializeAndShow(this.Kn,Object(qe.a)(this,this.s8a,"reactPasswordDialogHandler"),this.ora())};Ll.Object.defineProperties(Ad.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},Yob:{configurable:!0,enumerable:!0,get:function(){return this.Pna}},Kn:{configurable:!0,enumerable:!0,get:function(){return Ff.a.instance.da(1890)}}});
Object(te.a)(Ad,"PasswordProtectedFilePasswordInputDialog",td.a,[]);var Ph=b(303);Em(ne,Ad);ne.prototype.s8a=function(c,k){Ad.prototype.s8a.call(this,c,k);nd.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",c)};ne.prototype.xRa=function(c,k){this.passwordToModify=c;var D={};D.FileModifyPassword=ae.a.ff(c);Af.mb(this.$.ra.ua,D,this.rBi(k),this.qBi(k),null,null)};ne.prototype.f2=function(){var c=Ad.prototype.f2.call(this);
c[td.a.Ied]=Ff.a.instance.da(1895);c[td.a.description]=Ff.a.instance.Ua(24);return c};ne.prototype.Eh=function(){jg.b().C2c("PasswordToModifyDialogShown");nd.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");Ad.prototype.Eh.call(this)};ne.prototype.rBi=function(c){var k=this;return function(D){Eb.a.Yg(D.Errors,[-2019873242])&&k.l2b(k.bob());if(!D||Ph.a(D))if(0<k.wEd)k.YAf(c);else{nd.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",
Eb.a.Uc(D.Errors));k.$.fa.Jo(D.Errors);k.hide();return}k.S1d=D.Result;k.Bcc&&(jg.b().mMd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),nd.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));c(k.Bcc?0:1)}};ne.prototype.qBi=function(c){var k=this;return function(){0<k.wEd?k.YAf(c):(nd.ULS.sendTraceTag(537154753,
0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),c(3))}};ne.prototype.YAf=function(c){--this.wEd;this.xRa(this.passwordToModify,c)};ne.prototype.bob=function(){return Eb.a.gd(1,0,1594,1595,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};ne.prototype.Lvf=function(){this.$.isEditMode&&this.Bcc&&(jg.b().C2c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.dl(Object(qe.a)(this,this.Lvf,"passwordToModifyWorkbookOpenedinEdit")))};
Ll.Object.defineProperties(ne.prototype,{Bcc:{configurable:!0,enumerable:!0,get:function(){return this.S1d}},Kn:{configurable:!0,enumerable:!0,get:function(){return Ff.a.instance.da(1892)}}});Object(te.a)(ne,"PasswordProtectedFileModifyPasswordInputDialog",Ad,[]);Em(ee,se);ee.prototype.job=function(c){this.bwd=new ne(c);se.prototype.job.call(this,c)};ee.prototype.XBb=function(c,k){var D=c.Yob,ba=c.Bcc,Ba=c.passwordToModify;se.prototype.XBb.call(this,c,k);this.Sh.Vva([2001366804]);switch(D){case 1:ba?
(k=Object(yh.a)(10,this.Sh.Ae),this.Sh.activityState[gh.a.ide]=ae.a.ff(Ba),this.Sh.activityState[gh.a.BVa]=!0,c.passwordToModify="",this.fh(k.isEditMode?vf.a.Sj:this.y1b)):nd.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.Go();break;case 0:this.Sh.activityState[gh.a.Wq]=!1;this.fh(this.SI);this.Go();break;default:nd.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",
D)}};Object(te.a)(ee,"PasswordProtectedFileModifyActivity",se,[]);var Gh=Me.a;Em(Wd,Gh);Wd.prototype.create=function(){this.Eb(new ee(this.activityName,this.kT,this.SI))};Wd.ja=function(c){c.ea.Ia(434,new Wd(vf.a.WBb,vf.a.tbb,vf.a.VEa,c))};Object(te.a)(Wd,"PasswordProtectedFileModifyActivityFactory",Me.a,[]);Em(ld,Ad);ld.prototype.xRa=function(c,k){this.password=c;k(0)};ld.prototype.f2=function(){var c=Ad.prototype.f2.call(this);this.F9e&&(c[td.a.K9g]=1);return c};ld.prototype.Eh=function(){nd.ULS.sendTraceTag(537154722,
0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.F9e);Ad.prototype.Eh.call(this);Ae.a(this.$).ahe()};Object(te.a)(ld,"PasswordProtectedFileOpenPasswordInputDialog",Ad,[]);var M=b(155),wa=b(132);Em(Rc,se);Rc.prototype.job=function(c){var k=Eb.a.Yg(this.Sh.errors,[1217361942]);this.bwd=new ld(c,k);c.Xac||c.vze();se.prototype.job.call(this,c)};Rc.prototype.XBb=function(c,k){var D=c.password;c.password="";var ba=c.Yob;se.prototype.XBb.call(this,
c,k);this.Sh.activityState[gh.a.rOc]=ae.a.ff(D);zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5700049_PasswordProtectedWorkbookEditMode")?this.Sh.activityState[gh.a.BVa]=!0:(this.Sh.activityState[gh.a.Wq]=!1,zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5288832_TrackPasswordProtectedFilesOpenAndEditModeSupport")&&ze.Health.instance.recordQosError(M.a.passwordProtectedWorkbook,[wa.a.unsupportedFeatures],!1,!1,!1,!0,null));this.Sh.Vva([110414285,1217361942]);nd.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",
ba);switch(ba){case 1:this.fh(this.y1b);this.Go();break;case 0:this.fh(this.SI),this.Go()}};Object(te.a)(Rc,"PasswordProtectedFileOpenActivity",se,[]);var Mb=Me.a;Em(hd,Mb);hd.prototype.create=function(){this.Eb(new Rc(this.activityName,this.kT,this.SI))};hd.ja=function(c){c.ea.Ia(386,new hd(vf.a.kkc,vf.a.Sj,vf.a.vk,c))};Object(te.a)(hd,"PasswordProtectedFileOpenActivityFactory",Me.a,[]);var sc=b(374),dd=sc.a;Em(xc,dd);xc.prototype.Is=function(c,k){this.Pna=c;dd.prototype.Is.call(this,c,k)};xc.prototype.Lq=
function(){dd.prototype.Lq.call(this);this.hc=9;var c=this.tCh();this.yc(1,Ff.a.instance.da(1593));this.yc(2,Ff.a.instance.da(941));this.ul(Ff.a.instance.da(674),Nf.a.yq(c),this.icon,Object(qe.a)(this,this.Is,"standardDialogHandler"))};xc.prototype.tCh=function(){return String.format(Ff.a.instance.da(675))};Ll.Object.defineProperties(xc.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},Yob:{configurable:!0,enumerable:!0,get:function(){return this.Pna}}});Object(te.a)(xc,
"LegacySharedWorkbookDialog",sc.a,[]);var Be=Li.a;Em(pc,Be);pc.prototype.initialize=function(c){Be.prototype.initialize.call(this,c)};pc.prototype.execute=function(c){this.Sh=c;this.yTg();return 1};pc.prototype.SH=function(c){Be.prototype.SH.call(this,c)};pc.prototype.yTg=function(){var c=Object(yh.a)(10,this.Sh.Ae),k=Eb.a.nXa([-573864504]);k[0].HelpDescription=Ff.a.instance.da(677);k[0].HelpTopicId=xg.a.kai;var D=new xc(c,k[0]);this.subscribe(this.Sh,Object(qe.a)(this,this.jai,"legacySharedDialogDisposing"),
function(ba){D.add_disposing(ba)})};pc.prototype.jai=function(c){var k=this.Pr.fd,D=Object(yh.a)(10,k.Ae);var ba=c.Yob;this.unsubscribe(function(Rb){c.remove_disposing(Rb)});for(var Ba=0,nb=k.errors.length;Ba<nb;Ba++)-573864504===k.errors[Ba].MessageId&&k.Jja(k.errors[Ba]);switch(ba){case 1:D.fa.fvc=!0;nd.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.fh(D.isEditMode?vf.a.wJb:this.y1b);
this.Go();break;case 2:this.fh(vf.a.openInExcelClient);this.Go();break;case 0:k.activityState[gh.a.Wq]=!1,this.fh(this.SI),this.Go()}};Object(te.a)(pc,"LegacySharedWorkbookActivity",Li.a,[]);var jf=Me.a;Em(ub,jf);ub.prototype.create=function(){this.Eb(new pc(this.activityName,this.kT,this.SI))};ub.ja=function(c){c.ea.Ia(460,new ub(vf.a.Ixb,vf.a.tbb,vf.a.VEa,c))};Object(te.a)(ub,"LegacySharedWorkbookActivityFactory",Me.a,[]);dc.prototype.Wc=function(){return!1};dc.prototype.Ec=function(c,k){if(!zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",
!1))return!1;switch(k.command){case 642419866:return!0;case 588342182:return this.presentModeManager.vy;default:return!1}};dc.prototype.executeCommand=function(c,k){c=ia.TaskExtensions.dm();k=k.command;switch(k){case 642419866:this.presentModeManager.qsc(!this.presentModeManager.vy);this.presentModeManager.eh("TogglePresentMode");break;case 588342182:this.presentModeManager.f4a=!this.presentModeManager.f4a;this.presentModeManager.CTf(this.presentModeManager.f4a,"TogglePresentModeOverlay");this.presentModeManager.eh("TogglePresentModeOverlay");
break;default:c=u.a(k)}return c};dc.prototype.Yc=function(){return!1};Object(te.a)(dc,"PresentModeCommandHandler",null,[160]);var gf=Tf.a;Em(ce,gf);ce.prototype.Gd=function(){var c=this;ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.Va(this.$.ea,423,424,this.rb,"Microsoft.Office.Excel.WebUI.Client.PresentMode.IPresentModeManager"),function(k){c.Ad([new dc(c.$,k.result)])},this.la,3)};ce.ja=function(c){Tf.a.Yd(420,new ce(c))};Object(te.a)(ce,"PresentModeCommandHandlerFactory",Tf.a,[]);var Jf=b(135),
Gf=b(110);kd.ldh="ewa-presentMode-overlay";kd.mdh="ewa-presentMode-panel-container";kd.ndh="ewa-presentMode-rowHdrParent-container";Object(te.a)(kd,"CssClassNames",null,[]);var eh=b(18),ug=b(142),xh=b(285),Qh=b(125),Vi=b(119),oi=b(427),Yg=b(11),rj=b(95),ah=b(335),Qi=b(127),sj=b(407),Ci=b(257),tj=b(245),oj=b(175);Ta.prototype.dispose=function(){this.$=this.Cxd=this.Dxd=this.nba=this.kNa=null};Ta.prototype.LVh=function(){var c=this;window.requestAnimationFrame(function(){c.nba=document.createElement("div");
c.$.Zx.insertBefore(c.nba,c.$.Zx.lastChild);c.nba.id=c.$.Jb+Ac.a.F5b;c.nba.classList.add(kd.mdh);c.Dxd=document.getElementById(c.$.Jb+Ac.a.Z_c);c.Cxd=[c.$.Fz];c.isInitialized=!0});this.kNa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.kNa.initializePresentModeFloatie()};Ta.prototype.sJh=function(){var c={};c.PollingCountPerCaller=Gf.a.toJSON(this.Hkc);c.PollingDurationPerCaller=Gf.a.toJSON(this.Ikc);return c};Ta.prototype.MKd=function(c){this.isInitialized?
c?(this.kNa.showPresentModeFloatie(this.nba,this.Dxd,this.Cxd),this.eh("ShowOrHideFloatiePanel"),this.EQi()):(this.kNa.hidePresentModeFloatie(),this.avj()):nd.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};Ta.prototype.eh=function(c){this.Jwf=gd.HelperMethods.Ac();this.fNa=c;this.lke=oj.AsyncMethodContext.Hw(Object(qe.a)(this,this.xl,"pollForStateAndUpdateInternal"),100,Aj.a.wIi+c,this.lke)};Ta.prototype.Le=function(c,k){if(k)return!1;
c=Yg.DOMElementExtensions.ql(this.nba.querySelectorAll(Yg.DOMElementExtensions.gp));if(!c)return nd.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;c.focus();return!0};Ta.prototype.rh=function(c){return Yg.DOMElementExtensions.Ue(this.Ib,c)};Ta.prototype.Uh=function(){};Ta.prototype.Nh=function(){};Ta.prototype.onKeyDown=function(c){c=c.Ea;if(9===c.keyCode){var k=this.nba.querySelectorAll(Yg.DOMElementExtensions.gp),
D=Yg.DOMElementExtensions.ql(k);k=Yg.DOMElementExtensions.ny(k);Yg.DOMElementExtensions.ica(c,D,k);return!0}return!1};Ta.prototype.EQi=function(){var c=this;Ci.a(this.$).Og(this);this.$.ea.$a(15,function(k){c.ewaAccessibilityManager=k;c.ewaAccessibilityManager.mode=5});Oh.KeyInputManager.instance.pa(Sf.a.Qb,this.Ib,Object(qe.a)(this,this.onKeyDown,"onKeyDown"))};Ta.prototype.avj=function(){Ci.a(this.$).sA(this);$d.g(this.$).n_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);
Oh.KeyInputManager.instance.za(Sf.a.Qb,this.Ib,Object(qe.a)(this,this.onKeyDown,"onKeyDown"))};Ta.prototype.xl=function(){var c=this,k=[];this.$.ea.$a(337,function(D){c.kNa.getPresentModeFloatieControlsMap().then(function(ba){for(var Ba={},nb=0;nb<ba.length;nb++)Ba[ba[nb].controlId]=ba[nb].modelType;k.push.apply(k,D.sba.o1a(Ba));0<k.length&&appChrome.api.dispatch(k);c.G1i()})})};Ta.prototype.G1i=function(){var c=gd.HelperMethods.Ac()-this.Jwf,k=this.Ikc[this.fNa]?this.Ikc[this.fNa]:0;this.Ikc[this.fNa]=
k>c?k:c;this.Hkc[this.fNa]=this.Hkc[this.fNa]?this.Hkc[this.fNa]+1:1};Ll.Object.defineProperties(Ta.prototype,{Ib:{configurable:!0,enumerable:!0,get:function(){return this.nba}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.kNa.updatePresentModeFloatieShyState(2);return!!this.nba}},Vd:{configurable:!0,enumerable:!0,get:function(){return tj.a.Qxf}}});Object(te.a)(Ta,"PresentModeFloatieManager",null,[799,120,6]);var Pj=b(59);Object(te.a)(Ib,"OverlayCavityInfo",null,[]);Object(te.a)(fc,
"OverlayContainerInfo",null,[]);Object(te.a)(Da,"PresentModeOverlayProps",null,[]);lf.prototype.tWh=function(){var c=this;this.Exd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){c.xXa=Array(5);for(var k,D,ba=1;4>=ba;ba++)k=document.createElement("div"),Yg.DOMElementExtensions.setVisible(k,!1),k.id=String.format("{0}-{1}","PresentModeOverlay",ba),Yg.DOMElementExtensions.toggleCssClass(k,kd.ldh,!0),D=c.gridView.Mf(ba).domElement,
D.insertBefore(k,D.firstChild),c.xXa[ba]=k})};lf.prototype.BTf=function(c){c&&this.myj();for(var k=1;4>=k;k++)this.W6e(k)&&Yg.DOMElementExtensions.setVisible(this.xXa[k],c);Yg.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-overlay",c)};lf.prototype.myj=function(){for(var c=this.SGg(),k,D=1;4>=D;D++)k=D,c[k]&&this.Exd.showOverlayWithCavity(this.xXa[k],c[k])};lf.prototype.dispose=function(){this.Exd=this.xXa=this.gridView=this.$=null};lf.prototype.SGg=function(){for(var c,k,D=$d.g(this.$).rtl,
ba,Ba=Array(5),nb=1;4>=nb;nb++)k=nb,this.W6e(nb)&&(c=this.gridView.Mf(nb),ba=this.gridView.ga.Pa.R$?this.aAh(nb,c,D):this.SAh(nb,c,D),c=this.hWg(c),Ba[k]=this.AWg(this.xXa[k].id,c,ba));return Ba};lf.prototype.W6e=function(c){return this.gridView.Wa.nJ(c)};lf.prototype.hWg=function(c){return Object.assign(new fc,{width:c.Wm.width,height:c.Wm.height})};lf.prototype.AWg=function(c,k,D){return Object.assign(new Da,{containerId:c,overlayContainerInfo:k,overlayCavityInfos:D?[D]:null})};lf.prototype.aAh=
function(c,k,D){var ba=$d.g(this.$).ga.Pa.kc;if(!ba)return nd.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var Ba=ba.extension.dAh(c);c=Ba.bAa;ba=Ba.rotation;var nb=Ba.translateX;var Rb=Ba.translateY;return Ba.returnValue?(Ba=c.x-k.Wm.x,Object.assign(new Ib,{left:(D?k.Wm.width-(Ba+c.width):Ba)-3+1,top:c.y-k.Wm.y-3+1,width:c.width+5,height:c.height+5,angle:ba,translateX:nb,translateY:Rb})):null};lf.prototype.SAh=
function(c,k,D){c=this.gridView.Kb.Frb(this.gridView.ga.wa.activeRange,c)||Pj.a.L2;if(!c.Ef(k.Wm))return null;var ba=c.x-k.Wm.x;return Object.assign(new Ib,{left:D?k.Wm.width-(ba+c.width)-2:ba-3,top:c.y-k.Wm.y-3,width:c.width+5,height:c.height+5})};Object(te.a)(lf,"PresentModeOverlayRenderer",null,[798,6]);var Kj=td.a;Em(Ee,Kj);Ee.prototype.hide=function(){Kj.prototype.hide.call(this);Jf.a.Uv(Ac.a.GTf,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Ee.prototype.xIi=function(){this.oba.MKd(!0)};
Ll.Object.defineProperties(Ee.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(te.a)(Ee,"PresentModeWelcomeDialog",td.a,[]);fe.requestFullscreen=function(c){c.webkitRequestFullscreen?c.webkitRequestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.requestFullscreen?c.requestFullscreen():nd.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};fe.exitFullscreen=
function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():nd.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};Ll.Object.defineProperties(fe,{hqh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":
document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},iqh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},k2h:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||
!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(te.a)(fe,"FullscreenUtils",null,[]);Vc.prototype.qsc=function(c){var k=this;this.vy!==c&&(this.U1d=c,this.f4a=this.vy,this.O2e(),this.rHb=this.qSf(),window.requestAnimationFrame(function(){Yg.DOMElementExtensions.toggleCssClass(k.$.Yq,"ewr-presentMode-transition",!0);$addHandler(k.m_a,"transitionend",k.Dma);k.mhj(!c);k.xDi();Yg.DOMElementExtensions.toggleCssClass(k.$.Yq,"ewr-presentMode-on",c);
k.lhj(c);ug.b(k.$).zTf(k.vy);ug.c(k.$).zTf(k.vy);k.$.gla();k.mNa.BTf(k.rHb);if(k.vy){k.JWa();Jf.a.get(Ac.a.GTf)?k.oba.MKd(k.vy):k.clc=new Ee(k.$,k.oba);var D=sj.b(k.$);D&&(k.EEd=D.t2c(!1));k.Pxf=gd.HelperMethods.Ac()}else k.oba.MKd(c),k.EEd&&(D=sj.b(k.$))&&(D.t2c(!0),k.EEd=!1),k.P1b(),k.Hdi()}))};Vc.prototype.CTf=function(c,k){this.RKd=c;this.Rca(k)};Vc.prototype.eh=function(c){this.oba.eh(c)};Vc.prototype.dispose=function(){this.P1b();this.mNa&&(this.mNa.dispose(),this.mNa=null);this.gridView=this.$=
null};Vc.prototype.mhj=function(c){var k=this.$.ea.Ba(25);void 0===k||null===k?nd.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):c?k.ksc():k.h$b()};Vc.prototype.xDi=function(){var c=this;Yg.DOMElementExtensions.toggleCssClass(document.getElementById(wd.AFrameworkApplication.v_a),eh.a.gu,this.vy);Yg.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on",this.vy);this.phj(this.vy);this.gridView.Ohd=!this.vy;this.Cyj();this.$.ea.$a(32,function(k){k.Wyj(c.vy)});
Vi.b(this.$,function(k){k.w2f(c.vy)})};Vc.prototype.phj=function(c){if(this.CCb)if(c){if(c=Object(yh.a)(rj.a,this.$.qa))Yg.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-headers-off",!c.headersVisible),Yg.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-rtl",$d.g(this.$).rtl);this.Nvc(0)}else this.$.Yq.classList.remove("ewr-presentMode-on-headers-off"),this.$.Yq.classList.remove("ewr-presentMode-on-rtl"),this.Nvc(1)};Vc.prototype.Nvc=function(c){var k=Object(yh.a)(rj.a,
this.$.qa);if(k){var D=parseInt(this.$.Zx.style.right);if(1===c||2===c){if(isNaN(D)||D<this.ZYa)return;D-=this.ZYa}c&&2!==c||(c=k.headersVisible,k=$d.g(this.$).rtl,c=c?k?0:32:12,D=isNaN(D)?c:D+c,this.ZYa=c);this.$.Zx.style.right=gd.HelperMethods.Pb(D);this.Ate=D}};Vc.prototype.Cyj=function(){var c=document.getElementById(this.$.Jb+Ac.a.q1b).parentNode;Yg.DOMElementExtensions.toggleCssClass(c,kd.ndh,this.vy)};Vc.prototype.XSi=function(){Yg.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-transition",
!1);$removeHandler(this.m_a,"transitionend",this.Dma)};Vc.prototype.initialize=function(c){this.mNa=new lf(c);this.mNa.tWh();this.oba=new Ta(c);this.oba.LVh();this.m_a=document.getElementById("MainApp");this.BMe=Object(qe.a)(this,this.rsi,"onFullScreenChangeEventHandler");$addHandler(this.m_a,fe.hqh,this.BMe);c=Object(qe.a)(this,this.ssi,"onFullScreenErrorEventHandler");$addHandler(this.m_a,fe.iqh,c);this.CCb||(this.CCb=document.createElement("div"),this.CCb.className="ewa-presentMode-right-frame",
this.$.Fz.appendChild(this.CCb));this.Dma=Object(qe.a)(this,this.XSi,"removeTransitionCss")};Vc.prototype.JWa=function(){this.gridView.ga.p8(Object(qe.a)(this,this.hq,"onSelectionStarted"));this.gridView.ga.n1(Object(qe.a)(this,this.Bh,"onSelectionEnded"));this.gridView.uc.Jm(Object(qe.a)(this,this.Rj,"onEditStarted"));this.gridView.uc.Xr(Object(qe.a)(this,this.pj,"onEditEnded"));this.gridView.iD(Object(qe.a)(this,this.Ho,"onCurrentSelectionModeChanged"));this.gridView.view.Us(Object(qe.a)(this,this.Mv,
"onVisibleAreaChanged"));this.gridView.hkb(Object(qe.a)(this,this.OU,"onBeforeActiveItemCleanup"));this.gridView.Ca.DF(Object(qe.a)(this,this.Vl,"onBlockCacheItemEvicted"));this.gridView.Ca.Pp(Object(qe.a)(this,this.Be,"onBlockCacheItemChanged"));this.$.va.Pf(Object(qe.a)(this,this.Ai,"onActiveSheetChanged"));this.$.va.QVa(Object(qe.a)(this,this.Naa,"onActiveItemPanesChanged"));this.$.va.pfa(Object(qe.a)(this,this.aBb,"onSheetInserted"));this.$.hD(Object(qe.a)(this,this.fk,"onContentAreaResized"));
this.$.Jk(Object(qe.a)(this,this.jd,"onWorkbookOpened"));var c=Object(yh.a)(ah.a,this.$.va);c=Ol(c.items);for(var k=c.next();!k.done;k=c.next())k.value.Ckb(Object(qe.a)(this,this.Nwa,"onSheetOptionsChanged"))};Vc.prototype.P1b=function(){this.gridView&&(this.gridView.ga.Oba(Object(qe.a)(this,this.hq,"onSelectionStarted")),this.gridView.ga.WZ(Object(qe.a)(this,this.Bh,"onSelectionEnded")),this.gridView.uc.ym(Object(qe.a)(this,this.Rj,"onEditStarted")),this.gridView.uc.Fr(Object(qe.a)(this,this.pj,
"onEditEnded")),this.gridView.AE(Object(qe.a)(this,this.Ho,"onCurrentSelectionModeChanged")),this.gridView.view.Gr(Object(qe.a)(this,this.Mv,"onVisibleAreaChanged")),this.gridView.ZDb(Object(qe.a)(this,this.OU,"onBeforeActiveItemCleanup")),this.gridView.Ca.nH(Object(qe.a)(this,this.Vl,"onBlockCacheItemEvicted")),this.gridView.Ca.Ko(Object(qe.a)(this,this.Be,"onBlockCacheItemChanged")));if(this.$){this.$.va.zg(Object(qe.a)(this,this.Ai,"onActiveSheetChanged"));this.$.va.S8a(Object(qe.a)(this,this.Naa,
"onActiveItemPanesChanged"));this.$.va.Yka(Object(qe.a)(this,this.aBb,"onSheetInserted"));this.$.oH(Object(qe.a)(this,this.fk,"onContentAreaResized"));this.$.dl(Object(qe.a)(this,this.jd,"onWorkbookOpened"));var c=Object(yh.a)(ah.a,this.$.va);c=Ol(c.items);for(var k=c.next();!k.done;k=c.next())k.value.GCd(Object(qe.a)(this,this.Nwa,"onSheetOptionsChanged"))}};Vc.prototype.fk=function(){var c=this;parseInt(this.$.Zx.style.right)!==this.Ate&&window.requestAnimationFrame(function(){c.Nvc(0);c.$.wxa(xh.a.uY("PresentModeManager.OnContentAreaResized"))})};
Vc.prototype.Nwa=function(){var c=this,k=Object(yh.a)(rj.a,this.$.qa);if(k&&this.vy){this.gridView.Ohd=!1;k=k.headersVisible;var D=$d.g(this.$).rtl;Yg.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-headers-off",!k);Yg.DOMElementExtensions.toggleCssClass(this.$.Yq,"ewr-presentMode-on-rtl",D);(12!==this.ZYa&&!k||32!==this.ZYa&&k&&!D||0!==this.ZYa&&k&&D)&&window.requestAnimationFrame(function(){c.Nvc(2)})}};Vc.prototype.jd=function(){this.O2e();this.eh("OnWorkbookOpened");nd.ULS.sendTraceTag(537154323,
0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};Vc.prototype.hq=function(){this.Qjd=!0;this.Rca("OnSelectionStarted")};Vc.prototype.Bh=function(){this.Qjd=!1;this.Rca("OnSelectionEnded");this.sKf()};Vc.prototype.Rj=function(){this.Rca("OnEditStarted")};Vc.prototype.pj=function(){this.Rca("OnEditEnded")};Vc.prototype.Mv=function(){if(!this.Lua){var c=zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Rca("OnVisibleAreaChanged",
!0,c)}};Vc.prototype.OU=function(){this.Lua=!0};Vc.prototype.Ho=function(){this.Rca("OnCurrentSelectionModeChanged");this.sKf();this.eh("OnCurrentSelectionModeChanged")};Vc.prototype.Vl=function(){this.Rca("OnBlockCacheItemEvicted")};Vc.prototype.Be=function(){this.Rca("OnBlockCacheItemChanged")};Vc.prototype.Naa=function(){this.Lua||this.Rca("OnActiveItemPanesChanged")};Vc.prototype.Ai=function(){this.Lua=!1;this.oba.eh("ActiveSheetChanged");this.Nwa()};Vc.prototype.aBb=function(c,k){if(c=Object(yh.a)(rj.a,
k.item))c.Jmb(16,!0),c.Ckb(Object(qe.a)(this,this.Nwa,"onSheetOptionsChanged"))};Vc.prototype.qSf=function(){if(!this.vy||!this.f4a)return!1;if(1===this.gridView.ga.Qe){var c=this.$.qa.activeRange.isSingle,k=1===this.$.qa.selectedRanges.length&&!c,D=this.gridView.isEditing,ba=this.Qjd;k||nd.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",c);return this.RKd&&k&&!D&&!ba}return this.RKd};Vc.prototype.lhj=
function(c){c?fe.requestFullscreen(this.m_a):fe.exitFullscreen()};Vc.prototype.rsi=function(){fe.k2h||(this.clc&&this.clc.us&&this.clc.hide(),$d.g(this.$).isEditing&&$d.g(this.$).lq(!0),this.qsc(!1),nd.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};Vc.prototype.ssi=function(){nd.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};Vc.prototype.Rca=function(c,k,
D){var ba=this;D=void 0===D?!1:D;void 0!==k&&k||(this.rHb=this.qSf());nd.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",c,this.rHb,D);if(this.bKb&&D)nd.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.aKb),window.cancelAnimationFrame(this.aKb),this.aKb=0;else if(this.bKb){nd.ULS.sendTraceTag(543023558,0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",
c);return}D?this.QQd(gd.HelperMethods.Ac(),c):(this.aKb=window.requestAnimationFrame(function(Ba){ba.QQd(Ba,c)}),this.bKb=!0)};Vc.prototype.QQd=function(c,k){var D=this,ba=gd.HelperMethods.Ac();if(ba-c>this.q2i)this.aKb=window.requestAnimationFrame(function(nb){D.QQd(nb,k)}),this.bKb=!1,nd.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",ba-c);else{this.mNa.BTf(this.rHb);this.bKb=!1;var Ba=gd.HelperMethods.Ac();c=gd.HelperMethods.Ac()-
c;ba=Ba-ba;this.t1i(c,k);nd.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",ba,c)}};Vc.prototype.O2e=function(){var c=this;rf.a(this.$.userOperationManager,function(k,D,ba){var Ba=c.$.ra.ua,nb=c.vy,Rb=Ba.Na(41,null);Rb.shouldEnablePresentMode=nb;return Af.i(Ba,"SetPresentMode",Rb,k,D,ba,null,0)},function(k){return new Ne.a(252,0,k)},null)};Vc.prototype.sKf=function(){var c=oi.a(this.gridView.Qe);1!==this.gridView.Qe||
this.$.qa.activeRange.isSingle||(c="Range");this.xpc[c]=this.xpc[c]?this.xpc[c]+1:1};Vc.prototype.t1i=function(c,k){var D=this.Vjc[k]?this.Vjc[k]:0;this.Vjc[k]=D>c?D:c;this.Ujc[k]=this.Ujc[k]?this.Ujc[k]+1:1};Vc.prototype.Hdi=function(){var c={},k=gd.HelperMethods.Ac()-this.Pxf;c.PresentModeDuration=k;c.SelectionCountPerObject=Gf.a.toJSON(this.xpc);c.OverlayCountPerCaller=Gf.a.toJSON(this.Ujc);c.OverlayDurationPerCaller=Gf.a.toJSON(this.Vjc);k=this.oba.sJh();for(var D in k)c[D]=k[D];Qi.b(this.$).ee(Qh.a.vIi,
c,void 0,!0)};Ll.Object.defineProperties(Vc.prototype,{vy:{configurable:!0,enumerable:!0,get:function(){return this.U1d}}});Object(te.a)(Vc,"PresentModeManager",null,[776,6]);var Yi=b(332),di=Me.a;Em(Nd,di);Nd.prototype.create=function(){var c=this,k=Xf.GetServiceTaskFactory.Va(this.$.ea,283,284,1,"Common.IDynamicScriptLoaderProvider");ia.TaskExtensions.Aa(k,function(){ia.TaskExtensions.Aa(Yi.c(k.result.Cp.loadScript("presentMode")),function(){var D=c.$.ea.Ba(423);D||(D=new Vc(c.$),c.$.ea.Ia(423,
D));c.Eb(D)},c.$.la,3)},this.$.la,3)};Nd.ja=function(c){c.ea.Ia(424,new Nd(c))};Object(te.a)(Nd,"PresentModeManagerFactory",Me.a,[]);var Qj=b(167),bk=b(156),Nk=b(664),wk=b(82),vj=b(29);He.Adh="ewa-resizehdr-row-hidden";He.zdh="ewa-resizehdr-col-hidden";Object(te.a)(He,"CssClassNames",null,[]);var xk=b(62),Bj=b(25),Cj=b(141),yk=b(52),Ri=b(68),Zi=b(247),ck=b(366);Object(te.a)(Vd,"HeaderEventCachedInfo",null,[]);Id.prototype.Zte=function(c){return Math.max(0,Math.min(Id.qff,gd.HelperMethods.Dwd(c)))};
Id.prototype.Qte=function(c){return this.WFi(c)};Id.prototype.XMg=function(c){return Math.round(this.Q1c*c+2*this.$Pe()+1)};Id.prototype.WFi=function(c){return Math.max(0,Math.min(Id.Yef,(Math.max(0,Math.min(oe.a.Rfc,c))-2*this.$Pe()-1)/this.Q1c))};Id.prototype.$Pe=function(){return Math.floor(Math.max((this.Q1c+3)/4,2))};Id.prototype.d8b=function(c,k){return k?c?Id.qff:oe.a.mpd:c?Id.Yef:oe.a.Rfc};Id.qff=409;Id.Yef=255;Object(te.a)(Id,"ResizeHeadersConverter",null,[]);var Hi=b(34),pk=wk.a;Em(rd,pk);
rd.prototype.dispose=function(){this.VVc();this.grid.ga&&(this.grid.ga.Nba(Object(qe.a)(this,this.Bh,"onSelectionEnded")),this.grid.ga.Oba(Object(qe.a)(this,this.hq,"onSelectionStarted")));this.grid.Cs(Object(qe.a)(this,this.Bh,"onSelectionEnded"));Ae.a(this.grid.$)&&Ae.a(this.grid.$).pg.Zka(Object(qe.a)(this,this.qE,"onPartialInteractivityStatusChanged"));lh.a.instance.za(Sf.a.zj,this.domElement,Object(qe.a)(this,this.Paa,"onDblClick"));Qj.a.instance.za(Sf.a.Ud,this.domElement.ownerDocument.body,
Object(qe.a)(this,this.Yhc,"onDocumentMouseUp"));bk.a.instance.za(Sf.a.ye,this.domElement.ownerDocument.body,Object(qe.a)(this,this.Yhc,"onDocumentMouseUp"));af.a.tr||(Qj.a.instance.za(Sf.a.pointerDown,this.domElement,Object(qe.a)(this,this.CM,"onMouseDown")),Qj.a.instance.za(Sf.a.Ch,this.domElement,Object(qe.a)(this,this.qQ,"onMouseMove")));this.B9a&&(Qj.a.instance.za(Sf.a.Ch,this.domElement.ownerDocument.body,Object(qe.a)(this,this.vwa,"onDocumentMouseMove")),bk.a.instance.za(Sf.a.Gg,this.domElement.ownerDocument.body,
Object(qe.a)(this,this.vwa,"onDocumentMouseMove")),this.B9a=!1);this.cF&&(Qj.a.instance.za(Sf.a.pointerDown,this.cF,Object(qe.a)(this,this.CM,"onMouseDown")),lh.a.instance.za(Sf.a.zj,this.cF,Object(qe.a)(this,this.Paa,"onDblClick")),this.VVc(),this.cF=null);this.pIf&&(Yg.DOMElementExtensions.ig(rd.E9a),rd.E9a=null);this.jg=null;pk.prototype.dispose.call(this)};rd.prototype.r9g=function(){if(!rd.E9a){document.getElementById(rd.oIf);this.pIf=!0;var c=rd.E9a=document.createElement("div");this.grid.$.frame.h$().appendChild(c);
c.id=rd.oIf;c.className=vj.a.Bdh;Yg.DOMElementExtensions.setVisible(c,!1)}};rd.prototype.CM=function(c){c=Hi.a(this.grid.$).He(c);if(3===c.yb&&!this.j9e(c.Ea)||!this.Cxf(c,!1))return!1;nd.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var k=this.XKd();this.tNe(c,k,!0);this.B9a||(Qj.a.instance.pa(Sf.a.Ch,this.domElement.ownerDocument.body,Object(qe.a)(this,this.vwa,"onDocumentMouseMove")),bk.a.instance.pa(Sf.a.Gg,this.domElement.ownerDocument.body,Object(qe.a)(this,
this.vwa,"onDocumentMouseMove")),this.B9a=!0);this.s5e()&&this.caa&&this.v0e(c);return!1};rd.prototype.Yhc=function(c){c=Hi.a(this.grid.$).He(c);this.s5e()&&this.ZRc&&this.v0e(c);if(c.Ea.button||!this.caa)return!1;Ri.g(c.Ea);this.ZCe();c=oe.a.K2a;this.er&&(c=this.KTa?this.f9c():this.er.tta());var k=c!==this.Ol;if(this.nIb&&k&&c!==oe.a.K2a){c=this.grid;k=this.WTe(c);var D={};D.SheetMultiRange=Sb.r(k,c.$);rd.THd(D,this.isRow,this.Ol);this.J8g(D);c.Knj=!0}else this.Bh(null,null),this.Mmc();return this.KTa=
!1};rd.prototype.ZCe=function(){this.B9a&&(Qj.a.instance.za(Sf.a.Ch,this.domElement.ownerDocument.body,Object(qe.a)(this,this.vwa,"onDocumentMouseMove")),bk.a.instance.za(Sf.a.Gg,this.domElement.ownerDocument.body,Object(qe.a)(this,this.vwa,"onDocumentMouseMove")),this.B9a=!1);this.caa=!1;this.B_i();this.PBd();ck.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};rd.prototype.B_i=function(){this.grid.Kb.mk([this.isRow?13:14]);this.grid.Kb.mab()};rd.prototype.Paa=function(c){c=Nk.a.create(c.eventName,
c.Sb,c.Ea,c.yb);c=Hi.a(this.grid.$).He(c);if(!this.Cxf(c,!0))return!1;c=this.grid;var k=this.WTe(c);k=Sb.r(k,c.$);c.Kb.mk([this.isRow?13:14]);c.Kb.mab();this.Mmc();var D={};c.$.De(this.isRow?146338636:1391094586,Xd.a.Tb,30,(D.autoFitRanges=k,D));return!1};rd.prototype.vwa=function(c){c=Hi.a(this.grid.$).He(c);if(!this.caa)return!1;Ri.g(c.Ea);var k=this.isRow;if(!this.A_){this.A_=document.createElement("div");this.A_.style.cssText="position: relative; width: inherit; height: inherit;"+(k?"top: 0px; ":
this.rtl?"right: 0px:":"left: 0px:");for(var D=this.er.fJ();D.nextSibling;)this.A_.appendChild(D.nextSibling);D.parentNode.appendChild(this.A_)}D=k?c.clientPoint.y-this.cxb.y:(this.rtl?-1:1)*(c.clientPoint.x-this.cxb.x);var ba=k?c.clientPoint.y-this.nIb.y:(this.rtl?-1:1)*(c.clientPoint.x-this.nIb.x),Ba=this.er.tta();if(Ba===oe.a.K2a)return!1;D&&(0<this.Ol||0<Ba+ba)&&Ba+ba<=this.$ef&&(this.Ol=this.XKd(ba),this.tNe(c,this.Ol,!1),Yg.DOMElementExtensions.hRa(this.er.fJ(),!k,Math.max(this.uFb+ba,0)),this.A_.style[k?
"top":this.rtl?"right":"left"]=Math.max(ba,-this.uFb)+"px",Yg.DOMElementExtensions.hRa(this.er.jg.domElement,!k,(k?this.er.jg.wO:this.er.jg.xO)+Math.max(ba,-this.uFb)),this.cxb=new Sys.UI.Point(c.clientPoint.x,c.clientPoint.y),Yg.DOMElementExtensions.setVisible(this.cF,!1));return!0};rd.prototype.tNe=function(c,k,D){this.VL&&D&&(nd.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.PBd());this.VL||
D||nd.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.Nnd&&this.Nnd(function(){var ba={};return ba.Location="canvas",ba});this.VL?this.yNe(k):(this.VL=document.createElement("div"),this.VL.id=this.TQh,this.yNe(k),this.VL.className=vj.a.qch,k=document.getElementById(this.grid.$.Jb+Ac.a.Pgf),k.insertBefore(this.VL,k.firstChild),c=Hi.a(this.grid.$).xIa(c.clientPoint),this.VL.style.left=(this.rtl?Math.max(c.x-
this.VL.offsetWidth,0):c.x-Math.max(c.x+this.VL.offsetWidth-k.offsetWidth,0)).toString()+"px",k=document.getElementById(Ac.a.Wkb),this.VL.style.top=(c.y-k.offsetHeight-this.VL.offsetHeight).toString()+"px")};rd.prototype.PBd=function(){Yg.DOMElementExtensions.ig(this.VL);this.VL=null};rd.prototype.yNe=function(c){var k=new Id(this.grid.$.workbookContext.DxDigitNormal);this.VL.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.PQh:this.YQh,this.isRow?k.Zte(c).toFixed(2):k.Qte(c).toFixed(2),
c.toString(),this.SQh)};rd.prototype.Cxf=function(c,k){var D;if(-1!==this.grid.ga.selectionType||2===c.yb&&c.Ea.button||!this.$kd(D=this.R9c(c))||!this.S7e)return!1;Ri.g(c.Ea);this.nIb=this.cxb=new Sys.UI.Point(c.clientPoint.x,c.clientPoint.y);this.oGg(D,k);if(!this.er)return!1;this.caa=!0;this.x5h(this.er,D)&&this.LUh();c={};Qi.b(this.grid.$).ee(Qh.a.vZi,(c.IsResizingHiddenHeader=this.KTa,c.IsAutoFitting=k,c.NumberOfSelectedRanges=this.grid.ga.wa.MJ,c.Location="canvas",c));this.uFb=this.f9c();this.offset=
this.er.mia();this.Ol=this.er.tta();if(this.Ol===oe.a.K2a)return!1;ck.c(this.grid.$,!1,"HeaderResizeBehavior:PrepareResizeOperation");return!0};rd.prototype.x5h=function(c,k){var D=this.er.fJ();if(!D)return nd.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;D=D.nextSibling;if(!D)return!1;c=c.getRange();D=this.jg.kta(D).getRange();if((!c||!D)&&zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4307391_ColumnResizeOnSnappingHeaders_IsResizingHidden"))return nd.ULS.shipAssertTag(537154048,
2,!1,"IsResizingHidden: range is null"),!1;var ba=c.right===D.right;return c.right+1!==D.right&&!ba&&this.$kd(k,!0)};rd.prototype.LUh=function(){var c=this.er.fJ(),k=this.jg.kta(c.nextSibling);rd.y5h(k,this.isRow)?(this.er=k,this.gOa=this.er.getRange()):(this.Nog(c),this.er=k,c=this.er.getRange(),this.gOa=this.isRow?new Bj.Range(c.top-1,c.left,c.top-1,c.right,!1,!0):new Bj.Range(c.top,c.left-1,c.bottom,c.left-1,!1,!0),this.KTa=!0)};rd.prototype.Nog=function(c){var k=this.jg.kta(c.nextSibling),D=rd.CUg(k,
this.isRow,this.rtl);D&&c.parentNode.insertBefore(D,k.fJ())};rd.prototype.WTe=function(c){var k=this.gOa,D=c.ga.wa.selectedRanges;if(c.ga.wa.npb(k))if(this.isRow){if(ja.a.all(D,function(ba){return ba.isRow}))return D}else if(ja.a.all(D,function(ba){return ba.Fh}))return D;return[k]};rd.prototype.f9c=function(){var c=this.er.fJ().style;return Math.max(0,Math.min(this.$ef,0|parseInt(this.isRow?c.height:c.width)))};rd.prototype.XKd=function(c){c=void 0===c?0:c;var k=this.grid,D=this.jg.ij.paneType;D=
this.isRow?3===D?[3,2]:[1,4]:4===D?[2,4]:[1,3];var ba=k.view.visibleArea.bottomRight,Ba=this.er.tta();Ba===oe.a.K2a&&(Ba=0);c=this.KTa?Math.max(this.f9c(),0):Math.max(Ba+c,0);ba=this.isRow?new Pj.a(0,this.offset,ba.x,c):new Pj.a(this.offset,0,c,ba.y);Ba=[this.isRow?13:14];k.Kb.Ek(Bj.Range.ld(1,1),Ba,!1);k.Kb.Jr(Ba,ba,D);return c};rd.prototype.qQ=function(c){c=Hi.a(this.grid.$).He(c);var k;if(!this.S7e||-1!==this.grid.ga.selectionType)return Ae.a(this.grid.$).Eq()&&(k=this.R9c(c))&&(k.Zta.style.cursor=
""),!1;if(this.caa)return this.GWh(),!1;k=this.R9c(c);if(!k)return!1;k.Zta.style.cursor=!this.grid.isEditing&&this.$kd(k)?this.isRow?"row-resize":"col-resize":"";Ri.g(c.Ea);return!0};rd.prototype.VVc=function(){this.gOa=this.nIb=this.cxb=null;if(this.A_){var c=this.A_.parentNode;if(c)for(c.removeChild(this.A_);this.A_.firstChild;)c.appendChild(this.A_.firstChild);this.A_=null}this.er=null;Yg.DOMElementExtensions.setVisible(rd.E9a,!1);this.caa=!1;this.PBd();Yg.DOMElementExtensions.setVisible(this.cF,
!1)};rd.prototype.R9c=function(c){if(Yg.DOMElementExtensions.ty(c.Sb,"a"))return null;var k=this.j9e(c.Ea);if(k&&this.grid.ga.wa.xh){var D=this.grid.ga.wa.Nd;D=this.jg.hs(Bj.Range.ld(D.bottom,D.right))}else D=this.jg.kta(c.Sb);if(!D)return null;var ba=D.fJ(),Ba=new Sys.UI.Bounds(ba.offsetLeft,ba.offsetTop,ba.offsetWidth,ba.offsetHeight),nb=Yg.DOMElementExtensions.getBoundingClientRect(c.Sb);nb=new Sys.UI.Point(c.clientPoint.x-nb.x,c.clientPoint.y-nb.y);this.isRow&&!k&&(nb.y+=gd.HelperMethods.Uz(c.Sb,
ba,this.rtl).y);return new Vd(ba,nb,Ba,D.getRange(),Math.max(rd.oii,Math.min(rd.ahi,(this.isRow?Ba.height:Ba.width)*rd.DZi)),k,!this.isRow&&0<ba.getElementsByTagName("input").length)};rd.prototype.$kd=function(c,k){k=void 0===k?!1:k;if(!c||this.grid.isEditing)return!1;if(c.i9e)return!0;var D=c.hMa,ba=c.D9a,Ba=this.jg.ij.paneType,nb=this.grid.Mf(Ba).Hh,Rb=!!nb&&nb.top===c.Zcd.top,Ic=!!nb&&nb.left===c.Zcd.left;Ba=!!nb&&nb.bottom===c.Zcd.bottom&&(3===Ba||2===Ba);this.isRow?(Ic=c.Pyb.y,c=Ic<=ba&&!Rb,
D=Ic>=D.height-ba-(Ba?rd.aqh:0),k=k?c:D||c):(Ba=c.YPh,Rb=this.rtl,nb=c.Pyb.x,c=nb<=ba&&(!Ic||Rb)&&(!Ba||!Rb),D=nb>=D.width-ba&&(!Rb||!Ic)&&(!Ba||Rb),k=k?Rb?D:c:c||D);return k};rd.prototype.oGg=function(c,k){var D=this.isRow;if(c.i9e)this.er=this.jg.kta(c.Zta);else if(D&&c.Pyb.y<=c.D9a&&c.hMa.height>c.D9a||!D&&c.hMa.width>c.D9a&&(!this.rtl&&c.Pyb.x<=c.D9a||this.rtl&&c.Pyb.x>=c.hMa.width-c.D9a)){if(this.er=c.Zta.previousSibling?this.jg.kta(c.Zta.previousSibling):this.kCh(),k&&c.Zta.classList.contains(D?
vj.a.sIe:vj.a.rIe)&&(c=this.jg.kta(c.Zta)))c=c.getRange(),this.gOa=D?new Bj.Range(c.top-1,c.left,c.top-1,c.right,!1,!0):new Bj.Range(c.top,c.left-1,c.bottom,c.left-1,!1,!0)}else this.er=this.jg.kta(c.Zta);!this.gOa&&this.er&&(this.gOa=this.er.getRange())};rd.prototype.kCh=function(){var c=this.isRow?1:0;return(c=this.jg.ij.fF(this.jg.ij.Ca.Dg(this.grid.$.qa,xk.a.oL(this.jg.position.X+c-1,this.jg.position.Y-c,this.jg.position.PaneType))))?c.jCh():null};rd.prototype.GWh=function(){var c=this.EZi;Yg.DOMElementExtensions.setVisible(c,
!0);c.style.cursor=this.isRow?vj.a.GFe:vj.a.AEe;this.XKd()};rd.prototype.J8g=function(c){var k={};this.grid.$.De(this.isRow?745189930:-445963340,Xd.a.Tb,30,(k.resizeRowColumnParameters=c,k))};rd.prototype.hq=function(){this.Mmc()};rd.prototype.Bh=function(){if((3===Xd.a.Tb||af.a.tr)&&this.grid.ga.wa.xh){var c=this.grid.ga.wa.Nd;if(!(!c.isRow&&!c.Fh||!this.domElement||c.isRow&&this.isRow&&!Array.contains(this.jg.Rn,c.top)||c.Fh&&!this.isRow&&!Array.contains(this.jg.Rn,c.left))){var k=this.grid.Eg(c,
this.jg.ij.paneType);k&&(this.cF||this.AYg(),c.isRow&&this.isRow?(Yg.DOMElementExtensions.setVisible(this.cF,!0),this.cF.style.top=k.bottomRight.y-this.cF.offsetHeight/2+"px"):c.isRow||this.isRow||(Yg.DOMElementExtensions.setVisible(this.cF,!0),Zi.c(this.cF.style,this.grid.rtl,k.bottomRight.x-this.cF.offsetWidth/2+"px")))}}};rd.prototype.AYg=function(){var c=document.createElement("div");c.className=vj.a.neh;var k=document.createElement("div");k.className=eh.a.sB;c.appendChild(k);var D=document.createElement("img");
D.src=yk.a.ve(0);D.className=this.isRow?eh.a.ydh:eh.a.vdh;k.appendChild(D);this.jg.nB.domElement.parentNode.insertBefore(c,this.jg.nB.domElement);Qj.a.instance.pa(Sf.a.pointerDown,c,Object(qe.a)(this,this.CM,"onMouseDown"));lh.a.instance.pa(Sf.a.zj,c,Object(qe.a)(this,this.Paa,"onDblClick"));Yg.DOMElementExtensions.setVisible(c,!1);this.cF=c};rd.prototype.Mmc=function(){this.VVc();this.cF&&(this.jg.nB.domElement.parentNode.removeChild(this.cF),this.cF=null)};rd.prototype.j9e=function(c){return Yg.DOMElementExtensions.Ue(this.cF,
c.target)};rd.prototype.qE=function(c,k){k.kO&&this.Bmb()};rd.prototype.Bmb=function(){this.caa&&(this.ZCe(),Yg.DOMElementExtensions.hRa(this.er.fJ(),!this.isRow,this.uFb),this.Mmc(),this.KTa=!1)};rd.prototype.s5e=function(){return zg.EwaSettings.ka(722)};rd.prototype.v0e=function(c){(c=c.Ea.rawEvent)&&c.detail===rd.c3i&&(c.type===Sf.a.rp?(this.caa=!1,this.ZRc=!0):c.type===Sf.a.cH&&(this.caa=!0,this.ZRc=!1))};rd.yUg=function(c,k){return new rd(c,k)};rd.y5h=function(c,k){if(!c||!c.fJ())return nd.ULS.shipAssertTag(537154014,
2,!1,"header after hidden headers is null"),!1;var D=c.getRange();c=c.fJ().style;if(!D||!c)return nd.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;c=k?c.height:c.width;return(k?D.top:D.left)===(k?oe.a.lh:oe.a.zh)&&c===rd.p6f};rd.CUg=function(c,k,D){if(!c)return nd.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var ba=c.fJ();if(!ba||!ba.style)return nd.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;c=document.createElement("div");
var Ba=ba.style;c.style.top=k?Ba.top:rd.p6f;k||(D?c.style.right=Ba.right:c.style.left=Ba.left);c.classList.add(k?He.Adh:He.zdh);c.classList.add(k?vj.a.rqb:vj.a.qqb);D=document.createElement("div");D.classList.add(k?vj.a.gIe:vj.a.s4c);ba=k?Number.parseInvariant(ba.innerText):Bj.Range.jYa(ba.innerText);D.innerText=k?(ba-1).toString():Bj.Range.U1(ba-1);c.appendChild(D);return c};rd.THd=function(c,k,D){if(k)for(c.ColumnWidth=-1,c.RowHeight=D,c=Ol(c.SheetMultiRange.Ranges),k=c.next();!k.done;k=c.next())k=
k.value,k.FirstColumn=0,k.LastColumn=0;else for(c.RowHeight=-1,c.ColumnWidth=D,c=Ol(c.SheetMultiRange.Ranges),k=c.next();!k.done;k=c.next())k=k.value,k.FirstRow=0,k.LastRow=0};Ll.Object.defineProperties(rd.prototype,{S7e:{configurable:!0,enumerable:!0,get:function(){var c=(new Cj.a(this.grid.$.va)).we(this.isRow?16:8),k=this.grid.$.zb.xJ,D=this.grid.li,ba=Ae.a(this.grid.$).Eq();return c&&!k&&!D&&!ba}},EZi:{configurable:!0,enumerable:!0,get:function(){this.r9g();return rd.E9a}}});rd.oii=0;rd.ahi=5;
rd.aqh=3;rd.DZi=.1;rd.oIf="ewa-rszrbg";rd.p6f="0px";rd.c3i=2;rd.E9a=null;Object(te.a)(rd,"HeaderResizeBehavior",wk.a,[]);var lk=Me.a;Em(Pc,lk);Pc.prototype.create=function(){this.Eb(rd.yUg)};Pc.ja=function(c){c.ea.Ia(136,new Pc)};Object(te.a)(Pc,"HeaderResizeBehaviorFactory",Me.a,[]);var Sj=b(196),Ik=b(410),jj=b(514),ri=b(70);Object(te.a)(hc,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[115]);Object(te.a)(Bb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[115]);var Tj=td.a;Em(Oc,Tj);Oc.prototype.k3=
function(c,k){var D={};return D.id=this.sc,D.isRow=this.isRow,D.initialSizeInPx=c,D.initialSizeInDefaultUnits=k,D.isInitialUnitsDefaultUnits=this.Awb,D.getInputErrorIfInvalid=Object(qe.a)(this,this.nsb,"getInputErrorIfInvalid"),D};Oc.prototype.nsb=function(c){c=this.e$c(c);return this.B7c(c)};Oc.prototype.NGg=function(){var c=this.eth();try{return this.txh(c)}finally{c&&c.dispose()}};Oc.prototype.wZi=function(c,k){var D=this.Awb=k[Oc.Q0h];1===c?(c=k[Oc.Eij],D=this.MVe(c,D),nd.ULS.shipAssertTag(537153996,
0,D!==Oc.N$,"ResizeHeadersDialogHandler - invalid size input, size = {0}",c),c=D!==this.dfd,nd.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.Awb,D,c),c&&this.cSg(D)):nd.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",this.isRow)};Oc.prototype.cSg=function(c){var k={};k.SheetMultiRange=Sb.r(this.gridView.ga.wa.selectedRanges,this.$);Oc.THd(k,this.isRow,
c);c={};this.$.De(this.isRow?745189930:-445963340,Xd.a.Tb,8,(c.resizeRowColumnParameters=k,c))};Oc.prototype.MVe=function(c,k){return Cd.a.pU(c)?k?this.PQg(c):this.RQg(c):Oc.N$};Oc.prototype.RQg=function(c){return Math.floor(parseFloat(c))};Oc.prototype.PQg=function(c){c=parseFloat(c);return 0>c?Oc.N$:c?this.isRow?gd.HelperMethods.dGi(c):this.foc.XMg(c):0};Oc.prototype.SQg=function(c){return c===Oc.N$?"":this.isRow?this.foc.Zte(c).toString():this.foc.Qte(c).toFixed(2)};Oc.prototype.QQg=function(c){return c===
Oc.N$?"":c.toString()};Oc.prototype.txh=function(c){if(!c||!c.$$mn()||!c.jn)return Oc.N$;var k=Object(yh.a)(234,c.jn);if(!k)return Oc.N$;for(k=this.isRow?k.Hub:k.bfd;c.$$mn();){var D=Object(yh.a)(234,c.jn);if(D&&(this.isRow?D.Hub:D.bfd)!==k)return Oc.N$}return k};Oc.prototype.eth=function(){for(var c=[],k=Ol(this.gridView.ga.wa.selectedRanges),D=k.next();!D.done;D=k.next()){D=D.value.clone();var ba=this.gridView.Mf(this.gridView.Wa.Bj(D));ba=D.Ef(ba.Hh);if(!ba)return null;this.isRow?D.right=D.left=
ba.left:D.top=D.bottom=ba.top;Array.add(c,D)}return c.length?this.gridView.g2("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",c):null};Oc.prototype.e$c=function(c){if(!Cd.a.pU(c))return 1;c=this.MVe(c,this.Awb);return!c&&this.w5h()?3:this.Y7h(c)?0:2};Oc.prototype.w5h=function(){var c=this.gridView.ga.wa.selectedRanges;return this.isRow&&Sb.P(c)||!this.isRow&&Sb.O(c)};Oc.prototype.B7c=function(c){var k="";switch(c){case 0:k="";break;case 1:k=Ff.a.instance.da(737);break;case 2:c=this.Awb;
k=String.format(Ff.a.instance.Bb(98),0,this.d8b(c));break;case 3:k=Ff.a.instance.da(738)}return k};Oc.prototype.Y7h=function(c){return 0<=c&&c<=this.d8b(!1)};Oc.prototype.d8b=function(c){return this.foc.d8b(c,this.isRow)};Oc.THd=function(c,k,D){if(k)for(c.ColumnWidth=Oc.N$,c.RowHeight=D,c=Ol(c.SheetMultiRange.Ranges),k=c.next();!k.done;k=c.next())k=k.value,k.FirstColumn=0,k.LastColumn=0;else for(c.RowHeight=Oc.N$,c.ColumnWidth=D,c=Ol(c.SheetMultiRange.Ranges),k=c.next();!k.done;k=c.next())k=k.value,
k.FirstRow=0,k.LastRow=0};Ll.Object.defineProperties(Oc.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},Awb:{configurable:!0,enumerable:!0,get:function(){return Oc.d2d},set:function(c){Oc.d2d=c}}});Oc.p2a="id";Oc.Eij="size";Oc.Q0h="isDefaultUnits";Oc.N$=-1;Oc.d2d=!0;Object(te.a)(Oc,"ResizeHeadersDialog",td.a,[]);rc.prototype.Wc=function(c,k){c=!0;switch(k){case -445963340:case 1391094586:c=this.we(8);break;case 745189930:case 146338636:c=this.we(16)}return!c};
rc.prototype.executeCommand=function(c,k,D){var ba=ia.TaskExtensions.dm();var Ba=$d.g(this.$);c=Sj.a.create().toString();var nb=k.command;switch(nb){case 1391094586:case 146338636:var Rb=1391094586===nb;(c=D.autoFitRanges)&&c.Ranges&&c.Ranges.length||(c=Sb.r(Ba.ga.wa.selectedRanges,this.$));ba=this.z4g(Rb?1:0,c,k);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Rb=-445963340===nb||-706918724===nb||369708605===nb;if(-445963340===nb||745189930===nb)Rb=
Ik.a(k.command),Ba.vi.g6(16,c,Rb),D=D.resizeRowColumnParameters;else{var Ic=Ba.ga.wa.selectedRanges;if(-706918724===nb&&6===k.Ze&&Sb.O(Ic)){nd.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===nb&&6===k.Ze&&Sb.P(Ic)){nd.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}Ba=369708605===nb||1542466017===
nb?-2:0;D={};D.SheetMultiRange=Sb.r(Ic,this.$);if(Rb)for(ba=Ol(D.SheetMultiRange.Ranges),nb=ba.next();!nb.done;nb=ba.next())nb=nb.value,nb.FirstRow=0,nb.LastRow=0;else for(ba=Ol(D.SheetMultiRange.Ranges),nb=ba.next();!nb.done;nb=ba.next())nb=nb.value,nb.FirstColumn=0,nb.LastColumn=0;D.RowHeight=Rb?-1:Ba;D.ColumnWidth=Rb?Ba:-1}ba=this.P4g(D,k,c);break;case 957527587:case 2040891415:new Oc(this.$,k)}return ba};rc.prototype.hyi=function(c,k){if(!Ph.a(c)&&k){var D=!!c&&!!c.RequestTelemetryData;$d.g(this.$).vi.Kja(k,
c.StateId,D?c.RequestTelemetryData.EcsOperationDuration:0,D?c.RequestTelemetryData.EcsRequestDuration:0,D?c.RequestTelemetryData.WfeRequestDuration:0)}};rc.prototype.Ec=function(c,k,D,ba){if(c=!!D&&!!ba&&1===ba.Ez)switch(k.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:c=!1}return c};rc.prototype.Yc=function(){return!1};rc.prototype.Pgj=function(c,k,D,ba){if(!D)return this.d5a(!1,
"resizing to 0 - ignore"),!1;var Ba=c.Ca;if(c.rZe())return this.d5a(!1,"skeleton in view - ignore"),!1;var nb=c.pf;if(!nb)return nd.ULS.sendTraceTag(537154005,0,15,"ResizeCommandHandler.ShowInstantaneousResize: ActiveSheetProcessedData is null"),!1;var Rb=nb.T9c(k);if(Rb&&0<Rb.length)return this.d5a(!1,Rb.length.toString()+" hiddens in resizeRanges"),!1;if(this.C3h(c,k,ba))return this.d5a(!1,"There's a merge cell across blocks in resizeRanges"),!1;if(zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!ba)for(c=Ol(k),Rb=c.next();!Rb.done;Rb=c.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Rb.value.left);c=Sj.a.create().toString();nb.dRd(k,D,ba);D=Ba.uQd(ba);this.ji.wCf(k,ba);Ba.Yyd(D,c);this.d5a(!0);return!0};rc.prototype.C3h=function(c,k,D){for(var ba=Ol(k),Ba=ba.next();!Ba.done;Ba=ba.next())Ba=Ba.value,D?Ba.right=oe.a.zh:Ba.bottom=oe.a.lh;c=c.g2("ResizeCommandHandler.IsMergeCellAcrossBlocksExistInRanges",k);try{for(c.$$rst();c.$$mn();)if(c.jn.YUf)return!0}finally{c&&c.dispose()}return!1};
rc.prototype.d5a=function(c,k){nd.ULS.sendTraceTag(537154004,0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",c,void 0===k?"":k)};rc.prototype.we=function(c){return(new Cj.a(this.$.va)).we(c)};rc.prototype.z4g=function(c,k,D){function ba(){return new hc(Rb,k)}var Ba=this,nb=this.$.ra.ua.Wb(),Rb=!c;return rf.a(this.$.userOperationManager,function(Ic,Wc,Rd){var Ge=Ba.$.ra.ua,df=Ge.Na(41,nb);df.isRow=Rb;df.autoFitRanges=k;return Af.i(Ge,"AutoFit",df,Ic,
Wc,Rd,null,0)},function(Ic){return new Ne.a(135,0,Ic,void 0,ba)},D)};rc.prototype.P4g=function(c,k,D){function ba(){return new Bb(c)}function Ba(df,Wf,Pg){nb.$.Es();Sb.i(Rb,",",nb.$,!1);var Bg=nb.$.ra.ua;df=Fd.b(df,Object(qe.a)(nb,nb.hyi,"onResizeOperationWebMethodSuccess"));var qh=Bg.Na(41,void 0===Ge?null:Ge);qh.resizeRowColumnParameters=c;return Af.i(Bg,"ResizeRowsColumns",qh,df,Wf,Pg,D,0)}var nb=this,Rb=Sb.g(c.SheetMultiRange.Ranges),Ic=!1,Wc=k.command;if(745189930===Wc||-445963340===Wc){nd.ULS.shipAssertTag(537154002,
0,this.$.activeItemName===c.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");Ic=$d.g(this.$);var Rd=(Wc=745189930===Wc)?c.RowHeight:c.ColumnWidth;zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5830345_RowColumnResizeCSERefactor")?(Wc=this.ji.Qgj(Ic,Rb,Rd,Wc),Ic=Wc.success,this.d5a(Ic,Wc.reason)):Ic=this.Pgj(Ic,Rb,Rd,Wc);Ic&&$d.g(this.$).vi.u_(D,ri.BasicTelemetryCalculator.JP)}var Ge=this.$.ra.ua.Wb(!0);return Ic?zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,
Ba,function(df){return new Ne.a(136,0,df,64,ba)},k):rf.a(this.$.userOperationManager,Ba,function(df){return new jj.a(136,0,df,void 0,ba)},k):rf.a(this.$.userOperationManager,Ba,function(df){return new Ne.a(136,0,df,void 0,ba)},k)};Object(te.a)(rc,"ResizeCommandHandler",null,[160]);var Fj=Tf.a;Em(Lb,Fj);Lb.prototype.Gd=function(){var c=this,k=Xf.GetServiceTaskFactory.create(this.$.ea,18,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction");ia.TaskExtensions.Aa(k,function(){c.Ad([new rc(c.$,
k.result)])},this.la,3)};Lb.ja=function(c){Tf.a.Yd(113,new Lb(c))};Object(te.a)(Lb,"ResizeCommandHandlerFactory",Tf.a,[]);vb.prototype.Wc=function(){return!1};vb.prototype.executeCommand=function(c,k,D){c=2;switch(k.command){case -309686558:c=this.pi.Ge(eg.a.saveACopy,2,D);break;case 617689800:c=this.pi.Ge(eg.a.saveToCloudStorage,2,D);break;case -1244760097:c=this.pi.Ge(eg.a.saveToSharePoint,2,D)}return 2===c&&k?u.a(k.command):Ie.Task.Ra(!0)};vb.prototype.Ec=function(c,k){c=!1;switch(k.command){case -1244760097:case -309686558:case 617689800:c=
!0,nd.ULS.shipAssertTag(537153984,0,this.$.Q$,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return c};vb.prototype.Yc=function(){return!1};Object(te.a)(vb,"SaveToHostCommandHandler",null,[160]);var qk=Tf.a;Em(sa,qk);sa.prototype.Gd=function(){var c=this;ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),function(){c.Ad([new vb(c.$,wd.AFrameworkApplication.Hb)])},this.la,3);wd.AFrameworkApplication.Hb.Xb(eg.a.BOa,
ih.a.frame,Object(qe.a)(this,this.Toh,"forceSaveActionDispatcher"))};sa.prototype.Toh=function(c,k,D,ba,Ba){return 1===D?32:c===eg.a.BOa&&2===D?(c=this.$.ra.ua.Wb(),Af.Z(this.$.ra.ua,Ba[0],Ba[1],null,null,c),32):8};sa.ja=function(c){Tf.a.Yd(267,new sa(c))};Object(te.a)(sa,"SaveToHostCommandHandlerFactory",Tf.a,[]);Od.prototype.Wc=function(c){switch(c){case -309686558:return 8===this.pi.processAction(eg.a.saveACopy,1,null);case 617689800:return 8===this.pi.Ge(eg.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.pi.Ge(eg.a.saveToSharePoint,1,null)}return!1};Od.prototype.dispose=function(){this.$=null};Object(te.a)(Od,"SaveToHostManager",null,[662,6]);var dk=Me.a;Em(yd,dk);yd.prototype.create=function(){this.Eb(this.$.ea.Ba(393)||new Od(this.$,wd.AFrameworkApplication.Hb))};yd.ja=function(c){c.ea.Ia(394,new yd(c))};Object(te.a)(yd,"SaveToHostManagerFactory",Me.a,[]);var Gj=cj.a;Em(Nc,Gj);Nc.prototype.execute=function(c){var k=Object(yh.a)(10,c.Ae);nd.ULS.shipAssertTag(537153921,0,Eb.a.flb(c.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");
k.mH(!0,!0);c.activityState[gh.a.tUb]=k.fa.sessionId;c.activityState[gh.a.Mjb]=!0;c.activityState[gh.a.zUb]=!0;nd.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(te.a)(Nc,"SessionReloadActivity",cj.a,[]);var zk=Me.a;Em(Lc,zk);Lc.prototype.create=function(){this.Eb(new Nc(vf.a.j$a,vf.a.wk))};Lc.ja=function(c){c.ea.Ia(142,new Lc)};Object(te.a)(Lc,"SessionReloadActivityFactory",Me.a,[]);var Mg=b(55),ek=b(266),Rj=b(107),Fk=
b(47),fk=b(243),Ng=b(112),rk=cj.a;Em(gc,rk);gc.prototype.execute=function(c){var k=Object(yh.a)(10,c.Ae);c.activityState[gh.a.Opa]=!0;var D=gc.pIh(c);if(gc.Ecj(c,D))return gc.rgi(c),D=50,0<c.errors.length&&(D=15),nd.ULS.sendTraceTag(537153891,0,D,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",Eb.a.Uc(c.errors)),c.activityState[gh.a.Opa]=!1,this.fh(vf.a.idle),3;switch(D){case 1:case 3:this.nXh(c,D);break;case 2:this.mXh(c);break;case 0:c.activityState[gh.a.CVa]=
null}nd.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",D,this.activityName,this.xZ,k.fa.p6);var ba=Xj.a.rg(c.activityState,Ng.a.xbb);nd.ULS.shipAssertTag(40502925,0,!ba||ba&&(1===D||3===D),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",ba,D);k=k.Ck.reloadCount;return D&&0<k?(ba=ek.a.h1a(k,200),nd.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",
D,k,ba,this.activityName),th.a.instance.create(function(){gc.GI(c)},ba,Aj.a.R5i),1):3};gc.prototype.nXh=function(c,k){nd.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var D=Object(yh.a)(10,c.Ae);c.activityState[gh.a.Mjb]=!0;D.Xac||Fk.PageLoadTrackingInfo.instance.wj("ReopenOnLoad");!gc.isEditMode(c)&&Eb.a.flb(c.errors)&&(nd.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),
c.activityState[gh.a.tUb]=D.fa.sessionId,c.activityState[gh.a.zUb]=!0);c.$od();3===k?(D.fa.Rg()||D.fa.Vli(),D.mH(!0,!0),this.fh(this.trj),c.activityState[gh.a.Zce]=D.workbookContext.CalcMode):(zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===k&&D.mH(!0,!0),c.activityState[gh.a.jOc]=!1,this.fh(this.Asc))};gc.prototype.mXh=function(c){nd.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");c.activityState[gh.a.CVa]=
null;c.$od();this.fh(this.xij);c=Object(yh.a)(10,c.Ae);c.Xac||(Fk.PageLoadTrackingInfo.instance.wj("RefreshOnLoad"),c.xEb())};gc.GI=function(c){c.GI()};gc.pIh=function(c){var k=Object(yh.a)(10,c.Ae),D=k.fa,ba=gc.isEditMode(c),Ba=Eb.a.Yg(c.errors,ba?gc.Mod:gc.Nod),nb=Eb.a.Yg(c.errors,ba?gc.tef:gc.uef),Rb=k.LP,Ic=k.Ck.reloadCount,Wc=k.ya.MaxConsecutiveSilentReloadAllowed,Rd=k.Ck.eZe(),Ge=Eb.a.Uc(c.errors),df=Eb.a.Uc(c.txa),Wf=0<Eb.a.yL(function(qh){return!qh.triggerSilentReopenOnly},c.errors).length,
Pg=Ba,Bg=Xj.a.rg(c.activityState,Ng.a.xbb);Bg&&(Pg=!0);Ba={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:ba,isSilentReopenError:Ba,isSilentRefreshError:nb};Ba.reloadSequenceCount=k.Ck.TNa;Ba.reloadCount=Ic;Ba.maxReloads=Wc;Ba.stopSilentReloads=Rd;Ba.errorNames=Ge;Ba.processedErrorNames=df;Ba.isClientDirty=Rb;Ba.errorsForSilentReopenOnly=Wf;Ba.triggerSilentReloadAfterTokenRefresh=Bg;Ba.IsReopenDisabled=k.BKa;Rb=Mg.a.Hc(Ba);nd.ULS.sendTraceTag(21837004,0,50,Rb);if(!Rd){if(Pg&&(ba?
gc.ucj(c):gc.wcj(c)))return fk.a.mRf(c,k)?3:k.BKa?2:1;if(nb&&(ba||!D.v8a))return 2}return 0};gc.Ecj=function(c,k){for(var D=Ol(c.errors),ba=D.next();!ba.done;ba=D.next())if(ba=ba.value,-1337545025===ba.MessageId||-238814601===ba.MessageId)return!1;return Eb.a.yL(function(Ba){return!Ba.triggerSilentReopenOnly},c.errors).length?3!==k:!1};gc.rgi=function(c){var k=Eb.a.yL(function(ba){return!ba.triggerSilentReopenOnly},c.errors);k=Ol(k);for(var D=k.next();!D.done;D=k.next())c.Jja(D.value)};gc.isEditMode=
function(c){var k=Object(yh.a)(10,c.Ae);return k.fa.lc?k.isEditMode&&!!(k.zd&64):Xj.a.rg(c.activityState,gh.a.Wq)};gc.wcj=function(c){var k=Object(yh.a)(10,c.Ae),D=Eb.a.N9(c.errors,gc.Nod);if(Rj.b(D,function(ba){return ba.ForceVersionUpgrade}))return!1;c=Eb.a.flb(c.errors);return!k.fa.v8a||c?!0:!1};gc.ucj=function(c){c=Eb.a.N9(c.errors,gc.Mod);return!Rj.b(c,function(k){return k.ForceVersionUpgrade})};gc.Nod=null;gc.Mod=null;gc.uef=null;gc.tef=null;Object(te.a)(gc,"SessionReloadSilentActivity",cj.a,
[]);var Ak=Me.a;Em(Ab,Ak);Ab.prototype.create=function(){this.Eb(new gc(this.activityName,this.kT,vf.a.wk,vf.a.dj,vf.a.wJb))};Ab.ja=function(c){c.ea.Ia(143,new Ab(vf.a.Bla,vf.a.hXb));c.ea.Ia(144,new Ab(vf.a.Xpc,vf.a.KMa));c.ea.Ia(145,new Ab(vf.a.Ypc,vf.a.lvd));c.ea.Ia(154,new Ab(vf.a.k$a,vf.a.zN))};Object(te.a)(Ab,"SessionReloadSilentActivityFactory",Me.a,[]);cb.prototype.getSheetName=function(){return this.sheetName};cb.prototype.getValue=function(){return this.value};Object(te.a)(cb,"MacroRecorderSheetOptionToggledPayload",
null,[115]);jc.prototype.Wc=function(){return!1};jc.prototype.executeCommand=function(c,k){function D(){return new cb(ba.SheetName,Rd)}var ba={};this.$.Mj(ba);c=k.command;var Ba=Object(yh.a)(rj.a,this.$.va.getItemByName(ba.SheetName));if(!Ba)return u.a(c);switch(c){case 705559150:case -1411193626:var nb=16;var Rb=!Ba.hideGridLines;var Ic=Qa;var Wc=183;var Rd=Ba.hideGridLines;break;case -2052321504:case 515737500:nb=4;Rb=!Ba.headersVisible;Ic=fb;Wc=184;Rd=!Ba.headersVisible;break;case -1478455630:nb=
2;Rb=!Ba.displayRtl;Ic=sb;Wc=185;Rd=!Ba.displayRtl;$d.g(this.$).Ca.awj(Rb);break;default:return u.a(c)}Ba.Jmb(nb,Rb);var Ge=this.$.ra.ua;return rf.a(this.$.userOperationManager,function(df,Wf,Pg){return Ic(Ge,ba.SheetName,Rd,Fd.b(df,function(Bg){jc.hBb(Bg,Ba,nb,Rb)}),Fd.a(Wf,function(){jc.jAb(Ba,nb,Rb)}),Pg,null)},function(df){return new Ne.a(Wc,0,df,void 0,D)},k)};jc.prototype.Ec=function(c,k){c=!1;switch(k.command){case -1411193626:case 515737500:case -1478455630:c=!0;break;case 705559150:case -2052321504:c=
ck.a(this.$)}return c};jc.prototype.Yc=function(){return!1};jc.hBb=function(c,k,D,ba){Eb.a.vq(c.Errors)&&k.Jmb(D,!ba)};jc.jAb=function(c,k,D){c.Jmb(k,!D)};Object(te.a)(jc,"SheetOptionsToggleCommandHandler",null,[160]);var Ii=Tf.a;Em(Db,Ii);Db.prototype.Gd=function(){this.Ad([new jc(this.$)])};Db.ja=function(c){Tf.a.Yd(100,new Db(c))};Object(te.a)(Db,"SheetOptionsToggleCommandHandlerFactory",Tf.a,[]);var Uj=b(60),Bk=b(44),mk=b(198),gk=mk.a;Em(Hb,gk);Hb.prototype.initialize=function(){var c=this.$.Jb+
"iframeDialog_frame",k=this.$.Jb+"iframeDialog";var D=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',c,this.PQe(k));this.Nb.style.margin=gd.HelperMethods.Pb(0);this.Nb.style.marginBottom=gd.HelperMethods.Pb(-2);this.Nb.innerHTML=D;this.eEc=document.getElementById(c);this.domElement.id=k;this.onResize(null,Sys.EventArgs.Empty);af.a.bcc&&th.a.instance.create(Object(qe.a)(this,this.V8g,"ensureCloseButton"),50,Aj.a.zSh,!0,!0);gk.prototype.initialize.call(this)};
Hb.prototype.dispose=function(){this.$&&this.$.oH(Object(qe.a)(this,this.onResize,"onResize"));gk.prototype.dispose.call(this)};Hb.prototype.setFocus=function(){Yg.DOMElementExtensions.setFocus(this.nJa)};Hb.prototype.onHide=function(){this.nJa.contentWindow.close();Yg.DOMElementExtensions.ig(this.nJa);this.eEc=null;gk.prototype.onHide.call(this)};Hb.prototype.onResize=function(){var c=this.qBh();this.nJa.setAttribute("width",c.x.toString());this.nJa.setAttribute("height",c.y.toString());this.Iwj(c);
this.Itd()};Hb.prototype.Iwj=function(c){var k=this.domElement.style;k.width=gd.HelperMethods.Pb(c.x);k.marginLeft=gd.HelperMethods.Pb(-c.x/2)};Hb.prototype.qBh=function(){var c=Yg.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*c.width),this.sye.x),Math.min(Math.floor(.9*c.height),this.sye.y))};Hb.prototype.V8g=function(){var c=this.Aw.parentNode.style,k=c.top;c.top="2px";c.top=k};Ll.Object.defineProperties(Hb.prototype,{nJa:{configurable:!0,enumerable:!0,
get:function(){return this.eEc}}});Object(te.a)(Hb,"IFrameDialog",mk.a,[]);Em(Qb,Hb);Qb.prototype.PQe=function(c){var k=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);Kh.a.lg(k,Ac.a.cah,c);Te.a(this.$.ya,34)&&Kh.a.lg(k,Ac.a.aah,"1");Te.a(this.$.ya,35)&&Kh.a.lg(k,Ac.a.bah,"1");return k.toString()};Qb.prototype.onShow=function(){nd.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");Hb.prototype.onShow.call(this)};Ll.Object.defineProperties(Qb.prototype,{sc:{configurable:!0,
enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(te.a)(Qb,"EmbeddingDialog",Hb,[]);Sa.EQf="FrameDialog_ShareFromEdit";Sa.view="FrameDialog_View";Sa.jre="FrameDialog_CloseAndRefresh";Sa.Ebj="FrameDialog_ShareFromView";Sa.edit="FrameDialog_Edit";Sa.yPi="FrameDialog_RefreshGrid";Sa.tMg="FrameDialog_CloseMe";Sa.ure="FrameDialog_CloseMeError";Sa.ready="FrameDialog_Ready";Sa.cGi="FrameDialog_PleaseClose";Sa.qG="GotoRange";Object(te.a)(Sa,"PostMessageConstants",null,[]);var Zj=b(105);Object(te.a)(Ca,
"SessionUpdateContext",null,[]);Em(ua,Hb);ua.prototype.Ysg=function(c){this.addHandler(ua.Fmd,c)};ua.prototype.FUi=function(c){this.removeHandler(ua.Fmd,c)};ua.prototype.dispose=function(){qj.a.Fa(this.QYa);this.QYa=null;Hb.prototype.dispose.call(this)};ua.prototype.initialize=function(){Hb.prototype.initialize.call(this);var c=xe.a.k$(this.$.ya.FormLightBoxUrl),k=this.QYa=new K.a(this.nJa.contentWindow,c);k.isEnabled()&&k.CDa(c)&&(this.Tka(Sa.EQf,Object(qe.a)(this,this.yjc,"onUpdateMessage")),this.Tka(Sa.view,
Object(qe.a)(this,this.yjc,"onUpdateMessage")),this.Tka(Sa.jre,Object(qe.a)(this,this.yjc,"onUpdateMessage")),this.Tka(Sa.Ebj,Object(qe.a)(this,this.uzi,"onShareFromView")),this.Tka(Sa.edit,Object(qe.a)(this,this.vri,"onEditMessage")),this.Tka(Sa.yPi,Object(qe.a)(this,this.yjc,"onUpdateMessage")),this.Tka(Sa.ready,Object(qe.a)(this,this.Nxi,"onReadyMessage")),this.Tka(Sa.tMg,Object(qe.a)(this,this.alf,"onCloseMessage")),this.Tka(Sa.ure,Object(qe.a)(this,this.alf,"onCloseMessage")))};ua.prototype.close=
function(c){c===this.closeAction&&this.e6e&&this.QYa.send(new ag.a(Sa.cGi))||Hb.prototype.close.call(this,c)};ua.prototype.PQe=function(){return this.yve(this.Pcc)};ua.prototype.yve=function(c){var k=this.$.ya,D=new Sys.StringBuilder(k.FormLightBoxUrl);Kh.a.lg(D,Ac.a.oph,this.$.fa.sessionId);Kh.a.lg(D,Ac.a.mph,c?Ac.a.nph:Ac.a.lph);qi.a.dEa(D,k);return D.toString()};ua.prototype.yjc=function(c){function k(Rb,Ic,Wc){return Af.E(ba.ra.ua,Fd.b(Rb,Object(qe.a)(D,D.gzi,"onSessionUpdated")),Ic,Wc,Ba)}var D=
this,ba=this.$,Ba=new Ca;Ba.qG=c.Values[Sa.qG];var nb=!1;switch(c.MessageId){case Sa.EQf:this.Yt();nb=!0;Ba.cxd=1334518759;break;case Sa.view:this.pza=Ff.a.instance.da(1204);this.v3f(!0);break;case Sa.jre:this.Yt(),nb=!0}zg.EwaSettings.pc()?(c=new Ne.a(140,0,k),c.flags=nb?16:80):(c=nb?new Ne.a(140,0,k):new jj.a(140,0,k),c.flags=16);ba.userOperationManager.jc(c,this.Zd)};ua.prototype.vri=function(){var c=this.$;c.ya.SurveyRedirectUrl?(this.Yt(),c.De(1305810481,0,8,null)):(this.pza=Ff.a.instance.da(1203),
this.v3f(!1))};ua.prototype.uzi=function(){var c=this.$;this.Yt();c.De(1334518759,0,8,null)};ua.prototype.alf=function(c){var k=this.$;this.Yt();c.MessageId===Sa.ure&&k.fa.R6c()};ua.prototype.Nxi=function(){this.vFc=!0;this.raiseEvent(ua.Fmd)};ua.prototype.v3f=function(c){this.vFc=!1;this.nJa.src=this.yve(c);this.V1d=c};ua.prototype.Tka=function(c,k){this.QYa.En(c);this.QYa.xm(c,k)};ua.prototype.gzi=function(c,k){var D=this;if(!Ph.a(c)){c=this.$;if(k.qG){var ba=c.fa.va;if(ba.contains(k.qG.SheetName))this.uic(k);
else{var Ba=null;Ba=function(){ba.Yka(Ba);D.uic(k)};ba.pfa(Ba)}}1461300262!==k.cxd&&c.De(k.cxd,0,8,null)}};ua.prototype.uic=function(c){var k=this.$.fa.va.getItemByName(c.qG.SheetName);k&&!k.Bx&&$d.g(this.$).ki(c.qG,null,null,null,20,Zj.a.Xoh)};Ll.Object.defineProperties(ua.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},e6e:{configurable:!0,enumerable:!0,get:function(){return this.vFc}},Pcc:{configurable:!0,enumerable:!0,get:function(){return this.V1d}}});ua.z0g=
900;ua.b0g=1200;ua.Fmd="lightBoxReady";Object(te.a)(ua,"FormDialog",Hb,[201]);var R;(function(c){c[c.comment=10]="comment";c[c.range=12]="range";c[c.table=13]="table";c[c.chart=14]="chart"})(R||(R={}));Object(te.b)("NavigationType",R);var va=b(1002),jb=b(114),Xb=b(576),Jc=b(1061),Xc=b(280),Dc=b(835),Cc=Dc.a;Em($a,Cc);$a.prototype.initialize=function(){var c="<div class='"+jb.a.hy+"'>\r\n\t<div class='"+jb.a.MEe+"'>\r\n\t\t<div class='"+eh.a.kWc+"'>\r\n\t\t\t<img src='{0}' class='"+eh.a.FHe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+
jb.a.PEe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";c=String.format(c,yk.a.ve(13),Ff.a.instance.da(25),Ff.a.instance.da(this.message));this.Nb.innerHTML=c;this.addButton(0,this.Cni);this.addButton(1);Cc.prototype.initialize.call(this)};$a.prototype.vw=function(){return this.ISd};Ll.Object.defineProperties($a.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},$v:{configurable:!0,enumerable:!0,get:function(){return 1005}},Zqa:{configurable:!0,enumerable:!0,
get:function(){return this.operationFlags}}});Object(te.a)($a,"WebMethodConfirmationDialog",Dc.a,[]);var cd=va.a;Em(Ua,cd);Ua.prototype.dispose=function(){this.ZQa&&this.ZQa.Jba(Object(qe.a)(this,this.Qtf,"onUnshareClicked"));qj.a.mc([this.textBox,this.IOa,this.ZQa]);this.ZQa=this.IOa=this.textBox=null;cd.prototype.dispose.call(this)};Ua.prototype.initialize=function(){var c="<div class='"+jb.a.hy+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+jb.a.hqb+"'>\r\n\t<input type='text' id='{1}' class='"+
jb.a.zT+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";c=String.format(c,Ff.a.instance.da(1207),"sfd_input","sfd_unshare",eh.a.gu,Ff.a.instance.da(1208));this.Nb.innerHTML=c;this.textBox=new Xc.a(this.getElementById("sfd_input"));this.IOa=new Jc.a(this.textBox.domElement);this.ZQa=Xb.a.create(this.getElementById("sfd_unshare"));this.ZQa.k1(Object(qe.a)(this,this.Qtf,"onUnshareClicked"));this.textBox.text=Ff.a.instance.da(708);this.textBox.enabled=
!1;this.textBox.readOnly=!af.a.ah;this.addButton(1,10);cd.prototype.initialize.call(this)};Ua.prototype.Rfa=function(){var c=this;return function(k,D,ba){var Ba=c.$.ra.ua.Wb(),nb=c.$.ra.ua;k=c.Lha(k);D=c.d$(D);Ba=nb.Na(1,Ba);return Af.i(nb,"ShareForm",Ba,k,D,ba,null,0)}};Ua.prototype.kx=function(c,k,D){this.textBox.text=c.Result;this.textBox.enabled=!0;Yg.DOMElementExtensions.setVisible(this.ZQa.domElement,!0);cd.prototype.kx.call(this,c,k,D)};Ua.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(c){}cd.prototype.setFocus.call(this)};Ua.prototype.Qtf=function(){var c=this.$;this.Yt();var k=new $a(c,1209,1210,1211,function(D,ba,Ba){var nb=c.ra.ua.Wb(),Rb=c.ra.ua;nb=Rb.Na(1,nb);return Af.i(Rb,"UnshareForm",nb,D,ba,Ba,null,0)},16);k.initialize();k.mf()};Ll.Object.defineProperties(Ua.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(te.a)(Ua,"ShareFormDialog",va.a,[]);var Gd=b(657),zd=b(130),pe=b(174),kf=b(252),tf=b(17),Df=Gb.a;Em(Jb,Df);
Jb.prototype.Wc=function(c,k){c=this.$.workbookContext.FullDocumentInfo;switch(k){case 353606613:case -1099009678:case 192430811:return!zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.fa.isNamedObjectViewMode;case 869186573:return k=kf.a()&&this.$.fa.$g.get(5),Cd.a.ma(c.FileSharingUrl)&&!k;case -1570751769:case 1986648902:return 131072!==(this.$.xL&131072);case 330035228:return!(this.V_a(!0)&&this.wxc);case -509039657:return!(this.V_a()&&this.wxc);case 1334518759:return!(this.V_a()&&
this.wxc&&this.boe())}return!1};Jb.prototype.executeCommand=function(c,k,D){c=this.$.workbookContext.FullDocumentInfo;var ba=eg.a.workflow,Ba=ia.TaskExtensions.dm(),nb=k.command;if(nb===ba||-266099===nb)return this.HPh(k,ba,c);switch(nb){case 1986648902:this.QPf();break;case -1570751769:this.uNh(k);break;case 869186573:k=eg.a.Dbj;Ba=wd.AFrameworkApplication.ha.sa("ShareMenuIsEnabled");ba=Bk.a.h6e();nb=null;(zg.EwaSettings.ka(588)||Ba)&&D&&"CopyLink"===D.SourceControlId?(nb={},nb[vg.a.VGb]="copy",
k=eg.a.DQf):Ba&&D&&"ManageAccess"===D.SourceControlId?(nb={},nb[vg.a.VGb]="manageAccess",k=eg.a.Fbj):ba&&D&&"LinkToComment"===D.SourceControlId&&(nb={},nb[vg.a.VGb]="copy",nb[vg.a.FQf]=D.navId,k=eg.a.DQf);Ba=this.UTf(c,nb);pe.c(k);break;case -1099009678:Ba=this.GId(12,c);break;case 192430811:Ba=this.GId(13,c);break;case 353606613:Ba=this.GId(14,c);break;case -59906385:case 1197060601:this.UOh(k,c);break;case 1305810481:this.KXe(!1,k);break;case 330035228:this.KXe(!0,k);break;case -509039657:this.deleteForm();
break;case 1334518759:k.tvb=!0;this.shareForm();break;case 710925581:Yf.a.Df.urc("710925581")&&(Ba=ia.TaskExtensions.Aa(this.gJ.value,function(Rb){Rb.result.Vj(Ih.a.conversation,{})},this.la,3));break;case 327119921:this.lNh();break;default:Ba=u.a(nb)}return Ba};Jb.prototype.Ec=function(c,k){c=!1;k=k.command;if(k===eg.a.workflow)return!0;switch(k){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:c=
!0;break;case 353606613:case -1099009678:case 192430811:c=zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode}return c};Jb.prototype.Yc=function(c,k,D){if("PopulateFormMenu"===k){k=this.wxc?this.boe()?Jb.ojh:Jb.pjh:Jb.Lki;c=this.Sa.Oc();for(var ba=0;ba<k.length;ba++)Array.add(c.buttons,this.Sa.Ab(k[ba]));k=this.Sa.$o("Forms.Flyout");Array.add(k.Bc,c);D.MenuItems=k.pB();return!0}return!1};Jb.prototype.HPh=function(c,k,D){return this.oFd&&
c.command===k?(this.mFd(c,-266099),ia.TaskExtensions.p3()):ia.TaskExtensions.Aa(this.gJ.value,function(ba){lg.a(ba.result,Ih.a.workflow,null,D.WorkflowPostMessage)||gd.HelperMethods.lf(D.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)};Jb.prototype.boe=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.fa.$g.get(26)};Jb.prototype.lNh=function(){var c=Sj.a.create().toString();nd.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+
c);var k=this.$.frame,D=k.M5a,ba=this.$,Ba=new f.QueryStringBuilder(wd.AFrameworkApplication.ha.Ta("TeamsMeetingShareEndpoint"));Ba.Xj("deeplinkId",c);Ba.Xj("lm","deeplink");c=Ba.Xj;var nb=new f.QueryStringBuilder(wd.AFrameworkApplication.ha.Ta("TeamsAppSharingUrl"));nb.Xj("auth","2");nb.Xj("flight","officeunihost");nb.Xj("source","TEAMS-ELECTRON.meetingStage.deeplink");ba={kFj:ae.a.g3(ba.workbookContext.FullDocumentInfo.WorkbookPath),PFj:ba.workbookContext.FullDocumentInfo.WorkbookPath,baseUrl:ba.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl,
fileId:wd.AFrameworkApplication.Fb.ServerDocId};ba=Xa.c(Xa.c(ba));nb.Xj("subEntityId",ba.substring(1,ba.length-1));nb=JSON.stringify({VEj:nb.toString(),appId:wd.AFrameworkApplication.ha.Ta("TeamsAppId")});c.call(Ba,"appContext",nb);D.call(k,Ba.toString(),!0)};Jb.prototype.uNh=function(c){this.oFd?this.mFd(c,1986648902):this.QPf()};Jb.prototype.KXe=function(c,k){!c&&this.$.ya.SurveyRedirectUrl?this.hKi():(c=new ua(this.$,c,k),c.initialize(),c.mf())};Jb.prototype.UOh=function(c,k){var D=this;this.oFd&&
1197060601===c.command?this.mFd(c,-59906385):ia.TaskExtensions.Aa(this.gJ.value,function(ba){ba=ba.result;ba&&lg.a(ba,Ih.a.replyWithChanges,null,D.$.fa.$g.get(8))||(ba=new Sys.StringBuilder(k.ReplyWithChangesUrl),Kh.a.lg(ba,Oj.e,Oj.d),fd.a.ntw(ba.toString(),D.$))},this.la,3)};Jb.prototype.mFd=function(c,k){var D=this,ba=xi.a(this.$).fd.activityState,Ba=new Mj.a(k,c.method,c.mode,c.Ze,c.tabName);Ae.a(this.$).zs(new $e.a(vf.a.ly,5,function(){ba[Jh.a.rq]=vf.a.bKf;ba[Gd.a.fOc]=Ba;D.$.Ck.Px("SocialSharingSaveBeforeCommand");
D.$.Ck.ree(Ba.command)}))};Jb.prototype.QPf=function(){var c=this,k=this.$.ya.DocumentHostInfo;k.HostEmbeddedViewUrl||this.Une?this.OSf():this.$.Qf.get(53)&&ia.TaskExtensions.Aa(this.gJ.value,function(D){c.Htj(D.result)||fd.a.ntw(k.FileEmbedCommandUrl,c.$)},this.la,3)};Jb.prototype.Htj=function(c){return c.isEnabled()&&(this.Tne||(this.Tne=c.xm(Ih.a.Sne,Object(qe.a)(this,this.Roi,"onCanEmbedMessageReceived"))))?c.Vj(Ih.a.Wkh,null):!1};Jb.prototype.Roi=function(){this.Une=!0;this.OSf()};Jb.prototype.OSf=
function(){if(af.a.tr)fd.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var c=new Qb(this.$);c.initialize();c.mf()}};Jb.prototype.deleteForm=function(){var c=this.$,k=new $a(c,1212,1213,1205,function(D,ba,Ba){var nb=c.ra.ua.Wb(),Rb=c.ra.ua;nb=Rb.Na(9,nb);nb.surveyId=null;return Af.i(Rb,"DeleteSurvey",nb,D,ba,Ba,null,0)});k.initialize();k.mf()};Jb.prototype.shareForm=function(){var c=this,k=this.$.workbookContext.FullDocumentInfo;if(this.$.fa.$g.get(26)){var D=new Ua(this.$);D.initialize();D.mf()}else ia.TaskExtensions.Aa(this.gJ.value,
function(ba){var Ba={};lg.a(ba.result,Ih.a.shareForm,(Ba.SurveyTitle=c.$.workbookContext.SurveyTitle,Ba),c.$.fa.$g.get(10))||fd.a.ntw(k.ShareFormCommandUrl,c.$)},this.la,3)};Jb.prototype.hKi=function(){var c=this.$;c.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var k=new Sys.StringBuilder(c.ya.SurveyRedirectUrl);Kh.a.lg(k,"startupDialog","FormEdit");var D=xi.a(this.$),ba=D.fd.activityState;ba[Fh.a.a1]=k.toString();ba[Fh.a.XK]=Fh.a.Gqd;this.$.Ck.Px("SocialSharingEnvironmentChange");
Ae.a(c).zs(new $e.a(vf.a.ly,5,function(){var Ba=Eb.a.gd(3,2,1257,1258,1259,554412057,"FossEnvironmentUnsupported");D.fd.Ss([Ba]);ba[Jh.a.rq]=vf.a.x1f}))};Jb.prototype.V_a=function(c){return(this.$.fa.isEditMode||(void 0===c?!1:c))&&this.$.fa.$g.get(25)&&kf.a()};Jb.prototype.bIh=function(c){var k=void 0===k?null:k;var D=$d.g(this.$).ga;var ba=this.$.va.qa?Uj.d(this.$.va.qa):null;if(!ba)return nd.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",
R[c]),null;14===c?k=this.BHh(D):12===c?(k=D.Lga,k=Cd.a.contains(k,"!",!0)?k.split("!")[1]:k):13===c&&(D=D.wa.selectedRanges,D[0]&&(D=$d.g(this.$).$b.Mk(D[0])))&&(k=D.gj);if(!k)return nd.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",R[c]),null;D={};D[vg.a.VGb]="copy";D[vg.a.FQf]=this.Zyh(c,k,ba);nd.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",
R[c],k,ba);return D};Jb.prototype.BHh=function(c){if(c.Pa.R$&&(c=c.Pa.kc.floatingObject)&&!c.type){var k=c.id.split(".");if(1<k.length)return k[1];nd.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",c.id)}return null};Jb.prototype.Zyh=function(c,k,D){c=btoa(c+"_"+k+"_"+D);c=c.replace(RegExp("\\+","g"),"-");c=c.replace(RegExp("\\/","g"),"_");return c=c.replace(RegExp("\\=+$","g"),"")};Jb.prototype.UTf=function(c,k){var D=
this;return ia.TaskExtensions.Aa(this.gJ.value,function(ba){lg.a(ba.result,Ih.a.sharing,k,D.$.fa.$g.get(5))?nd.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",k?k[vg.a.VGb]:""):gd.HelperMethods.lf(c.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};Jb.prototype.GId=function(c,k){if(!zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1))return null;var D=
this.bIh(c);if(D)return this.UTf(k,D);nd.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",R[c]);return null};Ll.Object.defineProperties(Jb.prototype,{wxc:{configurable:!0,enumerable:!0,get:function(){return Pd.b(this.$.kg)}},oFd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.fa.A6g||this.$.LP)}}});Jb.Lki=[103];Jb.ojh=[107,104,105,106];Jb.pjh=[104,105];Jb.lJg=[new tf.a(vf.a.sre,554412057,
0,0,1260),new tf.a(vf.a.idle,554412057,0,1)];Object(te.a)(Jb,"SocialSharingCommandHandler",Gb.a,[160]);var Cg=Tf.a;Em(ic,Cg);ic.prototype.Gd=function(){var c=this,k=new Kf.a(function(){return Xf.GetServiceTaskFactory.create(c.$.ea,137,c.la,c.rb,"Postmessage.IHostPostmessenger")});ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.create(this.$.ea,102,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),function(D){c.Ad([new Jb(c.$,D.result,k)])},this.la,3)};ic.ja=
function(c){Tf.a.Yd(114,new ic(c))};Object(te.a)(ic,"SocialSharingCommandHandlerFactory",Tf.a,[]);Object(te.a)(wb,"MacroRecorderRangeCustomSortedPayload",null,[115]);var mh=b(1079),ji=b(1080),ki=b(956),bi=b(859),ai=b(197);Aa.prototype.show=function(){var c=new Td.StandardDialog;c.hc=11;c.yc(1,Ff.a.instance.da(2034));c.yc(2,Ff.a.instance.da(2035));c.KTf(Ff.a.instance.da(2033),Ff.a.instance.Ua(645),Object(qe.a)(this,this.sv,"dialogHandler"))};Aa.prototype.sv=function(c){switch(c){case 0:this.ALa("Cancel");
break;case 1:this.ALa("Expand and sort");this.UIe(!0);break;case 2:this.ALa("Just sort"),this.UIe(!1)}};Aa.prototype.ALa=function(c){nd.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",c)};Object(te.a)(Aa,"ExpandSortSelectionDialog",null,[]);tc.isValid=function(c){return Array.contains(tc.Cjh,c.Position)?!0:(nd.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",c.Position),!1)};tc.Cjh=[0,.5,1];Object(te.a)(tc,"FillGradientStopExtension",
null,[]);Object(te.a)(Ec,"GradientLine",null,[]);lc.isValid=function(c){if(!(c.Degree.toString()in lc.Bjh))return nd.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",c.Degree),!1;if(!c.GradientStops)return nd.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(c.GradientStops.length<lc.jii||c.GradientStops.length>lc.Lgi)return nd.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",
c.GradientStops.length),!1;c=Ol(c.GradientStops);for(var k=c.next();!k.done;k=c.next())if(!tc.isValid(k.value))return!1;return!0};lc.jii=2;lc.Lgi=3;var Dh={};lc.Bjh=(Dh["0"]=new Ec(0,0,1,0),Dh["180"]=new Ec(1,0,0,0),Dh["90"]=new Ec(0,0,0,1),Dh["270"]=new Ec(0,1,0,0),Dh["45"]=new Ec(0,0,1,1),Dh["225"]=new Ec(1,1,0,0),Dh["135"]=new Ec(1,0,0,1),Dh["315"]=new Ec(0,1,1,0),Dh);Object(te.a)(lc,"FillGradientExtension",null,[]);var fh=sc.a;Em(Yb,fh);Yb.prototype.Is=function(c,k){if(1===c){var D=Sb.v(this.Jyb,
this.$);$d.g(this.$).ki(D,null,null,null,0,Zj.a.Sjj)}D={};D=(D.DialogButton=c,D.Location="dialog",D);Qi.b(this.$).ee(Qh.a.Ujj,D,null,!0);fh.prototype.Is.call(this,c,k)};Yb.prototype.Lq=function(){fh.prototype.Lq.call(this);var c=this.Rjj();this.hc=1;this.yc(1,Ff.a.instance.da(2138));this.ul(Ff.a.instance.da(2139),Nf.a.yq(c),1,Object(qe.a)(this,this.Is,"standardDialogHandler"))};Yb.prototype.Rjj=function(){return String.format(Ff.a.instance.Bb(164),this.Jyb.toString())};Yb.prototype.F7c=function(){var c=
this.error.Description.split("_");return new Bj.Range(Number.parseInvariant(c[1])+1,Number.parseInvariant(c[2])+1,Number.parseInvariant(c[3])+1,Number.parseInvariant(c[4])+1,!0,!1)};Ll.Object.defineProperties(Yb.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(te.a)(Yb,"SortMergedCellsErrorDialog",sc.a,[]);var li=ki.a;Em(Ra,li);Ra.prototype.dispose=function(){this.Zgd||(this.Zgd=!0,this.xYb(),this.i5=null);li.prototype.dispose.call(this)};Ra.prototype.gZh=
function(c,k){var D=this,ba=this.sUg(c);this.N2a(214,function(Ba,nb,Rb){return Af.G(D.$.ra.ua,ba,D.OXa(Ba,D.mrh(k)),D.NS(nb),Rb,null)},16,!0)};Ra.prototype.mrh=function(c){var k=this;return function(D){if(Ph.b(D,-901005882))xi.a(k.$).fd.lO(-901005882),k.Eyd();else if(Ph.b(D,-569193796))xi.a(k.$).fd.lO(-569193796),k.hide(),new Yb(k.$,D.Errors[0]);else if(Ph.a(D))nd.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),
k.hide();else{D=D.Result;k.$.Mj(D.SortRange);var ba=zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");D&&P(D)&&uc(D)&&zb(D,ba)?c(D):k.l2b(Ra.bob())}}};Ra.prototype.fZh=function(c,k,D){c=Af.F(this.$.ra.ua,k,this.Xrh(k,D),Object(qe.a)(this,this.Tti,"onGetSortConditionColorsOrIconsRequestFailure"),null,c);Array.add(this.i5,c)};Ra.prototype.Xrh=function(c,k){var D=this;return function(ba,Ba){if(D.Zgd)nd.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");
else if(!ba||Ph.a(ba))nd.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",Eb.a.Uc(ba.Errors)),D.$.fa.Jo(ba.Errors),D.hide();else{ba=ba.Result;var nb=c.RangeType,Rb=c.HeaderRowSize,Ic=c.SortTopToBottom;ba&&Zb(ba,c.ConditionType)&&cc(ba,nb,Rb,Ic)?(ba.ColumnInfo.ColumnOffset=Ba,void 0!==ba.HeaderColumnInfo&&null!==ba.HeaderColumnInfo&&(ba.HeaderColumnInfo.ColumnOffset=Ba),k(ba,c.ConditionType,c.SortTopToBottom)):(nd.ULS.sendTraceTag(529105633,
0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),D.l2b(Ra.bob()))}}};Ra.prototype.Tti=function(){nd.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.l2b(Ra.bob())};Ra.prototype.T0c=function(c,k){if(1===c){c=k.sortRangeType;var D={};D.SortOptions=k.sortOptions;D.ShouldRestoreSelection=this.TJd;D.SelectedRange=this.selectedRange;
D.OriginalActiveCell=this.Kjc;D.TopCellAddress=this.PQa;if(this.Tdj(c)){var ba=this.$;this.namedSheetViewPublic.PPa().continueWith(function(Ba){Ba.result&&Ra.vAf(ba,D)})}else Ra.vAf(this.$,D)}else this.TJd&&this.Pma(this.selectedRange,this.Kjc)};Ra.prototype.Tdj=function(c){return!!this.namedSheetViewPublic&&(!c||3===c)};Ra.prototype.sUg=function(c){var k={};k.SelectedRange=this.selectedRange;k.ActiveCell=this.Kjc;k.SortInfoMode=c;k.ExpandSortSelection=this.qHg;k.ExpandSortSelectionSupported=!0;return k};
Ra.prototype.ora=function(c){var k={};k[Bi.a.W1b]=this.sc;k.fromAutoFilter=c.FromAutoFilter;k.gridRTL=$d.g(this.$).rtl;k.activeCell=c.ActiveCell;k.selectedRange=c.SelectedRange;k.invokeGetSortInfo=Object(qe.a)(this,this.gZh,"invokeGetSortInfoAction");k.invokeGetSortConditionColorsOrIcons=Object(qe.a)(this,this.fZh,"invokeGetSortConditionColorsOrIconsAction");k.highlightSortRange=Object(qe.a)(this,this.URh,"highlightSortRangeAction");k.getColorName=Object(qe.a)(this,this.getColorName,"getColorName");
return k};Ra.prototype.URh=function(c,k){this.TJd=!0;this.Pma(c,k)};Ra.prototype.Pma=function(c,k){c=Sb.D(c);this.ga.wa.Nd.equals(c)||this.ga.updateSelection(c,Sb.C(k),0,void 0,void 0,void 0,!0)};Ra.prototype.getColorName=function(c){return bi.a.sIa(ai.a.eG(c))};Ra.prototype.Eyd=function(){var c=this;(new Aa(function(k){var D={};D.ActiveCell=c.Kjc;D.SelectedRange=c.selectedRange;D.ExpandSelection=k;D.FromAutoFilter=!1;k={};c.$.De(-207540907,Xd.a.Tb,8,(k.SortCommandData=D,k))})).show()};Ra.prototype.xYb=
function(){if(void 0!==this.i5&&null!==this.i5)for(var c=Ol(this.i5),k=c.next();!k.done;k=c.next())this.$.ra.ua.Fbb(k.value.Tt)};Ra.vAf=function(c,k){var D={};c.De(1659552324,Xd.a.Tb,8,(D.CustomSortCommandData=k,D))};Ra.bob=function(){return Eb.a.gd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Ll.Object.defineProperties(Ra.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ga:{configurable:!0,enumerable:!0,get:function(){return $d.g(this.$).ga}}});Object(te.a)(Ra,
"CustomSortDialog",ki.a,[]);Wa.prototype.getSelection=function(){return this.selection};Object(te.a)(Wa,"MacroRecorderAutoFilterToggledPayload",null,[115]);lb.prototype.getSelection=function(){return this.selection};Object(te.a)(lb,"MacroRecorderRangeAutoFilterClearedPayload",null,[115]);Object(te.a)(ha,"MacroRecorderRangeFilterReappliedPayload",null,[115]);var sh=b(910),Rh=b(911);kb.prototype.Wc=function(c,k){return!this.E5h(c,k)};kb.prototype.executeCommand=function(c,k,D){c=null;var ba=k.command;
switch(ba){case -864298118:c=this.F4g(k,D);break;case -1010737776:c=this.w1c(!0,k,D);break;case 2123420468:c=this.w1c(!1,k,D);break;case -207540907:case -1677817820:c=this.gridView.$b.baa(this.gridView.ga.wa.activeCell)?this.iKi():this.fKi(k,D);break;case 1659552324:c=this.C4g(k,D);break;case 368460465:c=this.R4g(k);break;case 529856798:c=this.A4g(k);break;case 644342024:c=this.N4g(k)}return c||u.a(ba)};kb.prototype.Ec=function(c,k){if(c=1===c)switch(k.command){case -864298118:case -1010737776:case 2123420468:case 368460465:case 529856798:case 1659552324:case 644342024:case -207540907:case -1677817820:break;
default:c=!1}return c};kb.prototype.Yc=function(){return!1};kb.prototype.ga=function(){return this.$&&this.gridView?this.gridView.ga:null};kb.prototype.ZCf=function(c){c?this.gridView.uq(Object(qe.a)(this,this.onContentReady,"onContentReady")):this.gridView.Cs(Object(qe.a)(this,this.onContentReady,"onContentReady"));this.S3e=c};kb.prototype.Vej=function(c){return!!this.sortOptions&&Cd.a.equals(this.kaf,c.Lga,!0)};kb.prototype.E5h=function(c,k){var D=$d.g(this.$).ga.wa.selectedRanges;return(new Cj.a(this.$.va)).Tn(c,
k,D,this.gridView)};kb.prototype.w1c=function(c,k,D){var ba={OperationType:0};ba.IsAscending=c;ba.HasHeader=!0;ba.GuessHeader=!0;ba.SortTopToBottom=!0;ba.ExpandSortSelectionSupported=!0;D&&void 0!==D[kb.zab]&&null!==D[kb.zab]?(D=D[kb.zab],ba.ActiveCell=D.ActiveCell,ba.SelectedRange=D.SelectedRange,ba.ExpandSortSelection=D.ExpandSelection):(ba.ActiveCell=Sb.o(this.ga().wa.activeCell,this.$),ba.SelectedRange=Sb.v(this.ga().wa.Nd,this.$),ba.ExpandSortSelection=null);return this.jkd([Sb.D(ba.SelectedRange)])?
this.gridView.$b.baa(Sb.D(ba.SelectedRange))?this.K4g(c):this.R2e(ba,k):ia.TaskExtensions.dm()};kb.prototype.F4g=function(c,k){var D=null,ba=this.ga();ba&&(this.Vej(ba)?this.jkd(ba.wa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,D=this.R2e(this.sortOptions,c)):D=this.w1c(!0,c,k));return D};kb.prototype.jkd=function(c){return zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&this.$.isEditMode?this.$.Xs(c,!0,1):!0};kb.prototype.K4g=
function(c){this.ZEh(c);return Ie.Task.Ra(!0)};kb.prototype.ZDg=function(c){if(zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var k=this.gridView.$b.Mk(this.ga().wa.Nd,!1);if(k){var D=k.name;k=k.usedRange;k=this.ga().wa.activeCell.left-k.left;return new ji.a(D,k,c.IsAscending)}}return new mh.a(c)};kb.prototype.R2e=function(c,k){function D(){return ba.ZDg(c)}var ba=this;this.gridView.wi.PF(!1);return this.hDe(function(Ba,nb,Rb){return Tb(ba.$.ra.ua,c,Fd.b(Ba,
Object(qe.a)(ba,ba.Uzi,"onSortSuccessCallback")),nb,Rb,c)},function(Ba){return new Ne.a(141,0,Ba,void 0,D)},k,this.Sdj(c))};kb.prototype.Sdj=function(c){if(!this.namedSheetViewPublic)return!1;var k=this.ga().wa.Nd,D=Sb.v(this.ga().wa.Nd,this.$),ba=this.gridView.$b.zKa(k,!0),Ba=this.ga().wa.lva()&&this.gridView.$b.z7e(D),nb=this.gridView.$b.T4h(D);c=!k.faa&&!k.c4||k.isSingle||null!=c.ExpandSortSelection?c.ExpandSortSelection&&this.gridView.$b.z7e(D):!1;return ba||Ba||nb||c};kb.prototype.iKi=function(){return this.$.De(-1556797033,
Xd.a.Tb,8,null)};kb.prototype.fKi=function(c,k){c=8===c.Ze&&k&&void 0!==k[kb.zab]&&null!==k[kb.zab]?k[kb.zab]:19===c.Ze&&k&&void 0!==k[Xd.a.Hj]&&null!==k[Xd.a.Hj]?Mg.a.Xh(k[Xd.a.Hj]):this.uTg();if(!this.jkd([Sb.D(c.SelectedRange)]))return ia.TaskExtensions.dm();$d.g(this.$).wi.PF(!1);var D=null;zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5770108_PTPSOnReactCustomSort")&&(k=k.TopCellAddress)&&(D=Sb.o(k,this.$));new Ra(this.$,c,this.namedSheetViewPublic,D);return Ie.Task.Ra(!0)};kb.prototype.C4g=
function(c,k){function D(){return new wb(Rb.SortOptions)}function ba(){Rb.ShouldRestoreSelection&&nb.Pma(Rb.SelectedRange,Rb.OriginalActiveCell);nd.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",c.Ze)}function Ba(){Rb.ShouldRestoreSelection&&nb.Pma(Rb.SelectedRange,Rb.OriginalActiveCell);nd.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",c.Ze);
if(zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5770108_PTPSOnReactCustomSort")){if(Rb.TopCellAddress)var Ic=Sb.C(Rb.TopCellAddress);else Ic=Rb.OriginalActiveCell,Ic=new Bj.Range(Ic.FirstRow+1,Ic.FirstColumn+1,Ic.FirstRow+1,Ic.FirstColumn+1,!0,!1);nb.$Q(Ic)}}var nb=this,Rb=k[kb.EZg];return rf.a(this.$.userOperationManager,function(Ic,Wc,Rd){return Tb(nb.$.ra.ua,Rb.SortOptions,Fd.b(Ic,Ba),Fd.a(Wc,ba),Rd,nb.sortOptions)},function(Ic){return new Ne.a(187,0,Ic,void 0,D)},null)};kb.prototype.Pma=function(c,
k){c=Sb.D(c);$d.g(this.$).ga.wa.Nd.equals(c)||$d.g(this.$).ga.updateSelection(c,Sb.C(k),0,void 0,void 0,void 0,!0)};kb.prototype.uTg=function(){var c={};c.ActiveCell=Sb.o(this.ga().wa.activeCell,this.$);c.SelectedRange=Sb.v(this.ga().wa.Nd,this.$);c.FromAutoFilter=!1;c.ExpandSelection=null;return c};kb.prototype.R4g=function(c){function k(){return new Wa(ba)}var D=this,ba=this.dIa();if(!ba)return Ie.Task.Ra(!1);var Ba=this.$.ra.ua.Wb();return zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,function(nb,
Rb,Ic){return qb(D.$.ra.ua,ba,sh.a.Hta(wa.a.SWa,Rh.a.toggleAutoFilter,nb),Rb,Ic,null,Ba)},function(nb){return new Ne.a(516,0,nb,64,k)},c):rf.a(this.$.userOperationManager,function(nb,Rb,Ic){return qb(D.$.ra.ua,ba,sh.a.Hta(wa.a.SWa,Rh.a.toggleAutoFilter,nb),Rb,Ic,null,Ba)},function(nb){return new jj.a(516,0,nb,void 0,k)},c)};kb.prototype.A4g=function(c){function k(){return new lb(ba)}var D=this,ba=this.dIa();if(!ba)return Ie.Task.Ra(!1);var Ba=this.gridView.$b.Mk(this.ga().wa.Nd,!0);Ba&&nd.ULS.sendTraceTag(537151574,
0,50,"DoClearAutoFilter for namedObject: Type : {0}",Ba.type.toString());var nb=this.$.ra.ua.Wb();Ba=zg.EwaSettings.pc()?function(Rb){return new Ne.a(517,0,Rb,64,k)}:function(Rb){return new jj.a(517,0,Rb,void 0,k)};return this.hDe(function(Rb,Ic,Wc){var Rd=D.$.ra.ua;Rb=sh.a.Hta(wa.a.oEa,Rh.a.clearAutoFilter,Rb);var Ge=Rd.Na(41,void 0===nb?null:nb);Ge.selectedRange=ba;return Af.i(Rd,"ClearAutoFilter",Ge,Rb,Ic,Wc,null,0)},Ba,c,!!this.namedSheetViewPublic)};kb.prototype.hDe=function(c,k,D,ba){var Ba=
this;return ba?this.namedSheetViewPublic.PPa().continueWith(function(nb){nb.result&&rf.a(Ba.$.userOperationManager,c,k,D)}):rf.a(this.$.userOperationManager,c,k,D)};kb.prototype.N4g=function(c){function k(){return new ha(ba)}var D=this,ba=this.dIa();if(!ba)return Ie.Task.Ra(!1);var Ba=this.$.ra.ua.Wb();return zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,function(nb,Rb,Ic){return Ia(D.$.ra.ua,ba,sh.a.Hta(wa.a.oEa,Rh.a.UAf,nb),Rb,Ic,null,Ba)},function(nb){return new Ne.a(518,0,nb,64,k)},c):
rf.a(this.$.userOperationManager,function(nb,Rb,Ic){return Ia(D.$.ra.ua,ba,sh.a.Hta(wa.a.oEa,Rh.a.UAf,nb),Rb,Ic,null,Ba)},function(nb){return new jj.a(518,0,nb,void 0,k)},c)};kb.prototype.Uzi=function(c,k){Ph.b(c,-901005882)?(xi.a(this.$).fd.lO(-901005882),this.Eyd(k)):Ph.b(c,-569193796)?(xi.a(this.$).fd.lO(-569193796),new Yb(this.$,c.Errors[0])):!Ph.a(c)&&c.Result&&(this.sortOptions=k,this.Rsc=Sb.D(c.Result.ActualSortRange),this.kaf=this.ga().Lga,this.S3e||(this.selectedRange=this.ga().wa.Nd,this.selectedRange.equals(this.Rsc)||
this.cij()),this.sortOptions&&this.sortOptions.ActiveCell&&(c=this.sortOptions.ActiveCell,c=new Bj.Range(c.FirstRow+1,c.FirstColumn+1,c.FirstRow+1,c.FirstColumn+1,!0,!1),this.$Q(c),this.mPd(c)))};kb.prototype.Eyd=function(c){var k=this;(new Aa(function(D){var ba={};ba.ActiveCell=c.ActiveCell;ba.SelectedRange=c.SelectedRange;ba.ExpandSelection=D;D={};k.$.De(c.IsAscending?-1010737776:2123420468,Xd.a.Tb,8,(D.SortCommandData=ba,D))})).show()};kb.prototype.cij=function(){var c=this.ga();c.updateSelection(this.Rsc,
c.wa.activeCell,0,void 0,void 0,void 0,!0);this.ZCf(!0)};kb.prototype.onContentReady=function(){this.ZCf(!1);var c=this.ga();c.wa.xh&&c.wa.Nd.equals(this.Rsc)&&c.updateSelection(this.selectedRange,c.wa.activeCell,0,void 0,void 0,void 0,!0)};kb.prototype.dIa=function(){var c=this.ga();if(!c)return nd.ULS.shipAssertTag(537151573,0,!!c,"SelectionManger is null"),null;this.gridView.wi.PF(!1);return Sb.v(c.wa.Nd,this.$)};kb.prototype.mGb=function(){this.Tc&&this.Tc.so&&(this.Rf=this.Tc.so,this.xb=this.Tc.m7b())};
kb.prototype.ZEh=function(c){var k=this;if(this.$.isEditMode&&(this.Tc=this.gridView.$b.Up(this.gridView.ga.wa.activeCell))){this.activeCell=Sb.o(this.gridView.ga.wa.activeCell,this.$);if(this.Tc&&this.Tc.so){var D=this.Tc.so.CurrentCol;if(this.Tc.so.CurrentRow===this.activeCell.FirstRow&&D===this.activeCell.FirstColumn){this.mGb();this.applyPivotSort(c);return}}this.$.ra.ua.Wb();D=new Ne.a(228,0,function(ba,Ba,nb){return Af.B(k.$.ra.ua,k.activeCell,Fd.b(ba,Object(qe.a)(k,k.Bti,"onGetPivotTableContextAndApplySortSuccessCallback")),
Fd.a(Ba,Object(qe.a)(k,k.Ati,"onGetPivotTableContextAndApplySortFailedCallback")),nb,c)},16);this.$.userOperationManager.jc(D,null)}};kb.prototype.Bti=function(c,k){c&&!Eb.a.Zg(c.Errors)&&this.Tc&&(this.Tc.so=c.Result,this.mGb(),this.applyPivotSort(k))};kb.prototype.Ati=function(){};kb.prototype.applyPivotSort=function(c){var k=this;if(this.Tc&&this.xb&&this.activeCell&&this.Rf){var D=8===this.Rf.CellArea,ba=1===this.Rf.CellArea||2===this.Rf.CellArea;(D||ba)&&8!==this.Rf.CellType&&4!==this.Rf.CellType&&
(D?rf.a(this.$.userOperationManager,function(Ba,nb,Rb){return Af.e(k.$.ra.ua,k.activeCell,c?1:2,k.xb.Caption,Ba,nb,Rb,null)},function(Ba){return new Ne.a(1015,0,Ba,void 0,null)},null):(D=1===this.Rf.CellArea?1:2,this.$.ka(739)?fd.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,this.xb.Index.toString(),this.xb.Caption,this.Tc.isOlap?"":this.xb.Caption,D,c):fd.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,
this.xb.Index.toString(),c)))}};kb.prototype.$Q=function(c){zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.Va(this.$.ea,430,431,1,"Microsoft.Office.Excel.WebUI.Client.PivotTableHandRaise.IPivotTableHandRaiseManager"),function(k){k.result.Ema(c);nd.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};kb.prototype.mPd=function(c){zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1)&&ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.Va(this.$.ea,476,475,0,"Microsoft.Office.Excel.WebUI.Client.ProactiveSuggestion.IProactiveSuggestionManager"),function(k){k.result.mPd(c,0);nd.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,3)};kb.EZg="CustomSortCommandData";kb.zab="SortCommandData";Object(te.a)(kb,"SortCommandHandler",null,[160]);var Di=Tf.a;Em(Na,Di);Na.prototype.Gd=function(){var c=this;ia.TaskExtensions.Aa(Xf.GetServiceTaskFactory.Va(this.$.ea,
309,310,this.rb,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewPublic"),function(k){c.Ad([new kb(c.$,k.result)])},this.$.la,3)};Na.ja=function(c){Tf.a.Yd(160,new Na(c))};Object(te.a)(Na,"SortCommandHandlerFactory",Tf.a,[]);db.prototype.VXg=function(c,k){new Yb(c,k)};Object(te.a)(db,"SortUtil",null,[663]);var Oi=Me.a;Em(eb,Oi);eb.prototype.create=function(){var c=this.$.ea.Ba(446);c||(c=new db(this.$),this.$.ea.Ia(446,c));this.Eb(c)};eb.ja=function(c){c.ea.Ia(447,new eb(c))};Object(te.a)(eb,
"SortUtilFactory",Me.a,[]);Fa.prototype.executeCommand=function(c,k,D){return 2!==this.pi.Ge(eg.a.tryOfficeThroughTellMe,2,D)?Ie.Task.Ra(!0):u.a(k.command)};Fa.prototype.Ec=function(c,k){return 215809929===k.command};Fa.prototype.Yc=function(){return!1};Fa.prototype.Wc=function(){return!1};Object(te.a)(Fa,"TryOfficeThroughTellMeCommandHandler",null,[160]);var Sh=Tf.a;Em(Ga,Sh);Ga.prototype.Gd=function(){this.Ad([new Fa(wd.AFrameworkApplication.Hb)])};Ga.ja=function(c){Tf.a.Yd(207,new Ga(c))};Object(te.a)(Ga,
"TryOfficeThroughTellMeCommandHandlerFactory",Tf.a,[]);var ei=b(154);Ha.HL=function(){return oa.a.$i(Ha.Jj,ei.a.Ua(433))};Ha.Jj="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(te.a)(Ha,"NamedSheetViewTeachingDialogHtml",
null,[]);var yi=Bi.a;Em(mb,yi);mb.prototype.Eh=function(){this.hc=4;this.stopwatch=this.$.Vb.Dc("UserAction",this.sc);var c=Ff.a.instance.da(1830);this.tf=Ha.HL();this.xo=new ff.a;this.initializeAndShow(c,Object(qe.a)(this,this.Wji,"namedSheetViewTeachingDialogHandler"),{});return this.xo.task};mb.prototype.Wji=function(c){var k=this;if(1===c)this.$.Ka.Ub(new Mj.a(-2050946363,Xd.a.Tb,2,8,null)).continueWith(function(ba){k.xo.setResult(!qa.a(ba)&&ba.result)}),c="Yes";else{var D=2===c;this.xo.setResult(D);
c=2===c?"No":"Close";D&&this.EIi()}this.rdi(c);this.hide()};mb.prototype.Eu=function(c){yi.prototype.Eu.call(this,c);this.yc(1,Ff.a.instance.da(1832));this.yc(2,Ff.a.instance.Ua(446))};mb.prototype.EIi=function(){this.$.fa.Ogc=!1};mb.prototype.rdi=function(c){var k={};k.a=this.$.ya.UserSessionId;k.b="NamedSheetViewTeachingDialogClose";k.c=c;k.e=!0;this.stopwatch&&(this.stopwatch.stop(),k.d=this.stopwatch.Cc);jg.b().Je(53,k,!0)};Ll.Object.defineProperties(mb.prototype,{sc:{configurable:!0,enumerable:!0,
get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(te.a)(mb,"NamedSheetViewTeachingDialog",Bi.a,[]);var Si=b(188);Ka.prototype.PPa=function(){if(this.sej()){if(zg.EwaSettings.ka(615)){this.$.va.qa.Ke.WJd=!0;var c=new ff.a;this.$.Ka.Ub(new Mj.a(-2050946363,Xd.a.Tb,2,0,null)).continueWith(function(k){c.setResult(!qa.a(k)&&k.result)});return c.task}return(new mb(this.$)).Eh()}return Ie.Task.Ra(!0)};Ka.prototype.sej=function(){var c=this.$.va.qa;return this.$.fa.Y5a&&this.$.fa.Ogc&&!c.Ke.YB&&
this.$.fa.uL&&!Si.d(this.$)};Object(te.a)(Ka,"NamedSheetViewPublic",null,[664]);var Uh=Me.a;Em(ta,Uh);ta.prototype.create=function(){this.Eb(this.$.ea.Ba(309)||new Ka(this.$))};ta.ja=function(c){c.ea.Ia(310,new ta(c))};Object(te.a)(ta,"NamedSheetViewPublicFactory",Me.a,[]);var pj=b(1295),hi=b(986),Vh=b(578);Object(te.a)(ea,"NamedSheetViewTeachingCalloutContent",null,[]);Ll.Object.defineProperties(ab.prototype,{LNd:{configurable:!0,enumerable:!0,get:function(){return this.rae}},pKi:{configurable:!0,
enumerable:!0,get:function(){if(this.LNd<this.cYf.count){var c;return this.cYf.oa((this.rae=(c=this.LNd)+1,c))}return null}}});Object(te.a)(ab,"NamedSheetViewTeachingCalloutList",null,[]);var zh=b(1167);Ya.prototype.XUh=function(c){var k=this;this.bYf=c;var D=Object.assign(new fi.a,{});Ya.O1h(c)?(D.add(new ea(Ff.a.instance.Ua(435),Ff.a.instance.Ua(436),Ff.a.instance.da(1860),function(){k.YG(2,"Continue");k.JB(!0)},Ff.a.instance.da(1861),function(){k.JB();k.YG(1,"ExitGuide")},zh.a())),1===c&&D.add(new ea(Ff.a.instance.da(1862),
Ff.a.instance.Ua(438),Ff.a.instance.da(1860),function(){k.YG(2,"FirstEnterTempViewContinueSecond");k.JB(!0)},Ff.a.instance.da(1861),function(){k.JB();k.YG(1,"FirstEnterTempViewExitGuideSecond")},zh.a())),D.add(new ea(Ff.a.instance.Ua(439),Ff.a.instance.Ua(440),Ff.a.instance.da(1860),function(){k.YG(2,"FirstEnterExitCalloutContinue");k.JB(!0)},Ff.a.instance.da(1861),function(){k.JB();k.YG(1,"FirstEnterExitCalloutGuide")},Ya.rSe())),D.add(new ea(Ff.a.instance.da(1863),Ff.a.instance.Ua(437),Ff.a.instance.da(1864),
function(){k.uTf();k.JB();k.YG(1,"LearnMore")},Ff.a.instance.da(1865),function(){k.JB();k.YG(1,"Done")},Ya.qSe()))):2===c?D.add(new ea(Ff.a.instance.da(1862),Ff.a.instance.Ua(438),Ff.a.instance.da(1859),function(){k.JB();k.YG(1,"EnterTempViewAfterPersistedView")},null,null,zh.a())):3===c&&(D.add(new ea(Ff.a.instance.Ua(435),Ff.a.instance.da(1871),Ff.a.instance.da(1860),function(){k.YG(2,"AutoOptInExitCalloutContinue");k.JB(!0)},Ff.a.instance.da(1861),function(){k.JB();k.YG(1,"AutoOptInExitGuide")},
Ya.rSe())),D.add(new ea(Ff.a.instance.da(1862),Ff.a.instance.Ua(438),Ff.a.instance.da(1860),function(){k.YG(2,"Continue");k.JB(!0)},Ff.a.instance.da(1861),function(){k.JB();k.YG(1,"ExitGuide")},zh.a())),D.add(new ea(Ff.a.instance.da(1863),Ff.a.instance.Ua(437),Ff.a.instance.da(1864),function(){k.uTf();k.JB();k.YG(1,"LearnMore")},Ff.a.instance.da(1865),function(){k.JB();k.YG(1,"Done")},Ya.qSe())));this.MNd=new ab(D)};Ya.prototype.uTf=function(){var c=new Mj.a(-859308420,Xd.a.Tb,this.$.dd,9,null),k=
{};k=(k.CommandValueId="HelpID=SheetViews",k.InputMethod=Xd.a.Tb,k.MenuItemId=Ac.a.AY,k.ShouldCanvasTakeFocus=!0,k);this.$.Ka.Ub(c,k)};Ya.prototype.show=function(c){this.XUh(c);this.gab()};Ya.prototype.a9i=function(c){this.fWb=c};Ya.prototype.gab=function(){var c=this,k=this.MNd.pKi;if(k){var D=Object.assign(new pj.a,{label:k.PIi,onExecute:k.primaryButtonAction}),ba=null;k.zLf&&(ba=Object.assign(new pj.a,{label:k.zLf,onExecute:k.secondaryButtonAction}));k=Object.assign(new hi.a,{target:k.targetObject,
content:k.body,title:k.title,showCloseIcon:!0,primaryButtonProps:D,secondaryButtonProps:ba,useTeachingStyles:!0});k=this.fWb.callout(k);D=Object.assign(new Vh.a,{onShow:function(){c.YG(0)}});this.cuc=this.fWb.addNotification(k,D);this.hRc||(this.$.akd=!0)}};Ya.prototype.dismiss=function(){this.JB();this.YG(1,"DismissedByOthers")};Ya.prototype.JB=function(c){c=void 0===c?!1:c;this.cuc&&(this.hRc||(this.$.akd=!1),this.fWb.removeNotification(this.cuc),this.cuc=null);c&&this.gab()};Ya.prototype.YG=function(c,
k){var D={};D.a=this.$.ya.UserSessionId;D.b=this.bYf;D.c=this.MNd.LNd;D.d=c;D.e=void 0===k?null:k;c?(this.stopwatch&&(this.stopwatch.stop(),D.f=this.stopwatch.Cc,this.stopwatch=null),2===c&&(this.stopwatch=this.$.Vb.Dc("UserAction","ShowNamedSheetViewTeachingCalloutNext"))):this.stopwatch=this.$.Vb.Dc("UserAction","ShowNamedSheetViewTeachingCallout");jg.b().Je(52,D,!0)};Ya.qSe=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};Ya.rSe=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};
Ya.O1h=function(c){return!c||1===c};Object(te.a)(Ya,"NamedSheetViewTeachingCallout",null,[661]);var pi=Me.a;Em(xb,pi);xb.prototype.create=function(){var c=this.$.ea.Ba(322);c||(c=new Ya(this.$),zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.ea.Ia(322,c));this.Eb(c)};xb.ja=function(c){c.ea.Ia(323,new xb(c))};Object(te.a)(xb,"NamedSheetViewTeachingCalloutFactory",Me.a,[]);var Ei=b(100),Wi=b(170),kj=b(1168),zj=b(85),Hj=b(1058),hj=Td.StandardDialog;Em(pb,hj);pb.prototype.dP=function(){this.hc=
5;this.width=40;var c=document.createElement("span");c.id=this.Yh("DirectPrintHeaderContent");var k=document.createElement("span");k.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(k,"DirectPrintHeader");this.dO=document.createElement("iframe");this.dO.name="pdfObjectFrame";this.dO.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.dO.onload=Object(qe.a)(this,this.aJi,"printablePdfLoaded");if(this.fSb&&0<this.fSb.count){var D=xe.a.R$c(this.RQb,this.fSb),ba=xe.a.JBd(this.RQb,
this.fSb);this.Gl=document.createElement("form");this.Gl.id="printPreviewPostForm";this.Gl.method="POST";this.Gl.target=this.dO.name;this.Gl.action=ba;D=Ol(D);for(ba=D.next();!ba.done;ba=D.next()){ba=ba.value;var Ba=document.createElement("input");Ba.type="hidden";Ba.name=ba.key;Ba.value=ba.value;this.Gl.appendChild(Ba)}}else this.dO.setAttribute("src",this.RQb);Sys.UI.DomElement.addCssClass(this.dO,Wi.a.y5d);this.zdg?(Sys.UI.DomElement.addCssClass(this.dO,"DirectPrintPdfObjectHidden"),k.innerText=
CommonUIStrings.l_DirectPrintDialogSuccessText,Bh.a.oh(this.dO,Bh.a.mB,Bh.a.hj)):(Sys.UI.DomElement.addCssClass(this.dO,"DirectPrintPdfObject"),this.Im.push(this.dO));c.appendChild(k);c.appendChild(document.createElement("br"));c.appendChild(this.dO);this.Gl&&c.appendChild(this.Gl);c.appendChild(document.createElement("br"));c.appendChild(this.tPg(this.Gl?"#":this.RQb));this.Mib.start();this.Kyb(CommonUIStrings.l_AppTitle,null,null,null,null,c);this.OV(this.Yh("DirectPrintHeaderContent"));this.Gl&&
this.Gl.submit();this.hUg();nd.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};pb.prototype.tPg=function(c){var k=document.createElement("span"),D=document.createElement("span");D.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;k.appendChild(D);wd.AFrameworkApplication.ha&&(2===wd.AFrameworkApplication.xa.Xa.Tk&&wd.AFrameworkApplication.ha.sa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===wd.AFrameworkApplication.xa.Xa.Tk&&wd.AFrameworkApplication.ha.sa("XLODisableDirectPrintDialogOpenPDFLink"))?
(c=document.createElement("span"),2===wd.AFrameworkApplication.xa.Xa.Tk?c.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===wd.AFrameworkApplication.xa.Xa.Tk&&(c.innerText=CommonUIStrings.l_InternalError_Directive,nd.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.aoa=c,k.appendChild(document.createElement("br")),k.appendChild(c)):(D=document.createElement("a"),D.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,D.href=c,D.target=
"_blank",D.id="PrintPDFLink",D.className="AllowBrowserClick",this.aoa=D,k.appendChild(document.createElement("br")),k.appendChild(D),this.Gl&&yb.a.addHandler(D,"click",Object(qe.a)(this,this.rjc,"onSubmit")),this.$N.pa(Sf.a.click,this.aoa,Object(qe.a)(this,this.cBe,"downloadPDFLinkClicked"),null));this.Im.push(this.aoa);return k};pb.prototype.rjc=function(c){this.Gl&&(this.Gl.target="_blank",this.Gl.submit());c.preventDefault()};pb.prototype.hUg=function(){if(0<this.Im.length){var c=new kj.a(this.Im),
k=Ei.FocusManager.instance().wP();k&&(this.aoa.focus(),k.$e=c,k.lZ=!0)}};pb.prototype.cBe=function(){nd.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};pb.prototype.rnd=function(){nd.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};pb.prototype.aJi=function(){nd.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Mib&&this.Mib.stop()};pb.prototype.dispose=function(){this.aoa&&(this.$N.za(Sf.a.click,
this.aoa,Object(qe.a)(this,this.cBe,"downloadPDFLinkClicked")),this.aoa=null);zj.a.VZ(this.dO);this.dO=null;hj.prototype.dispose.call(this)};Object(te.a)(pb,"DirectPrintDialog",Td.StandardDialog,[716]);ib.prototype.oyh=function(c,k,D){return new pb(this.$N,c,k,void 0===D?null:D)};Object(te.a)(ib,"DirectPrintDialogFactory",null,[698]);Em(Pa,Eg);Pa.prototype.hcf=function(){nd.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};Pa.prototype.jcf=function(){wd.AFrameworkApplication.Cm.yub(9540);
nd.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};Pa.prototype.rnd=function(){nd.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Ll.Object.defineProperties(Pa.prototype,{j0e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},tOd:{configurable:!0,enumerable:!0,get:function(){return Pa.lRa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},OLa:{configurable:!0,enumerable:!0,get:function(){return Pa.lRa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},
lQc:{configurable:!0,enumerable:!0,get:function(){var c=[];Array.add(c,CommonUIStrings.l_PrintDialogCanCloseDocument);Eg.Vtb&&Array.add(c,CommonUIStrings.l_DirectPrintDialogFallbackSuggestion);return Pa.lRa?c:null}},Gec:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Fec:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},
d_c:{configurable:!0,enumerable:!0,get:function(){return wd.AFrameworkApplication.nze?"UIFontDialogTextLarge":null}}});Ll.Object.defineProperties(Pa,{lRa:{configurable:!0,enumerable:!0,get:function(){return!!wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.xa.Xa.qu&&wd.AFrameworkApplication.ha.sa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(af.a.$z||af.a.jf||af.a.uf||af.a.Y3a)&&wd.AFrameworkApplication.ha.sa("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(te.a)(Pa,
"PrintDialogWithLinkToPdf",Eg,[]);xa.Z0c=",";Object(te.a)(xa,"DirectPrintBrsSettings",null,[]);Object(te.a)(ma,"DirectPrintProbeResults",null,[]);na.prototype.start=function(){};na.prototype.XKi=function(){var c=Array(this.HB.rQa.length);if(void 0!==this.ehb&&null!==this.ehb)for(var k=0;k<this.HB.rQa.length;k++)c[k]=this.HB.rQa[k]in this.ehb&&this.Aeg(this.ehb[this.HB.rQa[k]]);return c};na.prototype.YKi=function(){for(var c=Array(this.HB.sQa.length),k=!(void 0===this.ZHc||null===this.ZHc),D=0;D<this.HB.sQa.length;D++){var ba=
this.HB.sQa[D];c[D]=k&&ba in this.ZHc?!0:this.ffg(ba)}return c};na.prototype.dJh=function(){for(var c=this.XKi(),k=Array(c.length),D=0;D<c.length;D++)k[D]=c[D]?this.dkh(this.ehb[this.HB.rQa[D]]):null;return k};na.prototype.dkh=function(c){if(void 0===c||null===c)return null;c=c.enabledPlugin;return void 0===c||null===c?null:c.name};na.prototype.KFh=function(){for(var c=this.dJh(),k=this.YKi(),D={},ba={},Ba=0;Ba<this.HB.rQa.length;Ba++)D[this.HB.rQa[Ba]]=c[Ba];for(c=0;c<this.HB.sQa.length;c++)ba[this.HB.sQa[c]]=
k[c];return new ma(D,ba)};na.prototype.ffj=function(){return this.mfg||!this.HB.isEnabled||wd.AFrameworkApplication.isUnifiedHostMode?!1:this.fnj()};na.prototype.Xrc=function(){if(null!=this.yTb)return this.yTb;var c=na.w4e(this.HB);return this.yTb=this.HB.x4e&&c||this.X_h()};na.prototype.X_h=function(){return af.a.Co&&this.HB.Y_h&&af.a.gqe>=this.HB.EKg?!0:!1};na.prototype.fnj=function(){if(!this.gfg(this.HB))return!1;var c=Gf.a.tbd(this.vJc.value.dXf);c=Ol(c);for(var k=c.next();!k.done;k=c.next())if(k=
k.value,void 0!==k&&null!==k)return!0;c=Gf.a.tbd(this.vJc.value.sQa);c=Ol(c);for(k=c.next();!k.done;k=c.next())if(k.value)return!0;return!1};na.prototype.hQh=function(){var c=Gf.a.tbd(this.vJc.value.dXf);c=Ol(c);for(var k=c.next();!k.done;k=c.next())if(ja.a.contains(this.HB.qTh,k.value))return!0;return!1};na.prototype.ITf=function(c){var k=void 0===k?!1:k;var D=void 0===D?null:D;wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.ha.sa("DirectPrintDialogAsStandardDialogIsEnabled")?this.o3d(c,D):
this.ffj()?this.I3g(c,this.hQh()&&!k,D):this.o3d(c,D)};na.prototype.I3g=function(c,k,D){D=void 0===D?null:D;var ba=this.pkg.Dc("UserAction","OpenDirectPrintDialog");this.OSa.oyh(c,k,D).dP();ba.stop()};na.J8e=function(c){try{return new ActiveXObject(c),!0}catch(k){nd.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",c)}return!1};na.y4e=function(c){return void 0===c||null===c?!1:!(void 0===c.enabledPlugin||null===c.enabledPlugin)};na.create=function(c){var k=new xa(wd.AFrameworkApplication.ha.appSettings),
D=null;try{D=window.navigator.mimeTypes}catch(Rd){nd.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var ba=null;try{ba=window.navigator.plugins}catch(Rd){nd.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var Ba=na.y4e,nb=na.J8e;c=c.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var Rb=wd.AFrameworkApplication.xa.MC,Ic=na.K8e,Wc=!!wd.AFrameworkApplication.xa&&wd.AFrameworkApplication.xa.Xa.qu&&!wd.AFrameworkApplication.ha.sa("PrintDialogFallbackLinkEnabled");
return new na(k,D,ba,Ba,nb,c,Rb,Ic,function(Rd,Ge){return new Pa(Rd,!1,Ge,!0,Wc)},wd.AFrameworkApplication.$Ja)};na.K8e=function(c){return af.a.Co||af.a.jf&&c.Y2h||c.x4e&&na.w4e(c)?!0:!1};na.w4e=function(c){var k=af.a.Fpb;if(k){var D=k.split(".");if(2===D.length)return k=parseInt(D[0]),D=parseInt(D[1]),k>c.Ppd||k===c.Ppd&&D>=c.cgf}return!1};Ll.Object.defineProperties(na.prototype,{HB:{configurable:!0,enumerable:!0,get:function(){return this.ubg}}});Object(te.a)(na,"DirectPrintManager",null,[659]);
La.prototype.Qh=function(c){var k=this;this.Za=c;c.register(ib,"Common.App.DirectPrint.DirectPrintDialogFactory").wc().Fc(function(){return new ib(wd.AFrameworkApplication.xa.bW)});c.register(659,"Common.App.DirectPrint.IDirectPrintManager").wc().Fc(function(){return na.create(k.Za)})};La.prototype.init=function(){this.wYd=this.Za.resolve("Common.App.DirectPrint.IDirectPrintManager");this.wYd.start()};La.prototype.dispose=function(){};Ll.Object.defineProperties(La.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(te.a)(La,"PackageManager",null,[8,9]);var uk=b(588),hk=va.a;Em(ra,hk);ra.prototype.setFocus=function(){this.qv.checked?Yg.DOMElementExtensions.setFocus(this.qv):Yg.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Ll.Object.defineProperties(ra.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return this.bNb}}});ra.b1b="printCurrentSelection";Object(te.a)(ra,"BasePrintDialog",va.a,[]);var ij=b(224);Em(da,
ra);da.prototype.initialize=function(){nd.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.SVh();this.JVa(1153);this.addButton(1);ra.prototype.initialize.call(this)};da.prototype.Rfa=function(){var c=this;return function(k,D,ba){var Ba=c.$.ra.ua,nb=c.um;k=c.Lha(k);D=c.d$(D);var Rb=c.Zd,Ic=Ba.Na(1,null);Ic.printOptions=nb;return Af.i(Ba,"ValidatePrint",Ic,k,D,ba,Rb,0)}};da.prototype.commit=function(){this.XNg();return!0};da.prototype.kx=function(c,
k,D){var ba=c.Result;if(ba&&k){var Ba=0,nb=0;ba.SelectedRanges&&ba.SelectedRanges.Ranges&&0<ba.SelectedRanges.Ranges.length&&ba.SelectedRanges.Ranges[0]&&(Ba=Math.min(da.RQf(ba.SelectedRanges.Ranges[0]),65535));ba.UsedRange&&(nb=Math.min(da.RQf(Sb.j(Sb.D(ba.UsedRange))),65535));ij.h(k,Ba);ij.i(k,nb)}this.um=ba;ra.prototype.kx.call(this,c,k,D)};da.prototype.setFocus=function(){this.Wpb.checked?Yg.DOMElementExtensions.setFocus(this.Wpb):ra.prototype.setFocus.call(this)};da.prototype.SVh=function(){this.Nb.innerHTML=
da.WHi(this.$.fa.isNamedObjectViewMode);this.qv=Yg.DOMElementExtensions.getElementById(this.Nb,ra.b1b);this.Wpb=Yg.DOMElementExtensions.getElementById(this.Nb,"printEntireItem");this.um.Type&&this.um.UseSelection?(this.qv.checked=!0,this.Wpb.disabled=!this.um.SheetName):(this.Wpb.checked=!0,this.qv.disabled=!this.um.Type||!$d.g(this.$).ga.wa.xh)};da.prototype.XNg=function(){nd.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var c=new Sys.StringBuilder;
this.gsh(c);var k=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",af.a.uf?0:1);gd.HelperMethods.lf(c.toString(),"",k,"PrintDialog.PrintViewUrl")||nd.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};da.prototype.gsh=function(c){var k=this.$.ya;c.append(this.$.gca+k.LayoutsRelativeUri+"/xlprintview.aspx?");Kh.a.lg(c,Ac.a.uKi,this.um.SessionId);Kh.a.lg(c,Ac.a.wKi,this.qv.checked?"1":"0");if(this.um.Type){if(!this.um.UsedRangeTooBig){var D=
Sb.D(this.um.UsedRange);(D=Sb.x(D,this.um.SheetName))&&Kh.a.lg(c,Ac.a.xKi,D)}1===this.um.Type?Kh.a.lg(c,Ac.a.sKi,this.um.ObjectId):(D=Sb.B(this.um.SelectedRanges.Ranges[0]),D=Sb.x(D,this.um.SheetName),Kh.a.lg(c,Ac.a.tKi,D))}else Kh.a.lg(c,Ac.a.rKi,this.um.ObjectId);qi.a.dEa(c,k);Kh.a.lg(c,Ac.a.vKi,this.um.Title)};da.WHi=function(c){return String.format("<div class='"+jb.a.hy+"'>{0}</div>\r\n\t<div class='"+jb.a.v3c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",
Ff.a.instance.da(1154),ra.b1b,Ff.a.instance.da(1157),"printEntireItem",c?Ff.a.instance.da(1156):Ff.a.instance.da(1155))};da.RQf=function(c){return(c.LastColumn-c.FirstColumn+1)*(c.LastRow-c.FirstRow+1)};Ll.Object.defineProperties(da.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(te.a)(da,"HtmlPrintDialog",ra,[]);var uj=b(572),ui=b(67);V.SIi="PrintDialogBody";V.printDialogTitle="PrintDialogTitle";V.U3b="ewa-dlg-elements-container-rtl";V.TIi="PrintDialogLeftContainer";
V.UIi="PrintDialogRightContainer";V.$7a="PrintDialogRadioButtonContainer";V.yyf="PrintRadioButtonElementInnerDiv";V.ZIi="PrintRadioButtonElementOuterDiv";V.a8a="PrintDialogTitleSection";V.cyd="PrintDialogComboBoxContainer";V.$Ii="PrintRadioButtonIcon";V.RIi="PrintButtonArea";V.qA="PrintPreviewerContainer";Object(te.a)(V,"CssClassNames",null,[]);var Ok=b(881),Vk=b(287),Zk=b(999),Pk=b(836);Y.prototype.getSheetName=function(){return this.sheetName};Y.prototype.getPrintSettings=function(){return this.printSettings};
Object(te.a)(Y,"MacroRecorderSheetPrintSettingsSavedPayload",null,[115]);Em(N,ra);N.prototype.initialize=function(){this.d6&&zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&N.RUg(this.Nb);this.Ee?this.gte(968,null):(this.Ok(),this.JVa(968));ra.prototype.initialize.call(this)};N.prototype.dispose=function(){this.huj();ra.prototype.dispose.call(this)};N.prototype.close=function(c){nd.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.KZ,c?"without":"with");this.H1i();if(this.Ar){var k=this.rxh();!this.BLd&&!this.G9.checked&&this.$.isEditMode&&this.Scd(k)&&this.y1i(k)}ra.prototype.close.call(this,c)};N.prototype.Rfa=function(){var c=this;return function(k,D,ba){return U(c.$.ra.ua,c.$.va.qa.name,c.locale,c.Lha(k),c.d$(D),ba,null)}};N.prototype.kx=function(c,k,D){this.Ar=c.Result;this.wFb=this.Ar.ScalingWidth;this.vFb=this.Ar.ScalingHeight;this.k6c();this.AVh();ra.prototype.kx.call(this,c,k,D)};N.prototype.Ok=function(){nd.ULS.sendTraceTag(537154315,
0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.TVh();ra.prototype.Ok.call(this)};N.prototype.commit=function(){this.WNg();return!0};N.prototype.setFocus=function(){this.Ee?mk.a.evc(this.qba):this.qba.checked?Yg.DOMElementExtensions.setFocus(this.qba):ra.prototype.setFocus.call(this)};N.prototype.fXh=function(){switch(this.KM.Pu){case 1:this.qba.checked=!0;break;case 0:this.qv.disabled?this.qba.checked=!0:this.qv.checked=!0;break;case 2:this.G9.checked=!0;break;
default:nd.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.KM.Pu),this.KM.Pu=1,this.qba.checked=!0}};N.prototype.H1i=function(){this.KM.Pu=this.LTc();this.d6&&(this.KM.ignorePrintArea=this.t2a.checked)};N.prototype.k6c=function(){if(100!==this.Ar.ScalingPercent||this.Ar.FitToPage&&(1<this.Ar.ScalingWidth||1<this.Ar.ScalingHeight))this.BLd=!0,this.Ar.ScalingWidth=N.u0c,this.Ar.ScalingHeight=N.t0c,this.Ar.ScalingPercent=N.A1b,this.Ar.FitToPage=N.o0c;this.Ar.PaperSize.toString()in
this.Qvd||(this.BLd=!0,this.Ar.PaperSize=this.Ar.PaperSize===N.MAg?34:N.Pob)};N.prototype.AVh=function(){this.rxa=this.Ar.IsLandscape?2:1;this.JZ=this.Ar.FitToPage?1===this.Ar.ScalingWidth&&1===this.Ar.ScalingHeight?1:this.Ar.ScalingWidth||1!==this.Ar.ScalingHeight?2:3:0;this.Lka=this.Ar.PaperSize;this.r2c(this.G9.checked?!0:!1);this.mHd(this.G9.checked?!0:!1)};N.prototype.gWh=function(){this.T$b.disabled=this.qv.checked;this.KCb=this.t2a.checked=this.KM.ignorePrintArea};N.prototype.wXg=function(c){this.kya=
document.createElement("select");this.kya.style.width=224+ui.a.af;this.kya.style.height=32+ui.a.af;this.kya.setAttribute(Ac.a.lD,"scalingElementId");this.jya=new Pk.a(this.kya,!0);for(var k=0,D=N.scalingOptions.length;k<D;++k){var ba=Ff.a.instance.da(N.h2i[k]);this.jya.YK(ba,N.scalingOptions[k].toString(),!1)}c.appendChild(this.kya)};N.prototype.lwe=function(c){this.bxa=document.createElement("select");this.bxa.style.width=224+ui.a.af;this.bxa.style.height=32+ui.a.af;this.bxa.setAttribute(Ac.a.lD,
"paperSizeElementId");this.axa=new Pk.a(this.bxa,!0);for(var k=0,D=N.paperSizeOptions.length;k<D;++k){var ba=Ff.a.instance.da(N.ODi[k]);this.axa.YK(ba,N.paperSizeOptions[k].toString(),!1)}c.appendChild(this.bxa)};N.prototype.rxh=function(){var c={};c.IsLandscape=2===this.rxa;c.PaperSize=this.Lka;c.ScalingWidth=this.wFb;c.ScalingHeight=this.vFb;c.ScalingPercent=100;c.FitToPage=this.JZ?!0:!1;return c};N.prototype.CFa=function(){var c=new Sys.StringBuilder;c.append(Zk.a(this.$,"Pdf",!0));this.Qga.Xrc()&&
Kh.a.lg(c,oe.a.$3f,"1");Kh.a.lg(c,oe.a.Syd,""+this.n5);Kh.a.lg(c,oe.a.Jzf,this.$.va.qa.name);this.n5||(Kh.a.lg(c,oe.a.Izf,this.selectedRange),Kh.a.lg(c,oe.a.Czf,this.activeCell));Kh.a.lg(c,oe.a.Dzf,""+this.rxa);Kh.a.lg(c,oe.a.Ezf,""+this.Lka);Kh.a.lg(c,oe.a.Hzf,""+this.JZ);Kh.a.lg(c,oe.a.Gzf,"1");Kh.a.lg(c,oe.a.Bzf,this.KCb?"1":"0");Kh.a.lg(c,oe.a.Fzf,"1");nd.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",c.toString());return c.toString()};N.prototype.Yub=function(){var c=this,
k=null;nd.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.jc(new Ne.a(223,0,function(D,ba,Ba){D=new Vk.a(D,null,ba,Ba,null,!0,!1,"GetFileCopyFileHandler","");D.correlationID=Sj.a.create().toString();k=D;wd.AFrameworkApplication.Cd.l8(c.CFa(),1,null,null,N.F5c,!1,2,Object(qe.a)(c,c.std,"onFileHandlerSuccessCallback"),Object(qe.a)(c,c.rtd,"onFileHandlerFailureCallback"),k,void 0,void 0,void 0,12E4);return Ie.Task.Ra(!0)},
16),null)};N.prototype.TVh=function(){nd.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.VHi(this.Nb);this.r2c(!0);this.mHd(!0);this.qv=Yg.DOMElementExtensions.getElementById(this.Nb,ra.b1b);this.qba=Yg.DOMElementExtensions.getElementById(this.Nb,"printActiveSheet");this.G9=Yg.DOMElementExtensions.getElementById(this.Nb,"printEntireWorkbook");this.d6&&(this.T$b=Yg.DOMElementExtensions.getElementById(this.Nb,"ignorePrintAreaCheckboxButtonId"),
this.t2a=new Ok.a(this.T$b));this.yrc()&&(this.qv.disabled=!0,this.um.SheetName=this.sheetName);this.fXh();this.d6&&this.gWh();this.BQi()};N.prototype.yrc=function(){return!!this.um.ObjectId||!$d.g(this.$).ga.wa.xh};N.prototype.BQi=function(){uj.a.instance.pa(Sf.a.change,this.qba,Object(qe.a)(this,this.m6a,"onChangeWhatToPrint"));uj.a.instance.pa(Sf.a.change,this.G9,Object(qe.a)(this,this.m6a,"onChangeWhatToPrint"));uj.a.instance.pa(Sf.a.change,this.qv,Object(qe.a)(this,this.m6a,"onChangeWhatToPrint"));
uj.a.instance.pa(Sf.a.change,this.uva,Object(qe.a)(this,this.Khc,"onChangeOrientation"));uj.a.instance.pa(Sf.a.change,this.J7a,Object(qe.a)(this,this.Khc,"onChangeOrientation"));uj.a.instance.pa(Sf.a.change,this.bxa,Object(qe.a)(this,this.Dkf,"onChangePaperSize"));uj.a.instance.pa(Sf.a.change,this.kya,Object(qe.a)(this,this.Ekf,"onChangeScaling"));this.d6&&this.t2a.kkb(Object(qe.a)(this,this.Ckf,"onChangeIgnorePrintArea"))};N.prototype.m6a=function(){this.KZ++;this.n5=this.LTc();this.r2c(this.G9.checked?
!0:!1);this.d6&&(this.T$b.disabled=this.qv.checked);this.mHd(this.G9.checked?!0:!1);nd.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",this.n5.toString());return!0};N.prototype.Ckf=function(){this.KZ++;this.KCb=this.t2a.checked;nd.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",this.KCb.toString())};N.prototype.Khc=function(){this.KZ++;this.rxa=this.Fne();nd.ULS.sendTraceTag(595079450,
0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",this.rxa.toString());return!0};N.prototype.Dkf=function(){this.KZ++;var c=this.Lka;this.Lka=N.paperSizeOptions[this.axa.selectedIndex];nd.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",c.toString(),this.Lka.toString());return!0};N.prototype.Ekf=function(){this.KZ++;var c=this.JZ;this.JZ=N.scalingOptions[this.jya.selectedIndex];2===this.JZ?(this.wFb=1,this.vFb=0):
3===this.JZ?(this.wFb=0,this.vFb=1):1===this.JZ&&(this.vFb=this.wFb=1);nd.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",c.toString(),this.JZ.toString());return!0};N.prototype.huj=function(){uj.a.instance.za(Sf.a.change,this.qba,Object(qe.a)(this,this.m6a,"onChangeWhatToPrint"));uj.a.instance.za(Sf.a.change,this.G9,Object(qe.a)(this,this.m6a,"onChangeWhatToPrint"));uj.a.instance.za(Sf.a.change,this.qv,Object(qe.a)(this,this.m6a,"onChangeWhatToPrint"));
uj.a.instance.za(Sf.a.change,this.uva,Object(qe.a)(this,this.Khc,"onChangeOrientation"));uj.a.instance.za(Sf.a.change,this.J7a,Object(qe.a)(this,this.Khc,"onChangeOrientation"));uj.a.instance.za(Sf.a.change,this.bxa,Object(qe.a)(this,this.Dkf,"onChangePaperSize"));uj.a.instance.za(Sf.a.change,this.kya,Object(qe.a)(this,this.Ekf,"onChangeScaling"));this.d6&&this.t2a.Iba(Object(qe.a)(this,this.Ckf,"onChangeIgnorePrintArea"))};N.prototype.VHi=function(c){c.classList.add(V.SIi);if(!this.Ee){document.getElementById("ewaDialogTitle").classList.add(V.printDialogTitle);
var k=document.getElementById("ewaDialogCloseButtonLink");k.style.top=32+ui.a.af;this.rtl?k.style.left=32+ui.a.af:k.style.right=32+ui.a.af}k=N.cy(V.TIi);c.appendChild(k);var D=N.cy(V.a8a,1161);D.style.marginBottom=12+ui.a.af;D.id="whatToPrintTitleElementId";k.appendChild(D);D=N.cy(V.$7a);k.appendChild(D);N.mob(D,this.rtl,"printActiveSheet",1165,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");k.appendChild(document.createElement("BR"));
D=N.cy(V.$7a);k.appendChild(D);N.mob(D,this.rtl,"printEntireWorkbook",1158,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");k.appendChild(document.createElement("BR"));D=N.cy(V.$7a);k.appendChild(D);N.mob(D,this.rtl,ra.b1b,1157,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.d6?(D=N.cy(V.a8a,1190),D.style.marginTop=24+ui.a.af,
D.id="printAreaElementId",k.appendChild(D),zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(D.style.marginBottom=12+ui.a.af,D=N.cy(jb.a.w3c),D.id="ignorePrintAreaCheckboxWarpperId",Yg.DOMElementExtensions.setVisible(D,!0),k.appendChild(D),k=this.getElementById("ignorePrintAreaCheckboxButtonId"),Yg.DOMElementExtensions.setVisible(k,!0),D.appendChild(k),k=this.getElementById("ignorePrintAreaCheckboxLabelId"),Yg.DOMElementExtensions.setVisible(k,!0),D.appendChild(k)):
(D=N.cy(V.$7a),k.appendChild(D),N.ISg(D,this.rtl))):(D=N.cy(V.a8a,1163),D.style.marginTop=24+ui.a.af,D.id="paperSizeElementId",k.appendChild(D),D=N.cy(V.cyd),this.lwe(D),k.appendChild(D));k=N.cy(V.UIi);c.appendChild(k);c=N.cy(V.a8a,1162);c.style.marginBottom=12+ui.a.af;c.id="orientationTitleElementId";k.appendChild(c);c=N.cy(V.$7a);k.appendChild(c);N.mob(c,this.rtl,"portraitRadioButtonId",1168,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");
k.appendChild(document.createElement("BR"));c=N.cy(V.$7a);k.appendChild(c);N.mob(c,this.rtl,"landscapeRadioButtonId",1167,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.d6&&(c=N.cy(V.a8a,1163),c.style.marginTop=12+ui.a.af,c.id="paperSizeElementId",k.appendChild(c),c=N.cy(V.cyd),this.lwe(c),k.appendChild(c));c=N.cy(V.a8a,1164);c.style.marginTop=(this.d6?10:74)+ui.a.af;c.id="scalingElementId";k.appendChild(c);c=N.cy(V.cyd);this.wXg(c);
k.appendChild(c);this.Ee||document.getElementById("buttonarea").classList.add(V.RIi);this.uva=Yg.DOMElementExtensions.getElementById(this.Nb,"landscapeRadioButtonId");this.J7a=Yg.DOMElementExtensions.getElementById(this.Nb,"portraitRadioButtonId")};N.prototype.WNg=function(){var c=this;nd.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.n5=this.LTc();2!==this.n5&&(this.rxa=this.Fne(),this.axa&&(this.Lka=N.paperSizeOptions[this.axa.selectedIndex]),
this.jya&&(this.JZ=N.scalingOptions[this.jya.selectedIndex]));if(this.$.Hua&&zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var k=this.$.ra.ua.Wb();this.$.userOperationManager.jc(new Ne.a(133,0,function(D,ba,Ba){var nb={};nb.WhatToPrint=c.n5;nb.UseNamedAction=c.Qga.Xrc();nb.SelectedSheetName=c.$.va.qa.name;nb.ActiveCell=c.activeCell;nb.SelectedRanges=[c.selectedRange];nb.IsPdfDocumentRequired=!1;nb.Orientation=c.rxa;nb.PaperSize=c.Lka;nb.Scaling=
c.JZ;nb.RichValuesEnabled=!0;c.d6&&(nb.IgnorePrintArea=c.KCb);return Z(c.$.ra.ua,nb,Fd.b(Object(qe.a)(c,c.Yzb,"onConvertWorkbookToPdfSucceeded"),D),ba,Ba,k)},16),null)}else this.Yub()};N.prototype.std=function(c){if(c&&c.data&&c.data.ae&&c.data.responseHeaders&&c.data.ae.length){if(c.data.responseHeaders["Content-Type"]&&Cd.a.contains(c.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){nd.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var k={};this.Yzb(k,null,null)}else k=Mg.a.Xh(c.data.ae),nd.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",k.Errors[0].MessageId);c=c.data.state;c.L3c(k,c.userContext,c.methodName)}else nd.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",c?c.data?c.data.ae?c.data.responseHeaders?c.data.ae.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":
"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};N.prototype.rtd=function(c){var k=qi.a.xg(c.data);nd.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Eb.a.Uc(k));k=c.data.state;k.O9(c,k.userContext,k.methodName)};N.prototype.r2c=function(c){this.J7a.disabled=c;this.uva.disabled=c;this.axa.vn.disabled=c;this.jya.vn.disabled=c};N.prototype.mHd=function(c){c?(this.uva.checked=!1,this.J7a.checked=
!1,this.axa.selectedIndex=-1,this.jya.selectedIndex=-1):(2===this.rxa?this.uva.checked=!0:this.J7a.checked=!0,this.axa.selectedIndex=this.Qvd[this.Lka.toString()],this.jya.selectedIndex=this.JZ)};N.prototype.y1i=function(c){var k=this;nd.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var D=this.$.va.qa.name,ba=this.$.ra.ua.Wb();this.$.userOperationManager.jc(new Ne.a(226,0,function(Ba,nb,Rb){return ca(k.$.ra.ua,
D,c,Ba,nb,Rb,ba)},void 0,function(){return new Y(D,c)}),null)};N.prototype.Scd=function(c){return this.Ar.IsLandscape!==c.IsLandscape||this.Ar.PaperSize!==c.PaperSize||this.Ar.FitToPage!==c.FitToPage||this.Ar.ScalingHeight!==c.ScalingHeight||this.Ar.ScalingWidth!==c.ScalingWidth?!0:!1};N.prototype.Fne=function(){return this.uva&&this.uva.checked?2:1};N.prototype.LTc=function(){return this.qv.checked?0:this.qba.checked?1:this.G9.checked?2:1};N.prototype.Yzb=function(c){c.Errors&&0<c.Errors.length?
nd.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",c.Errors[0].MessageId):(6===this.Zd.Ze&&wd.AFrameworkApplication.xa.Me.Wj($d.g(this.$).cLf),nd.ULS.shipAssertTag(537154309,0,!!this.$.va.qa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),this.$.va.qa&&this.Qga.ITf(this.CFa()))};N.cy=function(c,k){c=void 0===c?null:c;k=void 0===k?0:k;var D=document.createElement("div");Cd.a.ma(c)||(D.className=c);
k&&(D.innerHTML=Ff.a.instance.da(k));return D};N.RUg=function(c){var k=document.createElement("input");k.setAttribute("type","checkbox");k.className=jb.a.HEe;k.id="ignorePrintAreaCheckboxButtonId";k.setAttribute("name","ignorePrintAreaCbName");k.style.height=16+ui.a.af;k.style.width=16+ui.a.af;Yg.DOMElementExtensions.setVisible(k,!1);var D=Ff.a.instance.da(1190),ba=Ff.a.instance.da(1191);k.setAttribute(Ac.a.fv,D+ui.a.space+ba);c.appendChild(k);k=document.createElement("label");k.setAttribute("for",
"ignorePrintAreaCheckboxButtonId");k.id="ignorePrintAreaCheckboxLabelId";k.innerHTML=ba;k.setAttribute(Ac.a.rO,"true");k.style.position="relative";k.style.marginLeft=15+ui.a.af;Yg.DOMElementExtensions.setVisible(k,!1);c.appendChild(k)};N.ISg=function(c,k){var D=document.createElement("input");D.setAttribute("type","checkbox");D.id="ignorePrintAreaCheckboxButtonId";D.setAttribute("name","ignorePrintAreaCbName");D.setAttribute(Ac.a.lD,"printAreaElementId"+ui.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");
D.style.height=16+ui.a.af;D.style.width=16+ui.a.af;k?D.style.marginRight=0+ui.a.af:D.style.marginLeft=0+ui.a.af;c.appendChild(D);k=document.createElement("label");k.setAttribute("for","ignorePrintAreaCheckboxButtonId");k.setAttribute(Ac.a.rO,"true");k.style.position="relative";k.style.marginLeft=15+ui.a.af;c.appendChild(k);c=N.cy(V.yyf,1191);c.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";k.appendChild(c)};N.mob=function(c,k,D,ba,Ba,nb,Rb,Ic){var Wc=document.createElement("input");Wc.setAttribute("type",
"radio");Wc.id=D;Wc.setAttribute("name",Ba);Wc.setAttribute(Ac.a.lD,Ic+ui.a.space+Rb);Wc.style.height=16+ui.a.af;Wc.style.width=16+ui.a.af;k?Wc.style.marginRight=0+ui.a.af:Wc.style.marginLeft=0+ui.a.af;c.appendChild(Wc);k=document.createElement("label");k.setAttribute("for",D);k.style.position="relative";c.appendChild(k);c=mj.createClusteredImage(32,32,nb,V.$Ii,!0,Ff.a.instance.da(ba));ba=N.cy(V.yyf,ba);ba.id=Rb;ba.setAttribute(Ac.a.rO,"true");Rb=N.cy(V.ZIi);Rb.appendChild(ba);k.appendChild(Rb);k.appendChild(c)};
Ll.Object.defineProperties(N.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});N.u0c=1;N.t0c=0;N.A1b=100;N.Pob=9;N.o0c=!0;N.MAg=13;N.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];N.ODi=[1170,1171,1178,1172,1173,1174,1175,1176,1169,1179,1180,1181,1182,1183,1184,1185];N.scalingOptions=[0,1,2,3];N.h2i=[1186,1187,1188,1189];N.F5c=["Content-Type"];Object(te.a)(N,"PdfPrintDialog",ra,[]);Ll.Object.defineProperties(G.prototype,{Pu:{configurable:!0,enumerable:!0,
get:function(){return this.n5},set:function(c){0<=c&&2>=c?this.n5=c:(nd.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.n5=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.o0d},set:function(c){c||!c?this.o0d=c:nd.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(te.a)(G,"PdfPrintDialogBrowserSessionState",null,[]);var vk=b(1351);Object(te.a)(W,"MacroRecorderPrintAreaSetPayload",null,
[115]);Object(te.a)(fa,"MacroRecorderPageBreakInsertedPayload",null,[115]);Object(te.a)(aa,"MacroRecorderPageBreakRemovedPayload",null,[115]);L.prototype.getSheetName=function(){return this.sheetName};Object(te.a)(L,"MacroRecorderPageBreaksAllResetPayload",null,[115]);Q.prototype.getSheetName=function(){return this.sheetName};Object(te.a)(Q,"MacroRecorderPrintAreaClearedPayload",null,[115]);Object(te.a)(S,"PageBreaksInformation",null,[]);Object(te.a)(H,"RowColBreak",null,[]);Object(te.a)(A,"SharedRange",
null,[]);var Ck=b(122);E.prototype.executeCommand=function(c,k,D,ba,Ba,nb,Rb){Ba=void 0===Ba?null:Ba;nb=void 0===nb?null:nb;Rb=void 0===Rb?null:Rb;this.lPd();this.ribbonCommandInfo=k;this.Okj(k.command);c=Fd.b(Ba,Object(qe.a)(this,this.dsj,"triggerGridPerfTracking"));nd.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",k.command);switch(k.command){case 78661008:return this.iYe(k,c,nb,Rb,!1);case 275604654:return this.iYe(k,c,nb,Rb,!0);case -13332329:return this.mXe(k,
c,nb,Rb);case -837651977:return this.bOh(k,c,nb,Rb);case -1778266776:return this.TOh(k,c,nb,Rb);case 845325699:return this.dYe(k,c,nb,Rb)}return u.a(k.command)};E.prototype.Ec=function(c,k){switch(k.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===c;case 845325699:case -13332329:return!0}return!1};E.prototype.oPf=function(c,k,D){var ba=$d.g(this.$),Ba=ba.Ca,nb=Sb.r(ba.ga.wa.selectedRanges,this.$);if((Ba=Ba.iG())&&Ba.length){Ba=Ol(Ba);for(var Rb=Ba.next();!Rb.done;Rb=
Ba.next()){Rb=Rb.value;var Ic=Rb.Wf;if(Ic){for(var Wc=Sb.j(Rb.fg),Rd=[],Ge=Ol(nb.Ranges),df=Ge.next();!df.done;df=Ge.next()){var Wf=df.value;Wf.FirstRow>Wc.LastRow+1||Wf.LastRow<Wc.FirstRow||Wf.FirstColumn>Wc.LastColumn+1||Wf.LastColumn<Wc.FirstColumn||(df=this.AFh(Wc,Wf,Ic),Wf=this.zFh(Wc,Wf,Ic),Rd.push(Object.assign(new A,{FirstRow:df.FirstRow,FirstColumn:Wf.FirstColumn,LastRow:df.LastRow,LastColumn:Wf.LastColumn})))}0<Rd.length&&!D?Ic.setPrintArea(Rd):0<Rd.length&&D?Ic.addToPrintArea(Rd):!D&&Ic.hasPrintArea()&&
Ic.clearPrintArea();!Ic.isDirty()&&Ic.hasPageLayout()&&Ic.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Rb.Rd,4)}}this.BJb(ba,c,k)}};E.prototype.xLg=function(c,k){var D=$d.g(this.$),ba=$d.g(this.$).Ca.iG();if(ba&&ba.length){ba=Ol(ba);for(var Ba=ba.next();!Ba.done;Ba=ba.next()){Ba=Ba.value;var nb=Ba.Wf;nb&&(nb.clearPrintArea(),!nb.isDirty()&&nb.hasPageLayout()&&nb.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Ba.Rd,4))}this.BJb(D,c,k)}};E.prototype.JXh=
function(c,k){var D=$d.g(this.$),ba=D.Ca,Ba=Sb.o(D.ga.wa.activeCell,this.$);if(Ba){var nb=ba.iG();if(nb&&nb.length){ba=null;for(var Rb=Ol(nb),Ic=Rb.next();!Ic.done;Ic=Rb.next()){Ic=Ic.value;var Wc=Ic.Wf;if(Wc){var Rd=Sb.j(Ic.fg);if(!(Ba.FirstRow>Rd.LastRow||Ba.FirstRow<Rd.FirstRow||Ba.FirstColumn>Rd.LastColumn||Ba.FirstColumn<Rd.FirstColumn)&&(ba=this.iWg(Wc,Rd,Ba),Wc.insertPageBreak(ba),!Wc.isDirty()&&Wc.hasPageLayout()&&Wc.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Ic.Rd,
4),ba))break}}if(!ba)for(nb=Ol(nb),Ic=nb.next();!Ic.done;Ic=nb.next())if(ba=Ic.value,Rb=ba.Wf)ba=Sb.j(ba.fg),ba=this.kwe(Rb,ba,Ba),Rb.insertPageBreak(ba);this.BJb(D,c,k)}}};E.prototype.MSi=function(c,k){var D=$d.g(this.$),ba=D.Ca,Ba=Sb.o(D.ga.wa.activeCell,this.$);if(Ba&&(ba=ba.iG())&&ba.length){ba=Ol(ba);for(var nb=ba.next();!nb.done;nb=ba.next()){nb=nb.value;var Rb=nb.Wf;if(Rb){var Ic=Sb.j(nb.fg);(Ic=this.kwe(Rb,Ic,Ba))&&Rb.removePageBreak(Ic);!Rb.isDirty()&&Rb.hasPageLayout()&&Rb.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
nb.Rd,4)}}this.BJb(D,c,k)}};E.prototype.LYi=function(c,k){var D=$d.g(this.$),ba=D.Ca.iG();if(ba&&ba.length){ba=Ol(ba);for(var Ba=ba.next();!Ba.done;Ba=ba.next()){Ba=Ba.value;var nb=Ba.Wf;nb&&(nb.resetAllPageBreak(),!nb.isDirty()&&nb.hasPageLayout()&&nb.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Ba.Rd,4))}this.BJb(D,c,k)}};E.prototype.iYe=function(c,k,D,ba,Ba){if(!Ba){var nb=this.$.wb.getItemByName("PRINT_AREA");if(nb&&(nd.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
nb.type),2===nb.type))return this.nZh(),Ie.Task.Ra(!0)}nb=$d.g(this.$).ga.wa;var Rb=Sb.r(nb.selectedRanges,this.$);if(1===Rb.Ranges.length&&!Ba){if(nb.lva())return this.gPh(c,Rb,k,D,ba,Ba),Ie.Task.Ra(!0);if(Sb.R(Rb.Ranges[0]))return this.$.va.qa.hasPrintArea?this.mXe(c,k,D,ba):Ie.Task.Ra(!0)}this.oPf(c.command,ba,Ba);return this.Q2e(c,k,D,Rb,Ba)};E.prototype.mXe=function(c,k,D,ba){this.xLg(c.command,ba);return this.ZYh(c,k,D)};E.prototype.bOh=function(c,k,D,ba){this.JXh(c.command,ba);return this.kZh(c,
k,D)};E.prototype.TOh=function(c,k,D,ba){if(zg.EwaSettings.isChangeGateEnabled("OfficeVSO:4767450_ResetAllPageBreaksOnSelectAllAndRemovePageBreak")){var Ba=Sb.r($d.g(this.$).ga.wa.selectedRanges,this.$);if(Sb.R(Ba.Ranges[0]))return this.dYe(c,k,D,ba)}this.MSi(c.command,ba);return this.pZh(c,k,D)};E.prototype.dYe=function(c,k,D,ba){this.LYi(c.command,ba);return this.rZh(c,k,D)};E.prototype.Q2e=function(c,k,D,ba,Ba){function nb(){return new W(ba,Ba)}function Rb(Wc,Rd,Ge){Wc=Fd.b(Wc,k);Rd=Fd.a(Rd,D);
var df=Ic.Na(1,null);df.selectedRanges=ba;df.addToPrintArea=Ba;return Af.i(Ic,"SetPrintArea",df,Wc,Rd,Ge,null,0)}var Ic=this.$.ra.ua;return zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,Rb,function(Wc){return new Ne.a(241,0,Wc,64,nb)},c):rf.a(this.$.userOperationManager,Rb,function(Wc){return new jj.a(241,0,Wc,void 0,nb)},c)};E.prototype.ZYh=function(c,k,D){function ba(){return new Q(nb)}function Ba(Ic,Wc,Rd){Ic=Fd.b(Ic,k);Wc=Fd.a(Wc,D);var Ge=Rb.Na(1,null);Ge.sheetName=nb;return Af.i(Rb,"ClearPrintArea",
Ge,Ic,Wc,Rd,null,0)}var nb=this.$.va.qa.name,Rb=this.$.ra.ua;return zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,Ba,function(Ic){return new Ne.a(243,0,Ic,64,ba)},c):rf.a(this.$.userOperationManager,Ba,function(Ic){return new jj.a(243,0,Ic,void 0,ba)},c)};E.prototype.kZh=function(c,k,D){function ba(){return new fa(Ic)}function Ba(Wc,Rd,Ge){var df=nb.$.ra.ua;Wc=Fd.b(Wc,k);Rd=Fd.a(Rd,D);var Wf=df.Na(9,null);Wf.sheetCell=Ic;return Af.i(df,"InsertPageBreak",Wf,Wc,Rd,Ge,null,0)}var nb=this,Rb=$d.g(this.$),
Ic=Sb.o(Rb.ga.wa.activeCell,this.$);return zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,Ba,function(Wc){return new Ne.a(244,0,Wc,64,ba)},c):rf.a(this.$.userOperationManager,Ba,function(Wc){return new jj.a(244,0,Wc,void 0,ba)},c)};E.prototype.pZh=function(c,k,D){function ba(){return new aa(Ic)}function Ba(Wc,Rd,Ge){var df=nb.$.ra.ua;Wc=Fd.b(Wc,k);Rd=Fd.a(Rd,D);var Wf=df.Na(9,null);Wf.sheetCell=Ic;return Af.i(df,"RemovePageBreak",Wf,Wc,Rd,Ge,null,0)}var nb=this,Rb=$d.g(this.$),Ic=Sb.o(Rb.ga.wa.activeCell,
this.$);return zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,Ba,function(Wc){return new Ne.a(245,0,Wc,64,ba)},c):rf.a(this.$.userOperationManager,Ba,function(Wc){return new jj.a(245,0,Wc,void 0,ba)},c)};E.prototype.rZh=function(c,k,D){function ba(){return new L(Rb)}function Ba(Ic,Wc,Rd){var Ge=nb.$.ra.ua;Ic=Fd.b(Ic,k);Wc=Fd.a(Wc,D);var df=Ge.Na(9,null);df.sheetName=Rb;return Af.i(Ge,"ResetAllPageBreaks",df,Ic,Wc,Rd,null,0)}var nb=this,Rb=this.$.va.qa.name;return zg.EwaSettings.pc()?rf.a(this.$.userOperationManager,
Ba,function(Ic){return new Ne.a(246,0,Ic,64,ba)},c):rf.a(this.$.userOperationManager,Ba,function(Ic){return new jj.a(246,0,Ic,void 0,ba)},c)};E.prototype.AFh=function(c,k,D){if(!c||!k||!D)return null;var ba=new A;ba.FirstRow=k.FirstRow===c.LastRow+1?D.getRowIndex(c.LastRow+1)+1:k.FirstRow<c.FirstRow?0:D.getRowIndex(k.FirstRow+1);ba.LastRow=k.FirstRow===c.LastRow+1||k.LastRow>c.LastRow?D.getRowIndex(c.LastRow+1)+1:D.getRowIndex(k.LastRow+1);return ba};E.prototype.zFh=function(c,k,D){if(!c||!k||!D)return null;
var ba=new A;ba.FirstColumn=k.FirstColumn===c.LastColumn+1?D.getColumnIndex(c.LastColumn+1)+1:k.FirstColumn<c.FirstColumn?0:D.getColumnIndex(k.FirstColumn+1);ba.LastColumn=k.FirstColumn===c.LastColumn+1||k.LastColumn>c.LastColumn?D.getColumnIndex(c.LastColumn+1)+1:D.getColumnIndex(k.LastColumn+1);return ba};E.prototype.iWg=function(c,k,D){if(!k||!D||!c)return null;var ba=c.getPrintArea();if(!ba||!ba.length)return null;var Ba=c.getRowIndex(D.FirstRow+1),nb=c.getColumnIndex(D.FirstColumn+1),Rb=null,
Ic=null;ba=Ol(ba);for(var Wc=ba.next();!Wc.done;Wc=ba.next())if(Wc=Wc.value,Ba>=Wc.FirstRow&&Ba<=Wc.LastRow&&nb>=Wc.FirstColumn&&nb<=Wc.LastColumn){if(D.FirstRow===Wc.FirstRow&&D.FirstColumn===Wc.FirstColumn)return new S;Ba>Wc.FirstRow&&(Rb=Object.assign(new H,{Index:Ba-1,Min:Wc.FirstColumn-1,Max:Math.min(Wc.LastColumn,c.getColumnIndex(k.LastColumn+1))}));nb>Wc.FirstColumn&&(Ic=Object.assign(new H,{Index:nb-1,Min:Wc.FirstRow-1,Max:Math.min(Wc.LastRow,c.getRowIndex(k.LastRow+1))}));break}return Rb||
Ic?Object.assign(new S,{Row:Rb?[Rb]:null,Col:Ic?[Ic]:null}):null};E.prototype.sXg=function(c,k,D){if(!k||!D||!c)return null;var ba=null;D.FirstRow>k.FirstRow&&D.FirstRow<=k.LastRow?ba=Object.assign(new H,{Index:c.getRowIndex(D.FirstRow+1)-1,Min:-1,Max:-1}):D.FirstRow===k.LastRow+1&&(ba=Object.assign(new H,{Index:c.getRowIndex(k.LastRow+1),Min:-1,Max:-1}));return ba};E.prototype.PSg=function(c,k,D){if(!k||!D||!c)return null;var ba=null;D.FirstColumn>k.FirstColumn&&D.FirstColumn<=k.LastColumn?ba=Object.assign(new H,
{Index:c.getColumnIndex(D.FirstColumn+1)-1,Min:-1,Max:-1}):D.FirstColumn===k.LastColumn+1&&(ba=Object.assign(new H,{Index:c.getColumnIndex(k.LastColumn+1),Min:-1,Max:-1}));return ba};E.prototype.kwe=function(c,k,D){if(!D||!c||!k)return null;var ba=this.sXg(c,k,D);c=this.PSg(c,k,D);return ba||c?Object.assign(new S,{Row:ba?[ba]:null,Col:c?[c]:null}):null};E.prototype.nZh=function(){var c=new Td.StandardDialog;c.hc=0;c.yc(1,Ff.a.instance.da(4));c.ul(Ff.a.instance.da(547),Ff.a.instance.da(548),1,null)};
E.prototype.Okj=function(c){if(this.Pta.qb(c)&&(this.hHf&&(this.BBb=this.$.Vb.Dc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.NIa.qb(c)&&this.NIa.remove(c),this.NIa.add(c,Sj.a.create().toString()),$d.g(this.$).vi)){var k=jg.b()?jg.b().$h(c):"";$d.g(this.$).vi.g6(this.Pta.oa(c),this.NIa.oa(c),k)}};E.prototype.JJg=function(c){if(this.BBb&&c){var k=this.BBb.Cc;this.BBb.stop();this.BBb=null;switch(c){case "SetPrintArea":this.Omb(k,1700,c);break;case "ClearPrintArea":this.Omb(k,1500,c);break;
case "InsertPageBreak":this.Omb(k,1500,c);break;case "RemovePageBreak":this.Omb(k,1600,c);break;case "ResetAllPageBreaks":this.Omb(k,1700,c)}}};E.prototype.Omb=function(c,k,D){c>k&&(k=Object.assign(new Th.a,{extendedProperties:new Map}),k.extendedProperties.set("OperationName",D),k.extendedProperties.set("OperationExecutionTime",c.toString()),ze.Health.instance.recordQosError(M.a.Djj,[wa.a.yjj],!1,!0,!0,!1,k))};E.prototype.dsj=function(c,k,D){k=!!c&&!!c.RequestTelemetryData;$d.g(this.$).vi&&$d.g(this.$).vi.Kja(this.NIa.oa(this.ribbonCommandInfo.command),
c.StateId,k?c.RequestTelemetryData.EcsOperationDuration:0,k?c.RequestTelemetryData.EcsRequestDuration:0,k?c.RequestTelemetryData.WfeRequestDuration:0);this.hHf&&this.JJg(D)};E.prototype.gPh=function(c,k,D,ba,Ba,nb){var Rb=this,Ic=new Td.StandardDialog,Wc=new vk.a(Ff.a.instance.da(545),Ff.a.instance.da(546),Ff.a.instance.da(6),Ff.a.instance.da(5));Ic.hc=1;Ic.yc(1,Wc.confirmButton);Ic.yc(0,Wc.cancelButton);Ic.ul(Wc.title,Wc.body,3,function(Rd){1===Rd&&(Rb.oPf(c.command,Ba,nb),Rb.Q2e(c,D,ba,k,nb))})};
E.prototype.BJb=function(c,k,D){D();this.NIa.qb(k)&&c.vi.u_(this.NIa.oa(k),ri.BasicTelemetryCalculator.JP)};E.prototype.lPd=function(){this.jjd&&this.$.De(-1753588160,-1,0,null)};Object(te.a)(E,"PrintAreaBreakManager",null,[794]);var ik=b(381);J.prototype.equals=function(c){return c?this.orientation===c.orientation&&this.bba===c.bba&&this.d_===c.d_&&this.margin===c.margin&&this.sheetPrintOptions===c.sheetPrintOptions&&this.FZa===c.FZa&&this.NoColor===c.NoColor:!1};J.pue=function(c,k){c&&k&&(k.Pu=
c.Pu,k.orientation=c.orientation,k.bba=c.bba,k.d_=c.d_,k.margin=c.margin,k.ignorePrintArea=c.ignorePrintArea,k.sheetPrintOptions=c.sheetPrintOptions,k.FZa=c.FZa,k.NoColor=c.NoColor)};Object(te.a)(J,"PrintSettingsContainer",null,[]);var Wk=b(148),$k=b(334),Pi=b(930),wj=b(889),Qk=b(787);Object(te.a)(y,"PrintSettingMarginOption",null,[]);Object(te.a)(x,"PrintSettingMarginValue",null,[]);Object(te.a)(z,"PrintSettingOption",null,[]);B.prototype.dispose=function(){};B.prototype.Esb=function(c){if(!c)return null;
var k=new x;k.left=c.Left;k.right=c.Right;k.top=c.Top;k.bottom=c.Bottom;k.header=c.Header;k.footer=c.Footer;return k};B.prototype.DZc=function(c){nd.ULS.shipAssertTag(537154186,0,6===c.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var k={};k.Top=c[0];k.Bottom=c[1];k.Left=c[2];k.Right=c[3];k.Header=c[4];k.Footer=c[5];return k};B.prototype.BWh=function(){this.Jbe=[Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Bm.da(1165)}),
Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Bm.da(1158)}),Object.assign(new z,{printSettingOptionKey:0,printSettingOptionText:this.Bm.da(1157)})];this.d6d=[Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Bm.da(1168)}),Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Bm.da(1167)})];this.u6d=[Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Bm.da(1170)}),Object.assign(new z,{printSettingOptionKey:5,
printSettingOptionText:this.Bm.da(1171)}),Object.assign(new z,{printSettingOptionKey:6,printSettingOptionText:this.Bm.da(1178)}),Object.assign(new z,{printSettingOptionKey:7,printSettingOptionText:this.Bm.da(1172)}),Object.assign(new z,{printSettingOptionKey:8,printSettingOptionText:this.Bm.da(1173)}),Object.assign(new z,{printSettingOptionKey:9,printSettingOptionText:this.Bm.da(1174)}),Object.assign(new z,{printSettingOptionKey:11,printSettingOptionText:this.Bm.da(1175)}),Object.assign(new z,{printSettingOptionKey:12,
printSettingOptionText:this.Bm.da(1176)}),Object.assign(new z,{printSettingOptionKey:13,printSettingOptionText:this.Bm.da(1177)}),Object.assign(new z,{printSettingOptionKey:3,printSettingOptionText:this.Bm.da(1169)})];this.e9d=[Object.assign(new z,{printSettingOptionKey:0,printSettingOptionText:this.Bm.da(1186)}),Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Bm.da(1187)}),Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Bm.da(1188)}),Object.assign(new z,
{printSettingOptionKey:3,printSettingOptionText:this.Bm.da(1189)})];this.$3d=[Object.assign(new y,{printSettingOption:Object.assign(new z,{printSettingOptionKey:0,printSettingOptionText:this.Bm.da(1192)}),marginValue:this.Esb(this.normal)}),Object.assign(new y,{printSettingOption:Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Bm.da(1193)}),marginValue:this.Esb(this.wide)}),Object.assign(new y,{printSettingOption:Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Bm.da(1194)}),
marginValue:this.Esb(this.narrow)}),Object.assign(new y,{printSettingOption:Object.assign(new z,{printSettingOptionKey:3,printSettingOptionText:this.Bm.da(1195)}),marginValue:this.Esb(this.l5)})]};B.prototype.uWh=function(){this.normal=this.DZc(this.lli);this.narrow=this.DZc(this.aki);this.wide=this.DZc(this.QCj)};Ll.Object.defineProperties(B.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Jbe}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.d6d}},
paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.u6d}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.e9d}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.$3d}}});B.y0g=1;B.k0g=1;B.Pob=9;B.p0g=2;B.j0g=0;B.c0g=!1;B.$_g=!1;B.dGa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(te.a)(B,"PrintSettingsManagerBase",null,[6]);var Jk=b(120);t.prototype.getSheetName=function(){return this.sheetName};
Object(te.a)(t,"MacroRecorderSheetPrintOptionsSavedPayload",null,[115]);Em(w,B);w.prototype.dZh=function(c){var k=this;this.eZh(function(D){c&&(D=k.FFh(D),c(D))})};w.prototype.qFd=function(c,k){if(c){var D=new G(c.Pu,c.ignorePrintArea);this.x1i(D);if(!k||this.BUf)nd.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",k?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false");else{k=this.HFh(c.d_);k.IsLandscape=
2===c.orientation;k.PaperSize=c.bba;this.isUniversalPrintEnabled&&(k.NoColor=c.NoColor);this.Yua&&(k.PageMargin=this.bad(c.margin));if(zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintGridlines",!1)||zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintAlignmentsAndHeadings",!1))k.SheetPrintOptions=B.dGa,k.SheetPrintOptions.PrintGrid=c.sheetPrintOptions.PrintGrid,k.SheetPrintOptions.HorizontalCenter=c.sheetPrintOptions.HorizontalCenter,k.SheetPrintOptions.VerticalCenter=
c.sheetPrintOptions.VerticalCenter,k.SheetPrintOptions.PrintHeaders=c.sheetPrintOptions.PrintHeaders;this.w1i(k)}}else nd.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};w.prototype.bad=function(c){var k={};c?1===c?k=this.wide:2===c?k=this.narrow:3===c&&(k=this.l5):k=this.normal;return k};w.prototype.vZh=function(c){var k=this;if(c){nd.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");
var D=function(){return new t(k.$.va.qa.name,c)},ba=this.$.ra.ua,Ba=this.$.ra.ua.Wb(),nb=function(Rb,Ic,Wc){var Rd=k.$.va.qa.name;Rb=Fd.b(Object(qe.a)(k,k.sud,"onPrintOptionsUpdationSuccess"),Rb);Ic=Fd.a(Object(qe.a)(k,k.Aud,"onSavePrintOptionsToFileFailure"),Ic);var Ge=ba.Na(1,null);Ge.sheetName=Rd;Ge.printOptions=c;return Af.i(ba,"SetPrintOptions",Ge,Rb,Ic,Wc,Ba,0)};D=zg.EwaSettings.pc()?new Ne.a(598,0,nb,64,D):new jj.a(598,0,nb,void 0,D);this.$.userOperationManager.jc(D,null)}else nd.ULS.sendTraceTag(537154198,
0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};w.prototype.dispose=function(){this.Bd||(this.Bd=!0,this.$.userOperationManager.zC(Object(qe.a)(this,this.OJ,"onQueueChanged")),this.e8())};w.prototype.x1i=function(c){this.KM.Pu=c.Pu;this.KM.ignorePrintArea=c.ignorePrintArea};w.prototype.eZh=function(c){function k(Ic,Wc,Rd){return U(Ba.$.ra.ua,Ba.sheetName,Ba.locale,Fd.b(Ic,ba),Fd.a(Wc,D),Rd,nb)}function D(Ic){Ic=qi.a.xg(Ic.data);nd.ULS.sendTraceTag(537154194,
0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Eb.a.Uc(Ic));c(null)}function ba(Ic){Ph.a(Ic)?nd.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Eb.a.Uc(Ic.Errors)):(nd.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),c(Ic.Result))}var Ba=this,nb=this.$.ra.ua.Wb();var Rb=zg.EwaSettings.pc()?new Ne.a(247,
0,k,80):new jj.a(247,0,k,16);Rb=this.$.userOperationManager.jc(Rb,null);this.TJ.add(Rb)};w.prototype.w1i=function(c){var k=this;nd.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var D=this.$.ra.ua.Wb();this.$.userOperationManager.jc(new Ne.a(226,0,function(ba,Ba,nb){return ca(k.$.ra.ua,k.sheetName,c,Fd.b(ba,Object(qe.a)(k,k.Jyi,"onSavePrintSettingsToFileSuccess")),Fd.a(Ba,Object(qe.a)(k,k.Iyi,"onSavePrintSettingsToFileFailure")),
nb,D)},void 0,function(){return new Y(k.sheetName,c)}),null)};w.prototype.K4h=function(c){return this.b4e(c)||!this.X6e(c.PaperSize)};w.prototype.k6c=function(c){this.b4e(c)&&(nd.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),c.ScalingWidth=w.u0c,c.ScalingHeight=w.t0c,c.ScalingPercent=w.A1b,c.FitToPage=w.o0c);this.X6e(c.PaperSize)||(nd.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",
c.PaperSize.toString()),c.PaperSize=w.Pob);return c};w.prototype.DFh=function(c){if(c.FitToPage){if(1===c.ScalingWidth&&1===c.ScalingHeight)return 1;if(!c.ScalingWidth&&1===c.ScalingHeight)return 3}else return 0;return 2};w.prototype.CFh=function(c){return this.Vid(c,this.normal)?0:this.Vid(c,this.wide)?1:this.Vid(c,this.narrow)?2:3};w.prototype.Vid=function(c,k){return c.Left===k.Left&&c.Right===k.Right&&c.Top===k.Top&&c.Bottom===k.Bottom&&c.Header===k.Header&&c.Footer===k.Footer};w.prototype.HFh=
function(c){var k={};k.ScalingPercent=w.A1b;k.FitToPage=!!c;2===c?(k.ScalingWidth=1,k.ScalingHeight=0):3===c?(k.ScalingWidth=0,k.ScalingHeight=1):1===c&&(k.ScalingWidth=1,k.ScalingHeight=1);return k};w.prototype.X6e=function(c){return this.NDi.contains(c.toString())};w.prototype.b4e=function(c){return 100!==c.ScalingPercent||c.FitToPage&&(1<c.ScalingWidth||1<c.ScalingHeight)};w.prototype.FQg=function(){for(var c=new Qk.a(ci.a.rl()),k=0;k<this.paperSizeOptions.length;k++)c.add(this.paperSizeOptions[k].printSettingOptionKey.toString());
return c};w.prototype.sud=function(c){this.tC.sud(c)};w.prototype.Aud=function(c){this.tC.Aud(c)};w.prototype.Jyi=function(){nd.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};w.prototype.Iyi=function(c){c=qi.a.xg(c.data);nd.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Eb.a.Uc(c))};w.prototype.FFh=function(c){var k=null;if(c){var D=
this.KM.Pu,ba=this.KM.ignorePrintArea;this.K4h(c)&&(this.BUf=!0,c=this.k6c(c));k=new J;k.Pu=D;k.ignorePrintArea=ba;k.orientation=c.IsLandscape?2:1;k.bba=c.PaperSize;k.d_=this.DFh(c);this.isUniversalPrintEnabled&&(k.NoColor=c.NoColor);if(zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintGridlines",!1)||zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintAlignmentsAndHeadings",!1))k.sheetPrintOptions=B.dGa,k.sheetPrintOptions.PrintGrid=c.SheetPrintOptions.PrintGrid,k.FZa=
c.Draft,k.sheetPrintOptions.HorizontalCenter=c.SheetPrintOptions.HorizontalCenter,k.sheetPrintOptions.VerticalCenter=c.SheetPrintOptions.VerticalCenter,k.sheetPrintOptions.PrintHeaders=c.SheetPrintOptions.PrintHeaders;this.Yua&&(k.margin=this.CFh(c.PageMargin),zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&nd.ULS.sendTraceTag(553965398,0,50,"PageMargin received : {0}",k.margin),3===k.margin&&(this.l5={},this.l5.Left=c.PageMargin.Left,this.l5.Right=c.PageMargin.Right,this.l5.Top=
c.PageMargin.Top,this.l5.Bottom=c.PageMargin.Bottom,this.l5.Header=c.PageMargin.Header,this.l5.Footer=c.PageMargin.Footer))}return k};w.prototype.OJ=function(c,k){2===k.vC?this.TJ.clear():1===k.vC&&this.TJ&&this.TJ.contains(k.Jh)&&(nd.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Jk.a(k.Jh.operation.operationName),+k.Jh.dequeueUtcTime-+k.Jh.enqueueUtcTime),this.TJ.remove(k.Jh))};w.prototype.e8=function(){if(this.TJ){for(var c=
Ol(this.TJ),k=c.next();!k.done;k=c.next())k=k.value,this.$&&this.$.userOperationManager&&(k.operation&&nd.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",Jk.a(k.operation.operationName)),this.$.userOperationManager.oZa(k)),this.TJ.remove(k);this.TJ=null}};w.u0c=1;w.t0c=0;w.A1b=100;w.Pob=9;w.o0c=!0;Object(te.a)(w,"PrintSettingsManager",B,[]);Object(te.a)(v,"PrintSettingsTaskPaneCallbacks",null,[]);Object(te.a)(h,"SelectedPrintSettings",
null,[]);Object(te.a)(r,"PrintOperationCallbacks",null,[]);Object(te.a)(n,"PrintPreviewPaneCallbacks",null,[]);var Rk=b(1169);Object(te.a)(l,"UniversalPrintAppSettings",null,[]);var Dk=b(370);d.prototype.Xtg=function(c){this.Oa.addHandler("ppocek",c)};d.prototype.sVi=function(c){this.Oa.removeHandler("ppocek",c)};d.prototype.Ahj=function(c,k){this.eZi();this.$.userOperationManager.jB(Object(qe.a)(this,this.OJ,"onQueueChanged"));this.um=c;this.Oa.raiseEvent("ppocek");this.um.SelectedRanges&&this.um.SelectedRanges.Ranges&&
0<this.um.SelectedRanges.Ranges.length&&this.um.SelectedRanges.Ranges[0]&&(this.selectedRange=Sb.B(this.um.SelectedRanges.Ranges[0]).toString());nd.ULS.shipAssertTag(537154268,0,!this.yu,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.yu=new w(this,this.$,k,this.$.va.qa.name,Ff.a.instance,this.isUniversalPrintEnabled);nd.ULS.shipAssertTag(537154267,0,!this.$f,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.$f=new wj.PrintPreviewPane(this.$,
this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.$f.Y3g();this.$f.Chj();this.$f.otg(Object(qe.a)(this,this.Npf,"onNotifyOperationStatusUpdated"))};d.prototype.YCh=function(){this.yu.l5&&4<=this.yu.marginDetailedOptions.length&&(this.yu.marginDetailedOptions[3].marginValue=this.yu.Esb(this.yu.l5));return this.yu.marginDetailedOptions};d.prototype.yrc=function(){return!!this.um&&!!this.um.ObjectId||!$d.g(this.$).ga.wa.xh};d.prototype.IFh=function(){var c=Object.assign(new h,{selectedWhatToPrint:B.y0g,
selectedOrientation:B.k0g,selectedPaperSize:B.Pob,selectedScaling:B.p0g,selectedMargin:B.j0g,selectedIgnorePrintArea:B.c0g,selectedPrintGridlines:B.dGa.PrintGrid,selectedDraft:B.$_g,selectedHorizontalCenter:B.dGa.HorizontalCenter,selectedVerticalCenter:B.dGa.VerticalCenter,selectedRowAndColumnHeadings:B.dGa.PrintHeaders});this.yG?(c.selectedWhatToPrint=this.yG.Pu,c.selectedOrientation=this.yG.orientation,c.selectedPaperSize=this.yG.bba,c.selectedScaling=this.yG.d_,this.Yua&&(c.selectedMargin=this.yG.margin),
c.selectedIgnorePrintArea=this.yG.ignorePrintArea,this.isUniversalPrintEnabled&&(c.selectedColor=this.yG.NoColor?0:1),this.q7e&&(c.selectedPrintGridlines=this.yG.sheetPrintOptions.PrintGrid,c.selectedDraft=this.yG.FZa),this.p7e&&(c.selectedHorizontalCenter=this.yG.sheetPrintOptions.HorizontalCenter,c.selectedVerticalCenter=this.yG.sheetPrintOptions.VerticalCenter,c.selectedRowAndColumnHeadings=this.yG.sheetPrintOptions.PrintHeaders)):nd.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");
return c};d.prototype.zTe=function(){var c=this;return Object.assign(new n,{onBackToSheet:function(){c.hka()}})};d.prototype.EFh=function(){var c=this;return Object.assign(new Rk.a,{backActionButtonText:Ff.a.instance.da(1145),printPreviewPaneCallbacks:this.zTe(),logger:new ik.a,disableTellMeControl:!0,printOperationCallbacks:Object.assign(new r,{onClosePreviewer:function(){c.hka()},getGraphServiceAuthorizationToken:this.F6b(),onLocalPrint:function(){c.Eqf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),
universalPrintAppSettings:Object.assign(new l,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.x_h()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};d.prototype.GFh=function(){var c=this;return Object.assign(new v,{onSettingChange:function(k){c.wxi(k)},onPrint:function(){c.Eqf()}})};d.prototype.wxi=function(c){this.KZ++;c?(this.$f&&this.$f.tij(),this.kk.Pu=c.selectedWhatToPrint,this.kk.d_=c.selectedScaling,this.kk.orientation=
c.selectedOrientation,this.kk.bba=c.selectedPaperSize,this.isUniversalPrintEnabled&&(this.kk.NoColor=!c.selectedColor),this.Yua&&(this.kk.margin=c.selectedMargin),this.kk.ignorePrintArea=c.selectedIgnorePrintArea,this.n9i(c.selectedPageStart,c.selectedPageEnd),(this.q7e||this.p7e)&&this.yu&&this.rQh(this.kk,c)?(this.kk.sheetPrintOptions=B.dGa,this.kk.sheetPrintOptions.PrintGrid=c.selectedPrintGridlines,this.kk.sheetPrintOptions.HorizontalCenter=c.selectedHorizontalCenter,this.kk.sheetPrintOptions.VerticalCenter=
c.selectedVerticalCenter,this.kk.sheetPrintOptions.PrintHeaders=c.selectedRowAndColumnHeadings,this.yu.vZh(this.kk.sheetPrintOptions)):this.Yub()):nd.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};d.prototype.hka=function(){this.d3a&&(this.FIb=!0);nd.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.KZ);this.Dqf();this.pqe()};
d.prototype.Eqf=function(){nd.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.KZ);this.Yua&&zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&nd.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.kk.margin,this.yG.margin);if(this.useMSPdfViewer)this.uyf();else if(this.J3a)try{this.$f.printPdf(),
this.xWc()}catch(c){nd.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.uyf()}else this.Qga.ITf(this.CFa(!0)),this.xWc()};d.prototype.uyf=function(){var c=this.CFa(!0);this.xWc();gd.HelperMethods.lf(c,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};d.prototype.dispose=function(){qj.a.Fa(this.Oa)};d.prototype.Yub=function(){var c=this;if(this.$.Hua)this.aZh();else{this.e8();this.QIf();var k=null;this.WVh();nd.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var D=function(ba,Ba,nb){ba=new Vk.a(ba,null,Ba,nb,null,!0,!1,"GetFileCopyFileHandler","");ba.correlationID=Sj.a.create().toString();k=ba;c.saa=c.R1.l8(c.CFa(c.J3a?!1:!0,c.q_h?"Base64":"Pdf"),1,null,null,d.F5c,!1,2,Object(qe.a)(c,c.std,"onFileHandlerSuccessCallback"),Object(qe.a)(c,c.rtd,"onFileHandlerFailureCallback"),k,void 0,void 0,void 0,12E4);ba.requestId=c.saa;nd.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",
c.saa);return Ie.Task.Ra(!0)};this.aLa=zg.EwaSettings.pc()?this.$.userOperationManager.jc(new Ne.a(223,0,D,80),null):this.$.userOperationManager.jc(new jj.a(223,0,D,16),null)}};d.prototype.xWc=function(){this.Dqf();this.pqe()};d.prototype.sud=function(c){Eb.a.vq(c.Errors)?this.$f.showErrorMessageForPrintOptions(Ff.a.instance.da(1196)):(nd.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Yub(),this.$f&&this.$f.hideErrorMessageForPrintOptions())};
d.prototype.Aud=function(c){this.$f&&this.$f.showErrorMessageForPrintOptions(Ff.a.instance.da(1196));c=qi.a.xg(c.data);nd.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",Eb.a.Uc(c))};d.prototype.aZh=function(){function c(ba,Ba,nb){var Rb={};Rb.WhatToPrint=k.kk.Pu;Rb.UseNamedAction=k.Qga.Xrc();Rb.SelectedSheetName=k.$.va.qa.name;Rb.ActiveCell=k.activeCell;Rb.SelectedRanges=[k.selectedRange];Rb.IsPdfDocumentRequired=
!1;Rb.Orientation=k.kk.orientation;Rb.PaperSize=k.kk.bba;Rb.Scaling=k.kk.d_;Rb.RichValuesEnabled=!0;Rb.IgnorePrintArea=k.kk.ignorePrintArea;Rb.Preview=!0;k.isUniversalPrintEnabled&&(Rb.NoColor=k.kk.NoColor);k.kRf()&&(Rb.PaginationStartPage=k.Zwa,Rb.PaginationEndPage=k.yka,Rb.OutputTotalPdfPageCount=!0);if(k.Yua){var Ic=k.yu.bad(k.kk.margin);Ic&&(Rb.PageMargin={},Rb.PageMargin.Top=Ic.Top,Rb.PageMargin.Bottom=Ic.Bottom,Rb.PageMargin.Left=Ic.Left,Rb.PageMargin.Right=Ic.Right,Rb.PageMargin.Header=Ic.Header,
Rb.PageMargin.Footer=Ic.Footer)}k.K4a=Z(k.$.ra.ua,Rb,Fd.b(Object(qe.a)(k,k.yqi,"onConvertWorkbookToPdfSucceededInWebParts"),ba),Fd.a(Object(qe.a)(k,k.xqi,"onConvertWorkbookToPdfFailed"),Ba),nb,D);return k.K4a}var k=this;nd.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.e8();var D=this.$.ra.ua.Wb();zg.EwaSettings.pc()?this.aLa=this.$.userOperationManager.jc(new Ne.a(133,0,c,80),null):this.aLa=this.$.userOperationManager.jc(new jj.a(133,
0,c,16),null)};d.prototype.pqe=function(){this.$.userOperationManager.zC(Object(qe.a)(this,this.OJ,"onQueueChanged"));this.e8();this.QIf();nd.ULS.shipAssertTag(537154261,0,!!this.$f,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.$f&&(this.$f.VUi(Object(qe.a)(this,this.Npf,"onNotifyOperationStatusUpdated")),this.$f.g4g(),this.$f=null);this.um=null;this.yu&&(this.yu.dispose(),this.yu=null);this.b0a=this.OBb=null;this.EFc=!1;this.Oa&&this.Oa.raiseEvent("ppocek")};
d.prototype.jdj=function(){return this.$.isEditMode&&!!this.yG&&!!this.kk&&2!==this.kk.Pu&&this.Scd()};d.prototype.qFd=function(){nd.ULS.shipAssertTag(537154260,0,!!this.yu,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.yu&&this.yu.qFd(this.kk,this.jdj())};d.prototype.CFa=function(c,k){k=void 0===k?"Pdf":k;var D=new Sys.StringBuilder;D.append(Zk.a(this.$,k,!0));Kh.a.lg(D,oe.a.Syd,""+this.kk.Pu);c&&this.Qga.Xrc()&&Kh.a.lg(D,oe.a.$3f,"1");Kh.a.lg(D,oe.a.Jzf,this.$.va.qa.name);
this.kk.Pu||(Kh.a.lg(D,oe.a.Izf,this.selectedRange),Kh.a.lg(D,oe.a.Czf,this.activeCell));Kh.a.lg(D,oe.a.Dzf,""+this.kk.orientation);Kh.a.lg(D,oe.a.Ezf,""+this.kk.bba);Kh.a.lg(D,oe.a.Hzf,""+this.kk.d_);Kh.a.lg(D,oe.a.Gzf,"1");Kh.a.lg(D,oe.a.Bzf,this.kk.ignorePrintArea?"1":"0");Kh.a.lg(D,oe.a.Fzf,"1");this.wxg(D);this.isUniversalPrintEnabled&&Kh.a.lg(D,oe.a.RKi,this.kk.NoColor?"1":"0");this.Yua&&this.vxg(D);Cd.a.equals(k,"Pdf",!0)&&(D.append("&#toolbar=0"),zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5687501_PrintPreviewerResetZoomLevel")&&
D.append("&zoom=100"));c=D.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");nd.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",c);return c};d.prototype.n9i=function(c,k){c||k?(this.mvb=!0,this.Zwa=c,this.yka=k):this.fIf()};d.prototype.wxg=function(c){this.kRf()&&(Kh.a.lg(c,oe.a.TKi,""+this.Zwa),Kh.a.lg(c,oe.a.SKi,""+this.yka),Kh.a.lg(c,oe.a.UKi,"1"),nd.ULS.sendTraceTag(537154258,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",
this.Zwa,this.yka))};d.prototype.kRf=function(){return null!=this.Zwa&&0<this.Zwa&&null!=this.yka&&0<this.yka};d.prototype.vxg=function(c){if(this.yu&&this.kk){var k=this.yu.bad(this.kk.margin);k&&Kh.a.lg(c,oe.a.QKi,""+k.Top+" "+k.Bottom+" "+k.Left+" "+k.Right+" "+k.Header+" "+k.Footer)}};d.prototype.std=function(c){if(!(c&&c.data&&c.data.ae&&c.data.responseHeaders&&c.data.ae.length)){var k=c?c.data?c.data.ae?c.data.responseHeaders?c.data.ae.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.$f&&(c=this.gya(Ff.a.instance.da(1146)),this.cma(c,0));nd.ULS.sendTraceTag(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",k);this.nDd&&(c=Object.assign(new Th.a,{extendedProperties:new Map}),c.extendedProperties.set("InvalidParameterName",k),ze.Health.instance.recordQosError(M.a.syf,[wa.a.tyf],
!1,!0,!0,!1,c))}else if(0<this.saa&&c.data.id===this.saa){if(c.data.responseHeaders["Content-Type"]&&(Cd.a.contains(c.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Cd.a.contains(c.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){nd.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var D=null;Cd.a.contains(c.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(D=this.ESg(c));k={};
this.Yzb(k,null,null,D);c.data.responseHeaders["Total-Pdf-PageCount"]?(D=parseInt(c.data.responseHeaders["Total-Pdf-PageCount"].toString()),this.mvb||(this.fyd>=D?this.yka=D:this.mvb=!0),this.J3a&&this.$f&&this.$f.setPageRangeSettings(D,this.fyd,this.mvb,this.Zwa,this.yka)):nd.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else k=Mg.a.Xh(c.data.ae),Eb.a.C8(k.Errors)||xi.a(this.$).fd.lO(k.Errors[0].MessageId),this.ZOi(k.Errors),
this.$f&&(D=this.gya(k.Errors[0].Description),-1831476778===k.Errors[0].MessageId?(nd.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.cma(D,0,Ff.a.instance.da(1149))):this.cma(D,0)),297284985===k.Errors[0].MessageId?nd.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",k.Errors[0].MessageId):nd.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",
k.Errors[0].MessageId);c=c.data.state;c.L3c(k,c.userContext,c.methodName)}};d.prototype.rtd=function(c){var k=this;if(0<this.saa&&c.data.id===this.saa){var D=qi.a.xg(c.data);this.$f&&this.cma(this.gya(D[0].Description),1);nd.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Eb.a.Uc(D));D=c.data.state;D.O9(c,D.userContext,D.methodName);this.$.userOperationManager.l4.operation.mPa(function(){return k.FIb})}};d.prototype.Yzb=function(c,k,D,
ba){this.$f&&(nd.ULS.shipAssertTag(537154255,0,!!this.$.va.qa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.va.qa&&(this.J3a?(Cd.a.ma(ba)&&(ba=this.CFa(!1)),this.$f.gbi(ba)):this.uhj()))};d.prototype.yqi=function(c,k,D){c.Errors&&0<c.Errors.length&&this.$f?(Eb.a.C8(c.Errors)||xi.a(this.$).fd.lO(c.Errors[0].MessageId),this.cma(this.gya(c.Errors[0].Description),0),nd.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
c.Errors[0].MessageId)):(nd.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.Yzb(c,k,D,null))};d.prototype.xqi=function(c){var k=this;c=qi.a.xg(c.data);this.$f&&this.cma(this.gya(c[0].Description),1);nd.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Eb.a.Uc(c));this.$.userOperationManager.l4.operation.mPa(function(){return k.FIb})};d.prototype.Scd=function(){return!this.yG.equals(this.kk)};
d.prototype.Dqf=function(){!this.FIb&&0<this.KZ&&(this.kjd?this.qFd():nd.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));nd.ULS.shipAssertTag(537154250,0,!!this.$f,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.$f&&this.$f.zRh();this.lPd()};d.prototype.ai=function(){nd.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.$f){var c=
this.gya(Ff.a.instance.da(1));this.cma(c,1)}else c=Eb.a.gd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),zg.EwaSettings.eA()?new $k.a(this.$,c):(new Wk.ErrorDialog(this.$,c)).mf()};d.prototype.Bhj=function(c){c?(!c.Pu&&this.yrc()&&(nd.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",this.um.ObjectId?"floatingObject":"discontinuousRange"),c.Pu=1),J.pue(c,this.yG),J.pue(c,this.kk),nd.ULS.shipAssertTag(537154248,
0,!!this.$f,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.$f&&(this.kjd=!0,this.$f.Dhj(),this.Yub())):(nd.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.ai())};d.prototype.Npf=function(c,k){var D=this;if(k)switch(k.WIi){case 1:if(this.kk&&this.b0a)switch(c=this.b0a.Cc,this.b0a.stop(),this.b0a=null,this.kk.Pu){case 1:this.nVc(c,4800,"ActiveSheet");break;case 0:this.nVc(c,6100,"CurrentSelection");
break;case 2:this.nVc(c,7500,"EntireWorkbook")}break;case 0:this.OBb&&(c=this.OBb.Cc,this.OBb.stop(),2400<c&&(k=Object.assign(new Th.a,{extendedProperties:new Map}),k.extendedProperties.set("PaneLoadTime",c.toString()),ze.Health.instance.recordQosError(M.a.Cjj,[wa.a.JUf],!1,!0,!0,!1,k)),this.yu.dZh(function(ba){D.Bhj(ba)}))}};d.prototype.nVc=function(c,k,D){c>k&&(k=Object.assign(new Th.a,{extendedProperties:new Map}),k.extendedProperties.set("WtpSelectedValue",D),k.extendedProperties.set("FullyRenderedPdfLoadTime",
c.toString()),ze.Health.instance.recordQosError(M.a.Bjj,[wa.a.JUf],!1,!0,!0,!1,k))};d.prototype.OJ=function(c,k){(1===k.vC&&this.aLa===k.Jh||2===k.vC)&&this.WDd()};d.prototype.e8=function(){this.aLa&&(0<this.saa||this.K4a)&&(nd.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.saa),this.$.userOperationManager.oZa(this.aLa),this.K4a?qi.a.Ku(this.K4a.Tt):this.R1.Ku(this.saa),this.WDd())};d.prototype.WDd=function(){this.K4a=this.aLa=
null};d.prototype.WVh=function(){this.nDd&&this.kk&&(this.b0a=this.$.Vb.Dc("UserAction",(1===this.kk.Pu?"ActiveSheet":this.kk.Pu?"EntireWorkbook":"CurrentSelection")+"FullyRenderedPdfLoadTimeStopwatch"))};d.prototype.fIf=function(){this.mvb=!1;this.Zwa=1;this.yka=this.fyd};d.prototype.gya=function(c){if(c)return c.replace("&#39;","'");nd.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return c};d.prototype.uhj=function(){nd.ULS.sendTraceTag(537154244,
0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.bwb)if(this.Ccc)nd.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var c=this.gya(Ff.a.instance.da(1150));this.cma(c,2)}else c=this.gya(Ff.a.instance.da(1151)),this.cma(c,3)};d.prototype.cma=function(c,k,D){this.$f.Qy(c,k,void 0===D?null:D)};d.prototype.hWh=function(){this.Ccc=this.Xpe();this.bwb=this.fKg();this.J3a=this.gKg();nd.ULS.sendTraceTag(557061534,
0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",this.Ccc,this.bwb,this.J3a)};d.prototype.eZi=function(){this.I4a=null;this.WDd();this.fIf();this.OBb=this.$.Vb.Dc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.qa.activeCell.toString();this.KZ=0;this.kjd=this.d3a=this.FIb=!1;this.EFc=!0};d.prototype.hfj=function(){var c=this.lcc&&this.V8e()?!0:!1;
nd.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",c);return c};d.prototype.Xpe=function(){return!af.a.aA};d.prototype.PJg=function(){var c=15;af.a.IG&&(Cd.a.ma(af.a.Fpb)||(c=parseFloat(af.a.Fpb)));return this.Xpe()&&14<c&&this.bwb};d.prototype.fKg=function(){var c=this.$.Qf.get(111);return this.lcc?c:c&&!this.V8e()};d.prototype.V8e=function(){return af.a.$z||wd.AFrameworkApplication.isUnifiedHostMode};d.prototype.gKg=function(){return this.Ccc&&this.bwb};d.prototype.QIf=
function(){this.I4a&&(URL.revokeObjectURL(this.I4a),this.I4a=null)};d.prototype.ESg=function(c){var k=c.data.ae;c=this.$.Vb.Dc("UserAction","PrintPreviewBlobFileCreation");var D=window.self.atob(k);k=new Uint8Array(k.length);for(var ba=0;ba<D.length;ba++)k[ba]=D.charCodeAt(ba)&255;D=new Blob([k],{type:"application/pdf"});this.I4a=URL.createObjectURL(D);nd.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",
c.Cc,D.size);c.stop();c=this.I4a+"#toolbar=0";zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5687501_PrintPreviewerResetZoomLevel")&&(c+="&zoom=100");return c};d.prototype.ZOi=function(c){if(this.nDd&&Eb.a.Yg(c,d.ZEi)){var k=Object.assign(new Th.a,{extendedProperties:new Map});k.extendedProperties.set("ErrorMessageIdName",c[0].MessageIdName);ze.Health.instance.recordQosError(M.a.syf,[wa.a.tyf],!1,!0,!0,!1,k)}};d.prototype.rQh=function(c,k){return c.sheetPrintOptions.PrintGrid!==k.selectedPrintGridlines||
c.sheetPrintOptions.HorizontalCenter!==k.selectedHorizontalCenter||c.sheetPrintOptions.VerticalCenter!==k.selectedVerticalCenter||c.sheetPrintOptions.PrintHeaders!==k.selectedRowAndColumnHeadings};d.prototype.lPd=function(){this.jjd&&this.$.De(-1753588160,-1,0,null)};d.prototype.x_h=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};d.prototype.getToken=function(){return this.asd.aR("Print",this.graphServiceEndpoint).then(function(c){return c?
(c.IsSuccess||nd.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",c.ErrorCode,c.ErrorMessage),c):Object.assign(new Pi.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(c){var k=new Pi.a;Object.getType(c)===Object.getType(k)?k=c:(k.ErrorMessage=c.toString(),k.ErrorCode="exception");return Promise.resolve(k)})};d.prototype.F6b=function(){var c=this;return function(){var k=Promise.resolve("");
try{if(c.asd&&c.asd.NJa())return c.getToken().then(function(D){return D.IsSuccess?Promise.resolve(D.Token):k},function(){return k})}catch(D){nd.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",D)}return k}};d.prototype.onNotifyPrintJobStatus=function(c,k){c=Dk.a.Nx.notificationBar.n9(c,!1);c.displayTimeoutSeconds=10;c.image="failure"===k?1:"success"===k?3:0;Dk.a.Nx.notificationBar.fD(c)};Ll.Object.defineProperties(d.prototype,{J4h:{configurable:!0,
enumerable:!0,get:function(){return this.EFc}}});d.ZEi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];d.F5c=["Content-Type","Total-Pdf-PageCount"];Object(te.a)(d,"PrintPreviewManager",null,[792,6,793]);e.prototype.Wc=function(){return!1};e.prototype.executeCommand=function(c,k,D,ba){var Ba=k.command;return 1588554917===Ba?(k.tvb=!0,ck.a(this.$)&&this.$.ea.Ba(423).qsc(!1),this.L4g(k)?Ie.Task.Ra(!0):
u.a(Ba)):this.qyf.executeCommand(c,k,D,ba,Object(qe.a)(this,this.dxi,"onPageLayoutCommandSuccess"),Object(qe.a)(this,this.cxi,"onPageLayoutCommandFailure"),Object(qe.a)(this,this.Zrj,"triggerBlockRendering"))};e.prototype.Ec=function(c,k){return 1588554917===k.command?(nd.ULS.shipAssertTag(537154305,0,this.$.Q$,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.qyf.Ec(c,k)};e.prototype.Yc=function(){return!1};e.prototype.L4g=function(c){return this.$.fa.lc?
this.M4g(c):!1};e.prototype.M4g=function(c){nd.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var k=this.$.Vb.Dc("UserAction","DoPrintHtml"),D=this.$,ba=this.fa.isNamedObjectViewMode?D.wb.qa.sheetName:D.va.qa.name,Ba=this.fa.isNamedObjectViewMode,nb=!Ba;D=this.BFh(D,ba,nb);var Rb=!0;!zg.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Hua&&(Rb=!1);nb?Rb?uk.a(this.$)?nd.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):
(this.tC.Ahj(D,this.KM),nd.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new N(this.$,Ff.a.instance.da(1159),3,D,c,this.Qga,ba,this.KM)).mf(),nd.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",k.Cc)):((new da(this.$,Ff.a.instance.da(1159),3,D,c)).mf(),nd.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",k.Cc,
Ba));k.stop();this.scd();return!0};e.prototype.BFh=function(c,k,D){var ba={};ba.SessionId=this.fa.sessionId;ba.UsedRangeTooBig=!1;var Ba=$d.g(c),nb=Ba.ga,Rb=nb.Qe;if(Uj.e(c.qa))ba.Type=0,ba.ObjectId=c.qa.name,ba.UseSelection=!1;else if(Uj.g(c.qa))ba.Type=1,ba.ObjectId=c.qa.Eia,ba.UseSelection=!0;else if(2===Rb||4===Rb||64===Rb){var Ic=nb.Pa.kc.floatingObject;ba.Type=1;ba.SheetName=k;ba.ObjectId=Ic.id;ba.UseSelection=!0}else if(D&&Rb&470)ba.ObjectId=nb.Pa.kc.floatingObject.id,ba.SheetName=k;else if(Uj.i(c.qa)){ba.Type=
2;ba.SheetName=k;if(nb.wa.xh)if(D=nb.wa.Nd,ba.SelectedRanges=Sb.q(D,c),20<D.BO)ba.UseSelection=!0;else{k=0;Ba=Ba.mm("PrintCommandHandler.DoPrintHtml",D);try{for(Ba.$$rst();Ba.$$mn()&&2>k;)Ic=Ba.$$cu(),Cd.a.ma(Ic.text)||k++;ba.UseSelection=2<=k}finally{Ba&&Ba.dispose()}}else ba.UseSelection=!1,ba.SelectedRanges=Sb.q(nb.wa.activeRange,c);this.fa.isNamedObjectViewMode&&(ba.UsedRange=Sb.v(c.qa.usedRange,c))}ba.Title=c.workbookContext.WorkbookFileName;return ba};e.prototype.scd=function(){$d.g(this.$);
if(!this.uRf){this.jLc=!0;var c=this.$.Vb.Dc("UserAction","HandlePageLayoutRendering");this.msj();nd.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",c.Cc);c.stop()}};e.prototype.msj=function(){for(var c=$d.g(this.$).Ca,k=c.iG(),D=!1,ba=0,Ba=0;Ba<k.length;Ba++){var nb=k[Ba],Rb=nb.Wf;Rb&&Rb.hasPageLayout()&&(D=!0,Rb.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+nb.Rd,4),ba++)}D&&(nd.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",
k.length,ba),c.Jrd())};e.prototype.Zrj=function(){var c=$d.g(this.$).Ca;this.jLc=!0;c.Jrd()};e.prototype.dxi=function(){this.scd()};e.prototype.cxi=function(c,k,D){nd.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",D);this.scd()};Ll.Object.defineProperties(e.prototype,{uRf:{configurable:!0,enumerable:!0,get:function(){return this.jLc}}});Object(te.a)(e,"PrintCommandHandler",null,[160,777]);var al=Tf.a;Em(a,al);a.prototype.Gd=function(){var c=
this,k=wd.AFrameworkApplication.ha.appSettings,D=this.$.ya.DirectPrintSetting;k.DirectPrintIsEnabled=D.DirectPrintIsEnabled.toString();k.DirectPrintProbeIsEnabled=D.DirectPrintProbeIsEnabled.toString();k.DirectPrintEnabledForInternetExplorer=D.DirectPrintEnabledForInternetExplorer.toString();k.DirectPrintSupportedMimeTypes=D.DirectPrintSupportedMimeTypes;k.DirectPrintSupportedPlugins=D.DirectPrintSupportedPlugins;k.DirectPrintImmersivePreviewPlugins=D.DirectPrintImmersivePreviewPlugins;k.DirectPrintMinimalSupportedEdgeVersion=
D.DirectPrintMinimalSupportedEdgeVersion;k.DirectPrintEnabledForEdge=D.DirectPrintEnabledForEdge.toString();k=new xa(k);var ba=null;D=null;try{D=window.navigator.mimeTypes}catch(Rb){nd.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var Ba=null;try{Ba=window.navigator.plugins}catch(Rb){nd.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}ba=new na(k,D,Ba,na.y4e,na.J8e,new ib(wd.AFrameworkApplication.xa.bW),wd.AFrameworkApplication.xa.MC,na.K8e,function(Rb,
Ic){return new Pa(Rb,!1,Ic)},!1);if(zg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Qf.get(116)){var nb=Xf.GetServiceTaskFactory.Va(this.$.ea,349,350,this.rb,"Microsoft.Office.Excel.WebUI.Client.OAuth.IOAuthManagerWrapper");ia.TaskExtensions.Aa(nb,function(){var Rb=new e(c.$,ba,nb.result);c.Ad([Rb])},this.$.la)}else this.Ad([new e(this.$,ba,null)])};a.ja=function(c){Tf.a.Yd(73,new a(c))};Object(te.a)(a,"PrintCommandHandlerFactory",Tf.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");uh.a.Li(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");Hg.main();Type.registerNamespace("Common.App.NewAndOpen.UX");Wg.a.instance.ej(new qd);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Ma.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");$g.main();Type.registerNamespace("Common.App.SaveToSharePoint");Rg.main();Type.registerNamespace("Common.App.SaveToCloudStorage");wc.main();Type.registerNamespace("Common.App.SaveACopy");
je.main();Type.registerNamespace("Common.App.SharedFilePicker");Ag.main();Type.registerNamespace("Common.App.WildFire");Sc.main();uf.a.Ga(Yd.ja);uf.a.Ga(sg.ja);uf.a.Ga(hf.ja);uh.a.Li(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
uf.a.Ga(Ke.ja);uh.a.Li(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){uf.a.Ga(function(c){bb.ja(c)})})();(function(){uf.a.Ga(function(c){c.ea.Ia(165,new Nb(c))})})();uf.a.Ga(we.ja);(function(){uf.a.Ga(function(c){c.ea.Ia(57,new Ve(c));c.ea.Ia(60,new od(c));c.ea.Ia(63,new mc(c))})})();uf.a.Ga(hd.ja);uf.a.Ga(Wd.ja);uf.a.Ga(ub.ja);uh.a.Li(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){uf.a.Ga(function(c){Nd.ja(c);ce.ja(c)})})();uh.a.Li('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
uh.a.Li(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){uf.a.Ga(function(c){Pc.ja(c);Lb.ja(c)})})();uf.a.Ga(sa.ja);uf.a.Ga(yd.ja);(function(){uf.a.Ga(function(c){Lc.ja(c);Ab.ja(c)})})();uf.a.Ga(Db.ja);uf.a.Ga(ic.ja);(function(){uf.a.Ga(function(c){Na.ja(c);eb.ja(c)})})();uf.a.Ga(Ga.ja);(function(){uf.a.Ga(function(c){ta.ja(c);xb.ja(c)})})();Type.registerNamespace("Common.App.DirectPrint");Wg.a.instance.ej(new La);uf.a.Ga(a.ja)},812:function(C,
F,b){function a(S,Q){var L=H.call(this,document.createElement("div"))||this;L.Aw=null;L.uW=null;L.P6=null;L.taa=null;L.zZb=null;L.jce=null;L.Che=null;L.Xaf=null;L.e$b=!1;L.tG=!1;L.Wta=!1;L.VIa=!1;L.j0=S;L.YF=Q;L.bSc=Q.dmb.toString();L.title=Q.title;L.message=Q.message;L.set_visibilityMode(1);return L}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(86),l=b(278),n=b(13),r=b(117),h=b(90),v=b(37);F=b(230);var w=b(1158),t=b(18),B=b(4),z=b(313),x=b(52),y=b(11),J=b(68),E=b(16),A=b(20),H=F.a;Em(a,
H);a.prototype.dispose=function(){d.a.mc([this.zZb,this.uW,this.P6]);this.tG&&this.uW&&(l.a.instance.za(n.a.click,this.uW.domElement,Object(v.a)(this,this.osd,"onActionClickHandler")),r.KeyInputManager.instance.Mu(this.domElement,this.jce));this.Wta&&this.P6&&(l.a.instance.za(n.a.click,this.P6.domElement,Object(v.a)(this,this.wsd,"onAltActionClickHandler")),r.KeyInputManager.instance.Mu(this.domElement,this.Che));this.VIa&&this.taa&&(l.a.instance.za(n.a.click,this.taa,Object(v.a)(this,this.Vtd,"onLinkClickHandler")),
r.KeyInputManager.instance.Mu(this.domElement,this.Xaf));this.taa=this.Aw=this.j0=this.P6=this.uW=null;H.prototype.dispose.call(this)};a.prototype.LYc=function(){var S="<div class='"+w.a.u$g+"' id='{0}'><div class='"+w.a.s$g+"'><a class='"+w.a.A$g+"' title='{1}'><span class='"+t.a.jWc+" "+w.a.w$g+"' id='{2}'>";this.Nj.length&&(S+="<img class='{3}' src='{4}'/>");S+="</span></a><span class='"+w.a.z$g+"' id='{5}'>{6}</span><span class='"+w.a.y$g+"' id='message'>{7}</span><a id='link' href='#' class='"+
w.a.x$g+"'>{8}</a><span class='"+w.a.uEe+"'><button type='button' id='action' class='"+w.a.tEe+"'>{9}</button></span><span class='"+w.a.uEe+"'><button type='button' id='altAction' class='"+w.a.tEe+"'>{10}</button></span></div><a class='"+w.a.v$g+"' tabindex='0' role='button'><span id='close' class='"+t.a.sB+"'><img class='"+t.a.e4c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement);var Q=this.businessBar.$.Jb,
L=Q+"ewaBusinessBarEntryBody"+this.bSc,aa=Q+"ewaBusinessBarEntryTitle"+this.bSc;Q=Q+"ewaBusinessBarEntryIcon"+this.bSc;this.domElement.className=w.a.t$g;this.domElement.innerHTML=String.format(S,L,this.alt,Q,this.Nj,x.a.ve(0),aa,this.title,this.message,this.linkText,this.actionButton,this.aWb,x.a.ve(13),E.a.instance.da(759));y.DOMElementExtensions.fo(this.domElement,B.a.Afa,aa,L);this.taa=$get("link",this.domElement);y.DOMElementExtensions.setVisible(this.taa,this.VIa);this.VIa&&(l.a.instance.pa(n.a.click,
this.taa,Object(v.a)(this,this.Vtd,"onLinkClickHandler")),this.Xaf=r.KeyInputManager.instance.Cr(this.taa,Object(v.a)(this,this.Vtd,"onLinkClickHandler"),h.a.Ph,h.a.W_));this.uW=new z.a(y.DOMElementExtensions.getElementById(this.domElement,"action"));this.uW.isVisible=this.tG;this.P6=new z.a(y.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.P6.isVisible=this.Wta;this.tG&&(l.a.instance.pa(n.a.click,this.uW.domElement,Object(v.a)(this,this.osd,"onActionClickHandler")),this.jce=
r.KeyInputManager.instance.Cr(this.uW.domElement,Object(v.a)(this,this.osd,"onActionClickHandler"),h.a.Ph,h.a.W_),this.Wta&&(l.a.instance.pa(n.a.click,this.P6.domElement,Object(v.a)(this,this.wsd,"onAltActionClickHandler")),this.Che=r.KeyInputManager.instance.Cr(this.uW.domElement,Object(v.a)(this,this.wsd,"onAltActionClickHandler"),h.a.Ph,h.a.W_)));this.Aw=$get("close",this.domElement);this.zZb=this.Hd.yd(this.Aw);this.zZb.ja("click",Object(v.a)(this,this.NJ,"onCloseClick"));this.zZb.ja("keydown",
Object(v.a)(this,this.Opi,"onCloseKeyDown"));y.DOMElementExtensions.setVisible(this.Aw,!this.e$b)};a.prototype.cq=function(){e.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.YF.hash,this.YF.Z2c);A.g(this.businessBar.$).lq(!0)};a.prototype.fka=function(){e.ULS.sendTraceTag(537170257,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.YF.hash);A.g(this.businessBar.$).lq(!0)};a.prototype.nka=function(){e.ULS.sendTraceTag(537170256,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.YF.hash);A.g(this.businessBar.$).lq(!0)};a.prototype.NJ=function(S){e.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.YF.hash,this.YF.Z2c);this.set_visible(!1);this.businessBar.removeEntry(this.yFg);J.g(S)};a.prototype.Opi=function(S){13===S.keyCode&&this.NJ(S)};a.prototype.osd=function(S){this.cq(S.yb);return!0};a.prototype.wsd=function(S){this.fka(S.yb);return!0};a.prototype.Vtd=
function(S){this.nka(S.yb);return!0};Ll.Object.defineProperties(a.prototype,{yFg:{configurable:!0,enumerable:!0,get:function(){return this.YF.dmb}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.j0}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.YF?this.YF.actionButton:""}},aWb:{configurable:!0,enumerable:!0,get:function(){return this.YF?this.YF.aWb:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.YF?this.YF.link:""}},Nj:{configurable:!0,
enumerable:!0,get:function(){return this.YF?this.YF.Nj:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.YF?this.YF.alt:""}}});Object(C.a)(a,"BusinessBarEntry",F.a,[])},889:function(C,F,b){function a(G,N,Y,V){var da=W.call(this)||this;da.uE=null;da.uC=null;da.wQ=null;da.qA=null;da.LCb=null;da.SJ=null;da.Oec=null;da.Vxb=null;da.Uxb=!1;da.Nua=!0;da.okc=null;da.ewaAccessibilityManager=null;da.eyd=null;da.dyd=null;da.hyd=null;da.Ygd=!1;da.$=G;da.tC=N;da.FWg();da.lcc=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",
!1);da.useMSPdfViewer=Y;da.isUniversalPrintEnabled=V;da.j6c=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5768956_FixCtrlF6LoopForPdfViewer");return da}function e(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function d(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=
this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function l(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function n(G){this.$f=G}function r(G){this.$f=G}function h(G){this.$f=G}function v(G){var N=S.call(this)||this;N.WIi=G;return N}b.r(F);C=b(0);var w=b(15);b(23);var t=b(381),B=b(37),z=b(36),x=b(58),y=b(11),J=b(121),E=b(1),A=b(16),H=b(20),S=Sys.EventArgs;Em(v,S);Object(C.a)(v,"PrintPreviewPaneOperationStatusEventArgs",
Sys.EventArgs,[]);var Q=b(257),L=b(245);h.prototype.Og=function(){Q.a(this.$f.$).OL(this.Vd)||Q.a(this.$f.$).Og(this)};h.prototype.z6=function(){Q.a(this.$f.$).OL(this.Vd)&&Q.a(this.$f.$).sA(this)};h.prototype.rh=function(G){return y.DOMElementExtensions.Ue(this.Ib,G)};h.prototype.Uh=function(){this.$f.$.frame.Me.Wj(this.$f.$.frame.Me.BD)};h.prototype.Nh=function(){};h.prototype.Le=function(G,N){return N?!1:(this.$f.enterPrintPreviewHeaderFocusTrapZone(),!0)};Ll.Object.defineProperties(h.prototype,
{Vd:{configurable:!0,enumerable:!0,get:function(){return L.a.vyf}},Ib:{configurable:!0,enumerable:!0,get:function(){var G=b(889).PrintPreviewPane;return document.getElementById(G.VIi)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(C.a)(h,"PrintPreviewHeaderKeyboardAccessibleSection",null,[120]);r.prototype.Og=function(){Q.a(this.$f.$).OL(this.Vd)||Q.a(this.$f.$).Og(this)};r.prototype.z6=function(){Q.a(this.$f.$).OL(this.Vd)&&Q.a(this.$f.$).sA(this)};r.prototype.rh=
function(G){return y.DOMElementExtensions.Ue(this.Ib,G)};r.prototype.Uh=function(){this.$f.$.frame.Me.Wj(this.$f.$.frame.Me.BD)};r.prototype.Nh=function(){};r.prototype.Le=function(G,N){return N?!1:(this.$f.useMSPdfViewer&&this.$f.j6c?(G=document.getElementById(b(889).PrintPreviewPane.cwd))&&y.DOMElementExtensions.setFocus(G,!0):y.DOMElementExtensions.setFocus(this.$f.SJ),!0)};Ll.Object.defineProperties(r.prototype,{Vd:{configurable:!0,enumerable:!0,get:function(){return L.a.wyf}},Ib:{configurable:!0,
enumerable:!0,get:function(){var G=b(889).PrintPreviewPane;return this.$f.useMSPdfViewer&&this.$f.j6c?document.getElementById(b(889).PrintPreviewPane.cwd):document.getElementById(G.Uvf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(C.a)(r,"PrintPreviewKeyboardAccessibleSection",null,[120]);n.prototype.Og=function(){Q.a(this.$f.$).OL(this.Vd)||Q.a(this.$f.$).Og(this)};n.prototype.z6=function(){Q.a(this.$f.$).OL(this.Vd)&&Q.a(this.$f.$).sA(this)};n.prototype.rh=
function(G){return y.DOMElementExtensions.Ue(this.Ib,G)};n.prototype.Uh=function(){this.$f.$.frame.Me.Wj(this.$f.$.frame.Me.BD)};n.prototype.Nh=function(){};n.prototype.Le=function(G,N){return N?!1:(this.$f.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Ll.Object.defineProperties(n.prototype,{Vd:{configurable:!0,enumerable:!0,get:function(){return L.a.zyf}},Ib:{configurable:!0,enumerable:!0,get:function(){var G=b(889).PrintPreviewPane;return document.getElementById(G.gyd)}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return!0}}});Object(C.a)(n,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[120]);Object(C.a)(l,"MSPdfViewerFileUrl",null,[]);Object(C.a)(d,"PrintSettingsTaskPaneProps",null,[]);Object(C.a)(e,"ViewerPaneProps",null,[]);var aa=b(1169),fa=b(373);b.d(F,"PrintPreviewPane",function(){return a});var W=z.a;Em(a,W);a.prototype.otg=function(G){this.addHandler(a.rzb,G)};a.prototype.VUi=function(G){this.removeHandler(a.rzb,G)};a.prototype.Chj=function(){this.BWg()};a.prototype.Dhj=
function(){var G=this.$.Vb.Dc("UserAction","createSettingsPaneStopwatch"),N=document.getElementById(a.gyd);this.GWg();var Y=this.HWg();this.uC.createPrintSettingsTaskPane(N,Y);G.stop();this.Uxb=!1;if(this.isUniversalPrintEnabled&&this.qA){G="A4";switch(Y.selectedPrintSettingsValues.selectedPaperSize){case 8:G="A3";break;case 9:G="A4";break;case 11:G="A5";break;case 12:G="JIS B4";break;case 13:G="JIS B5";break;case 5:G="North America Legal";break;case 1:G="North America Letter";break;case 6:G="North America Invoice";
break;case 7:G="North America Executive";break;case 3:G="North America Ledger"}this.uE.setDocumentSettings({mediaSize:G,orientation:2===Y.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===Y.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.UAd()};a.prototype.setPageRangeSettings=function(G,N,Y,V,da){this.uC&&(this.uC.setPageRangeSettings(G,N,Y,V,da),this.cPf(String.format(A.a.instance.Bb(194),V,da,G)))};a.prototype.zRh=function(){this.qA&&
(this.qA.style.display="none")};a.prototype.g4g=function(){this.dispose();this.dQd();this.duj();this.uE&&this.uE.closePrintPreviewPane();this.wQ=this.uC=this.uE=this.qA=null};a.prototype.gbi=function(G){w.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.Vxb=this.$.Vb.Dc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||w.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.wQ.renderPdf(G)):
this.SJ&&((this.Oec=this.$.Vb.Dc("UserAction","loadPdfStopwatch"))||w.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.Uxb=!0,this.SJ.src&&this.SJ.src===G?this.nof(null):this.SJ.src=G);if(this.isUniversalPrintEnabled&&this.qA){var N=fa.b(this.$.workbookContext);this.uE.setFileUrl(G,N)}};a.prototype.onPdfLoad=function(){this.Vxb?(w.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.Vxb.Cc,
this.Nua),this.Vxb.stop()):w.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.rzb,new v(1));this.hideWaitCursor();this.vHd()};a.prototype.printPdf=function(){y.DOMElementExtensions.setFocus(this.SJ);this.SJ.contentWindow.print()};a.prototype.tij=function(){this.showSpinner();this.showWaitCursor();this.cPf("")};a.prototype.HRh=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.Qy=function(G,N,Y){this.qA&&this.wQ&&
(this.Ygd=!1,this.wQ.showErrorDetails(N,G,void 0===Y?null:Y),this.tC.d3a=!0,this.SJ&&(this.SJ.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.v4h(N)&&(this.Ygd=!0,this.gxi()))};a.prototype.hidePreviewError=function(){this.tC.d3a=!1;this.wQ.hidePreviewError();this.enablePrintButton()};a.prototype.Y3g=function(){(this.LCb=document.getElementById(a.xyf))&&this.LCb.parentNode&&this.LCb.parentNode.removeChild(this.LCb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.uC&&this.uC.hideErrorMessageForPrintOptions()};
a.prototype.showErrorMessageForPrintOptions=function(G){this.uC&&this.uC.showErrorMessageForPrintOptions(G)};a.prototype.showSpinner=function(){this.tC.d3a||E.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Ygd?this.hidePreviewError():this.SJ&&(this.SJ.style.visibility="hidden");this.wQ&&this.wQ.showSpinner()};a.prototype.hideSpinner=function(){this.wQ&&this.wQ.hideSpinner()};a.prototype.enablePrintButton=function(){this.uC&&this.uC.enablePrintButton();this.isUniversalPrintEnabled&&
this.qA&&this.uE.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.uC&&this.uC.disablePrintButton();this.isUniversalPrintEnabled&&this.qA&&this.uE.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.uC&&this.uC.showWaitCursor();this.isUniversalPrintEnabled&&this.qA&&this.uE.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.uC&&this.uC.hideWaitCursor();this.isUniversalPrintEnabled&&this.qA&&this.uE.updatePrintButtonEnableDisableState(!0)};
a.prototype.nof=function(){w.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",this.Uxb);this.Uxb&&(this.HRh(),this.SJ.style.visibility="visible",this.Oec?this.Oec.stop():w.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),this.raiseEvent(a.rzb,new v(1)),this.vHd(),this.Uxb=!1)};a.prototype.DWg=function(){this.qA?w.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null"):
(this.qA=document.createElement("div"),this.qA.id=a.xyf,this.qA.classList.add(a.XIi),this.$.Yq.insertBefore(this.qA,this.$.Yq.firstChild))};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.uE.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.uE.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.OGi=function(){var G=this;this.$.ea.$a(15,function(N){G.ewaAccessibilityManager=N;G.ewaAccessibilityManager.mode=3})};a.prototype.FWg=
function(){this.hyd=new n(this);this.eyd=new r(this);this.dyd=new h(this)};a.prototype.UAd=function(){this.hyd.Og();this.eyd.Og();this.dyd.Og();this.OGi()};a.prototype.dQd=function(){this.hyd.z6();this.eyd.z6();this.dyd.z6();H.g(this.$).n_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.pV=function(){this.okc=J.a.instance.yd(this.SJ);this.okc.ja("load",Object(B.a)(this,this.nof,"onIframeContentChange"))};a.prototype.duj=function(){this.okc&&this.SJ&&this.okc.detach("load")};
a.prototype.vHd=function(){if(this.Nua){var G=document.getElementById(a.gyd);G&&(G=y.DOMElementExtensions.getElementById(G,a.ryf))&&(this.Nua=!1,G.focus())}};a.prototype.gxi=function(){this.tC.d3a=!1;this.enablePrintButton();this.vHd()};a.prototype.BWg=function(){var G=this;x.GetServiceTaskFactory.Va(this.$.ea,283,284,0,"Common.IDynamicScriptLoaderProvider").result.Cp.loadScript("excelPrintPreviewer").then(function(){var N=G.$.Vb.Dc("UserAction","createEmptyPreviewerStopwatch");G.DWg();G.EWg();G.isUniversalPrintEnabled?
G.uE.createEmptyPrintPreviewPaneAsync(G.qA,G.qwe()).then(function(){N.stop();G.fte();G.uE.updatePrintButtonEnableDisableState(!1)}):(G.uE.createEmptyPrintPreviewPane(G.qA,G.qwe()),N.stop(),G.fte())})};a.prototype.fte=function(){var G=this.$.Vb.Dc("UserAction","createPdfPreviewPaneStopwatch"),N=document.getElementById(a.cwd);this.useMSPdfViewer&&this.j6c&&(N.tabIndex=0);this.oWg();this.nWg(N);G.stop();this.raiseEvent(a.rzb,new v(0))};a.prototype.EWg=function(){this.uE||(this.uE=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());
this.uE||w.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.GWg=function(){this.uC||(this.uC=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.uC||w.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.oWg=function(){this.wQ||(this.wQ=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());
this.wQ||w.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.nWg=function(G){this.lcc?this.wQ.createPrintPreviewPane(G,this.RYg()):this.wQ.createPrintPreview(G);this.useMSPdfViewer||(this.SJ=y.DOMElementExtensions.getElementById(this.qA,a.Uvf),this.SJ.title=A.a.instance.da(1147),this.pV())};a.prototype.HWg=function(){var G=null,N="en-US";E.EwaSettings.isChangeGateEnabled("OfficeVSO:5840596_FixJSCrashInMarginUnit")&&
(G=this.$.ya.IsMetricMeasurementUnit,this.$.ya.DataCultureTag?N=this.$.ya.DataCultureTag:w.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable"));return Object.assign(new d,{whatToPrintOptions:this.tC.yu.whatToPrintOptions,orientationOptions:this.tC.yu.orientationOptions,paperSizeOptions:this.tC.yu.paperSizeOptions,scalingOptions:this.tC.yu.scalingOptions,marginDetailedOptions:this.tC.YCh(),selectedPrintSettingsValues:this.tC.IFh(),
printSettingsTaskPaneCallbacks:this.tC.GFh(),logger:new t.a,shouldDisableCurrentSelection:this.tC.yrc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:G,dataCultureTag:N,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.qwe=function(){return this.isUniversalPrintEnabled?this.tC.EFh():Object.assign(new aa.a,{backActionButtonText:A.a.instance.da(1145),printPreviewPaneCallbacks:this.tC.zTe(),logger:new t.a,disableTellMeControl:!0})};a.prototype.RYg=function(){var G=this;
return this.useMSPdfViewer?Object.assign(new e,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.DVg(),onPdfLoad:function(){G.onPdfLoad()}}):Object.assign(new e,{useMSPdfViewer:!1})};a.prototype.DVg=function(){return Object.assign(new l,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.cPf=function(G){this.qA&&this.uE.setAdditionalHeaderText(G)};a.v4h=function(G){return 3===
G||2===G};a.xyf="PrintPreviewerContainer";a.gyd="printSettingsTaskPaneId";a.cwd="previewId";a.Uvf="printpreviewiframe";a.VIi="printPreviewHeaderId";a.ryf="printButton";a.XIi="PrintPreviewerContainer";a.rzb="pppnosu";Object(C.a)(a,"PrintPreviewPane",z.a,[817])},959:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(5),l=b(48),n=b(23);a.bOe=function(r,h){switch(r){case 3:return a.oLh(h);case 2:return a.JEh(h);case 1:return a.lzh(h)}return""};a.oLh=function(r){switch(r){case 1:return d.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return d.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkWordWac.toString()}return""};a.JEh=function(r){switch(r){case 1:return d.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return d.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.lzh=function(r){switch(r){case 1:return d.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return d.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};
a.openInClient=function(r,h,v){if(n.a.ah||n.a.lp)window.setTimeout(function(){a.tCf(v,a.W8b())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.kie(v),r,0,!1)};a.SLg=function(r,h,v,w){h&&w&&w();a.openInClient(r,h,v)};a.W8b=function(){return n.a.ah?1:n.a.lp?2:n.a.B4a?3:n.a.isMac?4:0};a.kLh=function(r){switch(r){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.lLh=function(r){switch(r){case 3:return"WildFireWordBizBarFlight";
case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};a.tCf=function(r,h){1===h?(e.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),r=a.bOe(r,h),8<n.a.n2a?l.a.lf(r,void 0,void 0,"RedirectToAppStore"):l.a.lY(r)):document.hidden||(a.jcc?(r=d.AFrameworkApplication.ha.appSettings.WildFireUrlChinaStoreAndroid.toString())?(e.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),l.a.lY(r)):e.ULS.sendTraceTag(18088019,306,50,
"Empty Url in China Proxy Page BRS Setting"):(e.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.bOe(r,h),null,null)))};a.kie=function(r){switch(r){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.h8c=function(r){switch(r){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.qid=function(r){return(r=a.VBh(r))&&""!==r?Boolean.parse(r):!1};a.mId=
function(r){a.A8i(r)};a.VBh=function(r){try{return localStorage.getItem(r)}catch(h){return e.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}};a.A8i=function(r){try{localStorage.setItem(r,"true")}catch(h){e.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}};Ll.Object.defineProperties(a,{jcc:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},
Vrc:{configurable:!0,enumerable:!0,get:function(){return(n.a.B4a||n.a.isMac)&&n.a.Co}},Iej:{configurable:!0,enumerable:!0,get:function(){return n.a.ah||n.a.lp}}});a.eqe="ChromeExtensionBarDismiss";Object(C.a)(a,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=EwaDS.kmhv.js.map