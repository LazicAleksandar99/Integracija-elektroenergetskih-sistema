(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1199:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);a.gyc="b-ring_Apc_Trans";a.W6f="cdn_static_resource_ewa_image";Object(C.a)(a,"ResourceHosts",null,[])},1244:function(C,F,b){function a(){}function e(v,w,t,B,z){this.url="";this.A2a=!1;this.q6=-1;this.testIteration=0;this.baseUrl=t;this.mlf=B;this.Mdd=w;this.result=new d(w,z)}function d(v,w){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=
this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=v;this.caller=w;this.reset()}C=b(0);var l=b(55),n=b(15),r=b(279);d.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(C.a)(d,"NetworkTestResult",null,[]);var h=b(593);e.prototype.fFd=function(){try{if(this.A2a)n.ULS.sendTraceTag(537155206,0,
50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.Mdd);else{this.reset();this.A2a=!0;this.result.startTimeMs=Date.now();var v=new r.QueryStringBuilder(this.baseUrl);v.k8("tid",this.result.startTimeMs.toString());this.url=v.toString();this.j4i();this.testIteration++;this.result.testIteration=this.testIteration}}catch(w){this.Dqb("Exeption: "+w.message)}};e.prototype.reset=function(){this.url="";this.result.reset();this.A2a=!1;this.q6=-1};e.prototype.clearTimeout=
function(){-1!==this.q6&&(window.clearTimeout(this.q6),this.q6=-1)};e.prototype.j4i=function(){var v=this;try{var w=new XMLHttpRequest;w.onreadystatechange=function(){4===w.readyState&&(200===w.status?v.anh():v.Dqb(String.format("Error when downloading resource. status code: {0}, status text: {1}",w.status,w.statusText),w.status.toString()))};w.onerror=function(){v.Dqb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",w.status,w.statusText))};this.q6=
window.setTimeout(function(){v.q6=-1;v.Dqb("Request timeout")},1E4);w.open("GET",this.url,!0);w.send(null)}catch(t){this.Dqb("Exeption: "+t.message)}};e.prototype.anh=function(){this.A2a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=h.a(this.url),this.result.isSuccess=!0,this.ZZb())};e.prototype.Dqb=function(v,w){w=void 0===w?null:w;this.A2a&&(this.clearTimeout(),this.result.errorMessage=v,this.result.isSuccess=!1,this.result.errorStatusCode=
w,this.ZZb())};e.prototype.ZZb=function(){this.A2a=!1;this.mlf&&this.mlf(this.result,this.Mdd)};Object(C.a)(e,"NetworkTestReq",null,[]);b.d(F,"a",function(){return a});a.E7c=function(v,w,t,B){B=void 0===B?null:B;a.Qgc||(a.Qgc=Array.isArray(l.a.Xh(t.ya.NetworkMeasurementUrlList))?l.a.Xh(t.ya.NetworkMeasurementUrlList):null);for(var z=[],x=0;x<a.Qgc.length;x++){var y=a.Qgc[x],J=y.key;J||(J=y.Key);if(!B||Array.contains(B,J)){var E=y.value;E||(E=y.Value);J&&E&&z.push(new e(t,J,E,v,w))}}return z};a.Qgc=
null;Object(C.a)(a,"NetworkConnectionHelpers",null,[])},1359:function(C,F,b){function a(T){var Oa=mj.call(this)||this;Oa.$=T;Oa.Yb();return Oa}function e(T,Oa,Eb,vc){this.$J=null;this.$=T;this.Olc=Oa;this.pt=Eb;this.hk=vc;this.Vld=this.Hld=null;this.dZ=this.E4b=this.i2b=this.f$b=!1;this.ASd=0;this.$.ea.Ia(406,this)}function d(T){var Oa=zg.call(this)||this;Oa.$=T;Oa.Yb();return Oa}function l(T,Oa,Eb){Eb=void 0===Eb?!0:Eb;var vc=Oh.call(this)||this;vc.UPa=null;vc.dma=null;vc.gMa=null;vc.l_b=null;vc.s_=
null;vc.mhf=0;vc.I8a=!1;vc.H8a=!1;vc.tmc=!1;vc.documentVisibilityObserver=null;vc.nhf=null;vc.zij=null;vc.Yda=!1;vc.o6=0;vc.Eed=0;vc.mwb=!1;vc.rUf=0;vc.GJd=!1;vc.G_=null;vc.iSb=E.Jai;vc.DXc=E.connected;vc.$=T;vc.qf=T.ra.qf;vc.yRf=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");vc.gHb=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");vc.Drc=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");Eb&&(vc.nhf=
new h(T,Oa));Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&vc.$.ea.$a(291,function(gd){vc.documentVisibilityObserver=gd});vc.Drc&&(Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||vc.$.ea.$a(291,function(gd){vc.documentVisibilityObserver=gd}),vc.mhf=vc.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,vc.qf.mtg(Object(za.a)(vc,vc.HAb,"onNetworkDownEvent")),vc.qf.vkb(Object(za.a)(vc,vc.Ipf,"onNetworkResumedEvent")),
vc.qf.hfe(Object(za.a)(vc,vc.rlf,"onConnectivityIssuesBeganEvent")),vc.qf.Lrg(Object(za.a)(vc,vc.slf,"onConnectivityIssuesEndedEvent")));if(vc.yRf||vc.gHb)vc.zij=new n(vc.$,vc);vc.idf=vc.$.ya.LongInactivityTimePeriodSeconds;vc.$.fa.bQc(Object(za.a)(vc,vc.Lsf,"onSilentReopenDueToTimeoutOrDeploymentInitiated"));vc.$.fa.wf.Vpa(Object(za.a)(vc,vc.Vaa,"onThrottledUserActivity"));vc.gHb&&(vc.rUf=vc.$.ya.SilentReopenDuringWorkDelayMs);return vc}function n(T){this.f6=null;this.$=T;this.pg=lg.a(this.$).pg;
this.pg.Mfe(Object(za.a)(this,this.bpf,"onLongInactivitySilentReopenPartialInteractivityStatusChanged"));this.pg.xug(Object(za.a)(this,this.Msf,"onSilentReopenDuringWorkPartialInteractivityStatusChanged"))}function r(T,Oa,Eb,vc){T=J.call(this,T,Oa,Eb)||this;T.wasInteruptedByOfflineMode=!1;T.type=vc;T.wasInteruptedByOfflineMode=!1;return T}function h(T,Oa){this.Tja=this.Uqd=this.ijf=null;this.$=T;!Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||Se.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
hf.a.uf||(this.ijf=new v(T,Oa));Se.EwaSettings.ka(214)&&(this.Uqd=new B(this.$),this.Uqd.sUh());!Se.EwaSettings.ka(595)||Se.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&hf.a.uf||(this.Tja=new dh.NetworkConnectionHealthChecker(this.$));this.oPg=new z(this.$)}function v(T,Oa){this.fMa=this.eT=null;this.Wxd=-1;this.Qqb=null;this.eaf=je.Task.delay(0);this.$=T;this.indexedDB=Oa;this.u5f=!1;this.indexedDB.Yf()&&(this.indexedDB.initialize(v.Led,v.Med),this.qXi(),this.fMa=
new t(this.$.ya.UserSessionId),lg.a(this.$).pg.HPc(Object(za.a)(this,this.L6a,"onOfflineModePartialInteractivityStatusChanged")));this.hk=Ld.a.instance.BB();this.hk.ja("beforeunload",Object(za.a)(this,this.Lzb,"onBeforeUnload"))}function w(T,Oa,Eb){T=J.call(this,T,Oa,Eb)||this;T.timeFromLastOffline=0;T._errorDataDuringOfflineMode=null;T.timeFromLastOffline=-1;T.type=5;return T}function t(T){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=
[];this.sessionID=T}function B(T){var Oa=this;this.pJf=null;this.Rld=this.Spd=this.zzb=this.Azb=0;this.NJd=!1;this.tXc=this.ZPa=this.Nsc=this.P5a=null;this.HXc=0;this.$=T;if(this.OJd=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.aKg())this.pJf=[Ff.a.gyc],this.HXc=1,this.tXc={},this.$.fa.wf.Vpa(Object(za.a)(this,this.Vaa,"onThrottledUserActivity")),this.$.ea.$a(291,function(Eb){Eb.LDa(Object(za.a)(Oa,Oa.QU,"onDocumentHidden"));Eb.okb(Object(za.a)(Oa,Oa.wwa,
"onDocumentUnhidden"))})}function z(T){this.iec=this.data=null;this.d5c=0;this.qte=null;this.$=T;lg.a(this.$).pg.ife(Object(za.a)(this,this.tlf,"onConnectivityIssuesStatusChanged"));this.$.qf.hfe(Object(za.a)(this,this.qlf,"onConnectivityIssuesBegan"))}function x(){}function y(T,Oa,Eb,vc,gd,Cd){T=J.call(this,T,Oa,vc)||this;T.swappedByOffline=!1;T.swappedOffline=!1;T.averageDurationBetweenFailedRequestsSec=0;T.longestDurationBetweenFailedRequestsSec=0;T.lastFailedRequestToOnlineTimeGapSec=0;T.disconnectionSource=
null;T.errorDataDuringConnectivityIssuesMode=null;T.failedRequests=[];T.triggeringRequest=null;T.type=4;T.swappedOffline=Eb;T.disconnectionSource=Enum.toString(jh.a,gd);T.triggeringRequest=Cd;return T}function J(T,Oa,Eb){this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=
!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.startTime=T;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=Eb;Oa.fa&&Oa.fa.wf&&(this.wasUserActiveOnPIStart=Oa.fa.wf.Fq);this.Uj(Oa);Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Oa.zb.tQ,T=Oa.ea.Ba(183),this.isTaskPaneShown=!!T&&T.isVisible&&!T.isCollapsed,this.isTaskPaneCollapsed=!!T&&T.isVisible&&T.isCollapsed):this.isTaskPaneCollapsed=
this.isTaskPaneShown=this.isDialogShown=!1}function E(){}function A(T){var Oa=Yf.call(this)||this;Oa.Kc=T;Oa.Yb();return Oa}function H(T,Oa,Eb){Eb=void 0===Eb?null:Eb;var vc=Ne.call(this)||this;vc.KXa=null;vc.r2a=null;vc.gac=null;vc.TAa=null;mc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");vc.$=T;vc.Dhb=new U(T);vc.PUh(T,Eb);Eb=Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DPMOWaitsForMergeToEnd",!1);vc.gea=new Z(vc.TAa,vc.Dhb,!Eb);vc.xDd=new S(T,vc.gea,Oa,
Eb);Se.EwaSettings.ka(257)&&(vc.gac=new na(T,vc));mc.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created");return vc}function S(T,Oa,Eb,vc,gd,Cd){gd=void 0===gd?null:gd;Cd=void 0===Cd?null:Cd;var Fd=rf.call(this)||this;Fd.FAe=null;Fd.wla=null;Fd.jpb=null;Fd.Vwb=0;Fd.D4a=null;Fd.Wwb=null;Fd.$=T;Fd.nqa=Eb;Fd.K3i=Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1);Fd.K3i&&(Fd.wla=new Q(Fd.$));Fd.LU=Oa;Fd.LU.Ytg(Object(za.a)(Fd,Fd.Xqf,"onReadyForPendingMergesUpdated"));
Fd.LU.uVb(Object(za.a)(Fd,Fd.mBb,"onTogglePendingMergeBlockedByClient"));Fd.LU.gtg(Object(za.a)(Fd,Fd.gpf,"onMergeCounterChanged"));Fd.$.ra.Wpa(Object(za.a)(Fd,Fd.gAa,"webServiceAdjustContextEventHandler"));Fd.ua=Fd.$.ra.ua;Fd.q9a=Fd.$.ya.MergeSuspensionRequestThrottlingTimeInMs;Fd.r9h=Fd.$.ya.KeepBlockingPendingMergesRequestIntervalMs;Fd.Gze=vc;Fd.Gze?(Fd.FAe=gd?gd:new G(Fd.ua,Fd.$,null,null,Fd.wla),mc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")):Cd?Fd.jpb=Cd:$g.TaskExtensions.Aa(Zd.GetServiceTaskFactory.Va(Fd.$.ea,
12,477,3,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),function($d){var Ae=new fa(Fd.ua,Fd.$);Fd.jpb=$d.result.Unb(Ae,Ae,null,"RequestController");mc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");2===Fd.LU.getState()&&Fd.dMf(Fd.LU.f8b())},Fd.$.la);return Fd}function Q(T){var Oa=this;this.htc=0;this.p1=this.sJ=null;this.ufa=new aa;this.Sg=function(){Oa.Gke(!0)};this.l6a=function(){Oa.Gke(!1)};this.$=T;this.gridView=Bf.g(this.$);this.gridView.Ca.Np(this.Sg);
this.gridView.Ca.Pp(this.l6a);this.gridView.Ca.Zee(this.l6a);this.gridView.Ca.nfa(this.l6a);this.AXi=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5712698_ReportDivergenceInSelectionAdjust")}function L(T,Oa,Eb,vc,gd){this.iF=Oa;this.W7=Eb;this.rSb=vc;this.e9f=gd;this.kyc&&(this.BVd=Bf.g(T).Ca.q0a(this.selectedRanges[0],gd))}function aa(){this.errors=this.ord=this.n1c=this.xQc=this.yQc=0}function fa(T,Oa,Eb){this.wva=null;this.ua=T;this.q9a=Oa.ya.MergeSuspensionRequestThrottlingTimeInMs;var vc=Oa.ya.GetRangeContentPrefetchDelayForMergeInMs;
this.Es=function(){Oa.zFd(vc)};this.Kg=(void 0===Eb?null:Eb)||Te.a.Qa;this.mcb=new Date(0);return this}function W(){}function G(T,Oa,Eb,vc,gd){this.wva=null;this.gvd=0;this.agd=!1;this.ua=T;this.q9a=Oa.ya.MergeSuspensionRequestThrottlingTimeInMs;var Cd=Oa.ya.GetRangeContentPrefetchDelayForMergeInMs;this.Es=function(){Oa.zFd(Cd)};this.Kg=(void 0===Eb?null:Eb)||Te.a.Qa;this.mcb=new Date(0);this.pN=void 0===vc?null:vc;this.wla=void 0===gd?null:gd;this.rpj=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5889975_ThrottleOnlyEqualSuspensionStartTimestamp")}
function N(T,Oa,Eb,vc,gd,Cd,Fd){Fd=T.Na(1,void 0===Fd?null:Fd);Fd.suspensionStartTimestamp=Oa;return bc.i(T,"KeepBlockingPendingMerges",Fd,Eb,vc,gd,Cd,0)}function Y(T,Oa,Eb,vc,gd,Cd,Fd){Fd=T.Na(1,void 0===Fd?null:Fd);Fd.viewportState=Oa;return bc.i(T,"DoPendingMergeWithSelectionAdjust",Fd,Eb,vc,gd,Cd,0)}function V(T,Oa,Eb,vc,gd,Cd){Cd=T.Na(1,void 0===Cd?null:Cd);return bc.i(T,"DoPendingMerge",Cd,Oa,Eb,vc,gd,0)}function da(){}function U(T){var Oa=Pd.call(this)||this;Oa.F0=null;Oa.lec=0;Oa.dIf();Oa.$=
T;Oa.$.ra.Yr(Object(za.a)(Oa,Oa.fAa,"webMethodSuccessEventHandler"));Oa.$.fa.Yj(Object(za.a)(Oa,Oa.Wpc,"sessionReloadEventHandler"));Oa.$.fa.nO(Object(za.a)(Oa,Oa.Wpc,"sessionReloadEventHandler"));Bf.g(Oa.$).Gc.Xr(Object(za.a)(Oa,Oa.s6a,"onEditCellEnded"));Oa.$.ea.$a(292,function(Eb){Eb.tkb(Object(za.a)(Oa,Oa.Hyb,"mergeCounterUpdatedEventHandler"));mc.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});return Oa}function Z(T,Oa,Eb){var vc=fd.call(this)||this;vc.kga=T;vc.kga.rVb(Object(za.a)(vc,
vc.AMa,"onSafeStateChanged"));vc.v7a=Oa;vc.v7a.tkb(Object(za.a)(vc,vc.BAb,"onMergeCounterUpdated"));vc.D4=Object.assign(new Gb.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});vc.PG=vc.OUh();vc.c8g=Eb;vc.Cnh=Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMergeSuspensionCheck",!1);return vc}function ca(T){var Oa=$b.call(this)||this;Oa.Zua=T;return Oa}function ra(T,Oa){return T||Oa?T&&Oa?T.Current===Oa.Current&&T.Pending===Oa.Pending&&T.SuspensionStartTimestamp===Oa.SuspensionStartTimestamp:
!1:!0}function La(T){return T?String.format("{0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp):null}function na(T,Oa){var Eb=ja.call(this)||this;Eb.statusBarManager=null;Eb.grd=!1;Eb.mergeSuspensionManager=Oa;Eb.mergeSuspensionManager.v7a.tkb(Object(za.a)(Eb,Eb.BAb,"onMergeCounterUpdated"));Eb.Tgc="";m.a.e1(1905775613,K.a.Ic,0,1);Eb.Ka=T.Ka;Eb.lJb=new ma;T.ea.$a(29,function(vc){Eb.mergeSuspensionManager&&(Eb.statusBarManager=vc,vc.sI(Eb),Eb.mergeSuspensionManager.kga.rVb(Object(za.a)(Eb,
Eb.AMa,"onSafeStateChanged")))});Eb.Ka.f1(Eb.lJb);return Eb}function ma(){return ka.call(this)||this}function xa(T,Oa){Oa=void 0===Oa?null:Oa;var Eb=u.call(this)||this;Eb.noa=!1;Eb.$=T;Eb.k0d=Oa?Oa:ia.a(T).vP(Xf.a.idle);ia.a(T).pPc(Object(za.a)(Eb,Eb.Flf,"onCurrentActivityChanged"));Eb.q2a.Qp(Object(za.a)(Eb,Eb.zM,"onIdleActivityStatusChanged"));Eb.refresh();return Eb}function Pa(){var T=Tf.call(this)||this;T.caf=null;T.yOa=new Uf.a;return T}function ib(T,Oa){this.handler=null;this.publisher=T;this.PG=
Oa}function pb(T){var Oa=uf.call(this)||this;Oa.noa=!1;Oa.gridView=Bf.g(T);Oa.gridView.Gc.Jm(Object(za.a)(Oa,Oa.Bkf,"onCellTextEditStarted"));Oa.gridView.Gc.Xr(Object(za.a)(Oa,Oa.Akf,"onCellTextEditEnded"));Oa.refresh();return Oa}function xb(T){return be.call(this,T)||this}function Ya(T){this.$=T}function ab(T,Oa,Eb,vc,gd,Cd){Eb=lb.call(this,null,Eb,vc)||this;Eb.sdf=0;Eb.$=T;Eb.Zd=Oa;Eb.C_=Cd;Eb.cie=Ef.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Eb.showDialog();
return Eb}function ea(T,Oa,Eb,vc,gd,Cd){var Fd=hb.call(this)||this;Fd.Zbc=!1;Fd.vua=null;Fd.yQ=null;Fd.Kxb=null;Fd.Kn=Cd;Fd.$=T;Fd.Z1e=Oa;Fd.Vkb=Eb;Fd.pya=[];Fd.Gff=vc;Fd.w2g=gd;Fd.yhe=Fd.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;Fd.tf=Fd.SUg();return Fd}function ta(){}function Ka(T,Oa){return Fi.call(this,T,ci.a.k$(Oa))||this}function mb(T,Oa,Eb,vc,gd,Cd,Fd){T=Ha.call(this,T,Oa,Eb,vc,gd,!1)||this;T.BRd=!1;T.C_=Fd;T.V$b=mb.hrh(Cd);if(Cd=T.aSd(T.V$b.name,T.V$b.size))return T.lTf(Cd),T.C_.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),
T.dispose(),T;T.tj=new eb(T.$.domElement,Object(za.a)(T,T.pBb,"onUploadFrameInitialized"),Object(za.a)(T,T.Sma,"uploadResponseReceived"),vc,!1,T.$);return T}function Ha(T,Oa,Eb,vc,gd,Cd){Cd=void 0===Cd?!0:Cd;Eb=lb.call(this,null,Eb,vc)||this;Eb.Oq=null;Eb.O9=null;Eb.Fwb=!1;Eb.zwd=null;Eb.ub=T;Eb.Zd=Oa;Eb.MSd=T.Vb.yi("WebServiceCall","InsertPictureOperation");Eb.SWb=ih.a.instance.create(Object(za.a)(Eb,Eb.HAi,"onTimeoutReached"),1E5,eg.a.DFi,!1);Eb.Auc=!1;Eb.fpd=Eb.$.ya.InsertPictureMaxFileSizeBytes;
gd&&(Eb.Fwb="TestOnly"in gd);Cd&&Eb.showDialog();return Eb}function Ga(T,Oa){this.dataUri=this.sheetName=null;this.sheetName=T;this.dataUri=Oa}function Fa(T,Oa,Eb){var vc=kb.call(this,T,!1)||this;vc.xT=null;vc.dza=!1;vc.$=Oa;vc.zwc=T;vc.nu=Zg.a.instance;vc.ha=Eb;vc.SPf();vc.gU();vc.$.zb.xJ=!0;return vc}function eb(T,Oa,Eb,vc,gd,Cd,Fd){T=db.call(this,T,Oa,Eb,vc,gd,"UploadFrame",Cd.fa.sessionId,"image/*",!1,null,void 0===Fd?!1:Fd)||this;T.$=Cd;T.Z3f=!0;Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?
T.O1e():T.yie();return T}function db(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae,$e,qg){Ae=void 0===Ae?!0:Ae;qg=void 0===qg?!1:qg;this.gKe="FileUpload.ashx";this.An=null;this._initialized=!1;this.Ig=this.jfb=this.BCc=this.Vea=this.pOb=this.pq=this.Rr=null;this.hm=!1;this.tR=this.qOb=this.ZMc=null;this._parent=T;this.ceg=Oa;this.zig=Eb;this.l_d=gd;this.XKc=Fd;this.nUd=$d;this.nWd=void 0===$e?null:$e;this.YMc=!1;this.veg=vc.sa("CanaryRenewalForFileUploadIsEnabled");this.Z3f=!1;(this.Poa=qg)||this.$Rg(Cd);Ae&&this.O1e()}
function Na(T,Oa,Eb){if(T){var vc=0;do{try{T();break}catch(gd){if(mc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",vc,Eb,gd.message,gd.stack),vc>=Oa)break}vc++}while(1)}}function kb(T,Oa){return ha.call(this,T,void 0===Oa?!0:Oa)||this}function Tb(){}function ha(T,Oa){Oa=void 0===Oa?!0:Oa;var Eb=Sf.call(this,!1,!1,ha.Cx)||this;Eb.uUa=null;Eb.JZd=!1;Eb.Im=[];Eb.tj=null;Eb.uTb=T;Eb.njg=Oa;Eb.eae=!1;Eb.Qt=!1;Eb.Vea=null;Eb.CCc=!1;
Eb.tf=Eb.v2g;Eb.Ie="InsertFileDialog";Eb.yc(1,Eb.TTb);if(ha.Cx){T={};Oa={};var vc={};Eb.uUa=(vc.id=Eb.Ie,vc.bodyControls=(Oa.uploadButtonProps=(T.label=CommonUIStrings.l_DialogChooseFile,T.onExecute=Object(za.a)(Eb,Eb.lBi,"onUploadButtonClick"),T),Oa),vc.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,vc.onFrameReady=Object(za.a)(Eb,Eb.qsi,"onFrameReady"),vc);Eb.initializeAndShow(Eb.titleText,Object(za.a)(Eb,Eb.zac,"insertDialogHandler"),Eb.uUa);Eb.RNb=!0}else Eb.showDialog(Eb.titleText,Object(za.a)(Eb,
Eb.zac,"insertDialogHandler")),Oa&&Eb.SPf(),(T=Eb.NT(1))&&Eb.Im.push(T),(T=Eb.NT(0))&&Eb.Im.push(T),Eb.O2f(),Eb.RNb=!1;return Eb}function lb(T,Oa,Eb){T=Wa.call(this,T,Oa,Eb)||this;T.Epa=null;T.$Qb=null;return T}function Wa(T,Oa,Eb){this.tj=this.Zud=null;this.SCa=this.hpa=0;this.rOb=null;this.sR=T;this.fe=Oa;this.vb=Eb;this.tZa=!1;this.BRd=!0;this.hZi();this.K5a=this.ha.sa("NativeFileOpenDialogIsEnabled")}function Ra(T,Oa){this.filename=T;this.blob=Oa}function Yb(T){var Oa=ff.call(this)||this;Oa.Ced=
null;Oa.$=T;Oa.Yb();return Oa}function oc(T){var Oa=Td.call(this)||this;Oa.$=T;Oa.Yb();return Oa}function zb(T,Oa){this.nLe=T;this.vnh=Oa}function uc(T){this.$=T}function P(T){var Oa=Ie.call(this)||this;Oa.$=T;Oa.Yb();return Oa}function lc(T,Oa,Eb){var vc=Hc.call(this)||this;vc.statusBarManager=null;vc.$=T;vc.pt=Oa;vc.hk=Eb;vc.W2c=!1;vc.oSf=Se.EwaSettings.getBooleanFeatureGate(md.a.pNa,!1);vc.oSf&&vc.$.ea.$a(29,function(gd){vc.statusBarManager=gd;gd.sI(vc)});return vc}function Ec(T){var Oa=X.call(this)||
this;Oa.$=T;Oa.Bm=Hf.a.instance;Oa.Yb();return Oa}function tc(T){this.Y0b="";this.$0=this.dr=null;this.Zkc=!1;this.gridView=Bf.g(T);this.gridView.ga.HF(Object(za.a)(this,this.hide,"hide"))}function cc(){}function Zb(T,Oa){T=Ih.call(this,T)||this;T.xo=null;T.Eh(Oa);return T}function Aa(T){this.tzc=this.FJc=null;this.$=T}function Ia(){}function qb(){}function wb(){}function ic(){}function Jb(T){this.kYc=this.jra=null;this.s7a=15;this.$=T}function Ua(T,Oa){this.$=T;this.nlb=Oa}function $a(T,Oa,Eb,vc){T=
Od.call(this,T)||this;T.isFromCurrentSession=!1;T.top=0;T.left=0;T.isFromCurrentSession=Oa;T.top=Eb;T.left=vc;return T}function ua(T,Oa,Eb,vc,gd){gd=void 0===gd?null:gd;var Cd=Qa.call(this,T,"ArtCopyPasteHandler")||this;Cd.dMg="XLO";Cd.eMg="3";Cd.PB=T;Cd.lT=new jc(T);Cd.W8=Oa;Cd.FWa=Eb;Cd.ga=Bf.g(T).ga;Cd.mYc=gd||new fb(Cd.W8);Cd.MEi=new Ca(Eb,T);Cd.nlb=vc;return Cd}function Ca(T,Oa){this.DEb=new gb.a;this.FWa=T;this.$=Oa;this.kKi=function(Eb){return Promise.resolve(Eb)};this.PAb=function(Eb){return Promise.reject(Eb)}}
function Sa(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){this.promise=null;this.ribbonCommandInfo=T;this.destination=Oa;this.Xye=Eb;this.LRd=gd;this.o_=Cd;this.item=Fd;this.pasteContext=$d;this.DLa=Eb||Oa.FirstRow+"_"+Oa.FirstColumn;this.W5e=!0;this.$qe=Ae}function Qb(T,Oa,Eb,vc,gd,Cd,Fd){this.floatingObjectId=T;this.commandParameters=Oa;this.Oq=Eb;this.GZg=vc;this.V2=void 0===Cd?null:Cd;this.LRd=void 0===Fd?null:Fd;this.eRg=gd}function Hb(T,Oa,Eb,vc){Oa=sb.call(this,T,Oa,Eb,"AcrossSessionRangeCopyPasteHandler",void 0===
vc?null:vc)||this;Oa.lT=new jc(T);return Oa}function Db(T,Oa){Oa=void 0===Oa?null:Oa;var Eb=ae.call(this,nd[T])||this;Eb.copyErrorName=0;Eb.ewaErrors=null;Eb.copyErrorName=T;(Eb.ewaErrors=Oa)&&Oa.length&&(Eb.innerError=new Qg.a(Oa,null));return Eb}function jc(T){this.lT=new Kf.a(!0);this.$=T}function sb(T,Oa,Eb,vc,gd){gd=void 0===gd?null:gd;vc=Qa.call(this,T,vc)||this;vc.nRg=Oa;vc.W8=Eb;vc.nYc=gd||new fb(vc.W8);vc.gridView=Bf.g(T);vc.ga=vc.gridView.ga;vc.clipboardRangeFactory=T.ea.Ba(169);return vc}
function fb(T){this.clipboardItems=this.key=null;this.W8=T}function Qa(T,Oa){this._name=Oa;this.$=T;this.Bm=Hf.a.instance;this.fr=new Nc(T,Bf.g(T))}function cb(T){return T.shadowWorkbookSizeExceedsLimit?!0:Ab(T)>mf.a.Tfc}function Ab(T){return T?T.shadowWorkbookSizeExceedsLimit&&void 0!==T.shadowWorkbookBlockedSize&&null!==T.shadowWorkbookBlockedSize?T.shadowWorkbookBlockedSize:T.shadowWorkbookBase64?T.shadowWorkbookBase64.length:0:0}function gc(){}function Lc(T){var Oa={};this.wWf=(Oa["SourceItemType.Range"]=
0,Oa["SourceItemType.Art"]=1,Oa);this.gIb={};Oa={};this.sWf=(Oa["FloatingObjectType.Unknown"]=99,Oa["FloatingObjectType.CardView"]=6,Oa["FloatingObjectType.Chart"]=0,Oa["FloatingObjectType.Group"]=7,Oa["FloatingObjectType.Image"]=1,Oa["FloatingObjectType.Ink"]=8,Oa["FloatingObjectType.InteractiveReport"]=4,Oa["FloatingObjectType.ModernOfficeExtension"]=3,Oa["FloatingObjectType.Shape"]=5,Oa["FloatingObjectType.Slicer"]=2,Oa["FloatingObjectType.Unsupported"]=100,Oa);Oa={};this.xRc=(Oa["99"]="FloatingObjectType.Unknown",
Oa["6"]="FloatingObjectType.CardView",Oa["0"]="FloatingObjectType.Chart",Oa["7"]="FloatingObjectType.Group",Oa["1"]="FloatingObjectType.Image",Oa["8"]="FloatingObjectType.Ink",Oa["4"]="FloatingObjectType.InteractiveReport",Oa["3"]="FloatingObjectType.ModernOfficeExtension",Oa["5"]="FloatingObjectType.Shape",Oa["2"]="FloatingObjectType.Slicer",Oa["100"]="FloatingObjectType.Unsupported",Oa);Oa={};this.vWf=(Oa["RibbonCommand.Copy"]=-911352779,Oa["RibbonCommand.Cut"]=-1985798686,Oa);Oa={};this.GEd=(Oa["-911352779"]=
"RibbonCommand.Copy",Oa["-1985798686"]="RibbonCommand.Cut",Oa);Oa={};this.uWf=(Oa["InputManager.InputMethod.NotDefined"]=-1,Oa["InputManager.InputMethod.Unknown"]=0,Oa["InputManager.InputMethod.Keyboard"]=1,Oa["InputManager.InputMethod.Mouse"]=2,Oa["InputManager.InputMethod.Touch"]=3,Oa["InputManager.InputMethod.CrossSlide"]=9,Oa);this.Mia={};Oa={};this.tWf=(Oa["FrameMode.None"]=0,Oa["FrameMode.Reading"]=1,Oa["FrameMode.Edit"]=2,Oa);this.Z_a={};Oa={};this.xWf=(Oa["UILocation.Unknown"]=0,Oa["UILocation.UpperRibbon"]=
1,Oa["UILocation.Ribbon"]=2,Oa["UILocation.QAT"]=3,Oa["UILocation.Jewel"]=4,Oa["UILocation.NavigationPane"]=5,Oa["UILocation.KeyboardShortcut"]=6,Oa["UILocation.StatusBar"]=7,Oa["UILocation.Dialog"]=8,Oa["UILocation.Floatie"]=9,Oa["UILocation.NotificationBar"]=10,Oa["UILocation.StandaloneCuiRoot"]=11,Oa["UILocation.TaskPane"]=12,Oa["UILocation.HeroDock"]=13,Oa["UILocation.SingleLineRibbon"]=14,Oa["UILocation.MultilineRibbon"]=15,Oa["UILocation.Overflow"]=16,Oa["UILocation.TellMe"]=17,Oa["UILocation.FarPeripheralControls"]=
18,Oa["UILocation.ContextMenu"]=19,Oa["UILocation.DialogMenu"]=20,Oa["UILocation.Header"]=21,Oa["UILocation.FileMenu"]=22,Oa["UILocation.Toolbar"]=26,Oa["UILocation.Canvas"]=30,Oa);this.Sq={};this.$=T;this.Mia.notDefined="InputManager.InputMethod.NotDefined";this.Mia.unknown="InputManager.InputMethod.Unknown";this.Mia.keyboard="InputManager.InputMethod.Keyboard";this.Mia.mouse="InputManager.InputMethod.Mouse";this.Mia.touch="InputManager.InputMethod.Touch";this.Mia.crossSlide="InputManager.InputMethod.CrossSlide";
this.Z_a.none="FrameMode.None";this.Z_a.reading="FrameMode.Reading";this.Z_a.edit="FrameMode.Edit";this.Sq.unknown="UILocation.Unknown";this.Sq.upperRibbon="UILocation.UpperRibbon";this.Sq.ribbon="UILocation.Ribbon";this.Sq.QAT="UILocation.QAT";this.Sq.jewel="UILocation.Jewel";this.Sq.navigationPane="UILocation.NavigationPane";this.Sq.keyboardShortcut="UILocation.KeyboardShortcut";this.Sq.statusBar="UILocation.StatusBar";this.Sq.dialog="UILocation.Dialog";this.Sq.floatie="UILocation.Floatie";this.Sq.notificationBar=
"UILocation.NotificationBar";this.Sq.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Sq.taskPane="UILocation.TaskPane";this.Sq.heroDock="UILocation.HeroDock";this.Sq.singleLineRibbon="UILocation.SingleLineRibbon";this.Sq.multilineRibbon="UILocation.MultilineRibbon";this.Sq.overflow="UILocation.Overflow";this.Sq.tellMe="UILocation.TellMe";this.Sq.farPeripheralControls="UILocation.FarPeripheralControls";this.Sq.header="UILocation.Header";this.Sq.fileMenu="UILocation.FileMenu";this.Sq.contextMenu=
"UILocation.ContextMenu";this.Sq.dialogMenu="UILocation.DialogMenu";this.Sq.toolbar="UILocation.Toolbar";this.Sq.canvas="UILocation.Canvas";this.gIb.range="SourceItemType.Range";this.gIb.art="SourceItemType.Art"}function Nc(T,Oa){this.pbc=Se.EwaSettings.getBooleanFeatureGate(md.a.G0b,!1);this.nKa=Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=T;this.gridView=Oa}function yd(T){this.parameters=null;this.parameters=T}function Od(T){this.pasteParameters=
null;this.pasteParameters=T}function sa(T,Oa){this.content=this.destinationRange=null;this.destinationRange=T;this.content=Oa}function vb(T,Oa,Eb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=T;this.destinationRange=Oa;this.pasteFlags=Eb}function Lb(T,Oa,Eb,vc,gd,Cd,Fd,$d){$d=void 0===$d?null:$d;Fd=T.Na(1,void 0===Fd?null:Fd);Fd.pasteParameters=Oa;return bc.i(T,"Paste",Fd,Eb,vc,gd,Cd,64,$d)}function rc(T,Oa,Eb,vc,gd,Cd,Fd,$d){$d=void 0===$d?null:$d;Fd=T.Na(1,void 0===
Fd?null:Fd);Fd.copyParameters=Oa;return bc.i(T,"Copy",Fd,Eb,vc,gd,Cd,0,$d)}function Oc(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){Ae=void 0===Ae?null:Ae;$d=T.Na(9,$d);$d.destinationRange=Oa;$d.source=Eb;return bc.i(T,"PasteString",$d,vc,gd,Cd,Fd,64,Ae)}function Bb(T,Oa,Eb,vc,gd,Cd,Fd,$d){$d=void 0===$d?null:$d;Fd=T.Na(1,Fd);Fd.pasteHtmlParameters=Oa;return bc.i(T,"PasteHtmlContent",Fd,Eb,vc,gd,Cd,64,$d)}function hc(){this.aYa=this.cre=null}function Pc(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){Ae=void 0===Ae?null:Ae;var $e=Kc.call(this)||
this;$e.pasteShortcutManager=null;$e.G3e=Se.EwaSettings.GG();$e.nKa=Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);$e.FYf=null;$e.d4a=!1;$e.p3e=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5747219_BlockModifyingProtectedRangeOnProtectedSheet");$e.$=T;$e.ji=Eb;$e.gridView=Bf.g(T);$e.fr=gd;$e.zXh=Cd;$e.FJ=Oa;$e.P_b=vc;$e.getStringifiedError=Ae?Ae:copyPasteInfra.getStringifiedError;$e.mSf=1===$d;$e.Uj();$e.copyPasteShortcutDialogFactory=$e.$.ea.Ba(85);
mc.ULS.shipAssertTag(537167825,0,!!$e.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");Fd||(mc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Fd=Pc.x0g);$e.userHash=Jg.a.jv(Fd);$e.Yhi="CultureTag: "+Hf.a.instance.Qob+" HASH: ";$e.FJ.addMetadataChangeListener(Pc.Yff,Object(za.a)($e,$e.bud,"onMetadataChanged"));$e.hpd=$e.$.ya.MaxCopyPasteLength;$e.JLa=$e.nKa?Se.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
$e.$.ya.CopyPasteMaxPayloadLength):mf.a.JLa;$e.Sn=Se.EwaSettings.getBooleanFeatureGate(md.a.pNa,!1);$e.Sn&&T.ea.$a(478,function(qg){$e.pasteShortcutManager=qg});$e.G3e&&($e.FYf=jd.a(function(){$e.Zsf()},1,$e.$.la,"CopyPasteInfrastructure.OnStartEditInternal",!0));return $e}function rd(T){if(!T)return"null";var Oa=[];T=Ol(T.get());for(var Eb=T.next();!Eb.done;Eb=T.next())Eb=Eb.value,Eb=String.format("{0}({1})",Eb.clipboardDataFormat,Eb.data.length),Array.add(Oa,Eb);Oa.sort();return Oa.join(",")}function Id(T){switch(T){case 0:return"None";
case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function Vd(T,Oa){return T?Oa&&Oa.ya?T.sessionId!==Oa.ya.UserSessionId:(mc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(mc.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1)}function He(){}function Nd(){}function Vc(){}function fe(T,Oa,Eb,vc){this.$=T;this.originalDestinations=Oa;this.D4b=Eb;this.o9f=vc;this.gig=this.originalDestinations;this.ccg=this.D4b;this.vfg="PasteRecoveryUI"}function Ee(T){return T&&
(T=T.getCachedMetadata())&&T.lastCopy?T.lastCopy:null}function lf(T){return T.clipboardItems&&(T=T.clipboardItems.getItem(Ib.a0h),!If.a.ma(T)&&"1"===T)?!0:!1}function Da(T){return fc(T)&&!(void 0===T.clipboardItems||null===T.clipboardItems)&&!!T.clipboardItems.getItem(Ib.png)&&If.a.ma(T.clipboardItems.getItem(Ib.bV))}function fc(T){return T.clipboardItems&&(T=T.clipboardItems.getItem(Ib.l3h),!If.a.ma(T)&&"1"===T)?!0:!1}function Ib(){}function Ta(){}function kd(T){return!!T&&Object.getType(T)===ce}
function ce(T,Oa,Eb,vc,gd){vc=ub.call(this,vc,gd)||this;mc.ULS.shipAssertTag(537167645,0,!!Oa&&0<Oa.length,"RangeSourceItem.ctor: ranges should not be null or empty");vc.$=T;vc.ranges=Oa;vc.sheetName=Eb;return vc}function dc(T,Oa,Eb,vc,gd){Eb=ub.call(this,Eb,vc)||this;Eb.activeFloatingObjectControlId=T;Eb.sheetName=Oa;Eb.type=gd;return Eb}function ub(T,Oa){this.sessionStateId=T;this.sessionId=Oa;this.toJSON=Object(za.a)(this,this.Wqh,"generateCustomJsonForLogging")}function pc(T,Oa,Eb,vc,gd){var Cd=
T.Stopwatch,Fd={};Fd.a=gd;Fd.e=Cd.id;Fd.c="RearrangeRowColumn";Fd.b="mouse";Fd.d=T.OperationId.toString();Fd.f=Eb.toString();Fd.g=vc.toString();Fd.h=Oa.toString();Fd.i=T.DragDropIsShiftKeyDown;Fd.j=!0;Fd.o=Cd.Cc;Fd.q=!1;Fd.r=T.CopyPasteTargetType.toString();Fd.s=T.EncounteredDeploymentErrors;return Fd}function xc(T){T=Rg.call(this,T)||this;mc.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");T.hc=0;T.yc(1,Hf.a.instance.da(2153));var Oa=Hf.a.instance.da(2151),
Eb=T.k3();T.initializeAndShow(Oa,Object(za.a)(T,T.cMg,"clipboardReadPermissionAskDialogHandler"),Eb);return T}function hd(){this.Za=null}function Rc(){this.pfb=this.wOb=this.gw=null}function ld(T,Oa,Eb,vc,gd){this.gw=T;this.Bfb=Oa;this.xfb=Eb;this.Z6d=void 0===vc?null:vc;this.Lhb=void 0===gd?null:gd}function Wd(){this.Za=null}function ee(T){this.dc=T}function ne(){this.Lae=0;this.WTa=Array(5);this.WTa[0]=10;this.WTa[1]=15;this.WTa[2]=50;this.WTa[3]=100;this.WTa[4]=200}function Ad(T,Oa,Eb,vc,gd){this.f6b=
!1;this.$ob=null;this.La=T;this.hVa=Oa;this.IRb=Eb;this.h0=vc;this.lzc=gd}function se(){this.BDf=this.qIf=this.VXf=this.vec=this.instance=null}function Ve(T,Oa,Eb){this.La=T;this.Ce=Oa;this.YOb=Eb}function Zf(){this.completed=this.KRi=!1}function Pf(){this.j$d=this.F4d=this.oVd=!0;this.kXi=this.aGi=null;this.Eji=!1;this.locale=null;this.y0f={}}function Fe(){}function me(){this.fRb=this.vOb=null}function ng(T){return Ag.call(this,T)||this}function Oe(){this.Za=null}function bd(T,Oa){if(void 0===T||
null===T||void 0===Oa||null===Oa)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=T;this.Ng=Oa;this.$Kc=this.qe=null}function ac(){this.YAe=this.h4f=this.Zs=0;this.ZAe=this.i4f=this.wFa="";this.LLc=this.Wca=2}function Fc(T,Oa){this.sAc=0;this.DZb=null;this.Pfb=new id(T,Oa);this.vb=T;Oa=T.Ta("HostAuthType");this.xCa=T.sa("OcpsIsEnabled")&&T.sa("IsO365CommercialHost")&&!(void 0===Oa||null===Oa)&&"aad"===Oa.toLowerCase();this.A5d=Ke.b(T.Ta("OcpsDefaultSettings")||"{}");this.Ggb=
this.W7b();Oa=this.vb.Yx("ServicesControlsMicrosoftControllerServicesList")?this.vb.Uw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.pNb=new nf.a;for(var Eb=0;Eb<Oa.length;Eb++)this.pNb.add(Oa[Eb]);this.xCa&&!T.sa("IsAnonymousUser")&&T.sa("SideCarIsEnabled")?this.DZb=this.ktj():this.DZb=this.Gma(this.xCa,this.qta("/afhs/CloudPolicySettings.ashx"),Object(za.a)(this,this.gEi,"parseCloudPolicySettingsResponse"));this.DZb.then(function(){return null}).catch(function(vc){mc.ULS.sendTraceTag(50622685,
3004,10,JSON.stringify(vc))})}function Zc(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function pd(){}function bf(T,Oa){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=T.PolicySettings;T=new Date;T.setMinutes(T.getMinutes()+Oa);this.ExpirationTime=T.getTime()}function Bd(T,Oa,Eb,vc,gd){var Cd=this;Eb=void 0===Eb?null:Eb;vc=void 0===vc?null:vc;gd=void 0===gd?null:gd;this.Fsa=this.LRb=this.g8d=this.xoa=this.PSb=null;this.Pfb=new id(T,Oa);this.vb=T;this.Afg=
T.xd("LicensingMaxRetryAttempts",0);this.AFc=T.sa("IsO365ConsumerHost");this.zFc=T.sa("IsO365CommercialHost");this.pPb=T.sa("PremiumUpsellIsEnabled");this.MWd=Eb;this.pbe=vc;this.La=gd;this.woa=T.sa("LicensingIsEnabled");this.xCa=T.sa("OcpsIsEnabled")&&this.zFc;this.dNc=T.sa("ShowPrivacyDialog")&&!!vc;this.U0d=T.sa("IsAnonymousUser");this.h5c=new Promise(function(Fd){Fd(!1)});this.yza=new Promise(function(Fd){Fd(!0)});this.Esa=new Le.a(we.a.rl());this.ATb=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1);this.q3d=this.ACh();this.Mid()&&!this.U0d?(void 0!==ad.AFrameworkApplication.xa&&null!==ad.AFrameworkApplication.xa&&(this.PSb=ad.AFrameworkApplication.xa.MC,void 0!==this.PSb&&null!==this.PSb&&(this.xoa=this.PSb.yi("WebServiceCall","ApplicationFeatureHelperService"))),this.Fsa=this.BPd()):this.Fsa=new Promise(function(Fd){Fd({})});this.Fsa.catch(function(Fd){mc.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Fd))});this.ATb&&(this.pPb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Fd){Cd.pPb=
Cd.vb.sa("PremiumUpsellIsEnabled")&&Fd;return null}))}function Qe(T,Oa,Eb){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=T;this.isEnabled=Oa;this.tierName=Eb}function Ob(T,Oa){this.Rqj=3E5;if(void 0===T||null===T||void 0===Oa||null===Oa)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=T;this.oMb=new Le.a(we.a.rl());this.Pfb=new id(T,Oa);void 0!==We.a.cod&&null!==We.a.cod&&void 0!==We.a.mfc&&null!==We.a.mfc&&0<We.a.mfc&&(T=new yc,T.Token=We.a.cod,
T.ExpirationTime=We.a.mfc,this.oMb.ia("loki",T))}function yc(){this.Token=null;this.ExpirationTime=0}function id(T,Oa){this.vb=T;this.Ng=Oa}function Tc(){this.message=null;this.I$b=0}b.r(F);var od=b(0),mc=b(15),Le=b(797),we=b(786),za=b(37),Nb=b(83),bb;(function(T){T[T.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";T[T.cloudPolicySettings=1]="cloudPolicySettings";T[T.alternateAuthToken=2]="alternateAuthToken"})(bb||(bb={}));Object(od.b)("ApplicationFeatureHelperRequestType",bb);
Object(od.a)(Tc,"HttpRequstToPromiseRejectData",null,[]);var Ub=b(93),kc=b(231);id.prototype.mZc=function(T,Oa,Eb,vc,gd,Cd,Fd,$d){var Ae=this;vc=void 0===vc?null:vc;gd=void 0===gd?null:gd;Cd=void 0===Cd?null:Cd;Fd=void 0===Fd?null:Fd;$d=void 0===$d?null:$d;var $e=bb[Eb],qg=$e+"RequestFailure";Ub.Health.instance.recordKpiUsage(qg,0,"jpittsdirects",null);return new Promise(function(Tg,jg){mc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",
$e);var vf=null!=Fd?Fd:Ae.vb.xd("ApplicationFeatureHelperRequestQueueTimeout",15E3),Xg=null!=$d?$d:Ae.vb.xd("ApplicationFeatureHelperRequestSentTimeout",3E4);Ae.Ng.l8(T,1,null,Ae.hBh(Eb,vc),Cd,!1,1,function(bh){mc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",$e);try{if(void 0===bh||null===bh||void 0===bh.data||null===bh.data||void 0===bh.data.ae||null===bh.data.ae){Ub.Health.instance.recordKpiFailure(qg,"Invalid RequestSucceededEventArgs",
!1,!0,null);var Fh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",$e);jg(Ae.Jsb(Fh,bh))}else if(bh.data.httpStatus!==kc.a.JN){Ub.Health.instance.recordKpiFailure(qg,"HttpStatusCode_"+bh.data.httpStatus.toString(),!1,!0,null);var gh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
bh.data.httpStatus,$e);jg(Ae.Jsb(gh,bh))}else{void 0!==gd&&null!==gd&&void 0!==bh.data.responseHeaders&&null!==bh.data.responseHeaders&&gd(bh.data.responseHeaders);var ud=Oa(bh.data.ae);if(ud)mc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",$e),Tg(ud);else{Ub.Health.instance.recordKpiFailure(qg,"Parse Failure",!1,!0,null);var Jh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
$e);jg(Ae.Jsb(Jh,bh))}}}catch(bg){Ub.Health.instance.recordKpiFailure(qg,"Unexpected Failure",!1,!0,null),Fh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",bg,$e),jg(Ae.Jsb(Fh,bh))}},function(bh){mc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",$e);if(bh.data){Ub.Health.instance.recordKpiFailure(qg,"HttpStatusCode_"+bh.data.httpStatus.toString(),!1,!0,null);var Fh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
bh.data.httpStatus,bh.data.ae||"No Data",$e)}else Ub.Health.instance.recordKpiFailure(qg,"Invalid RequestFailedEventArgs",!1,!0,null),Fh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",$e);jg(Ae.Jsb(Fh,bh))},null,void 0,void 0,vf,Xg)})};id.prototype.Jsb=function(T,Oa){var Eb=new Tc;Eb.message=T;Eb.I$b=Oa&&Oa.data?Oa.data.httpStatus:-1;return Eb};id.prototype.hBh=function(T,Oa){var Eb={};Eb["x-UserDataSignature"]=this.vb.Ta("UserDataSignature");
Eb["x-LicensingIsEnabled"]=this.vb.sa("LicensingIsEnabled").toString();Eb["x-CacheIsEnabled"]=this.vb.sa("LicensingRedisIsEnabled").toString();Eb["x-OcpsIsEnabled"]=this.vb.sa("OcpsIsEnabled").toString();Eb["x-LicensingAADIdIsEnabled"]=this.vb.sa("LicensingAadIdIsEnabled").toString();T||(Eb["x-LicenseCheckOnTenantEnabled"]=this.vb.sa("LicensingForSafeLinksIsEnabled").toString(),Eb["x-SupportUserConsentDependentFeatures"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1).toString(),Eb["x-AFHUserConsentGroupValue"]=this.vb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),Eb["x-UseShellServiceForUserConsentGroup"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),Eb["x-UseSALForLicensing"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),Eb["x-SMBUserLicensingEnabled"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",
!1).toString(),Eb["x-UseSALForAadGraphToken"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForAadGraphAFHS",!1).toString());if(Oa){T=Ol(Oa.keys);for(var vc=T.next();!vc.done;vc=T.next())vc=vc.value,Eb[vc]=Oa.oa(vc)}return Eb};Object(od.a)(id,"HttpRequestToPromiseUtility",null,[]);var ad=b(5),Qd;(function(T){T[T.loki=0]="loki";T[T.augloopACLP=1]="augloopACLP"})(Qd||(Qd={}));Object(od.b)("AlternateAuthSupportApp",Qd);var We=b(839),Ke=b(41);Object(od.a)(yc,"WacAlternateAuthToken",
null,[]);Ob.prototype.Pth=function(){var T=null;this.oMb.qb(Qd[0])&&(T=this.oMb.oa(Qd[0]));return void 0===T||null===T||this.Ckd(T)?this.Ikh():Promise.resolve(T.Token)};Ob.prototype.Ckd=function(T){return T.ExpirationTime-Date.now()<this.Rqj};Ob.prototype.Ikh=function(){var T=this,Oa=new Le.a(we.a.rl());Oa.ia("X-AlternateAuthApp",Qd[0]);return this.Pfb.mZc(this.qta("/afhs/AlternateAuthHelperHandler.ashx"),Object(za.a)(this,this.cEi,"parseAlternateAuthTokenResponse"),2,Oa).then(function(Eb){mc.ULS.sendTraceTag(545821456,
3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Qd[0]);T.oMb.ia(Qd[0],Eb);return Eb.Token},function(Eb){Eb=Object(Nb.a)(Tc,Eb);mc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Eb.message,Eb.I$b);return null})};Ob.prototype.cEi=function(T){var Oa=Ke.d(T).eu;mc.ULS.sendTraceTag(545821457,3004,Oa?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",
T);return Oa};Ob.prototype.qta=function(T){return String.format("{0}{1}?{2}",this.vb.Ta("WebServiceBase"),T,ad.AFrameworkApplication.Xi)};Object(od.a)(Ob,"AlternateAuthHelper",null,[223]);var nf=b(450);Object(od.a)(Qe,"FeatureStateChangeArgs",null,[]);var Pe=b(279),hf=b(23),Vf=b(110),Sg=b(196),wg;(function(T){T[T.Enabled=0]="Enabled";T[T.Disabled=1]="Disabled"})(wg||(wg={}));Object(od.b)("FeatureState",wg);var Ef=b(88),Fg=b(28),xf=b(177);Bd.prototype.ACh=function(){for(var T=this.vb.Yx("AllLicensedFeatures")?
this.vb.Uw("AllLicensedFeatures"):[],Oa=new nf.a,Eb=0;Eb<T.length;Eb++)Oa.add(T[Eb]);return Oa};Bd.prototype.Mid=function(){return this.zFc||this.AFc};Bd.prototype.BPd=function(T,Oa){var Eb=this;T=void 0===T?0:T;Oa=void 0===Oa?!1:Oa;mc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Oa);var vc=this.ZYc();vc&&(vc.set("retryAttempt",T.toString()),vc.set("forceRefresh",Oa.toString()),vc.set("isO365ConsumerHost",this.AFc.toString()),vc.set("isO365CommercialHost",
this.zFc.toString()),vc.set("isFreemiumUpsellEnabled",this.pPb.toString()));Ub.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",vc);Ub.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",vc);void 0!==this.xoa&&null!==this.xoa&&this.xoa.start();var gd=null;Oa&&(gd=new Le.a(we.a.rl()),gd.ia("x-LicensingForceRefresh","true"));this.g8d=new Date;return(this.woa?this.Pfb.mZc(this.qta("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(za.a)(this,
this.fEi,"parseApplicationFeatureHelperResponse"),0,gd,Object(za.a)(this,this.mJi,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(function(Cd){var Fd=Object.assign(new xf.a,{durationMs:Eb.RVf()});Fd.extendedProperties=vc;Fd.extendedProperties&&Cd&&(Fd.extendedProperties.set("featureCount",Vf.a.count(Cd).toString()),Fd.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Cd).toString()),Fd.extendedProperties.set("msoPremiumBadgeEnabled",
("MsoPremiumBadge"in Cd).toString()),Eb.LRb&&Fd.extendedProperties.set("fromCache",(Eb.LRb<Eb.g8d).toString()));Ub.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Fd);return Cd},function(Cd){var Fd=Object.assign(new xf.a,{durationMs:Eb.RVf()}),$d=Object(Nb.a)(Tc,Cd);if(!$d)return mc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Ub.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,Fd),new Promise(function(Ae,$e){$e(Cd)});Fd.extendedProperties=vc;Fd.extendedProperties&&Fd.extendedProperties.set("status",$d.I$b.toString());Ub.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Fd);return 408===$d.I$b&&++T<=Eb.Afg?Eb.BPd(T):new Promise(function(Ae,$e){$e($d)})})};Bd.prototype.fEi=function(T){(T=Ke.b(T))?(mc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),mc.ULS.sendTraceTag(50938594,
3004,50,"{0}",T)):mc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return T.Features};Bd.prototype.qta=function(T){var Oa=String.format("{0}{1}",this.vb.Ta("WebServiceBase"),T);this.vb.Yx("ApplicationFeatureHelperHttpCachingEnabled")&&this.vb.sa("ApplicationFeatureHelperHttpCachingEnabled")&&(T=Bd.W7b(this.vb))&&0<T.length&&(this.ATb&&(T+="ucbf"),Oa=new Pe.QueryStringBuilder(Oa),Oa.Xj("afhskey",T),Oa=Oa.toString());
return Oa};Bd.prototype.isFeatureEnabled=function(T,Oa){var Eb=this;if(!this.xCa&&!this.dNc&&!this.woa)return this.yza;mc.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",T);if("ConnectedServices"===T){var vc=this.xCa?this.MWd.bJ("ControllerConnectedServicesEnabled"):this.yza,gd=this.dNc?this.pbe.getSettings().then(function($d){return 2!==$d.Zs},function(){return Oa}):this.yza;return vc.then(function($d){return $d?gd:Eb.h5c})}vc=
null;vc=this.xCa?this.MWd.isFeatureEnabled(T):this.yza;var Cd=null;Cd=this.woa?this.F1h(T,Oa):this.yza;var Fd=null;Fd=this.dNc?this.pbe.isFeatureEnabled(T):this.yza;return vc.then(function($d){return $d?Fd.then(function(Ae){return Ae?Cd:Eb.h5c}):Eb.h5c}).then(function($d){Eb.pcf(T,$d);return $d},function($d){Eb.pcf(T,Oa,$d);return Oa})};Bd.prototype.pcf=function(T,Oa,Eb){Eb=void 0===Eb?null:Eb;var vc=this.ZYc();vc&&(vc.set("FeatureName",T),vc.set("IsEnabled",Oa.toString()));Eb?(T=Object.assign(new xf.a,
{extendedProperties:vc}),Ub.Health.instance.recordKpiFailure("AFHFeatureStatus","CanNotDetermineFeatureStatus",!1,!0,T)):Ub.Health.instance.recordKpiUsage("AFHFeatureStatus",0,"jpittsdirects",vc)};Bd.prototype.getFeatureTier=function(T,Oa){var Eb=this;if(!this.woa)return new Promise(function(vc){vc(2)});mc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",T);return this.Fsa.then(function(vc){return Eb.O8b(T,vc,Oa)},function(){return Oa})};
Bd.prototype.isFreemiumUpsellEnabled=function(){return this.pPb&&this.AFc&&!this.U0d};Bd.prototype.launchUpsellExperience=function(T,Oa){Oa=void 0===Oa?null:Oa;mc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",T));var Eb=this.ZYc();Eb&&(Eb.set("experienceId",T),Oa&&Eb.set("campaignId",Oa));Ub.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",Eb);if(Eb=Ef.a.instance.Mh("Common.IInProductMessagingUIManager")){var vc=
Object(za.a)(this,this.qNh,"handleDimeTaskComplete");Eb.xaf(T,vc,Oa)}else mc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Ub.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Oa={},this.La.Ge(Fg.a.g6b,2,(Oa.experience=T,Oa))};Bd.prototype.ONa=function(T,Oa){if(!this.woa)return null;if(!T||!Oa)return mc.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;var Eb=Sg.a.create().toString();this.Esa.qb(T)||this.Esa.ia(T,new Le.a(we.a.rl()));this.Esa.oa(T).add(Eb,Oa);mc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Eb,T));return Eb};Bd.prototype.uBd=function(T,Oa){this.woa&&(T&&this.Esa.qb(T)?Oa&&Sg.a.isValid(Oa)?this.Esa.oa(T).qb(Oa)?(mc.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
Oa,T)),this.Esa.oa(T).remove(Oa)):mc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Oa,T)):mc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Oa,T)):mc.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
T)))};Bd.prototype.O8b=function(T,Oa,Eb){return this.ATb?T in Oa?Oa[T].LicenseTier:Eb:T in Oa?this.DEi(Oa[T],Eb):Eb};Bd.prototype.DEi=function(T,Oa){switch(T.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Oa}};Bd.prototype.qNh=function(){var T=this;mc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Fsa.then(function(Oa){T.JCf(Oa)}).catch(function(){T.JCf({})})};Bd.prototype.JCf=function(T){var Oa=this;
mc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var Eb=this.BPd(0,!0);Eb.then(function(vc){Oa.Fsa=Eb;Vf.a.count(vc)>Vf.a.count(T)?Ub.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Ub.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var gd=Ol(Oa.Esa.keys),Cd=gd.next();!Cd.done;Cd=gd.next())if(Cd=Cd.value,Cd in vc){var Fd=Oa.O8b(Cd,vc,0);Cd in T?Oa.O8b(Cd,T,0)!==Fd&&Oa.Grd(Cd,
!0,Fd):Oa.Grd(Cd,!0,Fd)}else Cd in T&&Oa.Grd(Cd,!1,Oa.O8b(Cd,T,0))}).catch(function(vc){Ub.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);mc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(vc))})};Bd.prototype.Grd=function(T,Oa,Eb){mc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",T,Oa,Eb);Oa=new Qe(T,Oa,Eb);Eb=this.Esa.oa(T);Eb=Ol(Eb);for(var vc=
Eb.next();!vc.done;vc=Eb.next()){vc=vc.value;try{vc.value(Oa)}catch(gd){mc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",T,vc.key,gd.message))}}};Bd.prototype.we=function(T,Oa){var Eb=this;if(this.woa){var vc=this.q3d.contains(T),gd=!0,Cd="",Fd=!1;return this.Fsa.then(function($d){T in $d?($d=$d[T],Cd=wg[$d.FeatureState],gd=1!==$d.FeatureState):gd=!vc;Eb.wcf(T,
vc,Cd,Fd,Oa,gd);return gd},function(){Fd=!0;vc&&(gd=Oa);Eb.wcf(T,vc,Cd,Fd,Oa,gd);return gd})}return this.yza};Bd.prototype.wcf=function(T,Oa,Eb,vc,gd,Cd){mc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",T,Oa,vc,Eb,gd,Cd)};Bd.prototype.F1h=function(T,Oa){if(this.ATb)return this.we(T,Oa);if(this.woa){if(this.q3d.contains(T))return this.Fsa.then(function(Eb){return T in Eb},function(){return Oa});
mc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",T)}return this.yza};Bd.prototype.mJi=function(T){try{T&&"Date"in T&&(this.LRb=new Date(T.Date),mc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.LRb.toString()))}catch(Oa){mc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",Oa)}};Bd.prototype.ZYc=
function(){try{return new Map}catch(T){return null}};Bd.prototype.RVf=function(){if(void 0!==this.xoa&&null!==this.xoa){var T=this.xoa.Cc;this.xoa.stop();return T}return null};Bd.W7b=function(T){try{if(hf.a.qnj){var Oa=T.Ta("UserDataSignature").split(".");if(1<Oa.length){var Eb=window.self.atob(Oa[1]),vc=JSON.parse(Eb).LocalStorageKey;if(void 0!==vc&&null!==vc&&0<vc.length)return vc}}}catch(gd){mc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",gd.toString())}return null};
Object(od.a)(Bd,"ApplicationFeatureHelper",null,[224]);var Uf=b(211);Object(od.a)(bf,"CloudPolicySettingsCacheData",null,[]);var Gg=b(935),Eg=b(369),ig=b(219);pd.iUf=function(){return ad.AFrameworkApplication.ha.sa("SideCarIsEnabled")?pd.$oc&&pd.bhd?new Promise(function(T){T(!0)}):new Promise(function(T,Oa){pd.$oc=ig.a.create(ad.AFrameworkApplication.ha.Ta("SideCarUrl"));Eg.a.Zga(pd.$oc);pd.$oc.o8(function(Eb,vc){(pd.bhd=vc.succeeded)?T(vc.succeeded):Oa(vc.succeeded)})}):new Promise(function(T){T(!1)})};
pd.bhd=!1;pd.$oc=null;Object(od.a)(pd,"SideCarLoader",null,[]);Object(od.a)(Zc,"CloudPolicySettingsData",null,[]);Fc.prototype.bJ=function(T,Oa){Oa=void 0===Oa?!0:Oa;if(!this.xCa){var Eb=this;return new Promise(function(Fd){Fd(Eb.xsb(T))})}var vc=this,gd=this,Cd=this.DZb.then(function(Fd){try{var $d=null;Fd.PolicySettings&&"unknown"in Fd.PolicySettings&&($d=Fd.PolicySettings.unknown);if($d){if(T in $d&&void 0!==$d[T]&&null!==$d[T])return new Promise(function($e){$e("0"!==$d[T])});var Ae=T.toLowerCase();
if(Ae in $d&&void 0!==$d[Ae]&&null!==$d[Ae])return new Promise(function($e){$e("0"!==$d[Ae])});mc.ULS.sendTraceTag(51512667,3004,50,"Policy"+T+" not found, using default");return new Promise(function($e){$e(vc.xsb(T))})}return new Promise(function($e){$e(vc.xsb(T))})}catch($e){return mc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+T+" policy value. Error Message: {0}",$e.message),vc.handleError($e.toString(),Oa,vc.xsb(T))}},function(Fd){return gd.handleError(Fd,Oa,gd.xsb(T))});Cd.then(function(Fd){mc.ULS.sendTraceTag(50651667,
3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",T,Fd);return null});return Cd};Fc.prototype.isFeatureEnabled=function(T,Oa){Oa=void 0===Oa?!0:Oa;if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.H1h(T,Oa);var Eb=new Promise(function(gd){gd(!0)}),vc="";this.pNb.contains(T)&&(vc="ControllerConnectedServicesEnabled",Eb=this.bJ(vc,Oa));Eb.then(function(gd){mc.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",T,gd,vc);return null});return Eb};Fc.prototype.H1h=function(T,Oa){Oa=void 0===Oa?!0:Oa;var Eb=new Promise(function(gd){gd(!0)}),vc="";"mso_sendASmile"===T?vc="Enabled":"Survey"===T||"FloodgateSurvey"===T?vc="SurveyEnabled":this.pNb.contains(T)&&(vc="ControllerConnectedServicesEnabled");""!==vc&&(Eb=this.bJ(vc,Oa));Eb.then(function(gd){mc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
T,gd,vc);return null});return Eb};Fc.prototype.handleError=function(T,Oa,Eb){return Oa?new Promise(function(vc){vc(Eb)}):new Promise(function(vc,gd){gd(T)})};Fc.prototype.Gma=function(T,Oa,Eb){var vc=this;if(!T)return Promise.resolve(new Zc);var gd=!1,Cd=null;Ub.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Fd=this.JYc("GetCloudPolicySettings");return(new Promise(function($d,Ae){if(void 0!==vc.Ggb&&null!==vc.Ggb&&0<vc.Ggb.length){var $e=vc.Vsj();if(void 0!==$e&&
null!==$e){gd=!0;$d($e);return}}vc.Pfb.mZc(Oa,Eb,1,null,Object(za.a)(vc,vc.qJi,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],vc.vb.xd("CloudPolicySettingsRequestQueueTimeout",15E3),vc.vb.xd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(qg){mc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");vc.Jtj(qg);$d(qg);return qg},function(qg){Ae(qg);return null})})).then(function($d){var Ae=vc.jtc(Fd);Fd=Ae.stopwatch;Cd=Ae.returnValue;(Ae=vc.fs())&&
Ae.set("FromCache",gd.toString());Ae=Object.assign(new xf.a,{durationMs:Cd,extendedProperties:Ae});Ub.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ae);return $d})};Fc.prototype.ktj=function(){return pd.iUf().then(function(){mc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};Fc.prototype.qta=function(T){return String.format("{0}{1}",this.vb.Ta("WebServiceBase"),
T)};Fc.prototype.gEi=function(T){var Oa=Ke.d(T).eu;mc.ULS.sendTraceTag(50622687,3004,Oa?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",T);return Oa};Fc.prototype.qJi=function(T){try{if(void 0!==T&&null!==T&&"CheckIn-Interval"in T){var Oa=parseInt(T["CheckIn-Interval"]);void 0!==Oa&&null!==Oa&&0<Oa&&(this.sAc=Oa)}}catch(Eb){mc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Eb)}};Fc.prototype.xsb=function(T){return T in
this.A5d?"0"!==this.A5d[T]:!0};Fc.prototype.Vsj=function(){try{var T=Gg.a.instance.getItem(this.Ggb);if(void 0===T||null===T)return mc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;mc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",T);var Oa=JSON.parse(T);if(void 0===Oa||null===Oa)return mc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===Oa.ExpirationTime||null===Oa.ExpirationTime)return mc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Oa.ExpirationTime)).getTime()<Date.now())return mc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var Eb=new Zc;Eb.PolicySettings=Oa.PolicySettings;Eb.ControllerConnectedServicesFeatureNames=new Uf.a;this.vb.Yx("ServicesControlsMicrosoftControllerServicesList")&&
this.vb.Uw("ServicesControlsMicrosoftControllerServicesList");for(var vc=Ol(this.pNb),gd=vc.next();!gd.done;gd=vc.next())Eb.ControllerConnectedServicesFeatureNames.add(gd.value);mc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Eb}catch(Cd){return mc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Cd.toString()),null}};Fc.prototype.Jtj=function(T){try{if(void 0===T||null===T||void 0===T.PolicySettings||
null===T.PolicySettings)mc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.sAc)mc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Oa=new bf(T,this.sAc),Eb=JSON.stringify(Oa);mc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Eb);Gg.a.instance.setItem(this.Ggb,Eb);mc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(vc){mc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",vc.toString())}};Fc.prototype.W7b=function(){var T=Bd.W7b(this.vb);return T&&0<T.length?"OCPS"+T:null};Fc.prototype.fs=function(){try{return new Map}catch(T){return null}};Fc.prototype.JYc=function(T){var Oa=Ef.a.instance.Mh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Oa&&null!==Oa?Oa.Dc("WebServiceCall",T):null};Fc.prototype.jtc=function(T){if(void 0!==T&&null!==T){var Oa=T.Cc;T.stop();return{returnValue:Oa,
stopwatch:null}}return{returnValue:null,stopwatch:T}};Object(od.a)(Fc,"CloudPolicySettingsHelper",null,[221]);ac.prototype.clone=function(){var T=new ac;T.Zs=this.Zs;T.h4f=this.h4f;T.YAe=this.YAe;T.wFa=this.wFa;T.i4f=this.i4f;T.ZAe=this.ZAe;T.Wca=this.Wca;T.LLc=this.src;return T};ac.prototype.serialize=function(T){T=void 0===T?null:T;var Oa={};if(!T||T.contains(ac.eMa))Oa[ac.eMa]=this.Zs;if(!T||T.contains(ac.Dzb))Oa[ac.Dzb]=this.wFa;if(!T||T.contains(ac.Ezb))Oa[ac.Ezb]=this.Wca;return JSON.stringify(Oa)};
ac.create=function(T,Oa){Oa=void 0===Oa?null:Oa;var Eb=new ac;Eb.LLc=T;void 0!==Oa&&null!==Oa&&(ac.eMa in Oa&&(Eb.Zs=Oa[ac.eMa]),ac.Dzb in Oa&&(Eb.wFa=Oa[ac.Dzb]),ac.Ezb in Oa&&(Eb.Wca=Oa[ac.Ezb]));return Eb};ac.deserialize=function(T,Oa){try{var Eb=JSON.parse(T);if(void 0!==Eb&&null!==Eb)return ac.create(Oa,Eb);mc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",T);throw Error.argument("settingsData");}catch(vc){throw mc.ULS.sendTraceTag(50860947,
306,10,"UserPrivacySettings Deserialize Exception = {0}",vc.toString()),vc;}};Ll.Object.defineProperties(ac.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.LLc}}});ac.eMa="CCS";ac.Dzb="CCSTime";ac.Ezb="OfficePrivacyRoamedNoticeShown";Object(od.a)(ac,"UserPrivacySettings",null,[]);var sg=b(135);bd.prototype.qta=function(T){var Oa=String.format("{0}RoamingServiceHandler.ashx?action=",this.vb.appSettings.RoamingServiceHandlerWebServiceBase||"");Oa=new Sys.StringBuilder(Oa);Oa.append(T);
Oa.append("&");Oa.append(ad.AFrameworkApplication.Xi);return Oa.toString()};bd.prototype.executeRequest=function(T,Oa,Eb,vc){return this.Ng.TUb(T,Oa,void 0===vc?null:vc,null,Eb,"33",!1,null,6E4)};bd.prototype.saveSettings=function(T){var Oa=this;return new Promise(function(Eb,vc){try{if(void 0===Oa.qe||null===Oa.qe||void 0===T||null===T)mc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),vc("Can't determine setting changes to save");else{var gd=
Oa.qe.Zs!==T.Zs;if(2===Oa.qe.src&&gd)Oa.E1i(T),Eb(!0);else{var Cd=Oa.y5i(T);if(void 0===Cd||null===Cd||!Cd.length)mc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),vc("No changes to save");else if(1===Oa.qe.src)Eb(Oa.j0f(Cd));else if(!Oa.qe.src){mc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Cd);var Fd=Oa.executeRequest(Oa.qta("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Cd);Fd.continueWith(function(){if(Fd.wh||
Fd.gg)mc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),Eb(!1);else{var $d=Fd.result;void 0!==$d.Jg&&null!==$d.Jg&&void 0!==$d.Jg.data&&null!==$d.Jg.data&&$d.Jg.data.httpStatus===kc.a.JN?(mc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Eb(!0)):(mc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Eb(!1))}})}}}}catch($d){mc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",
$d.toString()),Eb(!1)}})};bd.prototype.y5i=function(T){if(void 0===this.qe||null===this.qe||void 0===T||null===T)throw Error.invalidOperation("User Privacy settings have not been initialized");var Oa=new Uf.a;T.src?1===T.src&&this.qe.Zs!==T.Zs&&Oa.add(ac.eMa):(this.qe.Zs!==T.Zs&&(Oa.add(ac.eMa),Oa.add(ac.Dzb)),this.qe.Wca!==T.Wca&&Oa.add(ac.Ezb));return Oa.count?T.serialize(Oa):(mc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};bd.prototype.getSettings=
function(){if(!this.$Kc){var T=this;this.$Kc=new Promise(function(Oa){try{T.qe?Oa(T.qe.clone()):T.ctj().then(function(Eb){T.qe=Eb;Oa(T.qe.clone());return null},function(){T.atj().then(function(Eb){T.qe=Eb;Oa(T.qe.clone());return null},function(){T.btj().then(function(Eb){T.qe=Eb;Oa(T.qe.clone());return null},function(){mc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");T.qe=new ac;Oa(T.qe.clone());return null});return null});return null})}catch(Eb){mc.ULS.sendTraceTag(50860932,
3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Eb.toString()),T.qe=new ac,Oa(T.qe.clone())}})}return this.$Kc};bd.prototype.ctj=function(){var T=this;return new Promise(function(Oa,Eb){try{var vc=-1!==window.location.href.indexOf("&wd_pn=2");if(T.vb.sa("PrivacyDialogShouldCheckRoaming")||vc){var gd=T.executeRequest(T.qta("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");gd.continueWith(function(){try{if(gd.wh||gd.gg)mc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{var Cd=gd.result;if(Cd&&Cd.Jg&&Cd.Jg.data)if(Cd.Jg.data.httpStatus!==kc.a.JN)mc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Cd.Jg.data.httpStatus);else{if(Cd.Jg.data.ae){Oa(bd.parse(Cd.Jg.data.ae,0));mc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Cd.Jg.data.ae);return}mc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else mc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Eb("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Fd){mc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Fd.toString()),Eb("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else mc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Eb("Roaming should not be used")}catch(Cd){mc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Cd.toString()),Eb("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};bd.prototype.atj=function(){var T=this;return new Promise(function(Oa,Eb){try{var vc=sg.a.get("WacUPToggleState"),gd=null;void 0!==vc&&null!==vc&&0<vc.length&&(gd=decodeURIComponent(vc));if(void 0!==gd&&null!==gd&&0<gd.length){var Cd=bd.parse(gd,1);mc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Cd.toString());
Oa(Cd)}else{var Fd=ac.create(1),$d=new Uf.a;$d.add(ac.eMa);var Ae=Fd.serialize($d);T.j0f(Ae)?(mc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Ae),Oa(Fd)):(mc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Ae),Eb("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch($e){mc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
$e.toString()),Eb("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};bd.prototype.btj=function(){return new Promise(function(T){try{var Oa=-1!==window.location.href.indexOf("&wdccsoff=1"),Eb=ac.create(2);Oa?(Eb.Zs=2,ad.AFrameworkApplication.Fze(),mc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Eb.toString())):(Eb.Zs=1,mc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Eb.toString()));T(Eb)}catch(vc){mc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",vc.toString()),Oa=ac.create(2),Oa.Zs=1,T(Oa)}})};bd.prototype.E1i=function(T){mc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===T.Zs?ad.AFrameworkApplication.Fze():ad.AFrameworkApplication.f8g();mc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",T)};bd.prototype.j0f=function(T){try{mc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",T);var Oa=this.vb.Ta("PrivacyCookieDomain")||"";if(!Oa||!Oa.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");mc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",T);return sg.a.rId("WacUPToggleState",T,sg.a.pZ,"/",Oa)}catch(Eb){return mc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Eb.toString()),!1}};bd.prototype.isFeatureEnabled=
function(T){var Oa=this;return this.getSettings().then(function(Eb){for(var vc=Oa.vb.Yx("ServicesControlsMicrosoftControllerServicesList")?Oa.vb.Uw("ServicesControlsMicrosoftControllerServicesList"):[],gd=new nf.a,Cd=0;Cd<vc.length;Cd++)gd.add(vc[Cd]);return gd.contains(T)?2!==Eb.Zs:!0},function(){mc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",T);return!0})};bd.parse=function(T,Oa){try{return mc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
T,Oa),ac.deserialize(T,Oa)}catch(Eb){throw mc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Eb.toString()),Eb;}};Object(od.a)(bd,"UserPrivacySettingsHelper",null,[222]);var yg=b(276);Oe.prototype.Qh=function(T){var Oa=this;this.Za=T;this.Za.register(221,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").wc().Fc(function(){return new Fc(ad.AFrameworkApplication.ha,ad.AFrameworkApplication.Cd)});this.Za.register(222,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").wc().Fc(function(){return new bd(ad.AFrameworkApplication.ha,
ad.AFrameworkApplication.Cd)});this.Za.register(223,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").wc().Fc(function(){return new Ob(ad.AFrameworkApplication.ha,ad.AFrameworkApplication.Cd)});this.Za.register(224,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").wc().Fc(function(){return new Bd(ad.AFrameworkApplication.ha,ad.AFrameworkApplication.Cd,Oa.Za.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Oa.Za.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
ad.AFrameworkApplication.Hb)})};Oe.prototype.init=function(){var T=this;ad.AFrameworkApplication.ha.Dv(function(){var Oa=T.Za.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");ad.AFrameworkApplication.ha.sa("LicensingIsEnabled")&&(Oa.isFeatureEnabled("LicensingTestFeature",!1).then(function(Eb){mc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Eb,ad.AFrameworkApplication.ha.Ta("IsAnonymousUser"));
return null}),Oa.getFeatureTier("LicensingTestFeature",0).then(function(Eb){mc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Eb,ad.AFrameworkApplication.ha.Ta("IsAnonymousUser"));return null}));T.Za.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");T.Ooj()})};Oe.prototype.dispose=function(){};Oe.prototype.Ooj=function(){try{ad.AFrameworkApplication.ha.sa("SideCarIsEnabled")&&pd.iUf().then(function(T){mc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",T);return T})}catch(T){}};Oe.main=function(){yg.a.instance.ej(new Oe)};Ll.Object.defineProperties(Oe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(od.a)(Oe,"ApplicationFeatureHelperPackage",null,[8,9]);var Yd=b(163),Sc=b(391),Ag=Sc.a;Em(ng,Ag);ng.prototype.createElement=function(){var T=document.createElement("link");T.setAttribute("rel",
"stylesheet");T.setAttribute("type","text/css");T.setAttribute("href",this.Bu);return T};ng.prototype.kZc=function(){return null};ng.prototype.ymc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.rH.Bu)};Ll.Object.defineProperties(ng.prototype,{U_b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(od.a)(ng,"CssResource",Sc.a,[]);var Jg=b(30),je=b(51);me.prototype.Wai=function(){this.vOb||(mc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.vOb=je.Task.WAA(me.bbi(),me.Tai()),this.vOb.continueWith(function(T){mc.ULS.sendTraceTag(21030599,324,10,"{0}",Jg.a.k9c(T.Cg))},5));return this.vOb};me.prototype.Yai=function(){if(!this.fRb)try{mc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.fRb=je.Task.WAA(me.E2c(ig.a.create(ad.AFrameworkApplication.ha.Ta("DimeUrl"),null,null))),this.fRb.continueWith(function(T){mc.ULS.sendTraceTag(39978391,324,10,"{0}",Jg.a.k9c(T.Cg))},5)}catch(T){mc.ULS.sendTraceTag(594874951,
324,10,"{0}",Jg.a.k9c(T))}return this.fRb};me.bbi=function(){var T=me.Q8b("inproductmessaging.js");T=ig.a.create(T,null,null);return me.E2c(T)};me.Tai=function(){var T=me.Q8b("inproductmessaging.css");T=new ng(T);return me.E2c(T)};me.Q8b=function(T){return Yd.a.XZb(String.format("ipm/{0}",T))};me.E2c=function(T){Eg.a.Zga(T);return T.a5a};Object(od.a)(me,"DependencyDownloader",null,[323]);Fe.qDi="inProductMessagingOverlayDiv";Fe.$Fi="PlayButtonImage";Fe.jXi="ReplayButtonImage";Object(od.a)(Fe,"Constants",
null,[]);Pf.prototype.y9i=function(){this.Qee(Fe.$Fi,this.aGi);this.Qee(Fe.jXi,this.kXi)};Pf.prototype.Qee=function(T,Oa){Oa&&(this.y0f[T]=Oa)};Ll.Object.defineProperties(Pf.prototype,{tAg:{configurable:!0,enumerable:!0,get:function(){return this.oVd},set:function(T){this.oVd=T}},Nii:{configurable:!0,enumerable:!0,get:function(){return this.F4d},set:function(T){this.F4d=T}},Tgj:{configurable:!0,enumerable:!0,get:function(){return this.j$d},set:function(T){(this.j$d=T)&&this.y9i()}}});Object(od.a)(Pf,
"FirstRunExperienceUISettings",null,[322]);Object(od.a)(Zf,"FirstRunExperienceViewData",null,[321]);var dg=b(169),ke=b(108);Ve.prototype.Lg=function(){this.La.Af(Fg.a.wnh,ke.a.frame,Object(za.a)(this,this.unh,"firstRunExperienceHandler"),64);this.La.Xb(Fg.a.mLe,ke.a.frame,Object(za.a)(this,this.vTh,"inProductMessagingTabHandler"));this.La.Xb(Fg.a.lLe,ke.a.frame,Object(za.a)(this,this.uTh,"inProductMessagingShiftTabHandler"));this.La.Xb(Fg.a.P2g,ke.a.frame,Object(za.a)(this,this.Q2g,"dimeLaunchHandler"));
this.La.Xb(Fg.a.TGf,ke.a.frame,dg.ActionManager.Tf);this.La.Xb(Fg.a.JXi,ke.a.frame,dg.ActionManager.Tf);this.La.Xb(Fg.a.KXi,ke.a.frame,dg.ActionManager.Tf);this.Ce&&this.Ce.updateCommandUI()};Ve.prototype.unh=function(T,Oa,Eb,vc,gd){2===Eb&&this.YOb.w$h(gd);return 32};Ve.prototype.Q2g=function(T,Oa,Eb,vc,gd){2===Eb&&this.YOb.u$h(gd);return 32};Ve.prototype.vTh=function(T,Oa,Eb){return 2===Eb?this.YOb.fqd():32};Ve.prototype.uTh=function(T,Oa,Eb){return 2===Eb?this.YOb.dqd():32};Object(od.a)(Ve,"InProductMessagingActor",
null,[]);Object(od.a)(se,"DimeExperienceUISettings",null,[]);var Qf=b(213),og=b(582);Ad.prototype.ZVh=function(T){Qf.apiExtensionExists("getHeaderApi")?T.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Oa){var Eb=T.isFreemiumUpsellEnabled();Eb&&(appChrome.getHeaderApi().then(function(vc){vc.updatePremiumStatus(Oa,Eb);return null}),T.ONa("MsoPremiumBadge",function(vc){appChrome.getHeaderApi().then(function(gd){gd.updatePremiumStatus(vc.isEnabled,Eb);return null})}));return null}):mc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};Ad.prototype.w$h=function(T){var Oa=this;this.IRb.Wai().continueWith(function(){Oa.hVa.lij(T)})};Ad.prototype.u$h=function(T){function Oa(){}var Eb="gopremium",vc=null;T?(T.experience&&""!==Object(Nb.a)(String,T.experience)&&(Eb=Object(Nb.a)(String,T.experience)),T.onTaskComplete&&(Oa=T.onTaskComplete),T.campaignId&&""!==Object(Nb.a)(String,T.campaignId)&&(vc=Object(Nb.a)(String,T.campaignId))):mc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.xaf(Eb,Oa,vc)};Ad.prototype.xaf=function(T,Oa,Eb){var vc=this;Eb=void 0===Eb?null:Eb;if(this.f6b&&this.$ob){var gd={};gd.experience=T||"gopremium";gd.campaignId=Eb||og.b(this.h0,this.lzc,Object(Nb.a)(String,gd.experience),!0);this.La.processAction(Fg.a.TGf,2);mc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+gd.experience);try{var Cd=Object.assign(new se,{instance:this.$ob,vec:gd,VXf:Oa||function(){},qIf:function(Fd){mc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
Fd.status)},BDf:function(){mc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");vc.f6b=!1;vc.$ob=null}});this.hVa.wgj(Cd)}catch(Fd){mc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Fd.message),this.f6b=!1,this.$ob=null,T={},this.La.Ge(Fg.a.g6b,2,(T.experience=gd.experience,T))}}else mc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),gd={},this.La.Ge(Fg.a.g6b,2,(gd.experience=T,gd))};Ad.prototype.nbf=function(){var T=this;this.IRb.Yai().continueWith(function(){try{var Oa=
Jg.a.$m(ad.AFrameworkApplication.uiCulture),Eb=og.c(T.h0);if(Eb){Oa={partnerId:Eb,language:Oa};Oa.sessionId=ad.AFrameworkApplication.userSessionId;Oa.authHint=ad.AFrameworkApplication.ha.Ta("UserPrincipalName");var vc=ad.AFrameworkApplication.ha.Ta("Puid")||"";""!==vc&&(Oa.userInfo={puid:vc});T.$ob=new Dime(Oa);T.f6b=!0;mc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else mc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(gd){mc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
gd.message)}},3)};Ad.prototype.fqd=function(){return this.hVa.fqd()};Ad.prototype.dqd=function(){return this.hVa.dqd()};Object(od.a)(Ad,"InProductMessagingUIManager",null,[320]);ne.prototype.Init=function(T){this.Lae=T};ne.prototype.SendTrace=function(T,Oa){mc.ULS.sendTraceTag(34182235,this.Lae,this.WTa[T],"{0}",Oa)};Object(od.a)(ne,"DefaultNetworkingManager",null,[338]);var Cf=b(277),Ea=b(368),ob=b(100);ee.prototype.lij=function(T){T&&(InProductMessaging.Networking.NetworkingMgr=new ne,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(T.Tgj,T.Nii,T.tAg,T.Eji,T.locale,Object(za.a)(this,this.ari,"onDismissFirstRunExperience"),T.y0f),this.fPa(Fe.qDi,!0))};ee.prototype.wgj=function(T){var Oa=this;if(T&&T.instance&&T.vec){var Eb=document.getElementById("wacDimeContainer");Eb||(Eb=document.createElement("div"),Eb.id="wacDimeContainer",document.body.appendChild(Eb));ad.AFrameworkApplication.ha.sa("DimeFocusManagerIsEnabled")&&this.fPa("wacDimeContainer",!1);T.vec.parentElementId="wacDimeContainer";T.instance.launch(T.vec,
T.VXf).then(function(vc){Oa.PDb();document.body.removeChild(Eb);T.qIf(vc)}).catch(function(vc){Oa.PDb();document.body.removeChild(Eb);T.BDf(vc)})}else throw Error.argument("DimeExperienceUISettings");};ee.prototype.fPa=function(T,Oa){if(this.dc&&T&&(T=document.getElementById(T),this.PVh(T),T=this.dc.ML("InProductMessagingFocusId"))){var Eb=this.dc.ui;Eb&&"InProductMessagingFocusId"===Eb.name||this.dc.zQ("InProductMessagingFocusId",!1);Oa&&this.MBf(T.scope)}};ee.prototype.PVh=function(T){var Oa=!1;
Oa=void 0===Oa?!0:Oa;var Eb=this.dc.Th("InProductMessagingFocusId");Eb.parent=Cf.AFrame.uS;var vc=new Ea.DOMFocusListing(function(){return T});vc.L8a=Oa;vc.Fn(3);vc.Fn(2);vc.Fn(4);Oa=this.dc.Cqa(function(){return T},Eb,vc);Oa.KDb();Oa.lZ=!0;Oa.oFa=!0};ee.prototype.MBf=function(T){T.Hk(ob.FocusManager.instance().Q0);T.Hk(ob.FocusManager.instance().R0);T.bindAction(ob.FocusManager.instance().Q0,Fg.a.mLe);T.bindAction(ob.FocusManager.instance().R0,Fg.a.lLe)};ee.prototype.PDb=function(){this.dc&&(this.dc.lba("InProductMessagingFocusId"),
this.dc.XNa("InProductMessagingFocusId"))};ee.prototype.ari=function(T,Oa){this.PDb();T=Object.assign(new Zf,{completed:T,KRi:Oa});ad.AFrameworkApplication.Hb.Ge(Fg.a.tnh,2,T)};ee.prototype.fqd=function(){var T=document.activeElement,Oa=this.dc.wP();return T&&Oa&&Oa.$e&&T===Oa.$e.Un?(Oa.$e.fl(T),Oa.cwa()?32:8):4};ee.prototype.dqd=function(){var T=document.activeElement,Oa=this.dc.wP();return T&&Oa&&Oa.$e&&T===Oa.$e.firstElement?(Oa.$e.fl(T),Oa.ULa()?32:8):4};Object(od.a)(ee,"InProductMessagingUIWrapper",
null,[319]);var wc=b(143);Wd.prototype.Qh=function(T){T.register(me,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").wc().Fc(function(){return new me});T.register(ee,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").wc().Fc(function(){return new ee(ob.FocusManager.instance())});T.register(Ad,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").wc().Fc(function(){return new Ad(ad.AFrameworkApplication.Hb,
T.resolve("Common.IInProductMessagingUIWrapper"),T.resolve("Common.App.InProductMessaging.IDependencyDownloader"),ad.AFrameworkApplication.xa.Xa.Tk,ad.AFrameworkApplication.xa.Xa.dMa)});T.register(Ve,"Common.App.InProductMessaging.InProductMessagingActor").wc().Fc(function(){return new Ve(ad.AFrameworkApplication.Hb,ad.AFrameworkApplication.xa,T.resolve("Common.IInProductMessagingUIManager"))});T.register(Pf,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").wc().Fc(function(){return new Pf});
T.register(Zf,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").wc().Fc(function(){return new Zf});this.Za=T};Wd.prototype.init=function(){var T=this;this.Za.resolve("Common.App.InProductMessaging.InProductMessagingActor").Lg();ad.AFrameworkApplication.ha.Dv(function(){ad.AFrameworkApplication.xa.Xa.isReactSharedHeaderUxEnabled&&wc.a.get_instance().Om(15,function(){T.Za.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){T.Za.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").ZVh(Oa)})});
ad.AFrameworkApplication.ha.sa("FreemiumUpsellShowDialogIsEnabled")&&og.a()&&!hf.a.aA&&1!==ad.AFrameworkApplication.xa.Xa.Tk&&T.Za.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){Oa.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Eb){!Eb&&Oa.isFreemiumUpsellEnabled()&&T.Za.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").nbf();return null})})})};Wd.prototype.dispose=function(){};Wd.main=function(){yg.a.instance.ej(new Wd)};Ll.Object.defineProperties(Wd.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(od.a)(Wd,"InProductMessagingPackage",null,[8,9]);ld.prototype.I4c=function(T){var Oa=new Sys.StringBuilder(this.gw.YEb);Oa.append("RoamingServiceHandler.ashx?action=");Oa.append("getFirstRunExperienceSettings");Oa.append("&");Oa.append(this.dad(T));Oa.append("&");Oa.append(ad.AFrameworkApplication.Xi);ad.AFrameworkApplication.Cd.Jl(Oa.toString(),1,null,null,!0,2,Object(za.a)(this,this.BIa,"getRequestSuccessCallback"),
Object(za.a)(this,this.fia,"getRequestFailureCallback"),null)};ld.prototype.J4c=function(T){var Oa=new Sys.StringBuilder(this.gw.YEb);Oa.append("RoamingServiceHandler.ashx?action=");Oa.append("saveFirstRunExperienceSettings");Oa.append("&");Oa.append(ad.AFrameworkApplication.Xi);Oa=Oa.toString();T=Ke.c(T);ad.AFrameworkApplication.Cd.Jl(Oa,2,T,null,!0,4,Object(za.a)(this,this.tHi,"postRequestSuccessCallback"),Object(za.a)(this,this.iNa,"postRequestFailureCallback"),null)};ld.prototype.BIa=function(T){var Oa=
!1,Eb=null;try{if(0<T.data.ae.length){var vc=Object(Nb.a)(Object,Ke.a(T.data.ae)),gd=vc?vc[this.gw.PQc]:null;gd&&(Eb=Object(Nb.a)(Object,Ke.a(gd.toString())))}Oa=!0}catch(Cd){this.fia(null)}Oa&&this.Bfb&&this.Bfb(T.data,Eb)};ld.prototype.fia=function(T){this.xfb&&this.xfb(T?T.data:null)};ld.prototype.tHi=function(T){this.Z6d&&this.Z6d(T?T.data:null)};ld.prototype.iNa=function(T){this.Lhb&&this.Lhb(T?T.data:null)};ld.prototype.dad=function(T){for(var Oa=new Sys.StringBuilder("requestedsettings="),
Eb=0;Eb<T.count;Eb++)Oa.append(T.oa(Eb)),Eb<T.count-1&&Oa.append(";");return Oa.toString()};Object(od.a)(ld,"FirstRunExperienceRequestHandler",null,[]);Rc.prototype.BKd=function(T){T?(this.gw=T,this.F3h()&&(mc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),T=new Uf.a,T.add(this.gw.PQc),this.wOb=new ld(this.gw,Object(za.a)(this,this.BIa,"getRequestSuccessCallback"),Object(za.a)(this,this.fia,"getRequestFailureCallback"),null,Object(za.a)(this,
this.iNa,"postRequestFailureCallback")),this.wOb.I4c(T)),(this.gw.Fwb||ad.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.CKd()):mc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};Rc.prototype.F3h=function(){try{if(this.gw.Fwb)return!0;if(!ad.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||ad.AFrameworkApplication.ha.sa("IsAnonymousUser"))return!1;if(this.gw.K0h||
this.gw.r4a||ad.AFrameworkApplication.ha.sa("IsO365ConsumerHost"))return!0;var T=ad.AFrameworkApplication.ha.Ta("FlightId");return-1!==(T?T.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Oa){mc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Oa?Oa.toString():null)}return!1};Rc.prototype.lKf=function(T){var Oa={},Eb={};Eb.FREDisplayedDate=(new Date).toUTCString();Eb.VersionDisplayed=T;Eb.RemindMeLater=!1;Oa[this.gw.PQc]=Ke.c(Eb);mc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.wOb&&this.wOb.J4c(Oa)};Rc.prototype.BIa=function(T,Oa){T=T?+T.a2-+T.bE:-1;T>this.gw.eJf?mc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",T,this.gw.eJf):Oa?this.jfj(Oa)?(mc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.gw.dgf),this.CKd()):mc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(mc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.CKd())};Rc.prototype.fia=function(T){mc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",T?T.httpStatus:-1)};Rc.prototype.iNa=function(T){mc.ULS.sendTraceTag(51675542,306,
10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",T?T.httpStatus:-1)};Rc.prototype.CKd=function(){var T=this,Oa=Ef.a.instance.Mh("Common.ISystemInitiatedFeedback");Oa?this.aTf(Oa):(mc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),ad.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Oa=Ef.a.instance.oc("Common.ISystemInitiatedFeedback"))?Oa.execute(function(Eb){T.aTf(Eb)}):
mc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};Rc.prototype.aTf=function(T){if(T){var Oa=this.gw.Knh;Oa&&(ad.AFrameworkApplication.Dja(Oa),ad.AFrameworkApplication.$xb(Oa));mc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Oa);T.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.pfb=Object(za.a)(this,this.Zri,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.pfb,!0),window.addEventListener("FRELaunchedEvent",this.pfb,!0)):(mc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.lKf(this.gw.currentVersion))}else mc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};Rc.prototype.Zri=function(T){if(T){var Oa=T.detail;T=T.type;var Eb=this.gw&&this.gw.campaignId?this.gw.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===T||Eb&&Oa&&Oa.id&&-1!==Oa.id.indexOf(Eb))Oa.success&&(mc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.lKf(this.gw.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.pfb,!0),window.removeEventListener("FRELaunchedEvent",this.pfb,!0))}};Rc.prototype.jfj=function(T){return"RemindMeLater"in T&&"FREDisplayedDate"in T&&"true"===T.RemindMeLater.toString()&&(+new Date-+new Date(T.FREDisplayedDate.toString()))/36E5>this.gw.dgf?!0:!1};Object(od.a)(Rc,"FirstRunExperienceLauncher",null,[232]);
hd.prototype.Qh=function(T){this.Za=T;this.Za.register(232,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").wc().Fc(function(){return new Rc})};hd.prototype.init=function(){};hd.prototype.dispose=function(){};hd.main=function(){yg.a.instance.ej(new hd)};Ll.Object.defineProperties(hd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(od.a)(hd,"FirstRunExperienceLauncherPackage",null,[8,9]);var zc=b(212),Hd=b(346),
Kd=b(371),he=b(349),Se=b(1),Ue=b(36),mf=b(10),Vg=b(517),Hf=b(16),Rg=Vg.a;Em(xc,Rg);xc.prototype.k3=function(){var T={};T.id=this.sc;var Oa=Hf.a.instance.da(2152);T.DialogMessage=Oa;return T};xc.prototype.cMg=function(){mc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};Ll.Object.defineProperties(xc.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});Object(od.a)(xc,"ClipboardReadPermissionAskDialog",Vg.a,[]);
var zf=b(49);ub.prototype.C4e=function(T){return T?this.sessionStateId===T.sessionStateId&&this.sessionId===T.sessionId:!1};ub.prototype.isFromCurrentSession=function(T){return this.sessionId===T.ya.UserSessionId};ub.prototype.Wqh=function(){var T={};T.SourceItem=this.toString();return T};Object(od.a)(ub,"SourceItem",null,[]);Em(dc,ub);dc.prototype.isEqual=function(T){return T&&Object.getType(T)===dc?this.C4e(T)&&this.activeFloatingObjectControlId===T.activeFloatingObjectControlId&&this.sheetName===
T.sheetName:!1};dc.prototype.toString=function(){return this.type.toString()};Object(od.a)(dc,"ArtSourceItem",ub,[]);var gg;(function(T){T[T.valid=0]="valid";T[T.notPairwiseDisjoint=1]="notPairwiseDisjoint";T[T.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";T[T.notValidForm=3]="notValidForm";T[T.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(gg||(gg={}));Object(od.b)("CopySourceValidationOptions",gg);var Xe=b(46);Em(ce,ub);ce.prototype.isEqual=function(T){return T&&
Object.getType(T)===ce?this.C4e(T)&&Xe.Q(this.ranges,T.ranges)&&this.sheetName===T.sheetName:!1};ce.prototype.toString=function(){return Xe.i(this.ranges,",",this.$,!1)};Object(od.a)(ce,"RangeSourceItem",ub,[]);Ta.mAj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(od.a)(Ta,"ExpectedErrorNames",null,[]);Ib.bV="text/plain";Ib.html="text/html";Ib.png="image/png";Ib.jN="data/shadow-workbook";Ib.l3h="metadata/is-last-copy-was-external";Ib.a0h="metadata/is-last-copy-was-external-XLO-source";
Ib.DKg="metadata/chrome-extension-id";Ib.oYc="copyId";Ib.rvg="metadata/additional-signature-data-attributes";Object(od.a)(Ib,"ClipboardDataFormat",null,[]);var If=b(7),yf=b(45),Bf=b(20),Vb=b(34);fe.prototype.cIa=function(){return fe.UEi};fe.prototype.syh=function(){return this.D4b&&1===this.D4b.length?this.tyh(this.D4b[0]):null};fe.prototype.tyh=function(T){var Oa=Bf.g(this.$),Eb=Oa.Wa.Bj(T),vc=Oa.Eg(T,Eb);Oa=Oa.rtl;if(!vc)return null;T=Bf.g(this.$).Mf(Eb);var gd=T.Wm;if(!gd.$d(vc))return null;vc=
gd.Ef(vc);var Cd=vc.topLeft.y,Fd=vc.bottomRight.y,$d=Oa?vc.bottomRight.x:vc.topLeft.x;vc=Oa?vc.topLeft.x:vc.bottomRight.x;var Ae=new yf.a(vc+(Oa?-81:81),Fd+38+6);if(gd.xYa(Ae))return this.Z0a(T,gd,Eb,vc,Fd,Oa?12:-3,66);Ae=new yf.a(vc+(Oa?-81:81),Fd);if(gd.xYa(Ae))return this.Z0a(T,gd,Eb,vc,Fd,Oa?20:3,22);Ae=new yf.a(vc,Fd+38+6);if(gd.xYa(Ae))return this.Z0a(T,gd,Eb,vc,Fd,-81+(Oa?18:0),66);vc=new yf.a($d+(Oa?81:-81),Fd);if(gd.xYa(vc))return this.Z0a(T,gd,Eb,$d,Fd,-81+(Oa?12:-6),22);Fd=new yf.a($d,
Cd-38-6);return gd.xYa(Fd)?this.Z0a(T,gd,Eb,$d,Cd,Oa?15:0,16):this.Z0a(T,gd,Eb,Oa?gd.topLeft.x:gd.bottomRight.x,gd.bottomRight.y,-81+(Oa?15:-6),22)};fe.prototype.Z0a=function(T,Oa,Eb,vc,gd,Cd,Fd){var $d=Bf.g(this.$),Ae=$d.rtl;T=Sys.UI.DomElement.getLocation(T.domElement);vc=new Sys.UI.Point(vc+(Ae?0:T.x)-Oa.topLeft.x,gd+T.y-Oa.topLeft.y);Ae&&($d=$d.view.visibleArea,vc.x=$d.bottomRight.x-$d.topLeft.x-vc.x,2===Eb||4===Eb)&&(vc.x+=Oa.bottomRight.x);vc=Vb.a(this.$).xIa(vc);return new Sys.UI.Point(vc.x+
Cd,vc.y+Fd)};Ll.Object.defineProperties(fe.prototype,{qvg:{configurable:!0,enumerable:!0,get:function(){return this.o9f}},P$h:{configurable:!0,enumerable:!0,get:function(){return this.vfg}},iPi:{configurable:!0,enumerable:!0,get:function(){return this.gig}},zjh:{configurable:!0,enumerable:!0,get:function(){return this.ccg}}});fe.UEi=["PasteRecoveryUI"];Object(od.a)(fe,"PasteRecoveryUI",null,[339]);var Qc=b(79),md=b(306);Vc.lng="ActiveSelection";Vc.jN="ShadowWorkbook";Vc.K7f="GVML";Vc.bV="PlainText";
Vc.html="Html";Vc.DBg="Bitmap";Object(od.a)(Vc,"PayloadType",null,[]);Nd.Vij="Slice4";Nd.Wij="Slice5";Nd.Xij="Slice6";Object(od.a)(Nd,"SliceName",null,[]);He.qli="NotCalled";He.success="Success";He.failed="Failed";Object(od.a)(He,"SucceededPopulatingSystemClipboardOptions",null,[]);var Ce=b(351),le;(function(T){T[T.valid=0]="valid";T[T.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";T[T.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";
T[T.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";T[T.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";T[T.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";T[T.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";T[T.copySourceNotValid=7]="copySourceNotValid";T[T.cutNotSupportedInDiscontinuousSelection=
8]="cutNotSupportedInDiscontinuousSelection";T[T.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";T[T.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";T[T.unknown=100]="unknown"})(le||(le={}));Object(od.b)("PasteValidationOptions",le);var Zd=b(58),fg=b(44),Kg=b(141),$g=b(35),pa=b(148),tb=b(334),qc=b(27),jd=b(453),Sd=b(9),ye=b(105),Ye=b(155),wf=b(132),Ma=b(592),gb=b(106),Wb=b(332),Kc=Ue.a;Em(Pc,Kc);Pc.prototype.Gtg=function(T){this.addHandler(Pc.Rud,T)};Pc.prototype.eVi=
function(T){this.removeHandler(Pc.Rud,T)};Pc.prototype.copy=function(T){T.stopwatch=this.$.Vb.Dc("UserAction",zf.b().$h(T.ribbonCommandInfo.command)+"ClientSide");if(this.Sn){var Oa=Zd.GetServiceTaskFactory.Va(this.$.ea,478,479,0,"Microsoft.Office.Excel.WebUI.Client.Clipboard.IPasteShortcutManager"),Eb=this;$g.TaskExtensions.Aa(Oa,function(){Eb.pasteShortcutManager=Oa.result},this.la,3)}var vc=!!Ee(this.FJ);Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!hf.a.$z&&(this.d4a=!1);this.mv("Copy/before/"+Hd.a[T.ribbonCommandInfo.method],!1,void 0,!0,T.copyPasteTargetType).catch(function(){});var gd=-1985798686===T.ribbonCommandInfo.command;if(1===this.gridView.Qe&&(gd=this.fr.T3e(this.gridView.ga.wa.selectedRanges,gd))){var Cd=Pc.sQg(gd);this.kxa(Cd,gg[gd],!1);return Promise.reject(!1)}T.userHash=this.userHash;T.id=Sg.a.create().toString();var Fd=this,$d=this;return this.P_b.onCopy(T).then(function(Ae){Ae.isAsyncCopy||T.stopwatch.stop();Fd.pasteIndicationManager.dBe();
mc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",Ce.d(T));Fd.nci(Ae,vc);!T.isFormatPainter&&Fd.Sn&&(Fd.pasteShortcutManager?Fd.pasteShortcutManager.k8g():mc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(Ae){var $e=!1,qg="none",Tg=Pc.Oob,jg=!0,vf=-1,Xg=Pc.copyErrorName+Pc.UGa,bh=!1,Fh=null;if(Ae){Fh=Ae.copyContext;vf=Ae.reason;Xg+=Pc.jIa(Ae);If.a.ma(Ae.message)||(Tg=Ae.message);
var gh=Pc.rQg(Ae);if(gh)if(3===gh.copyErrorName)$e=!0,Tg=qg="Async Copy canceled by the user.",jg=!1;else if(qc.a.vq(gh.ewaErrors))if(Tg=$d.B7b(gh.ewaErrors),qc.a.Yg(gh.ewaErrors,Pc.operationSucceededWithAlert))bh=$e=!0;else if(qc.a.Yg(gh.ewaErrors,Pc.pasteDataLimitHit)||qc.a.Yg(gh.ewaErrors,Pc.copyThrottlingError))$e=!0;13===Ae.reason?($e=!0,jg=!1):11===Ae.reason&&(jg=!1)}$e?mc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",
jg,qg,Ae?$d.getStringifiedError(Ae):"null",Ce.d(T)):mc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",jg,Ae?$d.getStringifiedError(Ae):"null",Ce.d(T));jg&&$d.mv("Copy/fail/"+Hd.a[T.ribbonCommandInfo.method],!0,void 0,void 0,T.copyPasteTargetType).catch(function(){});$d.mci(T,$e,Tg,Xg,vf,bh,Fh);return Promise.reject(Ae)})};Pc.prototype.paste=function(T){var Oa=this;T.stopwatch=
this.$.Vb.Dc("UserAction",zf.b().$h(T.ribbonCommandInfo.command)+"ClientSide");Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!hf.a.$z&&(mc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.d4a=!1,T.clipboardPicklingApiDataFormatsToRead=[Ib.jN]);Bf.g(this.$).vi&&Bf.g(this.$).vi.g6(this.H$c(T.ribbonCommandInfo.command),T.stopwatch.id);if(T.isPasteCommandFromRecoveryUI){var Eb=this.$.ea.Ba(406);
var vc=Kd.a.clone(Eb.Vld);Eb=Eb.Hld;T.pasteRecoveryCachedClipboardItems=Eb?Eb[Pc.SEi]:null}else vc=Kd.a.clone(this.gridView.ga.wa.selectedRanges);T.originalDestinations=vc;T.expandDestinations=this.MTc(T.originalDestinations,T.commandType);if(this.aUc(T.commandType,T.expandDestinations)||this.IHg())return T.userHash=this.userHash,T.id=Sg.a.create().toString(),Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!hf.a.$z&&(T.clipboardReadPermissionPromptShown=
!1,T.clipboardAsyncApiDataFormatsToRead=[Ib.bV+"Async"],this.P_b.shouldShowClipboardReadPermissionDialog().then(function(gd){gd&&(T.clipboardReadPermissionPromptShown=!0,new xc(Oa.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.P_b.onPaste(T).then(function(gd){return Oa.Ric(gd,T)},function(gd){return Oa.PAb(T,gd)});this.p3e&&this.$.De(927125067,Qc.a.Tb,30,null);mc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',
Xe.i(T.expandDestinations,",",this.$,!1),T.commandType,T.copyPasteTargetType);return Promise.resolve(!0)};Pc.prototype.H$c=function(T){if(Se.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(T){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8}return 3};Pc.prototype.IHg=function(){return!!Bf.g(this.$).ga.Pa.activeFloatingObjectControlId&&this.$.Xs(null,!1,470)};Pc.prototype.qxb=function(){var T=Ee(this.FJ);return T&&T.commandParameters?T.commandParameters.copyPasteTargetType:
0};Pc.prototype.k3h=function(){return!!Ee(this.FJ)&&Vd(Ee(this.FJ),this.$)};Pc.prototype.mv=function(T,Oa,Eb,vc,gd){var Cd=this;Eb=void 0===Eb?!1:Eb;vc=void 0===vc?!1:vc;gd=void 0===gd?0:gd;try{this.Sn&&this.pasteShortcutManager&&this.pasteShortcutManager.e2b();var Fd=gd,$d=this.N9h();if(!vc&&2===$d)return mc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",
Oa,Eb,vc,gd,$d),Promise.reject(null);Fd||(Fd=$d);var Ae=this.$.Vb.Dc("UserAction","ClearCopyState"),$e=Ae.id;mc.ULS.sendTraceTag(537167820,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Oa,Eb,vc,gd,$d);this.fr.Utb();this.lMi();return this.P_b.onCancelCopy(Oa).then(function(){Oa&&Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!hf.a.$z&&(Cd.d4a=!1);Ae.stop();Cd.dcf(T,$e,!0,Eb,Oa,"","",Ae.Cc,Fd);return Promise.resolve(!0)},function(qg){mc.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",qg?Cd.getStringifiedError(qg):"null");Ae.stop();var Tg=Pc.WHg+Pc.UGa,jg=Pc.Oob;qg&&(Tg+=Pc.jIa(qg),If.a.ma(qg.message)||(jg=qg.message));Cd.dcf(T,$e,!1,Eb,Oa,jg,Tg,Ae.Cc,Fd);return Promise.reject(qg)})}catch(qg){return Promise.reject(null)}};Pc.prototype.oZb=
function(T,Oa,Eb,vc,gd){Eb=void 0===Eb?!1:Eb;vc=void 0===vc?!1:vc;gd=void 0===gd?0:gd;return vc||!Se.EwaSettings.ka(699)||this.$4g()?this.mv(T,Oa,Eb,vc,gd):(mc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};Pc.prototype.kxa=function(T,Oa,Eb){mc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",
Oa);if(Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")){var vc=new gb.a;vc.ia("reason",Oa);Ma.a(Ye.a.discontinuousSelectionBlocking,[Eb?wf.a.OEi:wf.a.kRg],!0,!0,!1,!1,vc)}T=qc.a.gd(1,1,721,T,0,371863010,"DiscontinuousSelectionBlocking");Se.EwaSettings.eA()?new tb.a(this.$,T):(T=new pa.ErrorDialog(this.$,T),T.initialize(),T.mf())};Pc.prototype.N9h=function(){var T=Ee(this.FJ);return T&&T.sourceItem?Object.getType(T.sourceItem)===dc?2:1:0};Pc.prototype.dragDropCells=
function(T,Oa,Eb,vc,gd){var Cd=this;gd=void 0===gd?!1:gd;T.stopwatch=this.$.Vb.Dc("UserAction","DragDropClientSide");this.mv("DragDrop/before/"+Hd.a[T.ribbonCommandInfo.method],!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Fd=gd?2:1,$d=0;$d=gd?4:vc?256:128;var Ae={encounteredDeploymentErrors:!1};Ae.commandParameters=T;T.userHash=this.userHash;T.id=Sg.a.create().toString();return this.fr.pasteRange(T.ribbonCommandInfo,Xe.q(Oa,this.$),Xe.q(Eb,this.$),Fd,$d,[T.stopwatch],Ae,!1).then(function(){mc.ULS.sendTraceTag(537167818,
0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',T.copyPasteTargetType);Cd.gridView.ga.selectionType=-1;Cd.snd(T,Fd,Oa,Eb,Ae);return Promise.resolve(!0)},function($e){mc.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',$e?Cd.getStringifiedError($e):"null",T.copyPasteTargetType);return Cd.itd($e,T,Fd,Oa,Eb,Ae)})};Pc.prototype.v5g=function(T,Oa,Eb,vc,gd){var Cd=this;gd=void 0===gd?!1:gd;T.stopwatch=this.$.Vb.Dc("UserAction",
"DragDropReplaceClientSide");this.oZb("DragDropReplace/before/"+Hd.a[T.ribbonCommandInfo.method],!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Fd=gd?2:1,$d=0;$d=gd?4:vc?256:128;var Ae={encounteredDeploymentErrors:!1};Ae.commandParameters=T;Se.EwaSettings.getBooleanFeatureGate(md.a.rpb,!1)&&(T.isDragInsert=!1);T.userHash=this.userHash;T.id=Sg.a.create().toString();return this.fr.pasteRange(T.ribbonCommandInfo,Xe.q(Oa,this.$),Xe.q(Eb,this.$),Fd,$d,[T.stopwatch],Ae,!1).then(function(){mc.ULS.sendTraceTag(537167816,
0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',T.copyPasteTargetType);Cd.gridView.ga.selectionType=-1;Cd.snd(T,Fd,Oa,Eb,Ae);return Promise.resolve(!0)},function($e){mc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',$e?Cd.getStringifiedError($e):"null",T.copyPasteTargetType);return Cd.itd($e,T,Fd,Oa,Eb,Ae)})};Pc.prototype.t5g=function(T,Oa,Eb,vc,gd){var Cd=this;gd=void 0===gd?!1:gd;T.stopwatch=
this.$.Vb.Dc("UserAction","DragDropInsertClientSide");this.oZb("DragDropInsert/before/"+Hd.a[T.ribbonCommandInfo.method],!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Fd=gd?2:1,$d=Xe.K(this.MTc([Eb],Fd)),Ae=this.$.fa.qa.sheetName,$e=this.$.fa.qa.sheetName,qg=Xe.v(Oa,this.$);qg.SheetName=Ae;Ae=Xe.v($d,this.$);Ae.SheetName=$e;vc=$d.isRow||Oa.isRow||vc?1:0;var Tg={encounteredDeploymentErrors:!1};T.isDragInsert=!0;Tg.commandParameters=T;T.userHash=this.userHash;T.id=Sg.a.create().toString();
gd=this.fr.y5g(Tg,qg,Ae,gd,vc,T.ribbonCommandInfo);var jg=this;return Wb.c(gd.then(function(){mc.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',T.copyPasteTargetType);Cd.gridView.ga.selectionType=-1;Cd.snd(T,Fd,Oa,Eb,Tg);return Promise.resolve(!0)},function(vf){mc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',vf?jg.getStringifiedError(vf):"null",T.copyPasteTargetType);
return jg.itd(vf,T,Fd,Oa,Eb,Tg)})).CWR(function(){return!0})};Pc.prototype.yXh=function(T,Oa){var Eb=this,vc=Ee(this.FJ);if(!vc)return mc.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),je.Task.Ra(!1);if(!kd(vc.sourceItem))return mc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),je.Task.Ra(!1);var gd=vc.sourceItem;if(!gd)return mc.ULS.shipAssertTag(537167810,0,!!gd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),
je.Task.Ra(!1);if(!gd.isFromCurrentSession(this.$))return mc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),je.Task.Ra(!1);if(1<gd.ranges.length)return mc.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.kxa(2093,"InsertCopiedCutCells",!0),je.Task.Ra(!1);vc=Xe.K(gd.ranges);var Cd=this.gridView.ga.wa.Nd.clone();T=Xe.K(this.MTc([Cd],T));var Fd=this.U$e();gd=gd.sheetName;Cd=this.$.fa.qa.sheetName;
var $d=Xe.v(vc,this.$);$d.SheetName=gd;var Ae=Xe.v(T,this.$);Ae.SheetName=Cd;return(T.Fh||vc.Fh?je.Task.Ra(0):T.isRow||vc.isRow?je.Task.Ra(1):this.zXh.Z_b(this.$,Bf.g(this.$).rtl)).CWR(function($e){return Eb.fr.executeInsertCopiedCutCellsOperation($d,Ae,Fd,$e.result,Oa)}).continueWith(function(){Fd?Eb.fr.Utb():Eb.mv("InsertCopiedCutCells/success/"+Hd.a[Oa.method],!0)})};Pc.prototype.Zhd=function(){var T=Ee(this.FJ),Oa=this.gridView.ga.wa.xh;return!!T&&kd(T.sourceItem)&&Oa&&1===T.sourceItem.ranges.length};
Pc.prototype.U$e=function(){return this.V$e(-911352779)};Pc.prototype.nec=function(){return this.V$e(-1985798686)};Pc.prototype.aUc=function(T,Oa){var Eb=new Kg.a(this.$.va),vc=36===T,gd=Eb.we(4);T=2===this.qxb()&&Eb.we(1);vc=vc&&gd;Eb=!this.p3e||!Eb.Pi||!this.nec()||!Kg.a.F2b(Oa,Bf.g(this.$));return vc||T||this.$.Xs(Oa,!0)&&Eb};Pc.prototype.Nbc=function(T,Oa){return this.fr.Nbc(T,Oa)};Pc.prototype.dispose=function(){Kc.prototype.dispose.call(this);this.$l();this.FJ.removeMetadataChangeListener(Pc.Yff)};
Pc.prototype.t1c=function(T,Oa,Eb,vc,gd,Cd){if(!this.OLg(T.commandParameters.ribbonCommandInfo.command))return T.cseStatus=2,!1;if(Cd&&Oa.$d(vc))return T.cseStatus=4,!1;if(Eb!==gd)return T.cseStatus=6,!1;if(Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")){if(vc.width%Oa.width||vc.height%Oa.height)return T.cseStatus=16,!1;if(Cd&&1!==vc.BO&&vc.BO!==Oa.BO)return T.cseStatus=17,!1}Oa=Oa.Ef(this.gridView.Hh);vc=vc.Ef(this.gridView.Hh);if(!Oa||!vc)return T.cseStatus=7,!1;
gd=Xe.v(Oa,this.$);gd.SheetName=Eb;Eb=this.ji.REi(this.gridView,gd,Xe.v(vc,this.$),T.commandParameters.ribbonCommandInfo.command,T.commandParameters.stopwatch);1===Eb&&(Cd&&(this.ji.TVc(Oa,!1),this.ji.TVc(Oa,!0)),-185374993===T.commandParameters.ribbonCommandInfo.command&&Bf.g(this.$).YLi(),this.pasteIndicationManager.jdd(T.commandParameters.id),this.rpc(T.commandParameters.expandDestinations,T.commandParameters.isPasteCommandFromRecoveryUI),this.Pqe("DoPasteClientEstimation/"+Hd.a[T.commandParameters.ribbonCommandInfo.method],
T));T.cseStatus=Eb;return 1===Eb};Pc.prototype.axf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,Object(za.a)(this,this.cei,"logShortcutDialogAndRestoreFocus"))};Pc.prototype.Ldi=function(T,Oa,Eb,vc){T=pc(T,Oa,Eb,vc,this.$.ya.UserSessionId);T.k=!0;zf.b().Je(45,T,!0)};Pc.prototype.Pxi=function(T,Oa,Eb,vc,gd){var Cd=!1,Fd=!1,$d=Pc.Oob,Ae=Pc.hBe+Pc.UGa;T&&(Ae+=Pc.jIa(T),qc.a.vq(T.ewaErrors)?($d=this.B7b(T.ewaErrors),qc.a.Yg(T.ewaErrors,[-103190598])&&(Cd=!0)):T.message&&
($d=T.message));Fd||(Fd=this.thd(T));Oa=pc(Oa,Eb,vc,gd,this.$.ya.UserSessionId);Oa.k=!1;Oa.l=Fd;Oa.n=$d;Oa.p=Ae;Oa.q=Cd;zf.b().Je(45,Oa,!0);return Promise.reject(T)};Pc.prototype.OLg=function(T){switch(T){case 237279923:case 808159687:return md.a.s4h;case -185374993:return!0;case 1804571062:return!0;default:return!1}};Pc.prototype.V$e=function(T){var Oa=Ee(this.FJ);if(!Oa)return!1;var Eb=Oa.sourceItem;return Eb&&!Eb.isFromCurrentSession(this.$)?(mc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),
!1):Oa.commandParameters.ribbonCommandInfo.command===T};Pc.prototype.$4g=function(){var T=Ee(this.FJ);return T?(T=T.sourceItem)&&!T.isFromCurrentSession(this.$)?(mc.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};Pc.prototype.bud=function(T){this.Hcj(T)&&(this.fr.Utb(),mc.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
Pc.prototype.Hcj=function(T){return T&&T.lastCopy?Vd(T.lastCopy,this.$):!0};Pc.prototype.WPe=function(T,Oa,Eb,vc,gd){var Cd={};Cd.a=this.$.ya.UserSessionId;Cd.e=T.stopwatch.id;Cd.c=zf.b().$h(T.ribbonCommandInfo.command);Cd.b=Hd.a[T.ribbonCommandInfo.method];Cd.d=T.id;Cd.f=Eb.toString();Cd.g=vc.toString();Cd.h=Oa.toString();Cd.o=T.stopwatch.Cc;Cd.q=!1;Cd.r=T.copyPasteTargetType.toString();Cd.s=gd.encounteredDeploymentErrors;Se.EwaSettings.getBooleanFeatureGate(md.a.rpb,!1)&&(Cd.i=gd.commandParameters.dragDropIsShiftKeyDown,
Cd.j=gd.commandParameters.isDragInsert);return Cd};Pc.prototype.snd=function(T,Oa,Eb,vc,gd){T=this.WPe(T,Oa,Eb,vc,gd);T.k=!0;zf.b().Je(45,T,!0)};Pc.prototype.sci=function(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){T=this.WPe(T,Oa,Eb,vc,Ae);T.k=!1;T.l=gd;T.n=Cd;T.p=Fd;T.q=$d;zf.b().Je(45,T,!0)};Pc.prototype.dcf=function(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){var $e={};$e.a=this.$.ya.UserSessionId;$e.b=Oa;$e.c=T;$e.f=Eb;$e.e=vc;$e.d=gd;$e.g=Cd;$e.h=Fd;$e.i=$d;$e.j=Ae.toString();zf.b().Je(46,$e,!0)};Pc.prototype.nci=function(T,
Oa){T=this.uPe(T.commandParameters,T);T.l=!0;T.j=Oa;zf.b().Je(43,T,!0)};Pc.prototype.mci=function(T,Oa,Eb,vc,gd,Cd,Fd){T=this.uPe(T,Fd);T.l=!1;T.m=Oa;T.o=Eb;T.y=vc;T.x=gd;T.z=Cd;zf.b().Je(43,T,!0);mc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",T.y,T.x,T.m,T.z,T.o)};Pc.prototype.uPe=function(T,Oa){var Eb={};Eb.a=this.$.ya.UserSessionId;Eb.f=T.stopwatch.id;Eb.g=T.id;Eb.c=
zf.b().$h(T.ribbonCommandInfo.command);Eb.b=Hd.a[T.ribbonCommandInfo.method];Eb.q=T.stopwatch.Cc;Eb.bd=Pc.M6b();Eb.bg=T.copyPasteHandlerName;Eb.bj=void 0===T.ribbonCommandInfo.Ze||null===T.ribbonCommandInfo.Ze?null:he.a[T.ribbonCommandInfo.Ze];Eb.bq=T.uploadToClipService;Eb.br=T.floatingObjectType;Eb.s=T.copyPasteTargetType.toString();Eb.bc=Id(T.copyPasteTargetType);Eb.z=!1;if(Oa){Eb.bk=Oa.id;Eb.bl=Oa.serverRequestTimeInMs;Oa.requestTelemetryData&&(Eb.bm=Oa.requestTelemetryData.EcsOperationDuration,
Eb.bn=Oa.requestTelemetryData.EcsRequestDuration,Eb.bo=Oa.requestTelemetryData.WfeRequestDuration);Eb.d=Oa.sourceItem?Oa.sourceItem.toString():null;Eb.e=-1;if(kd(Oa.sourceItem)){Eb.e=0;T=Ol(Oa.sourceItem.ranges);for(var vc=T.next();!vc.done;vc=T.next())Eb.e+=vc.value.BO}Eb.h=Oa.isAsyncCopy;Eb.i=Oa.isFromCache;Eb.k=Oa.isSelectionAllowed;Eb.r=Oa.plainTextPayloadSize;Eb.u=Oa.htmlPayloadSize;Eb.v=Oa.htmlSizeExceedsLimit;Eb.w=Oa.copyTotalSizeExceedsLimit;Eb.t=Oa.shadowWorkbookPayloadSize;Eb.p=Oa.clientSideCopyTime;
Eb.ba=Oa.encounteredDeploymentErrors;Eb.bb=Oa.shadowWorkbookSizeExceedsLimit;Eb.be=Oa.syncClipboardItemsKeys;Eb.bf=Oa.asyncClipboardItemsKeys;Eb.bh=this.eue(Oa.succeededPopulatingSystemClipboardSync);Eb.bi=this.eue(Oa.succeededPopulatingSystemClipboardAsync)}return Eb};Pc.prototype.rpc=function(T,Oa){Oa=void 0===Oa?!1:Oa;if(!this.gridView.isEditing&&!this.gridView.li){var Eb=this.gridView.ga.wa,vc=!Oa&&1===T.length&&Xe.Q(T,Eb.selectedRanges),gd=vc?Eb.activeCell:T[0].topLeft;T[0].contains(gd)||(mc.ULS.shipAssertTag(537167775,
0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",Eb.selectedRanges,Eb.Yz,Eb.activeCell,T,vc,gd,Oa),gd=T[0].topLeft);this.gridView.ga.JC(T,0,gd,0,void 0,ye.a.oRg)}};Pc.prototype.hTe=function(T,Oa){var Eb={};Eb.a=this.$.ya.UserSessionId;Eb.g=T.stopwatch.id;Eb.t=T.stopwatch.Cc;Eb.bz=!1;Oa&&(Eb.bv=Oa.id,Eb.bw=Oa.serverRequestTimeInMs,
Eb.n=Oa.commandParameters.clipboardFormatReadTimes,Eb.o=Oa.commandParameters.clipboardFormatReadStatus,Eb.p=Oa.commandParameters.clipboardReadPermissionPromptShown,Eb.q=Oa.commandParameters.asyncApiReadTimedOut,Oa.requestTelemetryData&&(Eb.cb=Oa.requestTelemetryData.EcsOperationDuration,Eb.cc=Oa.requestTelemetryData.EcsRequestDuration,Eb.cd=Oa.requestTelemetryData.WfeRequestDuration));Eb.x=T.copyPasteTargetType.toString();Eb.bl=Id(T.copyPasteTargetType);Eb.br=T.copyPasteHandlerName;Eb.i=Xe.i(T.expandDestinations,
",",this.$,!1);Eb.h=Xe.i(T.originalDestinations,",",this.$,!1);Eb.e=T.id;Eb.d=T.commandType;Eb.c=zf.b().$h(T.ribbonCommandInfo.command);Eb.b=Hd.a[T.ribbonCommandInfo.method];Eb.bf=!1;Eb.bg=!1;Eb.bp=Pc.M6b();Eb.bt=void 0===T.ribbonCommandInfo.Ze||null===T.ribbonCommandInfo.Ze?null:he.a[T.ribbonCommandInfo.Ze];Eb.cj=T.isPasteCommandFromEnterShortcut;if(Eb.ca=T.isPasteCommandFromRecoveryUI)Eb.cf=T.pasteRecoveryUndoStopwatch.id,Eb.cg=T.pasteRecoveryUndoStopwatch.Cc;if(Oa){if((T=Oa.copyContextSnapshot)&&
!Oa.wasLastCopyExternal){Eb.f=T.commandParameters.id;Eb.j=T.sourceItem.toString();Eb.k=-1;if(kd(T.sourceItem)){Eb.k=0;for(var vc=Ol(T.sourceItem.ranges),gd=vc.next();!gd.done;gd=vc.next())Eb.k+=gd.value.BO}Eb.bg=1===T.commandParameters.commandType}else Oa.clipboardItems?Eb.f=Oa.clipboardItems.getItem(Ib.oYc):mc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");Eb.bz=Oa.pasteRecoveryUIDisplayed;Eb.ci=Oa.cseStatus}else mc.ULS.sendTraceTag(537167773,
0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Eb};Pc.prototype.ydi=function(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){T=this.hTe(T,$d);T.l=!1;T.m=Oa;T.s=Eb;T.bc=vc;T.be=gd;T.bd=Cd;T.bf=Fd;$d?(T.y=fc($d)||!$d.copyContextSnapshot,T.bi=!T.y&&Vd($d.copyContextSnapshot,this.$),T.bj=$d.shadowWorkbookSizeExceedsLimit,T.v=$d.shadowWorkbookPayloadSize,T.w=$d.htmlPayloadSize,T.bq=rd($d.clipboardItems),T.bb=$d.activeSelectionType,T.bs=$d.isSameSession,T.bn=$d.payloadOrigin,T.bo=$d.payloadType,
T.bu=$d.externalAppSource,T.bx=$d.indicationDisplayScheduled,T.by=$d.pasteIndicationDisplayStatus):T.bi=Vd(Ae,this.$);zf.b().Je(44,T,!0);mc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",T.be,T.bd,T.m,T.bf,T.s)};Pc.prototype.zdi=function(T){var Oa=this.hTe(T.commandParameters,T);Oa.y=T.wasLastCopyExternal;Oa.l=!0;Oa.u=T.plainTextPayloadSize;Oa.v=T.shadowWorkbookPayloadSize;
Oa.w=T.htmlPayloadSize;Oa.z=T.isClipboardDataContainShadowWorkbook;Oa.ba=T.isShadowWorkbookParsedSuccessfully;Oa.bb=T.activeSelectionType;Oa.bc=T.pasteResult;Oa.bh=T.encounteredDeploymentErrors;Oa.bj=T.shadowWorkbookSizeExceedsLimit;Oa.bk=lf(T);Oa.bq=rd(T.clipboardItems);Oa.bs=T.isSameSession;Oa.bn=T.payloadOrigin;Oa.bo=T.payloadType;Oa.bu=T.externalAppSource;Oa.bx=T.indicationDisplayScheduled;Oa.by=T.pasteIndicationDisplayStatus;Oa.bm=T.clipboardItems?T.clipboardItems.getItem(Ib.DKg):null;Oa.bi=
!T.isSameSession&&!T.wasLastCopyExternal;zf.b().Je(44,Oa,!0)};Pc.prototype.Uj=function(){this.$.va.Pf(Object(za.a)(this,this.Ai,"onActiveSheetChanged"));this.$.va.Psg(Object(za.a)(this,this.tic,"onItemDeleting"));this.$.userOperationManager.jB(Object(za.a)(this,this.rQ,"onQueueItemChanged"));this.$.Jk(Object(za.a)(this,this.jd,"onWorkbookOpened"));Bf.g(this.$).Gc.Jm(Object(za.a)(this,this.gBb,"onStartEdit"))};Pc.prototype.$l=function(){this.$&&this.$.va&&(this.$.va.zg(Object(za.a)(this,this.Ai,"onActiveSheetChanged")),
this.$.va.wUi(Object(za.a)(this,this.tic,"onItemDeleting")));this.$&&this.$.userOperationManager&&this.$.userOperationManager.zC(Object(za.a)(this,this.rQ,"onQueueItemChanged"));this.gridView&&this.gridView.Gc&&this.gridView.Gc.ym(Object(za.a)(this,this.gBb,"onStartEdit"))};Pc.prototype.PAb=function(T,Oa){var Eb=null,vc=!1,gd=null,Cd="UnknownFailure",Fd=-1,$d=Pc.Oob,Ae=Pc.pasteErrorName+Pc.UGa,$e=!1;this.pasteIndicationManager.jdd(T.id);var qg=Ee(this.FJ);(T.clearStateOnFinish||T.clearSystemClipboard)&&
this.mv("Paste/fail/"+Hd.a[T.ribbonCommandInfo.method],!0,void 0,void 0,T.copyPasteTargetType).catch(function(){});if(Oa){Fd=Oa.reason;Ae+=Pc.jIa(Oa);If.a.ma(Oa.message)||($d=Oa.message);if(Eb=Pc.GQg(Oa))if(1===Eb.pasteErrorName)vc=!0,Cd="CopyPasteLengthTooLongPopup",$d=gd="The pasted content is too long. Popup a dialog to the user.",mc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,T.copyPasteTargetType),Eb=qc.a.gd(1,0,26,662,0,1306609195,
"CopyPasteOversizeError"),Se.EwaSettings.eA()?new tb.a(this.$,Eb):(Eb=new pa.ErrorDialog(this.$,Eb),Eb.initialize(),Eb.mf());else if(7===Eb.pasteErrorName)vc=!0,Cd="No-Op",$d=gd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",mc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,T.copyPasteTargetType);else if(8===Eb.pasteErrorName)vc=!0,Cd="UseShortcutsPopup",$d=gd="Unable to paste content from the system clipboard. Popup dialog to the user.",
mc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,T.copyPasteTargetType),this.axf();else if(18===Eb.pasteErrorName){vc=!0;Cd="PasteExternalNotSupportMultipleSelectionPopup";$d="Paste external not support multiple selection.";gd="Unknown";var Tg=2093;100!==Eb.validationFailureReason&&(gd=le[Eb.validationFailureReason],Tg=Pc.Xte(Eb.validationFailureReason));this.kxa(Tg,gd,!0)}else 20===Eb.pasteErrorName||19===Eb.pasteErrorName?(vc=!0,20===Eb.pasteErrorName?
(Cd="PasteAcrossSessionNotSupportMultipleSelectionPopup",$d="Paste across session does not support multiple selection."):(Cd="PasteInSameSessionNotSupportMultipleSelectionPopup",$d="This kind of multiple selection is not supported for same session paste."),gd="Unknown",Tg=2093,100!==Eb.validationFailureReason&&(gd=le[Eb.validationFailureReason],Tg=Pc.Xte(Eb.validationFailureReason)),Eb=6===Eb.validationFailureReason,this.aUc(T.commandType,T.expandDestinations)&&Eb&&this.rpc(T.expandDestinations),
this.kxa(Tg,gd,!0)):6===Eb.pasteErrorName?(vc=!0,Cd="No-Op",$d=gd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",mc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,T.copyPasteTargetType)):17===Eb.pasteErrorName?(vc=!0,Cd="No-Op",$d=gd="Paste text on Art is not yet a supported operation",mc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,T.copyPasteTargetType)):
16===Eb.pasteErrorName?(vc=!0,Cd="No-Op",$d=gd="Paste has failed because the previous copy has failed",mc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',gd,T.copyPasteTargetType,this.getStringifiedError(Eb))):qc.a.vq(Eb.ewaErrors)?(qc.a.C8(Eb.ewaErrors)||qc.a.Yg(Eb.ewaErrors,qc.a.c9b())?(vc=!0,Cd="CommunicationError",gd=qc.a.Uc(Eb.ewaErrors),mc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
$d,T.copyPasteTargetType)):qc.a.Yg(Eb.ewaErrors,Pc.R1i)?(vc=!0,Cd="SavingWorkbookError",gd=qc.a.Uc(Eb.ewaErrors),mc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',$d,T.copyPasteTargetType)):qc.a.Yg(Eb.ewaErrors,Pc.operationSucceededWithAlert)&&($e=vc=!0,Cd="OperationSucceededWithAlert",gd=qc.a.Uc(Eb.ewaErrors),mc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',$d,T.copyPasteTargetType)),vc||
($d=this.B7b(Eb.ewaErrors),vc=this.thd(Oa))):11===Eb.pasteErrorName&&(vc=!0,Cd="No-Op",$d="Paste has failed because user try copy cross-session oart object");15===Oa.reason&&(vc=!0,Cd="No-Op",$d="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");If.a.equals(Ae,Ta.mAj,!1)&&(vc=!0,Cd="No-Op",$d="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}vc||mc.ULS.sendTraceTag(24150916,
0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Oa?this.getStringifiedError(Oa):"null",T.copyPasteTargetType);this.ydi(T,vc,$d,Cd,Ae,Fd,$e,Oa.pasteContext,qg);return Promise.reject(Oa)};Pc.prototype.Ric=function(T,Oa){mc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',Oa.copyPasteTargetType);this.pasteIndicationManager.jdd(Oa.id);if(this.XEi(Oa.copyPasteTargetType,T)){Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!hf.a.$z&&T.wasLastCopyExternal&&T.payloadType===Vc.jN&&(this.d4a=!0);var Eb=null;T.pastedRange&&T.pastedRange.Ranges&&0<T.pastedRange.Ranges.length?Eb=Xe.g(T.pastedRange.Ranges):T.wasLastCopyExternal||(Eb=Oa.expandDestinations);this.A3i(T,Eb);if(this.Aej(T,Eb)){var vc=Kd.a.clone(Oa.originalDestinations);Eb=1028===Oa.commandType?Kd.a.clone(Oa.expandDestinations):Kd.a.clone(Eb);var gd=null;T.wasLastCopyExternal&&(Oa.isKeyboardEvent||Oa.isPasteCommandFromRecoveryUI)&&(gd={},gd=(gd.PasteRecoveryCachedClipboardItems=
T.clipboardItems,gd));T.pasteRecoveryUIDisplayed=!0;var Cd=new fe(this.$,vc,Eb,gd),Fd=Zd.GetServiceTaskFactory.Va(this.$.ea,406,405,0,"Microsoft.Office.Excel.WebUI.Client.RecoveryUI.IRecoveryUIController");$g.TaskExtensions.Aa(Fd,function(){var $d=Fd.result;$d.CBg(Cd);$d.Mhj(Oa.ribbonCommandInfo.method)},this.la,3)}}this.Pqe("Paste/success/"+Hd.a[Oa.ribbonCommandInfo.method],T);this.zdi(T);this.mSf&&(!Oa.isKeyboardEvent||lf(T))&&this.$.fa.$g.get(66)&&(mc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),
this.mSf=!1,this.fSg());return Promise.resolve(!0)};Pc.prototype.Aej=function(T,Oa){return!Oa||1!==Oa.length||T.commandParameters.clearSystemClipboard||T.commandParameters.clearStateOnFinish||T.commandParameters.skipClipboardAccess?!1:fc(T)&&(Oa=T.clipboardItems.getItem(Ib.bV),T=T.clipboardItems.getItem(Ib.html),void 0===Oa||null===Oa||Oa.length>this.hpd||void 0===T||null===T||T.length>this.JLa)?(mc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),
!1):!0};Pc.prototype.XEi=function(T,Oa){return 1===T||Oa.payloadType===Vc.bV||Se.EwaSettings.ka(162)&&Oa.payloadType===Vc.html||Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!hf.a.$z&&Oa.payloadType===Vc.jN};Pc.prototype.Pqe=function(T,Oa){var Eb=this,vc;(function(){var gd=Eb.$_h(Oa);vc=gd.REa;return gd})().returnValue&&this.mv(T,vc,void 0,void 0,Oa.commandParameters.copyPasteTargetType).catch(function(){})};Pc.prototype.cei=function(T,Oa){mc.ULS.sendTraceTag(537167768,
0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",T,Oa);this.gridView.focus()};Pc.prototype.itd=function(T,Oa,Eb,vc,gd,Cd){mc.ULS.sendTraceTag(24150918,0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",T?this.getStringifiedError(T):"null");var Fd=!1,$d=!1,Ae=!1,$e=Pc.Oob,qg=Pc.hBe+Pc.UGa;T&&(qg+=Pc.jIa(T),qc.a.vq(T.ewaErrors)?($e=this.B7b(T.ewaErrors),qc.a.Yg(T.ewaErrors,Pc.operationSucceededWithAlert)&&
(Fd=!0),qc.a.Yg(T.ewaErrors,Pc.dragDropNonEmptyRange)&&($d=Ae=!0)):T.message&&($e=T.message));Ae||(Ae=this.thd(T));$d?this.gridView.ga.selectionType=-1:this.fr.lPi(gd);this.sci(Oa,Eb,vc,gd,Ae,$e,qg,Fd,Cd);return Promise.reject(T)};Pc.prototype.MTc=function(T,Oa){var Eb=T,vc=this.nCh();vc&&vc.ranges&&(Eb=this.fr.TGg(Oa,vc.ranges,T));return Eb};Pc.prototype.nCh=function(){var T=Ee(this.FJ);return T&&kd(T.sourceItem)?T.sourceItem:null};Pc.prototype.lMi=function(){this.raiseEvent(Pc.Rud,null)};Pc.prototype.A3i=
function(T,Oa){var Eb=T.commandParameters.originalDestinations;Oa&&(Xe.Q(this.gridView.ga.wa.selectedRanges,Eb)?(this.rpc(Oa),mc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",Sd.HelperMethods.llb(Oa))):T.commandParameters.isPasteCommandFromRecoveryUI?(this.rpc(Oa,!0),mc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",
Oa,Oa[0].topLeft)):mc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",Sd.HelperMethods.llb(Eb)))};Pc.prototype.$_h=function(T){if(T.isPlainTextPaste||T.isHtmlPaste||Da(T)||T.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,REa:!1};var Oa=T.copyContextSnapshot;if(T.commandParameters.clearStateOnFinish)return{returnValue:!0,REa:!0};if(Oa&&
kd(Oa.sourceItem)){var Eb=Oa.sourceItem;if(!Eb.isFromCurrentSession(this.$))return{returnValue:!1,REa:!0};Oa=-1985798686===Oa.commandParameters.ribbonCommandInfo.command;if(!(1<Eb.ranges.length||1<T.commandParameters.expandDestinations.length)){var vc=Xe.K(Eb.ranges);T=Xe.K(T.commandParameters.expandDestinations);var gd=this.$.fa.qa.sheetName;Eb=Eb.sheetName;if(Eb===gd&&T.equals(vc))return{returnValue:!1,REa:!0};if(Eb===gd&&T.Ef(vc))return{returnValue:!0,REa:!1}}return{returnValue:Oa,REa:!0}}return{returnValue:!1,
REa:!0}};Pc.prototype.jd=function(T,Oa){Oa.wJ||Oa.Rg||this.mv("OnWorkbookOpened",!1).catch(function(){})};Pc.prototype.Ai=function(T,Oa){T=Ee(this.FJ);var Eb=this.fr.Isb(T);Eb&&(Oa.qa&&Oa.qa.sheetName===Eb.sheetName&&Eb.isFromCurrentSession(this.$)?this.fr.q_e(Eb.ranges,T.commandParameters.commandType):this.fr.Utb())};Pc.prototype.tic=function(T,Oa){T=Ee(this.FJ);(T=this.fr.Isb(T))&&Oa.item&&Oa.item.sheetName===T.sheetName&&T.isFromCurrentSession(this.$)&&this.mv("OnItemDeleting",!1).catch(function(){})};
Pc.prototype.gBb=function(T,Oa){this.G3e?this.FYf(T,Oa):this.Zsf()};Pc.prototype.Zsf=function(){var T=Ee(this.FJ);(T=this.fr.Isb(T))&&T.isFromCurrentSession(this.$)&&this.mv("OnStartEdit",!1).catch(function(){})};Pc.prototype.rQ=function(T,Oa){1===Oa.vC&&Oa.Jh.operation.flags&2&&this.mv("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};Pc.prototype.B7b=function(T){T=qc.a.gzh(T,Pc.UGa);return this.Yhi+Jg.a.jv(T).toString()};Pc.prototype.thd=function(T){T=Pc.jIa(T);return!If.a.ma(T)&&If.a.SZa(T,
Pc.Xhi)};Pc.prototype.fSg=function(){var T=qc.a.gd(1,2,313,314,hf.a.Co?315:hf.a.IG?316:317,530046625,"ActivateLocalStorage"),Oa=Zd.GetServiceTaskFactory.Va(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");$g.TaskExtensions.Aa(Oa,function(){Oa.result.eg(41,T)},this.la,3)};Pc.prototype.eue=function(T){return void 0===T||null===T?He.qli:T?He.success:He.failed};Pc.GQg=function(T){var Oa=T.innerError;return Oa&&Oa.pasteErrorName?T.innerError:null};Pc.rQg=function(T){var Oa=
T.innerError;return Oa&&Oa.copyErrorName?T.innerError:null};Pc.jIa=function(T){var Oa="";if(!T)return Pc.fye;If.a.ma(T.errorName)||(Oa=T.errorName,T.innerError&&(Oa+=Pc.UGa+Pc.jIa(T.innerError)));If.a.ma(Oa)&&(Oa=T&&!If.a.ma(T.name)?T.name:Pc.fye);return Oa};Pc.M6b=function(){Pc.XHb||(fg.a.F6e()?Pc.XHb=Nd.Xij:fg.a.Hid()?Pc.XHb=Nd.Wij:Pc.XHb=Nd.Vij);return Pc.XHb};Pc.Xte=function(T){switch(T){case 7:case 1:return 2100;case 5:return 2097;case 6:return 2096;case 8:case 3:case 2:case 4:case 9:case 10:return 2093;
default:return mc.ULS.shipAssertTag(537167764,0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",T),2100}};Pc.sQg=function(T){switch(T){case 3:return 2094;case 1:return 2095;case 2:case 4:return 2093;default:return mc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",T),2100}};Ll.Object.defineProperties(Pc.prototype,{pasteIndicationManager:{configurable:!0,
enumerable:!0,get:function(){return this.$.ea.Ba(373)}}});Pc.Yff="EwaJsMetadataChangeListenerId";Pc.Rud="cpiOSC";Pc.x0g="cpiDID";Pc.Oob="Unknown";Pc.fye="UnknownError";Pc.UGa="_";Pc.hBe="DragAndDropError";Pc.pasteErrorName="PasteError";Pc.WHg="CancelError";Pc.copyErrorName="CopyError";Pc.Xhi="MergedCellOverlap";Pc.SEi="PasteRecoveryCachedClipboardItems";Pc.R1i=[1352631530,1679665408];Pc.operationSucceededWithAlert=[-103190598];Pc.pasteDataLimitHit=[1306609195];Pc.copyThrottlingError=[-386183710];
Pc.dragDropNonEmptyRange=[563945982];Pc.XHb=null;Object(od.a)(Pc,"CopyPasteInfrastructure",Ue.a,[328,329,6]);Object(od.a)(hc,"ClipboardPlatformInitializationResult",null,[]);var Bc=b(787),Fb=b(4),bc=b(81);Object(od.a)(vb,"MacroRecorderPasteRangePayload",null,[115]);sa.prototype.getContent=function(){return this.content};Object(od.a)(sa,"MacroRecorderPasteStringPayload",null,[115]);var ge=b(60);Object(od.a)(Od,"MacroRecorderPastePayload",null,[115]);var Jd=b(598),ue=b(893),qd=b(514),Ud=b(161),ed=b(195),
xd=b(126),Lg=b(275),hg=b(333);yd.prototype.getParameters=function(){return this.parameters};Object(od.a)(yd,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[115]);var Dg=b(364);Nc.prototype.copy=function(T,Oa,Eb,vc,gd){function Cd(Ae,$e,qg){var Tg={CopyPasteTargetType:1};Tg.SourceRanges=T;Tg.CopyOperationId=Oa.id;mc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",Fd.nKa,Tg.CopyOperationId);return Fd.nKa?rc(Fd.$.ra.Fw,Tg,Lg.b(Ae,
Eb),vc?Lg.a($e,vc):$e,qg,Oa.ribbonCommandInfo,$d,gd):rc(Fd.$.ra.ua,Tg,Lg.b(Ae,Eb),vc?Lg.a($e,vc):$e,qg,Oa.ribbonCommandInfo,$d,gd)}var Fd=this;vc=void 0===vc?null:vc;gd=void 0===gd?null:gd;var $d=this.$.ra.ua.Wb();Se.EwaSettings.pc()?this.$.userOperationManager.jc(new Ud.a(505,0,Cd,80),Oa.ribbonCommandInfo):this.$.userOperationManager.jc(new qd.a(505,0,Cd,16),Oa.ribbonCommandInfo)};Nc.prototype.Rvf=function(T,Oa,Eb,vc,gd,Cd){var Fd=this;return new Promise(function($d,Ae){var $e=Cd.commandParameters.stopwatch.Cc,
qg=2;20===Cd.commandParameters.commandType&&(qg=16);36===Cd.commandParameters.commandType&&(qg=32);fg.a.Hid()&&68===Cd.commandParameters.commandType&&(qg=64);fg.a.Ykd(Fd.$)&&1028===Cd.commandParameters.commandType&&(qg=1024);var Tg=null;Cd.copyContextSnapshot&&Cd.copyContextSnapshot.commandParameters&&(Tg=Cd.copyContextSnapshot.commandParameters.id);Nc.yGd(Fd.$,T,vc,Oa,Eb,null,function(jg){Nc.w9b(jg,Cd,$d,Ae,$e,Fd.$)},function(jg){Cd.serverRequestTimeInMs=Cd.commandParameters.stopwatch.Cc-$e;jg=xd.a.xg(jg.data);
Ae(new ue.a(5,jg))},gd,qg,Tg,Cd.commandParameters.id)})};Nc.prototype.pasteRange=function(T,Oa,Eb,vc,gd,Cd,Fd,$d){var Ae=this;return new Promise(function($e,qg){var Tg=Fd.commandParameters.stopwatch.Cc;Nc.O4i(Ae.$,T,Oa,Eb,vc|-5&gd,function(jg){Nc.w9b(jg,Fd,$e,qg,Tg,Ae.$)},function(jg){Fd.serverRequestTimeInMs=Fd.commandParameters.stopwatch.Cc-Tg;jg=xd.a.xg(jg.data);qg(new ue.a(5,jg))},Cd,$d)})};Nc.prototype.JJi=function(T,Oa,Eb,vc,gd,Cd,Fd){var $d=this;return new Promise(function(Ae,$e){if(If.a.ma(Oa))Ae("");
else if(Oa.length>$d.JLa){var qg=Fd.clipboardItems.getItem(Ib.bV),Tg=-1;void 0!==qg&&null!==qg&&(Tg=qg.length);mc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Oa.length,$d.JLa,Tg);$e(new ue.a(1))}else qg=function(jg,vf,Xg){$d.$.Es();var bh=Fd.commandParameters.stopwatch.Cc;jg=Lg.b(jg,function(Jh){Nc.w9b(Jh,Fd,Ae,$e,bh,$d.$,Oa)});vf=Lg.a(vf,function(Jh){Fd.serverRequestTimeInMs=
Fd.commandParameters.stopwatch.Cc-bh;Jh=xd.a.xg(Jh.data);$e(new ue.a(3,Jh))});var Fh=$d.$.ra.ua.Wb(),gh=Xe.v(T,$d.$),ud={};ud.SourceHtml=Oa;ud.DestinationRanges=gh?Xe.s(gh):null;ud.CopyOperationId=Eb;ud.PasteId=vc;mc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",$d.nKa,ud.PasteId);return $d.nKa?Bb($d.$.ra.Fw,ud,jg,vf,Xg,null,Fh,Cd):Bb($d.$.ra.ua,ud,jg,vf,Xg,null,Fh,Cd)},qg=Se.EwaSettings.pc()?new Ud.a(204,0,qg,65):new qd.a(204,
0,qg,1),$d.$.userOperationManager.jc(qg,gd)})};Nc.prototype.KJi=function(T,Oa,Eb,vc,gd){var Cd=this;return new Promise(function(Fd,$d){mc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",gd.id);If.a.ma(Oa)||(Oa=If.a.trimEnd(Oa,"\n","\r"));mc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",gd.id);if(If.a.ma(Oa))Fd("");else{var Ae=
Cd.hpd;if(Oa.length>Ae)mc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Oa.length,Ae),$d(new ue.a(1));else{var $e=Xe.v(T,Cd.$);mc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",gd.id);Ae=!Cd.$.fa.isNamedObjectViewMode&&-1===Oa.indexOf("\n")&&-1===Oa.indexOf("\t");mc.ULS.sendTraceTag(537167751,0,50,
"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",gd.id,Ae);Ae=Ae&&If.a.g6e(Oa);mc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",gd.id,Ae);var qg=Cd.$.ra.ua.Wb();if(Ae){var Tg=526;mc.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",gd.id);
var jg=ed.a.m6c(Oa);mc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",gd.id);var vf=Xe.s($e);Ae=function(bh,Fh,gh){var ud=gd.commandParameters.stopwatch.Cc;bh=Lg.b(bh,function(Jh){mc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",gd.id);gd.requestTelemetryData=Jh.RequestTelemetryData;gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.Cc-
ud;Jh.Errors&&0<Jh.Errors.length?$d(new ue.a(2,Jh.Errors)):Fd(Oa)});Fh=Lg.a(Fh,function(Jh){gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.Cc-ud;Jh=xd.a.xg(Jh.data);$d(new ue.a(2,Jh))});Cd.$.Es();mc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",gd.id);return bc.c(Cd.$.ra.ua,vf,Oa,jg,!1,!1,63,bh,Fh,gh,T,qg,vc)};var Xg=function(){return new Jd.a(vf,Oa,jg)}}else Tg=180,Ae=function(bh,Fh,gh){Cd.$.Es();var ud=
gd.commandParameters.stopwatch.Cc;bh=Lg.b(bh,function(Jh){mc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",gd.id);Nc.w9b(Jh,gd,Fd,$d,ud,Cd.$,Oa)});Fh=Lg.a(Fh,function(Jh){gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.Cc-ud;Jh=xd.a.xg(Jh.data);$d(new ue.a(4,Jh))});mc.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",
gd.id);return Oc(Cd.$.ra.ua,$e,Oa,bh,Fh,gh,null,qg,vc)},Xg=function(){return new sa($e,Oa)};mc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",gd.id);Ae=Se.EwaSettings.pc()?new Ud.a(Tg,0,Ae,65,Xg):new qd.a(Tg,0,Ae,1,Xg);mc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",gd.id);Cd.$.userOperationManager.jc(Ae,Eb)}}})};Nc.prototype.q_e=
function(T,Oa){Oa=[1===Oa?4:5];this.gridView.Kb.Hs(hg.a.fW(ge.d(this.$.qa),T),Oa,!0);this.gridView.Kb.Jr(Oa);this.gridView.Kb.update(!0)};Nc.prototype.Utb=function(){var T=[4,5];this.gridView.Kb.mk(T);this.gridView.Kb.Ek(null,T);1===this.gridView.ga.Qe&&this.gridView.Jr()};Nc.prototype.TGg=function(T,Oa,Eb){var vc=[];Eb=Ol(Eb);for(var gd=Eb.next();!gd.done;gd=Eb.next())Array.add(vc,this.WGg(T,Oa,gd.value));return vc};Nc.prototype.WGg=function(T,Oa,Eb){mc.ULS.shipAssertTag(537167713,0,!!Oa,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");
mc.ULS.shipAssertTag(537167712,0,0<Oa.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var vc=0,gd=0,Cd=new Set,Fd=new Set;Oa=Ol(Oa);for(var $d=Oa.next();!$d.done;$d=Oa.next()){$d=$d.value;var Ae=String.format("{0}_{1}",$d.left,$d.right),$e=String.format("{0}_{1}",$d.top,$d.bottom);Fd.has(Ae)||(Fd.add(Ae),gd+=$d.width);Cd.has($e)||(Cd.add($e),vc+=$d.height)}if(36===T)return Eb.isSingle?Nc.dJe(gd,vc,Eb):Eb.clone();516===T&&(T=vc,vc=gd,gd=T);T=!(Eb.width%gd)&&
!(Eb.height%vc);Cd=Eb.c4&&!(Eb.height%vc);Eb.faa&&!(Eb.width%gd)||Cd?Eb=Nc.dJe(gd,vc,Eb):T?Eb=Eb.clone():(Eb=Eb.clone(),Eb.bottom=Math.min(mf.a.lh,Eb.top+vc-1),Eb.right=Math.min(mf.a.zh,Eb.left+gd-1));return Eb};Nc.prototype.yyg=function(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae,$e,qg){if(!vc||!vc.length)return 1;if(1<vc.length){if(!this.pbc&&Cd)return 3;if($e)return 0;if($d)return 9;if(Ae)return 8;if(qg)return 2;if(1<Oa.length)return 4;var Tg=Oa[0];if(!Fd&&!Kd.a.all(vc,function(jg){return jg.isSingle||!(jg.width%
Tg.width)&&!(jg.height%Tg.height)}))return 5;if((!this.pbc||!Cd)&&If.a.equals(T,Eb,!0))for(gd=Ol(gd),T=gd.next();!T.done;T=gd.next())if(T=T.value,T.$d(Tg)&&!T.equals(Tg))return 6}else if(Oa&&0<Oa.length){if(this.T3e(Oa,Ae))return 7;if(1<Oa.length){if(!this.pbc&&Cd)return 3;if((!this.pbc||!Cd)&&If.a.equals(T,Eb,!0))for(T=Ol(Oa),Oa=T.next();!Oa.done;Oa=T.next())if(Oa=Oa.value,Eb=gd[0],Oa.$d(Eb)&&!Oa.equals(Eb))return 6}}return 0};Nc.prototype.T3e=function(T,Oa){if(!T||1>=T.length)return 0;if(Oa)return 2;
if(!Xe.S(T))return 1;Oa=new Bc.a(we.a.rl());for(var Eb=Ol(T),vc=Eb.next();!vc.done;vc=Eb.next()){vc=vc.value;for(var gd=Ol(T),Cd=gd.next();!Cd.done;Cd=gd.next()){Cd=Cd.value;var Fd=vc.top===Cd.top&&vc.bottom===Cd.bottom,$d=vc.left===Cd.left&&vc.right===Cd.right,Ae=Math.max(vc.left,Cd.left)<Math.min(vc.right,Cd.right);if(Math.max(vc.top,Cd.top)<Math.min(vc.bottom,Cd.bottom)&&!Fd||Ae&&!$d)return 3;Oa.add(String.format("{0}-{1}-{2}-{3}",vc.top,vc.bottom,Cd.left,Cd.right));Oa.add(String.format("{0}-{1}-{2}-{3}",
Cd.top,Cd.bottom,vc.left,vc.right))}}T=Ol(T);for(Eb=T.next();!Eb.done;Eb=T.next())Eb=Eb.value,Oa.remove(String.format("{0}-{1}-{2}-{3}",Eb.top,Eb.bottom,Eb.left,Eb.right));return 0<Oa.count?3:0};Nc.prototype.lPi=function(T){var Oa=this.gridView.ga;Oa.updateSelection(T,T.topLeft,0);Oa.selectionType=-1};Nc.prototype.Isb=function(T){if(T&&T.sourceItem){if(!kd(T.sourceItem))return null;if((T=T.sourceItem)&&Xe.bb(T.ranges,!0))return T}return null};Nc.prototype.Nbc=function(T,Oa){mc.ULS.shipAssertTag(537167711,
0,!!T,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Oa&&Fb.a.EH in Oa||T.tabName?!1:1===T.method};Nc.O4i=function(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){function $e(){return new vb(Eb,vc,gd)}function qg(jg,vf,Xg){T.Es();var bh=T.ra.ua;jg=Lg.b(jg,Cd);vf=Lg.a(vf,Fd);var Fh=$d;Fh=void 0===Fh?null:Fh;var gh=bh.Na(9,Tg);gh.sourceRanges=Eb;gh.destinationRanges=vc;gh.flags=gd;return bc.i(bh,"PasteRange",gh,jg,vf,Xg,null,64,Fh)}var Tg=T.ra.ua.Wb(Ae);Ae=Se.EwaSettings.pc()?new Ud.a(506,
0,qg,65,$e):new qd.a(506,0,qg,1,$e);T.userOperationManager.jc(Ae,Oa)};Nc.w9b=function(T,Oa,Eb,vc,gd,Cd,Fd){Fd=void 0===Fd?null:Fd;mc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Oa.id);Oa.requestTelemetryData=T.RequestTelemetryData;Oa.serverRequestTimeInMs=Oa.commandParameters.stopwatch.Cc-gd;qc.a.Zg(T.Errors)?qc.a.A8(T.Errors)?(Oa&&(Oa.encounteredDeploymentErrors=!0),mc.ULS.sendTraceTag(537167707,0,15,
"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",qc.a.Uc(T.Errors))):vc(new ue.a(5,T.Errors)):T.Result?(vc=!!T&&!!T.RequestTelemetryData,Bf.g(Cd).vi.Kja(Oa.commandParameters.stopwatch.id,T.StateId,vc?T.RequestTelemetryData.EcsOperationDuration:0,vc?T.RequestTelemetryData.EcsRequestDuration:0,vc?T.RequestTelemetryData.WfeRequestDuration:0),Oa.pastedRange=T.Result.SheetMultiRange,mc.ULS.sendTraceTag(537167708,
0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Oa.id),Eb(!0)):(mc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",Oa.id),Eb(Fd?Fd:!0))};Nc.yGd=function(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae,$e,qg,Tg){function jg(){return new Od(bh)}function vf(Fh,gh,ud){T.Es();return Lb(T.ra.ua,bh,Lg.b(Fh,Fd),Lg.a(gh,$d),ud,Cd,
Xg,Ae)}var Xg=T.ra.ua.Wb(),bh=Nc.mWg(Eb,vc,gd,$e,qg,Tg);Eb=Se.EwaSettings.pc()?new Ud.a(503,0,vf,65,jg):new qd.a(503,0,vf,1,jg);T.userOperationManager.jc(Eb,Oa)};Nc.mWg=function(T,Oa,Eb,vc,gd,Cd){var Fd={};Fd.ShadowWorkbookBase64=T.shadowWorkbookBase64;Fd.SourceRanges={};Fd.SourceRanges.Ranges=Array(1);Fd.SourceRanges.Ranges[0]={};Fd.SourceRanges.Ranges[0].FirstRow=T.rangeRowStart;Fd.SourceRanges.Ranges[0].LastRow=T.rangeRowEnd;Fd.SourceRanges.Ranges[0].FirstColumn=T.rangeColumnStart;Fd.SourceRanges.Ranges[0].LastColumn=
T.rangeColumnEnd;Se.EwaSettings.getBooleanFeatureGate(md.a.G0b,!1)?Eb?Fd.DestinationRanges=Xe.u(Eb.SheetName,Eb.NamedObjectName,Xe.g(Eb.Ranges)):(mc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),Fd.DestinationRanges=null):Fd.DestinationRanges=Oa?Xe.s(Oa):null;Fd.CopyPasteTargetType=1;Fd.PasteType=vc;Fd.CopyOperationId=gd;Fd.PasteId=Cd;Fd.SourceClientPath=T.sourceClientPath;Fd.SourceSheetName=T.sourceSheetName;Fd.SourceWorkbookName=
T.sourceWorkbookName;if(!T.originalSourceRangesCountExceedsLimit&&T.originalSourceRanges&&0<T.originalSourceRanges.length&&1024===vc){Fd.OriginalSourceMultiRange={};Oa=Array(T.originalSourceRanges.length);for(Eb=0;Eb<Oa.length;++Eb)Oa[Eb]={},Oa[Eb].FirstRow=T.originalSourceRanges[Eb][0],Oa[Eb].FirstColumn=T.originalSourceRanges[Eb][1],Oa[Eb].LastRow=T.originalSourceRanges[Eb][2],Oa[Eb].LastColumn=T.originalSourceRanges[Eb][3];Fd.OriginalSourceMultiRange.Ranges=Oa}return Fd};Nc.dJe=function(T,Oa,Eb){Eb=
Eb.clone();Eb.height<Oa&&(Eb.bottom=Math.min(mf.a.lh,Eb.top+Oa-1));Eb.width<T&&(Eb.right=Math.min(mf.a.zh,Eb.left+T-1));return Eb};Nc.prototype.executeInsertCopiedCutCellsOperation=function(T,Oa,Eb,vc,gd,Cd,Fd){function $d(){return new yd(Ae)}Cd=void 0===Cd?null:Cd;Fd=void 0===Fd?null:Fd;var Ae={};Ae.InsertDirection=vc;Ae.SourceRange=T;Ae.DestRange=Oa;Ae.CopyCutOperation=Eb?0:1;var $e=this.$.ra.ua;return Dg.a(this.$.userOperationManager,function(qg,Tg,jg){qg=Cd?Lg.b(qg,Cd):qg;Tg=Fd?Lg.a(Tg,Fd):Tg;
var vf=$e.Na(41,null);vf.insertCopiedCutCellsParameters=Ae;return bc.i($e,"InsertCopiedCutCells",vf,qg,Tg,jg,null,4)},function(qg){return new Ud.a(104,0,qg,void 0,$d)},gd)};Nc.prototype.y5g=function(T,Oa,Eb,vc,gd,Cd){var Fd=this;return new Promise(function($d,Ae){Fd.executeInsertCopiedCutCellsOperation(Oa,Eb,vc,gd,Cd,function($e){T.requestTelemetryData=$e.RequestTelemetryData;$e.Errors&&0<$e.Errors.length?Ae(new ue.a(21,$e.Errors)):$d(!0)},function($e){$e=xd.a.xg($e.data);Ae(new ue.a(21,$e))}).continueWith(function(){if(vc)Fd.Utb();
else{var $e=Fd.$.ea.Ba(254);$e&&$e.oZb("DragDropInsert/success/"+Hd.a[Cd.method],!0)}})})};Ll.Object.defineProperties(Nc.prototype,{hpd:{configurable:!0,enumerable:!0,get:function(){mc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},JLa:{configurable:!0,enumerable:!0,get:function(){return this.nKa?Se.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
this.$.ya.CopyPasteMaxPayloadLength):mf.a.JLa}}});Object(od.a)(Nc,"CopyPasteUtils",null,[327]);var cf=b(490),Hg;(function(T){T[T.range=0]="range";T[T.art=1]="art"})(Hg||(Hg={}));Object(od.b)("SourceItemType",Hg);var uh=b(25),te=b(92);Lc.prototype.serializeSourceItem=function(T){var Oa={};if(T&&Object.getType(T)===ce)Oa.sheetName=T.sheetName,Oa.topArray=Kd.a.map(T.ranges,function(Eb){return Eb.top}),Oa.leftArray=Kd.a.map(T.ranges,function(Eb){return Eb.left}),Oa.bottomArray=Kd.a.map(T.ranges,function(Eb){return Eb.bottom}),
Oa.rightArray=Kd.a.map(T.ranges,function(Eb){return Eb.right}),Oa.sessionStateId=T.sessionStateId,Oa.sessionId=T.sessionId,Oa.sourceItemType=this.zMf(0);else if(T&&Object.getType(T)===dc)Oa.activeFloatingObjectControlId=T.activeFloatingObjectControlId,Oa.sheetName=T.sheetName,Oa.sessionStateId=T.sessionStateId,Oa.sessionId=T.sessionId,Oa.floatingObjectType=this.p5i(T.type),Oa.sourceItemType=this.zMf(1);else return mc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),
null;return JSON.stringify(Oa)};Lc.prototype.serializeCommandParameters=function(T){if(!T)return mc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Oa={};Oa.id=T.id;Oa.commandType=T.commandType;Oa.copyPasteTargetType=T.copyPasteTargetType;T.ribbonCommandInfo&&(Oa.ribbonCommandName=this.x5i(T.ribbonCommandInfo.command),Oa.inputMethodName=this.r5i(T.ribbonCommandInfo.method),Oa.frameModeName=this.q5i(T.ribbonCommandInfo.mode),
Oa.uiLocationName=this.B5i(T.ribbonCommandInfo.Ze),Oa.tabName=T.ribbonCommandInfo.tabName);return JSON.stringify(Oa)};Lc.prototype.deserializeSourceItem=function(T){if(If.a.ma(T))return null;try{var Oa=JSON.parse(T);if(!Oa)return mc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var Eb=null;switch(this.x1g(Oa.sourceItemType)){case 0:Eb=new ce(this.$,this.u1g(Oa),Oa.sheetName,Oa.sessionStateId,Oa.sessionId);break;case 1:Eb=new dc(Oa.activeFloatingObjectControlId,
Oa.sheetName,Oa.sessionStateId,Oa.sessionId,this.r1g(Oa.floatingObjectType))}return Eb}catch(vc){return mc.ULS.sendTraceTag(537167702,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",T?T.length:0,vc),null}};Lc.prototype.deserializeCommandParameters=function(T){if(If.a.ma(T))return null;try{var Oa=JSON.parse(T);if(!Oa)return mc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),
null;var Eb=Ce.a();Eb.id=Oa.id;Eb.ribbonCommandInfo=this.w1g(Oa);Eb.commandType=Oa.commandType;Eb.copyPasteTargetType=Oa.copyPasteTargetType;return Eb}catch(vc){return mc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",T?T.length:0,vc),null}};Lc.prototype.u1g=function(T){var Oa=[];mc.ULS.shipAssertTag(537167699,0,!!T.topArray&&0<T.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",
T.topArray?"empty":"null");mc.ULS.shipAssertTag(537167698,0,!!T.leftArray&&0<T.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",T.leftArray?"empty":"null");mc.ULS.shipAssertTag(537167697,0,!!T.bottomArray&&0<T.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",T.bottomArray?"empty":"null");mc.ULS.shipAssertTag(537167696,0,!!T.rightArray&&0<T.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",
T.rightArray?"empty":"null");if(!(T.topArray&&T.leftArray&&T.bottomArray&&T.rightArray))return Oa;mc.ULS.shipAssertTag(537167695,0,T.topArray.length===T.bottomArray.length&&T.topArray.length===T.leftArray.length&&T.topArray.length===T.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",T.topArray.length,T.bottomArray.length,T.leftArray.length,T.rightArray.length);for(var Eb=Math.min(T.topArray.length,
T.bottomArray.length,T.leftArray.length,T.rightArray.length),vc=0;vc<Eb;vc++)Array.add(Oa,new uh.Range(T.topArray[vc],T.leftArray[vc],T.bottomArray[vc],T.rightArray[vc],!1,!1));return Oa};Lc.prototype.w1g=function(T){return new te.a(this.v1g(T.ribbonCommandName),this.t1g(T.inputMethodName),this.s1g(T.frameModeName),this.y1g(T.uiLocationName),T.tabName)};Lc.prototype.x5i=function(T){return void 0!==T&&null!==T&&T.toString()in this.GEd?this.GEd[T.toString()]:(mc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,T),this.GEd["-911352779"])};Lc.prototype.v1g=function(T){return!If.a.ma(T)&&T in this.vWf?this.vWf[T]:(mc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,T),-911352779)};Lc.prototype.r5i=function(T){return void 0!==T&&null!==T&&Hd.a[T]in this.Mia?this.Mia[Hd.a[T]]:(mc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",
T),this.Mia.unknown)};Lc.prototype.t1g=function(T){return!If.a.ma(T)&&T in this.uWf?this.uWf[T]:(mc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",T),0)};Lc.prototype.q5i=function(T){return void 0!==T&&null!==T&&cf.a[T]in this.Z_a?this.Z_a[cf.a[T]]:(mc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",T),this.Z_a.edit)};Lc.prototype.s1g=function(T){return!If.a.ma(T)&&T in
this.tWf?this.tWf[T]:(mc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",T),2)};Lc.prototype.zMf=function(T){return void 0!==T&&null!==T&&Hg[T]in this.gIb?this.gIb[Hg[T]]:(mc.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",T),this.gIb.range)};Lc.prototype.x1g=function(T){return!If.a.ma(T)&&T in this.wWf?this.wWf[T]:(mc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",
T),0)};Lc.prototype.p5i=function(T){return void 0!==T&&null!==T&&T.toString()in this.xRc?this.xRc[T.toString()]:(mc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",T),this.xRc["99"])};Lc.prototype.r1g=function(T){return!If.a.ma(T)&&T in this.sWf?this.sWf[T]:(mc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",T),99)};Lc.prototype.B5i=function(T){return void 0!==
T&&null!==T&&he.a[T]in this.Sq?this.Sq[he.a[T]]:(mc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",T),this.Sq.ribbon)};Lc.prototype.y1g=function(T){return!If.a.ma(T)&&T in this.xWf?this.xWf[T]:(mc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",T),2)};Object(od.a)(Lc,"EnvironmentSerializationHelper",null,[]);gc.VJf="SameSession";gc.axe="CrossSession";gc.Iaf="LegacyCrossSession";
gc.external="External";Object(od.a)(gc,"PayloadOrigin",null,[]);Qa.prototype.shouldWaitForCopyToComplete=function(){return!1};Qa.prototype.onDeferredPasteStarted=function(){};Qa.prototype.onDeferredPasteCompleted=function(){};Qa.prototype.beforePaste=function(){};Qa.prototype.ttj=function(T){var Oa=null;try{var Eb=T.getItem(Ib.jN);if(If.a.ma(Eb))return{returnValue:!1,o_:Oa};Oa=JSON.parse(Eb);return{returnValue:this.W7h(Oa),o_:Oa}}catch(vc){return mc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+
vc),{returnValue:!1,o_:Oa}}};Qa.prototype.W7h=function(T){return!!T&&(!If.a.ma(T.shadowWorkbookBase64)||T.shadowWorkbookSizeExceedsLimit)&&void 0!==T.rangeRowStart&&void 0!==T.rangeRowEnd&&void 0!==T.rangeColumnStart&&void 0!==T.rangeColumnEnd};Qa.prototype.lkc=function(T){T.wasLastCopyExternal=!0;if(Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!hf.a.$z&&516!==T.commandParameters.commandType&&1028!==T.commandParameters.commandType){var Oa=this.ttj(T.clipboardItems);
var Eb=Oa.o_;if(Oa.returnValue)return T.isShadowWorkbookParsedSuccessfully=!0,this.PEi(T,Eb)}return 516!==T.commandParameters.commandType&&36!==T.commandParameters.commandType?Se.EwaSettings.ka(162)&&20!==T.commandParameters.commandType&&(Eb=T.clipboardItems.getItem(Ib.html),void 0!==Eb&&null!==Eb&&!If.a.ma(Eb)&&Eb.trim()!==this.ARc&&(Eb.startsWith("<")||hf.a.uf&&Eb.startsWith("\n<")))?(Oa=T.clipboardItems.getItem(Ib.oYc),this.NEi(T,Eb,void 0===Oa?null:Oa)):this.Nvf(T):Promise.reject(new ue.a(6))};
Qa.prototype.PEi=function(T,Oa){mc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");T.pasteResult="SystemClipboardShadowWorkbookPaste";T.payloadType=Vc.jN;T.payloadOrigin=gc.external;T.shadowWorkbookPayloadSize=Ab(Oa);T.shadowWorkbookSizeExceedsLimit=cb(Oa);var Eb=null,vc=null,gd=T.commandParameters.originalDestinations;Se.EwaSettings.getBooleanFeatureGate(md.a.G0b,!1)?Eb=Xe.r(gd,this.$):vc=Xe.v(Xe.K(gd),this.$);
Oa.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(T.originalSourceRangesCountExceedsLimit=Oa.originalSourceRangesCountExceedsLimit);if(T.shadowWorkbookSizeExceedsLimit)return mc.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,mf.a.Tfc,Oa.shadowWorkbookSizeExceedsLimit),Promise.reject(new ue.a(1));mc.ULS.sendTraceTag(537167832,
0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",T.commandParameters.id);return this.fr.Rvf(T.commandParameters.ribbonCommandInfo,vc,Eb,Oa,[T.commandParameters.stopwatch],T)};Qa.prototype.Nvf=function(T){var Oa=T.clipboardItems.getItem(Ib.bV);if(void 0!==Oa&&null!==Oa&&Oa.trim()===this.ARc)return Promise.reject(new ue.a(7));void 0!==Oa&&null!==Oa&&(T.plainTextPayloadSize=Oa.length);T.isPlainTextPaste=!0;T.pasteResult="SystemClipboardPaste";
T.payloadOrigin=lf(T)?gc.Iaf:gc.external;T.payloadType=Vc.bV;mc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",T.id,T.commandParameters.id);Oa=this.fr.KJi(Xe.K(T.commandParameters.originalDestinations),Oa,T.commandParameters.ribbonCommandInfo,[T.commandParameters.stopwatch],T);mc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",
T.id);return Oa};Qa.prototype.NEi=function(T,Oa,Eb){T.htmlPayloadSize=Oa.length;T.isHtmlPaste=!0;T.pasteResult="SystemClipboardHtmlPaste";T.payloadType=Vc.html;T.payloadOrigin=lf(T)?gc.Iaf:gc.external;mc.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",T.commandParameters.id);return this.fr.JJi(Xe.K(T.commandParameters.originalDestinations),Oa,Eb,T.commandParameters.id,T.commandParameters.ribbonCommandInfo,[T.commandParameters.stopwatch],
T)};Qa.prototype.Bwe=function(T){var Oa={};T&&(Oa.shadowWorkbookBase64=T.ShadowWorkbookBase64,Oa.shadowWorkbookSizeExceedsLimit=T.ShadowWorkbookSizeExceedsLimit,Oa.originalSourceRangesCountExceedsLimit=T.OriginalSourceRangesCountExceedsLimit,Oa.originalSourceRangesCount=T.OriginalSourceRangesCount,Oa.shadowWorkbookBlockedSize=T.ShadowWorkbookBlockedSize);return Oa};Qa.prototype.G4f=function(T,Oa){var Eb=fc(T),vc=32===(T.commandParameters.commandType&32),gd=1024===(T.commandParameters.commandType&
1024),Cd=!1,Fd=null,$d=null,Ae=!1;if(!Eb){Cd=-1985798686===T.commandParameters.ribbonCommandInfo.command;var $e=T.copyContextSnapshot;if(Oa)Ae=!$e.sourceItem.isFromCurrentSession(this.$);else if($e=this.fr.Isb($e))Fd=$e.ranges,$d=$e.sheetName,Ae=!T.isSameSession}return this.fr.yyg($d,Fd,this.$.qa.sheetName,T.commandParameters.originalDestinations,T.commandParameters.expandDestinations,Ae,vc,gd,Cd,Oa,Eb)};Ll.Object.defineProperties(Qa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
ARc:{configurable:!0,enumerable:!0,get:function(){return this.Bm.Ua(5)}}});Object(od.a)(Qa,"BaseCopyPasteHandler",null,[351,352,353]);fb.prototype.getValue=function(T){return this.key&&this.key.isEqual(T)?this.createClipboardItems(this.clipboardItems):null};fb.prototype.setValue=function(T,Oa){this.key=T;this.clipboardItems=this.createClipboardItems(Oa)};fb.prototype.createClipboardItems=function(T){var Oa=this.W8.create(),Eb=T.getItem(Ib.bV);Eb&&Oa.setItem(Ib.bV,Eb);(Eb=T.getItem(Ib.jN))&&Oa.setItem(Ib.jN,
Eb);(T=T.getItem(Ib.html))&&Oa.setItem(Ib.html,T);return Oa};Object(od.a)(fb,"CopyCache",null,[]);var Wg=b(70);Em(sb,Qa);sb.prototype.getSourceItem=function(){var T=Kd.a.clone(this.gridView.ga.wa.selectedRanges);return new ce(this.$,T,this.$.fa.qa.sheetName,this.$.fa.vf,this.$.ya.UserSessionId)};sb.prototype.beforeSerialize=function(T){var Oa=this;T.isSelectionAllowed=!1;T.isAsyncCopy=!1;T.isFromCache=!1;T.encounteredDeploymentErrors=!1;T.plainTextPayloadSize=0;T.shadowWorkbookPayloadSize=0;T.htmlPayloadSize=
0;T.clientSideCopyTime=0;var Eb=new Kg.a(this.$.va),vc=T.sourceItem;T.isSelectionAllowed=Kd.a.all(vc.ranges,function(gd){return Oa.isSelectionAllowed(Eb,gd)});T.isSelectionAllowed&&this.fr.q_e(vc.ranges,T.commandParameters.commandType)};sb.prototype.AKa=function(T){return this.gridView.Ca.DG()&&Bf.i(this.gridView,T)};sb.prototype.lFi=function(T,Oa,Eb,vc){var gd=!1;1===Eb.ranges.length&&1===vc.length?Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5470715_Paste_Instantaneous")&&(gd=this.nRg.t1c(T,Xe.K(Eb.ranges),
Eb.sheetName,Xe.K(T.commandParameters.expandDestinations),this.$.fa.qa.sheetName,1===Oa.commandParameters.commandType)):T.cseStatus=5;gd&&Bf.g(this.$).vi.u_(T.commandParameters.stopwatch.id,Wg.BasicTelemetryCalculator.JP);return this.VEi(T,Eb,Xe.u(this.$.qa.sheetName,null,vc),Oa.commandParameters.commandType,gd)};sb.prototype.isSelectionAllowed=function(T,Oa){return T.i4a(Oa,this.gridView)};sb.prototype.VEi=function(T,Oa,Eb,vc,gd){Oa=Xe.u(Oa.sheetName,null,Oa.ranges);T.pasteResult="SameSessionPaste";
T.payloadOrigin=gc.VJf;T.payloadType=Vc.lng;mc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",T.commandParameters.id);return this.fr.pasteRange(T.commandParameters.ribbonCommandInfo,Oa,Eb,vc,T.commandParameters.commandType,[T.commandParameters.stopwatch],T,gd)};Object(od.a)(sb,"BaseRangeCopyPasteHandler",Qa,[]);var Kf=b(32);jc.prototype.onDeferredPasteStarted=function(T){this.lT.qb(T.id)||this.lT.add(T.id,!0);if(0<this.lT.count){var Oa=
Zd.GetServiceTaskFactory.Va(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");$g.TaskExtensions.Aa(Oa,function(){Oa.result.eg(28,null)},this.$.la,3)}};jc.prototype.onDeferredPasteCompleted=function(T){var Oa=0<this.lT.count;this.lT.qb(T.id)&&this.lT.remove(T.id);if(Oa&&!this.lT.count){var Eb=Zd.GetServiceTaskFactory.Va(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");$g.TaskExtensions.Aa(Eb,function(){Eb.result.removeEntry(28)},
this.$.la,3)}};Object(od.a)(jc,"DeferredPasteTracker",null,[]);var nd;(function(T){T[T.none=0]="none";T[T.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";T[T.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";T[T.asyncCopyCanceled=3]="asyncCopyCanceled";T[T.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(nd||(nd={}));Object(od.b)("CopyErrorType",nd);var qe=b(1042),Qg=b(1198),ae=qe.a;Em(Db,ae);Object(od.a)(Db,"CopyInnerError",qe.a,[]);Em(Hb,
sb);Hb.prototype.serialize=function(T){var Oa=T.sourceItem,Eb={},vc=this.nYc.getValue(Oa);if(vc)Eb.synchronousResult=vc,T.isFromCache=!0,T.clientSideCopyTime=T.commandParameters.stopwatch.Cc;else{var gd=null,Cd=Xe.F(Oa.ranges);if(!fg.a.C5e()&&this.AKa(Cd)){mc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Cd=this.clipboardRangeFactory.create(Cd);try{gd=Cd.toString(),vc=this.W8.create(),vc.setItem(Ib.bV,gd),this.nYc.setValue(Oa,
vc),Eb.synchronousResult=vc,T.clientSideCopyTime=T.commandParameters.stopwatch.Cc}finally{Cd&&Cd.dispose()}}else T.isAsyncCopy=!0,Eb.synchronousResult=this.W8.create(),Eb.synchronousResult.setItem(Ib.bV,this.ARc);Eb.asynchronousResult=this.N8c(T,Oa,gd)}T.syncClipboardItemsKeys=rd(Eb.synchronousResult);return Eb};Hb.prototype.shouldWaitForCopyToComplete=function(T){if(!T||!T.copyContextSnapshot)return mc.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),
!1;mc.ULS.shipAssertTag(537167906,0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(T.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return mc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;mc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};
Hb.prototype.onDeferredPasteStarted=function(T){this.lT.onDeferredPasteStarted(T)};Hb.prototype.onDeferredPasteCompleted=function(T){this.lT.onDeferredPasteCompleted(T)};Hb.prototype.deserialize=function(T){T.isClipboardDataContainShadowWorkbook=!(void 0===T.clipboardItems.getItem(Ib.jN)||null===T.clipboardItems.getItem(Ib.jN));if(Bf.g(this.$).ga.Qe&326)return fc(T)&&(T.wasLastCopyExternal=!0),Promise.reject(new ue.a(17));var Oa=this.G4f(T,!1);if(Oa)return Promise.reject(new ue.a(fc(T)?18:T.isSameSession?
19:20,void 0,void 0,void 0,Oa));var Eb=T.copyContextSnapshot,vc=this.fr.Isb(Eb);if(fc(T))return this.lkc(T);Oa=T.commandParameters.originalDestinations;if(vc&&T.isSameSession)return this.lFi(T,Eb,vc,Oa);if(516!==T.commandParameters.commandType){vc=this.stj(T.clipboardItems);Eb=vc.o_;if(vc.returnValue){T.isShadowWorkbookParsedSuccessfully=!0;var gd=vc=null;Se.EwaSettings.getBooleanFeatureGate(md.a.G0b,!1)?vc=Xe.r(Oa,this.$):gd=Xe.v(Xe.K(Oa),this.$);return this.LEi(T,gd,vc,Eb)}if(T.isClipboardInaccessible)return Promise.reject(new ue.a(8));
if(36!==T.commandParameters.commandType)return this.Nvf(T)}return Promise.reject(new ue.a(6))};Hb.prototype.beforePaste=function(T){this.$.ea.Ba(373).m2i(T);T.indicationDisplayScheduled=!0};Hb.prototype.Psj=function(T){if(!(T&&T.SourceRanges&&T.SourceRanges.Ranges&&T.SourceRanges.Ranges.length&&(T.OriginalSourceRangesCountExceedsLimit||T.OriginalSourceMultiRange&&T.OriginalSourceMultiRange.Ranges&&T.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,o_:null};var Oa=T.SourceRanges.Ranges[0];
var Eb=null;if(If.a.ma(T.ShadowWorkbookBase64)&&!T.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,o_:Eb};Eb=this.Bwe(T);Eb.rangeRowStart=Oa.FirstRow;Eb.rangeRowEnd=Oa.LastRow;Eb.rangeColumnStart=Oa.FirstColumn;Eb.rangeColumnEnd=Oa.LastColumn;Eb.sourceClientPath=T.SourceClientPath;Eb.sourceSheetName=T.SourceSheetName;Eb.sourceWorkbookName=T.SourceWorkbookName;if(!T.OriginalSourceRangesCountExceedsLimit)for(T=T.OriginalSourceMultiRange.Ranges,Eb.originalSourceRanges=Array(T.length),Oa=0;Oa<T.length;++Oa)Eb.originalSourceRanges[Oa]=
[T[Oa].FirstRow,T[Oa].FirstColumn,T[Oa].LastRow,T[Oa].LastColumn];return{returnValue:!0,o_:Eb}};Hb.prototype.stj=function(T){var Oa=null;T=T.getItem(Ib.jN);if(If.a.ma(T))return{returnValue:!1,o_:Oa};Oa=JSON.parse(T);return{returnValue:this.V7h(Oa),o_:Oa}};Hb.prototype.V7h=function(T){return!!T&&(!If.a.ma(T.shadowWorkbookBase64)||T.shadowWorkbookSizeExceedsLimit)&&void 0!==T.rangeRowStart&&void 0!==T.rangeRowEnd&&void 0!==T.rangeColumnStart&&void 0!==T.rangeColumnEnd};Hb.prototype.LEi=function(T,Oa,
Eb,vc){mc.ULS.shipAssertTag(537167903,0,!!vc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");ad.AFrameworkApplication.lM("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");T.pasteResult="CrossSessionPaste";T.payloadOrigin=gc.axe;T.payloadType=Vc.jN;T.shadowWorkbookPayloadSize=Ab(vc);T.shadowWorkbookSizeExceedsLimit=cb(vc);vc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(T.originalSourceRangesCountExceedsLimit=
vc.originalSourceRangesCountExceedsLimit);if(T.shadowWorkbookSizeExceedsLimit)return mc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,mf.a.Tfc,vc.shadowWorkbookSizeExceedsLimit),Promise.reject(new ue.a(1));if(1028===T.commandParameters.commandType&&T.originalSourceRangesCountExceedsLimit)return mc.ULS.sendTraceTag(572617859,
0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",vc.originalSourceRangesCount,mf.a.Hgi,vc.originalSourceRangesCountExceedsLimit),Promise.reject(new ue.a(1));mc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",T.commandParameters.id);return this.fr.Rvf(T.commandParameters.ribbonCommandInfo,
Oa,Eb,vc,[T.commandParameters.stopwatch],T)};Hb.prototype.N8c=function(T,Oa,Eb){var vc=this;mc.ULS.shipAssertTag(537167901,0,!!T,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var gd=T.commandParameters.stopwatch.Cc;return new Promise(function(Cd,Fd){mc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",T.id);var $d=Xe.u(Oa.sheetName,null,Oa.ranges);
vc.fr.copy($d,T.commandParameters,function(Ae){T.requestTelemetryData=Ae.RequestTelemetryData;T.serverRequestTimeInMs=T.commandParameters.stopwatch.Cc-gd;if(qc.a.Zg(Ae.Errors))qc.a.A8(Ae.Errors)?(T.encounteredDeploymentErrors=!0,mc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",qc.a.Uc(Ae.Errors),T.id)):(mc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",
qc.a.Uc(Ae.Errors),T.id),Fd(new Db(2,Ae.Errors)));else if(mc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",T.id),T.markForCancellation)Fd(new Db(3,Ae.Errors));else{Ae=Ae.Result;var $e=Ae.PlainTextResult;void 0!==Eb&&null!==Eb&&($e=Eb);void 0!==$e&&null!==$e&&(T.plainTextPayloadSize=$e.length);var qg=vc.W8.create(),Tg=vc.Psj(Ae);var jg=Tg.o_;Tg.returnValue&&(T.shadowWorkbookPayloadSize=Ab(jg),T.shadowWorkbookSizeExceedsLimit=
cb(jg),T.originalSourceRangesCountExceedsLimit=Ae.OriginalSourceRangesCountExceedsLimit,jg=JSON.stringify(jg),qg.setItem(Ib.jN,jg));qg.setItem(Ib.bV,$e);fg.a.C5e()&&($e=Ae.HtmlResult,T.htmlSizeExceedsLimit=Ae.HtmlSizeExceedsLimit,void 0!==$e&&null!==$e&&(T.htmlPayloadSize=$e.length),qg.setItem(Ib.html,$e));T.copyTotalSizeExceedsLimit=Ae.CopyTotalSizeExceedsLimit;qg.setItem(Ib.oYc,T.commandParameters.id);vc.nYc.setValue(Oa,qg);T.asyncClipboardItemsKeys=rd(qg);Cd(qg)}},function(Ae){T.serverRequestTimeInMs=
T.commandParameters.stopwatch.Cc-gd;Ae=xd.a.xg(Ae.data);mc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",qc.a.Uc(Ae),T.id);Fd(new Db(2,Ae))},[T.commandParameters.stopwatch])})};Object(od.a)(Hb,"AcrossSessionRangeCopyPasteHandler",sb,[]);Object(od.a)(Qb,"CopyArtRequest",null,[]);Object(od.a)(Sa,"PasteArtRequest",null,[]);Ca.prototype.VOh=function(T){if(this.t4h(T.DLa)){mc.ULS.sendTraceTag(537167681,
5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",T.DLa);var Oa=this.DEb.oa(T.DLa);this.DEb.ia(T.DLa,T);var Eb=Oa.promise;Oa.W5e=!1;return this.I8g(T,Eb)}this.DEb.ia(T.DLa,T);return this.H$h(T)};Ca.prototype.t4h=function(T){return this.DEb.qb(T)};Ca.prototype.H$h=function(T){var Oa=this;return new Promise(function(Eb,vc){T.promise=Oa.FWa.Mvf(T).then(function(gd){Eb(null);return Oa.Ric(T,gd)},function(gd){vc(null);return Oa.PAb(gd)})})};
Ca.prototype.I8g=function(T,Oa){var Eb=this;return new Promise(function(vc,gd){T.promise=Oa.then(function(Cd){Eb.ryj(T,Cd);return Eb.FWa.Mvf(T).then(function(Fd){vc(null);return Eb.Ric(T,Fd)},function(Fd){gd(null);return Eb.PAb(Fd)})},function(Cd){return Eb.PAb(Cd)})})};Ca.prototype.Ric=function(T,Oa){T.W5e&&(this.nLg(T.DLa),this.dGd(T,Oa));return this.kKi(Oa)};Ca.prototype.nLg=function(T){this.DEb.remove(T)};Ca.prototype.dGd=function(T,Oa){var Eb=this.AHh();T.DLa===Eb&&this.FWa.dGd(T.destination,
Oa,T.item.type)};Ca.prototype.AHh=function(){var T=Bf.g(this.$).ga.Pa.activeFloatingObjectControlId;T||(T=Xe.v(Bf.g(this.$).ga.wa.activeCell,this.$),T=T.FirstRow+"_"+T.FirstColumn);return T};Ca.prototype.ryj=function(T,Oa){T.destination=null;T.Xye=Oa};Object(od.a)(Ca,"PasteArtRequestManager",null,[]);var Nh=b(185),wd=b(115),ze=b(102);Em(ua,Qa);ua.prototype.getSourceItem=function(){mc.ULS.shipAssertTag(537167896,0,!!this.ga.Pa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");
mc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ga.Pa.activeFloatingObjectControlId);return new dc(this.ga.Pa.activeFloatingObjectControlId,this.PB.fa.qa.sheetName,this.PB.fa.vf,this.PB.ya.UserSessionId,this.ga.Pa.kc.floatingObject.type)};ua.prototype.beforeSerialize=function(T){T&&T.commandParameters?(T?(T.isAsyncCopy=!1,T.isSelectionAllowed=!1,T.isFromCache=!1,T.plainTextPayloadSize=0,T.shadowWorkbookPayloadSize=0,T.htmlPayloadSize=
0,T.htmlSizeExceedsLimit=!1,T.clientSideCopyTime=0,T.encounteredDeploymentErrors=!1,T.shadowWorkbookSizeExceedsLimit=!1,T.originalSourceRangesCountExceedsLimit=!1,T.copyTotalSizeExceedsLimit=!1):mc.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),T.commandParameters.copyPasteTargetType=2):mc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};ua.prototype.serialize=function(T){var Oa=
T.sourceItem,Eb={};if(!Oa)return mc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Eb;if(!this.T6h())return mc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),Eb;mc.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Oa.activeFloatingObjectControlId);this.nxd();var vc=this.mYc.getValue(Oa);if(vc)Eb.synchronousResult=
vc,T.isFromCache=!0,T.isAsyncCopy=!1,T.clientSideCopyTime=T.commandParameters.stopwatch.Cc,1===T.commandParameters.commandType&&this.PB.De(2045211913,T.commandParameters.ribbonCommandInfo.method,T.commandParameters.ribbonCommandInfo.Ze,null);else{T.isFromCache=!1;T.isAsyncCopy=!0;vc=this.W8.create();if(Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyChartsToPPTOEnabled",!1)&&T.commandParameters.uploadToClipService){var gd={};gd["data-clipservice-ccpid"]=T.commandParameters.id;gd["data-pkey"]=
T.commandParameters.pKey;gd["data-clipservice-type"]=T.commandParameters.clipServiceDataType;gd["data-clipservice-count"]=T.commandParameters.objectCount.toString();gd["data-clipservice-dc"]=T.commandParameters.clipServiceDataCenter;gd["data-clipservice-client"]=this.dMg;gd["data-TimeStamp"]=(new Date).toUTCString();gd["data-clipservice-version"]=this.eMg;vc.setItem(Ib.rvg,JSON.stringify(gd))}Eb.synchronousResult=this.Rog(vc);Eb.asynchronousResult=this.N8c(T,Oa,vc)}T.syncClipboardItemsKeys=rd(Eb.synchronousResult);
return Eb};ua.prototype.Rog=function(T){mc.ULS.shipAssertTag(537167891,0,!!this.ga.Pa.kc,"Expecting a floating object to be currently selected for copy");T||(T=this.W8.create());var Oa=this.ga.Pa.kc.qrb();If.a.ma(Oa)||(Oa=String.format("<img src='{0}'>",Oa),T.setItem(Ib.html,Oa));return T};ua.prototype.nxd=function(){var T=this.ga.Pa.kc;this.nlb.nxd(wd.a.fnb(T.floatingObject),wd.a.gMg(T.dt))};ua.prototype.shouldWaitForCopyToComplete=function(){mc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");
return!0};ua.prototype.onDeferredPasteStarted=function(T){this.lT.onDeferredPasteStarted(T)};ua.prototype.onDeferredPasteCompleted=function(T){this.lT.onDeferredPasteCompleted(T)};ua.prototype.deserialize=function(T){var Oa=fc(T),Eb=null,vc=null,gd=!1;if(!Oa){Eb=T.copyContextSnapshot;vc=Eb.sourceItem;if(!vc)return Promise.reject(new ue.a(10));gd=vc.isFromCurrentSession(this.PB)}var Cd=this.G4f(T,!0);if(Cd)return Promise.reject(new ue.a(Oa?18:gd?19:20,void 0,void 0,void 0,Cd));if(Oa)return this.lkc(T);
if(!gd&&!ua.B0h(vc))return T=String.format("User attempted to paste art of type [{0}] between sessions.",vc.type),mc.ULS.sendTraceTag(537167889,0,50,T),Promise.reject(new ue.a(11,void 0,void 0,T));if(Eb.isAsyncSerializeFailed)return Promise.reject(new ue.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));try{var Fd=T.clipboardItems.getItem(Ib.jN);var $d=JSON.parse(Fd)}catch(Ae){return mc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",
copyPasteInfra.getStringifiedError(Ae)),Promise.reject(new ue.a(12,void 0,Ae))}$d.floatingObjectId!==vc.activeFloatingObjectControlId?mc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",vc.activeFloatingObjectControlId,$d.floatingObjectId):mc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
vc.activeFloatingObjectControlId,$d.floatingObjectId);if(!$d||If.a.ma($d.shadowWorkbookBase64))return Promise.reject(new ue.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!$d)));T.isShadowWorkbookParsedSuccessfully=!0;T.shadowWorkbookPayloadSize=Ab($d);T.shadowWorkbookSizeExceedsLimit=cb($d);T.payloadOrigin=gd?gc.VJf:gc.axe;T.payloadType=Vc.K7f;if(cb($d))return T=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,
mf.a.Tfc,$d.shadowWorkbookSizeExceedsLimit),mc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",T),Promise.reject(new ue.a(1,void 0,void 0,T));Eb=Oa=null;Bf.g(this.PB).ga.Qe&326?Eb=Bf.g(this.PB).ga.Pa.activeFloatingObjectControlId:Oa=this.PB.qa&&this.PB.qa.activeCell?Xe.v(this.PB.qa.activeCell,this.PB):Xe.v(Xe.K(T.commandParameters.originalDestinations),this.PB);gd=null;if(this.nlb.PRf(vc))try{gd=this.nlb.t1c()}catch(Ae){mc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",
copyPasteInfra.getStringifiedError(Ae))}return this.MEi.VOh(new Sa(T.commandParameters.ribbonCommandInfo,Oa,Eb,T.commandParameters.commandType,[T.commandParameters.stopwatch],$d,vc,T,gd))};ua.prototype.lkc=function(T){T.wasLastCopyExternal=!0;if(T.clipboardItems.getItem("image/png")){var Oa=T.commandParameters.stopwatch.Cc;T.payloadType=Vc.DBg;var Eb={};return Wb.b(this.PB.De(1403967063,T.commandParameters.ribbonCommandInfo.method,T.commandParameters.ribbonCommandInfo.Ze,(Eb.dataUrl=T.clipboardItems.getItem("image/png"),
Eb))).then(function(vc){T.serverRequestTimeInMs=T.commandParameters.stopwatch.Cc-Oa;return vc?Promise.resolve(null):Promise.reject(new ue.a(15))},function(){T.serverRequestTimeInMs=T.commandParameters.stopwatch.Cc-Oa;return Promise.reject(new ue.a(15))})}mc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return Qa.prototype.lkc.call(this,T)};ua.prototype.T6h=function(){var T=Bf.g(this.PB).ga;return T.Pa.activeFloatingObjectControlId&&
T.Pa.kc&&T.Pa.kc.floatingObject?T.Pa.kc.floatingObject.ZMd():!1};ua.prototype.N8c=function(T,Oa,Eb){var vc=this;return new Promise(function(gd,Cd){var Fd=T.commandParameters.stopwatch.Cc;mc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");vc.FWa.gRg(new Qb(Oa.activeFloatingObjectControlId,T.commandParameters,function($d){T.requestTelemetryData=$d.RequestTelemetryData;T.serverRequestTimeInMs=T.commandParameters.stopwatch.Cc-
Fd;if(qc.a.Zg($d.Errors))qc.a.A8($d.Errors)?(T.encounteredDeploymentErrors=!0,mc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",qc.a.Uc($d.Errors))):(mc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",qc.a.Uc($d.Errors)),Cd(new Db(4,$d.Errors)));else if(mc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",
Oa.activeFloatingObjectControlId),T.markForCancellation)Cd(new Db(3,$d.Errors));else{qc.a.vq($d.Errors)&&mc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",qc.a.Uc($d.Errors));var Ae=$d.Result;if(Ae){Ae=vc.Bwe(Ae);Ae.floatingObjectId=Oa.activeFloatingObjectControlId;T.shadowWorkbookPayloadSize=Ab(Ae);T.shadowWorkbookSizeExceedsLimit=cb(Ae);try{var $e=JSON.stringify(Ae)}catch(qg){Cd(new ue.a(14,void 0,qg,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",
T.shadowWorkbookPayloadSize,Ae.floatingObjectId)));return}mc.ULS.shipAssertTag(537167881,0,!!Eb,"Expecting syncClipboardItems to be defined");Eb.setItem(Ib.jN,$e);1===T.commandParameters.commandType&&(vc.UHi(Oa.type,Oa.activeFloatingObjectControlId,$d.StateId),vc.deleteFloatingObject(Oa.activeFloatingObjectControlId,Oa.type));vc.mYc.setValue(Oa,Eb);T.asyncClipboardItemsKeys=rd(Eb);gd(Eb)}else mc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",
Oa.activeFloatingObjectControlId),gd(vc.mYc.getValue(Oa))}},T.commandParameters.commandType,Oa.type,function($d){T.serverRequestTimeInMs=T.commandParameters.stopwatch.Cc-Fd;$d=xd.a.xg($d.data);1===T.commandParameters.commandType&&vc.FWa.ruj(Oa.type,Oa.activeFloatingObjectControlId);mc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",qc.a.Uc($d));Cd(new Db(4,$d))},[T.commandParameters.stopwatch]))})};ua.prototype.deleteFloatingObject=
function(T,Oa){T=Nh.a.ey(Oa,T);if(T=ze.a(this.PB).kp(T))ze.a(this.PB).deleteFloatingObject(T,14,!0),Bf.g(this.PB).ga.Pa.EB=null};ua.prototype.UHi=function(T,Oa,Eb){var vc=this.PB.ea.Ba(277);if(vc){var gd=null;T=Nh.a.ey(T,Oa);(T=ze.a(this.PB).kp(T))&&T.si&&(gd=T.si.block);if(gd){var Cd=T.floatingObject.Dg();vc.JUb(function(){return!gd.Ii.qb(Cd)},Eb,"CutArt")}}};ua.B0h=function(T){return 1===T.type||5===T.type};Object(od.a)(ua,"ArtCopyPasteHandler",Qa,[]);var Ah=b(55);Em($a,Od);Object(od.a)($a,"MacroRecorderPasteArtPayload",
Od,[]);Ua.prototype.eUh=function(T,Oa,Eb,vc,gd,Cd,Fd){var $d=this;Cd=void 0===Cd?null:Cd;Fd=void 0===Fd?null:Fd;var Ae=this.$.ra.ua.Wb(),$e=null,qg={CopyPasteTargetType:2};qg.FloatingObjectId=T;qg.CopyOperationId=Eb.id;Eb.floatingObjectType=Oa;Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyChartsToPPTOEnabled",!1)&&(qg.UploadToClipService=Eb.uploadToClipService,qg.PKey=Eb.pKey,qg.ClipServiceDataCenter=Eb.clipServiceDataCenter);var Tg=0;2===gd?(gd=505,Tg=16,$e=function(jg,vf,Xg){return rc($d.$.ra.ua,
qg,Lg.b(jg,vc),Cd?Lg.a(vf,Cd):vf,Xg,Eb.ribbonCommandInfo,Ae,Fd)}):(gd=179,$e=function(jg,vf,Xg){$d.D4g(Oa,T);$d.$.Es();var bh=$d.$.ra.ua;jg=Lg.b(jg,vc);vf=Cd?Lg.a(vf,Cd):vf;var Fh=Eb.ribbonCommandInfo,gh=Fd;gh=void 0===gh?null:gh;var ud=bh.Na(1,void 0===Ae?null:Ae);ud.copyParameters=qg;return bc.i(bh,"Cut",ud,jg,vf,Xg,Fh,0,gh)});Se.EwaSettings.pc()?this.$.userOperationManager.jc(new Ud.a(gd,0,$e,Tg|64),Eb.ribbonCommandInfo):this.$.userOperationManager.jc(new qd.a(gd,0,$e,Tg),Eb.ribbonCommandInfo)};
Ua.prototype.D4g=function(T,Oa){var Eb=Nh.a.ey(T,Oa);(Eb=ze.a(this.$).kp(Eb))?(Bf.g(this.$).ga.Pa.VF(Eb),Eb.isVisible=!1):mc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",T,Oa)};Ua.prototype.ruj=function(T,Oa){T=Nh.a.ey(T,Oa);if(T=ze.a(this.$).kp(T))T.isVisible=!0};Ua.prototype.gRg=function(T){this.eUh(T.floatingObjectId,T.eRg,T.commandParameters,T.Oq,T.GZg,T.V2,T.LRd)};Ua.prototype.EUh=function(T,
Oa,Eb,vc,gd,Cd,Fd,$d,Ae){var $e=this;$d=void 0===$d?null:$d;Ae=void 0===Ae?!0:Ae;return new Promise(function(qg,Tg){var jg=Cd.commandParameters.stopwatch.Cc;$e.yGd(T,gd,Oa,Eb,function(vf){Cd.requestTelemetryData=vf.RequestTelemetryData;Cd.serverRequestTimeInMs=Cd.commandParameters.stopwatch.Cc-jg;if(qc.a.A8(vf.Errors))Cd&&(Cd.encounteredDeploymentErrors=!0),mc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
qc.a.Uc(vf.Errors));else if(qc.a.Zg(vf.Errors))mc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",qc.a.Uc(vf.Errors)),Tg(new ue.a(9,vf.Errors));else if(vf.Result){var Xg=vf.Result;mc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");$e.hIi(Fd,Xg.FloatingObjectId,vf.StateId);qg(Ua.ted(Xg.FloatingObjectId))}else mc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),
Tg(new ue.a(9,vf.Errors))},function(vf){Cd.serverRequestTimeInMs=Cd.commandParameters.stopwatch.Cc-jg;vf=xd.a.xg(vf.data);mc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",qc.a.Uc(vf));Tg(new ue.a(9,vf))},vc,$d,Ae)})};Ua.prototype.hIi=function(T,Oa,Eb){var vc=this,gd=this.$.ea.Ba(277);if(gd){var Cd=Nh.a.ey(T,Ua.ted(Oa));gd.JUb(function(){return!!ze.a(vc.$).kp(Cd)},Eb,"PasteArt")}};Ua.prototype.TPd=function(T,Oa){If.a.ma(Oa)||this.nlb.TPd(T,Nh.a.ey(T.type,
Oa))};Ua.prototype.Mvf=function(T){var Oa=this;return this.EUh(T.ribbonCommandInfo,T.destination,T.Xye,T.LRd,T.o_,T.pasteContext,T.item.type,T.$qe,T.item.isFromCurrentSession(this.$)).then(function(Eb){return Eb},function(Eb){Oa.TPd(T.item,T.$qe);return Promise.reject(Eb)})};Ua.prototype.dGd=function(T,Oa,Eb){T||(T=Xe.v(Bf.g(this.$).ga.wa.activeCell,this.$));Bf.g(this.$).Tcc(Xe.D(T),1)?ze.a(this.$).ula(Eb,Oa,!0):Bf.g(this.$).ga.Pa.OEa(T,Oa,Eb).continueWith(function(vc){vc.result?mc.ULS.sendTraceTag(537167843,
5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Oa):mc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Oa)})};Ua.prototype.yGd=function(T,Oa,Eb,vc,gd,Cd,Fd,$d,Ae){function $e(){if(Ae){var Xg=Ah.a.Xh(Ah.a.Hc(vf));Xg.FloatingObjectId=Oa.floatingObjectId;vf.DestinationRanges||(Xg.DestinationRanges=Xe.p(Tg.$.va.qa.sheetName,"",0,0,0,0));return new $a(Xg,Ae,0,0)}return new $a(vf,
Ae,0,0)}function qg(Xg,bh,Fh){$d||Tg.$.Es();return Lb(Tg.$.ra.ua,vf,Lg.b(Xg,gd),Lg.a(bh,Cd),Fh,null,jg,Fd)}var Tg=this;Ae=void 0===Ae?!0:Ae;var jg=this.$.ra.ua.Wb(),vf={};vf.ShadowWorkbookBase64=Oa.shadowWorkbookBase64;vf.FloatingObjectId=vc;vf.DestinationRanges=Eb?Xe.s(Eb):null;vf.CopyPasteTargetType=2;vf.ClientEstimationFloatingObjectId=$d;Eb=Se.EwaSettings.pc()?new Ud.a(503,0,qg,void 0,$e):new qd.a(503,0,qg,void 0,$e);Eb.flags=Se.EwaSettings.pc()?65:1;this.$.userOperationManager.jc(Eb,T)};Ua.ted=
function(T){return String.format("{0}.{{{1}}}",T.length+2,T.toUpperCase())};Object(od.a)(Ua,"ArtCopyPasteUtils",null,[345]);var Xh=b(237);Jb.prototype.nxd=function(T,Oa){this.jra=T;this.kYc=Oa};Jb.prototype.t1c=function(){if(!this.jra||!this.kYc)return mc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";var T=wd.a.fnb(new Nh.a(this.jra));T.Id=Ua.ted(Sg.a.create().toString());
T.Version=-1;T.Name="";T.IsClientEstimation=!0;var Oa=this.MVh(T);if(!Oa)return null;var Eb=new Nh.a(T);Oa.block.Ii.add(Eb);Eb.IEb();var vc=ze.a(this.$);vc.X_b(Eb,Oa);Oa=vc.kp(Nh.a.$Ah(T));!Oa||Oa.floatingObject.gKa||Oa.floatingObject.FKa||Oa.bPa(this.kYc);vc.ula(T.Type,T.Id,!0);return T.Id};Jb.prototype.PRf=function(T){return Se.EwaSettings.ka(224)&&T.isFromCurrentSession(this.$)&&!Bf.g(this.$).rtl&&!Bf.g(this.$).Wa.Mi};Jb.prototype.TPd=function(T,Oa){this.PRf(T)&&(T=ze.a(this.$).kp(Oa))&&(mc.ULS.sendTraceTag(537167840,
5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Oa,T.floatingObject.type),ze.a(this.$).deleteFloatingObject(T,15,!0),T.si&&T.M8a(T.si,!1))};Jb.prototype.MVh=function(T){if(!T)return mc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(Bf.g(this.$).ga.Pa.activeFloatingObjectControlId){var Oa=Bf.g(this.$).ga.Pa.EB.floatingObject;
T.OriginDeltaX=Oa.offsetX+this.s7a;T.OriginDeltaY=Oa.offsetY+this.s7a;T.AbsoluteLeft+=this.s7a;T.AbsoluteTop+=this.s7a;T.AbsoluteRight+=this.s7a;T.AbsoluteBottom+=this.s7a;T.ZOrder=Oa.az+1;return Bf.g(this.$).ga.Pa.EB.si}if(!this.$.qa||!this.$.qa.activeCell)return mc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var Eb=this.$.qa.activeCell;Oa=Bf.g(this.$).Y_(Eb);if(!Oa)return mc.ULS.sendTraceTag(537167837,
0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",Eb.toString()),null;var vc=Sd.HelperMethods.uIa(Oa.domElement,Oa.ij.domElement);Eb=Oa.gridView.Eg(Eb,2);if(!vc||!Eb)return mc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",!vc,!Eb),null;T.OriginDeltaX=Eb.topLeft.x-vc.x;T.OriginDeltaY=Eb.topLeft.y-vc.y;T.AbsoluteLeft=
Eb.topLeft.x;T.AbsoluteTop=Eb.topLeft.y;T.AbsoluteRight=T.AbsoluteLeft+Math.abs(this.jra.AbsoluteRight-this.jra.AbsoluteLeft);T.AbsoluteBottom=T.AbsoluteTop+Math.abs(this.jra.AbsoluteBottom-this.jra.AbsoluteTop);T.ZOrder=this.jra.ZOrder+100;return new Xh.a(Oa.gridView.Ca.zk(Oa.hashCode),Oa.hashCode)};Object(od.a)(Jb,"ArtPasteClientEstimation",null,[346]);ic.prototype.create=function(){var T=window.clipboardPlatform;return T?T.createClipboardItems():null};Object(od.a)(ic,"ClipboardItemsFactory",null,
[344]);wb.undefined="Undefined";Object(od.a)(wb,"CCPTelemetryConsts",null,[]);qb.cells="Cells";qb.floatingObject="FloatingObject";qb.unknown="Unknown";Object(od.a)(qb,"ActiveSelection",null,[]);Ia.K3g="DisplayNotInvoked";Ia.k1c="Displayed";Ia.sIi="PrerequisitesNotReady";Object(od.a)(Ia,"PasteIndicationDisplayStatus",null,[]);var pg=b(107);Aa.prototype.getCopyFlowHandler=function(T){var Oa=this.cxh(Bf.g(this.$).Qe);T.commandParameters.copyPasteHandlerName=Oa.name;return Oa};Aa.prototype.getPasteFlowHandler=
function(T){var Oa=T.copyContextSnapshot;Oa=Da(T)?this.wRc:fc(T)?this.mzd:Oa&&Oa.sourceItem&&Object.getType(Oa.sourceItem)===dc?this.wRc:this.mzd;T.commandParameters.copyPasteHandlerName=Oa.name;return Oa};Aa.prototype.initializePasteContext=function(T){if(T&&(T.isSameSession=!1,T.isShadowWorkbookParsedSuccessfully=!1,T.pasteResult=wb.undefined,T.payloadOrigin=wb.undefined,T.payloadType=wb.undefined,T.encounteredDeploymentErrors=!1,T.shadowWorkbookSizeExceedsLimit=!1,T.originalSourceRangesCountExceedsLimit=
!1,T.activeSelectionType=this.fth(),T.indicationDisplayScheduled=!1,T.pasteIndicationDisplayStatus=Ia.K3g,T.copyContextSnapshot)){var Oa=T.copyContextSnapshot,Eb=kd(Oa.sourceItem),vc=Oa.sourceItem;var gd=!!vc&&Object.getType(vc)===dc;vc=0;var Cd=!1;Eb?(Cd=Oa.sourceItem,T.isSameSession=Cd.isFromCurrentSession(this.$),vc=1,Cd=this.u4h(Cd,T)):gd&&(T.isSameSession=Oa.sourceItem.isFromCurrentSession(this.$),vc=2);if(T.copyContextSnapshot.commandParameters){gd=-1985798686===Oa.commandParameters.ribbonCommandInfo.command;
var Fd=T.commandParameters;var $d=this.$;Oa?$d&&$d.ya?Oa=Oa.sessionId===$d.ya.UserSessionId:(mc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Oa=!1):(mc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Oa=!1);Fd.clearSystemClipboard=Oa&&gd&&Eb&&!Cd;T.commandParameters.copyPasteTargetType=vc}}};Aa.prototype.getSessionId=function(){return this.$.ya.UserSessionId};Aa.prototype.u4h=function(T,Oa){var Eb=pg.b(T.ranges,function(vc){return vc.Fh})&&pg.b(Oa.commandParameters.originalDestinations,
function(vc){return 1!==vc.top});return pg.b(T.ranges,function(vc){return vc.isRow})&&pg.b(Oa.commandParameters.originalDestinations,function(vc){return 1!==vc.left})||Eb};Aa.prototype.cxh=function(T){switch(T){case 1:return this.mzd;case 64:case 4:case 2:case 256:return this.wRc;default:throw Error.invalidOperation("Unsupported selection");}};Aa.prototype.fth=function(){return Bf.g(this.$).ga.Qe&470?qb.floatingObject:1===Bf.g(this.$).ga.Qe?qb.cells:qb.unknown};Ll.Object.defineProperties(Aa.prototype,
{mzd:{configurable:!0,enumerable:!0,get:function(){if(!this.FJc){var T=this.$.ea.Ba(254,!0);T&&(this.FJc=new Hb(this.$,T,new ic))}return this.FJc}},wRc:{configurable:!0,enumerable:!0,get:function(){if(!this.tzc&&this.$.ea.Ba(254,!0)){var T=new Jb(this.$);this.tzc=new ua(this.$,new ic,new Ua(this.$,T),T)}return this.tzc}}});Object(od.a)(Aa,"ExcelCopyPasteApplicationHost",null,[326]);var vg=b(139),Ih=Vg.a;Em(Zb,Ih);Zb.prototype.Eh=function(T){this.xo=new vg.a;var Oa=Hf.a.instance.da(16);T=this.k3(T);
this.initializeAndShow(Oa,Object(za.a)(this,this.AXh,"insertCopiedCutCellsDialogHandler"),T)};Zb.prototype.k3=function(T){var Oa={};return Oa.id=this.sc,Oa.isRtl=T,Oa};Zb.prototype.AXh=function(T,Oa){1===T?(T=Zb.V2g[Oa[Zb.U2g]],mc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",T?"Vertical":"Horizontal"),this.xo.setResult(T)):(mc.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),
this.xo.Dt())};Ll.Object.defineProperties(Zb.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});Zb.U2g="direction";var Eh={};Zb.V2g=(Eh.Vertical=1,Eh.Horizontal=0,Eh);Object(od.a)(Zb,"InsertCopiedCutCellsDialog",Vg.a,[]);cc.prototype.Z_b=function(T,Oa){return(new Zb(T,Oa)).xo.task};Object(od.a)(cc,"InsertCopiedCutCellsDialogFactory",null,[324]);var Zh=b(86),ih=b(43),eg=b(42);tc.prototype.dBe=function(){var T=this;this.Zkc||(mc.ULS.sendTraceTag(537167680,
0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.RD(function(Oa){Oa.fta(0).then(function(){T.Zkc=!0})}))};tc.prototype.m2i=function(T){var Oa=this,Eb=T.commandParameters.id;mc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",Eb,!this.dr,this.Zkc);this.dBe();this.Y0b=Eb;Eb=!this.xhf();if(!this.dr||Eb)this.joe(),this.dr=ih.a.instance.create(function(){Oa.J3g(T)},
void 0===T.timeoutToShowSpinnerInMs||null===T.timeoutToShowSpinnerInMs?100:T.timeoutToShowSpinnerInMs,eg.a.QEi);this.$0=T.commandParameters.originalDestinations};tc.prototype.J3g=function(T){this.Zkc?(this.display(T.commandParameters.originalDestinations),T.pasteIndicationDisplayStatus=Ia.k1c):(mc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),T.pasteIndicationDisplayStatus=Ia.sIi)};tc.prototype.display=function(T){mc.ULS.sendTraceTag(537167649,
0,50,"PasteIndicationManager.Display: started");this.gridView.Kb.Hs(hg.a.fW(ge.d(this.gridView.$.qa),T),tc.mkc,!0);this.gridView.Kb.Jr(tc.mkc)};tc.prototype.jdd=function(T){mc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",T,this.Y0b);T&&If.a.equals(T,this.Y0b,!1)&&this.hide()};tc.prototype.hide=function(T){this.$0&&(void 0===T?0:T)&&this.xhf()&&mc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");
this.Y0b="";this.joe();this.$0=null;this.gridView.Kb.mk(tc.mkc);this.gridView.Kb.Ek(null,tc.mkc)};tc.prototype.xhf=function(){return Xe.Q(this.gridView.ga.wa.selectedRanges,this.$0)};tc.prototype.joe=function(){this.dr&&(Zh.a.Fa(this.dr),this.dr=null)};tc.prototype.dispose=function(){this.hide();this.gridView.ga.CE(Object(za.a)(this,this.hide,"hide"))};tc.mkc=[30];Object(od.a)(tc,"PasteIndicationManager",null,[261,6]);var oh=b(1006),Hh=b(52),X=zc.a;Em(Ec,X);Ec.prototype.create=function(){var T=this,
Oa=Hh.a.iZ([52,53],4,this.rb,void 0,void 0,void 0,Ec.QOa),Eb=Zd.GetServiceTaskFactory.create(this.$.ea,18,this.$.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction");$g.TaskExtensions.Aa($g.TaskExtensions.xe([Eb,Oa],this.la),function(){var vc=new oh.a,gd=null;T.TOg(vc).then(function(Cd){gd=Cd.cre;var Fd=copyPasteInfra.createCopyPasteInfra(gd,new Aa(T.$),vc,T.$);mc.ULS.shipAssertTag(537167762,0,!!T.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");
mc.ULS.shipAssertTag(537167761,0,!!T.$.ya&&!!T.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var $d=gd.getMetadataManager();T.Eb(new Pc(T.$,$d,Eb.result,Fd,new Nc(T.$,Bf.g(T.$)),new cc,T.$.ya.DocumentHostInfo.UserId,gd.getInitializationError()));Cd.aYa?mc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",
Pc.M6b(),Cd.aYa.dataClipboardStrategyType,JSON.stringify(Cd.aYa.dataClipboardCapabilities),Cd.aYa.clipboardStrategiesToInitialize[0].clipboardStrategyType===Cd.aYa.dataClipboardStrategyType,void 0!==window.bsqmXLSPageLoadStartTime&&null!==window.bsqmXLSPageLoadStartTime?(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString():"-1"):mc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Cd){mc.ULS.shipAssertTag(38847436,
0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",Pc.M6b(),Cd?copyPasteInfra.getStringifiedError(Cd):"null")})},this.la,3)};Ec.prototype.dispose=function(){X.prototype.dispose.call(this)};Ec.prototype.TOg=function(T){var Oa=null,Eb=window.clipboardPlatform;Eb&&(Oa=Eb.getClipboardPlatformEnvironment());if(!Oa)return mc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),
Promise.reject(null);Eb=this.$.ya;var vc=[Eb.OfficeOnlineChromeExtensionId,Eb.ChromeClipboardAccessExtensionId],gd=this.Bm.Ua(5),Cd=this.$.Qf.get(57),Fd=!Cd&&this.$.Qf.get(5),$d=this.$.fa.ic;$d&&($d.inWebPart||$d.inViewerFromWebPart||$d.isDivSyndicated)&&(Fd=!1);Cd=this.cwh(Fd,!Cd);mc.ULS.shipAssertTag(537167758,0,!!Eb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Oa.init(this.$,T,vc,Eb.SharedClipboardHostingApp,
Eb.SharedClipboardHostingApps,Eb.SharedClipboardHostingEnvironments,Eb.SharedClipboardOverrideOrigin,Eb.SharedClipboardSchemaVersion,Eb.SharedClipboardExpirationInMinutes,Eb.ClipboardPromiseTimeoutInMinutes,gd,Eb.MachineCluster,new Lc(this.$),Cd,Eb.DocumentHostInfo.UserId,Eb.ClipboardTtlInMS,Se.EwaSettings.ka(317),Eb.UserSessionId).then(function(Ae){return Object.assign(new hc,{cre:Oa,aYa:Ae})},function(Ae){return Promise.reject(Ae)})};Ec.prototype.cwh=function(T,Oa){var Eb=[];T&&Oa&&Array.add(Eb,
this.iYg());Oa&&(Array.add(Eb,this.XZc(7)),Array.add(Eb,this.XZc(0)));T&&Array.add(Eb,this.Lve());Array.add(Eb,{clipboardStrategyType:4});mc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",T,Oa,Eb?Eb.join(","):"[]");return Eb};Ec.prototype.Lve=function(){var T=this.$.ya,Oa={clipboardStrategyType:5};Oa.sessionId=T.UserSessionId;Oa.useSharedClipboardIframe=
!0;Oa.sharedClipboardHostingApp=T.SharedClipboardHostingApp;Oa.sharedClipboardHostingApps=T.SharedClipboardHostingApps;Oa.sharedClipboardHostingEnvironments=T.SharedClipboardHostingEnvironments;Oa.sharedClipboardOverrideOrigin=T.SharedClipboardOverrideOrigin;Oa.sharedClipboardSchemaVersion=T.SharedClipboardSchemaVersion;Oa.sharedClipboardExpirationInMinutes=T.SharedClipboardExpirationInMinutes;Oa.wacCluster=T.MachineCluster;return Oa};Ec.prototype.iYg=function(){var T={clipboardStrategyType:6};T.localStorageStrategyParameters=
this.Lve();T.systemClipboardStrategyParameters=this.XZc(0);return T};Ec.prototype.XZc=function(T){var Oa={};Oa.clipboardStrategyType=T;Oa.skipFilesIfPlainTextExists=!0;return Oa};Ec.ja=function(T){T.ea.Ia(373,new tc(T));T.ea.Ia(Ec.QOa,new Ec(T))};Ec.QOa=255;Object(od.a)(Ec,"CopyPasteInfrastructureFactory",zc.a,[]);var Xa=b(12),Pb=b(117),Gc=b(13),Hc=Ue.a;Em(lc,Hc);lc.prototype.dispose=function(){this.$l();this.hk=this.pt=this.$=null;this.statusBarManager&&(this.statusBarManager.xE(this),this.statusBarManager=
null)};lc.prototype.Vm=function(){return this.oSf};lc.prototype.mr=function(T,Oa){if("QueryPasteShortcutEnabledLabel"!==T&&!Array.contains(lc.Rlj,T))return!1;var Eb=this.Sn();"QueryPasteShortcutEnabledLabel"===T?(Oa.Visible=Eb,mc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",Eb,T)):(Oa.Visible=!Eb,mc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!Eb,T));return!0};
lc.prototype.k8g=function(){this.Uj();this.raiseEvent("pasteShortcutStatusChanged")};lc.prototype.e2b=function(){this.$l();this.raiseEvent("pasteShortcutStatusChanged")};lc.prototype.Sn=function(){return this.W2c};lc.prototype.Qp=function(T){this.addHandler("pasteShortcutStatusChanged",T)};lc.prototype.jq=function(T){this.removeHandler("pasteShortcutStatusChanged",T)};lc.prototype.Uj=function(){if(!this.Sn()){this.W2c=!0;Bf.g(this.$).Yi.Jm(Object(za.a)(this,this.Nze,"disablePressEnterToPasteOnEditStarted"));
this.hk.ja("blur",Object(za.a)(this,this.c3g,"disablePressEnterToPasteOnDocumentHidden"));var T=this.$.ea.Ba(65);T&&T.Y1&&T.Y1.registerForCommentEvents(Object(za.a)(this,this.Mze,"disablePressEnterToPasteOnCommentsEvent"));this.pt.Au(Gc.a.Qb,this.$.domElement,Object(za.a)(this,this.onKeyDown,"onKeyDown"),!0)}};lc.prototype.$l=function(){if(this.Sn()){this.W2c=!1;Bf.g(this.$).Yi.ym(Object(za.a)(this,this.Nze,"disablePressEnterToPasteOnEditStarted"));this.hk.detach("blur");var T=this.$.ea.Ba(65);T&&
T.Y1&&T.Y1.unregisterForCommentEvents(Object(za.a)(this,this.Mze,"disablePressEnterToPasteOnCommentsEvent"));this.pt.Nu(Gc.a.Qb,this.$.domElement,Object(za.a)(this,this.onKeyDown,"onKeyDown"),!0)}};lc.prototype.Nze=function(){this.e2b()};lc.prototype.c3g=function(){this.e2b()};lc.prototype.Mze=function(T){10===T&&this.e2b()};lc.prototype.onKeyDown=function(T){if(13===T.Ea.keyCode){T=new te.a(237279923,1,2,6,null);var Oa={};this.$.Ka.Ub(T,(Oa.SkipClipboardAccess=!0,Oa.EnterToPaste=!0,Oa));return!0}return!1};
lc.Rlj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(od.a)(lc,"PasteShortcutManager",Ue.a,[257,156,157,6]);var Ld=b(121),Ie=zc.a;Em(P,Ie);P.prototype.create=function(){var T=this.$;this.Eb(T.ea.Ba(478)||this.$.ea.Ia(478,new lc(T,Pb.KeyInputManager.instance,Ld.a.instance.BB())))};P.ja=function(T){T.ea.Ia(479,new P(T))};Object(od.a)(P,"PasteShortcutManagerFactory",zc.a,[]);uc.prototype.isEnabled=function(){if(ad.AFrameworkApplication.ha?ad.AFrameworkApplication.ha.sa("IsAnonymousUser"):
1)return!1;var T=ad.AFrameworkApplication.Fb?Object(Nb.a)(String,ad.AFrameworkApplication.Fb.AudienceGroup):"";return"Unknown"!==T&&"Automation"!==T};Ll.Object.defineProperties(uc.prototype,{PQc:{configurable:!0,enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},K0h:{configurable:!0,
enumerable:!0,get:function(){return this.isEnabled()&&this.$.ka(350)}},r4a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ka(352)}},Fwb:{configurable:!0,enumerable:!0,get:function(){return this.$.ka(351)}},Knh:{configurable:!0,enumerable:!0,get:function(){return null}},dgf:{configurable:!0,enumerable:!0,get:function(){return 24}},eJf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},YEb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||
""}}});Object(od.a)(uc,"FirstRunExperienceLauncherSettings",null,[259]);zb.prototype.BKd=function(){this.nLe&&this.nLe.BKd(this.vnh)};Object(od.a)(zb,"FirstRunExperienceManager",null,[258]);var Td=zc.a;Em(oc,Td);oc.prototype.create=function(){this.Eb(this.$.ea.Ba(311)||this.dUg())};oc.prototype.dUg=function(){var T=new uc(this.$);T=new zb(Ef.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),T);T.BKd();return T};oc.ja=function(T){T.ea.Ia(312,new oc(T))};Object(od.a)(oc,
"FirstRunExperienceManagerFactory",zc.a,[]);var Re=b(57),ff=zc.a;Em(Yb,ff);Yb.prototype.create=function(){this.Eb(this.$.ea.Ba(361)||this.PUg())};Yb.prototype.PUg=function(){var T=this;this.Ced=Ef.a.instance.Mh("Common.IInProductMessagingUIManager");Re.a.Df.isReactSharedHeaderUxEnabled?wc.a.get_instance().Om(16,function(){T.R1e()}):this.R1e();return this.Ced};Yb.prototype.R1e=function(){var T=this;Ef.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){Oa.isFeatureEnabled("MsoPremiumBadge",
!0).then(function(Eb){!Eb&&Oa.isFreemiumUpsellEnabled()&&T.Ced.nbf();return null})})};Yb.ja=function(T){T.ea.Ia(362,new Yb(T))};Object(od.a)(Yb,"InProductMessagingManagerFactory",zc.a,[]);var Of=b(800),kg=b(98),Rf=b(173);Object(od.a)(Ra,"UploadBlobParameters",null,[]);var Ig=b(109);Wa.prototype.pBb=function(T){this.tj=T;if(!this.tZa){if(this.BRd){if(this.K5a&&hf.a.gE){this.rOb=T.D2b(Object(za.a)(this,this.qtd,"onFileChosen"));return}this.rOb=T.D2b(null);if(!this.Wza(this.rOb,T))return}this.finalizeUpload(T,
null)}};Wa.prototype.qtd=function(T){if(this.Wza(T,this.tj)){if(hf.a.gE||hf.a.uf)this.rOb=T;this.finalizeUpload(this.tj,null)}};Wa.prototype.zjc=function(){this.Zud&&this.Zud()};Wa.prototype.hZi=function(){this.hpa=0;this.SCa=this.ha.xd("Box4UploadRetryDelayStart",200);this.tj&&(this.tj.dispose(),this.tj=null)};Ll.Object.defineProperties(Wa.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.sR}},ha:{configurable:!0,enumerable:!0,get:function(){return this.vb}},retryCount:{configurable:!0,
enumerable:!0,get:function(){return this.hpa}},AEd:{configurable:!0,enumerable:!0,get:function(){return this.SCa}}});Object(od.a)(Wa,"FileUploader",null,[]);var ya=b(408),oa=b(891),yb=b(128);Em(lb,Wa);lb.prototype.kQe=function(T){switch(T){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};lb.prototype.E4f=function(T){return lb.Wza(T,this.PKh())};lb.prototype.PKh=function(){return lb.tbe};lb.prototype.Wza=function(T,
Oa){return(T=this.E4f(T))?(Oa&&Oa.Gde(),2===T&&this.ai(0,this.kQe(T)),!1):!0};lb.prototype.finalizeUpload=function(T,Oa){mc.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Zud=Oa;this.Ygj();ya.a.mark(5576);this.$Qb=this.IH.Dc("LoadResource","PictureUploadTime")};lb.prototype.ai=function(T,Oa){var Eb=new yb.StandardDialog;Eb.hc=0;Eb.Qy(T,CommonUIStrings.l_ImageUploadFailedTitle,Oa,null)};lb.prototype.zjc=function(){mc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");
Wa.prototype.zjc.call(this);this.$Qb&&(this.$Qb.stop(),this.$Qb=null);this.sMg()};lb.prototype.Ygj=function(){this.Epa=(new oa.a).create();this.Epa.message=CommonUIStrings.l_ImageUploadWait;this.Epa.hc=5;this.Epa.lu=!1;this.Epa.Qya(null,null,null)};lb.prototype.sMg=function(){this.Epa&&(this.Epa.close(),this.Epa=null)};lb.DQh=function(T,Oa){T=Jg.a.$m(T);for(var Eb=0;Eb<Oa.length;++Eb)if(T.endsWith(Oa[Eb]))return!0;return!1};lb.Wza=function(T,Oa){Oa=void 0===Oa?null:Oa;Oa||(Oa=lb.tbe);return T?lb.DQh(T,
Oa)?0:2:1};Ll.Object.defineProperties(lb.prototype,{IH:{configurable:!0,enumerable:!0,get:function(){return ad.AFrameworkApplication.xa.MC}}});lb.tbe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(od.a)(lb,"PictureUploader",Wa,[]);var Dd=b(671),ie=b(569),xe=b(140),Lf=b(40),ph=b(1168),Sf=xe.a;Em(ha,Sf);ha.prototype.validate=function(){this.tj.aG||mc.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.tj.aG.value?!0:(ha.Qy(CommonUIStrings.l_FileUploadNoFileSpecified),
!1)};ha.prototype.qsi=function(T){this.njg&&(this.tj=this.RPf(T,this.uTb))};ha.prototype.lBi=function(){this.tj&&this.tj.aG&&(this.JZd||(this.tj.NQi(Object(za.a)(this,this.qtd,"onFileChosen")),this.JZd=!0),this.tj.aKe())};ha.prototype.qtd=function(T){this.uUa.uploadStatusLabel=T;this.Svc(this.titleText,Object(za.a)(this,this.zac,"insertDialogHandler"),this.uUa)};ha.prototype.zac=function(T){1===T&&this.isEnabled()?ha.Cx&&this.tj.aG&&!this.tj.aG.value?(this.uUa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,
this.Svc(this.titleText,Object(za.a)(this,this.zac,"insertDialogHandler"),this.uUa)):(this.Ztb(),this.uTb.finalizeUpload(this.tj,Object(za.a)(this,this.dispose,"dispose"))):T||this.hide()};ha.prototype.SPf=function(){this.CCc=!1;this.tj=this.RPf(document.getElementById("uploadFrameContainer"),this.uTb);ad.AFrameworkApplication.ha.sa("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Vea=Object(za.a)(this,this.$ud,"onUploadFrameLoad"),Lf.a.addHandler(this.tj.iFrame,"load",this.Vea));this.tj.aG||mc.ULS.sendTraceTag(25798092,
322,15,"UploadFrame.FileInputElement is null");this.Vyf()};ha.prototype.$ud=function(){this.Vyf()};ha.prototype.Vyf=function(){if(this.tj&&!this.CCc){var T=this.tj.aG;T&&(Lf.a.addHandler(T,Gc.a.Qb,Object(za.a)(this,this.onKeyDown,"onKeyDown")),T=[T],this.Im=T.concat.apply(T,this.Im),this.O2f(),this.CCc=!0)}};ha.prototype.dispose=function(){if(this.tj&&!ha.Cx){var T=this.tj.aG;T&&Lf.a.removeHandler(T,Gc.a.Qb,Object(za.a)(this,this.onKeyDown,"onKeyDown"));this.Vea&&Lf.a.removeHandler(this.tj.iFrame,
"load",this.Vea)}this.tj=null;Sf.prototype.dispose.call(this)};ha.prototype.O2f=function(){if(0<this.Im.length){var T=new ph.a(this.Im),Oa=ob.FocusManager.instance().wP();Oa&&(this.Im[0].focus(),Oa.$e=T,Oa.lZ=!0)}};ha.prototype.onKeyDown=function(T){4!==ob.FocusManager.instance().Xyf(T)&&T.preventDefault()};ha.Qy=function(T){var Oa=document.getElementById("errorText");Oa.innerText=T;Oa.style.display="inline-block"};Ll.Object.defineProperties(ha.prototype,{Szj:{configurable:!0,enumerable:!0,get:function(){return this.uTb}}});
Ll.Object.defineProperties(ha,{Cx:{configurable:!0,enumerable:!0,get:function(){return ad.AFrameworkApplication.xa.Xa.qu&&ad.AFrameworkApplication.xa.Xa.E7e}}});Object(od.a)(ha,"InsertFileDialog",xe.a,[]);Ll.Object.defineProperties(Tb,{tf:{configurable:!0,enumerable:!0,get:function(){return xe.a.$i(Tb.Jj,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});Tb.Jj="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(od.a)(Tb,"InsertImageDialogHtml",null,[]);Em(kb,ha);kb.prototype.validate=function(){this.tj.aG||mc.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var T=Object(Nb.a)(lb,this.Szj),Oa=T.E4f(this.tj.aG.value);return Oa?(ha.Qy(T.kQe(Oa)),!1):!0};Ll.Object.defineProperties(kb.prototype,{TTb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},
v2g:{configurable:!0,enumerable:!0,get:function(){return Tb.tf}}});Object(od.a)(kb,"InsertImageDialog",ha,[]);var Zg=b(572),Bh=b(87),ti=b(186),ci=b(78),fi=b(411);db.prototype.O1e=function(){this.tR=Sg.a.create().toString();this.Poa?this.K2c():this.yie()};db.prototype.$Rg=function(T){this.An=document.createElement("iframe");this.An.className=T;this.An.id=T;this.l_d&&(this.An.style.visibility="visible",this.An.style.height="30px",this.An.setAttribute("frameborder","0"));this.Vea=Object(za.a)(this,this.$ud,
"onUploadFrameLoad");Lf.a.addHandler(this.An,"load",this.Vea)};db.prototype.D2b=function(T){var Oa=this;ad.AFrameworkApplication.xa.ACb();if(!this.pq)return mc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";Lf.a.addHandler(this.pq,"change",function(){Oa.clh(T)});Na(Object(za.a)(this,this.aKe,"fileInputClick"),1,"DoFileOpenDialog");return this.pq.value};db.prototype.clh=function(T){T&&T(this.pq.value)};db.prototype.dlh=function(){this.pOb&&(this.pOb.innerText=this.vRe())};db.prototype.NQi=
function(T){var Oa=this;Lf.a.addHandler(this.pq,"change",function(){T(Oa.vRe())})};db.prototype.vRe=function(){var T=null;if(this.pq.value){var Oa=this.pq.value,Eb=Oa.lastIndexOf("\\");0<Eb&&(T=Oa.substring(Eb+1,Oa.length))}return T?T:""};db.prototype.aKe=function(){try{mc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.pq.click()}catch(T){throw mc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",T.message),T;}};db.prototype.Hmj=
function(){this.g6h()?this.HWf():(this.qRd(),this.Rr.submit())};db.prototype.g6h=function(){return(this.veg||this.Poa)&&!(void 0===window.self.FormData||null===window.self.FormData)};db.prototype.sMf=function(T){if(T){var Oa=this.Eue();this.Ig=new XMLHttpRequest;this.Ig.open("POST",Oa);this.Ig.setRequestHeader("X-CorrelationId",this.tR);this.Ici(T);this.Ig.onreadystatechange=Object(za.a)(this,this.Sma,"uploadResponseReceived");this.Ig.send(T)}};db.prototype.Ici=function(T){if(!hf.a.aA&&T.get){var Oa=
T.get("ImageId");T=window.self.navigator;var Eb={};Oa=(Eb.CorrelationId=this.tR,Eb.Canary=ad.AFrameworkApplication.canary,Eb.ImageNodeId=Oa,Eb);T&&(T=T.connection?T.connection:T.mozConnection?T.mozConnection:T.webkitConnection?T.webkitConnection:null)&&(Oa.effectiveType=T.effectiveType,Oa.downlink=T.downlink,Oa.type=T.type,Oa.rtt=T.rtt);mc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Oa)}};db.prototype.HWf=function(){try{this.qRd();mc.ULS.sendTraceTag(594888409,322,
50,"SubmitFormWithRequest is preparing to send an upload request");var T=new (Type.parse("FormData"))(this.Rr);this.sMf(T)}catch(Oa){mc.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Oa.message),this.Y6a(null)}};db.prototype.GWf=function(T){try{if(this.qRd(),mc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.ZAj(T)){this.qOb=T;this.Rr.contains(this.pq)&&this.Rr.removeChild(this.pq);var Oa=new (Type.parse("FormData"))(this.Rr);
Oa.append("applicationfileInput",T.blob,T.filename);this.sMf(Oa)}else this.Y6a(null)}catch(Eb){mc.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+Eb.message),this.Y6a(null)}};db.prototype.ZAj=function(T){return T&&void 0!==T.blob&&null!==T.blob&&void 0!==T.filename&&null!==T.filename&&""!==T.filename?void 0===window.self.FormData||null===window.self.FormData?(mc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(T=T?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",
void 0===T.blob||null===T.blob,void 0===T.filename||null===T.filename||""===T.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",mc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",T)),!1)};db.prototype.Sma=function(){if(4===this.Ig.readyState)if(200===this.Ig.status){mc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.tR);var T=this.Ig.getResponseHeader("X-NewKey"),
Oa=this.M_h(this.Ig),Eb=!1;if(void 0!==T&&null!==T&&Oa&&(Eb=this.QAj(T),!this.YMc&&Eb)){mc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.tR);this.YMc=!0;void 0!==this.qOb&&null!==this.qOb?this.GWf(this.qOb):this.HWf();return}mc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.YMc,
Oa,!(void 0===T||null===T),Eb,this.tR);this.Y6a(this.Ig.responseText)}else mc.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Ig.status,this.Ig.responseText?!1:!0,this.tR),this.Y6a(null)};db.prototype.M_h=function(T){try{var Oa=Ke.a(T.responseText).Responses;if(void 0!==Oa&&null!==Oa&&1===Oa.length){var Eb=Oa[0];if(void 0!==Eb&&null!==Eb&&2===Eb.length&&28===Eb[1].StatusCode)return!0}}catch(vc){}return!1};db.prototype.QAj=function(T){fi.a.O1f(T);
return ad.AFrameworkApplication.canary!==T?!1:!0};db.prototype.qRd=function(){this.ZMc||(this.ZMc=new Date)};db.prototype.dispose=function(){this.hm||(this.Poa?this._parent.removeChild(this.Rr):(this._parent.removeChild(this.An),Lf.a.removeHandler(this.An,"load",this.Vea),this.Vea=null),this.BCc&&(Lf.a.removeHandler(this.pq,"change",this.BCc),this.BCc=null),this.bKe&&(this.jfb&&(Lf.a.removeHandler(this.pq,"change",this.jfb),this.jfb=null),this.pOb=null),this.pq=this.Rr=this._parent=this.An=null,this.hm=
!0,this.ZMc=null,mc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};db.prototype.delayedDispose=function(){this.dispose()};db.prototype.EUg=function(T){if(this.Rr){var Oa;(Oa=this.Rr.querySelector("input[name=__REQUESTDIGEST]"))?Oa.value=T:(Oa=this.qZc(),Oa.type="hidden",Oa.id="__REQUESTDIGEST",Oa.name="__REQUESTDIGEST",Oa.value=T,this.Rr.appendChild(Oa))}};db.prototype.qZc=function(){return this.Poa?document.createElement("input"):this.An.contentWindow.document.createElement("input")};
db.prototype.$ud=function(){try{if(!this.An.contentWindow.document.body)return}catch(vc){this.CPh();return}if(!(this._initialized||this.K5a&&hf.a.gE))this.K2c();else if(!this.K5a||!hf.a.gE||this.q3h){var T=hf.a.jf?this.An.contentWindow.document.body.innerText:this.Z3f?this.An.contentWindow.document.body.firstChild.innerText:this.An.contentWindow.document.body.firstChild.innerHTML;var Oa=this.An.contentWindow.document.body.innerText.toLowerCase(),Eb=0<=Oa.indexOf("responses")||0<=Oa.indexOf("wopisrc");
Oa=0<=Oa.indexOf("http error");!Eb&&Oa&&mc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.An.contentWindow.document.body.innerText);this.Y6a(T)}};db.prototype.K2c=function(){if(!this._initialized){var T=this.da("uploadForm"),Oa=this.da("fileInput"),Eb=this.Eue();this.jUg();this.Rr.id=T;this.Rr.method="post";this.Rr.encoding="multipart/form-data";this.Rr.action=Eb;this.pq.type="file";this.nUd&&(this.pq.accept=this.nUd,this.nWd&&(this.pq.capture=this.nWd));
this.pq.id=Oa;this.pq.name=Oa;this.wwg&&(this.pq.multiple=!0);!this.bKe||hf.a.jf||hf.a.IG||(this.jfb=Object(za.a)(this,this.dlh,"fileInputChangedHandleAccessibility"),Lf.a.addHandler(this.pq,"change",this.jfb),this.pOb=Bh.a.uie(this.Rr,this.pq,"InputFileDescription"));this.l_d&&(this.Poa||(T=this.An.contentWindow.document.body,T.style.margin="0",T.style.overflow="hidden"),T=ad.AFrameworkApplication.xa,this.pq.style.fontFamily=T.L_,this.pq.style.fontSize=T.hvc,this.pq.style.margin="0");(T=document.getElementById("__REQUESTDIGEST"))&&
this.EUg(T.value);this.Rr.appendChild(this.pq);this._initialized=!0;this.ceg(this)}};db.prototype.jUg=function(){if(this.Poa)this.Rr=document.createElement("form"),this._parent.appendChild(this.Rr),this.pq=document.createElement("input");else{this.Rr=this.An.contentWindow.document.createElement("form");var T=this.An.contentWindow.document;T.body.appendChild(this.Rr);this.pq=T.createElement("input")}};db.prototype.yie=function(){this._parent.appendChild(this.An);this.K5a&&hf.a.gE&&this.K2c()};db.prototype.Eue=
function(){var T=new Pe.QueryStringBuilder(this.gKe);ad.AFrameworkApplication.Ujb(T);this.j6i(T);T=T.toString();if(hf.a.uf||hf.a.gE||hf.a.IG)T=ci.a.L7c(T);return T};db.prototype.Gde=function(){var T=new Ig.a(2,1,0,Object(za.a)(this,this.delayedDispose,"delayedDispose"),4);ad.AFrameworkApplication.sj.kh(T)};Ll.Object.defineProperties(db.prototype,{zIf:{configurable:!0,enumerable:!0,get:function(){return this.zig}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.XKc}},iFrame:{configurable:!0,
enumerable:!0,get:function(){return this.An}},aG:{configurable:!0,enumerable:!0,get:function(){return this.pq}},K5a:{configurable:!0,enumerable:!0,get:function(){return ad.AFrameworkApplication.ha?ad.AFrameworkApplication.ha.sa("NativeFileOpenDialogIsEnabled"):!1}},bKe:{configurable:!0,enumerable:!0,get:function(){return ad.AFrameworkApplication.ha?ad.AFrameworkApplication.ha.sa("FileInputDescriptionAccessibilityIsEnabled"):!1}},q3h:{configurable:!0,enumerable:!0,get:function(){return this.Poa?!1:
ti.a(this.An.contentWindow.location.pathname,this.gKe,0)}},wwg:{configurable:!0,enumerable:!0,get:function(){return!hf.a.aA&&ad.AFrameworkApplication.ha?ad.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleImageInsertFromLocalIsEnabled",!1)&&ad.AFrameworkApplication.ha.sa("AllowMultipleImageInsertFromLocalDevice"):!1}}});Object(od.a)(db,"UploadFrame",null,[6]);Em(eb,db);eb.prototype.da=function(T){return T};eb.prototype.j6i=function(T){mc.ULS.shipAssertTag(528345168,
0,!!this.sessionId,"SessionId shouldn't be null.");xd.a.UQc(T,this.$.ya);T.k8(mf.a.sessionId,this.sessionId);var Oa=Bf.g(this.$).ga;Oa=Xe.o(Oa.wa.c3,this.$);T.k8(mf.a.DKi,this.$.va.qa.name);T.k8(mf.a.CKi,Oa.FirstRow.toString());T.k8(mf.a.BKi,Oa.FirstColumn.toString())};eb.prototype.CPh=function(){this.zIf("ServerUploadError")};eb.prototype.Y6a=function(T){this.zIf(T)};eb.D1h=function(T){return If.a.ma(T)||If.a.equals(T,"ServerUploadError",!1)};Object(od.a)(eb,"UploadFrameWrapper",db,[]);Em(Fa,kb);
Fa.prototype.RPf=function(T,Oa){return new eb(T,Object(za.a)(Oa,Oa.pBb,"onUploadFrameInitialized"),Object(za.a)(Oa,Oa.Sma,"uploadResponseReceived"),this.ha,!0,this.$)};Fa.prototype.dispose=function(){this.xvc();this.nu=this.zwc=null;kb.prototype.dispose.call(this)};Fa.prototype.hide=function(){kb.prototype.hide.call(this);this.$.zb.xJ=!1};Fa.prototype.validate=function(){var T=this.zwc.aSd(this.tj.aG.value,this.zwc.P_f(this.tj));return T?(T=this.zwc.i9c(T).Description,this.EQd(T),this.LMd(),!1):!0};
Fa.prototype.isEnabled=function(){return!0};Fa.prototype.EQd=function(T){this.xT.innerHTML=T};Fa.prototype.gU=function(){this.xT=document.getElementById("errorText");this.xT.style.display="inline-block";this.dza=!1;this.EQd("");this.mGa.style.maxWidth=this.mGa.currentStyle.minWidth};Fa.prototype.LMd=function(){this.nu.pa(Gc.a.click,this.tj.aG,Object(za.a)(this,this.mQ,"onDialogInteraction"));this.nu.pa(Gc.a.Qb,this.tj.aG,Object(za.a)(this,this.mQ,"onDialogInteraction"));this.dza=!0};Fa.prototype.xvc=
function(){this.dza&&(this.nu.za(Gc.a.click,this.tj.aG,Object(za.a)(this,this.mQ,"onDialogInteraction")),this.nu.za(Gc.a.Qb,this.tj.aG,Object(za.a)(this,this.mQ,"onDialogInteraction")),this.dza=!1)};Fa.prototype.mQ=function(){this.EQd("");this.xvc();return!1};Object(od.a)(Fa,"InsertImageDialogWrapper",kb,[]);Ga.prototype.getSheetName=function(){return this.sheetName};Object(od.a)(Ga,"MacroRecorderPictureInsertedPayload",null,[115]);Em(Ha,lb);Ha.prototype.Sma=function(T){this.MSd.stop();this.SWb.cancel();
if(eb.D1h(T))this.Auc?this.xXe(4):(T=new Dd.a(0,2,null,null,!1,null,null,null),T.status=8,this.jPd(new ie.a(T),null,"InsertPictureWebMethod")),mc.ULS.sendTraceTag(537155796,0,50,"Http Error occurred, isTimeoutError: {0}",this.Auc);else{var Oa=Ha.aBj(T);Oa?(mc.ULS.sendTraceTag(537155797,0,50,"Server returned error, response: {0}",T),this.xXe(Oa)):this.oPh(T)}this.zjc();this.dispose()};Ha.prototype.dispose=function(){Zh.a.Fa(this.SWb);this.tj&&this.tj.Gde();this.tj=this.SWb=this.ub=null};Ha.prototype.Rri=
function(T){this.Wza(T,this.tj)&&this.finalizeUpload(this.tj,null)};Ha.prototype.pBb=function(T){mc.ULS.sendTraceTag(537155795,0,50,"Upload frame initialized");this.tj=T;if(!this.tZa){if(this.BRd){if(Ha.Xne()||this.K5a&&hf.a.gE){T.D2b(Object(za.a)(this,this.Rri,"onFileChosen$2"));return}var Oa=T.D2b(null);if(!this.Wza(Oa,T))return}this.finalizeUpload(T,null)}};Ha.prototype.finalizeUpload=function(T,Oa){var Eb=this;lb.prototype.finalizeUpload.call(this,T,Oa);Dg.a(this.$.userOperationManager,function(vc,
gd){Eb.Oq=vc;Eb.O9=gd;Eb.MSd.start();Eb.SWb.kq();Eb.Auc=!1;Eb.h_f(T);return Eb.VNi(T)},function(vc){function gd(){return new Ga(Fd,Eb.zwd?Eb.zwd:"")}var Cd={};Eb.$.Mj(Cd);var Fd=Cd.SheetName;vc=Se.EwaSettings.pc()?new Ud.a(510,0,vc,72,gd):new qd.a(510,0,vc,8,gd);vc.mPa(function(){return!0});vc.Zd=Eb.Zd;return vc},this.Zd)};Ha.prototype.VNi=function(T){function Oa(){vc.Lu(!0)}var Eb=this;if(!this.$)return mc.ULS.sendTraceTag(537155794,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),je.Task.Ra(!0);
if(!this.$.U$)return je.Task.Ra(!0);var vc=new vg.a,gd=new FileReader;T=T.aG.files[0];gd.onload=function(){Eb.zwd=gd.result;vc.Lu(!0)};gd.onerror=Oa;gd.onabort=Oa;gd.readAsDataURL(T);return vc.task};Ha.prototype.P_f=function(T){var Oa=-1;(T=T.aG)&&T.files&&0<T.files.length&&(Oa=T.files[0].size);return Oa};Ha.prototype.aSd=function(T,Oa){var Eb=Ha.$Qg(lb.Wza(T));Eb?6===Eb&&this.uei(T):-1!==Oa&&(mc.ULS.sendTraceTag(537155793,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",
Oa,this.fpd,this.$.fa.Z$e),Oa>this.fpd?Eb=3:Oa>this.$.fa.Z$e&&(Eb=7));mc.ULS.sendTraceTag(537155792,0,50,"Validated file on client, validation result: {0}",Eb);return Eb};Ha.prototype.Wza=function(T,Oa){return(T=this.aSd(T,this.P_f(Oa)))?(this.tZa||1===T||this.lTf(T),!1):!0};Ha.prototype.h_f=function(T){T.Hmj()};Ha.prototype.i9c=function(T){var Oa=0,Eb=1,vc=-1100324317,gd="InsertPictureUnknownError",Cd=null;switch(T){case 1:Oa=1682;Eb=0;vc=940870981;gd="InsertPictureNoFileSelected";break;case 3:Eb=
0;vc=1250467391;gd="InsertPicturePictureTooBig";Cd=String.format(Hf.a.instance.Bb(170),this.zgi.toLocaleString());break;case 6:Oa=1686;Eb=0;vc=1380041209;gd="InsertPictureUnsupportedFormat";break;case 7:Oa=1683;Eb=0;vc=-903115058;gd="InsertPictureExceedWorkbookSize";break;case 4:Oa=1684;Eb=0;vc=1218352119;gd="InsertPictureUploadTimeout";break;case 5:Oa=1685,Eb=0,vc=1979899005,gd="InsertPictureServiceNonDeterministicError"}T=Ha.gd(Oa,Eb,vc,gd);Cd&&(T.Description=Cd);return T};Ha.prototype.showDialog=
function(){Ha.Xne()?(this.tZa=!1,this.tj=new eb(this.$.domElement,Object(za.a)(this,this.pBb,"onUploadFrameInitialized"),Object(za.a)(this,this.Sma,"uploadResponseReceived"),this.ha,!1,this.$,!0)):(mc.ULS.sendTraceTag(537155790,0,50,"Showing Insert Picture dialog"),!this.Fwb&&(hf.a.pu||hf.a.gE&&72>hf.a.gqe)?(this.tZa=!1,this.tj=new eb(this.$.domElement,Object(za.a)(this,this.pBb,"onUploadFrameInitialized"),Object(za.a)(this,this.Sma,"uploadResponseReceived"),this.ha,!1,this.$)):(this.tZa=!0,this.tj=
(new Fa(this,this.$,this.ha)).tj))};Ha.prototype.oPh=function(T){var Oa={};try{if(Oa=Ah.a.Xh(T),zf.b().iB(this.MSd.id,Oa.ServerCorrelationId,"actions","ServerActions"),!qc.a.Zg(Oa.Errors)&&Oa.Result){this.$.fa.kW(Oa.StateId,"PictureUploaderWrapper.UploadResponseReceived");var Eb=Oa.Result;ze.a(this.$).ula(1,Eb);var vc=this.$.ea.Ba(277);vc&&vc.HOc(this.$,1,Oa.Result,Oa,"InsertPicture");mc.ULS.sendTraceTag(537155789,0,50,"Insert picture completed successfully :)")}}catch(gd){mc.ULS.sendTraceTag(537155788,
0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",T?T.length:-1,gd)}this.Xuc(Oa,null,"InsertPictureWebMethod")};Ha.prototype.xXe=function(T){T={Errors:[this.i9c(T)]};this.Xuc(T,null,"InsertPictureWebMethod")};Ha.prototype.Xuc=function(T,Oa,Eb){this.Oq(T,Oa,Eb)};Ha.prototype.jPd=function(T,Oa,Eb){this.O9(T,Oa,Eb)};Ha.prototype.lTf=function(T){T=this.i9c(T);Se.EwaSettings.eA()?new tb.a(this.$,T):(new pa.ErrorDialog(this.$,T)).mf()};
Ha.prototype.HAi=function(){this.Auc=!0};Ha.prototype.uei=function(T){var Oa=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;T=Jg.a.$m(T);for(var Eb=0;Eb<Oa.length;++Eb)if(T.endsWith(Oa[Eb])){mc.ULS.sendTraceTag(537155787,0,50,"Insert picture blocked invalid extension: {0}",Oa[Eb]);break}};Ha.aBj=function(T){return If.a.ma(T)||If.a.equals(T,mf.a.insertPictureUnknownError,!0)?2:If.a.equals(T,mf.a.insertPictureNoFileSelectedError,!0)?1:If.a.equals(T,mf.a.KXh,!0)?3:If.a.equals(T,mf.a.LXh,!0)?5:
0};Ha.gd=function(T,Oa,Eb,vc){return qc.a.gd(1,0,0,T,Oa,Eb,vc)};Ha.$Qg=function(T){switch(T){case 1:return 1;case 2:return 6}return 0};Ha.Xne=function(){return Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};Ll.Object.defineProperties(Ha.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ub}},zgi:{configurable:!0,enumerable:!0,get:function(){return this.fpd/1024/1024}}});
Object(od.a)(Ha,"PictureUploaderWrapper",lb,[6]);Em(mb,Ha);mb.prototype.jPd=function(T,Oa,Eb){Ha.prototype.jPd.call(this,T,Oa,Eb);this.C_.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};mb.prototype.Xuc=function(T,Oa,Eb){Ha.prototype.Xuc.call(this,T,Oa,Eb);qc.a.Zg(T.Errors)?this.C_.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",qc.a.Uc(T.Errors)))):this.C_.setResult(!0)};
mb.prototype.h_f=function(T){var Oa=new Ra(this.V$b.name,this.V$b);T.GWf(Oa)};mb.hrh=function(T){var Oa=T.split(",");T=0<=Oa[0].indexOf("base64")?window.self.atob(Oa[1]):window.self.decodeURI(Oa[1]);Oa=Oa[0].split(":")[1].split(";")[0];for(var Eb=new Uint8Array(T.length),vc=0;vc<T.length;vc++)Eb[vc]=T.charCodeAt(vc);T=new Blob([Eb],{type:Oa});T.name="Image.png";return T};Object(od.a)(mb,"DataUrlUploaderWrapper",Ha,[]);var $h=b(575),Th=b(303),mg=b(178),rg=b(170),af=b(91),de=b(1235),Fi=de.a;Em(Ka,Fi);
Ka.prototype.mmc=function(T,Oa){this.isEnabled()&&this.CDa(this.targetOrigin)&&(this.En(T),this.xm(T,Oa))};Object(od.a)(Ka,"InsertMediaCrossDocumentMessenger",de.a,[337,266,6]);Object(od.a)(ta,"OnlineMediaSearchResult",null,[]);var f=b(305),hb=xe.a;Em(ea,hb);ea.prototype.Lgj=function(T){var Oa=this;this.Zbc=!1;this.showDialog(this.Kn,null);this.vua=document.getElementById(this.Yh("InsertMediaFrame"));if(!this.vua)throw this.Csa(this.Vlb),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Eb=
document.getElementById(this.Yh("WACDialogPanel"));Eb&&Eb.setAttribute(Bh.a.Od,Bh.a.AWa);Eb=document.createElement("div");Eb.id="KeepFocusStartDiv";Eb.tabIndex=0;Eb.className="keep-focus-start";this.vua.parentNode.insertBefore(Eb,this.vua.parentNode.firstChild);Eb=document.createElement("div");Eb.id="KeepFocusDiv";Eb.tabIndex=0;Eb.className="keep-focus";this.vua.parentNode.appendChild(Eb);$addHandler(this.mGa,"keydown",Object(za.a)(this,this.zld,"keyDownHandler"));this.vua.src=this.Z1e;this.vua.frameBorder=
"0";Eb=document.getElementById(this.Yh("WACDialogButtonPanel"));if(!Eb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Eb.className="display-none";Eb=document.getElementById(this.Yh("WACDialogTitleText"));if(!Eb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Eb.className="display-none";2===this.Gff&&(document.getElementById(this.Yh("WACDialogTitlePanel")).className="display-none",document.getElementById(this.Yh("WACDialogBodyPanel")).className="padding-zero");
ob.FocusManager.instance().wP().scope.ZP=!0;this.yQ=new Ka(this.vua.contentWindow,this.Z1e);this.yQ.mmc(mg.a.Xog,function(vc){Oa.Tni(vc,Object(za.a)(T,T.Sma,"uploadResponseReceived"))});this.yQ.mmc(mg.a.insert,function(){Oa.Qui(Object(za.a)(T,T.Sma,"uploadResponseReceived"))});this.yQ.mmc(mg.a.jUc,Object(za.a)(this,this.Toi,"onCancelDialog"));2!==this.Gff||this.w2g||(this.yQ.mmc(mg.a.y$h,Object(za.a)(this,this.xvi,"onLaunchM365Upsell")),this.Kxb=this.Vkb.ONa("MsoPremiumStockImages",function(vc){mc.ULS.sendTraceTag(537155811,
0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(vc.isEnabled){var gd={};Oa.yQ.Vj(mg.a.Mzj,(gd.LicenseTier=vc.toString(),gd))}else mc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};ea.prototype.dispose=function(){this.pya=null;this.Vkb&&this.Kxb&&this.Vkb.uBd("MsoPremiumStockImages",this.Kxb);this.yQ&&(this.yQ.dispose(),this.yQ=null);hb.prototype.dispose.call(this)};ea.prototype.hide=function(){hb.prototype.hide.call(this);
af.a.xqc(this.$)};ea.prototype.Tni=function(T,Oa){T=T&&T.Values?(T=T.Values)?Object.assign(new ta,{Action:T.action||"",Caption:T.caption||"",ContentType:T.contentType||"",FileExtension:T.extension||"",PageUrl:T.pageUrl||"",SourceUrl:T.sourceUrl||"",ThumbnailUrl:T.thumbnailUrl||"",LicenseUrl:T.licenseUrl||"",LicenseDisplayName:T.licenseDisplayName||"",Height:T.height||0,Width:T.width||0}):null:null;T&&(Array.add(this.pya,T),this.Zbc&&(mc.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),
Oa(this.pya),this.Zbc=!1,this.Csa(this.Vlb)))};ea.prototype.Toi=function(){this.Csa(this.Vlb)};ea.prototype.Qui=function(T){this.pya&&0<this.pya.length?this.pya.length<=this.yhe?(T(this.pya),this.Csa(this.Vlb)):(this.Qy(),mc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.pya)):this.Zbc=!0};ea.prototype.zld=function(T){T.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==T.target.id||T.shiftKey?"KeepFocusStartDiv"===T.target.id&&T.shiftKey&&
(T.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(T.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};ea.prototype.SUg=function(){var T=document.createElement("div");T.id="InsertMediaDialog";T.className=Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var Oa=document.createElement("div");Oa.id="InsertMediaPanel";Oa.className=Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",
!0)?"insert-media-panel":"insert-media-panel-old";var Eb=document.createElement("iframe");Eb.id="InsertMediaFrame";Eb.className="insert-media-frame";T.appendChild(Oa);Oa.appendChild(Eb);return f.b(T)};ea.prototype.xvi=function(){this.Vkb&&(this.Vkb.launchUpsellExperience("stockimages"),mc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};ea.prototype.Qy=function(){var T=qc.a.gd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");T.Description=String.format(Hf.a.instance.Bb(195),
this.yhe.toLocaleString());Se.EwaSettings.eA()?new tb.a(this.$,T):(new pa.ErrorDialog(this.$,T)).mf()};Ll.Object.defineProperties(ea.prototype,{d3:{configurable:!0,enumerable:!0,get:function(){return rg.a.V1b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(od.a)(ea,"InsertMediaDialog",xe.a,[]);var ec=b(452),$c=b(372);Em(ab,lb);ab.prototype.Sma=function(T){var Oa=this;if(T){for(var Eb=Array(T.length),vc=0;vc<T.length;vc++){var gd=T[vc];Eb[vc]=
{};Eb[vc].SourceUrl=gd.SourceUrl;Jg.a.Qua(gd.LicenseUrl)&&Jg.a.Qua(gd.PageUrl)&&(Eb[vc].LicenseUrl=gd.LicenseUrl,Eb[vc].LicenseDisplayName=gd.LicenseDisplayName,Eb[vc].PageUrl=gd.PageUrl);Eb[vc].AltText=-2053056795===this.Zd.command?gd.Caption:""}var Cd=-2009825598===this.Zd.command?"bing":"M365";vc=Bf.g(this.$);var Fd=Xe.o(vc.ga.wa.activeCell,this.$);Dg.a(this.$.userOperationManager,function($d,Ae,$e){return bc.L(Oa.$.ra.ua,Fd,Eb,Cd,Lg.b($d,Object(za.a)(Oa,Oa.nxi,"onPictureUploadSuccess")),Lg.a(Ae,
Object(za.a)(Oa,Oa.mxi,"onPictureUploadFailed")),$e,null)},function($d){return new Ud.a(595,0,$d)},this.Zd);Sd.HelperMethods.TY?(vc=new Map,vc.set("MediaProvider",Cd),vc.set("ImagesCount",T.length.toString()),vc.set("TimeTakenToOpenDialog",this.sdf.toString()),Ub.Health.instance.recordKpiUsage($c.a.HXh,1,ec.a.fuc,vc)):mc.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.zjc()}else mc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
ab.prototype.dispose=function(){this.$=null};ab.prototype.showDialog=function(){var T=this,Oa=null;Oa=this.$.Vb.Dc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Zd.command){case -2009825598:this.Vfj();break;case -2053056795:this.cie.execute(function(Eb){Eb.isFeatureEnabled("MsoPremiumStockImages",!1).catch(function(vc){return mc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",vc)}).then(function(vc){T.Wfj(vc);
return null})})}Oa.stop();this.sdf=Oa.Cc};ab.prototype.Vfj=function(){var T=this.$.ya.BingPictureEndpoint,Oa=$h.a.eJ(ad.AFrameworkApplication.lcid),Eb=Sg.a.create();If.a.ma(T)?(mc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.C_.setException(Error.create("Failed to access the Bing service endpoint"))):(T=0<T.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(T,1,1):String.format(T,1,ad.AFrameworkApplication.lcid,
Oa?Oa.name:"en-us",ad.AFrameworkApplication.buildVersion,Eb.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.Z_b(T,1,-1,Hf.a.instance.da(1688)))};ab.prototype.Wfj=function(T){var Oa=this.$.ya.M365PictureEndpoint,Eb=Sg.a.create();if(If.a.ma(Oa))mc.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.C_.setException(Error.create("Failed to access the M365 service endpoint"));else{var vc=this.$.ya.DocumentHostInfo.UserId;
vc=If.a.ma(vc)?"0":Jg.a.jv(vc).toString();var gd=this.cie.instance.isFreemiumUpsellEnabled();T=T?1:gd?0:-1;Eb=Eb.toString();gd=$h.a.eJ(ad.AFrameworkApplication.lcid).name;Oa=String.format(Oa,ad.AFrameworkApplication.lcid,gd,ad.AFrameworkApplication.buildVersion,Eb,1,vc,T,1);this.Z_b(Oa,2,T,Hf.a.instance.da(1687))}};ab.prototype.Z_b=function(T,Oa,Eb,vc){try{(new ea(this.$,T,Ef.a.instance.Mh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Oa,Eb,vc)).Lgj(this),this.C_.setResult(!0)}catch(gd){mc.ULS.sendTraceTag(537155802,
0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",gd,Oa,Eb),this.C_.setException(gd)}};ab.prototype.nxi=function(T){Th.a(T)?mc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",qc.a.Uc(T.Errors)):(mc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),T.Result?ze.a(this.$).ula(1,T.Result):
mc.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};ab.prototype.mxi=function(){mc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};Object(od.a)(ab,"OnlinePictureUploaderWrapper",lb,[6]);Ya.prototype.executeCommand=function(T,Oa,Eb){T=Oa.command;switch(T){case 1403967063:if(Eb&&"dataUrl"in Eb)return Oa=new vg.a,new mb(this.$,null,kg.a.instance,ad.AFrameworkApplication.ha,Eb,Eb.dataUrl,
Oa),Oa.task;new Ha(this.$,Oa,kg.a.instance,ad.AFrameworkApplication.ha,Eb);return je.Task.Ra(!0);case -2053056795:case -2009825598:return T=new vg.a,new ab(this.$,Oa,kg.a.instance,ad.AFrameworkApplication.ha,Eb,T),T.task;default:return Rf.a(T)}};Ya.prototype.Ec=function(T,Oa){if(T=this.$.isEditMode)switch(Oa.command){case 1403967063:T=!0;break;case -2053056795:T=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;case -2009825598:T=(T=Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures"))&&
Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertBingPictures",!1);break;default:T=!1}return T};Ya.prototype.Yc=function(){return!1};Ya.prototype.Wc=function(){return!1};Object(od.a)(Ya,"PictureCommandHandler",null,[160]);var be=Of.a;Em(xb,be);xb.prototype.Gd=function(){this.Ad([new Ya(this.$)])};xb.ja=function(T){Of.a.Yd(90,new xb(T))};Object(od.a)(xb,"PictureCommandHandlerFactory",Of.a,[]);var ve=b(509),De=b(403),Me=b(74),sf=b(551),tg=b(597),uf=sf.a;Em(pb,uf);pb.prototype.wId=
function(T){this.noa!==T&&(this.noa=T,this.ZCb())};pb.prototype.dispose=function(){this.gridView.Gc.ym(Object(za.a)(this,this.Bkf,"onCellTextEditStarted"));this.gridView.Gc.Fr(Object(za.a)(this,this.Akf,"onCellTextEditEnded"));this.gridView=null;uf.prototype.dispose.call(this)};pb.prototype.ZCb=function(){this.hzd(this.noa)};pb.prototype.Akf=function(){this.refresh()};pb.prototype.Bkf=function(){this.refresh()};pb.prototype.refresh=function(){this.wId(!this.gridView.isEditing)};Ll.Object.defineProperties(pb.prototype,
{PG:{configurable:!0,enumerable:!0,get:function(){return this.noa}},name:{configurable:!0,enumerable:!0,get:function(){return tg.a.cellEdit}}});Object(od.a)(pb,"CellEditSafeStatePublisher",sf.a,[]);Object(od.a)(ib,"SafeStatePublisherState",null,[]);var Og=b(645),Tf=Ue.a;Em(Pa,Tf);Pa.prototype.rVb=function(T){this.addHandler(Pa.xOa,T)};Pa.prototype.onc=function(T){this.removeHandler(Pa.xOa,T)};Pa.prototype.Ixa=function(T,Oa){function Eb(Cd,Fd){gd.PG=Fd.PG;vc.kzd()}var vc=this,gd=new ib(T,Oa);this.yOa.add(gd);
T.rVb(Eb);gd.handler=Eb;this.kzd()};Pa.prototype.fQd=function(T){for(var Oa=null,Eb=Ol(this.yOa),vc=Eb.next();!vc.done;vc=Eb.next())if(vc=vc.value,vc.publisher===T){this.t1f(vc);Oa=vc;break}Oa&&(this.yOa.remove(Oa),this.kzd())};Pa.prototype.dispose=function(){for(var T=Ol(this.yOa),Oa=T.next();!Oa.done;Oa=T.next())this.t1f(Oa.value);this.yOa.clear();Tf.prototype.dispose.call(this)};Pa.prototype.dUe=function(){for(var T=!0,Oa=Ol(this.yOa),Eb=Oa.next();!Eb.done&&(Eb=Eb.value,T=T&&Eb.PG,T);Eb=Oa.next());
return T};Pa.prototype.t1f=function(T){T.publisher.onc(T.handler)};Pa.prototype.kzd=function(){var T=this.dUe();T!==this.caf&&(this.raiseEvent(Pa.xOa,new Og.a(T)),this.caf=T)};Ll.Object.defineProperties(Pa.prototype,{svj:{configurable:!0,enumerable:!0,get:function(){return pg.f(pg.c(this.yOa.toArray(),function(T){return!T.PG}),function(T){return T.publisher.name})}}});Pa.xOa="SSC";Object(od.a)(Pa,"ClientStateMonitor",Ue.a,[]);var Xf=b(6),ia=b(64),u=sf.a;Em(xa,u);xa.prototype.wId=function(T){T!==this.noa&&
(this.noa=T,this.ZCb())};xa.prototype.dispose=function(){ia.a(this.$).Zmc(Object(za.a)(this,this.Flf,"onCurrentActivityChanged"));this.q2a.jq(Object(za.a)(this,this.zM,"onIdleActivityStatusChanged"));this.k0d=null;u.prototype.dispose.call(this)};xa.prototype.ZCb=function(){this.hzd(this.PG)};xa.prototype.refresh=function(){this.wId(1===this.q2a.ht||ia.a(this.$).gi===this.q2a)};xa.prototype.zM=function(){this.refresh()};xa.prototype.Flf=function(){this.refresh()};Ll.Object.defineProperties(xa.prototype,
{PG:{configurable:!0,enumerable:!0,get:function(){return this.noa}},name:{configurable:!0,enumerable:!0,get:function(){return tg.a.q2a}},q2a:{configurable:!0,enumerable:!0,get:function(){return this.k0d}}});Object(od.a)(xa,"IdleActivitySafeStatePublisher",sf.a,[]);var m=b(307),K=b(3),ka=Me.a;Em(ma,ka);ma.prototype.Wc=function(){return!1};ma.prototype.executeCommand=function(){return je.Task.Ra(!0)};ma.prototype.Ec=function(T,Oa){return 1905775613===Oa.command};ma.prototype.Yc=function(){return!1};
Object(od.a)(ma,"ToggleMergeSuspensionSafeState",Me.a,[160]);var ja=Ue.a;Em(na,ja);na.prototype.Qp=function(T){this.addHandler(na.Lpd,T)};na.prototype.jq=function(T){this.removeHandler(na.Lpd,T)};na.prototype.jx=function(){this.raiseEvent(na.Lpd)};na.prototype.Vm=function(T){return T===na.IKi&&!!this.mergeSuspensionManager};na.prototype.mr=function(T,Oa){if(!this.Vm(T))return!1;this.mergeSuspensionManager&&(Oa.LabelText=this.Tgc,Oa.On=this.grd);return!0};na.prototype.dispose=function(){this.lJb&&
(this.Ka.O8a(this.lJb),this.lJb.dispose(),this.lJb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.v7a.jEb(Object(za.a)(this,this.BAb,"onMergeCounterUpdated")),this.mergeSuspensionManager.kga.onc(Object(za.a)(this,this.AMa,"onSafeStateChanged")),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.xE(this),this.statusBarManager=null);this.Tgc=null;ja.prototype.dispose.call(this)};na.prototype.BAb=function(T,Oa){T=String.format("{0}{1}",Oa.Eaa.Current===Oa.Eaa.Pending?
"\u26ad":"\u26ae",Oa.Eaa.Current);If.a.equals(this.Tgc,T,!1)||(this.Tgc=T,this.jx())};na.prototype.AMa=function(T,Oa){T=Oa.PG;this.grd!==T&&(this.grd=T,this.jx())};na.Lpd="MSMSC";na.IKi="QueryMergeSuspensionStatus";Object(od.a)(na,"MergeSuspensionIndicatorManager",Ue.a,[156,157,6]);var Gb=b(1010),$b=Sys.EventArgs;Em(ca,$b);Object(od.a)(ca,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);var Ac=b(1011),fd=Ue.a;Em(Z,fd);Z.prototype.OUh=function(){return Object(De.a)(Pa,this.kga)?Object(Nb.a)(Pa,
this.kga).dUe():!1};Z.prototype.uVb=function(T){this.addHandler(Z.DOd,T)};Z.prototype.pnc=function(T){this.removeHandler(Z.DOd,T)};Z.prototype.Ytg=function(T){this.addHandler(Z.Ulc,T)};Z.prototype.tVi=function(T){this.removeHandler(Z.Ulc,T)};Z.prototype.gtg=function(T){this.addHandler(Z.Hpd,T)};Z.prototype.OUi=function(T){this.removeHandler(Z.Hpd,T)};Z.prototype.mMi=function(){this.fzd(1===this.getState())};Z.prototype.dispose=function(){this.kga.onc(Object(za.a)(this,this.AMa,"onSafeStateChanged"));
this.kga=null;this.v7a.jEb(Object(za.a)(this,this.BAb,"onMergeCounterUpdated"));this.v7a=null;fd.prototype.dispose.call(this)};Z.prototype.f8b=function(){return Object.assign(new Gb.a,{Current:this.D4.Current,Pending:this.D4.Pending,SuspensionStartTimestamp:this.D4.SuspensionStartTimestamp})};Z.prototype.getState=function(){var T=this.Cnh?(T=this.D4)&&T.SuspensionStartTimestamp&&T.Pending>T.Current:this.D4.Pending!==this.D4.Current;return T?this.PG?2:1:0};Z.prototype.ZKe=function(T,Oa){T!==Oa&&(1===
Oa?this.fzd(!0):1===T&&this.fzd(!1));2===Oa?this.raiseEvent(Z.Ulc,new Ac.a(this.D4)):this.c8g&&this.raiseEvent(Z.Ulc,new Ac.a(null))};Z.prototype.Adi=function(T,Oa,Eb){!T&&Oa?(T=1===Oa,mc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2}",T,T?this.kga.svj.join(","):"",La(this.D4))):T&&!Oa&&mc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: No pending changes. counter: {0}",
La(Eb))};Z.prototype.fzd=function(T){this.raiseEvent(Z.DOd,new ca(T))};Z.prototype.BAb=function(T,Oa){T=this.getState();var Eb=this.D4;this.D4=Oa.Eaa;Oa=this.getState();this.Adi(T,Oa,Eb);this.raiseEvent(Z.Hpd);this.ZKe(T,Oa)};Z.prototype.AMa=function(T,Oa){T=this.getState();this.PG=Oa.PG;Oa=this.getState();this.ZKe(T,Oa)};Z.DOd="TPMBBC";Z.Ulc="RFPMU";Z.Hpd="MCC";Object(od.a)(Z,"MergeSuspensionState",Ue.a,[]);var Pd=Ue.a;Em(U,Pd);U.prototype.tkb=function(T){this.addHandler("MCU",T)};U.prototype.jEb=
function(T){this.removeHandler("MCU",T)};U.prototype.xMa=function(T,Oa){Oa=void 0===Oa?"":Oa;var Eb=this.F0.Current<T.Current||this.F0.Pending<T.Pending;if(T.SuspensionStartTimestamp&&this.lec!==T.SuspensionStartTimestamp){if(this.lec>T.SuspensionStartTimestamp){Eb&&mc.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Oa,U.Gyb(T),U.Gyb(this.F0));return}Eb||mc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",
U.Gyb(T),U.Gyb(this.F0))}else if(!Eb)return;this.F0=T;this.pAf(T)};U.prototype.dispose=function(){this.$.fa.qk(Object(za.a)(this,this.Wpc,"sessionReloadEventHandler"));this.$.fa.tV(Object(za.a)(this,this.Wpc,"sessionReloadEventHandler"));this.$.ra.yt(Object(za.a)(this,this.fAa,"webMethodSuccessEventHandler"));Bf.g(this.$).Gc.Fr(Object(za.a)(this,this.s6a,"onEditCellEnded"));var T=this.$.ea.Ba(292);T&&T.jEb(Object(za.a)(this,this.Hyb,"mergeCounterUpdatedEventHandler"));Pd.prototype.dispose.call(this)};
U.prototype.pAf=function(T){T&&T.SuspensionStartTimestamp&&T.Pending>T.Current&&T.SuspensionStartTimestamp>this.lec&&(mc.ULS.sendTraceTag(537155416,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}",La(T)),this.lec=T.SuspensionStartTimestamp);this.raiseEvent("MCU",new Ac.a(T))};U.prototype.fAa=function(T,Oa){Oa&&Oa.hd&&Oa.hd.MergeCount&&(If.a.equals(Oa.hd.SessionId,this.$.fa.sessionId,!1)?this.xMa(Oa.hd.MergeCount,U.N1c):mc.ULS.sendTraceTag(579737049,
0,50,"Stale merge counter ({0}/{1})",Oa.hd.MergeCount.Current,Oa.hd.MergeCount.Pending))};U.prototype.Hyb=function(T,Oa){Oa&&Oa.Eaa&&this.xMa(Oa.Eaa,U.NSd)};U.prototype.Wpc=function(){this.dIf();this.pAf(this.F0)};U.prototype.dIf=function(){mc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",U.Gyb(this.F0));this.F0=Object.assign(new Gb.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};U.prototype.s6a=function(T,Oa){Oa.Ese&&this.F0.SuspensionStartTimestamp&&
mc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",La(this.F0))};U.Gyb=function(T){return T?String.format("({0}/{1} @{2})",T.Current,T.Pending,T.SuspensionStartTimestamp):"null"};Ll.Object.defineProperties(U.prototype,{D4:{configurable:!0,enumerable:!0,get:function(){return this.F0}}});U.NSd="PMM.RTC";U.N1c="PMM.EwaResult";Object(od.a)(U,"PendingMergeMonitor",Ue.a,[]);Object(od.a)(da,"ClientRevisions",null,[]);var Xd=b(194),Te=b(26);G.prototype.iFi=
function(T){var Oa=this;if(this.IPa(T))(new vg.a).setResult(!0);else{var Eb=this.jFi(T);this.wva=T;this.gvd++;this.agd=!0;Eb.CWCT(function(){Oa.dri()},Xd.a.none,0,this.pN)}};G.prototype.jFi=function(T){function Oa(){mc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottler.performDoPendingMergeInternal: request failed {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp)}var Eb=this.ua.Wb();this.Es();this.mcb=this.Kg.Gb;mc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottler.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}",
T.Current,T.Pending,T.SuspensionStartTimestamp);if(this.wla){var vc=this.wla.ABi();return Y(this.ua,vc,this.eri.bind(this),Oa,null,null,Eb)}return V(this.ua,null,Oa,null,null,Eb)};G.prototype.IPa=function(T){return this.rpj?!this.wva||T.SuspensionStartTimestamp>this.wva.SuspensionStartTimestamp?(this.GJa&&mc.ULS.sendTraceTag(528561877,0,50,"DoPendingMergeThrottler.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp),
!1):this.GJa?!0:ra(T,this.wva)&&this.Kg.Gb.getTime()-this.mcb.getTime()<this.q9a:this.agd?!0:ra(T,this.wva)&&+this.Kg.Gb-+this.mcb<this.q9a};G.prototype.dri=function(){this.gvd--;this.agd=!1};G.prototype.eri=function(T){this.wla&&this.wla.Vni(T.Result,T.StateId)};Ll.Object.defineProperties(G.prototype,{GJa:{configurable:!0,enumerable:!0,get:function(){return 0<this.gvd}}});Object(od.a)(G,"DoPendingMergeThrottler",null,[292]);W.prototype.Kkb=function(T){return T};Object(od.a)(W,"ReturnNewestAggregatorStrategy",
null,[306]);Em(fa,W);fa.prototype.wrb=function(T){return T};fa.prototype.eCb=function(T){if(!T||this.IPa(T)){var Oa=new vg.a;Oa.setResult(!0);return Oa.task}Oa=this.ua.Wb();this.Es();this.mcb=this.Kg.Gb;this.wva=T;mc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottlingStrategy.PerformAction: Sending DoPendingMerge {0}",La(T));return V(this.ua,null,function(){mc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottlingStrategy.PerformAction: request failed {0}",La(T))},null,null,Oa)};fa.prototype.IPa=
function(T){return ra(T,this.wva)&&+this.Kg.Gb-+this.mcb<this.q9a};Object(od.a)(fa,"DoPendingMergeThrottlingStrategy",W,[291]);aa.prototype.Ond=function(){mc.ULS.sendTraceTag(824467,0,50,"AggregateSelectionAdjustStats.LogResults: Didn't change {0} Adjusted {1} Divergence {2} NonContinuous {3} Erros {4}",this.yQc,this.xQc,this.n1c,this.ord,this.errors)};Object(od.a)(aa,"AggregateSelectionAdjustStats",null,[]);L.prototype.h5f=function(T){if(!this.BVd)return mc.ULS.sendTraceTag(528590294,0,10,"Selection.viewportBlocksReadyForAdjust: _blockCacheItems undefined"),
!1;for(var Oa=Ol(this.BVd),Eb=Oa.next();!Eb.done;Eb=Oa.next())if(Eb=Eb.value,Eb.jj&&Eb.ue.Revision<T)return!1;return!0};L.prototype.wqj=function(){var T;if(this.kyc)return{SheetName:this.sheetName,ActiveCell:null===(T=this.activeCell)||void 0===T?void 0:T.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0}};L.prototype.toString=function(){return String.format("active cell: {0} selection: {1}",this.activeCell.toString(),pg.f(this.selectedRanges,function(T){return T.toString()}).join(","))};
L.prototype.equals=function(T){return T?this.activeCell.equals(T.activeCell)&&Xe.Q(this.selectedRanges,T.selectedRanges)&&this.sheetName===T.sheetName:!1};Ll.Object.defineProperties(L.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.iF}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.W7}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.rSb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.e9f}},kyc:{configurable:!0,
enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(od.a)(L,"Selection",null,[]);Q.prototype.ABi=function(){this.p1=null;this.sJ=this.dIa();return{ActiveSheetName:this.sJ.sheetName,SheetViewportStateChanges:[this.sJ.wqj()]}};Q.prototype.Vni=function(T,Oa){var Eb=this;if(this.sJ)if(T){var vc,gd;if(function(){var $e=Xe.Y(T.ActiveCell,Eb.$.va);vc=$e.range;return $e}().returnValue)if(function(){var $e=Xe.Y(T.SelectedRange,Eb.$.va);gd=$e.range;return $e}().returnValue)this.p1=
new this.ULf(this.$,vc,[gd],T.SheetName,this.sJ.activeItemName),this.htc=Oa;else{var Cd;(Cd=this.ufa).errors=Cd.errors+1;this.sJ=null;mc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Unable to extract selected range {0}",T.SelectedRange)}else{var Fd;(Fd=this.ufa).errors=Fd.errors+1;this.sJ=null;mc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Unable to extract active cell {0}",T.ActiveCell)}}else{var $d;($d=this.ufa).errors=$d.errors+
1;mc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null")}else{var Ae;(Ae=this.ufa).errors=Ae.errors+1;mc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them")}};Q.prototype.dispose=function(){this.gridView.Ca.Jq(this.Sg);this.gridView.Ca.Ko(this.l6a);this.gridView.Ca.MEf(this.l6a);this.gridView.Ca.T8a(this.l6a);Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5769813_SelectionAdjustAggregateStats")&&
this.ufa.Ond()};Q.prototype.dIa=function(){var T=this.$.qa;return T&&T.activeCell&&T.selectedRanges&&T.sheetName?new this.ULf(this.$,T.activeCell,T.selectedRanges,T.sheetName,this.$.activeItemName):null};Q.prototype.Gke=function(T){if(this.p1)if(this.sJ){if(T){if(Bf.g(this.$).Ca.nff<this.htc)return;mc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.sJ.h5f(this.htc)||!this.p1.h5f(this.htc))return;
try{if(this.sJ.equals(this.dIa()))if(this.sJ.kyc)if(this.sJ.equals(this.p1)){var Oa;(Oa=this.ufa).yQc=Oa.yQc+1}else{var Eb;(Eb=this.ufa).xQc=Eb.xQc+1;this.gridView.YT(this.p1.selectedRanges,0,this.p1.sheetName,null,this.p1.activeCell,null,null,0,ye.a.J3i)}else{var vc;(vc=this.ufa).ord=vc.ord+1}else{var gd;(gd=this.ufa).n1c=gd.n1c+1;this.zXi()}}finally{this.sJ=this.p1=null}}else mc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSheetName is null while adjustedSheetName isn't null")};
Q.prototype.zXi=function(){if(this.AXi){var T=this.dIa();mc.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.sJ.toString(),T?T.toString():"",this.p1.toString(),this.sJ.sheetName===this.p1.sheetName,this.sJ.sheetName===(T?T.sheetName:null))}};Ll.Object.defineProperties(Q.prototype,{ULf:{configurable:!0,enumerable:!0,get:function(){return L}}});Object(od.a)(Q,
"SelectionAdjustManager",null,[287,6]);var rf=Ue.a;Em(S,rf);S.prototype.dispose=function(){this.$.ra.Sxa(Object(za.a)(this,this.gAa,"webServiceAdjustContextEventHandler"));Zh.a.Fa(this.jpb);this.mtc();this.LU.tVi(Object(za.a)(this,this.Xqf,"onReadyForPendingMergesUpdated"));this.LU.pnc(Object(za.a)(this,this.mBb,"onTogglePendingMergeBlockedByClient"));this.LU.OUi(Object(za.a)(this,this.gpf,"onMergeCounterChanged"));this.LU=null;this.wla&&this.wla.dispose();rf.prototype.dispose.call(this)};S.prototype.Xqf=
function(T,Oa){this.Gze?this.FAe.iFi(Oa.Eaa):this.jpb&&this.dMf(Oa.Eaa)};S.prototype.dMf=function(T){this.jpb.fCb(T)};S.prototype.mBb=function(T,Oa){Oa.Zua?this.glj():this.mtc()};S.prototype.gpf=function(){this.Vwb=0};S.prototype.glj=function(){this.mtc();if(this.yze()){var T=this.LU.f8b();mc.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",La(T),
this.Vwb)}else this.Wwb=this.nqa.create(Object(za.a)(this,this.iMf,"sendKeepBlockingPendingMerges"),this.q9a,eg.a.Wwb),this.D4a=this.nqa.AB(Object(za.a)(this,this.iMf,"sendKeepBlockingPendingMerges"),this.r9h,eg.a.D4a)};S.prototype.mtc=function(){this.D4a&&(this.Wwb.cancel(),this.D4a.cancel(),this.D4a=this.Wwb=null)};S.prototype.iMf=function(){var T=this,Oa=this.LU.f8b();N(this.ua,null!=Oa.SuspensionStartTimestamp?Oa.SuspensionStartTimestamp:0,null,function(){T.kvi(Oa)},null,null,this.ua.Wb())};S.prototype.kvi=
function(T){var Oa=" fail count: "+this.Vwb;this.Vwb++;this.yze()&&this.mtc();mc.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",La(T),Oa)};S.prototype.yze=function(){return this.Vwb>S.Ogi};S.prototype.gAa=function(T,Oa){if(Oa){Oa.Nkb.MergeCount=this.LU.f8b();var Eb=Bf.g(this.$).mii();T=Eb.min;Eb=Eb.max;Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Oa.Nkb.ClientRevisions=Object.assign(new da,{Min:T,
Max:Eb,MaxFromBlockCache:Bf.g(this.$).Ca.nff}):Oa.Nkb.ClientRevisions=Object.assign(new da,{Min:T,Max:Eb})}};S.Ogi=5;Object(od.a)(S,"RequestController",Ue.a,[]);var Ne=Me.a;Em(H,Ne);H.prototype.uVb=function(T){this.gea.uVb(T)};H.prototype.pnc=function(T){this.gea&&this.gea.pnc(T)};H.prototype.Ixa=function(T,Oa){this.TAa.Ixa(T,Oa)};H.prototype.fQd=function(T){this.TAa.fQd(T)};H.prototype.xMa=function(T,Oa){this.Dhb.xMa(T,void 0===Oa?"":Oa)};H.prototype.dispose=function(){this.gac&&(this.gac.dispose(),
this.gac=null);this.xDd&&(this.xDd.dispose(),this.xDd=null);this.gea&&(this.gea.dispose(),this.gea=null);this.Dhb.dispose();this.Dhb=null;this.TAa.dispose();this.TAa=null;this.KXa&&(this.KXa.dispose(),this.KXa=null);this.r2a&&(this.r2a.dispose(),this.r2a=null);this.$=null;Ne.prototype.dispose.call(this)};H.prototype.ZCb=function(){this.gea.mMi()};H.prototype.PUh=function(T,Oa){this.TAa=new Pa;Oa?Object(De.a)(xa,Oa)?this.Ixa(Oa,Object(Nb.a)(xa,Oa).PG):Object(De.a)(pb,Oa)?this.Ixa(Oa,Object(Nb.a)(pb,
Oa).PG):this.Ixa(Oa,!0):(this.KXa=new pb(T),this.r2a=new xa(T),this.Ixa(this.KXa,this.KXa.PG),this.Ixa(this.r2a,this.r2a.PG))};Ll.Object.defineProperties(H.prototype,{kga:{configurable:!0,enumerable:!0,get:function(){return this.TAa}},v7a:{configurable:!0,enumerable:!0,get:function(){return this.Dhb}},LU:{configurable:!0,enumerable:!0,get:function(){return this.gea}}});Object(od.a)(H,"MergeSuspensionManager",Me.a,[254,6]);var Yf=zc.a;Em(A,Yf);A.prototype.create=function(){mc.ULS.sendTraceTag(537155419,
0,50,"MergeSuspensionFactory.Create");this.Eb(this.Kc.ea.Ba(343)||this.Kc.ea.Ia(343,new H(this.Kc,ih.a.instance)))};A.ja=function(T){mc.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");T.ea.Ia(344,new A(T))};Object(od.a)(A,"MergeSuspensionFactory",zc.a,[]);E.Jai=3;E.connected=0;Object(od.a)(E,"ConnectionStateConstants",null,[]);var Af=b(103),ch=b(113),lg=b(39);J.prototype.hkf=function(T,Oa){this.blockedOperationsCount++;T=String.format("{0}_{1}_{2})",Oa.componentName,Oa.actionName,
Oa.details);this.blockedActions[T]=this.blockedActions[T]?this.blockedActions[T]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};J.prototype.SNf=function(){this.durationMs=ch.a(Te.a.Qa,this.startTime)};J.prototype.nud=function(T){var Oa=this;this.SNf();lg.a(T).mnc(Object(za.a)(this,this.hkf,"onBlockedOperationDuringPartialInteractivity"));lg.a(T).pg.nnc(Object(za.a)(this,this.Waa,"onToastShown"));T.ea.$a(291,function(Eb){Eb.V8a(Object(za.a)(Oa,Oa.QU,"onDocumentHidden"))});T.fa&&
T.fa.wf&&(T.fa.wf.$Ff(Object(za.a)(this,this.bvd,"onUserNotActive")),this.wasUserActiveOnPIEnd=T.fa.wf.Fq)};J.prototype.Uj=function(T){var Oa=this;lg.a(T).oVb(Object(za.a)(this,this.hkf,"onBlockedOperationDuringPartialInteractivity"));this.isToastShown?this.toastRaiser="Immediate":lg.a(T).pg.QPc(Object(za.a)(this,this.Waa,"onToastShown"));T.ea.$a(291,function(Eb){Oa.hasTabbedOut=Eb.aj;Eb.LDa(Object(za.a)(Oa,Oa.QU,"onDocumentHidden"))});this.wasUserActiveOnPIStart&&T.fa.wf.Uug(Object(za.a)(this,this.bvd,
"onUserNotActive"))};J.prototype.bvd=function(T){this.durationUntilUserInactive=Af.getElapsedSeconds(this.startTime,Te.a.Qa.Gb);T.$Ff(Object(za.a)(this,this.bvd,"onUserNotActive"))};J.prototype.QU=function(){this.hasTabbedOut=!0};J.prototype.Waa=function(T,Oa){Oa.Gvf!==this.type||this.isToastShown||(this.durationUntilToastShownMs=ch.a(Te.a.Qa,this.startTime),this.toastRaiser=Oa.toastRaiser,this.isToastShown=!0)};Object(od.a)(J,"PartialInteractivityData",null,[]);var jh=b(1200);Em(y,J);y.prototype.dqi=
function(T,Oa){this.swappedByOffline=Oa;this.nud(T)};y.prototype.B7i=function(T){this.errorDataDuringConnectivityIssuesMode=T};y.prototype.OOi=function(T){10>this.failedRequests.length&&(T=T+"_"+Af.getElapsedSeconds(this.startTime,Te.a.Qa.Gb).toString(),this.failedRequests.push(T))};Object(od.a)(y,"ConnectivityIssuesData",J,[]);var vh=b(165);x.d6g="DuringWork";x.connectivityIssues="ConnectivityIssues";x.offline="Offline";Object(od.a)(x,"UnavailabilityTypes",null,[]);z.prototype.dispose=function(){this.$&&
(lg.a(this.$).pg.YEf(Object(za.a)(this,this.tlf,"onConnectivityIssuesStatusChanged")),this.$.qf&&this.$.qf.XEf(Object(za.a)(this,this.qlf,"onConnectivityIssuesBegan")));this.data&&this.$.ra.qf.aGf(Object(za.a)(this,this.Io,"onWebMethodError"));this.$=null};z.prototype.tlf=function(T,Oa){Oa.kO?(this.data=new y(Te.a.Qa.Gb,this.$,5===Oa.qma,!!Oa.qma,this.$.qf.disconnectionSource,this.qte),this.iec=this.$.qf.laf,this.d5c=1,this.$.ra.qf.$ug(Object(za.a)(this,this.Io,"onWebMethodError")),vh.a(this.$).rPc(Object(za.a)(this,
this.jKf,"saveErrorDataDuringConnectivityIssuesMode"))):(this.data.dqi(this.$,5===Oa.qma),this.$.ra.qf.aGf(Object(za.a)(this,this.Io,"onWebMethodError")),this.data.lastFailedRequestToOnlineTimeGapSec=Af.getElapsedSeconds(this.iec,Te.a.Qa.Gb),Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?zf.b().$Fb(557682689,0,50,x.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",
Ah.a.Hc(this.data)):mc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Ah.a.Hc(this.data)),Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.data&&this.data.isToastShown&&Ub.Health.instance.recordQosError(Ye.a.MLg,[wf.a.Dec],!0,!1,!1,!1,null),vh.a(this.$).dCd(Object(za.a)(this,this.jKf,"saveErrorDataDuringConnectivityIssuesMode")),this.data=null)};z.prototype.jKf=function(T,Oa){this.data.B7i(Oa.wT)};
z.prototype.Io=function(T,Oa){this.data.OOi(Oa.context.methodName);T=Te.a.Qa.Gb;Oa=Af.getElapsedSeconds(this.iec,T);this.iec=T;Oa>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=Oa);this.d5c++;this.data.averageDurationBetweenFailedRequestsSec=this.BGg(Oa)};z.prototype.BGg=function(T){var Oa=this.d5c-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Oa-1)+T)/Oa};z.prototype.qlf=function(T,Oa){this.qte=Oa.ysj};Object(od.a)(z,"ConnectivityIssuesTelemetryManager",
null,[6]);var dh=b(976),xg=b(1244),Ff=b(1199);B.prototype.dispose=function(){this.$&&(this.NJd&&this.$.ra&&0<this.P5a.count&&this.$.ra.yt(Object(za.a)(this,this.Oh,"onWebMethodSuccess")),this.OJd&&(this.vMd("Dispose"),this.$.fa.wf.Rxa(Object(za.a)(this,this.Vaa,"onThrottledUserActivity"))))};B.prototype.sUh=function(){Se.EwaSettings.ka(214)&&this.MHi();this.OJd&&this.NHi()};B.prototype.QUh=function(){this.zzb=this.Azb;this.Rld=0;var T={};if(!this.P5a){this.P5a=new Uf.a;var Oa=xg.a.E7c(Object(za.a)(this,
this.eYi,"reportSampleTestResult"),"InitSampleMeasurement",this.$);Oa=Ol(Oa);for(var Eb=Oa.next();!Eb.done;Eb=Oa.next())Eb=Eb.value,T[Eb.Mdd]=Eb.baseUrl,this.P5a.add(Eb)}T=Sys.Serialization.JavaScriptSerializer.serialize(T);mc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.Azb,this.zzb,T);0<this.P5a.count&&this.$.ra.Yr(Object(za.a)(this,this.Oh,"onWebMethodSuccess"))};
B.prototype.zlj=function(){for(var T=Ol(this.P5a),Oa=T.next();!Oa.done;Oa=T.next())Oa.value.fFd()};B.prototype.n4i=function(){if(12E4>this.$.fa.wf.hbb)for(var T=Ol(this.Nsc),Oa=T.next();!Oa.done;Oa=T.next())Oa.value.fFd();else this.vMd("UserInactive")};B.prototype.eYi=function(T){T=Sys.Serialization.JavaScriptSerializer.serialize(T);mc.ULS.sendTraceTag(388821830,0,50,T)};B.prototype.vXi=function(T){if(T){var Oa=this.tXc[T.testIteration.toString()];Oa?Oa.push(T):(Oa=[T],this.tXc[T.testIteration.toString()]=
Oa);if(Oa.length===this.pJf.length){Oa=Sys.Serialization.JavaScriptSerializer.serialize(Oa);if(this.$&&this.$.qf){if(T.EstimatedLatency=this.$.qf.dle,this.$.qf.dle>this.$.Ut.ExcelRountripThresholdMs){mc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",Oa,this.HXc++);return}}else mc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");mc.ULS.sendTraceTag(570712142,
0,50,"Periodic ping tests results: {0}",Oa);this.HXc=1}}};B.prototype.Oh=function(T,Oa){T=Oa.context.methodName;if(T===mf.a.d1a||T===mf.a.Dta)this.zzb++,T=Date.now(),this.Ddj(T)&&(this.zzb=0,this.Rld=T,this.zlj())};B.prototype.Vaa=function(){this.dMd("OnThrottledUserActivity")};B.prototype.QU=function(){this.vMd("OnDocumentHidden")};B.prototype.wwa=function(){this.dMd("OnDocumentUnhidden")};B.prototype.dMd=function(T){this.ZPa&&this.ZPa.Do||(mc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",
T),this.ZPa=ih.a.instance.AB(Object(za.a)(this,this.n4i,"sendConnectionSpeedMeasurement"),5E3,eg.a.zjj),this.ZPa.Tia())};B.prototype.vMd=function(T){this.ZPa&&this.ZPa.Do&&(mc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",T),this.ZPa.cancel())};B.prototype.Ddj=function(T){return this.zzb>=this.Azb&&T-this.Rld>this.Spd};B.prototype.aKg=function(){return B.fJf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};B.prototype.MHi=function(){this.Azb=
this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.Spd=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var T=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.Azb&&0<this.Spd&&(this.NJd=B.fJf(T))&&this.QUh()};B.prototype.NHi=function(){if(!this.Nsc){this.Nsc=new Uf.a;var T=xg.a.E7c(Object(za.a)(this,this.vXi,"reportConectionLatencyTestResult"),"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Ff.a.gyc]);T=Ol(T);for(var Oa=T.next();!Oa.done;Oa=T.next())this.Nsc.add(Oa.value);
this.$.fa.wf.Fq&&this.dMd("PrepareAndInitSlowNetworkTests")}};B.fJf=function(T){return 100*Math.random()<T};Object(od.a)(B,"NetworkMeasurement",null,[6]);var Ai=b(895);t.prototype.Dwj=function(){this.eT&&this.eT.SNf()};t.prototype.Bpg=function(T){this.allOfflinePartialInteractivitiesDataInSession.push(T);this._count++};Ll.Object.defineProperties(t.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},eT:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-
1]}}});Object(od.a)(t,"OfflinePartialInteractivitiesDataForLog",null,[]);Em(w,J);w.prototype.Z$i=function(T){this.timeFromLastOffline=T};w.prototype.C7i=function(T){this._errorDataDuringOfflineMode=T};Object(od.a)(w,"OfflinePartialInteractivityData",J,[]);v.prototype.dispose=function(){this.$&&lg.a(this.$)&&lg.a(this.$).pg.sCd(Object(za.a)(this,this.L6a,"onOfflineModePartialInteractivityStatusChanged"));Zh.a.Fa(this.Qqb);this.$=this.Qqb=null};v.prototype.L6a=function(T,Oa){Oa.kO?this.Uwi(Oa.qma):
this.Vwi()};v.prototype.Waa=function(T,Oa){5===Oa.Gvf&&this.N_a()};v.prototype.kKf=function(T,Oa){this.eT.C7i(Oa.wT)};v.prototype.Uwi=function(T){this.eT=new w(Te.a.Qa.Gb,this.$,!!T);this.eT.Z$i(-1!==this.Wxd?window.performance.now()-this.Wxd:-1);this.fMa.Bpg(this.eT);lg.a(this.$).pg.QPc(Object(za.a)(this,this.Waa,"onToastShown"));this.N_a();this.Qqb=ih.a.instance.AB(Object(za.a)(this,this.N_a,"flushOfflinePartialInteractivityDataToIDB"),v.foh,eg.a.N_a);vh.a(this.$).rPc(Object(za.a)(this,this.kKf,
"saveErrorDataDuringOfflineMode"))};v.prototype.N_a=function(){this.fMa.Dwj();this.K1i(v.$vd,Sys.Serialization.JavaScriptSerializer.serialize(this.fMa))};v.prototype.Vwi=function(){this.eT.nud(this.$);this.N_a();Zh.a.Fa(this.Qqb);this.Qqb=null;this.Wxd=window.performance.now();lg.a(this.$).pg.nnc(Object(za.a)(this,this.Waa,"onToastShown"));vh.a(this.$).dCd(Object(za.a)(this,this.kKf,"saveErrorDataDuringOfflineMode"));this.wXi()};v.prototype.K1i=function(T,Oa){var Eb=this;this.$?this.eaf=$g.TaskExtensions.Aa(this.eaf,
function(){Eb.indexedDB.U9a(new Ai.a(T,Oa))},this.$.la):mc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};v.prototype.qXi=function(){var T=this.$.la;$g.TaskExtensions.Aa($g.TaskExtensions.Aa(this.indexedDB.iIa(v.$vd),Object(za.a)(this,this.WXi,"reportOfflinePartialInteractivityDataFromIDB"),T),Object(za.a)(this,this.fSi,"removeDataFromIDB"),T)};v.prototype.WXi=function(T){T=T.result;If.a.ma(T)||(this.u5f=
!0,mc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",T))};v.prototype.wXi=function(){if(this.eT){var T=Sys.Serialization.JavaScriptSerializer.serialize(this.eT);Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?zf.b().$Fb(560791645,0,50,x.offline,this.eT.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",
T):mc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",T)}Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.eT&&this.eT.isToastShown&&Ub.Health.instance.recordQosError(Ye.a.pAj,[wf.a.Dec],!0,!1,!1,!1,null)};v.prototype.fSi=function(){this.u5f&&(this.$?$g.TaskExtensions.Aa(this.indexedDB.Kye(v.$vd),function(){mc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},
this.$.la):mc.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};v.prototype.Lzb=function(){if(this.fMa&&0<this.fMa.count){var T=Sys.Serialization.JavaScriptSerializer.serialize(this.fMa);mc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",T)}};v.Led="NetworkAvailability";v.Med="NetworkAvailabilityData";v.$vd=
"partialInteractivityData";v.foh=3E3;Object(od.a)(v,"OfflineModeTelemetryManager",null,[6]);h.prototype.dispose=function(){Zh.a.Fa(this.ijf);Zh.a.Fa(this.Uqd);Zh.a.Fa(this.Tja);Zh.a.Fa(this.oPg);this.$=null};Object(od.a)(h,"NetworkConnectionTelemetryManager",null,[6]);Em(r,J);r.prototype.L6a=function(){this.wasInteruptedByOfflineMode=!0};Object(od.a)(r,"SilentReopenData",J,[]);n.prototype.dispose=function(){this.pg.xFf(Object(za.a)(this,this.bpf,"onLongInactivitySilentReopenPartialInteractivityStatusChanged"));
this.pg.RVi(Object(za.a)(this,this.Msf,"onSilentReopenDuringWorkPartialInteractivityStatusChanged"));this.f6=this.pg=this.$=null};n.prototype.Msf=function(T,Oa){this.Jsf(Oa,3)};n.prototype.bpf=function(T,Oa){this.Jsf(Oa,2)};n.prototype.Jsf=function(T,Oa){T.kO?this.f6=new r(Te.a.Qa.Gb,this.$,!!T.qma,Oa):(5===T.qma&&(this.f6.wasInteruptedByOfflineMode=!0),3!==T.qma&&2!==T.qma||mc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),
this.f6.nud(this.$),2===Oa?Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?zf.b().aGb(571289604,0,50,x.offline,this.f6.durationMs,this.f6):mc.ULS.sendTraceTag(571289604,0,50,Ah.a.Hc(this.f6)):Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?zf.b().aGb(542782150,0,50,x.d6g,this.f6.durationMs,this.f6):mc.ULS.sendTraceTag(542782150,0,50,Ah.a.Hc(this.f6)),this.f6=null)};Object(od.a)(n,"SilentReopenPartialInteractivityTelemetryManager",
null,[6]);var Oh=Ue.a;Em(l,Oh);l.prototype.dispose=function(){this.qf&&(this.Drc&&(this.qf.TUi(Object(za.a)(this,this.HAb,"onNetworkDownEvent")),this.qf.kEb(Object(za.a)(this,this.Ipf,"onNetworkResumedEvent"))),this.qf.XEf(Object(za.a)(this,this.rlf,"onConnectivityIssuesBeganEvent")),this.qf.FTi(Object(za.a)(this,this.slf,"onConnectivityIssuesEndedEvent")));this.mwb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.dEb(Object(za.a)(this,this.wwa,"onDocumentUnhidden")),this.mwb=!1);
this.$&&(this.tmc&&this.uvc(),this.$.fa&&(this.$.fa.SFf(Object(za.a)(this,this.Lsf,"onSilentReopenDueToTimeoutOrDeploymentInitiated")),this.$.fa.wf&&this.$.fa.wf.Rxa(Object(za.a)(this,this.Vaa,"onThrottledUserActivity"))));Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.G_&&(this.G_.dispose(),this.G_=null);Zh.a.Fa(this.nhf);this.$=null;Oh.prototype.dispose.call(this)};l.prototype.pgi=function(){this.GJd=!0};l.prototype.pce=function(){this.dma||(this.dma=
lg.a(this.$).pg.vVa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};l.prototype.m_h=function(){if(this.GJd)return this.GJd=!1,!0;var T=this.o6>this.idf||this.Eed>this.idf&&10>this.o6;mc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",this.o6,this.Eed,T);return T};l.prototype.gYi=function(){Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&
(this.G_=ih.a.instance.create(function(){Ub.Health.instance.recordQosError(Ye.a.Ejj,[wf.a.Dec],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};l.prototype.ing=function(){var T=this;this.dma||this.s_?mc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.s_=
ih.a.instance.create(function(){T.$?T.dma?mc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):Bf.g(T.$).isEditing?(T.H8a||(Bf.g(T.$).uc.Xr(Object(za.a)(T,T.pj,"onEditEnded")),mc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),
T.I8a=!0,mc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):T.pce():mc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.rUf,eg.a.yij,void 0,!0)};l.prototype.HAb=function(){mc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");
this.sgc(1,!1)};l.prototype.wwa=function(){var T=this;this.Yia||this.hyb?window.setTimeout(function(){T.COd()},this.mhf):this.COd();this.documentVisibilityObserver.dEb(Object(za.a)(this,this.wwa,"onDocumentUnhidden"));this.mwb=!1};l.prototype.kgf=function(T){this.DXc=this.une(2,T,!0);this.Yge()};l.prototype.sgc=function(T,Oa){this.iSb=this.une(T,Oa,!1);this.Yge()};l.prototype.une=function(T,Oa,Eb){Eb=Eb?this.DXc:this.iSb;return Oa?Eb|T:Eb&~T};l.prototype.COd=function(){var T=!!this.gMa,Oa=!!this.UPa,
Eb=!!this.dma,vc=!!this.l_b;this.hyb&&!T?this.hng():!this.hyb&&T&&this.H_g();!this.nfc||Oa||Eb?this.nfc||(Oa?this.Rxe():(Eb||this.s_&&this.s_.Do)&&this.Sxe()):this.yRf&&this.Yda?this.fng():!this.gHb||this.Yda||Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.s_||this.ing();this.Yia&&!vc?this.qZf(!0):!this.Yia&&vc&&this.qZf(!1)};l.prototype.pj=function(){mc.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",
this.hyb&&this.Drc,this.nfc&&!this.Yda&&this.gHb);this.hyb&&this.Drc&&this.sce();this.nfc&&!this.Yda&&this.gHb&&this.pce();Bf.g(this.$).uc.Fr(Object(za.a)(this,this.pj,"onEditEnded"));this.I8a=this.H8a=!1};l.prototype.hng=function(){this.$?this.gMa?mc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):Bf.g(this.$).isEditing?(this.I8a||(Bf.g(this.$).uc.Xr(Object(za.a)(this,
this.pj,"onEditEnded")),mc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.H8a=!0,mc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.sce():mc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};
l.prototype.sce=function(){this.gMa||(this.gMa=lg.a(this.$).pg.vVa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};l.prototype.Ipf=function(){mc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.sgc(1,!0);this.H8a&&!this.I8a&&Bf.g(this.$).uc.Fr(Object(za.a)(this,this.pj,"onEditEnded"));this.H8a=!1};l.prototype.H_g=function(){this.gMa&&(Zh.a.Fa(this.gMa),this.gMa=null)};l.prototype.Rxe=function(){this.UPa&&(Zh.a.Fa(this.UPa),
this.UPa=null);Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.G_&&this.G_.Do&&this.G_.cancel();this.G_=null};l.prototype.Sxe=function(){this.dma&&(Zh.a.Fa(this.dma),this.dma=null);this.s_&&(Zh.a.Fa(this.s_),this.s_=null);this.I8a&&!this.H8a&&Bf.g(this.$).uc.Fr(Object(za.a)(this,this.pj,"onEditEnded"));this.I8a=!1};l.prototype.Vaa=function(T,Oa){this.Eed=this.o6;this.o6=Oa.wuc};l.prototype.Lsf=function(){this.$&&(this.tmc||(ia.a(this.$).vP(Xf.a.KMa).gsg(Object(za.a)(this,
this.Upf,"onOpenWebMethodErrorUserAlertExecuting")),this.$.Jk(Object(za.a)(this,this.jd,"onWorkbookOpened")),this.tmc=!0),this.Yda=this.m_h(),this.sgc(2,!1))};l.prototype.Upf=function(){var T=ia.a(this.$).gi,Oa=T.lyg();T=pg.f(T.Pr.fd.errors,function(Eb){return Eb.MessageIdName});mc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",Oa,this.Yda,Ah.a.Hc(T));Oa&&(this.UPa?(this.Yda=!1,this.Rxe(),this.uvc()):
this.dma&&(this.Sxe(),this.uvc()))};l.prototype.jd=function(){this.$?(mc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.Yda=!1,Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&this.s_&&this.s_.Do&&(Zh.a.Fa(this.s_),this.s_=null),Se.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.G_&&this.G_.Do&&(Zh.a.Fa(this.G_),this.G_=null),
this.sgc(2,!0),this.uvc()):mc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};l.prototype.fng=function(){this.UPa||(this.UPa=lg.a(this.$).pg.vVa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",void 0,Hf.a.instance.da(2091)));this.gYi()};l.prototype.rlf=function(){this.kgf(!0)};l.prototype.slf=function(){this.kgf(!1)};l.prototype.qZf=function(T){T?(this.l_b=lg.a(this.$).pg.vVa(4,"NetworkConnectionStateManager.ConnectivityIssues"),
this.JKi()):(Zh.a.Fa(this.l_b),this.l_b=null)};l.prototype.JKi=function(){if(this.$&&this.$.ra){var T=this.$.ra.ua.Wb();bc.ib(this.$.ra.ua,null,null,null,T)}};l.prototype.uvc=function(){ia.a(this.$).vP(Xf.a.KMa).jq(Object(za.a)(this,this.Upf,"onOpenWebMethodErrorUserAlertExecuting"));this.$.dl(Object(za.a)(this,this.jd,"onWorkbookOpened"));this.tmc=!1};l.prototype.Yge=function(){this.documentVisibilityObserver||mc.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.aj?this.mwb||(this.documentVisibilityObserver.okb(Object(za.a)(this,this.wwa,"onDocumentUnhidden")),this.mwb=!0,mc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.COd()};Ll.Object.defineProperties(l.prototype,{$0h:{configurable:!0,enumerable:!0,get:function(){return this.Yda}},hyb:{configurable:!0,
enumerable:!0,get:function(){return!(this.iSb&1)}},nfc:{configurable:!0,enumerable:!0,get:function(){return!(this.iSb&2)}},Yia:{configurable:!0,enumerable:!0,get:function(){return!!(this.DXc&2)}}});Object(od.a)(l,"NetworkConnectionStateManager",Ue.a,[253,6]);var zg=zc.a;Em(d,zg);d.prototype.create=function(){var T=this;$g.TaskExtensions.Aa(Zd.GetServiceTaskFactory.Va(this.$.ea,395,396,this.rb,"Microsoft.Office.Excel.WebUI.Client.IndexedDB.IIndexedDB"),function(Oa){T.Eb(T.$.ea.Ba(400)||new l(T.$,Oa.result))},
this.$.la,3)};d.ja=function(T){T.ea.Ia(401,new d(T))};Object(od.a)(d,"NetworkConnectionStateManagerFactory",zc.a,[]);var Bi=b(1353);e.prototype.dispose=function(){this.Y0f();this.e1f();this.Vld=this.Hld=this.$J=this.hk=this.pt=this.Olc=this.$=null;this.ASd=0};e.prototype.CBg=function(T){this.$J=T;this.Hld=T.qvg;this.Vld=T.iPi};e.prototype.tGa=function(){if(this.$J){var T=Xe.K(this.$J.zjh);if(Se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&T){var Oa=ge.d(this.$.va.qa);
T=new hg.a(T,Oa);this.wsj(T)}this.hide();this.Y0f();this.$J=null}};e.prototype.n5h=function(){return!!this.$J&&this.Olc.Q1h};e.prototype.Mhj=function(T){this.$J?this.show(T):mc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};e.prototype.rCh=function(){return this.$J?this.$J.P$h:null};e.prototype.show=function(T){var Oa=this.$J.syh();Oa?(this.Olc.showFloatie(Object.assign(new Bi.a,{x:Oa.x,y:Oa.y}),this.$J.cIa(),T),this.Uj()):mc.ULS.sendTraceTag(537154071,
0,100,"RecoveryUIController.Show: point is null.")};e.prototype.hide=function(){this.n5h()&&this.Olc.IB();this.e1f()};e.prototype.Uj=function(){if(!this.i2b){var T=Bf.g(this.$);T.view.Us(Object(za.a)(this,this.b3f,"updatePositionOnVisibleAreaChanged"));T.Yi.Jm(Object(za.a)(this,this.cAe,"dismissRecoveryUIOnEditStarted"));this.hk.ja("blur",Object(za.a)(this,this.v3g,"dismissRecoveryUIOnDocumentHidden"));this.$.Ka.mkb(Object(za.a)(this,this.twa,"onCommandExecutionStarting"));this.$.va.Pf(Object(za.a)(this,
this.dAe,"dismissRecoveryUIOnSheetChanged"));(T=this.$.ea.Ba(65))&&T.Y1&&T.Y1.registerForCommentEvents(Object(za.a)(this,this.bAe,"dismissRecoveryUIOnCommentsEvent"));this.i2b=!0}this.f$b||(this.pt.Au(Gc.a.Qb,this.$.domElement,Object(za.a)(this,this.onKeyDown,"onKeyDown"),!0),this.pt.Au(Gc.a.Xd,this.$.domElement,Object(za.a)(this,this.onKeyUp,"onKeyUp"),!0),this.f$b=!0)};e.prototype.Y0f=function(){if(this.i2b){var T=Bf.g(this.$);T.view.Gr(Object(za.a)(this,this.b3f,"updatePositionOnVisibleAreaChanged"));
T.Yi.ym(Object(za.a)(this,this.cAe,"dismissRecoveryUIOnEditStarted"));this.hk.detach("blur");this.$.Ka.U8a(Object(za.a)(this,this.twa,"onCommandExecutionStarting"));this.$.va.zg(Object(za.a)(this,this.dAe,"dismissRecoveryUIOnSheetChanged"));(T=this.$.ea.Ba(65))&&T.Y1&&T.Y1.unregisterForCommentEvents(Object(za.a)(this,this.bAe,"dismissRecoveryUIOnCommentsEvent"));this.i2b=!1}};e.prototype.e1f=function(){this.f$b&&(this.pt.Nu(Gc.a.Qb,this.$.domElement,Object(za.a)(this,this.onKeyDown,"onKeyDown"),!0),
this.pt.Nu(Gc.a.Xd,this.$.domElement,Object(za.a)(this,this.onKeyUp,"onKeyUp"),!0),this.f$b=this.dZ=this.E4b=!1)};e.prototype.b3f=function(){var T=this;this.$J&&(this.ASd=Te.a.Qa.oe.m,this.hide(),ih.a.instance.create(function(){T.yyj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};e.prototype.yyj=function(){this.$J&&250<=Te.a.Qa.oe.m-this.ASd&&this.show(-1)};e.prototype.bAe=function(T){10===T&&this.tGa()};e.prototype.v3g=function(){if(this.$J){var T=document.getElementById("PasteRecoveryUI");
T&&Fb.a.hj===T.getAttribute(Fb.a.rX)&&T.click();this.tGa()}};e.prototype.cAe=function(){this.tGa()};e.prototype.dAe=function(){this.tGa()};e.prototype.onKeyUp=function(T){if(this.$J){if(this.dZ)return!1;if(17===T.Ea.keyCode&&this.E4b){T=document.getElementById("PasteRecoveryUI");if(!T)return mc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var Oa=T.getAttribute(Fb.a.rX)||"";if(Fb.a.Vo===Oa)return T.click(),!0}}return!1};e.prototype.onKeyDown=function(T){if(this.$J){this.E4b=
!1;this.dZ=T.ctrlKey;T=T.Ea.keyCode;if(27===T)return this.tGa(),!0;if(17===T)return this.E4b=!0}return!1};e.prototype.twa=function(T,Oa){T=Oa.Zd;-1027730316!==T.command&&-1059615499!==T.command?this.tGa():(Oa=Oa.properties)&&Oa.launcherId!==this.rCh()&&this.tGa()};e.prototype.wsj=function(T){$g.TaskExtensions.Aa(Zd.GetServiceTaskFactory.Va(this.$.ea,426,427,1,"Microsoft.Office.Excel.WebUI.Client.IntelligentMetadataOverlay.IIntelligentMetadataOverlayManager"),function(Oa){Oa.result.Ema(T,"Paste")},
this.$.la,3)};Object(od.a)(e,"RecoveryUIController",null,[252,6]);var mj=zc.a;Em(a,mj);a.prototype.create=function(){var T=this,Oa=this.$;Oa.RD(function(Eb){Eb.Xed().then(function(vc){T.Eb(Oa.ea.Ba(406)||new e(Oa,vc,Pb.KeyInputManager.instance,Ld.a.instance.BB()))})})};a.ja=function(T){T.ea.Ia(405,new a(T))};Object(od.a)(a,"RecoveryUIControllerFactory",zc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Type.registerNamespace("Common");
Type.registerNamespace("Common.App.ApplicationFeatureHelper");Oe.main();Type.registerNamespace("Common.App.InProductMessaging");Wd.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");hd.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(function(){Xa.a.Ga(function(T){Ec.ja(T)})})();(function(){Xa.a.Ga(function(T){P.ja(T)})})();(function(){Xa.a.Ga(function(){Xa.a.Ga(oc.ja)})})();(function(){Xa.a.Ga(function(){Xa.a.Ga(Yb.ja)})})();
(function(){Xa.a.Ga(function(T){xb.ja(T)})})();ve.a.Li(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Xa.a.Ga(A.ja);Xa.a.Ga(d.ja);(function(){Xa.a.Ga(function(T){a.ja(T)})})()},976:function(C,F,b){function a(z){var x=this;this.businessBar=this.M4a=null;this.$=z;this.ra=this.$.ra;this.localStorage=new w.a;this.k_b=!1;this.$.fa.oo(Object(r.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"));this.ra.qf.vkb(Object(r.a)(this,this.Gwa,"onNetworkResumed"));this.ra.Yr(Object(r.a)(this,this.Oh,"onWebMethodSuccess"));this.$.ea.$a(5,function(y){x.businessBar=y;y.rrg(Object(r.a)(x,x.Foi,"onBusinessBarEntryDisplayChanged"))});
this.ra.lB(Object(r.a)(this,this.Io,"onWebMethodError"))}function e(z){this.Udd=[t.a.W6f,t.a.gyc];this.Tja=z;this.$=z.$;this.VM={}}function d(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(F);C=b(0);var l=b(15),n=b(316),r=b(37),h=b(27),v=b(9),w=b(304);Object(C.a)(d,"ConnectionErrorLogInfo",null,[]);var t=b(1199),B=b(1244);e.prototype.h$h=function(){var z=Object(r.a)(this,this.Mp,"addResult");z=B.a.E7c(z,"OnNetworkDownImmediatePing",this.$,this.Udd);z=Ol(z);for(var x=
z.next();!x.done;x=z.next())x.value.fFd()};e.prototype.Mp=function(z,x){this.VM[x]=z;this.vQh()&&this.$Xi("OnNetworkDownImmediatePing"===z.caller)};e.prototype.vQh=function(){for(var z=Ol(this.Udd),x=z.next();!x.done;x=z.next())if(x=x.value,void 0===this.VM[x]||null===this.VM[x])return!1;return!0};e.prototype.$Xi=function(z){var x=this.$.qf.qU;z&&this.smj(x);z=Ol(this.Udd);for(var y=z.next();!y.done;y=z.next())y=y.value,this.VM[y]=Sys.Serialization.JavaScriptSerializer.serialize(this.VM[y]);z=Date.now();
y=this.Tja.cbd(b(976).NetworkConnectionHealthChecker.bzb).returnValue;var J=this.Tja.cbd(b(976).NetworkConnectionHealthChecker.dGb).returnValue;this.VM.isOfflineMode=x;this.VM.networkDownBBAge=-1===y?y:z-y;this.VM.transientServerCommunicationFailuresBBAge=-1===J?J:z-J;this.Tja.businessBar?(this.VM.isNetworkDownBBShown=this.Tja.businessBar.tD(54).toString(),this.VM.isServerErrorBBShown=this.Tja.businessBar.tD(21).toString()):(this.VM.isNetworkDownBBShown="unknown",this.VM.isServerErrorBBShown="unknown");
l.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",Sys.Serialization.JavaScriptSerializer.serialize(this.VM))};e.prototype.smj=function(z){for(var x=b(976).NetworkConnectionHealthChecker,y={},J=Ol(Object.keys(this.VM)),E=J.next();!E.done;E=J.next())E=this.VM[E.value],y[E.testName]=E.isSuccess;y.isOfflineMode=z;this.Tja.EMd(x.CXc,Sys.Serialization.JavaScriptSerializer.serialize(y))};Object(C.a)(e,"ConnectionHealthTestsRunner",null,[]);b.d(F,"NetworkConnectionHealthChecker",
function(){return a});a.prototype.dispose=function(){this.$&&(this.$.fa&&this.$.fa.Er(Object(r.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive")),this.ra&&(this.ra.qf.kEb(Object(r.a)(this,this.Gwa,"onNetworkResumed")),this.ra.BC(Object(r.a)(this,this.Io,"onWebMethodError")),this.ra.yt(Object(r.a)(this,this.Oh,"onWebMethodSuccess"))))};a.prototype.Foi=function(z,x){x.k1c?this.Hoi(x):this.Goi(x)};a.prototype.Hoi=function(z){var x={};x.Timestamp=Date.now().toString();switch(z.dmb){case 21:this.M4a=
z.data.FailedMethod;x.FailedMethod=this.M4a;this.EMd(a.dGb,JSON.stringify(x));break;case 54:this.EMd(a.bzb,JSON.stringify(x))}};a.prototype.Goi=function(z){switch(z.dmb){case 21:this.e5a(a.dGb,!0);break;case 54:this.e5a(a.bzb,!0)}};a.prototype.EMd=function(z,x){try{this.localStorage.Yf()&&this.localStorage.setItem(z,x)}catch(y){l.ULS.sendTraceTag(537155231,0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",y.message||"Unknown")}};a.prototype.cbd=
function(z){if(this.localStorage.Yf()&&(z=this.localStorage.P0a(z))&&"null"!==z){var x=JSON.parse(z);z=parseInt(x.Timestamp);x=Sys.Serialization.JavaScriptSerializer.serialize(x);return{returnValue:z,rawData:x}}return{returnValue:-1,rawData:null}};a.prototype.Oh=function(z,x){z=x.context.methodName;this.M4a&&z===this.M4a&&(l.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',this.M4a),
this.e5a(a.dGb,!0),this.M4a=null);this.Fcf(!1);this.k_b=!1};a.prototype.Io=function(z,x){h.a.Yg(x.errors,[-1387426400])&&!this.k_b&&(this.k_b=!0,this.MRf()&&window.performance.mark(a.hjf),(new e(this)).h$h())};a.prototype.Ih=function(){this.Fcf(!0);this.e5a(a.bzb,!1);this.e5a(a.dGb,!1)};a.prototype.Fcf=function(z){if(this.localStorage.Yf()){var x=this.localStorage.P0a(a.CXc);if(x&&"null"!==x){var y=-1;this.k_b&&(y=this.Jyh(a.hjf,a.xni));l.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",
Sys.Serialization.JavaScriptSerializer.serialize(x),y,z);this.localStorage.removeItem(a.CXc)}}};a.prototype.Jyh=function(z,x){if(!this.MRf())return-1;window.performance.measure(x,z);z=window.performance.getEntriesByName(x);return z.length&&z[z.length-1]?z[z.length-1].duration:(l.ULS.sendTraceTag(537155228,0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",x),-1)};a.prototype.e5a=function(z,x){try{var y=this.cbd(z);var J=y.rawData;var E=y.returnValue;
if(-1!==E){var A=Object.assign(new d,{timeElapsed:Date.now()-E,scenario:z,isNewSession:!x,rawData:J});l.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(A))}this.localStorage.removeItem(z)}catch(H){l.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",H.message||"Unknown")}};a.prototype.Gwa=function(){l.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");
this.e5a(a.bzb,!0)};a.prototype.MRf=function(){return v.HelperMethods.VSc&&n.a.Ulb};a.bzb="NetworkDownBBShown";a.dGb="ServerCommunicationFailureBBShown";a.CXc="ConnectionHealthPingRsults";a.hjf="offMoStMa";a.xni="offMoDuMea";Object(C.a)(a,"NetworkConnectionHealthChecker",null,[6])}}]);

//# sourceMappingURL=EwaDS.pi.js.map