(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1252:function(C,F,b){function a(){var B=t.call(this)||this;B.xii=3E4;B.Jei=l.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.RFLowFidelityThreshold",10);B.qjd=void 0;B.zma={};B.wXb={};B.Vjd=!1;return B}function e(B){var z=v.call(this)||this;z.$=B;z.Yb();return z}b.r(F);C=b(0);var d=b(15),l=b(1),n=b(74),r=b(9),h=b(212),v=h.a;Em(e,v);e.prototype.create=function(){var B=b(1252).RenderingFidelityTracker,z=this.$.ea.Ba(462);
z||(z=this.$.ea.Ia(462,new B));this.Eb(z)};Object(C.a)(e,"RenderingFidelityTrackerFactory",h.a,[]);var w=b(47);b.d(F,"RenderingFidelityTracker",function(){return a});var t=n.a;Em(a,t);a.prototype.Ewg=function(B,z,x,y){var J=this;if(!(w.PageLoadTrackingInfo.instance.Eta(new Date)<this.xii||this.Vjd)){void 0===this.qjd&&(this.qjd=l.EwaSettings.isChangeGateEnabled("OfficeVSO:5839331_RFMetricPhase3"));var E=r.HelperMethods.Yva(function(){for(var A=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(z),
H=Object.keys(A),S=J.wXb[B],Q=0;Q<H.length;Q++){var L=H[Q];S&&S[L]&&J.zma[L]&&(J.zma[L]-=S[L])}J.wXb[B]=A;for(S=0;S<H.length;S++)if(Q=H[S],L=A[Q],J.zma[Q]&&(L+=J.zma[Q]),J.qjd)if(gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(Q,L)){J.Vjd=!0;J.zma={};J.wXb={};d.ULS.sendTraceTag(529065378,0,50,"Session Vetoed because of : { key:"+Q+", isHC:"+x+", scaleFactor:"+y+"}");break}else J.zma[Q]=L;else if(L>J.Jei){J.Vjd=!0;J.zma={};J.wXb={};d.ULS.sendTraceTag(537151042,0,50,"Session Vetoed because of : { key:"+
Q+", isHC:"+x+", scaleFactor:"+y+"}");break}else J.zma[Q]=L});1<E&&d.ULS.sendTraceTag(537151041,1,50,"RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration={0}",E)}};a.ja=function(B){B.ea.Ia(463,new e(B))};Object(C.a)(a,"RenderingFidelityTracker",n.a,[217,6])},1363:function(C,F,b){function a(ya){this.$=ya;this.KBg=new bc.a;this.yLe=new bc.a;ge.g(this.$).Ca.Np(Object(Fc.a)(this,this.Sg,"onBlockCacheConsistent"));ge.g(this.$).Ca.Yee(Object(Fc.a)(this,
this.h6a,"onAllFloatingObjectsRendered"))}function e(ya,oa,yb){this.jBj=ya;this.BT=oa;this.name=yb}function d(ya,oa,yb,Dd,ie,xe){oa=void 0===oa?null:oa;yb=void 0===yb?null:yb;Dd=void 0===Dd?null:Dd;ie=void 0===ie?null:ie;xe=void 0===xe?!1:xe;var Lf=kg.call(this)||this;Lf.Tih=[je.a.Rle,je.a.qEe,je.a.rEe,je.a.kac,je.a.Rec,je.a.Ebf,je.a.renderCachedContent,je.a.renderServerContent,je.a.C0b,je.a.BKf,je.a.CKf,je.a.DKf,je.a.t5i];Lf.L$d=null;Lf.nUa=null;Lf.ele=null;Lf.M3d=null;Lf.icb=null;Lf.wKb=null;Lf.dBa=
null;Lf.hib=null;Lf.Ple=!1;Lf.Xvf=!1;Lf.q5f=null;Lf.DDd=null;Lf.w4f=null;Lf.t4f=null;Lf.u4f=null;Lf.userSessionId=ya;Lf.DYa=oa=oa||new Ie.a;Lf.Kg=yb||fg.a.Qa;Lf.kmj=Dd||Lf;Lf.nf=ie;Lf.G6h=xe;Lf.bye=oa.u5a();Lf.nf&&Lf.nf.LDa(Object(Fc.a)(Lf,Lf.QU,"onDocumentHidden"));return Lf}function l(){}function n(){}function r(){}function h(){}function v(){}function w(){}function t(ya,oa){this.iFd=void 0===oa?1:oa;this.total=ya}function B(){var ya=ff.call(this)||this;ya.Cki=0;ya.operation="DOMUpdate";ya.target=
null;ya.sender=null;return ya}function z(ya,oa){function yb(xe,Lf){null!=Lf&&(Dd[xe]=Lf)}var Dd={},ie=null;switch(ya){case 0:ie="Actions";yb("Id",oa.a);yb("Operation",null==oa.b?null:oa.b);yb("Target",oa.c);yb("StartTime",null==oa.d?null:oa.d.toString());yb("Duration",null==oa.e?null:oa.e.toString());yb("CorrelationId",oa.f);yb("ParentAction",oa.g);yb("DocumentHidden",null==oa.h?null:oa.h.toString());break;case 1:ie="CorrelationStart";yb("CorrelationId",oa.a);yb("UserSessionId",oa.b);yb("UserAction",
oa.c);break;case 2:ie="ReorderSheetOp";yb("UserSessionId",oa.a);yb("IsDragReorder",null==oa.b?null:oa.b.toString());yb("DocumentUp",null==oa.c?null:oa.c.toString());yb("OldIndex",null==oa.d?null:oa.d.toString());yb("NewIndex",null==oa.e?null:oa.e.toString());yb("TotalSheets",null==oa.f?null:oa.f.toString());break;case 3:ie="FormatCellOp";yb("UserSessionId",oa.a);yb("TaskId",null==oa.b?null:oa.b.toString());yb("NumberOfRanges",null==oa.c?null:oa.c.toString());yb("Ranges",oa.d);yb("ActiveCell",oa.e);
yb("ActionId",null==oa.f?null:oa.f.toString());yb("CommandParameters",oa.g);yb("UserActionStopwatchId",oa.h);break;case 4:ie="CopyOp";yb("UserSessionId",oa.a);yb("IsChrome",null==oa.b?null:oa.b.toString());yb("IsIE",null==oa.c?null:oa.c.toString());yb("IsFromUI",null==oa.d?null:oa.d.toString());yb("IsCopyInLoadedRange",null==oa.e?null:oa.e.toString());yb("IsRepeatedCopy",null==oa.f?null:oa.f.toString());yb("IsClipboarAccessSupported",null==oa.g?null:oa.g.toString());yb("IsClipboarAccessInstallationSupported",
null==oa.h?null:oa.h.toString());yb("RibbonCommand",null==oa.i?null:oa.i.toString());yb("CutCopyPasteFlags",null==oa.j?null:oa.j.toString());yb("IsDrag",null==oa.k?null:oa.k.toString());yb("IsIeBeforeAlowDenyPopUp",null==oa.l?null:oa.l.toString());yb("IsPasteMatchCopy",oa.m);yb("WaitMessageInClipboard",oa.n);yb("CallCount",null==oa.o?null:oa.o.toString());break;case 5:ie="PasteOp";yb("UserSessionId",oa.a);yb("IsChrome",null==oa.b?null:oa.b.toString());yb("IsIE",null==oa.c?null:oa.c.toString());yb("IsCopyActive",
null==oa.d?null:oa.d.toString());yb("IsFromUI",null==oa.e?null:oa.e.toString());yb("IsClipboarAccessSupported",null==oa.f?null:oa.f.toString());yb("IsClipboarAccessInstallationSupported",null==oa.g?null:oa.g.toString());yb("RibbonCommand",null==oa.h?null:oa.h.toString());yb("CutCopyPasteFlags",null==oa.i?null:oa.i.toString());yb("WaitMessageInClipboard",oa.j);yb("PopupDialog",oa.k);yb("SimplePopupMessage",oa.l);yb("DialogCloseButton",oa.m);yb("UserPressedInstallLink",oa.n);yb("CallCount",null==oa.o?
null:oa.o.toString());break;case 6:ie="GetNumberViewModelDataOp";yb("UserSessionId",oa.a);yb("NumberFormatOptionsPreviousOutputJson",oa.b);yb("NumberFormatOptionsNewInputJson",oa.c);break;case 7:ie="InstantaneousSetData";yb("Id",oa.a);yb("WasEmpty",null==oa.b?null:oa.b.toString());yb("ValueNotChanged",null==oa.c?null:oa.c.toString());yb("Source",oa.d);yb("ProcessingCompleted",null==oa.e?null:oa.e.toString());break;case 8:ie="ImmediateSetData";yb("ClientStopwatchId",oa.a);yb("Operation",oa.b);yb("Parameters",
oa.c);yb("WasUpdatedByImmediate",null==oa.d?null:oa.d.toString());yb("areHtmlElementsEqualClientComparison",null==oa.e?null:oa.e.toString());yb("WasDecisionMadeByHtmlComparison",null==oa.f?null:oa.f.toString());yb("IsNumeric",null==oa.g?null:oa.g.toString());yb("IsDateTime",null==oa.h?null:oa.h.toString());yb("HasCurrencySymbol",null==oa.i?null:oa.i.toString());yb("HasPercentSymbol",null==oa.j?null:oa.j.toString());yb("IsFunc",null==oa.k?null:oa.k.toString());yb("DiffInWrappingWhitespace",null==oa.l?
null:oa.l.toString());yb("ImmediatePattern",oa.m);yb("TextAlignmentMatch",null==oa.n?null:oa.n.toString());yb("FontColorMatch",null==oa.o?null:oa.o.toString());yb("FormulaTextMatch",null==oa.p?null:oa.p.toString());yb("isFormula",null==oa.q?null:oa.q.toString());yb("FormulaText",oa.r);yb("InstantaneousPattern",oa.s);yb("AreHtmlInnerTextElementsEqualClientComparison",null==oa.t?null:oa.t.toString());yb("HtmlComparisonDecision",oa.u);break;case 9:ie="DependentCellsCalc";yb("CalcStatus",oa.a);yb("SuccessfullyCalculatedRanges",
null==oa.b?null:oa.b.toString());yb("RangesSkipped",null==oa.c?null:oa.c.toString());yb("TotalErrors",null==oa.d?null:oa.d.toString());yb("Partial",null==oa.e?null:oa.e.toString());yb("Canceled",null==oa.f?null:oa.f.toString());yb("Aggregate",null==oa.g?null:oa.g.toString());yb("Unknown",null==oa.h?null:oa.h.toString());yb("UnavailableData",null==oa.i?null:oa.i.toString());yb("Cycle",null==oa.j?null:oa.j.toString());yb("NotImplemented",null==oa.k?null:oa.k.toString());yb("InvalidInput",null==oa.l?
null:oa.l.toString());yb("AreDepCells",null==oa.m?null:oa.m.toString());break;case 10:ie="DependentCellsGraphStat";yb("ParsedFormulas",null==oa.a?null:oa.a.toString());yb("GraphNodes",null==oa.b?null:oa.b.toString());yb("GraphArcs",null==oa.c?null:oa.c.toString());yb("AnalyzedBlocks",null==oa.d?null:oa.d.toString());yb("IterationId",null==oa.e?null:oa.e.toString());yb("UniqueId",oa.f);yb("Aborted",null==oa.g?null:oa.g.toString());break;case 11:ie="DependentCellsGraphSectionStat";yb("IterationId",
null==oa.a?null:oa.a.toString());yb("BlockHash",oa.b);yb("Functions",oa.c);yb("Operators",oa.d);yb("CrossDocRefs",null==oa.e?null:oa.e.toString());yb("CrossSheetRefs",null==oa.f?null:oa.f.toString());yb("ErrRefs",null==oa.g?null:oa.g.toString());yb("LargeRanges",null==oa.h?null:oa.h.toString());yb("NameRefs",null==oa.i?null:oa.i.toString());yb("ParserErrors",null==oa.j?null:oa.j.toString());yb("RowRefs",null==oa.k?null:oa.k.toString());yb("ColumnRefs",null==oa.l?null:oa.l.toString());yb("TableRefs",
null==oa.m?null:oa.m.toString());yb("UniqueId",oa.n);yb("UnreachableReferences",null==oa.o?null:oa.o.toString());break;case 12:ie="GetRangeContentPrefetchFailures";yb("UserSessionId",oa.a);yb("ClientStopwatchId",oa.b);yb("StateId",null==oa.c?null:oa.c.toString());break;case 13:ie="GridBlockUpdates";yb("UserSessionId",oa.a);yb("CorrelationId",oa.b);yb("Operation",oa.c);yb("PerformanceType",null==oa.d?null:oa.d.toString());yb("BlockHash",oa.e);yb("DurationInMs",null==oa.f?null:oa.f.toString());break;
case 14:ie="BrowserAppStart";yb("ScriptExecutionStart",null==oa.a?null:Pb.a.hra(oa.a.getTime()));yb("UserSessionId",oa.b);yb("ClockMechanism",oa.c);yb("ScreenDPI",null==oa.d?null:oa.d.toString());yb("NavigationToScriptExecutionDelta",null==oa.e?null:oa.e.toString());break;case 15:ie="LinkedObjects";yb("ChildId",oa.a);yb("ParentId",oa.b);yb("ChildTable",oa.c);yb("ParentTable",oa.d);break;case 16:ie="LongFrames";yb("StartTime",null==oa.a?null:Pb.a.hra(oa.a.getTime()));yb("DurationInMs",null==oa.b?null:
oa.b.toString());break;case 17:ie="Task";yb("StopwatchId",oa.a);yb("Status",null==oa.b?null:oa.b.toString());yb("CreateTime",null==oa.c?null:oa.c.toString());yb("TaskId",null==oa.d?null:oa.d.toString());break;case 18:ie="ConflictInEditing";yb("OtherUserState",oa.a);yb("UserSessionId",oa.b);yb("ConflictTime",null==oa.c?null:Pb.a.hra(oa.c.getTime()));break;case 19:ie="IncomingPresenceData";yb("UserSessionId",oa.a);yb("UserId",oa.b);yb("Disconnected",null==oa.c?null:oa.c.toString());yb("ReceivedTime",
null==oa.d?null:Pb.a.hra(oa.d.getTime()));break;case 20:ie="EditorTableDelay";yb("UserSessionId",oa.a);yb("UserId",oa.b);yb("Received",null==oa.c?null:oa.c.toString());yb("DurationInMs",null==oa.d?null:oa.d.toString());yb("NotAloneAtLogTime",null==oa.e?null:oa.e.toString());yb("Time",null==oa.f?null:Pb.a.hra(oa.f.getTime()));break;case 21:ie="PresenceStartup";yb("UserSessionId",oa.a);yb("EverReceived",null==oa.b?null:oa.b.toString());yb("NotAloneOnOpen",null==oa.c?null:oa.c.toString());yb("NotAloneAtLogTime",
null==oa.d?null:oa.d.toString());yb("EditorCount",null==oa.e?null:oa.e.toString());yb("WorkbookOpenToFirstReceivedInMs",null==oa.f?null:oa.f.toString());break;case 22:ie="PresenceDelete";yb("UserSessionId",oa.a);yb("UserId",oa.b);yb("Context",oa.c);yb("Reason",oa.d);yb("Time",null==oa.e?null:Pb.a.hra(oa.e.getTime()));break;case 23:ie="EditorEvent";yb("UserSessionId",oa.a);yb("UserId",oa.b);yb("Context",oa.c);yb("Time",null==oa.d?null:Pb.a.hra(oa.d.getTime()));break;case 24:ie="EditorTime";yb("UserSessionId",
oa.a);yb("UserId",oa.b);yb("DurationInMs",null==oa.c?null:oa.c.toString());break;case 25:ie="GridScreenReaderOps";yb("UserSessionId",oa.a);yb("CommandTaskId",oa.b);yb("CommandId",null==oa.c?null:oa.c.toString());yb("ClientSideOnly",null==oa.d?null:oa.d.toString());yb("DurationInMS",null==oa.e?null:oa.e.toString());yb("ReachedMaxReadoutCells",null==oa.f?null:oa.f.toString());yb("RequstedCellCount",null==oa.g?null:oa.g.toString());yb("NonEmptyCellCount",null==oa.h?null:oa.h.toString());yb("Succeeded",
null==oa.i?null:oa.i.toString());yb("Canceled",null==oa.j?null:oa.j.toString());yb("ErrorType",oa.k);break;case 26:ie="SendPresenceToService";yb("UserSessionId",oa.a);yb("TotalCount",null==oa.b?null:oa.b.toString());yb("SendCount",null==oa.c?null:oa.c.toString());break;case 27:ie="IME";yb("UserSessionId",oa.a);break;case 28:ie="FreezePaneFloatingObjects";yb("UserSessionId",oa.a);yb("ObjectType",null==oa.b?null:oa.b.toString());yb("ObjectID",oa.c);yb("SpannedPanesCount",null==oa.d?null:oa.d.toString());
break;case 29:ie="CustomizeStatusBar";yb("UserSessionId",oa.a);yb("UIControlName",oa.b);yb("IsControlVisible",null==oa.c?null:oa.c.toString());break;case 30:ie="ClientWebRequests";yb("Path",oa.a);yb("ProxyStopwatchId",oa.b);yb("RequestStatus",oa.c);yb("ResponseSizeInBytes",null==oa.d?null:oa.d.toString());yb("ClientRequestId",oa.e);yb("StateId",null==oa.f?null:oa.f.toString());break;case 31:ie="ShowCommentTaskPane";yb("UserSessionId",oa.a);yb("IsFromKeyboardShortcut",null==oa.b?null:oa.b.toString());
yb("IsShowPane",null==oa.c?null:oa.c.toString());yb("ShowForDeepLink",null==oa.d?null:oa.d.toString());yb("DeepLinkFound",null==oa.e?null:oa.e.toString());break;case 32:ie="ApplyThreadedCommentChange";yb("UserSessionId",oa.a);yb("Operation",null==oa.b?null:oa.b.toString());yb("CommentId",oa.c);yb("CommentsCount",null==oa.d?null:oa.d.toString());break;case 33:ie="UpgradeLegacyCommentsChange";yb("UserSessionId",oa.a);yb("OperationSuccessful",null==oa.b?null:oa.b.toString());break;case 34:ie="FindNextOrPreviousComment";
yb("UserSessionId",oa.a);yb("Succeeded",null==oa.b?null:oa.b.toString());break;case 35:ie="Goto";yb("UserSessionId",oa.a);yb("IsSucceeded",null==oa.b?null:oa.b.toString());yb("IsNOVMode",null==oa.c?null:oa.c.toString());break;case 36:ie="LaunchOfficeAddInDialog";yb("UserSessionId",oa.a);yb("SourceId",oa.b);yb("SourceLabel",oa.c);yb("Flight",oa.d);yb("Experiment",oa.e);yb("UICultureTag",oa.f);yb("UICultureTagLcid",null==oa.g?null:oa.g.toString());yb("WacHostId",null==oa.h?null:oa.h.toString());break;
case 37:ie="RichApiInvocation";yb("UserSessionId",oa.a);yb("Succeeded",null==oa.b?null:oa.b.toString());yb("ErrorType",oa.c);yb("ResultInfo",oa.d);yb("Source",oa.e);break;case 38:ie="FxLibrary";yb("EntityName",oa.a);yb("EntryPoint",null==oa.b?null:oa.b.toString());yb("Action",null==oa.c?null:oa.c.toString());yb("InsertLocation",null==oa.d?null:oa.d.toString());break;case 39:ie="EmbeddedApiSession";yb("UserSessionId",oa.a);break;case 40:ie="NumberFormattingCalculator";yb("Id",oa.a);yb("CounterName",
oa.b);yb("Values",oa.c);break;case 41:ie="RequestDataAfterSend";yb("ClientStopwatchId",oa.a);yb("RequestStatus",oa.b);yb("SendDuration",null==oa.c?null:oa.c.toString());yb("RequestId",null==oa.d?null:oa.d.toString());break;case 42:ie="FloatingObjectsStopwatchData";yb("StopMessage",oa.a);yb("Type",null==oa.b?null:oa.b.toString());yb("GUID",oa.c);yb("Pane",null==oa.d?null:oa.d.toString());yb("IsAboveGrid",null==oa.e?null:oa.e.toString());yb("StartCorrelation",oa.f);yb("LoadImageCorrelation",oa.g);yb("SkippedGetEffectsExtents",
null==oa.h?null:oa.h.toString());yb("Version",null==oa.i?null:oa.i.toString());break;case 43:ie="Copy";yb("UserSessionId",oa.a);yb("Trigger",oa.b);yb("RibbonCommandName",oa.c);yb("SourceItem",oa.d);yb("SourceRangeCellCount",null==oa.e?null:oa.e.toString());yb("ClientSideStopwatchId",oa.f);yb("CopyOperationId",oa.g);yb("IsAsync",null==oa.h?null:oa.h.toString());yb("IsFromCache",null==oa.i?null:oa.i.toString());yb("IsSuccessiveCopy",null==oa.j?null:oa.j.toString());yb("IsSelectionAllowed",null==oa.k?
null:oa.k.toString());yb("IsSuccess",null==oa.l?null:oa.l.toString());yb("IsExpectedError",null==oa.m?null:oa.m.toString());yb("ExpectedErrorReason",oa.n);yb("ErrorMessage",oa.o);yb("ClientSideCopyTimeInMs",null==oa.p?null:oa.p.toString());yb("TotalTimeInMs",null==oa.q?null:oa.q.toString());yb("PlainTextPayloadSize",null==oa.r?null:oa.r.toString());yb("CopyPasteTargetType",oa.s);yb("ShadowWorkbookPayloadSize",null==oa.t?null:oa.t.toString());yb("HtmlPayloadSize",null==oa.u?null:oa.u.toString());yb("HtmlSizeExceedsLimit",
null==oa.v?null:oa.v.toString());yb("CopyTotalSizeExceedsLimit",null==oa.w?null:oa.w.toString());yb("ErrorReason",null==oa.x?null:oa.x.toString());yb("ErrorName",oa.y);yb("IsSucceededWithAlert",null==oa.z?null:oa.z.toString());yb("EncounteredDeploymentErrors",null==oa.ba?null:oa.ba.toString());yb("ShadowWorkbookSizeExceedsLimit",null==oa.bb?null:oa.bb.toString());yb("CopyPasteTargetName",oa.bc);yb("CCPSliceName",oa.bd);yb("SyncClipboardItemsKeys",oa.be);yb("AsyncClipboardItemsKeys",oa.bf);yb("CopyPasteHandlerName",
oa.bg);yb("SucceededPopulatingSystemClipboardSync",oa.bh);yb("SucceededPopulatingSystemClipboardAsync",oa.bi);yb("Location",oa.bj);yb("CopyContextId",oa.bk);yb("ServerRequestTimeInMs",null==oa.bl?null:oa.bl.toString());yb("EcsOperationDuration",null==oa.bm?null:oa.bm.toString());yb("EcsRequestDuration",null==oa.bn?null:oa.bn.toString());yb("WfeRequestDuration",null==oa.bo?null:oa.bo.toString());yb("OriginalSourceRangesCountExceedsLimit",null==oa.bp?null:oa.bp.toString());yb("UploadToClipServiceAttempted",
null==oa.bq?null:oa.bq.toString());yb("FloatingObjectType",null==oa.br?null:oa.br.toString());break;case 44:ie="Paste";yb("UserSessionId",oa.a);yb("Trigger",oa.b);yb("RibbonCommandName",oa.c);yb("PasteTypeFlagValue",null==oa.d?null:oa.d.toString());yb("PasteOperationId",oa.e);yb("CopyOperationId",oa.f);yb("ClientSideStopwatchId",oa.g);yb("OriginalDestinationRange",oa.h);yb("ExpandDestinationRange",oa.i);yb("SourceItem",oa.j);yb("SourceRangeCellCount",null==oa.k?null:oa.k.toString());yb("IsSuccess",
null==oa.l?null:oa.l.toString());yb("IsExpectedError",null==oa.m?null:oa.m.toString());yb("ClipboardFormatReadTimeInMs",oa.n);yb("ClipboardFormatReadStatus",oa.o);yb("ClipboardReadPermissionPromptShown",null==oa.p?null:oa.p.toString());yb("AsyncApiReadTimedOut",null==oa.q?null:oa.q.toString());yb("ExpectedErrorReason",oa.r);yb("ErrorMessage",oa.s);yb("TotalTimeInMs",null==oa.t?null:oa.t.toString());yb("PlainTextPayloadSize",null==oa.u?null:oa.u.toString());yb("ShadowWorkbookPayloadSize",null==oa.v?
null:oa.v.toString());yb("HtmlPayloadSize",null==oa.w?null:oa.w.toString());yb("CopyPasteTargetType",oa.x);yb("IsLastCopyWasExternal",null==oa.y?null:oa.y.toString());yb("IsClipboardDataContainShadowWorkbook",null==oa.z?null:oa.z.toString());yb("IsShadowWorkbookParsedSuccessfully",null==oa.ba?null:oa.ba.toString());yb("ActiveSelectionType",oa.bb);yb("PasteResult",oa.bc);yb("ErrorReason",null==oa.bd?null:oa.bd.toString());yb("ErrorName",oa.be);yb("IsSucceededWithAlert",null==oa.bf?null:oa.bf.toString());
yb("IsAfterCut",null==oa.bg?null:oa.bg.toString());yb("EncounteredDeploymentErrors",null==oa.bh?null:oa.bh.toString());yb("IsCrossSession",null==oa.bi?null:oa.bi.toString());yb("ShadowWorkbookSizeExceedsLimit",null==oa.bj?null:oa.bj.toString());yb("ClipboardContainXLOPayload",null==oa.bk?null:oa.bk.toString());yb("CopyPasteTargetName",oa.bl);yb("ChromeExtensionId",oa.bm);yb("PayloadOrigin",oa.bn);yb("PayloadType",oa.bo);yb("CCPSliceName",oa.bp);yb("ClipboardItemsKeys",oa.bq);yb("CopyPasteHandlerName",
oa.br);yb("IsSourceItemOriginSameSession",null==oa.bs?null:oa.bs.toString());yb("Location",oa.bt);yb("ExternalAppSource",oa.bu);yb("PasteContextId",oa.bv);yb("ServerRequestTimeInMs",null==oa.bw?null:oa.bw.toString());yb("IndicationDisplayScheduled",null==oa.bx?null:oa.bx.toString());yb("PasteIndicationDisplayStatus",oa.by);yb("PasteRecoveryUIDisplayed",null==oa.bz?null:oa.bz.toString());yb("IsFromPasteRecoveryUI",null==oa.ca?null:oa.ca.toString());yb("EcsOperationDuration",null==oa.cb?null:oa.cb.toString());
yb("EcsRequestDuration",null==oa.cc?null:oa.cc.toString());yb("WfeRequestDuration",null==oa.cd?null:oa.cd.toString());yb("OriginalSourceRangesCountExceedsLimit",null==oa.ce?null:oa.ce.toString());yb("PasteRecoveryUndoStopwatchId",oa.cf);yb("PasteRecoveryUndoTimeInMs",null==oa.cg?null:oa.cg.toString());yb("PasteCSEPerformed",null==oa.ch?null:oa.ch.toString());yb("CSEStatus",null==oa.ci?null:oa.ci.toString());yb("IsFromEnterShortcut",null==oa.cj?null:oa.cj.toString());break;case 45:ie="DragDrop";yb("UserSessionId",
oa.a);yb("Trigger",oa.b);yb("RibbonCommandName",oa.c);yb("OperationId",oa.d);yb("ClientSideStopwatchId",oa.e);yb("SourceRange",oa.f);yb("DestinationRange",oa.g);yb("CutCopyType",oa.h);yb("IsShiftKeyDown",null==oa.i?null:oa.i.toString());yb("IsDragInsert",null==oa.j?null:oa.j.toString());yb("IsSuccess",null==oa.k?null:oa.k.toString());yb("IsExpectedError",null==oa.l?null:oa.l.toString());yb("ExpectedErrorReason",oa.m);yb("ErrorMessage",oa.n);yb("TotalTimeInMs",null==oa.o?null:oa.o.toString());yb("ErrorName",
oa.p);yb("IsSucceededWithAlert",null==oa.q?null:oa.q.toString());yb("CopyPasteTargetType",oa.r);yb("EncounteredDeploymentErrors",null==oa.s?null:oa.s.toString());break;case 46:ie="ClearCopyState";yb("UserSessionId",oa.a);yb("ClientSideStopwatchId",oa.b);yb("Trigger",oa.c);yb("IsClearClipboard",null==oa.d?null:oa.d.toString());yb("IsExplicit",null==oa.e?null:oa.e.toString());yb("IsSuccess",null==oa.f?null:oa.f.toString());yb("ErrorMessage",oa.g);yb("ErrorName",oa.h);yb("TotalTimeInMs",null==oa.i?null:
oa.i.toString());yb("CopyPasteTargetType",oa.j);break;case 47:ie="WebWorkerRecalcStats";yb("SuccessCount",null==oa.a?null:oa.a.toString());yb("FailureCount",null==oa.b?null:oa.b.toString());yb("ValueTypeMismatchCount",null==oa.c?null:oa.c.toString());yb("CellValueMismatchCount",null==oa.d?null:oa.d.toString());yb("IfmtMismatchCount",null==oa.e?null:oa.e.toString());yb("FormattedTextMismatchCount",null==oa.f?null:oa.f.toString());yb("CellValueStringMismatchCount",null==oa.g?null:oa.g.toString());yb("CellValueNumberMismatchCount",
null==oa.h?null:oa.h.toString());yb("CellValueBooleanMismatchCount",null==oa.i?null:oa.i.toString());yb("CellValueBlankMismatchCount",null==oa.j?null:oa.j.toString());yb("CellValueErrorMismatchCount",null==oa.k?null:oa.k.toString());yb("FormattedTextStringMismatchCount",null==oa.l?null:oa.l.toString());yb("FormattedTextNumberMismatchCount",null==oa.m?null:oa.m.toString());yb("FormattedTextBooleanMismatchCount",null==oa.n?null:oa.n.toString());yb("FormattedTextBlankMismatchCount",null==oa.o?null:oa.o.toString());
yb("FormattedTextErrorMismatchCount",null==oa.p?null:oa.p.toString());yb("StringMismatchCount",null==oa.q?null:oa.q.toString());yb("NumericMismatchCount",null==oa.r?null:oa.r.toString());yb("ErrorMismatchCount",null==oa.s?null:oa.s.toString());yb("StringValuesCount",null==oa.t?null:oa.t.toString());yb("NumericValuesCount",null==oa.u?null:oa.u.toString());yb("BooleanValuesCount",null==oa.v?null:oa.v.toString());yb("BlankValuesCount",null==oa.w?null:oa.w.toString());yb("ErrorValuesCount",null==oa.x?
null:oa.x.toString());yb("NumericValuesDiffAverage",null==oa.y?null:oa.y.toString());yb("NumericEvaluatedValuesMismatchSamples",oa.z);yb("NumericFormattedTextMismatchSamples",oa.ba);yb("NumericMismatchSamples",oa.bb);yb("CellValueTypeMismatchSamples",oa.bc);yb("IfmtMismatchSamples",oa.bd);yb("BlockHashCode",oa.be);break;case 48:ie="DataValidationEditOpenDialog";yb("ServerCommand",oa.a);yb("SubDialogOpened",null==oa.b?null:oa.b.toString());yb("SubDialogButtonClicked",oa.c);yb("DialogOpened",null==
oa.d?null:oa.d.toString());yb("RuleType",oa.e);yb("ConditionType",oa.f);yb("LowerBoundaryFilled",null==oa.g?null:oa.g.toString());yb("UpperBoundaryFilled",null==oa.h?null:oa.h.toString());yb("IgnoreBlank",null==oa.i?null:oa.i.toString());yb("InCellDropdown",null==oa.j?null:oa.j.toString());yb("ShowInputMessage",null==oa.k?null:oa.k.toString());yb("InputTitleFilled",null==oa.l?null:oa.l.toString());yb("InputMessageFilled",null==oa.m?null:oa.m.toString());yb("ShowErrorAlert",null==oa.n?null:oa.n.toString());
yb("AlertBlocking",null==oa.o?null:oa.o.toString());yb("AlertTitleFilled",null==oa.p?null:oa.p.toString());yb("AlertMessageFilled",null==oa.q?null:oa.q.toString());yb("StopWatchId",oa.r);break;case 49:ie="DataValidationEditSubmitRule";yb("RuleType",oa.a);yb("ConditionType",oa.b);yb("LowerBoundaryFilled",null==oa.c?null:oa.c.toString());yb("UpperBoundaryFilled",null==oa.d?null:oa.d.toString());yb("IgnoreBlank",null==oa.e?null:oa.e.toString());yb("InCellDropdown",null==oa.f?null:oa.f.toString());yb("ShowInputMessage",
null==oa.g?null:oa.g.toString());yb("InputTitleFilled",null==oa.h?null:oa.h.toString());yb("InputMessageFilled",null==oa.i?null:oa.i.toString());yb("ShowErrorAlert",null==oa.j?null:oa.j.toString());yb("AlertBlocking",null==oa.k?null:oa.k.toString());yb("AlertTitleFilled",null==oa.l?null:oa.l.toString());yb("AlertMessageFilled",null==oa.m?null:oa.m.toString());yb("ClearAllPressed",null==oa.n?null:oa.n.toString());yb("ActionStatus",oa.o);yb("Error",oa.p);yb("StopWatchId",oa.q);break;case 50:ie="CustomSort";
yb("RangeType",oa.a);yb("HasHeaders",null==oa.b?null:oa.b.toString());yb("SortTopToBottom",null==oa.c?null:oa.c.toString());yb("ColumnCount",null==oa.d?null:oa.d.toString());yb("RowCount",null==oa.e?null:oa.e.toString());yb("RangeLimitExceeded",null==oa.f?null:oa.f.toString());yb("CaseSensitive",null==oa.g?null:oa.g.toString());yb("GetSortInfoDuration",null==oa.h?null:oa.h.toString());yb("LevelCount",null==oa.i?null:oa.i.toString());yb("SortOnValuesCount",null==oa.j?null:oa.j.toString());yb("SortOnCellColorCount",
null==oa.k?null:oa.k.toString());yb("SortOnFontColorCount",null==oa.l?null:oa.l.toString());yb("SortOnIconCount",null==oa.m?null:oa.m.toString());yb("CustomOrderCount",null==oa.n?null:oa.n.toString());yb("AvgCellColorCount",null==oa.o?null:oa.o.toString());yb("MaxCellColorCount",null==oa.p?null:oa.p.toString());yb("AvgFontColorCount",null==oa.q?null:oa.q.toString());yb("MaxFontColorCount",null==oa.r?null:oa.r.toString());yb("AvgIconsCount",null==oa.s?null:oa.s.toString());yb("MaxIconsCount",null==
oa.t?null:oa.t.toString());yb("Executed",null==oa.u?null:oa.u.toString());break;case 51:ie="NamedSheetViewUserAction";yb("UserSessionId",oa.a);yb("UserActionName",oa.b);yb("UserActionSource",null==oa.c?null:oa.c.toString());yb("UserActionData",oa.d);yb("OtherData",oa.e);break;case 52:ie="NamedSheetViewTeachingCallout";yb("UserSessionId",oa.a);yb("TeachingCalloutSequence",null==oa.b?null:oa.b.toString());yb("TeachingCalloutIndex",null==oa.c?null:oa.c.toString());yb("UserActionName",null==oa.d?null:
oa.d.toString());yb("UserActionData",oa.e);yb("DurationInMs",null==oa.f?null:oa.f.toString());break;case 53:ie="NamedSheetViewTeachingDialog";yb("UserSessionId",oa.a);yb("UserActionName",oa.b);yb("ButtonClicked",oa.c);yb("DurationInMs",null==oa.d?null:oa.d.toString());yb("IsNewTeachingDialog",null==oa.e?null:oa.e.toString());break;case 54:ie="NamedSheetViewOptionsDialog";yb("UserSessionId",oa.a);yb("OptionsAction",null==oa.b?null:oa.b.toString());yb("OptionsActionData",oa.c);yb("OptionsOtherData",
oa.d);yb("DurationInMs",null==oa.e?null:oa.e.toString());break;case 55:ie="NamedSheetViewTempViewApplyDialog";yb("UserSessionId",oa.a);yb("TriggeredFrom",oa.b);yb("ButtonClicked",oa.c);yb("DurationInMs",null==oa.d?null:oa.d.toString());break;case 56:ie="NamedSheetViewTempViewSaveDialog";yb("UserSessionId",oa.a);yb("TriggeredFrom",oa.b);yb("ButtonClicked",oa.c);yb("NameUpdated",null==oa.d?null:oa.d.toString());yb("DurationInMs",null==oa.e?null:oa.e.toString());break;case 57:ie="TemporaryViewStartedDataRestore";
yb("UserSessionId",oa.a);yb("CountOfTempViews",null==oa.b?null:oa.b.toString());break;case 58:ie="TemporaryViewFetchedVersion";yb("UserSessionId",oa.a);yb("NumberOfBytes",null==oa.b?null:oa.b.toString());break;case 59:ie="RaiseEventsAndGenerateBlockRequests";yb("ReturnContentStatus",null==oa.a?null:oa.a.toString());yb("CacheState",null==oa.b?null:oa.b.toString());yb("FromXhrCallback",null==oa.c?null:oa.c.toString());yb("AreGeneralErrorsPresent",null==oa.d?null:oa.d.toString());yb("BlockCacheItemHash",
oa.e);yb("StopwatchId",oa.f);yb("BlockCacheItemProcessingStopwatchId",oa.g);yb("StateId",null==oa.h?null:oa.h.toString());yb("IsHighPriority",null==oa.i?null:oa.i.toString());yb("CalcComplete",null==oa.j?null:oa.j.toString());yb("EditedCellsUpdatedByCse",null==oa.k?null:oa.k.toString());yb("DependentCellsUpdatedByCse",null==oa.l?null:oa.l.toString());yb("Revision",null==oa.m?null:oa.m.toString());yb("SheetProcessedDataVersion",null==oa.n?null:oa.n.toString());yb("RefCount",null==oa.o?null:oa.o.toString());
yb("ExistsInView",null==oa.p?null:oa.p.toString());yb("ContentSource",null==oa.q?null:oa.q.toString());break;case 60:ie="LaunchMakerCodeEditor",yb("SessionId",oa.a),yb("Command",oa.b),yb("IsPreviewGallery",null==oa.c?null:oa.c.toString()),yb("MenuItemId",oa.d),yb("ScriptId",oa.e),yb("ShareId",oa.f),yb("IsOwner",null==oa.g?null:oa.g.toString()),yb("PublishedScriptCount",null==oa.h?null:oa.h.toString()),yb("RecentScriptCount",null==oa.i?null:oa.i.toString()),yb("WorkbookScriptCount",null==oa.j?null:
oa.j.toString())}Dd.Table=ie;return Sys.Serialization.JavaScriptSerializer.serialize(Dd)}function x(){this.Zna=new y}function y(){}function J(ya){var oa=eg.call(this)||this;oa.$=ya;oa.Yb();return oa}function E(ya){var oa=ih.call(this)||this;oa.Skb=-1;oa.Sld=0;oa.Ava=null;oa.AX=null;oa.Kga={};oa.lsa=new bc.a;oa.O4a=!1;oa.vEd=!1;oa.$_a=null;oa.U5a=0;oa.muc=0;oa.lJa=0;oa.isSynthetic=!1;oa.rxb=new Date;oa.nf=new W;oa.nf.LDa(Object(Fc.a)(oa,oa.QU,"onDocumentHidden"));Rc.AFrameworkApplication.hPc(Object(Fc.a)(oa,
oa.Hjf,"onAppSleep"));Rc.AFrameworkApplication.iPc(Object(Fc.a)(oa,oa.Jjf,"onAppWakeup"));oa.$=ya;oa.hdf=ya.ya.LongFrameThresholdMs;oa.Cei="MoreThan_"+oa.hdf.toString()+"_Ms";oa.npj=ya.ya.ThresholdToEndOperationTrackingSeconds;oa.opj=ya.ya.ThresholdToStopFPSTrackingMS;oa.Ca=ge.g(oa.$).Ca;Rc.AFrameworkApplication.Fb&&Rc.AFrameworkApplication.Fb.IsSynthetic&&(oa.isSynthetic=hf.a.compare(Rc.AFrameworkApplication.Fb[Se.a.isSynthetic],"True",!0)?!1:!0);oa.Ca.Np(Object(Fc.a)(oa,oa.Sg,"onBlockCacheConsistent"));
oa.PDd();oa.kdi=oa.$.Tua&&Pe.EwaSettings.ka(621);return oa}function A(ya,oa,yb,Dd,ie,xe,Lf,ph,Sf,Zg){ph=void 0===ph?-1:ph;this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===ya?null:ya;this.count=void 0===oa?0:oa;this.start=void 0===yb?-1:yb;this.end=void 0===Dd?-1:Dd;this.Avg=void 0===ie?0:ie;this.Max=void 0===xe?-1:xe;this.Min=Ih.a.E7f;this.longFrameCount=void 0===Lf?0:Lf;this.coauth=
ph?ph:1;this.tfAppInt=void 0===Sf?-1:Sf;this.Props=void 0===Zg?null:Zg;this.LFrame=null}function H(ya,oa){this.duration=this.startSecond=0;this.startSecond=void 0===ya?-1:ya;this.duration=void 0===oa?-1:oa}function S(){this.f=null}function Q(ya){var oa=this;this.svd={};this.vfa=null;this.df=new L;this.$Vg();ya.ea.$a(276,function(){Qf.a(ya).jfa(oa.df)})}function L(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}function aa(ya){this.name=null;this.count=0;
this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new fa;this.l2FramePerformanceData=new fa;this.l3FramePerformanceData=new fa;this.name=ya}function fa(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}function W(){var ya=vg.call(this)||this;ya.JK=!1;ya.F2d=null;ya.G2d=null;ya.ZX=te.a.instance.pra();ya.hk=te.a.instance.BB();ya.ZX.ja("visibilitychange",Object(Fc.a)(ya,ya.gtd,
"onDocumentVisibilityChange"));ya.hk.ja("pagehide",Object(Fc.a)(ya,ya.bxi,"onPageHide"));ya.J2f();return ya}function G(ya){this.gye=!1;this.iye=null;this.$=ya;this.oYf=new Set;this.TNd=new Set;this.$.va&&this.$.va.qa&&this.TNd.add(this.$.va.qa.name);ge.g(this.$).ga.GF(Object(Fc.a)(this,this.$c,"onSelectionChanged"));this.$.va.Pf(Object(Fc.a)(this,this.Ai,"onActiveSheetChanged"))}function N(ya){hd.ULS.sendTraceTag(537151049,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");
zc.TaskExtensions.Aa(Nh.a.mq(we.a.instance.oc("Common.ICpuMeterProvider")),function(oa){hd.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");zc.TaskExtensions.Aa(oa.result.Hl.task,function(yb){hd.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");var Dd=new Y(ya);yb.result.zOc(0,Object(Fc.a)(Dd,Dd.Qlh,"filterTaskEvent"),Object(Fc.a)(Dd,Dd.Crj,"traceTaskEvent"))},
ya.la,3)},ya.la,3)}function Y(ya){var oa=this;this.nf=null;this.lOd=ya.ya.TimeToReportOnLongWaitingTaskInMsAsWarning;this.kOd=ya.ya.TimeToReportOnLongWaitingTaskInMsAsMedium;this.jOd=ya.ya.TimeToReportOnLongRunningTaskInMsAsWarning;this.iOd=ya.ya.TimeToReportOnLongRunningTaskInMsAsMedium;this.fa=ya.fa;ya.ea.$a(291,function(yb){oa.nf=yb});hd.ULS.sendTraceTag(537151046,0,50,"TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = {0}, TimeToReportOnLongWaitingTaskInMsAsWarning = {1}, TimeToReportOnLongRunningTaskInMsAsMedium = {2}, TimeToReportOnLongRunningTaskInMsAsWarning = {3}",
this.kOd,this.lOd,this.iOd,this.jOd)}function V(ya){this.Gqa=[];this.VUc=null;this.iii=100;this.documentVisibilityObserver=null;this.hii=ya}function da(ya,oa){this.F4c=0;this.BIe=this.startTime=Bc.HelperMethods.Ac();this._name=ya;this.gB=oa}function U(ya,oa){this.stopped=!1;this.chainedCallsTracer=ya;this.M$f=oa}function Z(ya){this.QQc="AppUnloadInfo";this.hk=this.$=this.workbookHashedId=this.Qx=null;this.SUd=this.tYd=!1;this.wf=null;this.K0e=0;this.localStorage=new hg.a;this.NGf=Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");
this.localStorage.Yf()&&(this.$=ya,this.workbookHashedId=qe.a(this.$),this.Qx=new ra(this.workbookHashedId,this.$.ya.UserSessionId),this.hk=te.a.instance.BB(),this.hk.ja("beforeunload",Object(Fc.a)(this,this.Lzb,"onBeforeUnload")),this.$.userOperationManager.Vug(Object(Fc.a)(this,this.Vtf,"onUserOperationsLost")),ya.fa.Wh?this.kMf():this.$.fa.oo(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive")),this.wf=this.$.fa.wf,this.wf.Vpa(Object(Fc.a)(this,this.Vaa,"onThrottledUserActivity")),
Sys.Application.add_unload(Object(Fc.a)(this,this.oBb,"onUnload")),Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&this.$.fa.bQc(Object(Fc.a)(this,this.Nzi,"onSilentReopenTriggered")))}function ca(ya){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=ya.Jre+ya.B0f;this.dataLossReason=ya.Qne;this.yGg(ya.PRd)}function ra(ya,oa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=
!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=
ya;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=oa}function La(ya){var oa=Dg.call(this)||this;oa.vka=null;oa.dla=null;oa.vxe=Array(1);oa.iod=null;oa.oHc=null;oa.$=ya;if(!Pe.EwaSettings.ka(41))return oa;Sd.a.TUh(oa.$);oa.mM=new Tb(oa.$);oa.lVg();Pe.EwaSettings.ka(622)&&oa.i5a&&(oa.iod=new Fa(oa.$,oa.i5a));oa.zH=new na(oa.$);oa.Uja=new Ha(oa.$);oa.$.dn(Object(Fc.a)(oa,oa.Pd,"onWorkbookClosing"));
oa.$.ra.Yr(Object(Fc.a)(oa,oa.Oh,"onWebMethodSuccess"));oa.$.ra.lB(Object(Fc.a)(oa,oa.Io,"onWebMethodError"));oa.$.fa.Cfe(Object(Fc.a)(oa,oa.Cdc,"isUsingOcsChanged"));Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&oa.$.fa.oo(Object(Fc.a)(oa,oa.Ih,"onCommandUIGeneratedAndGridInteractive"));return oa}function na(ya){this.dirtySessionOnLastRecordedRequest=this.ULd=!1;this.sbf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=ya;this.ujb={};this.tjb={};this.F_c={}}function ma(ya,
oa,yb,Dd,ie,xe,Lf,ph){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=ya;this.ocsCapable=oa;this.endedBySplashScreen=yb;this.dirtySessionOnLastRecordedRequest=Dd;this.loadOnDemandCount=ie;this.maxCoauthorsCount=xe;this.everConnectedToOcs=Lf;ya=[];for(var Sf in ph)oa=ph[Sf],oa.N5c(),ya.push(oa.data);this.requests=ya}function xa(ya){this.data=new Pa;
this.data.requestName=ya;this.data.totalCount=0;this.r9a=[];this.ZOd=this.POd=this.QOd=this.WOd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=-1}function Pa(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=
this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}function ib(ya,oa){this.data=new pb;this.data.operationName=ya;this.data.isUserOperation=oa;this.data.totalCount=0;this.GVf=[];this.HVf=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles=
"";this.data.startToResponsePercentiles=""}function pb(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}function xb(ya,oa,yb){this.$=ya;this.zH=oa;this.Uja=yb}function Ya(){}function ab(ya,oa,yb,Dd,ie,xe,Lf,ph,Sf,Zg,Bh,ti,ci,fi,$h,Th,mg){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=
this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=ya;this.isUserTriggeredRequest=
ab.RBh(ya);this.isFullyLoggedKPIRequest=ab.OBh(ya);this.isPromotedUTRRequest=ab.PBh(ya);this.requestDuration=oa;this.totalOperationDuration=yb;this.requestTimeInQueue=Dd;this.requestInvokedTime=ie;this.ecsOperationDuration=xe.EcsOperationDuration;this.EcsRequestDuration=xe.EcsRequestDuration;this.WfeRequestDuration=xe.WfeRequestDuration;this.TimeFromLastEcsFreeze=xe.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=xe.DuringLoadOnDemand;this.correlationID=Lf;this.errors=ab.BPg(ph);this.httpStatus=Sf;
this.requestResourceTiming=Zg;this.communicationErrorRetryCount=Bh;this.successfulCall=ti;this.isDocumentHidden=ci;this.coauthorsCount=fi;this.responseSize=$h;this.networkInfoData=Th;this.responseToCallbackTime=mg}function ea(ya,oa){this.messageIdName=null;this.errorCause=0;this.messageIdName=ya;this.errorCause=oa}function ta(ya,oa,yb,Dd){var ie=this;this.framePerformanceTracker=this.uEb=this.FZ=this.y_=null;this.$=ya;this.zH=oa;this.Kg=this.Kg||fg.a.Qa;this.kC=new bc.a;this.xD=new bc.a;this.KQc=
this.J4a=-1;this.gyb=new bc.a;this.operationsGroupDetector=new Ka;this.IFb=this.dcc=!1;this.WUh();this.BUh();this.AUh();this.sessionStatisticsManager=yb;this.mM=Dd;this.mM.Nfe(Object(Fc.a)(this,this.Aic,"onLongTaskObservedAction"));this.$.ea.$a(263,function(xe){ie.framePerformanceTracker=xe})}function Ka(){this.operationsGroups=null;this.zUh()}function mb(ya,oa,yb,Dd,ie,xe,Lf,ph,Sf,Zg){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=
this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===ya?"":ya;this.startTime=void 0===oa?-1:oa;this.startToNextFrame=void 0===yb?-1:yb;this.startToResponseRenderEnd=void 0===Dd?-1:Dd;this.wasHidden=void 0===ie?!1:ie;this.isUserOperation=void 0===xe?!0:xe;this.isGroupBreaking=void 0===Lf?!0:Lf;this.operationThatLedToLogging=void 0===Sf?"":Sf;this.startToOperationThatLedToLogging=void 0===Zg?-1:Zg;this.isPartOfGroup=void 0===
ph?!1:ph}function Ha(ya){var oa=Fb.call(this)||this;oa.statusBarManager=null;oa.NOc=!1;oa.$=ya;if(!Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry"))return oa;oa.uZ=oa.yPd("connection")||oa.yPd("mozConnection")||oa.yPd("webkitConnection");oa.uZ&&Pe.EwaSettings.ka(495)&&ya.ea.$a(29,function(yb){oa.statusBarManager=yb;yb.sI(oa);oa.uZ.addEventListener("change",Object(Fc.a)(oa,oa.fif,"notifyNetworkInfoChanged"));oa.NOc=!0});return oa}function Ga(){this.rttMs=this.bandwidthMps=
0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}function Fa(ya,oa){var yb=Kc.call(this)||this;yb.nf=null;yb.statusBarManager=null;yb.$=ya;yb.$.ea.$a(29,function(Dd){yb.statusBarManager=Dd;Dd.sI(yb)});yb.$.ea.$a(291,function(Dd){yb.nf=Dd});yb.kdf=0;yb.M$e=0;yb.Gei=ya.ya.LongTaskThresholdMs;yb.i5a=oa;yb.i5a.dtg(Object(Fc.a)(yb,yb.dpf,"onLongTaskTracked"));return yb}function eb(ya,oa){var yb=this;this.Oa=new yf.a;this.WKa=this.u4=this.gR=this.nf=null;this.s$e=this.hKd=this.Bdc=
!1;this.CLa=null;this.maxUsersCount=0;this.$=ya;this.c5f=ya.ya.LongTaskPerformanceVetoThreshold;this.Dei="PercentageOver_"+this.c5f.toString();this.god=ya.ya.LongTaskPerformanceWindowDurationInMs;this.mM=oa;this.r4f=Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.ea.$a(291,function(Dd){yb.nf=Dd;yb.ftc()});this.$.fa.Wh?this.Ih(this,Sys.EventArgs.Empty):this.$.fa.oo(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"));this.mM.ctg(Object(Fc.a)(this,
this.cpf,"onLongTaskPerformanceObserverInitialized"));this.$.Jk(Object(Fc.a)(this,this.jd,"onWorkbookOpened"));this.$.dn(Object(Fc.a)(this,this.Pd,"onWorkbookClosing"))}function db(ya){var oa=Ma.call(this)||this;oa.fod=ya;return oa}function Na(ya,oa,yb,Dd,ie){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=ya;this.entireSessionData=oa;this.worstWindowData=yb;this.postBootWindowData=Dd;this.maxUsersCount=ie}function kb(ya,
oa){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===ya?0:ya;this.longTaskDuration=void 0===oa?0:oa}function Tb(ya){this.Oa=new yf.a;this.FEc=!1;this.$=ya;this.$.fa.Wh?this.Ih(this,Sys.EventArgs.Empty):this.$.fa.oo(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"))}function ha(ya){var oa=Ye.call(this)||this;oa.vac=ya;return oa}function lb(ya){var oa=ye.call(this)||this;oa.MDe=ya;return oa}function Wa(ya,oa){this.entryTypes=null;this.buffered=
!1;this.entryTypes=ya;this.buffered=void 0===oa?!1:oa}function Ra(ya,oa){var yb=jd.call(this)||this;yb.CEb=!1;yb.Ecd=!1;yb.LRf=!0;yb.Oa=new yf.a;yb.mBc=!1;yb.$=ya;yb.Zrb=oa;yb.fa=ya.fa;yb.$.dn(Object(Fc.a)(yb,yb.Pd,"onWorkbookClosing"));yb.I0f=new oc;yb.TMa=new uc(Ke.a.EFd,ya.ya.PageGenerationMetrics.TimeToCompleteFirstFlush);yb.Jwc=new Yb(yb);return yb}function Yb(ya){this.RZb=[];this.dxg=null;this.sqmManager=ya}function oc(){this.bod=null;this.mNg=oc.SSg();this.cIf()}function zb(ya,oa,yb){this.KLc=
ya.keyCode;this.jGb(ya.ctrlKey,1);this.jGb(ya.shiftKey,2);this.jGb(ya.altKey,4);this.jGb(Kg.b(ya),8);this.jGb(yb,16);this.KLc=this.Bab|oa<<24}function uc(ya,oa){this.XMb=null;this.o1b=this.Jdd=!1;this.h9d=this.i9d=null;this.i2a=this.h2a=0;this.fLf=ya;this.r6d=oa}function P(ya){var oa=Ce.call(this)||this;oa.wT=ya;return oa}function lc(ya){var oa=zf.call(this)||this;oa.$=ya;oa.Yb();return oa}function Ec(ya){this.vHa=new Set;this.zIb=null;this.VWf=!1;this.Olb=new Zb;this.Olb.hasBlockedActions=!1;this.Mab=
new tc;this.Alh();this.$=ya;this.$.fa.oo(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"));this.$.dn(Object(Fc.a)(this,this.Pd,"onWorkbookClosing"))}function tc(){this.successfulActions=[]}function cc(){var ya=Aa.call(this)||this;ya.inputMethod=null;ya.isCommand=!1;return ya}function Zb(){this.hasBlockedActions=!1;this.blockedActions=[]}function Aa(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}function Ia(ya){var oa=Hf.call(this)||this;oa.$=ya;
oa.Yb();return oa}function qb(ya){this.AVf=this.zyd=this.c8a=this.Ayd=this.gzf=this.hzf=null;this.$Ji=new Set([1,0]);hd.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=ya;this.DWh();this.CWh();this.i9h=this.$.ya.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=Pe.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.Jte=Pe.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",
3E5);this.Alj()}function wb(){this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=
this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}function ic(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=
this.maximumNumberOfSamplesToTake=null}function Jb(ya,oa){this.Zzi=ya;this.aAi=oa}function Ua(){}function $a(){}function ua(){this.customProperties=new Map}function Ca(ya){this.xjj=ya}function Sa(ya){var oa=Kd.call(this)||this;oa.$=ya;oa.Yb();return oa}function Qb(ya){var oa=this;this.M$=null;if(Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5693908_UsingInteractivityTrackerFromSeparatedSlice2"))if(Qb.P5e)hd.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization.");
else{var yb=wc.GetServiceTaskFactory.Va(ya.ea,283,284,1,"Common.IDynamicScriptLoaderProvider");zc.TaskExtensions.Aa(yb,function(){window.interactivity=null;zc.TaskExtensions.Aa(Hd.c(yb.result.Cp.loadScript("interactivity")),function(){hd.ULS.sendTraceTag(537155544,0,50,"Interactivity slice is loaded");oa.initialize(ya)},ya.la,3)},ya.la,3);Qb.P5e=!0}else this.initialize(ya)}function Hb(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}function Db(ya){this.$=
ya}function jc(){this.coAuthCount=this.appState=null}function sb(ya){var oa=Ea.call(this)||this;oa.l2e=0;oa.qLe=!1;oa.Tld=Array(sb.z5a);oa.X0b=0;oa.$=ya;oa.Qvb=Pe.EwaSettings.ka(78);oa.W8e=Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");oa.VFj=Fg.a.BEh();oa.L$={};sb.ZTb||(sb.ZTb=new Uf.a(Gg.a.rl()),sb.ZUh(sb.ZTb));fb.KVh();if(Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(ya=0;ya<sb.z5a;ya++)oa.Tld[ya]="NA";return oa}
function fb(){this.commandSurface=this.triggerMethod=Fg.a.Nbb}function Qa(ya,oa,yb){ya=cb.call(this,ya.operation,ya.properties,ya.correlations)||this;ya.timeFromAppInteractive=0;ya.timeFromNavigationStart=0;ya.timeFromAppInteractive=oa;ya.timeFromNavigationStart=yb;return ya}function cb(ya,oa,yb){this.correlations=this.properties=this.operation=null;this.operation=ya;this.properties=oa;this.correlations=yb}function Ab(ya){var oa=Ef.call(this)||this;oa.Vse=!1;oa.$=ya;return oa}function gc(ya,oa,yb){oa=
wg.call(this,oa,yb)||this;oa.Oa=new Ve.a;oa.$=ya;yb!==Sg.a.x8&&oa.CDa(yb);oa.FWh();oa.UVh();ya=Object(Fc.a)(oa,oa.dSh,"hostMessageHandler");oa.xm(kc.a.Pdd,ya);oa.xm(kc.a.hnd,ya);oa.xm(kc.a.E$b,ya);oa.xm(kc.a.Tdd,ya);return oa}function Lc(){}function Nc(){}function yd(ya){this.mw=[];this.GNb=[];this._count=void 0===ya?1:ya}function Od(ya){this.teb=null;this.Hl=new bf.a;this.EK=ya}function sa(ya,oa,yb,Dd,ie){this.bDa=0;this.wF=null;this.WRb=this.E$d=0;this.U8d=!1;this.cTa=0;this.fgb=!1;this.Qoa=null;
this.cPb=0;this.O5d=new Ve.a;this.$Sb=[];this.EK=ya;this.pHc=oa;this.iDc=yb;this.X3d=Dd;Rc.AFrameworkApplication.ha&&Rc.AFrameworkApplication.ha.sa("WrapSetTimeoutForTelemetryIsEnabled")&&this.xld();this.dcg=ie;this.jDc=new Id(100);this.Sfg=Lb.o0a(1,5,new vb)}function vb(ya){ya=void 0===ya?null:ya;this.Fm=null;this.reset();this.oib=ya}function Lb(ya,oa,yb,Dd,ie,xe,Lf){xe=void 0===xe?!0:xe;Lf=void 0===Lf?null:Lf;this.GW=this.S$d=this.k2d=!1;this.fe=null;if(!ya)throw od.a.argument("taskManagerLazy");
if(!ie)throw od.a.argument("dataAggregator");this.Pkg=ya;this.sIc=oa;this._id=yb;this.N0d=6E4*Dd;this.yNb=ie;this.h8d=xe;this.oib=Lf;rc.wLh().qb(this._id.toString())&&(this.GW=!0)}function rc(){}function Oc(){}function Bb(){}function hc(ya){var oa=yc.call(this)||this;oa.rhf=ya;return oa}function Pc(){}function rd(){}function Id(ya,oa){var yb=this;this.vEc=!1;this.GBa={};this.WPb=void 0===ya?0:ya;this.fQb=void 0===oa?0:oa;this.SMc=0;Qe.a.addHandler(window.self,Bd.a.awg,function(){yb.vEc=!0});Qe.a.addHandler(window.self,
Bd.a.bwg,function(){yb.vEc=!1})}function Vd(){this.S=this.T=this.M=this.C=0}function He(){this.FSa=[];this.zXd=this.kBc=0;this.xda=null;this.Ya=new Ve.a}function Nd(ya,oa){var yb=Zc.call(this)||this;yb.ppj=ya;yb.actualValue=oa;return yb}function Vc(){this.Za=null}function fe(ya,oa,yb,Dd,ie){yb=void 0===yb?null:yb;Dd=void 0===Dd?null:Dd;ie=void 0===ie?100:ie;this.UFc=!1;this.Fi=null;this.ueb=0;this.Ya=new Ve.a;this.zdb=null;this.PW=!1;this.Eae=0;this.fe=ya;this.bYd=0;this.wRd=this;this.VBc=new kd(yb);
this.oea=oa;Dd&&(this.zdb=new lf(null,Dd,ie))}function Ee(ya){var oa=Oe.call(this)||this;oa.entries=ya;return oa}function lf(ya,oa,yb){this.ZUd=ya;this.OSb=void 0===oa?null:oa;this.udb={};this.J$f=void 0===yb?100:yb}function Da(ya,oa){this.s9=null;this.FMc=ya;this.behavior=oa;this.url=this.Jt.name}function fc(ya,oa,yb){this.ei=ya;this.wRd=this;this.Zcg=(void 0===oa?null:oa)||function(){return window.location.href};this.VBc=new kd(void 0===yb?null:yb)}function Ib(ya,oa){function yb(xe,Lf){null!=Lf&&
(Dd[xe]=Lf)}var Dd={},ie=null;switch(ya){case 0:ie="ResourceTiming";yb("Url",oa.a);yb("InitiatorType",oa.b);yb("RedirectStart",null==oa.c?null:oa.c.toString());yb("RedirectEnd",null==oa.d?null:oa.d.toString());yb("FetchStart",null==oa.e?null:oa.e.toString());yb("DomainLookupStart",null==oa.f?null:oa.f.toString());yb("DomainLookupEnd",null==oa.g?null:oa.g.toString());yb("ConnectStart",null==oa.h?null:oa.h.toString());yb("ConnectEnd",null==oa.i?null:oa.i.toString());yb("SecureConnectionStart",null==
oa.j?null:oa.j.toString());yb("RequestStart",null==oa.k?null:oa.k.toString());yb("ResponseStart",null==oa.l?null:oa.l.toString());yb("ResponseEnd",null==oa.m?null:oa.m.toString());yb("CustomText",oa.n);yb("DecodedBodySize",null==oa.o?null:oa.o.toString());yb("EncodedBodySize",null==oa.p?null:oa.p.toString());yb("TransferSize",null==oa.q?null:oa.q.toString());break;case 1:ie="PerformanceTiming",yb("Url",oa.a),yb("NavigationStart",null==oa.b?null:oa.b.toString()),yb("UnloadEventStart",null==oa.c?null:
oa.c.toString()),yb("UnloadEventEnd",null==oa.d?null:oa.d.toString()),yb("RedirectStart",null==oa.e?null:oa.e.toString()),yb("RedirectEnd",null==oa.f?null:oa.f.toString()),yb("FetchStart",null==oa.g?null:oa.g.toString()),yb("DomainLookupStart",null==oa.h?null:oa.h.toString()),yb("DomainLookupEnd",null==oa.i?null:oa.i.toString()),yb("ConnectStart",null==oa.j?null:oa.j.toString()),yb("ConnectEnd",null==oa.k?null:oa.k.toString()),yb("SecureConnectionStart",null==oa.l?null:oa.l.toString()),yb("RequestStart",
null==oa.m?null:oa.m.toString()),yb("ResponseStart",null==oa.n?null:oa.n.toString()),yb("ResponseEnd",null==oa.o?null:oa.o.toString()),yb("DomLoading",null==oa.p?null:oa.p.toString()),yb("DomInteractive",null==oa.q?null:oa.q.toString()),yb("DomContentLoadedEventStart",null==oa.r?null:oa.r.toString()),yb("DomContentLoadedEventEnd",null==oa.s?null:oa.s.toString()),yb("DomComplete",null==oa.t?null:oa.t.toString()),yb("LoadEventStart",null==oa.u?null:oa.u.toString()),yb("LoadEventEnd",null==oa.v?null:
oa.v.toString()),yb("CustomText",oa.w)}Dd.Table=ie;return Sys.Serialization.JavaScriptSerializer.serialize(Dd)}function Ta(ya,oa){this.s9=null;this.FMc=ya;this.url=oa}function kd(ya){this.Yyc=ya}function ce(){}function dc(){}function ub(){this.Version=this.Name=null}function pc(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=
this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}b.r(F);var xc=b(0),hd=b(15);Object(xc.a)(pc,"BrowserInfo",null,[]);Object(xc.a)(ub,"PluginInfo",null,[]);var Rc=b(5),ld=b(23);dc.Zci=function(){if(Rc.AFrameworkApplication.ha.sa("LogBrowserInfoIsEnabled")){var ya=
dc.Mqh();try{var oa=JSON.stringify(ya);hd.ULS.sendTraceTag(6903563,102,50,oa)}catch(yb){hd.ULS.sendTraceTag(6903564,102,15,yb.message)}}else hd.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")};dc.cFh=function(){var ya=window.navigator.plugins;if(!ya||!ya.length)return null;for(var oa=[],yb=0;yb<ya.length;yb++){var Dd=ya[yb].name,ie=ya[yb].version;Array.add(oa,Object.assign(new ub,{Name:Dd,Version:ie}))}return oa};dc.Mqh=function(){var ya=new pc,oa=new Sys.StringBuilder;
dc.ls(function(yb){ya.DocElemClientHeight=yb},function(){return document.documentElement.clientHeight},oa);dc.ls(function(yb){ya.DocElemClientWidth=yb},function(){return document.documentElement.clientWidth},oa);dc.ls(function(yb){ya.DocElemOffsetHeight=yb},function(){return document.documentElement.offsetHeight},oa);dc.ls(function(yb){ya.DocElemOffsetWidth=yb},function(){return document.documentElement.offsetWidth},oa);dc.ls(function(yb){ya.ScreenAvailHeight=yb},function(){return window.screen.availHeight},
oa);dc.ls(function(yb){ya.ScreenAvailWidth=yb},function(){return window.screen.availWidth},oa);dc.ls(function(yb){ya.ScreenWidth=yb},function(){return window.screen.width},oa);dc.ls(function(yb){ya.ScreenHeight=yb},function(){return window.screen.height},oa);dc.ls(function(yb){ya.ScreenLogicalXdpi=yb},function(){return window.screen.logicalXDPI},oa);dc.ls(function(yb){ya.ScreenLogicalYdpi=yb},function(){return window.screen.logicalYDPI},oa);dc.ls(function(yb){ya.ScreenDeviceXdpi=yb},function(){return window.screen.deviceXDPI},
oa);dc.ls(function(yb){ya.ScreenDeviceYdpi=yb},function(){return window.screen.deviceYDPI},oa);dc.ls(function(yb){ya.WinInnerHeight=yb},function(){return window.self.innerHeight},oa);dc.ls(function(yb){ya.WinInnerWidth=yb},function(){return window.self.innerWidth},oa);dc.ls(function(yb){ya.WinOuterHeight=yb},function(){return window.self.outerHeight},oa);dc.ls(function(yb){ya.WinOuterWidth=yb},function(){return window.self.outerWidth},oa);dc.ls(function(yb){ya.WinOrientation=yb},function(){return window.self.orientation},
oa);dc.ls(function(yb){ya.WinDevicePixelRatio=yb},function(){return window.self.devicePixelRatio},oa);dc.ls(function(yb){ya.SupportsTouch=yb},function(){return ld.a.Htc},oa);dc.ls(function(yb){ya.NavAppName=yb},function(){return window.navigator.appName},oa);dc.ls(function(yb){ya.NavAppVersion=yb},function(){return window.navigator.appVersion},oa);dc.ls(function(yb){ya.NavLanguage=yb},function(){return window.navigator.browserLanguage||window.navigator.language},oa);dc.ls(function(yb){ya.NavUserAgent=
yb},function(){return window.navigator.userAgent},oa);dc.ls(function(yb){ya.NavPlatform=yb},function(){return window.navigator.platform},oa);dc.ls(function(yb){ya.NavPlugins=yb},dc.cFh,oa);dc.ls(function(yb){ya.CalculatedDevicePixelRatio=yb},function(){return dc.devicePixelRatio},oa);ya.Error=oa.toString();return ya};dc.ls=function(ya,oa,yb){try{var Dd=oa();ya(Dd)}catch(ie){yb.isEmpty()||yb.append(" | "),yb.append(ie.message||"null")}};Ll.Object.defineProperties(dc,{devicePixelRatio:{configurable:!0,
enumerable:!0,get:function(){var ya=window.devicePixelRatio;return isNaN(ya)?window.screen.deviceXDPI/window.screen.logicalXDPI:ya}}});Object(xc.a)(dc,"BrowserInfoLogger",null,[]);var Wd=b(276);ce.prototype.Qh=function(){};ce.prototype.init=function(){dc.Zci()};ce.prototype.dispose=function(){};ce.main=function(){Wd.a.instance.ej(new ce)};Ll.Object.defineProperties(ce.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.BrowserInfoLogger"}}});Object(xc.a)(ce,"BrowserInfoLoggerPackage",
null,[8,9]);var ee=b(78);kd.prototype.n4e=function(ya){if(!this.Yyc)return!0;ya=ee.a.W9c(ya);if(!ya)return!1;ya=ya.toLowerCase();for(var oa=0;oa<this.Yyc.length;oa++)if(ya.endsWith(this.Yyc[oa]))return!0;return!1};Object(xc.a)(kd,"DomainAllowListManager",null,[]);Ta.prototype.xOd=function(){var ya={},oa=this.Jt;ya.a=this.xRd;ya.b=this.round(oa.navigationStart);ya.c=this.round(oa.unloadEventStart);ya.d=this.round(oa.unloadEventEnd);ya.e=this.round(oa.redirectStart);ya.f=this.round(oa.redirectEnd);
ya.g=this.round(oa.fetchStart);ya.h=this.round(oa.domainLookupStart);ya.i=this.round(oa.domainLookupEnd);ya.j=this.round(oa.connectStart);ya.k=this.round(oa.connectEnd);ya.l=void 0!==oa.secureConnectionStart&&null!==oa.secureConnectionStart?this.round(oa.secureConnectionStart):0;ya.m=this.round(oa.requestStart);ya.n=this.round(oa.responseStart);ya.o=this.round(oa.responseEnd);ya.q=this.round(oa.domInteractive);ya.r=this.round(oa.domContentLoadedEventStart);ya.s=this.round(oa.domContentLoadedEventEnd);
ya.t=this.round(oa.domComplete);ya.u=this.round(oa.loadEventStart);ya.v=this.round(oa.loadEventEnd);ya.w=this.s9;return ya};Ta.prototype.round=function(ya){return Math.round(1E3*ya)/1E3};Ll.Object.defineProperties(Ta.prototype,{xRd:{configurable:!0,enumerable:!0,get:function(){return ee.a.Lxa(this.url)}},Jt:{configurable:!0,enumerable:!0,get:function(){return this.FMc}}});Object(xc.a)(Ta,"PerformanceTimingEntry",null,[]);var ne=b(54),Ad=b(208),se=b(316);fc.prototype.run=function(){if(fc.BS(window.performance))try{var ya=
this.Zcg();if(fc.Blg.exec(ya)&&this.VBc.n4e(ya)){var oa=new Ta(window.performance.timing,ya);se.a.instance.JOi(oa.Jt.fetchStart);se.a.instance.KOi(oa.Jt.navigationStart);se.a.instance.Dyb(ne.a.Hph,"connectStart","requestStart");se.a.instance.Dyb(ne.a.Rph,"requestStart","responseStart");se.a.instance.Dyb(ne.a.Uph,"responseStart","responseEnd");this.wRd.Je(1,oa.xOd());this.ei.cn(ne.a.Y_a,oa.Jt.fetchStart);this.ei.cn(ne.a.Nph,oa.Jt.domainLookupStart);this.ei.cn(ne.a.Mph,oa.Jt.domainLookupEnd);this.ei.cn(ne.a.Jph,
oa.Jt.connectStart);this.ei.cn(ne.a.Vph,oa.Jt.secureConnectionStart);this.ei.cn(ne.a.Iph,oa.Jt.connectEnd);this.ei.cn(ne.a.Sph,oa.Jt.requestStart);this.ei.cn(ne.a.g7c,oa.Jt.responseStart);this.ei.cn(ne.a.Oph,oa.Jt.responseEnd-oa.Jt.responseStart);this.ei.cn(ne.a.Tph,oa.Jt.responseStart-oa.Jt.requestStart);var yb=0,Dd=0,ie=0,xe=this.qtj(ya);yb=xe.transferSize;Dd=xe.u2c;ie=xe.f0c;xe.returnValue&&(this.ei.cn(ne.a.Wph,yb),this.ei.cn(ne.a.Kph,ie),this.ei.cn(ne.a.Pph,Dd));this.ei.cn(ne.a.Qph,oa.Jt.navigationStart)}}catch(Lf){hd.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Lf)}};fc.prototype.qtj=function(ya){var oa,yb;var Dd=yb=oa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:oa,u2c:yb,f0c:Dd};ya=window.performance.getEntriesByName(ya,"navigation");if(void 0===ya||null===ya||1!==ya.length)return{returnValue:!1,transferSize:oa,u2c:yb,f0c:Dd};ya=ya[0];var ie=ya.transferSize;void 0!==oa&&null!==oa&&(oa=ie);ie=ya.decodedBodySize;
void 0!==ie&&null!==ie&&(Dd=ie);ya=ya.encodedBodySize;void 0!==ya&&null!==ya&&(yb=ya);return{returnValue:!0,transferSize:oa,u2c:yb,f0c:Dd}};fc.prototype.Je=function(ya,oa){hd.ULS.sendTraceTag(4551815,306,50,Ib(ya,oa))};fc.BS=function(ya){return!(void 0===ya||null===ya)&&!(void 0===ya.timing||null===ya.timing)};Ll.Object.defineProperties(fc,{instance:{configurable:!0,enumerable:!0,get:function(){return fc.Ma||(fc.Ma=new fc(Ad.a.instance,null,Rc.AFrameworkApplication.ha.sa("PerfTimingLoggerFilterDomainsIsEnabled")?
Rc.AFrameworkApplication.ha.Uw("ResourceLoggerDomainAllowList"):null))}}});fc.Ma=null;fc.Blg=RegExp("^https?://.*","i");Object(xc.a)(fc,"PerformanceTimingLogger",null,[271]);var Ve=b(94),Zf=b(83);Da.prototype.xOd=function(){var ya={},oa=this.Jt;ya.a=this.xRd;ya.b=oa.initiatorType;ya.c=this.round(oa.redirectStart);ya.d=this.round(oa.redirectEnd);ya.e=this.round(oa.fetchStart);ya.f=this.round(oa.domainLookupStart);ya.g=this.round(oa.domainLookupEnd);ya.h=this.round(oa.connectStart);ya.i=this.round(oa.connectEnd);
ya.j=void 0!==oa.secureConnectionStart&&null!==oa.secureConnectionStart?this.round(oa.secureConnectionStart):0;ya.k=this.round(oa.requestStart);ya.l=this.round(oa.responseStart);ya.m=this.round(oa.responseEnd);ya.o=this.round(Da.g1a(oa,"decodedBodySize"));ya.p=this.round(Da.g1a(oa,"encodedBodySize"));ya.q=this.round(Da.g1a(oa,"transferSize"));ya.n=this.s9;return ya};Da.prototype.round=function(ya){return Math.round(1E3*ya)/1E3};Da.g1a=function(ya,oa){return ya[oa]};Ll.Object.defineProperties(Da.prototype,
{xRd:{configurable:!0,enumerable:!0,get:function(){return 2===this.behavior?this.url:ee.a.Lxa(this.url)}},Jt:{configurable:!0,enumerable:!0,get:function(){return this.FMc}}});Object(xc.a)(Da,"ResourceTimingEntry",null,[281]);var Pf=b(93),Fe=b(41),me=b(110),ng=b(177);lf.prototype.Lsj=function(ya){var oa=ya.name.toLowerCase(),yb=ee.a.Bta(oa);this.RZi(yb,oa)&&(yb in this.udb?hd.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",yb):(oa={},oa.fetchstart=ya.fetchStart,
oa.responseend=ya.responseEnd,oa.iscached=this.s7h(ya),oa.encodedsize=Da.g1a(ya,"encodedBodySize"),oa.decodedsize=Da.g1a(ya,"decodedBodySize"),this.udb[yb]=oa))};lf.prototype.RZi=function(ya,oa){if(this.ZUd)return Array.contains(this.ZUd,ya);if(this.OSb)for(ya=ee.a.IL(oa),oa=0;oa<this.OSb.length;oa++)if(this.OSb[oa]&&ya.endsWith(this.OSb[oa]))return!0;return!1};lf.prototype.s7h=function(ya){try{var oa=Da.g1a(ya,"transferSize");if(oa)return!oa;hd.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return ya.responseEnd-ya.fetchStart<this.J$f}catch(yb){hd.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",yb.message)}return!1};lf.prototype.cPi=function(){if(me.a.ma(this.udb))hd.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var ya=Rc.AFrameworkApplication.ZI?Rc.AFrameworkApplication.ZI.split(";"):[],oa=Object.assign(new ng.a,{extendedProperties:this.nzh()});oa.extendedProperties.set("Flights",
Fe.c(ya));this.fdi(oa,this.udb,Pf.Health.instance)}};lf.prototype.nzh=function(){try{return new Map}catch(ya){return null}};lf.prototype.fdi=function(ya,oa,yb){if(oa){var Dd=0,ie=0,xe=0,Lf=0,ph=0,Sf=0,Zg=0,Bh=0,ti=0,ci=0,fi=0,$h;for($h in oa){var Th=oa[$h];try{var mg=Object(Zf.a)(Object,Th);if(mg){var rg=mg.iscached?Boolean.parse(mg.iscached.toString()):!1,af=mg.fetchstart?this.parseFloat(mg.fetchstart.toString()):0,de=(mg.responseend?this.parseFloat(mg.responseend.toString()):0)-af,Fi=mg.encodedsize?
this.parseFloat(mg.encodedsize.toString()):0,f=mg.decodedsize?this.parseFloat(mg.decodedsize.toString()):0;Dd+=de;Lf+=Fi;Zg+=f;ci++;rg?(xe+=de,Sf+=Fi,ti+=f,fi++):(ie+=de,ph+=Fi,Bh+=f)}}catch(hb){hd.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",hb.message)}}ya.extendedProperties.set("StaticResources",Fe.c(oa));ya.extendedProperties.set("TotalResourceDownloadLatency",Dd.toString());ya.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
ie.toString());ya.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",xe.toString());ya.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",Lf.toString());ya.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",ph.toString());ya.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Sf.toString());ya.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Zg.toString());ya.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Bh.toString());
ya.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",ti.toString());ya.extendedProperties.set("TotalNumberOfResourcesDownloaded",ci.toString());ya.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",fi.toString());yb.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);yb.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",ya)}};lf.prototype.parseFloat=function(ya){if(!ya)return 0;ya=parseFloat(ya);return isNaN(ya)?
0:ya};Object(xc.a)(lf,"AppStaticResourceManager",null,[]);var Oe=Sys.EventArgs;Em(Ee,Oe);Object(xc.a)(Ee,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var bd=b(109);fe.prototype.dsg=function(ya){this.Ya.addHandler(fe.X2c,ya)};fe.prototype.WTi=function(ya){this.Ya.removeHandler(fe.X2c,ya)};fe.prototype.Qh=function(ya,oa){var yb=this.pOd!==ya;this.Eae=ya;this.isActive&&this.fe&&yb&&(this.cp(),this.kh());this.bYd=oa};fe.prototype.activate=function(){!this.isActive&&this.mme&&(this.kh(),this.PW=!0)};
fe.prototype.deactivate=function(ya){this.isActive&&(this.cp(),ya&&this.flush(),this.PW=!1)};fe.prototype.flush=function(){if(this.isActive&&this.mme)try{var ya=window.performance.getEntriesByType("resource");0<ya.length-this.ueb&&hd.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",ya.length-this.ueb);var oa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);oa&&(window.performance.clearResourceTimings(),
this.ueb=0);for(var yb=[],Dd=this.ueb;Dd<ya.length;Dd++)this.VBc.n4e(ya[Dd].name)&&(this.zdb&&this.zdb.Lsj(ya[Dd]),yb.push(new Da(ya[Dd],this.V_g)));oa||(this.ueb=ya.length);this.Ya.raiseEvent(fe.X2c,new Ee(yb));for(ya=0;ya<yb.length;ya++)yb[ya].behavior&&2!==yb[ya].behavior||this.wRd.Je(0,yb[ya].xOd());0<yb.length&&hd.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",yb.length)}catch(ie){hd.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",
ie)}};fe.prototype.Je=function(ya,oa){hd.ULS.sendTraceTag(4310804,306,50,Ib(ya,oa))};fe.prototype.IOi=function(){this.zdb.cPi()};fe.prototype.kh=function(){var ya=this;this.fe&&0<this.pOd&&(this.Fi=new bd.a(3,2,1E3*this.pOd,function(){ya.flush()},5),this.fe.kh(this.Fi),this.UFc=!0)};fe.prototype.cp=function(){this.UFc&&(this.fe.cp(this.Fi),this.Fi=null,this.UFc=!1)};Ll.Object.defineProperties(fe.prototype,{mme:{configurable:!0,enumerable:!0,get:function(){try{return!(void 0===this.oea||null===this.oea)&&
!(void 0===this.oea.getEntriesByType||null===this.oea.getEntriesByType)}catch(ya){return hd.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",ya),!1}}},V_g:{configurable:!0,enumerable:!0,get:function(){return this.bYd}},isActive:{configurable:!0,enumerable:!0,get:function(){return this.PW}},pOd:{configurable:!0,enumerable:!0,get:function(){return this.Eae}}});fe.X2c="EntriesAvailable";Object(xc.a)(fe,"ResourceTimingLogger",null,[238,
271]);var ac=b(163);Vc.prototype.init=function(){this.Za.resolve("Common.NetworkTiming.IResourceTimingLogger");fc.instance.run()};Vc.prototype.dispose=function(){};Vc.prototype.Qh=function(ya){this.Za=ya;var oa=null;if(Rc.AFrameworkApplication.ha.sa("ResourceLoggerFilterDomainsIsEnabled"))try{oa=Rc.AFrameworkApplication.ha.Uw("ResourceLoggerDomainAllowList")}catch(ie){hd.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}var yb=[];yb.push(ee.a.IL(ac.a.w_).toLowerCase());
yb.push(ee.a.IL(ac.a.K$a).toLowerCase());var Dd=Rc.AFrameworkApplication.ha.xd("AppStaticResourceMonitorCacheThresholdInMs",100);ya.register(238,"Common.NetworkTiming.IResourceTimingLogger").wc().Fc(function(){return new fe(Rc.AFrameworkApplication.sj,window.performance,oa,yb,Dd)})};Vc.main=function(){Wd.a.instance.ej(new Vc)};Ll.Object.defineProperties(Vc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.ResourceTiming"}}});Object(xc.a)(Vc,"ResourceTimingPackage",null,[8,
9]);var Fc=b(37),Zc=Sys.EventArgs;Em(Nd,Zc);Object(xc.a)(Nd,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var pd=b(166);He.prototype.init=function(ya,oa,yb){this.xda=ya;this.kBc=oa;this.zXd=yb;this.xda.Vfe(Object(Fc.a)(this,this.Aqi,"onCpuMeterFrameAvailable"));this.ttg(Object(Fc.a)(this,this.DRg,"cpuPercentThresholdExceeded"))};He.prototype.Aqi=function(ya,oa){oa.rhf&&(Array.enqueue(this.FSa,oa.rhf.CP),this.FSa.length>this.zXd&&(Array.dequeue(this.FSa),this.SJg()))};He.prototype.SJg=
function(){for(var ya=this.FSa.length,oa=0,yb=0;yb<ya;yb++){var Dd=Array.dequeue(this.FSa);oa+=Dd;Array.enqueue(this.FSa,Dd)}ya=oa/ya;ya>this.kBc&&this.Ya.raiseEvent("CPTTE",new Nd(this.kBc,ya))};He.prototype.DRg=function(ya,oa){pd.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.FTg(oa.ppj,oa.actualValue))};He.prototype.ttg=function(ya){this.Ya.addHandler("CPTTE",ya)};He.prototype.FTg=function(ya,oa){var yb={};yb.ThresholdValue=ya;yb.ActualValue=oa;return yb};Object(xc.a)(He,
"CpuMeterMonitor",null,[307]);var bf=b(139);Object(xc.a)(Vd,"ProfileInformation",null,[]);var Bd=b(13),Qe=b(40),Ob=b(262);Id.prototype.lhe=function(ya,oa,yb){var Dd=Id.generateKey(oa,yb);Dd in this.GBa?oa=this.GBa[Dd]:(oa=new Vd,oa.S=yb?1:0,this.GBa[Dd]=oa,this.SMc++);oa.C++;oa.M=ya>oa.M?ya:oa.M;oa.T+=ya};Id.prototype.mWa=function(ya,oa){this.lhe(ya,oa,!1);this.vEc&&this.lhe(ya,oa,!0)};Id.prototype.getData=function(){if(0<this.fQb&&this.SMc>this.fQb)return this.nxh();var ya=0<this.WPb,oa={},yb=this.GBa,
Dd;for(Dd in yb){var ie=Dd,xe=yb[Dd];this.nJf(xe);ya&&xe.T>=this.WPb&&(oa[ie]=xe)}return ya?me.a.ma(oa)?null:oa:this.GBa};Id.prototype.nxh=function(){var ya=0<this.WPb,oa=[],yb=this.GBa;for(xe in yb){var Dd={key:xe,value:yb[xe]},ie=Dd.value;(!ya||ie.T>=this.WPb)&&Array.add(oa,Dd)}if(oa.length>this.fQb)oa.sort(function(Lf,ph){return ph.value.T-Lf.value.T}),oa=oa.slice(0,this.fQb);else if(!oa.length)return null;ya={};oa=Ol(oa);for(yb=oa.next();!yb.done;yb=oa.next()){yb=yb.value;var xe=yb.value;this.nJf(xe);
ya[yb.key]=xe}return ya};Id.prototype.nJf=function(ya){ya.M=Ob.a.b_(ya.M,0);ya.T=Ob.a.b_(ya.T,0)};Id.prototype.reset=function(){this.GBa={};this.SMc=0};Id.generateKey=function(ya,oa){return oa?ya+" [it]":ya};Object(xc.a)(Id,"FunctionCallAggregator",null,[272]);rd.$Ag="BatchedOperation";rd.replication="Replication";rd.Utj="25";rd.lXi="9_"+rd.$Ag+"_"+rd.replication;Object(xc.a)(rd,"CpuMeterConstants",null,[]);Object(xc.a)(Pc,"CpuMeterFrame",null,[]);var yc=Sys.EventArgs;Em(hc,yc);Object(xc.a)(hc,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);Object(xc.a)(Bb,"MiniTaskItemInfo",null,[]);Object(xc.a)(Oc,"TaskItemInfo",null,[]);var id=b(675),Tc=b(106);rc.wLh=function(){if(!rc.mMb&&(rc.mMb=new Tc.a,Rc.AFrameworkApplication.ha&&Rc.AFrameworkApplication.ha.Yx("AggregatorIdDisabledList")))for(var ya=Rc.AFrameworkApplication.ha.Uw("AggregatorIdDisabledList"),oa=0;oa<ya.length;oa++)rc.mMb.ia(ya[oa],!0);return rc.mMb};rc.mMb=null;Object(xc.a)(rc,"DisabledAggregatorListStore",null,[]);var od=b(264);Lb.prototype.track=function(ya,
oa){oa=void 0===oa?null:oa;this.GW||(this.u9g(),this.n2i(),this.yNb.mWa(ya,oa))};Lb.prototype.n2i=function(){!this.k2d&&0<this.N0d&&(this.k2d=!0,this.ZKf())};Lb.prototype.ZKf=function(){var ya=this,oa=new bd.a(5,1,this.N0d,function(){ya.r4i()},19,this._id.toString());this.taskManager.kh(oa)};Lb.prototype.r4i=function(){!this.oib||this.oib.Acj()?this.cMf():this.h8d&&this.yNb.reset();this.ZKf()};Lb.prototype.cMf=function(){var ya=this.yNb.getData();if(ya){var oa=parseInt(String(ya.length));if(isNaN(oa)||
0<oa)this.Jpc(ya),this.h8d&&this.yNb.reset()}};Lb.prototype.Jpc=function(ya){var oa={};hd.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",(oa.ID=this._id.toString(),oa.Data=ya,oa))};Lb.prototype.u9g=function(){var ya=this;this.S$d||(this.sIc(function(){ya.cMf()}),this.S$d=!0)};Lb.MT=function(ya,oa,yb,Dd,ie){return new Lb(new id.a(function(){return Rc.AFrameworkApplication.sj}),Rc.AFrameworkApplication.wIb,ya,oa,yb,Dd,ie)};Lb.o0a=function(ya,oa,yb){return Lb.MT(ya,oa,yb,!0,null)};Ll.Object.defineProperties(Lb.prototype,
{taskManager:{configurable:!0,enumerable:!0,get:function(){return this.fe||(this.fe=this.Pkg.value)}}});Object(xc.a)(Lb,"Aggregator",null,[305]);vb.prototype.mWa=function(ya,oa){if(!this.oib||this.oib.Acj())oa in this.Fm||(this.Fm[oa]=[]),this.Fm[oa].push(ya)};vb.prototype.getData=function(){return me.a.count(this.Fm)?this.Fm:null};vb.prototype.reset=function(){this.Fm={}};Object(xc.a)(vb,"NamedValuesAggregator",null,[272]);var mc=b(371);sa.prototype.Vfe=function(ya){this.O5d.addHandler("OnCpuMeterFrameAvailable",
ya)};sa.prototype.b8a=function(ya,oa,yb,Dd){yb=(Dd=void 0===Dd?null:Dd)?Dd.priority:7;var ie=this.EK();this.start(oa,yb);try{ya()}finally{this.stop(oa,Dd),ya=this.EK()-ie,this.X3d.track(ya,oa)}};sa.prototype.o5=function(ya,oa){var yb=this.EK();try{ya()}finally{ya=this.EK()-yb,this.iDc.mWa(ya,oa),0<this.bDa&&this.jDc.mWa(ya,oa),this.X3d.track(ya,oa)}};sa.prototype.Tud=function(ya){var oa=new Oc;oa.TN=ya.lfc;oa.TP=ya.priority;this.IAf(1,oa)};sa.prototype.w5a=function(ya){this.cPb|=ya};sa.prototype.start=
function(ya,oa){if(!this.bDa){this.jDc.reset();var yb=this.q9e(ya);yb&&this.dpd(1);this.wF=new Oc;this.wF.TN=ya;this.wF.TP=oa;this.wF.ST=(new Date).toISOString();this.wF.STS=Ob.a.b_(this.EK(),2);yb?this.wF.UI=1:this.L3h(ya)?this.wF.UI=2:this.wF.UI=0}this.bDa++};sa.prototype.dpd=function(ya){this.cTa|=ya};sa.prototype.MVc=function(ya,oa){this.cTa=void 0===ya||ya?0:this.cTa&~(void 0===oa?0:oa)};sa.prototype.stop=function(ya,oa){oa=void 0===oa?null:oa;this.bDa--;if(0>=this.bDa&&this.wF){var yb=this.EK()-
this.wF.STS;this.WRb+=yb;this.pHc.mWa(yb,ya);this.q9e(ya)&&this.MVc(!1,1);this.wF.TRT=Ob.a.b_(yb,2);oa&&(this.wF.TQT=Ob.a.b_(oa.gLi,2),this.wF.TDT=Ob.a.b_(oa.B$e,2));this.dcg&&(this.IAf(0,this.wF),this.TXi());this.bDa=0}0<=ya.indexOf(rd.Utj)&&this.w5a(2);0<=ya.indexOf(rd.lXi)&&this.w5a(4);1===(this.cTa&1)&&this.w5a(1);2===(this.cTa&2)&&this.w5a(8)};sa.prototype.TXi=function(){var ya=this.wF.TRT;if(750<ya){var oa=this.jDc.getData();if(oa){var yb={},Dd;for(Dd in oa){var ie=oa[Dd],xe=Dd;xe.startsWith("SiOp_")||
(yb[xe]=Ob.a.b_(100*ie.T/ya,2))}oa=yb}ya=Object.assign(new Bb,{T:ya,S:oa});this.Sfg.track(ya,this.wF.TN)}};sa.prototype.Njj=function(){var ya=this.EK()-this.E$d,oa=Ob.a.b_(this.WRb/ya*100,2);ya=new Pc;ya.CP=oa;ya.II=this.cPb;oa=this.pHc.getData();me.a.count(oa)&&(ya.LRT=oa);oa=this.iDc.getData();me.a.count(oa)&&(ya.FP=oa);this.O5d.raiseEvent("OnCpuMeterFrameAvailable",new hc(ya));this.tVf()};sa.prototype.tVf=function(){this.pHc.reset();this.iDc.reset();this.WRb=this.bDa=0;this.E$d=this.EK();this.cPb=
0;this.wF=null};sa.prototype.run=function(){this.U8d?this.Njj():(this.tVf(),this.U8d=!0);this.Qoa?this.Qoa(Object(Fc.a)(this,this.run,"run"),1E3):window.setTimeout(Object(Fc.a)(this,this.run,"run"),1E3)};sa.prototype.zOc=function(ya,oa,yb){var Dd=Array(2);Dd[0]=oa;Dd[1]=yb;this.$Sb[ya]||(this.$Sb[ya]=[]);this.$Sb[ya].push(Dd)};sa.prototype.IAf=function(ya,oa){ya=this.$Sb[ya];if(!mc.a.ma(ya))for(var yb=0;yb<ya.length;yb++){var Dd=ya[yb],ie=Dd[0];Dd=Dd[1];ie&&!ie(oa)||Dd(oa)}};sa.prototype.xld=function(){if(!this.fgb){var ya=
window.setTimeout;this.Qoa=function(oa,yb){return ya(oa,yb)};this.fgb=!0}};sa.prototype.q9e=function(ya){return ya.startsWith("key")||ya.startsWith("input")};sa.prototype.L3h=function(ya){return ya.startsWith("click")||ya.startsWith("mouse")||ya.startsWith("pointer")};Object(xc.a)(sa,"CpuMeter",null,[77]);Od.prototype.initialize=function(ya,oa,yb,Dd){this.teb||(this.teb=new sa(this.EK,ya,oa,yb,void 0===Dd?!1:Dd),this.Hl.setResult(this.teb));return this.teb};Object(xc.a)(Od,"CpuMeterProvider",null,
[308]);yd.prototype.Dmh=function(){for(var ya=0,oa=0;oa<this.mw.length;oa++)this.mw[oa]<this.mw[ya]&&(ya=oa);return ya};yd.prototype.mWa=function(ya,oa){ya=Ob.a.b_(ya,2);if(this.mw.length<this._count)Array.add(this.mw,ya),Array.add(this.GNb,oa);else{var yb=this.Dmh();ya>this.mw[yb]&&(this.mw[yb]=ya,this.GNb[yb]=oa)}};yd.prototype.getData=function(){if(!this.mw.length)return null;var ya={};return ya.Vals=this.mw,ya.Desc=this.GNb,ya};yd.prototype.reset=function(){this.mw=[];this.GNb=[]};Object(xc.a)(yd,
"MaxDataAggregator",null,[272]);var Le=b(48),we=b(88);Nc.prototype.Qh=function(ya){ya.register(Od,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").wc().Fc(function(){return new Od(Le.a.Pe)});ya.register(He,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").wc().Fc(function(){return new He})};Nc.prototype.init=function(){var ya=Rc.AFrameworkApplication.ha;if(ya.sa("CpuMeterIsEnabled")){var oa=we.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
se.a.instance.Xwg.continueWith(function(){Nc.xVh(ya,oa)})}};Nc.prototype.dispose=function(){};Nc.xVh=function(ya,oa){var yb=Lb.o0a(10,5,new Id(ya.xd("TaskManagerLoggingThreshold",0),ya.xd("CpuMeterMaximumEntriesToLog",0)));oa=oa.initialize(new yd(5),new Id,yb,ya.sa("CPUMeterExposeTaskDetailsIsEnabled"));oa.run();ya.sa("CpuMeterMonitorIsEnabled")&&we.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(oa,ya.Tha("CpuMeterAverageCpuPercentThreshold",80),ya.xd("CpuMeterRollingAverageFramesCount",
15));pd.a(16827671,306,50,"Initializing CpuMeter")};Nc.main=function(){Wd.a.instance.ej(new Nc)};Ll.Object.defineProperties(Nc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CpuMeter"}}});Object(xc.a)(Nc,"CpuMeterPackage",null,[8,9]);var za=b(1069);Lc.prototype.Qh=function(){};Lc.prototype.init=function(){za.a.instance.init()};Lc.prototype.dispose=function(){};Lc.main=function(){Wd.a.instance.ej(new Lc)};Ll.Object.defineProperties(Lc.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.EventsCachePackage"}}});Object(xc.a)(Lc,"EventsCachePackage",null,[8,9]);var Nb=b(12),bb=b(212),Ub=b(1235),kc=b(178),ad=b(519),Qd=b(191),We=b(149),Ke=b(57),nf=b(92),Pe=b(1),hf=b(7),Vf=b(165),Sg=b(872),wg=Ub.a;Em(gc,wg);gc.prototype.dispose=function(){this.$=null;wg.prototype.dispose.call(this)};gc.prototype.dSh=function(ya){if(Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){var oa=ya.Values.m_Origin;Rc.AFrameworkApplication.wopiHostOriginFromPostMessage||
(Rc.AFrameworkApplication.wopiHostOriginFromPostMessage=oa)}switch(ya.MessageId){case kc.a.Pdd:Vf.a(this.$).RXe(ya);break;case kc.a.hnd:We.a.ltas(null);break;case kc.a.E$b:this.xui();break;case kc.a.Tdd:this.wui(ya)}};gc.prototype.FWh=function(){this.En(kc.a.Sne);this.En(kc.a.Pdd);this.En(kc.a.E$b);this.En(kc.a.Tdd);this.tOc(kc.a.hnd);this.En(kc.a.Sdd)};gc.prototype.UVh=function(){this.ffa(kc.a.sjb);this.ffa(kc.a.Vra);this.ffa("App_CloseTab");this.ffa(kc.a.DRa);this.ffa(kc.a.ERa);this.ffa(kc.a.Ldd);
this.ffa(kc.a.B$b)};gc.prototype.xui=function(){var ya={};ya.hostMessageReceived=(new Date).getTime();hd.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");Rc.AFrameworkApplication.bkd=!0;ya.appUnloadStart=(new Date).getTime();ya.sendBeaconFlight=Rc.AFrameworkApplication.ha.sa("SendBeaconOnShuttingDownRequestsEnabled");ya.sendBeaconSupported=Ke.a.dca();Ke.a.lie();ya.appUnloadEnd=(new Date).getTime();ya.appMessageSent=(new Date).getTime();this.Vj(kc.a.exg,ya)};gc.prototype.wui=function(ya){hd.ULS.sendTraceTag(537162882,
0,50,"EwaHostMessenger.OnHostSwitchMode");ya.Values&&ad.a.ard in ya.Values&&hf.a.equals(ya.Values[ad.a.ard],Qd.a.edit,!0)&&!this.$.isEditMode&&(hd.ULS.sendTraceTag(537162881,0,50,"EwaHostMessenger.OnHostSwitchMode: Switching to {0}",ya.Values[ad.a.ard]),ya=new nf.a(-8805455,0,1,0,null),this.$.Ka.Ub(ya))};Object(xc.a)(gc,"EwaHostMessenger",Ub.a,[314,266,6]);var Ef=bb.a;Em(Ab,Ef);Ab.prototype.create=function(){var ya=this,oa=this.$.ea,yb=we.a.instance;if(!this.Vse){this.Vse=!0;var Dd=Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?
this.$.ya.DocumentHostInfo.PostMessageOrigin||Sg.a.x8:Rc.AFrameworkApplication.bxd||Sg.a.x8;yb.register(gc,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").wc().Fc(function(){return new gc(ya.$,window.parent,Dd,Rc.AFrameworkApplication.ha.sa("HostSendReadyToAcceptPostMessage"))})}this.Eb(oa.Ba(21)||oa.Ia(21,yb.resolve("Postmessage.IHostPostmessenger")))};Object(xc.a)(Ab,"HostMessengerFactory",bb.a,[]);var Fg=b(116),xf=b(144),Uf=b(797),Gg=b(786),
Eg=b(74),ig=b(125),sg=b(451),yg=b(42),Yd=b(453),Sc=b(346),Ag=b(349),Jg=b(490),je=b(4),dg=b(49);cb.Yjh=function(ya,oa,yb){var Dd={},ie=dg.b();switch(ya.command){case -1537138325:Dd.Action=oa.LabelText;break;case -1104934572:Dd.PrevTab=ie.$h(parseInt(oa.OldContextCommand));Dd.NextTab=ie.$h(parseInt(oa.NewContextCommand));break;case 802602464:Dd.Origin=oa[je.a.lha];break;case -1027730316:case -1059615499:Dd.MenuType=oa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5197543_AddColorPickerMenuSectionInfoToLogs")&&
"SqmControlId"in oa&&(Dd.SqmControlId=oa.SqmControlId)}Dd.InputMethod=Sc.a[ya.method];Dd.Location=Ag.a[ya.Ze];Dd.Mode=Jg.a[ya.mode];Dd.IsSystemInitiated="IsSystemInitiated"in oa?oa.IsSystemInitiated:!1;Dd.NoReporting="NoReporting"in oa?oa.NoReporting:!1;ya=Ol(Object.keys(yb));for(oa=ya.next();!oa.done;oa=ya.next())oa=oa.value,Dd[oa]=yb[oa];return Dd};Object(xc.a)(cb,"InteractivityRecord",null,[]);Em(Qa,cb);Object(xc.a)(Qa,"FirstUserInteractivityRecord",cb,[]);var ke=b(787);fb.KVh=function(){fb.J_a||
(fb.J_a=new ke.a(Gg.a.rl()),fb.J_a.add("InputMethod"),fb.J_a.add("Location"),fb.J_a.add("Mode"))};fb.J_a=null;Object(xc.a)(fb,"ExcelUserAction",null,[]);var Qf=b(204),og=b(47),Cf=b(423),Ea=Eg.a;Em(sb,Ea);sb.prototype.dispose=function(){this.$=this.L$=null;Ea.prototype.dispose.call(this)};sb.prototype.MGf=function(ya,oa,yb){if(this.Qvb){var Dd=dg.b().$h(ya.command);hf.a.ma(Dd)&&hd.ULS.sendTraceTag(537155555,3,50,"InteractivityLogger.ReportCommand: command name is null or empty. commandName: {0}, command: {1}, commandInfo: {2}",
Dd,ya.command,ya);oa=cb.Yjh(ya,oa,yb);yb=!!oa&&(!("IsSystemInitiated"in oa)||!oa.IsSystemInitiated);this.$&&this.$.fa.Wh&&yb&&za.a.instance.YBf("OtelUserAction",new Cf.a(Dd,ya.tabName,Date.now()));this.aHf(Dd,oa,null,!0,!0)}};sb.prototype.ee=function(ya,oa,yb,Dd){this.Qvb&&this.aHf(ya,oa,void 0===yb?null:yb,!1,void 0===Dd?!1:Dd)};sb.prototype.kMd=function(ya){if(this.Qvb)if(this.L$){++this.l2e;this.L$[ya]||(this.L$[ya]=[]);var oa=this.l2e.toString();this.L$[ya].push(oa);hd.ULS.sendTraceTag(537155553,
0,50,"StartInteractivityCorrellation - '{0}', correlation={1}",ya,oa)}else hd.ULS.shipAssertTag(537155554,0,!1,"StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",ya)};sb.prototype.xMd=function(ya){if(this.Qvb)if(this.L$&&this.L$[ya]){var oa=this.L$[ya],yb=oa.pop().toString();oa.length||delete this.L$[ya];hd.ULS.sendTraceTag(537155551,0,50,"StopInteractivityCorrellation - '{0}', correlation={1}",ya,yb)}else hd.ULS.shipAssertTag(537155552,
0,!1,"StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",ya)};sb.prototype.UO=function(ya,oa,yb){var Dd=this;yb=void 0===yb?!1:yb;return this.Qvb?Yd.a(function(ie){Dd.ee(ya,ie(),void 0,yb)},sb.spj,this.la,yg.a.BYh,!1,!oa):null};sb.prototype.lDd=function(){for(var ya="",oa=0;oa<sb.z5a;oa++)ya+=this.Tld[(this.X0b+sb.z5a-oa-1)%sb.z5a]+",";hd.ULS.sendTraceTag(557188890,0,15,"Last operations {0}",ya)};sb.prototype.Kxj=function(ya){hf.a.ma(ya)||
(this.Tld[this.X0b]=ya,this.X0b=(this.X0b+1)%sb.z5a)};sb.prototype.cdi=function(ya,oa){Rc.AFrameworkApplication.D3b();var yb=ya.operation,Dd=ya.properties;if(Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PageLoadEngagmentInfo",!1)){var ie="ActionRelativeTime"in Dd?Dd.ActionRelativeTime:og.PageLoadTrackingInfo.UD();sg.a(this.$,432,433,0,function(xe){xe.dPi(yb,Dd,ie)},"Microsoft.Office.Excel.WebUI.Client.PageLoadEngagementInfo.IPageLoadEngagementInfo")}else this.auj(ya);this.buj(ya);
this.SCi(oa,Dd,yb)};sb.prototype.auj=function(ya){this.Mij(ya)||(this.qLe=!0,ya=new Qa(ya,og.PageLoadTrackingInfo.instance.Eta(new Date),og.PageLoadTrackingInfo.UD()),ya=Sys.Serialization.JavaScriptSerializer.serialize(ya),hd.ULS.sendTraceTag(458261331,0,50,"{0}",ya))};sb.prototype.Mij=function(ya){var oa=ya.properties;ya=ya.operation;return this.qLe||void 0===ya||null===ya||ya===ig.a.$Nc||ya===ig.a.nGd||ya===ig.a.Bxd||Ke.a.pjd(ya)||!!oa&&"IsSystemInitiated"in oa&&oa.IsSystemInitiated};sb.prototype.buj=
function(ya){Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.Kxj(ya.operation);ya=Sys.Serialization.JavaScriptSerializer.serialize(ya);hd.ULS.sendTraceTag(21542793,0,50,"{0}",ya)};sb.prototype.SCi=function(ya,oa,yb){Fg.a.rja()&&(oa?"NoReporting"in oa&&oa.NoReporting||"IsSystemInitiated"in oa&&oa.IsSystemInitiated||!ya&&!this.W8e||((ya=Fg.a.fy(oa,sb.ZTb,fb.J_a))?(oa=sb.ekh(oa))?xf.a.sendUserActionEvent(Fg.a.A0b(yb,null,oa.triggerMethod,oa.commandSurface,
ya)):hd.ULS.sendTraceTag(537155550,0,50,"user action was null"):hd.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):hd.ULS.sendTraceTag(537155548,0,50,"Not logging action telemetry because adction data was null, actionName: {0}",yb))};sb.prototype.aHf=function(ya,oa,yb,Dd,ie){var xe=Qf.a(this.$);if(this.W8e){var Lf=null;hf.a.equals(ya,ig.a.wpc,!0)&&oa&&"InputMethod"in oa&&(Lf=ig.a.jMe(ya,oa.InputMethod));xe.AEb(Lf?Lf:ya,yb)}else hf.a.equals(ya,ig.a.wpc,!0)&&oa&&"InputMethod"in
oa&&(ya=ig.a.jMe(ya,oa.InputMethod)),xe.AEb(ya,yb);oa&&(oa.IsCommand=Dd);ya=new cb(ya,oa,this.L$);this.cdi(ya,ie)};sb.ekh=function(ya){if(!ya)return null;var oa=new fb;"InputMethod"in ya&&(oa.triggerMethod=ya.InputMethod);"Location"in ya&&(oa.commandSurface=ya.Location);return oa};sb.ZUh=function(ya){ya?(ya.add("Origin",2),ya.add("InputMethod",2),ya.add("ButtonType",2),ya.add("selectedRange",2),ya.add("SelectedRanges",2),ya.add("editRange",2),ya.add("Location",2),ya.add("Mode",2),ya.add("CurrentSelectionMode",
2),ya.add("Action",2),ya.add("type",2),ya.add("floatingObjectType",2),ya.add("PrevTab",2),ya.add("NextTab",2),ya.add("DialogName",2),ya.add("dx",3),ya.add("dy",3),ya.add("NumberOfSelectedRanges",3),ya.add("IsCommand",1),ya.add("IsInFormulaBarEdit",1),ya.add("isLink",1),ya.add("isSheetRef",1),ya.add("isEmptyText",1),ya.add("isFormula",1),ya.add("IsResizingHiddenHeader",1)):hd.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")};sb.spj=1E3;sb.z5a=40;sb.ZTb=null;Object(xc.a)(sb,
"InteractivityLogger",Eg.a,[4]);var ob=b(381),wc=b(58),zc=b(35);Object(xc.a)(jc,"CurrentAppInfo",null,[]);Db.prototype.getAppState=function(){var ya=og.PageLoadTrackingInfo.instance.Eta(new Date);return-1===ya?"boot":3E4>ya?"postboot":"steady"};Db.prototype.isChangeGateEnabled=function(ya){return Pe.EwaSettings.isChangeGateEnabled(ya)};Db.prototype.getCurrentAppInfo=function(){return Object.assign(new jc,{appState:this.getAppState(),coAuthCount:this.$.fa.tm.length})};Db.prototype.sendBeaconTraceTag=
function(ya,oa,yb,Dd){this.$.sendBeaconTraceTag(ya,oa,yb,Dd)};Object(xc.a)(Db,"InteractivityTrackerCallbacks",null,[280]);Object(xc.a)(Hb,"InteractivityTrackerOptions",null,[]);var Hd=b(332);Qb.prototype.initialize=function(ya){hd.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5693908_UsingInteractivityTrackerFromSeparatedSlice2")||gridRenderer.CanvasRendererGlobals.initializeLogger(new ob.a);if(this.M$=interactivity.InteractivityTrackerFactoryGlobal.create()){var oa=
new Hb;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5738340_TrackDblClick")&&Qb.cXf.push("dblclick");oa.events=Qb.cXf;oa.durationThresholdInMs=Qb.durationThresholdInMs;oa.callbacks=new Db(ya);oa.patchTaskScheduling=Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);ya=this.M$.start(oa);ya.started?hd.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):hd.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+
ya.failureReason)}else hd.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")};Qb.prototype.Bma=function(ya,oa){this.M$?this.M$.track(ya,oa):hd.ULS.sendTraceTag(537155540,0,50,"InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: {0}",oa)};Qb.prototype.Ewe=function(){return this.M$?this.M$.createActionsRetriever():(hd.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),
null)};Qb.prototype.dispose=function(){this.M$&&(this.M$.stop(),this.M$=null)};Qb.durationThresholdInMs=100;Qb.cXf=["click","mousedown","contextmenu","keypress","keydown"];Qb.P5e=!1;Object(xc.a)(Qb,"InteractivityTrackerService",null,[264]);var Kd=bb.a;Em(Sa,Kd);Sa.prototype.create=function(){this.Eb(this.$.ea.Ba(443)||this.$.ea.Ia(443,new Qb(this.$)))};Sa.ja=function(ya){ya.ea.Ia(444,new Sa(ya))};Object(xc.a)(Sa,"InteractivityTrackerServiceFactory",bb.a,[]);var he=b(86),Se=b(10),Ue=b(43),mf=b(261),
Vg=b(55);Ca.prototype.getCustomProperties=function(ya){var oa=new Map;if(ya.hasOwnProperty("startTimeInMs")&&ya.hasOwnProperty("totalExecutionTimeInMs")){var yb=ya.startTimeInMs;ya=this.xjj.retrieveSlowActionsBetweenTimeRange(yb,yb+ya.totalExecutionTimeInMs);oa.set("actions",Vg.a.Hc(ya))}return oa};Object(xc.a)(Ca,"CallTreeCustomPropertiesRetriever",null,[304]);ua.prototype.addCustomProperty=function(ya,oa){this.customProperties.set(ya,oa)};ua.prototype.getCustomProperties=function(){return this.customProperties};
Object(xc.a)(ua,"CustomPropertiesRetriever",null,[303]);$a.prototype.isFeatureEnabled=function(ya,oa){return Pe.EwaSettings.getBooleanFeatureGate(ya,oa)};Object(xc.a)($a,"ExcelFeatureChecker",null,[302]);Ua.prototype.isProfilingEnabled=function(){return!0};Object(xc.a)(Ua,"ExcelProfilingFeatureChecker",null,[300]);Jb.prototype.onProfilerEvent=function(ya){switch(ya.eventId){case 1:this.Zzi(Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.KeepOldCollectedActions",!1));break;case 0:this.aAi();
break;default:hd.ULS.sendTraceTag(537155529,0,15,"JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId {0}",ya.eventId)}};Object(xc.a)(Jb,"JSCPUProfilerObserver",null,[301]);Object(xc.a)(ic,"JSCPUProfilerInitOptions",null,[]);Object(xc.a)(wb,"JSCPUProfilingPackageInitOptions",null,[]);qb.prototype.dispose=function(){hd.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");he.a.Fa(this.AVf);this.zyd=this.$=null;this.Ayd.clear();this.c8a.clear()};qb.prototype.Rkj=function(){var ya=
this,oa=Math.random()*this.Jte;hd.ULS.sendTraceTag(537155526,0,50,"JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: {0}",oa);this.AVf=Ue.a.instance.create(function(){ya.M$c("ExcelOnlineContinuousSessionProfiler",2).start()},oa,yg.a.Rbj,!0)};qb.prototype.clj=function(){hd.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.M$c("ExcelOnlineFullSessionProfiler",3).start()};qb.prototype.jlj=function(ya){var oa=void 0===oa?1E4:
oa;hd.ULS.sendTraceTag(537155524,0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.s7e(ya)?this.M$c(ya,0,oa).start():hd.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")};qb.prototype.emj=function(ya){this.s7e(ya)?(ya=this.ATe(ya))&&ya.stop():hd.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")};qb.prototype.yyd=function(ya){return this.c8a.has(ya)};qb.prototype.Alj=
function(){Pe.EwaSettings.ZTe()||(Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.clj():this.Rkj())};qb.prototype.createProfiler=function(ya,oa,yb,Dd,ie,xe){hd.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");var Lf=new ic;Lf.samplingIntervalInMs=oa;Lf.maximumNumberOfSamplesToTake=yb;Lf.idleIntervalInMs=Dd;Lf.profilingIntervalInMs=ie;return this.IWg(ya,xe,Lf)};qb.prototype.CWh=function(){var ya=new Ua,oa=
new wb;oa.ulsInstance=new ob.a;oa.deObfuscationEndpoint="ProfilerReporting.ashx";oa.shouldCompressSerializedCallTrees=!1;oa.shouldKeepSamplesOutsideOfProfilingInterval=!1;oa.shouldSendAllCallTreesFromProfileInASingleRequest=!Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);oa.shouldUseSendBeaconForSendingCallTrees=Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);oa.callTreeFilteringThresholdInMs=
Pe.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",50);oa.deObfuscationRequestQueryParamsRetriever=this.tTg();oa.deObfuscationRequestBodyPropertiesRetriever=this.sTg();oa.featureEnabledChecker=new $a;oa.useMainEventLoopForProfilerTraceProcessing=!1;oa.profilerTraceProcessingWebWorkerSourceURL=this.$.ya.JSProfilerProcessingWebWorkerJsScriptUrl;oa.shouldProcessProfileCapturedWhileUserIsIdle=Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldProcessProfileCapturedWhileUserIsIdle",
!0);this.zyd=this.hzf.retrievePackage(ya,oa).retrieveProfilerFactory()};qb.prototype.tTg=function(){var ya=new ua;ya.addCustomProperty(Se.a.Nzf,Rc.AFrameworkApplication.userType);ya.addCustomProperty(Rc.AFrameworkApplication.lcb,Rc.AFrameworkApplication.userSessionId);ya.addCustomProperty(Se.a.Fhf,this.$.ya.SkipAuthentication?Se.a.Ghf:null);ya.addCustomProperty(Se.a.Tyd,this.$.ya.MachineCluster);return ya};qb.prototype.sTg=function(){var ya=new ua;ya.addCustomProperty("appName","Excel");ya.addCustomProperty("buildVersion",
Rc.AFrameworkApplication.buildVersion);ya.addCustomProperty("shouldUseSourceMaps","true");Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5619353_profilerFilterSensitiveResources")&&ya.addCustomProperty("shouldFilterSensitiveResources","true");Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5636639_UseNewDeobfForProfiler")&&ya.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","true");return ya};qb.prototype.IWg=function(ya,oa,yb){var Dd=new ua;Dd.addCustomProperty("ProfilerName",ya);this.gzf.set(ya,
Dd);oa=this.zyd.createProfiler(oa,yb,Dd);this.c8a.set(ya,oa);Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5786153_JsProfilerAddSlowActionsRetriever")&&(ya=this.VUg(ya),oa.subscribeProfilerObserver(ya,this.$Ji));return oa};qb.prototype.ATe=function(ya){return this.yyd(ya)?this.c8a.get(ya):(hd.ULS.shipAssertTag(537155520,0,!1,"JsSelfProfilerManager.GetProfiler: Profiler with such name ({0}) does not exist",ya),null)};qb.prototype.M$c=function(ya,oa,yb){yb=void 0===yb?null:yb;if(this.yyd(ya))return this.ATe(ya);
var Dd=this.i9h;return this.createProfiler(ya,Dd,null!=yb&&0<Dd?yb/Dd:2E6,2===oa?this.Jte:null,oa?this.profilingIntervalInMs:null,oa)};qb.prototype.VUg=function(ya){if(mf.a(this.$)){var oa=mf.a(this.$).Ewe();if(oa){var yb=this.c8a.get(ya),Dd=new Ca(oa);yb.subscribeCallTreeCustomPropertiesRetriever(Dd);yb=new Jb(function(ie){oa.startCollectingSlowActions(ie)},Object(Fc.a)(oa,oa.stopCollectingSlowActions,"stopCollectingSlowActions"));this.Ayd.set(ya,yb);return yb}hd.ULS.sendTraceTag(537155491,0,15,
"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}hd.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null};qb.prototype.DWh=function(){this.hzf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.gzf=new Map;this.Ayd=new Map;this.c8a=new Map};qb.prototype.s7e=function(ya){return!hf.a.ma(ya)};Object(xc.a)(qb,"JsSelfProfilerManager",
null,[247,6]);var Hf=bb.a;Em(Ia,Hf);Ia.prototype.create=function(){var ya=this;hd.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");var oa=wc.GetServiceTaskFactory.Va(this.$.ea,283,284,1,"Common.IDynamicScriptLoaderProvider");zc.TaskExtensions.Aa(oa,function(){zc.TaskExtensions.Aa(Hd.c(oa.result.Cp.loadScript("officeOnlineCpuProfiling")),function(){ya.Eb(ya.$.ea.Ba(437)||new qb(ya.$))},ya.$.la,3)},this.$.la,3)};Ia.ja=function(ya){ya.ea.Ia(438,
new Ia(ya))};Object(xc.a)(Ia,"JsSelfProfilerManagerFactory",bb.a,[]);Object(xc.a)(Aa,"ActionData",null,[]);Object(xc.a)(Zb,"BlockedEngagementInfo",null,[]);Em(cc,Aa);Object(xc.a)(cc,"SuccessfulActionData",Aa,[]);Object(xc.a)(tc,"SuccessfulEngagementInfo",null,[]);var Rg=b(39);Ec.prototype.dispose=function(){this.$.fa&&this.$.fa.Er(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"));this.$.Lo(Object(Fc.a)(this,this.Pd,"onWorkbookClosing"));he.a.Fa(this.zIb);this.$=this.zIb=null};Ec.prototype.dPi=
function(ya,oa,yb){if(void 0!==ya&&null!==ya&&oa){var Dd=this.Mab.successfulActions.length+1,ie="InputMethod"in oa?oa.InputMethod:"",xe="IsCommand"in oa&&oa.IsCommand;Dd>Ec.dff||!this.I7h(ya,oa,ie,xe)||(ya=Object.assign(new cc,{order:Dd,name:ya,componentName:"Location"in oa?oa.Location:"",timeFromNavigationStart:yb,inputMethod:ie,isCommand:xe}),Array.add(this.Mab.successfulActions,ya),1===Dd?this.Kci():Dd===Ec.dff&&this.cyb())}};Ec.prototype.QOi=function(ya){Rg.a(this.$).oVb(Object(Fc.a)(this,this.ABb,
"operationBlockedDuringPartialInteractivity"));this.Olb.hasBlockedActions=!0;this.ABb(null,ya)};Ec.prototype.Ih=function(){var ya=this;this.Ybi();this.zIb=Ue.a.instance.create(function(){ya.cyb()},Ec.Zmj,yg.a.cyb)};Ec.prototype.Pd=function(){this.cyb()};Ec.prototype.Ybi=function(){hd.ULS.sendTraceTag(254546634,0,50,"{0}",Fe.c(this.Olb))};Ec.prototype.Kci=function(){og.PageLoadTrackingInfo.instance.Eta(new Date)>Ec.Mlh?hd.ULS.sendTraceTag(537154758,0,50,"First user interaction was filtered: {0}",Fe.c(this.Mab.successfulActions[0])):
hd.ULS.sendTraceTag(254563592,0,50,"{0}",Fe.c(this.Mab.successfulActions[0]))};Ec.prototype.cyb=function(){!this.VWf&&this.Mab.successfulActions.length&&(this.VWf=!0,he.a.Fa(this.zIb),this.zIb=null,this.$.sendBeaconTraceTag(254559496,50,!1,Fe.c(this.Mab)))};Ec.prototype.Alh=function(){this.vHa.add(ig.a.$Nc);this.vHa.add(ig.a.nGd);this.vHa.add(ig.a.Bxd);this.vHa.add(ig.a.Ixf);this.vHa.add(ig.a.Kxf);this.vHa.add(ig.a.Mxf)};Ec.prototype.I7h=function(ya,oa,yb,Dd){yb=hf.a.ma(yb)||"unknown"===yb;var ie=
"IsSystemInitiated"in oa&&oa.IsSystemInitiated;oa="NoReporting"in oa&&oa.NoReporting;var xe=this.vHa.has(ya);ya=hf.a.equals(ya,ig.a.wpc,!0)&&yb;return!ie&&!oa&&!xe&&!ya&&!(Dd&&yb)};Ec.prototype.ABb=function(ya,oa){ya=this.Olb.blockedActions.length;var yb=hf.a.ma(oa.details)?oa.actionName:oa.actionName+"_"+oa.details;oa=Object.assign(new Aa,{order:ya+1,name:yb,componentName:oa.componentName,timeFromNavigationStart:oa.timeFromNavigationStart});Array.add(this.Olb.blockedActions,oa)};Ec.dff=10;Ec.Mlh=
6E4;Ec.Zmj=12E4;Object(xc.a)(Ec,"PageLoadEngagementInfo",null,[245]);var zf=bb.a;Em(lc,zf);lc.prototype.create=function(){this.Eb(this.$.ea.Ba(432)||this.$.ea.Ia(432,new Ec(this.$)))};lc.ja=function(ya){ya.ea.Ia(433,new lc(ya))};Object(xc.a)(lc,"PageLoadEngagementInfoFactory",bb.a,[]);var gg=b(50),Xe=b(143),If=b(513),yf=b(36),Bf=b(73),Vb=b(370),Qc=b(32),md=b(224),Ce=Sys.EventArgs;Em(P,Ce);Object(xc.a)(P,"ErrorDataArgs",Sys.EventArgs,[]);var le=b(680),Zd=b(103),fg=b(26);uc.prototype.l$i=function(ya){this.o1b||
(this.i9d=ya,this.h9d=Zd.toUtc(this.AFb))};uc.prototype.jSh=function(ya){if(ya.Values&&(!this.h2a||!this.i2a))try{ad.a.K_e in ya.Values&&(this.h2a=parseInt(ya.Values[ad.a.K_e].toString()));ad.a.L_e in ya.Values&&(this.i2a=parseInt(ya.Values[ad.a.L_e].toString()));var oa=se.a.instance;0<this.h2a&&(this.tcf(this.h2a,"PageLoadFromHostClick"),oa.fPi(this.h2a));0<this.i2a&&(this.tcf(this.i2a,"PageLoadFromHostFrameCreation"),oa.gPi(this.i2a));var yb=ya.Values[ad.a.mSh]||0,Dd=ya.Values[ad.a.kSh]||ya.Values[ad.a.lSh]||
0;0<Dd&&oa.SOi(Dd);oa.TOi(yb)}catch(ie){}};uc.prototype.pZi=function(){this.fLf=this.are=fg.a.Qa.Gb;this.r6d=0;this.Jdd=this.o1b=!1};uc.prototype.Lne=function(ya){var oa=this.are.getTime();return oa>=ya?0:ya-oa+this.Zuf};uc.prototype.tcf=function(ya,oa){if(ya){var yb=dg.b();yb.lIb("UserAction",oa,oa,fg.a.uyb(ya),le.EcmaDateClock.instance.appStart);yb.Qpb(oa,Zd.toTimestamp(this.AFb))}};Ll.Object.defineProperties(uc.prototype,{Zuf:{configurable:!0,enumerable:!0,get:function(){return this.r6d}},AFb:{configurable:!0,
enumerable:!0,get:function(){return this.i9d}},eLf:{configurable:!0,enumerable:!0,get:function(){return this.h9d}},g9h:{configurable:!0,enumerable:!0,get:function(){return this.Lne(this.fLf.getTime())}},HDi:{configurable:!0,enumerable:!0,get:function(){return this.Lne(this.eLf.getTime())}},IRf:{configurable:!0,enumerable:!0,get:function(){return!(this.o1b||void 0===window.bsqmXLSPageLoadStartTime)}},are:{configurable:!0,enumerable:!0,get:function(){try{return this.XMb||(this.XMb=Zd.toUtc(window.bsqmXLSPageLoadStartTime)),
this.XMb}catch(ya){return null}},set:function(ya){this.XMb=ya}}});Object(xc.a)(uc,"PageLoadPerfInfo",null,[]);var Kg=b(68);zb.prototype.jGb=function(ya,oa){ya&&(this.KLc=this.Bab|oa<<16)};Ll.Object.defineProperties(zb.prototype,{Bab:{configurable:!0,enumerable:!0,get:function(){return this.KLc}},keyCode:{configurable:!0,enumerable:!0,get:function(){return this.Bab&65535}}});Object(xc.a)(zb,"ShortcutSqmData",null,[]);oc.prototype.qIg=function(ya,oa,yb){yb||(yb=this.mNg[oa.toString()]);return oc.HRf(ya,
yb)&&(ya=new zb(ya,yb,ld.a.isMac),!Qc.a.rg(this.bod,ya.Bab.toString()))?(this.bod[ya.Bab.toString()]=!0,ya):null};oc.prototype.cIf=function(){this.bod={}};oc.SSg=function(){var ya={};return ya["1"]=1,ya["2"]=2,ya["4"]=3,ya["8"]=4,ya["16"]=5,ya["32"]=6,ya};oc.l2h=function(ya){return 112<=ya&&123>=ya||61440<=ya&&61451>=ya};oc.u3h=function(ya){return 17!==ya&&18!==ya&&16!==ya&&91!==ya&&93!==ya};oc.HRf=function(ya,oa){var yb=ya.ctrlKey||ya.altKey||Kg.b(ya);ya=ya.keyCode;yb=oc.l2h(ya)||yb;yb=oc.u3h(ya)&&
yb;return!!oa&&yb};Object(xc.a)(oc,"UnhandledShortcutLogger",null,[]);Yb.prototype.FUb=function(ya){Array.add(this.RZb,ya)};Yb.prototype.xaa=function(ya,oa,yb){try{if(oa)oa.endTime=yb,this.sqmManager.zde(oa);else{oa=0;for(var Dd=this.RZb.length;oa<Dd;oa++){var ie=this.RZb[oa];ya?(ie.endTime=ie.startTime,ie.gse=0):ie.endTime=yb;this.sqmManager.zde(ie)}}}catch(xe){}finally{Array.clear(this.RZb)}};Object(xc.a)(Yb,"UserInteractionPerfInfo",null,[]);var $g=b(33),pa=b(64),tb=b(99),qc=b(223),jd=Eg.a;Em(Ra,
jd);Ra.prototype.rPc=function(ya){this.Oa.addHandler("EREK",ya)};Ra.prototype.dCd=function(ya){this.Oa.removeHandler("EREK",ya)};Ra.prototype.dispose=function(){this.vZg&&Rc.AFrameworkApplication.Cm&&Rc.AFrameworkApplication.Cm.disable();this.$&&this.$.Lo(Object(Fc.a)(this,this.Pd,"onWorkbookClosing"));this.$=this.Jwc=this.TMa=this.xX=null;jd.prototype.dispose.call(this)};Ra.prototype.RXe=function(ya){this.TMa.jSh(ya);this.Tci()};Ra.prototype.WGd=function(ya){this.setDw(9415,ya)};Ra.prototype.FUb=
function(ya){this.Jwc.FUb(ya)};Ra.prototype.xaa=function(ya,oa,yb){this.Jwc.xaa(ya,oa,yb)};Ra.prototype.Gnd=function(ya){if(this.E1){var oa=this.fa.isNamedObjectViewMode&&1===this.workbookContext.NovMode;ya=this.$.isEditMode||ya&&this.fa.workbookContext.Options&512?2:oa?9:this.fa.ic.inEmbedView?14:1;this.setDw(8721,ya);this.Gnh(ya);this.mBc=!1}};Ra.prototype.Dcf=function(){var ya=this.TMa;this.E1&&ya.IRf&&(this.setDw(9450,ya.Zuf),this.setDw(9085,ya.g9h))};Ra.prototype.Ecf=function(ya){if(!this.CEb){this.CEb=
!0;var oa=this.TMa,yb=0;this.E1&&oa.IRf?(oa.l$i(ya),this.Jwc.dxg=oa.eLf,this.setDw(9086,oa.HDi),oa.o1b=!0,yb=this.TMa.AFb.getTime()):yb=ya.getTime();zc.TaskExtensions.Aa(this.Zrb.value,function(Dd){var ie={};Dd.result.Vj(kc.a.Ywg,(ie.DocumentLoadedTime=yb,ie))},this.la,3)}};Ra.prototype.zde=function(ya){this.E1&&ya&&1!==ya.uca&&this.mfa(8327,md.b(ya),md.n(ya),md.a(ya),2,ya.gse,md.o(ya),md.d(ya),md.e(ya))};Ra.prototype.iDd=function(ya,oa){ya&&ya.MessageIdHash&&this.hDd(ya.MessageIdHash,ya.MessageIdName,
ya.MessageId,ya.ErrorCause?ya.ErrorCause:gg.a.nvc,!1,oa,ya,null)};Ra.prototype.hDd=function(ya,oa,yb,Dd,ie,xe,Lf,ph){Ra.appEncounteredFirstError||(Ra.appEncounteredFirstError=!0,Xe.a.get_instance().isCompleted(13)||(Xe.a.get_instance().yx(13),hd.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));ya=this.Xpb(ya);var Sf=!!Lf,Zg={};Zg.ErrorName=oa;Zg.ErrorHashCode=ya.toString();Zg.ErrorId=yb.toString();Zg.ErrorCause=Dd.toString();Zg.ErrorType=xe?"BusinessBar":
"ErrorDialog";Zg.BusinessBarEntryName=hf.a.ma(ph)?"null":ph;Zg.ServerCorrelationId=Sf?Lf.CorrelationId:"null";Zg.WebMethodName=Sf?Lf.WebMethodName:"null";Zg.SessionHostingEcs=this.fa.workbookContext?this.fa.workbookContext.EcsServerName:"null";Zg.EcsServerId=Sf?Lf.EcsServerId:"null";Zg.WfeServerId=Sf?Lf.WfeServerId:"null";oa=Vg.a.Hc(Zg);this.Oa.raiseEvent("EREK",new P(Zg));hd.ULS.sendTraceTag(1881314,0,15,oa);this.E1&&(tb.a.$Bf(ya.toString()),this.mfa(9134,ya,Dd,gg.a.VPd),this.fa.ot||ie||(this.setDw(10459,
ya),this.Gnd(!0),this.Ecd=!0,this.upload(),this.y1e()))};Ra.prototype.Xpb=function(ya){return 5439488|(ya>>>16^ya&65535)&65535};Ra.prototype.Vnd=function(ya,oa,yb){ya=this.I0f.qIg(ya,oa,yb);this.E1&&ya&&this.mfa(11007,ya.Bab)};Ra.prototype.upload=function(){!this.E1||!this.CEb&&!this.Ecd||ld.a.uf&&Rc.AFrameworkApplication.Fg?ld.a.uf&&Rc.AFrameworkApplication.Fg&&hd.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.xX.uKb(),this.mBc=!0);Rc.AFrameworkApplication.Cm=this.xX=
null;this.TMa.pZi();this.CEb=!1;Rc.AFrameworkApplication.Cm=this.xX=this.lDe();this.I0f.cIf()};Ra.prototype.Tci=function(){var ya=this.TMa;if(this.E1&&!ya.Jdd){var oa=ya.h2a,yb=ya.i2a,Dd=ya.AFb.getTime();Rc.AFrameworkApplication.eP=ya.AFb;oa&&this.setDw(10324,oa>Dd?0:Dd-oa);yb&&this.setDw(10325,yb>Dd?0:Dd-yb);ya.Jdd=!0}};Ra.prototype.mfa=function(ya,oa){for(var yb=[],Dd=1;Dd<arguments.length;++Dd)yb[Dd-1]=arguments[Dd];if(this.E1){var ie;(ie=this.xX).mfa.apply(ie,[ya].concat(yb))}};Ra.prototype.setDw=
function(ya,oa){this.E1&&this.xX.setDw(ya,oa)};Ra.prototype.lDe=function(){Vb.a.JDe(this.$.ya);return Rc.AFrameworkApplication.Cm};Ra.prototype.Gnh=function(ya){try{var oa=Object(Zf.a)(Object,Vg.a.Xh(Rc.AFrameworkApplication.ha.appSettings.SessionStartInfoJson))}catch(ie){hd.ULS.sendTraceTag(537151311,0,15,"Couldn't parse SessionStartInfoJson. Message: {0}",ie.message);return}if(oa){var yb=Object(Zf.a)(String,oa.ApplicationModeExtended),Dd=Object(Zf.a)(String,oa.ApplicationMode);hf.a.ma(yb)||hf.a.ma(Dd)||
(yb=yb.toUpperCase(),2!==ya&&16!==ya||"VIEW"!==yb&&"UNIFIED"!==yb?1!==ya||"EDIT"!==yb&&"UNIFIED"!==yb||(yb="VIEW",Dd="View"):(yb="EDIT",Dd="Edit"),oa.ApplicationModeExtended=yb,oa.ApplicationMode=Dd,Rc.AFrameworkApplication.ha.appSettings.SessionStartInfoJson=Vg.a.Hc(oa))}};Ra.prototype.y1e=function(){var ya=this.$.ya;this.xX.uU=!0;this.xX.mKb(ya.BWsaStartTime);this.setDw(59,83);this.CEb=!1;if(this.E1){var oa=ya.DocumentHostInfo;this.ZXg();this.setDw(8491,this.$.QH);this.setDw(9236,ya.RequestedUILcid);
this.setDw(8473,ya.WacHostId);this.setDw(9902,md.c(oa.ClusterId));Pe.EwaSettings.ka(477)?this.xX.ZNf(""):this.xX.ZNf(ya.FlightHolder?ya.FlightHolder.FlightId:"");this.WGd(this.fa.ic.inEmbedView?1:0);this.Ecd=!1;this.setDw(9104,md.c(oa.FileSourceId));this.setDw(10309,this.hYh);this.mbj();Rc.AFrameworkApplication.Hb.jDf(If.a.getInstance(!1))}};Ra.prototype.mbj=function(){se.a.instance.eVh(this.xX);if(this.LRf){var ya=se.a.instance;ya.NOi();ya.bPi();ya.aPi();ya.$Oi();ya.WOi();this.LRf=!1}};Ra.prototype.ZXg=
function(){this.createStream(8327,1,qc.a.o0g,qc.a.kZa);this.createStream(9134,1,3,qc.a.kZa);this.createStream(11007,1,1,qc.a.kZa)};Ra.prototype.createStream=function(ya,oa,yb,Dd){this.xX.createStream(ya,oa,yb,Dd)};Ra.prototype.Pd=function(){var ya=pa.a(this.$).fd.activityState,oa=Qc.a.rg(ya,$g.a.cde);Qc.a.rg(ya,$g.a.Mjb)||oa||this.upload()};Ll.Object.defineProperties(Ra.prototype,{vZg:{configurable:!0,enumerable:!0,get:function(){return this.mBc}},hYh:{configurable:!0,enumerable:!0,get:function(){return this.$.frame.$Y?
Se.a.jYh:Se.a.iYh}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},xX:{configurable:!0,enumerable:!0,get:function(){Ra.Idb||(Ra.Idb=this.lDe());Ra.YSc||(Ra.YSc=!0,this.y1e());return Ra.Idb},set:function(ya){Ra.Idb=ya;Ra.Idb||(Ra.YSc=!1)}},E1:{configurable:!0,enumerable:!0,get:function(){return Bf.a(this.$.ya,3)}}});Ra.Idb=null;Ra.YSc=!1;Ra.appEncounteredFirstError=!1;Object(xc.a)(Ra,"SqmManager",Eg.a,[126,216]);var Sd=b(862);Object(xc.a)(Wa,"PerformanceObserverInit",
null,[]);var ye=Sys.EventArgs;Em(lb,ye);Object(xc.a)(lb,"LongTaskObservedEventArgs",Sys.EventArgs,[]);var Ye=Sys.EventArgs;Em(ha,Ye);Object(xc.a)(ha,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);Tb.prototype.Nfe=function(ya){this.Oa.addHandler("ltoek",ya)};Tb.prototype.KUi=function(ya){this.Oa.removeHandler("ltoek",ya)};Tb.prototype.ctg=function(ya){this.Oa.addHandler("ltpoiek",ya)};Tb.prototype.LUi=function(ya){this.Oa.removeHandler("ltpoiek",ya)};Tb.prototype.dispose=function(){this.$.fa.Er(Object(Fc.a)(this,
this.Ih,"onCommandUIGeneratedAndGridInteractive"));he.a.Fa(this.Oa);this.$=this.Oa=null};Tb.prototype.Ih=function(){if(ld.a.Co){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(Object(Fc.a)(this,this.Fei,"longTaskObserverAction"))).observe(new Wa([Se.a.eod])),this.FEc=!0)}catch(ya){this.FEc=!1,hd.ULS.sendTraceTag(537153885,0,10,"Exception related to PerformanceObserver: {0}",ya)}this.Oa.raiseEvent("ltpoiek",new ha(this.vac))}};Tb.prototype.Fei=
function(ya){this.Oa.raiseEvent("ltoek",new lb(ya))};Ll.Object.defineProperties(Tb.prototype,{vac:{configurable:!0,enumerable:!0,get:function(){return this.FEc}}});Object(xc.a)(Tb,"LongTaskPerformanceObserver",null,[6]);var wf=b(175);kb.prototype.$7h=function(ya){return 100*this.hod>ya};kb.prototype.Iqg=function(ya){this.Lee(ya.longTaskDuration);this.bPc(ya.activeSessionDuration)};kb.prototype.Lee=function(ya){this.longTaskDuration+=ya};kb.prototype.bPc=function(ya){this.activeSessionDuration+=ya};
Ll.Object.defineProperties(kb.prototype,{hod:{configurable:!0,enumerable:!0,get:function(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}}});Object(xc.a)(kb,"LongTaskPerformanceData",null,[]);Ll.Object.defineProperties(Na.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return"LongTaskPerformance"}}});Ll.Object.defineProperties(Na,{Z7g:{configurable:!0,enumerable:!0,get:function(){return new Na(!1,new kb,new kb,new kb,0)}}});Object(xc.a)(Na,
"LongTaskPerformanceDataStatistics",null,[250]);var Ma=Sys.EventArgs;Em(db,Ma);Object(xc.a)(db,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var gb=b(452),Wb=b(372);eb.prototype.dtg=function(ya){this.Oa.addHandler("lttek",ya)};eb.prototype.MUi=function(ya){this.Oa.removeHandler("lttek",ya)};eb.prototype.dispose=function(){this.hKd=!1;this.gWf();this.$.dl(Object(Fc.a)(this,this.jd,"onWorkbookOpened"));this.$.Lo(Object(Fc.a)(this,this.Pd,"onWorkbookClosing"));this.mM.LUi(Object(Fc.a)(this,this.cpf,"onLongTaskPerformanceObserverInitialized"));
he.a.Fa(this.CLa);this.mM=this.$=this.CLa=null;void 0!==this.nf&&null!==this.nf&&he.a.Fa(this.nf)};eb.prototype.Aic=function(ya,oa){ya=oa.MDe.getEntriesByType(Se.a.eod);ya=Ol(ya);for(oa=ya.next();!oa.done;oa=ya.next())if(oa=oa.value,!this.nf.vJ(oa.duration)&&!Rc.AFrameworkApplication.j4a){this.gR.Lee(oa.duration);this.Oa.raiseEvent("lttek",new db(oa));var yb={};yb.LongTaskDuration=oa.duration;yb.LongTaskStartTime=oa.startTime;hd.ULS.sendTraceTag(187982418,0,50,JSON.stringify(yb))}};eb.prototype.Ih=
function(){this.hKd=!0;this.ftc()};eb.prototype.ftc=function(){void 0===this.nf||null===this.nf?hd.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.mM.vac?this.Bdc?hd.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.hKd?(this.Bdc=!0,this.u4=Na.Z7g,this.gR=new kb,this.$.fa.rfa(Object(Fc.a)(this,
this.jH,"onUserListChanged")),this.maxUsersCount=this.$.fa.tm.length,this.mM.Nfe(Object(Fc.a)(this,this.Aic,"onLongTaskObservedAction")),this.nf.LDa(Object(Fc.a)(this,this.zhc,"onAppSleepOrDocumentHidden")),this.nf.okb(Object(Fc.a)(this,this.Ahc,"onAppWakeupOrDocumentUnhidden")),Rc.AFrameworkApplication.hPc(Object(Fc.a)(this,this.zhc,"onAppSleepOrDocumentHidden")),Rc.AFrameworkApplication.iPc(Object(Fc.a)(this,this.Ahc,"onAppWakeupOrDocumentUnhidden")),this.CLa=Ue.a.instance.create(Object(Fc.a)(this,
this.bdf,"logWindowLongTaskPerformanceData"),this.god,yg.a.xcf,!1),Qf.a(this.$).jfa(this.u4),this.nf.aj||Rc.AFrameworkApplication.j4a||this.ZLd(!0),hd.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):hd.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):hd.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")};
eb.prototype.jH=function(ya,oa){oa&&(this.maxUsersCount=Math.max(this.maxUsersCount,oa.QRd));this.u4.maxUsersCount=this.maxUsersCount};eb.prototype.jd=function(){this.ftc()};eb.prototype.Pd=function(){this.gWf()};eb.prototype.gWf=function(){this.Bdc&&(this.Bdc=!1,this.$.fa.Er(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive")),this.mM.KUi(Object(Fc.a)(this,this.Aic,"onLongTaskObservedAction")),this.$.fa.Pba(Object(Fc.a)(this,this.jH,"onUserListChanged")),void 0!==this.nf&&null!==
this.nf&&(this.nf.V8a(Object(Fc.a)(this,this.zhc,"onAppSleepOrDocumentHidden")),this.nf.dEb(Object(Fc.a)(this,this.Ahc,"onAppWakeupOrDocumentUnhidden"))),Rc.AFrameworkApplication.IEf(Object(Fc.a)(this,this.zhc,"onAppSleepOrDocumentHidden")),Rc.AFrameworkApplication.JEf(Object(Fc.a)(this,this.Ahc,"onAppWakeupOrDocumentUnhidden")),this.CLa.cancel(),this.WKa=this.gR=this.u4=null,this.maxUsersCount=0)};eb.prototype.cpf=function(ya,oa){oa.vac&&this.ftc()};eb.prototype.bdf=function(){this.gR.bPc(Zd.getElapsedMilliseconds(this.WKa,
fg.a.Qa.Gb));this.ZLd(!0);var ya=!1;this.u4.postBootWindowData.activeSessionDuration?(!this.s$e&&Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.r4f&&dg.b().dHf(2),Pf.Health.instance.recordKpiUsage(Wb.a.longJsTask,0,gb.a.h9h,null),this.s$e=!0),!this.u4.isVetoSession&&this.gR.$7h(this.c5f)&&(this.u4.isVetoSession=!0,Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.r4f&&dg.b().eHf(2,this.Dei),Pf.Health.instance.recordKpiFailure(Wb.a.longJsTask,
"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.u4.worstWindowData.hod<=this.gR.hod&&(this.u4.worstWindowData=this.gR),this.u4.entireSessionData.Iqg(this.gR)):(this.u4.postBootWindowData=new kb(this.gR.activeSessionDuration,this.gR.longTaskDuration),ya=!0);var oa={};oa.LastWindowScore=this.gR;oa.postBootWindow=ya;oa.CoauthersNumber=this.$.fa.tm.length;ya=JSON.stringify(oa);hd.ULS.sendTraceTag(20779346,0,50,ya);this.gR=new kb};eb.prototype.ZLd=function(ya){ya||void 0===this.WKa||null===this.WKa?(this.WKa=
fg.a.Qa.Gb,ya=ya?this.god:this.god-this.gR.activeSessionDuration,this.CLa=wf.AsyncMethodContext.dWg(Object(Fc.a)(this,this.bdf,"logWindowLongTaskPerformanceData"),ya,yg.a.xcf,this.CLa)):hd.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")};eb.prototype.Ahc=function(){this.nf.aj||Rc.AFrameworkApplication.j4a||this.ZLd(!1)};eb.prototype.zhc=function(){this.gR.bPc(Zd.getElapsedMilliseconds(this.WKa,
fg.a.Qa.Gb));this.WKa=null;this.CLa.cancel()};Object(xc.a)(eb,"LongTaskPerformanceTracker",null,[6]);var Kc=yf.a;Em(Fa,Kc);Fa.prototype.Qp=function(ya){this.addHandler("LTSCEK",ya)};Fa.prototype.jq=function(ya){this.removeHandler("LTSCEK",ya)};Fa.prototype.jx=function(){this.Vm("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")};Fa.prototype.mr=function(ya,oa){if("QueryLongTasksCount"!==ya)return!1;this.KOh(oa);return!0};Fa.prototype.Vm=function(){return Pe.EwaSettings.ka(622)};Fa.prototype.dispose=
function(){this.statusBarManager&&(this.statusBarManager.xE(this),this.statusBarManager=null);this.i5a.MUi(Object(Fc.a)(this,this.dpf,"onLongTaskTracked"));Kc.prototype.dispose.call(this)};Fa.prototype.dpf=function(ya,oa){oa.fod&&oa.fod.duration>=this.Gei&&(this.kdf++,this.M$e=oa.fod.duration)};Fa.prototype.KOh=function(ya){ya.Value=String.format("Long Tasks: {0} | Last Task Duration: {1}ms",this.kdf,Math.round(this.M$e))};Object(xc.a)(Fa,"LongTasksStatusBarManager",yf.a,[6,156,157]);var Bc=b(9);
Object(xc.a)(Ga,"NetworkInfoData",null,[]);var Fb=yf.a;Em(Ha,Fb);Ha.prototype.Qp=function(ya){this.addHandler("NetworkInformation",ya)};Ha.prototype.jq=function(ya){this.removeHandler("NetworkInformation",ya)};Ha.prototype.T0a=function(){return this.uZ?Object.assign(new Ga,{bandwidthMps:this.uZ.downlink,rttMs:this.uZ.rtt,connectionType:this.uZ.type,effectiveConnection:this.uZ.effectiveType,downlinkMaxMps:this.uZ.downlinkMax}):null};Ha.prototype.mr=function(ya,oa){if("QueryNetworkInformation"!==ya)return!1;
this.LOh(oa);return!0};Ha.prototype.Vm=function(){return this.NOc};Ha.prototype.dispose=function(){this.NOc&&(this.statusBarManager&&(this.statusBarManager.xE(this),this.statusBarManager=null),this.uZ&&this.uZ.removeEventListener("change",Object(Fc.a)(this,this.fif,"notifyNetworkInfoChanged")));this.$=null;Fb.prototype.dispose.call(this)};Ha.prototype.yPd=function(ya){return Bc.HelperMethods.Tl(window.navigator,ya)?window.navigator[ya]:null};Ha.prototype.LOh=function(ya){ya.Value="Network: "+this.uZ.downlink.toString()+
" Mbps, "+this.uZ.rtt.toString()+" ms"};Ha.prototype.fif=function(){this.raiseEvent("NetworkInformation")};Object(xc.a)(Ha,"NetworkInformationManager",yf.a,[156,157]);var bc=b(211),ge=b(20);Object(xc.a)(mb,"OperationStatisticsData",null,[]);var Jd=b(72);Ka.prototype.isGroup=function(ya,oa,yb){var Dd=new bc.a;Dd.addRange(ya);Dd.addRange(oa);for(var ie=0;ie<this.operationsGroups.count;ie++)if(this.F4h(this.operationsGroups.oa(ie),Dd,yb))return hd.ULS.sendTraceTag(595194768,1,50,"OperationsGroupDetector: Operation '{0}' is part of a group ( operationsList: {1} , frameOperationsList: {2})",
yb,this.Kuf(ya),this.Kuf(oa)),!0;hd.ULS.sendTraceTag(595194767,1,50,"OperationsGroupDetector: Operation '{0}' is NOT part of a group.",yb);return!1};Ka.prototype.F4h=function(ya,oa,yb){for(var Dd=0,ie=0;ie<oa.count;ie++)if(oa.oa(ie).isGroupBreaking){if(ya.count<=Dd||!hf.a.equals(oa.oa(ie).name,ya.oa(Dd),!0))return!1;Dd++}return ya.count>Dd&&hf.a.equals(yb,ya.oa(Dd),!0)};Ka.prototype.Kuf=function(ya){ya=Jd.select(ya,function(oa){return oa.name});return String.format("[{0}]",Jd.toArray(ya).join(", "))};
Ka.prototype.zUh=function(){this.operationsGroups=new bc.a;var ya;this.KVa((ya=new bc.a,ya.add("Paste"),ya.add("SelectingRange_unknown"),ya));var oa;this.KVa((oa=new bc.a,oa.add("AutoSum"),oa.add("SelectingRange_unknown"),oa));var yb;this.KVa((yb=new bc.a,yb.add("ChangeSheetDirection"),yb.add("ActiveItemChanged"),yb));var Dd;this.KVa((Dd=new bc.a,Dd.add("InsertSheet"),Dd.add("ActiveItemChanged"),Dd.add("SelectingRange_unknown"),Dd));var ie;this.KVa((ie=new bc.a,ie.add("DeleteSheet"),ie.add("DialogButtonClick"),
ie.add("ActiveItemChanged"),ie.add("SelectingRange_unknown"),ie));var xe;this.KVa((xe=new bc.a,xe.add("EditBoxEndEdit"),xe.add("SetCell"),xe.add("SelectingRange_keyboard"),xe.add("MoveDownWithinSelectionOrCommitEdit"),xe))};Ka.prototype.KVa=function(ya){this.operationsGroups.add(ya)};Object(xc.a)(Ka,"OperationsGroupDetector",null,[]);var ue=b(28);ta.prototype.AEb=function(ya,oa){var yb=Bc.HelperMethods.Ac(),Dd=Pe.EwaSettings.ka(382)?this.operationsGroupDetector.isGroup(this.kC,this.xD,ya):!1;this.dcc=
this.P6e(ya);Pe.EwaSettings.ka(382)?this.dcc&&0<this.kC.count&&!Dd&&(this.lyj(),this.V2f(ya,yb),this.GLe()):0<this.kC.count&&this.P6e(ya)&&(this.V2f(ya,yb),this.GLe());this.J4a=-1;if(ge.g(this.$)&&ge.g(this.$).Ca){var ie=!this.y_.contains(ya);yb=new mb(ya,yb,void 0,void 0,void 0,ie,this.dcc,Dd);this.xD.add(yb);this.framePerformanceTracker&&this.framePerformanceTracker.rlj(yb.name,oa);Pe.EwaSettings.ka(382)&&!this.IFb&&this.uEb.contains(ya)&&(this.IFb=!0);-1===this.KQc&&(this.KQc=window.requestAnimationFrame(Object(Fc.a)(this,
this.IXi,"reportFrame")))}else hd.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")};ta.prototype.Hnc=function(){this.J4a=Bc.HelperMethods.Ac()};ta.prototype.Onc=function(){this.kC.count||this.xD.count?(this.nKb(this.xD,this.J4a),this.nKb(this.kC,this.J4a)):hd.ULS.sendTraceTag(0,1,50,"ReportOnBlockCacheConsistant when no operations in the list. Last block render time: {0}",this.J4a);this.J4a=-1};ta.prototype.P6e=function(ya){return!this.FZ.contains(ya)&&!hf.a.contains(ya,"Menu",
!1)&&!hf.a.contains(ya,"TellMe",!1)};ta.prototype.GLe=function(){for(var ya=0;ya<this.kC.count;ya++){var oa=this.kC.oa(ya);this.zH.Nmg(oa);this.tdi(oa)}this.kC.clear()};ta.prototype.IXi=function(){this.KQc=-1;var ya=Bc.HelperMethods.Ac();this.gzj(ya);Pe.EwaSettings.ka(382)&&(this.IFb&&(hd.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.nKb(this.xD,ya),this.IFb=!1),this.dcc&&(this.nKb(this.kC,ya),this.IFb||
this.nKb(this.xD,ya)));window.setTimeout(Object(Fc.a)(this,this.Pci,"logFrameInformation"),0)};ta.prototype.Pci=function(){for(var ya=new bc.a,oa=this.$.ya.OperationToPrevOperationThreshold,yb=0;yb<this.xD.count;yb++){var Dd=this.xD.oa(yb);yb<oa&&ya.add(Dd);this.kC.add(Dd)}ge.g(this.$)&&ge.g(this.$).Ca?((yb=this.sessionStatisticsManager.U8c(0))?hd.ULS.sendTraceTag(237798547,1,50,"DOM count: ({0}, {1}, {2}), long tasks: {3}, operations count: {4}, operations: {5}",yb.nii,yb.GAg,yb.Tgi,this.gyb,this.xD.count,
ya):hd.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.xD.count>oa&&hd.ULS.sendTraceTag(537153875,1,50,"More than {0} operations are in the operationsList. count: {1}",oa,this.xD.count),this.xD.clear(),this.gyb.clear()):hd.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};ta.prototype.gzj=function(ya){for(var oa=0;oa<this.xD.count;oa++)this.xD.oa(oa).startToNextFrame=this.F$c(this.xD.oa(oa).startTime,ya),this.xD.oa(oa).wasHidden=Sd.a.vJ(this.xD.oa(oa).startToNextFrame)};
ta.prototype.V2f=function(ya,oa){for(var yb=0;yb<this.kC.count;yb++)-1===this.kC.oa(yb).startToResponseRenderEnd&&(this.kC.oa(yb).operationThatLedToLogging=ya,this.kC.oa(yb).startToOperationThatLedToLogging=this.F$c(this.kC.oa(yb).startTime,oa))};ta.prototype.lyj=function(){for(var ya=!1,oa=Ol(this.kC),yb=oa.next();!yb.done;yb=oa.next())if(yb.value.isPartOfGroup){ya=!0;break}if(ya)for(ya=0;ya<this.kC.count;ya++)this.kC.oa(ya).isPartOfGroup=this.kC.oa(ya).isGroupBreaking};ta.prototype.nKb=function(ya,
oa){for(var yb=0;yb<ya.count;yb++)ya.oa(yb).startToResponseRenderEnd=this.F$c(ya.oa(yb).startTime,oa),ya.oa(yb).wasHidden=Sd.a.vJ(ya.oa(yb).startToResponseRenderEnd)};ta.prototype.tdi=function(ya){hd.ULS.sendTraceTag(2020372336,1,50,"{0}",ya)};ta.prototype.F$c=function(ya,oa){return-1===ya?-1:-1===oa?-2:oa-ya};ta.prototype.Aic=function(ya,oa){this.Eei(oa.MDe)};ta.prototype.Eei=function(ya){ya=ya.getEntriesByType(Se.a.eod);for(var oa=0;oa<ya.length;oa++)if(30>this.gyb.count)if(this.xD.count)this.gyb.add(this.nFi(ya[oa]));
else{var yb=ya[oa];yb&&yb.attribution&&(void 0!==yb.attribution.containerSrc&&null!==yb.attribution.containerSrc&&(yb.attribution.containerSrc=""),void 0!==yb.attribution.containerId&&null!==yb.attribution.containerId&&(yb.attribution.containerId=""),void 0!==yb.attribution.containerName&&null!==yb.attribution.containerName&&(yb.attribution.containerName=""));hd.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty. {0}",yb)}else{hd.ULS.sendTraceTag(537153874,
1,50,"More then {0} long tasks are in the longTaskList. entries length: {1} First long task: {2}",30,ya.length,this.gyb.oa(0));break}};ta.prototype.nFi=function(ya){return String.format("name:{0}, startTime:{1}, duration:{2}",ya.name,ya.startTime,ya.duration)};ta.prototype.WUh=function(){this.y_||(this.y_=new ke.a(Gg.a.rl()),this.y_.add("ActiveItemChanged"),this.y_.add(dg.b().$h(-1398645260)),this.y_.add(dg.b().$h(722290388)),this.y_.add(dg.b().$h(974713501)),this.y_.add(ue.a.AP(ue.a.FZb)),this.y_.add(ue.a.AP(ue.a.EZb)),
this.y_.add(ue.a.AP(ue.a.inb)),this.y_.add(ue.a.AP(ue.a.vzf)),this.y_.add(ue.a.AP(ue.a.kla)))};ta.prototype.BUh=function(){this.FZ||(this.FZ=new ke.a(Gg.a.rl()),this.FZ.add("PromptEditInBrowser"),this.FZ.add(dg.b().$h(-1398645260)),this.FZ.add(dg.b().$h(722290388)),this.FZ.add(dg.b().$h(974713501)),this.FZ.add(ue.a.AP(ue.a.FZb)),this.FZ.add(ue.a.AP(ue.a.EZb)),this.FZ.add(ue.a.AP(ue.a.inb)),this.FZ.add(ue.a.AP(ue.a.vzf)),this.FZ.add(ue.a.AP(ue.a.kla)))};ta.prototype.AUh=function(){this.uEb||(this.uEb=
new ke.a(Gg.a.rl()),this.uEb.add("SelectingRange_keyboard"),this.uEb.add("SelectingRange_mouse"))};Object(xc.a)(ta,"OperationStatistics",null,[]);var qd=b(593);Object(xc.a)(ea,"RequestError",null,[]);ab.BPg=function(ya){if(!ya)return[];var oa=[];ya=Ol(ya);for(var yb=ya.next();!yb.done;yb=ya.next())yb=yb.value,oa.push(new ea(yb.MessageIdName,yb.ErrorCause));return oa};ab.RBh=function(ya){return!ab.kli.contains(ya)};ab.XDh=function(){var ya=new ke.a(Gg.a.rl());ya.add("CheckPersistedContentUpdate");
ya.add("GetContentBundle");ya.add("GetSessionStatus");ya.add("GetStatusBarAggregates");ya.add("PollSessionStatus");ya.add("UpdatePresenceUsers");ya.add("UploadLatencyTelemetry");return ya};ab.OBh=function(ya){return ab.jqh.contains(ya)};ab.PBh=function(ya){return ab.eKi.contains(ya)};ab.DAh=function(){var ya=new ke.a(Gg.a.rl());ya.add("SetRichTextCell");ya.add("Copy");ya.add("FormatCells");ya.add("PasteRange");ya.add("FindCell");ya.add("ApplyToRangesV2");ya.add("ResizeRowsColumns");ya.add("InsertDeleteCells");
ya.add("FillRange");ya.add("PasteHtmlContent");ya.add("ApplyFilter");ya.add("PasteString");ya.add("Undo");ya.add("LineageUpdateView");ya.add("FindAll");ya.add("ApplyHyperlink");ya.add("AutoFit");ya.add("GetPrintSettings");ya.add("GetEdgeCell");ya.add("Paste");ya.add("MoveAndResizeFloatingObject");ya.add("FindRange");ya.add("SetCustomFilter");ya.add("RenameSheet");ya.add("ApplyThreadedComment");ya.add("SortFilterColumn");ya.add("InsertCopiedCutCells");ya.add("InsertSheet");ya.add("ToggleAutoFilter");
ya.add("ReorderSheets");ya.add("SetOutlineLevel");ya.add("RefreshAll");ya.add("LineageOpenPaneOrChangeFilter");ya.add("ApplySlicerSelection");ya.add("GetCardViewCardByCell");ya.add("AutoSum");ya.add("LineageClosePane");ya.add("Sort");ya.add("ClearAutoFilter");ya.add("DeleteSheet");ya.add("Redo");Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(ya.add("RemovePageBreak"),ya.add("InsertPageBreak"),ya.add("SetPrintArea"),ya.add("ClearPrintArea"));return ya};ab.QBh=
function(){var ya=new ke.a(Gg.a.rl());ya.add("DeleteConditionalFormattingRules");ya.add("GetConditionalFormattingRules");ya.add("AddConditionalFormattingRule");ya.add("QuickEditConditionalFormattingRule");ya.add("GetPrintSettings");ya.add("UpdatePresenceUsers");ya.add("GetThemeInfo");Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(ya.add("LineageOpenPaneOrChangeFilter"),ya.add("LineageUpdateView"),ya.add("LineageRefreshView"),ya.add("LineageLoadMore"));return ya};ab.kli=
ab.XDh();ab.jqh=ab.DAh();ab.eKi=ab.QBh();Object(xc.a)(ab,"RequestStatisticsData",null,[]);var Ud;Ya.eOg=(Ud=new bc.a,Ud.add(Se.a.d1a),Ud.add(Se.a.Dta),Ud.add("GetSessionStatus"),Ud.add("SetCell"),Ud.add("FindRange"),Ud.add("FindAll"),Ud.add("FindCell"),Ud.add("PollSessionStatus"),Ud);var ed={};Ya.D5f=(ed.GetPrintSettings=gb.a.fuc,ed.UpdatePresenceUsers=gb.a.presence,ed.GetThemeInfo=gb.a.fuc,ed);Object(xc.a)(Ya,"WebRequestsKpi",null,[]);xb.prototype.Snc=function(ya,oa,yb,Dd,ie,xe,Lf,ph,Sf,Zg,Bh,ti,
ci,fi){ti=qd.a(ti);ya=new ab(ya,oa,yb,Dd,ie,xe,Lf,ph,Sf,ti,Zg,Bh,Sd.a.vJ(oa),this.k$c(null),ci,this.Uja.T0a(),fi);this.wDd(ya)};xb.prototype.Oh=function(ya,oa){ya="UnknownMethodName";var yb=-1;void 0!==oa.context&&null!==oa.context&&(ya=oa.context.methodName,yb=oa.context.communicationErrorRetryCount);var Dd={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};if(oa.hd){var ie=oa.hd.Errors||[];this.zH.yXi(oa.hd.EditSessionIsDirty);void 0!==
oa.hd.RequestTelemetryData&&null!==oa.hd.RequestTelemetryData&&(Dd=oa.hd.RequestTelemetryData)}else ie=[];var xe=oa.duration,Lf=qd.a(oa.url);oa=new ab(ya,xe,oa.totalOperationDuration,oa.eOd,oa.bE,Dd,oa.JGd,ie,oa.httpStatus,Lf,yb,!0,Sd.a.vJ(xe),this.k$c(oa.hd),oa.responseSize,this.Uja.T0a(),oa.responseToCallbackTime);this.wDd(oa)};xb.prototype.Io=function(ya,oa){ya="UnknownMethodName";var yb=-1;void 0!==oa.context&&null!==oa.context&&(ya=oa.context.methodName,yb=oa.context.communicationErrorRetryCount);
var Dd=oa.duration,ie=qd.a(oa.url);oa=new ab(ya,Dd,oa.totalOperationDuration,oa.eOd,oa.bE,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},oa.JGd,oa.errors||[],oa.httpStatus,ie,yb,!1,Sd.a.vJ(Dd),this.k$c(null),-1,this.Uja.T0a(),oa.responseToCallbackTime);this.wDd(oa)};xb.prototype.wDd=function(ya){this.zH.dwg(ya);if(Pe.EwaSettings.ka(232)){var oa=ya.requestName;if(oa!==Se.a.Dta&&"SetCell"!==oa&&"FindRange"!==oa&&"FindAll"!==oa&&"FindCell"!==
oa)return}oa=Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===ya.requestName||null===ya.requestName)&&ya.isPromotedUTRRequest;xb.V5g(ya,oa);Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5158052_AddInfraToRecordKpiForWebRequests")&&xb.VOi(ya);this.zH.Omg(ya)};xb.prototype.k$c=function(ya){if(ya&&ya.CollaborationResult&&ya.CollaborationResult.Users)return ya.CollaborationResult.Users.length;ya=this.$.fa.tm.length;return 0<ya?ya:1};xb.V5g=function(ya,oa){oa?dg.b().Kpc(388829456,
0,15,ya):(oa=Sys.Serialization.JavaScriptSerializer.serialize(ya),hd.ULS.sendTraceTag(388829456,0,50,oa));if(Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==ya.requestName&&null!==ya.requestName&&ya.isFullyLoggedKPIRequest){oa=new Map;oa.set("isUserTriggeredRequest",ya.isUserTriggeredRequest.toString());oa.set("requestDuration",ya.requestDuration.toString());oa.set("totalOperationDuration",ya.totalOperationDuration.toString());oa.set("requestTimeInQueue",ya.requestTimeInQueue.toString());
oa.set("requestInvokedTime",ya.requestInvokedTime.toString());oa.set("ecsOperationDuration",ya.ecsOperationDuration.toString());oa.set("ecsRequestDuration",ya.EcsRequestDuration.toString());oa.set("wfeRequestDuration",ya.WfeRequestDuration.toString());oa.set("timeFromLastEcsFreeze",ya.TimeFromLastEcsFreeze.toString());oa.set("duringLoadOnDemand",ya.DuringLoadOnDemand.toString());oa.set("correlationID",ya.correlationID);oa.set("errors",ya.errors.toString());oa.set("httpStatus",ya.httpStatus.toString());
if(ya.networkInfoData){var yb=ya.networkInfoData;oa.set("networkInfoData_bandwidthMps",void 0!==yb.bandwidthMps&&null!==yb.bandwidthMps?yb.bandwidthMps.toString():"NA");oa.set("networkInfoData_rttMs",void 0!==yb.rttMs&&null!==yb.rttMs?yb.rttMs.toString():"NA");oa.set("networkInfoData_effectiveConnection",void 0!==yb.effectiveConnection&&null!==yb.effectiveConnection?yb.effectiveConnection:"NA")}ya.requestResourceTiming&&(yb=ya.requestResourceTiming,oa.set("requestResourceTiming_fetchStart",void 0!==
yb.downloadDuration&&null!==yb.downloadDuration?yb.downloadDuration.toString():"NA"));oa.set("communicationErrorRetryCount",ya.communicationErrorRetryCount.toString());oa.set("successfulCall",ya.successfulCall.toString());oa.set("isDocumentHidden",ya.isDocumentHidden.toString());oa.set("coauthorsCount",ya.coauthorsCount.toString());oa.set("responseSize",ya.responseSize.toString());oa.set("responseToCallbackTime",ya.responseToCallbackTime.toString());dg.b().Pnc(ya.requestName,ya.successfulCall,oa)}};
xb.VOi=function(ya){var oa=ya.requestName;if(!Ya.eOg.contains(oa))if(!Bc.HelperMethods.TY&&!xb.U5e)hd.ULS.sendTraceTag(537153872,0,15,"RequestStatistics.RecordKpiForRequest: Failed to record KPI since usage is not supported."),xb.U5e=!0;else if(oa in Ya.D5f){var yb=new Map,Dd=oa+"WebRequest";yb.set("IsUserTriggeredRequest",ya.isUserTriggeredRequest.toString());yb.set("RequestDuration",ya.requestDuration.toString());yb.set("TotalOperationDuration",ya.totalOperationDuration.toString());yb.set("RequestTimeinQueue",
ya.requestTimeInQueue.toString());yb.set("EcsOperationDuration",ya.ecsOperationDuration.toString());yb.set("WfeRequestDuration",ya.WfeRequestDuration.toString());yb.set("ResponseSize",ya.responseSize.toString());yb.set("IsSuccessfulCall",ya.successfulCall.toString());yb.set("EcsRequestDuration",ya.EcsRequestDuration.toString());yb.set("ResponseToCallbackTime",ya.responseToCallbackTime.toString());Pf.Health.instance.recordKpiUsage(Dd,0,Ya.D5f[oa].toString(),yb)}};xb.U5e=!1;Object(xc.a)(xb,"RequestStatistics",
null,[]);var xd=b(193),Lg=b(81),hg=b(304);Object(xc.a)(pb,"OperationTypeStatisticsData",null,[]);ib.prototype.ee=function(ya){this.data.totalCount<ib.P1c&&(Array.add(this.GVf,ya.startToNextFrame),Array.add(this.HVf,ya.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<ya.startToNextFrame&&(this.data.longestStartToNextFrame=ya.startToNextFrame);this.data.longestStartToResponse<ya.startToResponseRenderEnd&&(this.data.longestStartToResponse=ya.startToResponseRenderEnd)};
ib.prototype.N5c=function(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.jTe(this.GVf),this.data.startToResponsePercentiles=this.jTe(this.HVf))};ib.prototype.jTe=function(ya){ya.sort(Bc.HelperMethods.eC);var oa="("+Sd.a.nta(ya,25).toString();oa=oa+", "+Sd.a.nta(ya,50).toString();oa=oa+", "+Sd.a.nta(ya,75).toString();oa=oa+", "+Sd.a.nta(ya,95).toString();return oa+")"};ib.P1c=1E3;Object(xc.a)(ib,"OperationTypeStatistics",null,[]);Object(xc.a)(Pa,"RequestTypeStatisticsData",null,
[]);xa.prototype.dYi=function(ya){this.data.totalCount<xa.P1c&&Array.add(this.r9a,ya.requestDuration);this.data.totalCount++;this.WOd+=ya.requestDuration;this.QOd+=xa.V7c(ya.ecsOperationDuration);this.POd+=xa.V7c(ya.EcsRequestDuration);this.ZOd+=xa.V7c(ya.WfeRequestDuration);0<ya.TimeFromLastEcsFreeze&&ya.TimeFromLastEcsFreeze<xa.$ph&&this.data.callsDuringEcsFreeze++;ya.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;ya.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;
if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<ya.requestDuration)this.data.longestRequest=ya};xa.prototype.N5c=function(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.WOd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.QOd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.POd/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.ZOd/
this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.r9a.sort(Bc.HelperMethods.eC),this.data.requestDurationPercentile25=Sd.a.nta(this.r9a,25),this.data.requestDurationPercentile50=Sd.a.nta(this.r9a,50),this.data.requestDurationPercentile75=Sd.a.nta(this.r9a,75),this.data.requestDurationPercentile95=Sd.a.nta(this.r9a,95))};xa.V7c=function(ya){return 0>ya?0:ya};xa.$ph=3E3;xa.P1c=1E3;Object(xc.a)(xa,"RequestTypeStatistics",
null,[]);Object(xc.a)(ma,"SessionStatisticsData",null,[]);na.prototype.Pd=function(){var ya=this.XYg();Ke.a.dca()?this.$.yla(xd.a.zDj,{xlendJson:ya},!1):Lg.ob(this.$.ra.ua,ya,null,null,null,null,null);ya=this.YYg();Ke.a.dca()?this.$.yla(xd.a.ADj,{xlenoJson:ya},!1):hd.ULS.sendTraceTag(388776782,0,50,ya);Pe.EwaSettings.ka(69)&&(ya=this.pTg(),Ke.a.dca()?this.$.yla(xd.a.yDj,{xlencJson:ya},!1):hd.ULS.sendTraceTag(388776770,0,50,ya));this.KYi()};na.prototype.Cdc=function(){this.everConnectedToOcs=this.$.fa.t4a||
this.everConnectedToOcs;Pf.Health.instance&&Pf.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())};na.prototype.Ih=function(){var ya=new hg.a,oa="",yb=!this.$.isAnonymousUser(),Dd=ya.Yf();if(Dd){if(yb){ya.Eqc("UMI_Linkable","true");return}oa=ya.P0a("UMI_Linkable")}yb||hd.ULS.sendTraceTag(537153870,0,50,"SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:{0}, UMIIsLinkable:{1}",Dd,!hf.a.ma(oa))};na.prototype.m9a=function(){this.ULd=
!0};na.prototype.yXi=function(ya){this.dirtySessionOnLastRecordedRequest=ya};na.prototype.dwg=function(ya){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,ya.coauthorsCount);Pf.Health.instance&&Pf.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())};na.prototype.Omg=function(ya){if(!(ya.requestName in this.ujb)){var oa=new xa(ya.requestName);this.ujb[ya.requestName]=oa}this.ujb[ya.requestName].dYi(ya)};na.prototype.Nmg=function(ya){if(!(ya.name in this.tjb)){var oa=
new ib(ya.name,ya.isUserOperation);this.tjb[ya.name]=oa}this.tjb[ya.name].ee(ya)};na.prototype.jfa=function(ya){this.F_c[ya.reportName]=ya};na.prototype.KYi=function(){this.dirtySessionOnLastRecordedRequest=this.ULd=!1;this.sbf=this.$.fa.cnd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.ujb={};this.tjb={};this.F_c={}};na.prototype.XYg=function(){var ya=new ma(this.$.isEditMode?"edit":"view",this.$.fa.ocsCapable,this.ULd,this.dirtySessionOnLastRecordedRequest,this.$.fa.cnd-this.sbf,this.maxCoauthorsCount,
this.everConnectedToOcs,this.ujb);return Sys.Serialization.JavaScriptSerializer.serialize(ya)};na.prototype.YYg=function(){var ya=new bc.a,oa=this.tjb,yb;for(yb in oa){var Dd=oa[yb];Dd.N5c();ya.add(Dd.data)}ya=ya.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(ya)};na.prototype.pTg=function(){return Sys.Serialization.JavaScriptSerializer.serialize(this.F_c)};Object(xc.a)(na,"SessionStatistics",null,[]);var Dg=Eg.a;Em(La,Dg);La.prototype.dispose=function(){this.$&&Pe.EwaSettings.ka(41)&&
(this.$.Lo(Object(Fc.a)(this,this.Pd,"onWorkbookClosing")),this.$.ra.yt(Object(Fc.a)(this,this.Oh,"onWebMethodSuccess")),this.$.ra.BC(Object(Fc.a)(this,this.Io,"onWebMethodError")),this.$.fa.pFf(Object(Fc.a)(this,this.Cdc,"isUsingOcsChanged")),Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.fa.Er(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive")));he.a.Fa(this.Uja);he.a.Fa(this.i5a);this.oHc=null;he.a.Fa(this.mM);this.mM=null;he.a.Fa(this.iod);this.$=
this.iod=null;Dg.prototype.dispose.call(this)};La.prototype.m9a=function(){Pe.EwaSettings.ka(41)&&this.zH.m9a()};La.prototype.Snc=function(ya,oa,yb,Dd,ie,xe,Lf,ph,Sf,Zg,Bh,ti,ci,fi){Pe.EwaSettings.ka(41)&&(this.dla=this.dla||new xb(this.$,this.zH,this.Uja),this.dla.Snc(ya,oa,yb,Dd,ie,xe,Lf,ph,Sf,Zg,Bh,ti,ci,fi))};La.prototype.AEb=function(ya,oa){Pe.EwaSettings.ka(41)&&(this.vka=this.vka||new ta(this.$,this.zH,this,this.mM),this.vka.AEb(ya,oa))};La.prototype.Hnc=function(){Pe.EwaSettings.ka(41)&&(this.vka=
this.vka||new ta(this.$,this.zH,this,this.mM),this.vka.Hnc())};La.prototype.Onc=function(){Pe.EwaSettings.ka(41)&&(this.vka=this.vka||new ta(this.$,this.zH,this,this.mM),this.vka.Onc())};La.prototype.jfa=function(ya){Pe.EwaSettings.ka(41)&&this.zH.jfa(ya)};La.prototype.U8c=function(ya){return Pe.EwaSettings.ka(41)?this.vxe[ya]:null};La.prototype.JNf=function(ya){ya&&(this.vxe[ya.type]=ya)};La.prototype.T0a=function(){return this.Uja.T0a()};La.prototype.lVg=function(){ld.a.Co&&void 0!==window.PerformanceObserver&&
null!==window.PerformanceObserver&&(this.oHc=new eb(this.$,this.mM))};La.prototype.Oh=function(ya,oa){Pe.EwaSettings.ka(41)&&(this.dla=this.dla||new xb(this.$,this.zH,this.Uja),this.dla.Oh(ya,oa))};La.prototype.Io=function(ya,oa){Pe.EwaSettings.ka(41)&&(this.dla=this.dla||new xb(this.$,this.zH,this.Uja),this.dla.Io(ya,oa))};La.prototype.Pd=function(ya,oa){Pe.EwaSettings.ka(41)&&this.zH.Pd(ya,oa)};La.prototype.Ih=function(ya,oa){Pe.EwaSettings.ka(41)&&this.zH.Ih(ya,oa)};La.prototype.Cdc=function(ya,
oa){Pe.EwaSettings.ka(41)&&this.zH.Cdc(ya,oa)};Ll.Object.defineProperties(La.prototype,{i5a:{configurable:!0,enumerable:!0,get:function(){return this.oHc}}});Object(xc.a)(La,"SessionStatisticsManager",Eg.a,[215]);var cf=b(101),Hg=b(1200),uh=b(113),te=b(121);ra.prototype.vqj=function(){return Vg.a.Hc(this)};Object(xc.a)(ra,"AppUnloadInfo",null,[]);var Wg=b(1397),Kf=b(120),nd=b(957);ca.prototype.yGg=function(ya){var oa=new Wg.a(nd.a.RL()),yb=0,Dd=0;ya=Ol(ya);for(var ie=ya.next();!ie.done;ie=ya.next()){ie=
ie.value;oa.qb(ie)||oa.ia(ie,0);var xe=void 0,Lf=oa.ia(xe=ie,oa.oa(xe)+1);Lf>yb&&(yb=Lf,Dd=ie)}yb>this.mostCommonOperationCount&&(this.mostCommonOperationName=Kf.a(Dd),this.mostCommonOperationCount=yb)};Object(xc.a)(ca,"DataLossInfo",null,[]);var qe=b(53);Z.prototype.dispose=function(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.jWi(Object(Fc.a)(this,this.Vtf,"onUserOperationsLost"));this.wf&&(this.wf.Rxa(Object(Fc.a)(this,this.Vaa,"onThrottledUserActivity")),this.wf=null);this.hk.GB();
this.$=this.hk=null};Z.prototype.Vaa=function(ya,oa){this.K0e=oa.wuc};Z.prototype.Vtf=function(ya,oa){oa.PRd.length&&this.$.cE&&(this.Qx.dataLossInfo=new ca(oa),this.Qx.wasDataLostDuringUnload=!0,this.T9a())};Z.prototype.Ih=function(){this.kMf();this.$.fa.Er(Object(Fc.a)(this,this.Ih,"onCommandUIGeneratedAndGridInteractive"))};Z.prototype.Lzb=function(){this.Qx.wasUpdatedOnBeforeUnload=!0;this.Qx.inactivityDurationBeforeUnloadSeconds=this.wf.hbb<Z.ghi?this.K0e:this.wf.hbb;this.R2f()};Z.prototype.oBb=
function(){this.Qx.wasUpdatedOnUnload=!0;this.R2f();Sys.Application.remove_unload(Object(Fc.a)(this,this.oBb,"onUnload"))};Z.prototype.R2f=function(){this.daj();this.T9a()};Z.prototype.daj=function(){this.Qx.wasOfflineDuringUnload=this.$.qf.qU;this.Qx.timeFromLastConnectivity=uh.a(fg.a.Qa,this.$.qf.maf);this.Qx.timeFromLastDisconnectionStart=uh.a(fg.a.Qa,this.$.qf.O9h);this.Qx.disconnectionSource=Enum.toString(Hg.a,this.$.qf.disconnectionSource);this.NGf&&(this.Qx.hadConnectivityIssuesDuringUnload=
this.$.qf.Yia,this.Qx.timeFromLastStatusCode0=uh.a(fg.a.Qa,this.$.qf.laf))};Z.prototype.T9a=function(){this.Qx.timestamp=Date.now();this.localStorage.Eqc(this.QQc,this.Qx.vqj())};Z.prototype.kMf=function(){var ya=this.localStorage.P0a(this.QQc);if(hf.a.ma(ya))hd.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information");else try{var oa=Vg.a.Xh(ya);this.localStorage.ABd(this.QQc);var yb=this.Ifi(oa);hd.ULS.sendTraceTag(574677456,0,50,yb)}catch(Dd){hd.ULS.sendTraceTag(537151056,
0,15,"AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: {0}",Dd.message)}};Z.prototype.Ifi=function(ya){var oa={};oa.WACSessionID=ya.wacSessionId;oa.wasRefreshed=this.hKg(ya,this.$.ya.MaxAppReloadDurationIndicatingRefresh);oa.closedWithDialogConfirmation=ya.dialogPromptedOnUnload;oa.wasOfflineDuringUnload=ya.wasOfflineDuringUnload;oa.TimeFromLastConnectivityMs=ya.timeFromLastConnectivity;oa.TimeFromLastDisconnectionStart=ya.timeFromLastDisconnectionStart;oa.wasDataLostDuringUnload=
ya.wasDataLostDuringUnload;oa.DataLossInfo=ya.dataLossInfo;oa.flushedOnUnload=ya.wasUpdatedOnUnload;oa.flushedOnBeforeUnload=ya.wasUpdatedOnBeforeUnload;oa.InactivityDurationBeforeUnload=ya.inactivityDurationBeforeUnloadSeconds;oa.DisconnectionSource=ya.disconnectionSource;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(oa.ApiBeforeCloseNotificationEnabledOnUnload=ya.apiBeforeCloseNotificationEnabledOnUnload);this.NGf&&(oa.hadConnectivityIssuesDuringUnload=
ya.hadConnectivityIssuesDuringUnload,oa.TimeFromLastStatusCode0=ya.timeFromLastStatusCode0);Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&(oa.LastSilentReopenStartTime=ya.lastSilentReopenStartTime,oa.LastSilentReopenEndTime=ya.lastSilentReopenEndTime);return Fe.c(oa)};Z.prototype.hKg=function(ya,oa){var yb=window.performance.timing.navigationStart-ya.timestamp;(ya=this.workbookHashedId===ya.workbookHashedId&&yb<oa)&&hd.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");
return ya};Z.prototype.Nzi=function(){this.Qx.lastSilentReopenStartTime=fg.a.Qa.Gb;this.Qx.lastSilentReopenEndTime=null;this.T9a();this.$.Jk(Object(Fc.a)(this,this.Nsf,"onSilentReopenEnded"))};Z.prototype.Nsf=function(){this.Qx.lastSilentReopenEndTime=fg.a.Qa.Gb;this.T9a();this.$.dl(Object(Fc.a)(this,this.Nsf,"onSilentReopenEnded"))};Z.ja=function(ya){ya.fa.ic.inWebPart||ya.ea.Ia(410,new Z(ya))};Ll.Object.defineProperties(Z.prototype,{dialogPromptedOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.tYd},
set:function(ya){this.tYd=ya;this.Qx?(this.Qx.dialogPromptedOnUnload=ya,this.T9a()):this.localStorage.Yf()&&hd.ULS.sendTraceTag(537151058,0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",this.localStorage.Yf())}},apiBeforeCloseNotificationEnabledOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.SUd},set:function(ya){this.SUd=ya;this.Qx?(this.Qx.apiBeforeCloseNotificationEnabledOnUnload=ya,this.T9a()):this.localStorage.Yf()&&
hd.ULS.sendTraceTag(537151057,0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",this.localStorage.Yf())}}});Z.ghi=10;Object(xc.a)(Z,"AppUnloadTelemetryManager",null,[334,6]);var Qg=b(196),ae=b(107);U.prototype.$Vf=function(){hd.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.fmj(this))};
U.prototype.dispose=function(){this.$Vf()};Ll.Object.defineProperties(U.prototype,{call:{configurable:!0,enumerable:!0,get:function(){return this.M$f}}});Object(xc.a)(U,"CallMeasureContext",null,[343,6]);da.prototype.dQg=function(){this.BIe=Bc.HelperMethods.Ac()};da.prototype.WVf=function(){this.F4c+=Bc.HelperMethods.Ac()-this.BIe};da.prototype.yBh=function(){return Bc.HelperMethods.Ac()-this.startTime};da.prototype.Zlj=function(){this.WVf();return this.F4c};Ll.Object.defineProperties(da.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},type:{configurable:!0,enumerable:!0,get:function(){return this.gB}}});Object(xc.a)(da,"MeasuredCall",null,[]);V.prototype.xVf=function(ya,oa){this.KVg();this.bmj();ya=new da(ya,oa);this.Gqa.push(ya);return new U(this,ya)};V.prototype.KVg=function(){0<this.Gqa.length?hd.ULS.shipAssertTag(537151054,1,!hf.a.ma(this.VUc),"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):this.VUc=Qg.a.create().toString()};
V.prototype.fmj=function(ya){var oa=this.Gqa.pop();if(ya.call!==oa)hd.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",ya.call.name,oa?oa.name:"null"),this.Gqa=[];else{ya=oa.yBh();var yb=oa.Zlj();hd.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var Dd=this.documentVisibilityObserver?
this.documentVisibilityObserver.vJ(ya+this.iii):null;this.Dci(oa,ya,yb,Dd);this.eQg()}};V.prototype.bmj=function(){var ya=this.HRe();ya&&ya.WVf()};V.prototype.eQg=function(){var ya=this.HRe();ya&&ya.dQg()};V.prototype.HRe=function(){return this.Gqa.length?this.Gqa[this.Gqa.length-1]:null};V.prototype.Dci=function(ya,oa,yb,Dd){if(!(oa<this.hii)){var ie=ae.f(this.Gqa,function(xe){return xe.name}).join();hd.ULS.sendTraceTag(537151051,0,50,"ChainedCallsTracer: Inclusive duration: {0} Exclusive duration: {1} Chain ID: {2} Call ID: {3} Type: {4} Document hidden: {5} Call chain: {6}",
oa.toFixed(2),yb.toFixed(2),this.VUc,ya.name,ya.type,Dd,ie)}};V.ja=function(ya){if(Pe.EwaSettings.ka(726)){var oa=new V(ya.ya.ChainedCallsTracerMinThresholdToLogInMs);ya.ea.$a(291,function(yb){oa.documentVisibilityObserver=yb});ya.ea.Ia(425,oa);yf.a.C6i(oa)}};Object(xc.a)(V,"ChainedCallsTracer",null,[333]);var Nh=b(520);Y.prototype.Crj=function(ya){var oa={};oa=(oa.TaskName=ya.TN,oa.TotalRunInMs=ya.TRT,oa.TotalDelayInMs=ya.TDT,oa.TotalQueueInMs=ya.TQT,oa.TaskPriority=ya.TP,oa.CoauthorsCount=this.fa.tm.length,
oa);ya.TDT>this.lOd||ya.TRT>this.jOd?hd.ULS.sendTraceTag(321938518,0,15,me.a.toJSON(oa)):(ya.TDT>this.kOd||ya.TRT>this.iOd)&&hd.ULS.sendTraceTag(321938508,0,50,me.a.toJSON(oa))};Y.prototype.Qlh=function(ya){return this.nf.vJ(ya.TRT+ya.TQT+3E3)?!1:ya.TDT>Math.min(this.kOd,this.lOd)||ya.TRT>Math.min(this.iOd,this.jOd)};Object(xc.a)(Y,"TaskEventProcessor",null,[]);var wd=b(16);G.prototype.dispose=function(){this.$=null};G.prototype.O0i=function(){this.iye||this.FGg();var ya=ge.c(ge.g(this.$));if(!this.gye){var oa=
wd.a.instance.Ua(279).split(",");Array.addRange(ya,oa);this.gye=!0}ya=Ol(ya);for(oa=ya.next();!oa.done;oa=ya.next())oa=oa.value,hf.a.ma(oa)||this.oYf.has(oa)||(this.Mci(oa),this.oYf.add(oa))};G.prototype.Mci=function(ya){this.DHg(ya)};G.prototype.FGg=function(){this.iye=G.I0a("monospace");G.I0a("sans-serif");G.I0a("serif")};G.prototype.DHg=function(ya){G.I0a(String.format("{0},{1}",ya,"monospace"));G.I0a(String.format("{0},{1}",ya,"sans-serif"));G.I0a(String.format("{0},{1}",ya,"serif"))};G.prototype.$c=
function(){this.O0i();ge.g(this.$).ga&&ge.g(this.$).ga.aK(Object(Fc.a)(this,this.$c,"onSelectionChanged"))};G.prototype.Ai=function(ya,oa){oa.qa&&!this.TNd.has(oa.qa.name)&&(this.TNd.add(oa.qa.name),ge.g(this.$).ga&&(ge.g(this.$).ga.aK(Object(Fc.a)(this,this.$c,"onSelectionChanged")),ge.g(this.$).ga.GF(Object(Fc.a)(this,this.$c,"onSelectionChanged"))))};G.ja=function(ya){if(Pe.EwaSettings.ka(62)){var oa=new G(ya);ya.ea.Ia(210,oa)}};G.I0a=function(ya){var oa=document.createElement("div"),yb=document.createElement("div");
oa.style.cssText="position: absolute; overflow: auto; visibility: hidden;";G.O$i(yb,ya);document.body.appendChild(oa);oa.appendChild(yb);yb.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";ya=yb.offsetWidth+"x"+yb.offsetHeight;document.body.removeChild(yb.parentNode);return ya};G.O$i=function(ya,oa){ya.style.cssText="display: inline; visibility: hidden;";ya.style.fontSize="100px";ya.style.fontWeight="normal";ya.style.fontStyle="normal";ya.style.letterSpacing=
"normal";ya.style.lineHeight="normal";ya.style.whiteSpace="nowrap";ya.style.fontFamily=oa};Object(xc.a)(G,"FontTelemetryManager",null,[6]);var ze=b(228),Ah=b(162),Xh=b(502),pg=b(104),vg=yf.a;Em(W,vg);W.prototype.LDa=function(ya){this.addHandler("ekdh",ya)};W.prototype.V8a=function(ya){this.removeHandler("ekdh",ya)};W.prototype.okb=function(ya){this.addHandler("ekduh",ya)};W.prototype.dEb=function(ya){this.removeHandler("ekduh",ya)};W.prototype.vJ=function(ya){return this.aj?!0:this.gec?Zd.getElapsedMilliseconds(this.gec,
fg.a.Qa.Gb)<ya:!1};W.prototype.dispose=function(){he.a.Fa(this.ZX);he.a.Fa(this.hk);vg.prototype.dispose.call(this)};W.prototype.J2f=function(){this.JK="hidden"===window.document.visibilityState;this.aj?(this.raiseEvent("ekdh"),this.F2d=fg.a.Qa.Gb):(this.raiseEvent("ekduh"),this.G2d=fg.a.Qa.Gb)};W.prototype.gtd=function(){this.J2f()};W.prototype.bxi=function(){he.a.Fa(this.ZX);he.a.Fa(this.hk)};Ll.Object.defineProperties(W.prototype,{aj:{configurable:!0,enumerable:!0,get:function(){return this.JK}},
C$e:{configurable:!0,enumerable:!0,get:function(){return this.F2d}},gec:{configurable:!0,enumerable:!0,get:function(){return this.G2d}}});Object(xc.a)(W,"DocumentVisibilityObserver",yf.a,[283,6]);Object(xc.a)(fa,"FramePerformanceData",null,[]);Object(xc.a)(aa,"FramePerformanceDataGroup",null,[]);Ll.Object.defineProperties(L.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this._reportName}}});Object(xc.a)(L,"FramePerformanceSessionEndsReport",null,[250]);Q.prototype.$Vg=
function(){this.vfa=new aa("AllGridOperationsData");this.df.operationsGroups.push(this.vfa);this.eob("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.eob("DragScroll",["DragScroll"]);this.eob("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.eob("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.eob("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])};Q.prototype.XXi=function(ya,oa,yb,Dd){var ie=this.zAh(ya);ie&&(ae.b(this.df.operationsGroups,function(xe){return hf.a.equals(xe.name,ie.name,!1)})||this.df.operationsGroups.push(ie),ie.count++,this.fwc(oa,
ie),this.bwc(yb,ie),this.vfa.count++,this.fwc(oa,this.vfa),this.bwc(yb,this.vfa),0<Dd&&this.Rxj(Dd,ie),0<=oa&&this.mxj(oa,ie))};Q.prototype.uyj=function(){for(var ya=Ol(this.df.operationsGroups),oa=ya.next();!oa.done;oa=ya.next())Q.sxj(oa.value)};Q.prototype.eob=function(ya,oa){ya=new aa(ya);oa=Ol(oa);for(var yb=oa.next();!yb.done;yb=oa.next())this.svd[yb.value]=ya};Q.prototype.zAh=function(ya){return ya in this.svd?this.svd[ya]:null};Q.prototype.mxj=function(ya,oa){30>ya&&this.rQd(function(yb){yb.l1FramePerformanceData.fpsUnderThresholdOps++},
oa);15>ya&&this.rQd(function(yb){yb.l2FramePerformanceData.fpsUnderThresholdOps++},oa);5>ya&&this.rQd(function(yb){yb.l3FramePerformanceData.fpsUnderThresholdOps++},oa)};Q.prototype.Rxj=function(ya,oa){100<=ya&&(this.Zbb(oa.l1FramePerformanceData,ya,Object(Fc.a)(this,this.Ybb,"updateLongFrameAction")),this.Zbb(this.vfa.l1FramePerformanceData,ya,Object(Fc.a)(this,this.Ybb,"updateLongFrameAction")));300<=ya&&(this.Zbb(oa.l2FramePerformanceData,ya,Object(Fc.a)(this,this.Ybb,"updateLongFrameAction")),
this.Zbb(this.vfa.l2FramePerformanceData,ya,Object(Fc.a)(this,this.Ybb,"updateLongFrameAction")));600<=ya&&(this.Zbb(oa.l3FramePerformanceData,ya,Object(Fc.a)(this,this.Ybb,"updateLongFrameAction")),this.Zbb(this.vfa.l3FramePerformanceData,ya,Object(Fc.a)(this,this.Ybb,"updateLongFrameAction")))};Q.prototype.rQd=function(ya,oa){oa&&(ya(oa),ya(this.vfa))};Q.prototype.Zbb=function(ya,oa,yb){ya&&yb(ya,oa)};Q.prototype.Ybb=function(ya,oa){ya.longFramesOverThresholdOps++;ya.maxLongFrameDuration=Math.max(ya.maxLongFrameDuration,
oa)};Q.prototype.fwc=function(ya,oa){oa.minFPS=-1===oa.minFPS?ya:Math.min(oa.minFPS,ya)};Q.prototype.bwc=function(ya,oa){oa.maxFPS=Math.max(oa.maxFPS,ya)};Q.sxj=function(ya){Q.RQd(ya.l1FramePerformanceData,ya.count);Q.RQd(ya.l2FramePerformanceData,ya.count);Q.RQd(ya.l3FramePerformanceData,ya.count)};Q.RQd=function(ya,oa){ya.fpsUnderThresholdOpsPercentage=100*ya.fpsUnderThresholdOps/oa;ya.longFramesOverThresholdOpsPercentage=100*ya.longFramesOverThresholdOps/oa};Object(xc.a)(Q,"FramePerformanceSessionEndsReportManager",
null,[]);Object(xc.a)(S,"FpsDataWrapper",null,[]);Object(xc.a)(H,"LongFrameData",null,[]);var Ih=b(336);Object(xc.a)(A,"OperationFPSData",null,[]);var Eh=b(34),Zh=b(906),ih=Eg.a;Em(E,ih);E.prototype.start=function(){this.vEd=!0;this.resume()};E.prototype.stop=function(){this.vEd=!1;this.pause()};E.prototype.dispose=function(){this.stop();this.nf.V8a(Object(Fc.a)(this,this.QU,"onDocumentHidden"));Rc.AFrameworkApplication.IEf(Object(Fc.a)(this,this.Hjf,"onAppSleep"));Rc.AFrameworkApplication.JEf(Object(Fc.a)(this,
this.Jjf,"onAppWakeup"));he.a.Fa(this.nf);this.Ca.Jq(Object(Fc.a)(this,this.Sg,"onBlockCacheConsistent"));ih.prototype.dispose.call(this)};E.prototype.rlj=function(ya,oa){var yb=ya in this.Kga?this.Kga[ya]:null;this.rxb=new Date;this.start();var Dd=this.rxb.getSeconds(),ie=Dd+this.npj;yb&&Dd<=yb.end?(yb.count++,yb.end=ie):(yb&&Dd>yb.end&&this.lsa.add(yb),this.Kga[ya]=new A(ya,1,Dd,ie,void 0,void 0,void 0,this.$.fa.tm.length,og.PageLoadTrackingInfo.instance.Eta(this.rxb),oa))};E.prototype.mUg=function(){this.$_a||
(this.r6c(new Date),this.$_a=new Q(this.$))};E.prototype.resume=function(){this.M4e()||!this.Ca.DC||this.isSynthetic||(this.O4a=this.nf.aj,this.Ava=new Date,this.Sld=this.Ava.getMinutes(),this.PDd(),this.Jze(this.Ava.getSeconds()),this.Skb=window.requestAnimationFrame(Object(Fc.a)(this,this.vMe,"fpsTick")))};E.prototype.M4e=function(){return 0<=this.Skb};E.prototype.pause=function(){this.M4e()&&(this.O4a||(this.Kze((new Date).getSeconds()),hd.ULS.sendTraceTag(21280654,0,50,"FPS : {0}",this.AX.toString())),
window.cancelAnimationFrame(this.Skb),this.Skb=-1)};E.prototype.vMe=function(){var ya=new Date,oa=ya.getMinutes(),yb=ya.getSeconds();this.rxb&&ya.getTime()-this.rxb.getTime()>this.opj?(this.stop(),this.r6c(ya)):(oa!==this.Sld&&(this.r6c(ya),this.Sld=oa),this.O4a&&(this.nf.aj?this.AX[yb]=E.f2b:(this.Jze(yb),this.O4a=!1,this.lsa.clear(),this.Kga={})),this.AX[yb]!==E.f2b&&(this.AX[yb]++,oa=+ya-+this.Ava,oa>this.hdf&&this.jdi(this.Ava,oa)),this.Skb=window.requestAnimationFrame(Object(Fc.a)(this,this.vMe,
"fpsTick")),this.Ava=ya)};E.prototype.r6c=function(ya){if(+ya-+this.Ava<E.fii&&(this.O4a&&this.Kze(this.Ava.getSeconds()),this.r8g(),0<this.lsa.count&&(ya={},ya.NonEmptyCellsCount=this.U5a,ya.TextCellsCount=this.muc,ya.xlfpsJson=Object.assign(new S,{f:this.lsa.toArray()}),ya.memoryInfo=this.shi(),ya.zoom=Eh.a(this.$)?Eh.a(this.$).zoom:1,ya.HtmlOverlayDomCount=this.lJa,Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:4941972_AddRibbonModeToXLFPS")&&(ya.RibbonMode=Ah.a(this.$)?Xh.a[Ah.a(this.$).IQ]:E.invalid),
Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5855471_xlfpsDeviceMem")&&(ya.deviceMemory=navigator.deviceMemory||0),Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5872137_addDeviceMemoryAndHardwareConcurrency")&&(ya.hardwareConcurrency=navigator.hardwareConcurrency||0),ya=JSON.stringify(ya),hd.ULS.sendTraceTag(537151044,0,50,"FPS : {0}",this.AX.toString()),!this.isSynthetic))){Ke.a.dca()?this.$.yla(xd.a.BDj,{xlfpsJson:ya},!1):hd.ULS.sendTraceTag(388781010,0,50,"{0}",ya);if(this.kdi)for(var oa=Ol(this.lsa),
yb=oa.next();!yb.done;yb=oa.next()){yb=yb.value;var Dd=1E3>=this.U5a?"0_1000":3E3>=this.U5a?"1000_3000":"3000_inf",ie=new Map;ie.set("Operation",yb.Op);ie.set("BucketOfRenderedCells",Dd);Pf.Health.instance.recordKpiUsage(Wb.a.longFrame,0,gb.a.canvas,ie);0<yb.longFrameCount&&Pf.Health.instance.recordKpiFailure(Wb.a.longFrame,"LongFrame",!1,!0,Object.assign(new ng.a,{extendedProperties:ie}));3E4<yb.tfAppInt&&(0<yb.longFrameCount?dg.b().bHf(0,this.Cei,ie):dg.b().cHf(0,ie))}hd.ULS.sendTraceTag(537151043,
0,50,"Operations message length: {0}",ya.length)}this.reset()};E.prototype.shi=function(){var ya={};if(window.performance){var oa=window.performance.memory;oa&&(ya.jsHeapSizeLimit=oa.jsHeapSizeLimit,ya.usedJSHeapSize=oa.usedJSHeapSize,ya.totalJSHeapSize=oa.totalJSHeapSize)}return ya};E.prototype.reset=function(){this.lsa.clear();this.Kga={};this.PDd()};E.prototype.r8g=function(){var ya=!0;ya=void 0===ya?!0:ya;if(this.AX){for(var oa=Ol(Zh.a(this.Kga)),yb=oa.next();!yb.done;yb=oa.next())yb=this.Kga[yb.value],
yb.end=Math.min(this.AX.length-1,yb.end),this.lsa.add(yb);this.RGg(this.lsa,this.AX,ya)}};E.prototype.RGg=function(ya,oa,yb){yb=void 0===yb?!0:yb;ya=Ol(ya);for(var Dd=ya.next();!Dd.done;Dd=ya.next()){Dd=Dd.value;var ie=0,xe=0;if(Dd.end<oa.length){for(var Lf=Dd.start;Lf<=Dd.end;Lf++){var ph=oa[Lf];0<=ph&&(Dd.Max=Math.round(Math.max(Dd.Max,ph)),Dd.Min=Math.round(Math.min(Dd.Min,ph)),ie+=ph,xe++)}0<xe&&(Dd.Avg=Math.round(ie/xe));yb&&this.$_a&&this.$_a.XXi(Dd.Op,Dd.Min,Dd.Max,Dd.LFrame?Dd.LFrame.duration:
-1);Dd.Props&&(this.ptj(Dd),Dd.Props=null)}}yb&&this.$_a&&this.$_a.uyj()};E.prototype.PDd=function(){this.AX=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};E.prototype.Jze=function(ya){ya++;for(var oa=0;oa<ya;oa++)this.AX[oa]=E.f2b};E.prototype.Kze=function(ya){for(;60>ya;ya++)this.AX[ya]=E.f2b};E.prototype.jdi=function(ya,oa){ya=ya.getSeconds();var yb=Zh.a(this.Kga);if(0<yb.length){yb=Ol(yb);for(var Dd=yb.next();!Dd.done;Dd=
yb.next())if(Dd=this.Kga[Dd.value],ya>=Dd.start&&ya<Dd.end)Dd.LFrame?Dd.LFrame.duration<oa&&(Dd.LFrame.startSecond=ya,Dd.LFrame.duration=oa,Dd.longFrameCount++):(Dd.LFrame=new H(ya,oa),Dd.longFrameCount++)}};E.prototype.QU=function(){this.O4a=!0};E.prototype.Hjf=function(){this.pause()};E.prototype.Jjf=function(){this.vEd&&this.resume()};E.prototype.Sg=function(){this.Ca.DG()&&this.ayj()};E.prototype.ayj=function(){this.lJa=this.muc=this.U5a=0;for(var ya=Ol(ge.g(this.$).ao),oa=ya.next();!oa.done;oa=
ya.next()){oa=oa.value.$za;for(var yb in oa){var Dd=this.Ca.zk(oa[yb].hashCode);Dd&&Dd.jj&&(this.U5a+=Dd.me.NonEmptyCellsCount,this.muc+=Dd.me.TextValueCellsCount,this.lJa+=Dd.lJa)}}};E.prototype.ptj=function(ya){var oa=ya.Props;if(je.a.KRf in oa&&oa[je.a.KRf]&&je.a.tYf in oa){var yb;(yb=Object(Zf.a)(ze.a,oa[je.a.tYf]))&&yb.continueWith(function(Dd){pg.TextEditorTelemetry.instance.Wog(ya.Op,ya.Min,!!ya.LFrame,ya.LFrame?ya.LFrame.duration:0,Dd.result)})}};E.f2b=-1;E.fii=6E4;E.invalid="Invalid";Object(xc.a)(E,
"FramePerformanceTracker",Eg.a,[268,6]);var eg=bb.a;Em(J,eg);J.prototype.create=function(){var ya=this.$.ea.Ba(263);ya||(ya=this.$.ea.Ia(263,new E(this.$)));this.Eb(ya)};J.ja=function(ya){ya.ea.Ia(264,new J(ya))};Object(xc.a)(J,"FramePerformanceTrackerFactory",bb.a,[]);var oh=b(1252),Hh=b(1058);y.prototype.yi=function(ya,oa){return new Hh.a(ya,oa)};y.prototype.Dc=function(ya,oa){ya=this.yi(ya,oa);ya.start();return ya};Object(xc.a)(y,"DefaultStopwatchBuilder",null,[27]);x.prototype.yi=function(ya,
oa){return this.Zna.yi(ya,oa)};x.prototype.Dc=function(ya,oa){return this.Zna.Dc(ya,oa)};Object(xc.a)(x,"StopwatchBuilder",null,[27]);var X=b(403),Xa=b(908),Pb=b(1043),Gc;(function(ya){ya[ya.actions=0]="actions";ya[ya.correlationStart=1]="correlationStart";ya[ya.reorderSheetOp=2]="reorderSheetOp";ya[ya.formatCellOp=3]="formatCellOp";ya[ya.copyOp=4]="copyOp";ya[ya.pasteOp=5]="pasteOp";ya[ya.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";ya[ya.instantaneousSetData=7]="instantaneousSetData";
ya[ya.immediateSetData=8]="immediateSetData";ya[ya.dependentCellsCalc=9]="dependentCellsCalc";ya[ya.dependentCellsGraphStat=10]="dependentCellsGraphStat";ya[ya.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";ya[ya.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";ya[ya.gridBlockUpdates=13]="gridBlockUpdates";ya[ya.browserAppStart=14]="browserAppStart";ya[ya.linkedObjects=15]="linkedObjects";ya[ya.longFrames=16]="longFrames";ya[ya.task=17]="task";ya[ya.conflictInEditing=
18]="conflictInEditing";ya[ya.incomingPresenceData=19]="incomingPresenceData";ya[ya.editorTableDelay=20]="editorTableDelay";ya[ya.presenceStartup=21]="presenceStartup";ya[ya.presenceDelete=22]="presenceDelete";ya[ya.editorEvent=23]="editorEvent";ya[ya.editorTime=24]="editorTime";ya[ya.gridScreenReaderOps=25]="gridScreenReaderOps";ya[ya.sendPresenceToService=26]="sendPresenceToService";ya[ya.IME=27]="IME";ya[ya.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";ya[ya.customizeStatusBar=29]=
"customizeStatusBar";ya[ya.clientWebRequests=30]="clientWebRequests";ya[ya.showCommentTaskPane=31]="showCommentTaskPane";ya[ya.applyThreadedCommentChange=32]="applyThreadedCommentChange";ya[ya.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";ya[ya.findNextOrPreviousComment=34]="findNextOrPreviousComment";ya[ya.goto=35]="goto";ya[ya.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";ya[ya.richApiInvocation=37]="richApiInvocation";ya[ya.fxLibrary=38]="fxLibrary";ya[ya.embeddedApiSession=
39]="embeddedApiSession";ya[ya.numberFormattingCalculator=40]="numberFormattingCalculator";ya[ya.requestDataAfterSend=41]="requestDataAfterSend";ya[ya.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";ya[ya.copy=43]="copy";ya[ya.paste=44]="paste";ya[ya.dragDrop=45]="dragDrop";ya[ya.clearCopyState=46]="clearCopyState";ya[ya.webWorkerRecalcStats=47]="webWorkerRecalcStats";ya[ya.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";ya[ya.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";
ya[ya.customSort=50]="customSort";ya[ya.namedSheetViewUserAction=51]="namedSheetViewUserAction";ya[ya.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";ya[ya.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";ya[ya.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";ya[ya.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";ya[ya.namedSheetViewTempViewSaveDialog=56]="namedSheetViewTempViewSaveDialog";ya[ya.temporaryViewStartedDataRestore=
57]="temporaryViewStartedDataRestore";ya[ya.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";ya[ya.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";ya[ya.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(Gc||(Gc={}));Object(xc.b)("UsageTable",Gc);var Hc=b(410),Ld=b(470),Ie=b(637),Td=b(681),Re=b(265),ff=Sys.EventArgs;Em(B,ff);Object(xc.a)(B,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);t.prototype.eNg=function(ya){return new t(this.total+ya.total,
this.iFd+ya.iFd)};t.VDg=function(ya,oa){return String.format("{0}_{1}",ya,oa)};Ll.Object.defineProperties(t.prototype,{average:{configurable:!0,enumerable:!0,get:function(){return this.total/this.iFd}}});Object(xc.a)(t,"StopwatchAverage",null,[]);var Of;(function(ya){ya[ya.longFrame=0]="longFrame";ya[ya.longGetRange=1]="longGetRange";ya[ya.longJsTask=2]="longJsTask";ya[ya.viewportCalculationLoops=3]="viewportCalculationLoops"})(Of||(Of={}));Object(xc.b)("UtrKpiVeto",Of);w.p1a=function(ya){return Enum.toString(Of,
ya)};w.uRa="UTR";Object(xc.a)(w,"KpiConstants",null,[]);v.y4f="UTRVetoName";v.q4f="UTRErrorName";v.zAj="UTROperationName";v.TRd="UTRDuration";v.AAj="UTREndedInPhase";v.v4f="UTRMessage";v.x4f="UtrUnavailabilityType";v.operationName="OperationName";v.duration="Duration";v.message="Message";Object(xc.a)(v,"UtrAdditionalData",null,[]);h.HBj="VetoLike";h.p6g="E2EOperationPerf";h.AYi="RequestPerf";h.iuj="UnavailabilityDurations";Object(xc.a)(h,"UtrTypes",null,[]);r.prototype.zEb=function(ya,oa,yb){yb=void 0===
yb?null:yb;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(yb=yb?Object.assign(new ng.a,{extendedProperties:yb}):null,ya=w.p1a(ya),Pf.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+ya,oa,!1,!0,"",yb))};r.prototype.bGb=function(ya,oa,yb,Dd,ie,xe){xe[w.uRa]=h.HBj;xe[v.y4f]=w.p1a(Dd);xe[v.q4f]=ie;hd.ULS.sendTraceTag(ya,oa,yb,Vg.a.Hc(xe));delete xe[w.uRa];delete xe[v.y4f];delete xe[v.q4f]};Object(xc.a)(r,"UtrKpiVetoReporter",null,[]);n.prototype.mYi=function(ya){var oa=
null;oa=void 0===oa?null:oa;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Pf.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+w.p1a(ya),0,"",oa)};n.prototype.zEb=function(ya,oa,yb){yb=void 0===yb?null:yb;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ya=w.p1a(ya),Pf.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+ya,oa,!1,!0,this.FYc(yb)))};n.prototype.MXi=function(ya,oa){oa=void 0===oa?null:oa;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
Pf.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+w.p1a(ya),"",this.FYc(oa))};n.prototype.LXi=function(ya,oa,yb){yb=void 0===yb?null:yb;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ya=w.p1a(ya),Pf.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+ya,oa,!1,!0,"",this.FYc(yb)))};n.prototype.FYc=function(ya){return ya?Object.assign(new ng.a,{extendedProperties:ya}):null};Object(xc.a)(n,"UtrKpiVetoUsageReporter",null,[]);l.prototype.Inc=function(ya,oa,
yb){yb=void 0===yb?null:yb;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Pf.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+ya,"",Object.assign(new ng.a,{extendedProperties:yb,durationMs:oa}))};l.prototype.Pnc=function(ya,oa,yb){yb=void 0===yb?null:yb;Pe.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(oa?Pf.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+ya,"",Object.assign(new ng.a,{extendedProperties:yb})):Pf.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+
ya,"",!1,!1,"",Object.assign(new ng.a,{extendedProperties:yb})))};l.prototype.ZFb=function(ya,oa,yb,Dd,ie,xe,Lf,ph){for(var Sf=[],Zg=7;Zg<arguments.length;++Zg)Sf[Zg-7]=arguments[Zg];Sf=String.format.apply(null,[Lf].concat(Sf));Zg={};Zg[w.uRa]=h.p6g;Zg[v.zAj]=Dd;Zg[v.AAj]=ie;Zg[v.TRd]=xe;Zg[v.v4f]=Sf;hd.ULS.sendTraceTag(ya,oa,yb,Vg.a.Hc(Zg))};l.prototype.aGb=function(ya,oa,yb,Dd,ie,xe){this.PPf(xe,Dd,ie);hd.ULS.sendTraceTag(ya,oa,yb,Vg.a.Hc(xe));this.g1g(xe)};l.prototype.$Fb=function(ya,oa,yb,Dd,
ie,xe,Lf){for(var ph=[],Sf=6;Sf<arguments.length;++Sf)ph[Sf-6]=arguments[Sf];ph=String.format.apply(null,[xe].concat(ph));Sf={};this.PPf(Sf,Dd,ie,ph);hd.ULS.sendTraceTag(ya,oa,yb,Vg.a.Hc(Sf))};l.prototype.Kpc=function(ya,oa,yb,Dd){Dd[w.uRa]=h.AYi;hd.ULS.sendTraceTag(ya,oa,yb,Vg.a.Hc(Dd));delete Dd[w.uRa]};l.prototype.PPf=function(ya,oa,yb,Dd){Dd=void 0===Dd?null:Dd;ya[w.uRa]=h.iuj;ya[v.x4f]=oa;ya[v.TRd]=yb;Dd&&(ya[v.v4f]=Dd)};l.prototype.g1g=function(ya){delete ya[w.uRa];delete ya[v.x4f];delete ya[v.TRd]};
Object(xc.a)(l,"UtrOperationPerfReporter",null,[]);var kg=yf.a;Em(d,kg);d.prototype.mMd=function(ya,oa,yb){this.lIb(ya,oa,yb,fg.a.uyb(fg.a.Qa.Gb.getTime()))};d.prototype.lIb=function(ya,oa,yb,Dd,ie){ie=void 0===ie?null:ie;if(this.j6[yb])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.j6[yb]=this.Hwe(ya,oa,yb,Dd,ie)};d.prototype.C2c=function(ya){this.Qpb(ya,fg.a.uyb(fg.a.Qa.Gb.getTime()))};d.prototype.Qpb=function(ya,oa){var yb=this.j6[ya];yb&&(this.Sse(yb,oa),this.Wvj(yb),
delete this.j6[ya])};d.prototype.wEf=function(ya){delete this.j6[ya]};d.prototype.IVf=function(ya,oa){this.icb||this.zVf(ya,oa)};d.prototype.uVf=function(){this.IVf(d.Ubd,this.Kg.oe)};d.prototype.dDe=function(ya,oa){oa=void 0===oa?!1:oa;if(this.icb){if(this.dBa===d.Jvd||this.dBa===d.Ubd){var yb=se.a.instance;yb.userSessionId=this.userSessionId;if(this.dBa===d.Jvd){this.Ple||(this.yaa(ya.m,Object(Fc.a)(yb,yb.MOi,"recordContentFetchEnd")),this.Ple=!0);if(oa){this.Xvf||(this.yaa(ya.m,Object(Fc.a)(yb,
yb.XOi,"recordPerceivedContentDisplayed")),this.Xvf=!0);return}this.yaa(ya.m,Object(Fc.a)(yb,yb.LOi,"recordContentDisplayed"))}else this.dBa===d.Ubd&&(oa=this.j6[this.wKb])&&this.yaa(Re.a(ya,oa.s),Object(Fc.a)(yb,yb.UOi,"recordInteractivityContentDisplayed"),!1)}this.Qpb(this.wKb,ya);this.wKb=this.dBa=this.icb=null}};d.prototype.yaa=function(ya,oa,yb){yb=void 0===yb?!0:yb;se.a.BS&&Object(X.a)(Td.PerformanceClock,fg.a.Qa)&&yb&&(ya+=window.performance.timing.navigationStart);oa(ya)};d.prototype.$h=
function(ya){return Hc.a(ya)};d.prototype.Je=function(ya,oa,yb){yb=void 0===yb?!1:yb;try{this.fdf[Gc[ya]]=!0,yb&&hd.ULS.sendTraceTag(3704927,0,50,z(ya,oa))}catch(Dd){hd.ULS.sendTraceTag(3704928,0,10,"Error when serializing usage table: {0} exception: {1}",ya,Dd)}};d.prototype.A2c=function(ya,oa,yb){if(this.skc){var Dd=this.nUa[ya+oa];Dd&&(Dd.e=yb,this.O5c(Dd));delete this.nUa[ya+oa]}};d.prototype.qnd=function(ya,oa){Gc[ya]in this.fdf||this.Je(ya,oa)};d.prototype.wFi=function(){this.Kg.appStart&&this.zVf(d.Jvd,
this.Kg.appStart)};d.prototype.iei=function(ya){var oa={};oa.a=ya.i;oa.b=ya.o;oa.c=ya.t;oa.d=Re.a(ya.s,ya.p||this.Kg.appStart);oa.e=Re.a(ya.e,ya.s);oa.f=ya.c;oa.g=ya.a;oa.h=ya.h;this.Je(0,oa,this.i4h(oa.b,oa.c))};d.prototype.i4h=function(ya,oa){return Array.contains(["CommandTask","QueuedTask","Task"],ya)&&!Array.contains(this.Tih,oa)?!1:!0};d.prototype.iB=function(ya,oa,yb,Dd,ie){if(ya&&oa){var xe={};xe.a=ya;xe.b=oa;xe.c=yb.toString();xe.d=Dd.toString();this.Je(15,xe,void 0===ie?!0:ie)}};d.prototype.Tcf=
function(ya,oa,yb,Dd){var ie={};ya&&(ie.c=Re.a(ya,this.Kg.appStart));ie.b=oa;ie.a=yb;ie.d=Dd;this.Je(17,ie)};d.prototype.dispose=function(){var ya=this;this.hOa.execute(function(oa){oa.deactivate(!0);oa.WTi(Object(Fc.a)(ya,ya.orf,"onResourceTimingEntriesAvailable"))});this.nf&&this.nf.V8a(Object(Fc.a)(this,this.QU,"onDocumentHidden"));kg.prototype.dispose.call(this)};d.prototype.ZVe=function(){return this.q5f=this.q5f||new x};d.prototype.Hwe=function(ya,oa,yb,Dd,ie){var xe={};xe.o=ya;xe.t=oa;xe.p=
void 0===ie?null:ie;xe.s=(void 0===Dd?null:Dd)||this.Kg.oe;this.qfd(xe,void 0===yb?null:yb);return xe};d.prototype.Sse=function(ya,oa){ya&&(ya.e=(void 0===oa?null:oa)||this.Kg.oe,ya.i=ya.i||this.DYa.u5a(),ya.c=ya.c||this.kxe,ya.a=ya.a||this.rxe,ya.h=void 0!==ya.h&&null!==ya.h?ya.h:this.nf?this.nf.aj:!1,this.O5c(ya))};d.prototype.adf=function(ya){var oa=ya.context;ya.duration>d.c6g&&(oa.methodName===Se.a.d1a||oa.methodName===Se.a.Dta)&&this.Mnc(1,d.bGh);if("GetSessionStatus"!==oa.methodName){var yb=
{};yb.a=oa.methodName;yb.b=oa.stopwatch.id;yb.c=ya.Ync;yb.d=ya.responseSize;yb.e=oa.wZb;yb.f=ya.hd?ya.hd.StateId:Se.a.RPd;this.Je(30,yb,!0);this.iB(yb.b,ya.hd.ServerCorrelationId,"clientWebRequests","ServerActions")}};d.prototype.jWf=function(){if(this.skc){var ya=this.nUa.LoadingUIShownSplashScreen;ya&&og.PageLoadTrackingInfo.instance.N8i(ya.s)}};d.prototype.Mnc=function(ya,oa){this.s4f.zEb(ya,oa,null)};d.prototype.cHf=function(ya,oa){this.Mwc.MXi(ya,void 0===oa?null:oa)};d.prototype.bHf=function(ya,
oa,yb){this.Mwc.LXi(ya,oa,void 0===yb?null:yb)};d.prototype.dHf=function(ya){this.Mwc.mYi(ya)};d.prototype.eHf=function(ya,oa){this.Mwc.zEb(ya,oa,null)};d.prototype.Inc=function(ya,oa,yb){this.ncb.Inc(ya,oa,void 0===yb?null:yb)};d.prototype.Pnc=function(ya,oa,yb){this.ncb.Pnc(ya,oa,void 0===yb?null:yb)};d.prototype.sendDNMTraceTag=function(ya,oa,yb,Dd,ie){for(var xe=[],Lf=4;Lf<arguments.length;++Lf)xe[Lf-4]=arguments[Lf];Pe.EwaSettings.ka(220)&&hd.ULS.sendTraceTag.apply(null,[ya,oa,yb,Dd].concat(xe))};
d.prototype.ZFb=function(ya,oa,yb,Dd,ie,xe,Lf,ph){for(var Sf=[],Zg=7;Zg<arguments.length;++Zg)Sf[Zg-7]=arguments[Zg];var Bh;(Bh=this.ncb).ZFb.apply(Bh,[ya,oa,yb,Dd,ie,xe,Lf].concat(Sf))};d.prototype.aGb=function(ya,oa,yb,Dd,ie,xe){this.ncb.aGb(ya,oa,yb,Dd,ie,xe)};d.prototype.$Fb=function(ya,oa,yb,Dd,ie,xe,Lf){for(var ph=[],Sf=6;Sf<arguments.length;++Sf)ph[Sf-6]=arguments[Sf];var Zg;(Zg=this.ncb).$Fb.apply(Zg,[ya,oa,yb,Dd,ie,xe].concat(ph))};d.prototype.bGb=function(ya,oa,yb,Dd,ie,xe){this.s4f.bGb(ya,
oa,yb,Dd,ie,xe)};d.prototype.Kpc=function(ya,oa,yb,Dd){this.ncb.Kpc(ya,oa,yb,Dd)};d.prototype.O5c=function(ya){this.kmj.iei(ya)};d.prototype.xFi=function(){if(this.skc){Stw.swpc=null;var ya=this.skc,oa;for(oa in ya)this.qfd(ya[oa])}};d.prototype.Ylh=function(){var ya=this,oa=window[Ld.a.namespace];if(oa){var yb=oa[Ld.a.Xre];yb&&(delete oa[Ld.a.Xre],yb.forEach(function(Dd){ya.qfd(Dd);ya.O5c(Dd)}))}};d.prototype.orf=function(ya,oa){for(ya=0;ya<oa.entries.length;ya++){var yb=oa.entries[ya];yb.url=ee.a.removeParameter(yb.url,
Rc.AFrameworkApplication.jO);var Dd=ee.a.Lxa(yb.url);this.s5h(yb.url,Dd)&&(yb.behavior=1);if("img"===yb.Jt.initiatorType&&Dd.endsWith(Xa.a.GBe)){var ie=ee.a.dia(yb.url,Xa.a.FBe),xe=ee.a.dia(yb.url,Xa.a.T1c);yb.s9=yb.s9+"imageID="+ie+", imgStateID="+xe}ie=yb.Jt[je.a.transferSize];xe=null;void 0!==ie&&null!==ie&&(xe=!ie);og.PageLoadTrackingInfo.instance.Wpg(Dd,Math.round(yb.Jt.fetchStart),Math.round(yb.Jt.responseEnd),xe,this.G6h);hf.a.contains(Dd,je.a.richTextEditor,!0)&&(Dd=pg.TextEditorTelemetry.instance,
Dd.gD(je.a.OZi,Math.round(yb.Jt.fetchStart)),Dd.gD(je.a.QZi,Math.round(yb.Jt.responseEnd)))}};d.prototype.s5h=function(ya,oa){if("about:blank"===ya||"renamehandler.ashx"===oa&&"2"===ee.a.Vz(ya,"u"))return!0;for(ya=0;ya<this.DDd.length;ya++)if(oa.endsWith(this.DDd[ya]))return!0;return!1};d.prototype.Zbi=function(){var ya=this;this.hOa.execute(function(oa){oa.Qh(d.sAg,0);oa.dsg(Object(Fc.a)(ya,ya.orf,"onResourceTimingEntriesAvailable"));oa.activate()})};d.prototype.Tbi=function(){var ya={};ya.a=new Date(le.EcmaDateClock.instance.appStart.m);
ya.b=this.userSessionId;ya.c=this.Kg.dZf;ya.d=d.W_g*dc.devicePixelRatio;ya.e=fg.a.Qa.appStart.m;this.Je(14,ya,!0);this.yaa(fg.a.Qa.appStart.m,Object(Fc.a)(se.a.instance,se.a.instance.EOi,"recordAppInitStart"))};d.prototype.zVf=function(ya,oa){this.icb=this.DYa.u5a();this.wKb=this.DYa.u5a();this.dBa=ya;this.lIb("UserAction",ya,this.wKb,oa);this.ecf(ya,this.icb)};d.prototype.poj=function(){var ya=this,oa=window[Ld.a.namespace];oa&&!d.fve&&(oa[Ld.a.llj]=function(yb,Dd){return ya.Hwe(yb,Dd)},oa[Ld.a.t8g]=
function(yb){ya.Sse(yb)},d.fve=!0)};d.prototype.Wvj=function(ya){var oa=t.VDg(ya.o,ya.t),yb=new t(Re.a(ya.e,ya.s)),Dd=oa in this.BMd?this.BMd[oa].eNg(yb):yb;this.BMd[oa]=Dd;if(yb===Dd||yb.average!==Dd.average)ya=Object.assign(new B,{operation:ya.o,target:ya.t,Cki:Dd.average,sender:this}),this.raiseEvent(oa,ya)};d.prototype.ecf=function(ya,oa){var yb={};yb.a=oa;yb.b=this.userSessionId;yb.c=ya;this.Je(1,yb,!0)};d.prototype.HVh=function(){this.DDd=["RemoteUls.ashx","GetSessionStatus",Se.a.Dta,"Collector/3.0/",
"CheckCollabServiceContentUpdate","UpdatePresenceUsers","GetNumberFormatCategory","GetObjectMetadata","SetCell","GetSheetProcessedData","UploadLatencyTelemetry","PollSessionStatus","GetStatusBarAggregates","GetRichValueFieldListContextList","GetInstantaneousSupportInformation"]};d.prototype.QU=function(){var ya=this.j6,oa;for(oa in ya)ya[oa].h=!0};d.prototype.qfd=function(ya,oa){ya.i=(void 0===oa?null:oa)||this.DYa.u5a();ya.a=this.rxe;ya.c=this.kxe;ya.h=this.nf?this.nf.aj:!1};d.ja=function(ya){var oa=
new W;ya.ea.Ia(291,oa);oa=new d(ya.ya.UserSessionId,void 0,void 0,void 0,oa,!0);oa.ecf(d.Ehf,oa.bye);hd.ULS.sendTraceTag(19481687,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");oa.Zbi();oa.poj();oa.wFi();oa.Tbi();oa.Ylh();oa.xFi();oa.HVh();d.J6i(ya);cf.a.Ji.Ia(41,oa)};d.J6i=function(ya){var oa=dc.devicePixelRatio;1<oa&&ya.ic.Tv(!0,2<=oa?8388608:4194304)};Ll.Object.defineProperties(d.prototype,{j6:{configurable:!0,enumerable:!0,get:function(){return this.L$d||(this.L$d={})}},
kxe:{configurable:!0,enumerable:!0,get:function(){return this.icb||this.bye}},rxe:{configurable:!0,enumerable:!0,get:function(){return this.dBa||d.Ehf}},BMd:{configurable:!0,enumerable:!0,get:function(){return this.ele=this.ele||{}}},skc:{configurable:!0,enumerable:!0,get:function(){return this.nUa||"undefined"===typeof Stw?this.nUa:this.nUa=Stw.swpc}},fdf:{configurable:!0,enumerable:!0,get:function(){return this.M3d=this.M3d||{}}},hOa:{configurable:!0,enumerable:!0,get:function(){return this.hib||
(this.hib=we.a.instance.oc("Common.NetworkTiming.IResourceTimingLogger"))}},s4f:{configurable:!0,enumerable:!0,get:function(){return this.t4f||(this.t4f=new r)}},ncb:{configurable:!0,enumerable:!0,get:function(){return this.w4f||(this.w4f=new l)}},Mwc:{configurable:!0,enumerable:!0,get:function(){return this.u4f||(this.u4f=new n)}}});d.Ehf="UnassignedUserAction";d.Jvd="PageLoad";d.Ubd="GridUpdateOperation";d.c6g=5E3;d.bGh="MoreThan_5000_Ms";d.W_g=96;d.sAg=30;d.fve=!1;Object(xc.a)(d,"TelemetryManager",
yf.a,[211,212,213,214]);var Rf=b(185),Ig=b(102);Object(xc.a)(e,"Validation",null,[]);a.prototype.HOc=function(ya,oa,yb,Dd,ie){if(ya&&Dd){var xe=Rf.a.ey(oa,yb);this.JUb(function(){return!!Ig.a(ya).kp(xe)},Dd.StateId,ie)}};a.prototype.JUb=function(ya,oa,yb){this.Rqg(this.yLe,ya,oa,yb)};a.prototype.h6a=function(){this.bwf(this.yLe)};a.prototype.Sg=function(){this.bwf(this.KBg)};a.prototype.Rqg=function(ya,oa,yb,Dd){ya&&oa&&yb!==Se.a.Oe&&ya.add(new e(oa,yb,Dd))};a.prototype.bwf=function(ya){if(ya){for(var oa=
new bc.a,yb=Ol(ya),Dd=yb.next();!Dd.done;Dd=yb.next()){Dd=Dd.value;if(Dd.BT===this.$.fa.vf)try{Dd.jBj()||hd.ULS.sendTraceTag(537151010,0,15,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [{0}]",Dd.name)}catch(ie){hd.ULS.sendTraceTag(537151009,0,10,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [{0}]. Exception: [{1}]",Dd.name,ie)}oa.add(Dd)}oa=Ol(oa);for(Dd=oa.next();!Dd.done;Dd=
oa.next())ya.remove(Dd.value)}else hd.ULS.shipAssertTag(537151011,0,!!ya,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")};a.prototype.dispose=function(){ge.g(this.$)&&ge.g(this.$).Ca&&(ge.g(this.$).Ca.Jq(Object(Fc.a)(this,this.Sg,"onBlockCacheConsistent")),ge.g(this.$).Ca.XBd(Object(Fc.a)(this,this.h6a,"onAllFloatingObjectsRendered")));this.$=null};a.ja=function(ya){var oa=new a(ya);ya.ea.Ia(277,oa)};Object(xc.a)(a,"ValidationTelemetryManager",null,[210,6]);Type.registerNamespace("_Ewa");
Type.registerNamespace("Common.App.BrowserInfoLogger");ce.main();Type.registerNamespace("CNT");Vc.main();Type.registerNamespace("CACPU");Nc.main();Type.registerNamespace("Common.App.EventsCacheManager");Lc.main();(function(){Nb.a.Ga(function(ya){ya.ea.Ia(137,new Ab(ya))})})();(function(){Nb.a.Ga(function(ya){ya.ea.Ia(37,new sb(ya))})})();(function(){Nb.a.Ga(function(ya){Sa.ja(ya)})})();(function(){Nb.a.Ga(function(ya){Ia.ja(ya)})})();(function(){Nb.a.Ga(function(ya){lc.ja(ya)})})();(function(){Nb.a.Ga(function(ya){ya.ea.Ia(40,
new Ra(ya,new id.a(function(){return wc.GetServiceTaskFactory.create(ya.ea,137,ya.la,1,"Postmessage.IHostPostmessenger")})))})})();(function(){Nb.a.Ga(function(ya){ya.ea.Ia(276,new La(ya))})})();(function(){Nb.a.Ga(function(ya){cf.a.Ji.$a(135,function(){d.ja(ya);G.ja(ya);a.ja(ya);J.ja(ya);Pe.EwaSettings.ka(419)&&N(ya);Z.ja(ya);V.ja(ya);Pe.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RenderingFidelityMetric",!1)&&oh.RenderingFidelityTracker.ja(ya)})})})()}}]);

//# sourceMappingURL=EwaDS.tm.js.map