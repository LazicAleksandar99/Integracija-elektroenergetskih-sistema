(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1030:function(C,F,b){function a(v,w){var t=h.call(this,w.textBox.domElement)||this;t.TRc=null;t.ub=v;t.kF=w;w.sO&&(w.sO.add(t),w.Jm(Object(d.a)(t,t.Rj,"onEditStarted")),w.Xr(Object(d.a)(t,t.pj,"onEditEnded")));return t}b.d(F,"a",function(){return a});C=b(0);var e=b(86),d=b(37);F=b(82);var l=b(43),n=b(42),r=b(68),h=F.a;Em(a,h);a.prototype.dispose=function(){var v=this.kF;v&&v.sO&&(v.sO.remove(this),v.ym(Object(d.a)(this,this.Rj,
"onEditStarted")),v.Fr(Object(d.a)(this,this.pj,"onEditEnded")));e.a.Fa(this.TRc);this.kF=null;h.prototype.dispose.call(this)};a.prototype.Vh=function(v,w){switch(w){case -1470715894:case -1231471547:this.US(!1);break;default:if(this.Fyd(v,w))return r.g(v),!0;a.V3h(w)||this.US(!1)}return!1};a.prototype.US=function(){e.a.Fa(this.TRc);this.TRc=l.a.instance.create(Object(d.a)(this,this.zsd,"onAutoCompleteTimerTick"),10,n.a.Cai)};a.prototype.Rj=function(){this.US(!1)};a.V3h=function(v){switch(v){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};
Ll.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ub}},pb:{configurable:!0,enumerable:!0,get:function(){return this.kF}}});Object(C.a)(a,"ListAutoCompleteBehavior",F.a,[743,6])},1173:function(C,F,b){function a(B){var z=t.call(this,document.createElement("div"))||this;z.qGa=!1;z.rGa=!1;z.pGa=!1;z.nGa=!1;z.oGa=!1;z.aQ=!1;z.kF=null;z.$=B;v.g(B)&&v.g(B).ga&&v.g(z.$).ga.CF(Object(e.a)(z,z.mh,"onActiveCellChanged"));z.P$=l.a.ZL(B)&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");
return z}b.d(F,"a",function(){return a});C=b(0);var e=b(37);F=b(230);var d=b(4),l=b(44),n=b(1),r=b(9),h=b(7),v=b(20),w=b(34),t=F.a;Em(a,t);a.prototype.fq=function(){this.Jza(!1);this.Ws.fq()};a.prototype.dispose=function(){this.$&&v.g(this.$)&&v.g(this.$).ga&&v.g(this.$).ga.SM(Object(e.a)(this,this.mh,"onActiveCellChanged"));t.prototype.dispose.call(this)};a.prototype.Vh=function(B,z,x){x=void 0===x?!1:x;B=!1;if((!h.a.ma(this.wob)||x)&&!this.pKa()&&this.get_visible()&&this.isListVisible)switch(this.P$&&
this.Gvc(z),z){case 1872288872:this.isListVisible=!1;B=!0;break;case -798660877:this.Ws.jA(1);B=!0;break;case 137938150:this.Ws.jA(-1);B=!0;break;case 2091832999:this.Ws.jA(this.$G-1);B=!0;break;case 742457698:this.Ws.jA(-(this.$G-1));B=!0;break;case 125627505:B=this.Rx(!1);break;case 267796030:n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(B=this.Rx(!1))}return B};a.prototype.Jza=function(B){if(this.isListVisible||B){var z=v.g(this.$);B=z.domElement;
var x=this.kF.textBox.domElement,y=w.a(this.$).ri(x.offsetHeight),J=w.a(this.$).ri(x.offsetTop),E=w.a(this.$).ri(x.offsetWidth);x=w.a(this.$).ri(x.offsetLeft);z=z.nj;var A=$get(this.$.Jb+d.a.$Xa,this.$.domElement),H=new Sys.UI.Point(z?this.Ws.d6b:0,z?this.zph:a.NMh);y=A.offsetTop+H.y+(l.a.dM(this.$)&&z?0:y+J);this.$.P3||(J=$get(d.a.Wkb,this.$.domElement),y+=J?J.offsetHeight:0);J=this.domElement;J.style.top=r.HelperMethods.Pb(y);x=A.offsetLeft+x+H.x;!l.a.dM(this.$)&&this.$.isChromeRtl?J.style.right=
r.HelperMethods.Pb(z?this.Ws.d6b:B.offsetLeft+B.offsetWidth-x-E):J.style.left=r.HelperMethods.Pb(x)}};a.prototype.mQa=function(B){this.Ws&&(B&&!this.aQ?(this.Ws.n8(Object(e.a)(this,this.Xjf,"onAutoCompleteListBoxGotFocus")),this.Ws.hVb(Object(e.a)(this,this.qJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.Ws.Bkb(Object(e.a)(this,this.Mwa,"onSetCell")),this.aQ=!0):this.aQ&&(this.Ws.Kba(Object(e.a)(this,this.Xjf,"onAutoCompleteListBoxGotFocus")),this.Ws.dnc(Object(e.a)(this,this.qJa,"ignoreOnBlurOnAutoCompleteEditBox")),
this.Ws.pEb(Object(e.a)(this,this.Mwa,"onSetCell")),this.aQ=!1))};a.prototype.Gvc=function(B){switch(B){case -798660877:case 137938150:case 2091832999:case 742457698:this.qGa=!0;break;case 125627505:this.pGa=!0;break;case 267796030:n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.nGa=!0)}};a.prototype.qJa=function(){this.pb.textBox.pJ=!0};a.prototype.Mwa=function(){this.Rx(!0)};a.prototype.Xjf=function(){this.pb.textBox.focus()};a.prototype.mh=
function(){v.g(this.$).inRangePicker||(this.isListVisible=!1)};Ll.Object.defineProperties(a.prototype,{$G:{configurable:!0,enumerable:!0,get:function(){return this.Ws.$G}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Ws.isListVisible},set:function(B){this.Ws.isListVisible=B}},pb:{configurable:!0,enumerable:!0,get:function(){return this.kF},set:function(B){(this.kF=B)&&!this.kF.dAa.contains(this)&&this.kF.dAa.add(this)}},zph:{configurable:!0,enumerable:!0,get:function(){return l.a.dM(this.$)?
-5:-40}}});a.d6b=0;a.NMh=1;Object(C.a)(a,"AutoCompleteControl",F.a,[689])},1174:function(C,F,b){function a(J,E){J=y.call(this,J,E,new x.a(n.a.listItem,n.a.Oxb,n.a.Rxb,n.a.Sxb))||this;J.m9b=!1;J.nr=null;J.wib=null;J.tMe=!1;J.bza(!0);J.tMe=t.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");return J}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(23),l=b(37);F=b(962);var n=b(913),r=b(4),h=b(79),v=b(44),w=b(11),t=b(1),B=b(118),z=b(20),x=b(1029),y=F.a;Em(a,y);a.prototype.bwa=
function(){var J=460,E=z.g(this.$),A=E.domElement,H=this.MQa.style,S=this.Zf.offsetTop+this.Dk.offsetHeight*this.Dk.sectionRowIndex-this.Zf.scrollTop;H.width="auto";H.whiteSpace="nowrap";H.position=d.a.bcc?"relative":"absolute";var Q=A.offsetLeft+A.offsetWidth-(this.domElement.offsetLeft+this.Zf.offsetLeft+this.Zf.offsetWidth+3);A=this.domElement.offsetLeft-3-(A.offsetLeft+this.d6b);J=Math.min(this.MQa.offsetWidth,J,Math.max(Q,A));w.DOMElementExtensions.nq(this.MQa,J);H.whiteSpace="";H.position="absolute";
S+3>this.Zf.offsetTop+this.Zf.offsetHeight||S<this.Zf.offsetTop||(J=this.Zf.offsetLeft-3-this.MQa.offsetWidth,H=this.Zf.offsetLeft+this.Zf.offsetWidth+3,w.DOMElementExtensions.updatePosition(this.MQa,A>Q!==E.rtl?J:H,S,!1))};a.prototype.jA=function(J){y.prototype.jA.call(this,J);this.bwa()};a.prototype.fq=function(){this.bwa()};a.prototype.Ypa=function(){var J=this.sn,E=this.Zf,A=3===h.a.Tb||d.a.tr,H=A?this.zyb:this.$G;this.isListVisible=!0;E.style.height="auto";this.rqa.set_visible(!0);this.ckb(J,
A);this.nr.length>H?(w.DOMElementExtensions.eF(E,Math.floor(E.offsetHeight*H/this.nr.length)),E.style.overflowY="auto"):(E.style.height="auto",E.style.overflowY="hidden");w.DOMElementExtensions.nq(E,J.offsetWidth+(this.nr.length>H?B.a.yp:0))};Ll.Object.defineProperties(a.prototype,{d6b:{configurable:!0,enumerable:!0,get:function(){if(v.a.dM(this.$)){var J=document.getElementById(this.$.Jb+r.a.sMe);return!this.tMe||J?w.DOMElementExtensions.getBoundingClientRect(J).x:0}J=t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",
!1)?document.getElementById(r.a.xqd):document.getElementById(this.$.Jb+r.a.xqd+"-"+r.a.Vgf);e.ULS.shipAssertTag(537170323,0,!!J||this.$.V3,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return J?J.offsetWidth:0}},je:{configurable:!0,enumerable:!0,get:function(){return this.wib},set:function(J){this.wib=J}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return w.DOMElementExtensions.isVisible(this.Zf)&&0<this.nr.length},set:function(J){w.DOMElementExtensions.setVisible(this.Zf,
J);w.DOMElementExtensions.setVisible(this.MQa,J);var E=z.g(this.$).view;J?this.m9b||(E.Us(Object(l.a)(this.rqa,this.rqa.fq,"onGridScroll")),this.m9b=!0):(Array.clear(this.nr),this.m9b&&(E.Gr(Object(l.a)(this.rqa,this.rqa.fq,"onGridScroll")),this.m9b=!1))}}});Object(C.a)(a,"AutoCompleteListBox",F.a,[])},1175:function(C,F,b){function a(d,l,n,r){l=void 0===l?0:l;n=void 0===n?"":n;r=void 0===r?"":r;var h=e.call(this)||this;h.length=d;h.selectedIndex=l;h.xH=n;h.description=r;return h}b.d(F,"a",function(){return a});
C=b(0);var e=Sys.EventArgs;Em(a,e);Object(C.a)(a,"ListEventArgs",Sys.EventArgs,[])},1227:function(C,F,b){function a(xa,Pa){var ib=ma.call(this,xa)||this;ib.$Aa=null;ib.QUc=[];ib.ZXd=null;ib.iua=!1;ib.v$b=!1;ib.Dp=null;ib.v3d=null;ib.gf=xa;ib.tableManager=Pa;ib.domElement.className=B.a.sEe;ib.domElement.innerHTML="<div id='suggested_cells_list_box' class='ewa-lb ewa-scrollbars' ></div>";W.DOMElementExtensions.setVisible(ib.domElement,!1);na.d(ib.style,ib.gf.isChromeRtl);ib.Toe=$get(n.bnj,ib.domElement);
ib.DX=new e(ib.gf,ib.Toe);ib.mQa(!0);ib.gf.domElement.appendChild(ib.domElement);ib.wlb(xa,Z.a(xa));ib.wlb(xa,L.g(xa).Gc);ib.gf.ea.Ia(1,ib);return ib}function e(xa,Pa){xa=V.call(this,xa,Pa)||this;xa.cellAutoCompleteControl=null;xa.qpa=null;xa.nr=[];return xa}function d(xa,Pa){var ib=aa.call(this,xa,Pa)||this;ib.qWd=null;ib.Old=0;ib.S4a=null;ib.D_=null;ib.RJa=!1;ib.jBb=function(){ib.RJa&&(ib.cellAutoCompleteControl.iua=!1)};ib.pb.bVb(Object(v.a)(ib,ib.Vzb,"onCommitEdit"));ib.RJa=S.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");
ib.RJa&&(ib.D_=ib.Hd.yd(ib.pb.textBox.domElement),ib.D_.ja("mousedown",ib.jBb));return ib}function l(xa,Pa){this.c$f=xa;this.b$f=Pa}function n(){}b.r(F);C=b(0);var r=b(15),h=b(86),v=b(37),w=b(1173),t=b(10),B=b(913);n.bnj="suggested_cells_list_box";Object(C.a)(n,"CssElementIds",null,[]);var z=b(4),x=b(1175);Ll.Object.defineProperties(l.prototype,{sqa:{configurable:!0,enumerable:!0,get:function(){return this.c$f}},SRc:{configurable:!0,enumerable:!0,get:function(){return this.b$f}}});Object(C.a)(l,"CellAutoCompleteItem",
null,[730]);var y=b(5),J=b(83),E=b(1030),A=b(378),H=b(46),S=b(1),Q=b(7),L=b(20),aa=E.a;Em(d,aa);d.prototype.dispose=function(){this.pb.aCd(Object(v.a)(this,this.Vzb,"onCommitEdit"));aa.prototype.dispose.call(this)};d.prototype.US=function(xa){xa&&!this.cellAutoCompleteControl.isListVisible||aa.prototype.US.call(this,xa)};d.prototype.Vh=function(xa,Pa){this.cellAutoCompleteControl.pb=this.pb;this.Old=xa.keyCode;if(this.pb.isEditing){var ib=this.pb.text;Q.a.equals(this.S4a,ib,!1)||(this.S4a=ib)}else this.S4a=
null;if(237279923===Pa)return this.cellAutoCompleteControl.isListVisible=!1;S.EwaSettings.ka(136)&&17===this.Old&&this.cellAutoCompleteControl.iua&&(this.cellAutoCompleteControl.v$b=!0);return aa.prototype.Vh.call(this,xa,Pa)};d.prototype.Vzb=function(xa,Pa){if(xa=this.cellAutoCompleteControl.items)if(1===xa.length&&this.cellAutoCompleteControl.wob.length<xa[0].sqa.length&&this.cellAutoCompleteControl.iua&&Q.a.HH(xa[0].sqa,this.cellAutoCompleteControl.wob)&&(Pa.newValue=xa[0].sqa),this.pb&&S.EwaSettings.ka(136)){var ib=
-1;1<xa.length?ib=this.cellAutoCompleteControl.J8b(this.pb.text,!0):1===xa.length&&(this.cellAutoCompleteControl.iua||this.cellAutoCompleteControl.v$b)&&(ib=0);if(0<=ib&&xa.length>ib&&xa[ib].SRc){var pb=H.C(xa[ib].SRc);pb&&L.g(this.$).$b.DKa(pb)&&(Pa.z3e=!0,Pa.Uoe=xa[ib].SRc)}}};d.prototype.zsd=function(){S.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")&&y.AFrameworkApplication.Fg||(this.cellAutoCompleteControl.pb=this.pb,this.cellAutoCompleteControl.iua=
!1,this.pb.isEditing?Q.a.equals(this.S4a,this.pb.text,!0)||this.cellAutoCompleteControl.$yg(this.Old):this.S4a=null)};d.prototype.Rj=function(){};d.prototype.pj=function(){this.rU=!1;this.cellAutoCompleteControl.set_visible(!1);this.S4a=null;this.cellAutoCompleteControl.iua=!1;this.cellAutoCompleteControl.v$b=!1;this.cellAutoCompleteControl.Z4a&&this.cellAutoCompleteControl.Z4a.cancel()};d.prototype.Fyd=function(xa,Pa){return this.cellAutoCompleteControl.Vh(xa,Pa)};Ll.Object.defineProperties(d.prototype,
{qvb:{configurable:!0,enumerable:!0,get:function(){return!1}},rU:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(xa){this.cellAutoCompleteControl.isListVisible=xa}},uub:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return A.a.RUc}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){var xa=b(1227).CellAutoCompleteControl;return this.qWd||(this.qWd=Object(J.a)(xa,
this.$.ea.Ba(1)))}}});Object(C.a)(d,"CellAutoCompleteListAutoCompleteBehavior",E.a,[]);var fa=b(30);E=b(1174);var W=b(11),G=b(9),N=b(118),Y=b(65),V=E.a;Em(e,V);e.prototype.dispose=function(){V.prototype.dispose.call(this);this.qpa=null};e.prototype.Ltc=function(xa){this.l6(!1);var Pa=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.vaa);for(var ib=0,pb=this.nr.length;ib<pb;ib++){var xb=fa.a.Xf(xa[this.nr[ib]].sqa);xb=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.fZ,e.SUc,z.a.Dhe,xb,fa.a.u3b(xb));Pa+=xb}this.Zf.innerHTML=Pa+"</tbody></table>";this.sn=W.DOMElementExtensions.lj(this.domElement,this.vaa);this.l6(!0);this.Ypa()};e.prototype.tHa=function(xa,Pa){if(xa&&xa.length){var ib=[];if(!Q.a.ma(Pa))for(var pb=0,xb=xa.length;pb<xb;pb++)Q.a.HH(xa[pb].sqa,Pa)&&Array.add(ib,pb);this.nr=ib;this.Ltc(xa)}else this.isListVisible=!1,this.qpa=null};e.prototype.bwa=function(){};e.prototype.AGg=function(xa,Pa,ib){var pb=Math.min(xa,Math.max(200,ib));Pa&&xa<ib&&(pb+=
N.a.yp);W.DOMElementExtensions.nq(this.Zf,pb);Pa&&(pb-=N.a.yp);return pb};e.prototype.Ypa=function(){V.prototype.Ypa.call(this);var xa=W.DOMElementExtensions.lj(this.get_element(),this.vaa),Pa=this.nr.length>this.$G,ib=L.g(this.$);if(ib=ib.tc(ib.ga.wa.activeCell))for(xa=this.AGg(xa.offsetWidth,Pa,ib.width),Pa=this.Zf.getElementsByClassName(e.SUc),ib=0;ib<Pa.length;ib++)Pa[ib].style.maxWidth=G.HelperMethods.Pb(xa);else r.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};
e.prototype.uAb=function(xa){if(xa=V.prototype.uAb.call(this,xa)){var Pa=L.g(this.$);Pa.lq(!1);Pa.focus()}return xa};Ll.Object.defineProperties(e.prototype,{Dk:{configurable:!0,enumerable:!0,get:function(){return this.qpa},set:function(xa){this.qza(this.Dk);this.qpa=xa;var Pa=this.qza(this.Dk);this.je=xa?Pa.innerText:null;this.cpc(xa)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Y.a)(e.prototype,this,"isListVisible")},set:function(xa){Object(Y.b)(e.prototype,this,"isListVisible",
xa);xa||(this.Dk=null)}},MQa:{configurable:!0,enumerable:!0,get:function(){return null}},rqa:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.ea.Ba(1))}}});e.SUc="ewa-suggested-cell-name";Object(C.a)(e,"CellAutoCompleteListBox",E.a,[]);var da=b(25),U=b(60),Z=b(119),ca=b(175),ra=b(42),La=b(32),na=b(247);b.d(F,"CellAutoCompleteControl",function(){return a});var ma=w.a;Em(a,ma);a.prototype.EPc=function(xa){this.addHandler("ACLBUpdated",
xa)};a.prototype.oCd=function(xa){this.removeHandler("ACLBUpdated",xa)};a.prototype.m1=function(xa){this.addHandler("ACLBSelectionChanged",xa)};a.prototype.Mba=function(xa){this.removeHandler("ACLBSelectionChanged",xa)};a.prototype.Qsg=function(xa){this.addHandler("ACLBMatchedItem",xa)};a.prototype.xUi=function(xa){this.removeHandler("ACLBMatchedItem",xa)};a.prototype.nWf=function(xa){for(var Pa=0;Pa<xa.length;Pa++){var ib=xa.charCodeAt(Pa);if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
Q.a.isLetter(ib):Q.a.kid(ib))return!0}return!1};a.prototype.pKa=function(){return!this.items};a.prototype.dispose=function(){if(this.gf){this.mQa(!1);var xa=L.g(this.gf);xa&&xa.view.Gr(Object(v.a)(this,this.fq,"onGridScroll"))}h.a.mc([this.DX,this.Z4a]);h.a.mc(this.QUc);this.QUc=this.Toe=this.DX=this.pb=this.gf=null;ma.prototype.dispose.call(this)};a.prototype.Vh=function(xa,Pa){var ib=!1,pb=S.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");if(!Q.a.ma(this.wob)&&
!this.pKa()&&this.get_visible()&&this.isListVisible||!pb&&267796030===Pa)switch(Pa){case -798660877:if(1===this.items.length&&this.je)break;this.Ws.jA(1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.J8b(this.je),this.je));ib=this.Rx(!1);break;case 137938150:if(1===this.items.length&&this.je)break;this.Ws.jA(-1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.J8b(this.je),this.je));ib=this.Rx(!1);break;case 2091832999:this.Ws.jA(this.$G-1);ib=this.Rx(!1);
break;case 742457698:this.Ws.jA(-(this.$G-1));ib=this.Rx(!1);break;case 125627505:this.pb.textBox.caretPosition=this.pb.text.length;this.isListVisible=!1;ib=!0;break;case 267796030:pb||1!==this.items.length?this.Rx(!0):this.Z$b(!0);break;default:ib=ma.prototype.Vh.call(this,xa,Pa)}return ib};a.prototype.show=function(){this.items&&this.items.length&&(this.DX.Dk=this.je?this.Ws.sn.rows[this.J8b(this.je)]:null,this.isListVisible=0<this.DX.nr.length,this.Jza(!0),this.DX.bwa())};a.prototype.$yg=function(xa){var Pa=
!!this.pb&&!U.f(this.gf.qa);this.v$b=this.iua=!1;this.pb&&!this.pb.isEditing?this.set_visible(!1):Pa&&!this.i_g(this.activeCell)&&this.Vgj(xa)};a.prototype.i_g=function(xa){return!!this.dataValidationControl&&this.dataValidationControl.A1c(xa)};a.prototype.Rx=function(xa){if(!this.pb||!this.isListVisible)return!1;var Pa=this.$Aa;if(this.je){var ib=W.DOMElementExtensions.oY(W.DOMElementExtensions.lj(this.DX.Dk,e.SUc),z.a.Dhe,""),pb=ib.substring(Pa.length,ib.length);xa?this.pb.text=ib:this.pb.insertTextAt(pb,
Pa.length,this.pb.text.length)}ib=L.g(this.gf);ib.nj&&(ib=ib.Gc,ib.text=this.pb.text,ib.setCaretPosition(this.pb.textBox.caretPosition));xa?this.isListVisible=!1:this.pb.textBox.selectRange(Pa.length,this.pb.text.length);return!0};a.prototype.J8b=function(xa,Pa){Pa=void 0===Pa?!1:Pa;if(!this.DX.sn)return-1;for(var ib=this.DX.sn.children[0],pb=ib.children.length,xb,Ya=0;Ya<pb;++Ya)if(xb=ib.children[Ya],Q.a.equals(xb.innerText.trim(),xa,Pa))return Ya;return-1};a.prototype.aog=function(xa,Pa,ib,pb,xb,
Ya,ab){var ea=ib.originalText.replace(a.Nhf,String.fromCharCode(32)),ta=new da.Range(xa.top-1,xa.left,xa.bottom-1,xa.right,!1,!1),Ka=ab?ab.zo(ib.range):null;(!ib.cM||ib.range.left===xa.left)&&1<ea.length&&!pb.qb(ea.toUpperCase())&&Q.a.HH(ea,Pa)&&!Q.a.equals(ea,Pa,!0)&&!a.fLe(Pa)&&this.nWf(ea)&&(!xb&&!Ka||!xb&&Ka.equals(ab.zo(ta))||xb&&ib.range.$d(Ya)&&ib.range.top!==Ya.top)&&(xa=ib.formulaBarText,Q.a.equals(xa,ib.text,!1)||Q.a.ma(xa))&&(xa={},xa.FirstRow=ib.range.top-1,xa.FirstColumn=ib.range.left-
1,ib=new l(ea,xa),pb.add(ea.toUpperCase(),ib))};a.prototype.Vgj=function(xa){this.Dp=this.YIh();this.Z4a&&this.Z4a.cancel();0<this.pb.text.length&&229!==xa&&xa?this.items&&((1<this.items.length||this.isListVisible)&&this.N5g(),8!==xa&&127!==xa&&46!==xa&&(1===this.items.length?this.Z$b(!1):this.DX.Dk&&this.Rx(!1))):this.isListVisible=!1};a.prototype.N5g=function(){this.isListVisible?this.wBe():this.v3d=ca.AsyncMethodContext.Hw(Object(v.a)(this,this.wBe,"dropDownListAutoCompleteUpdate"),500,ra.a.NIg,
this.Z4a)};a.prototype.Z$b=function(xa){r.ULS.shipAssertTag(537167966,0,!this.pKa()&&1===this.items.length,"Invalid Items");var Pa=this.items[0].sqa,ib=this.pb.text,pb=Pa.substring(ib.length,Pa.length);if(xa&&!pb.length)this.pb.text=Pa;else if(!xa&&0<pb.length)this.pb.appendText(pb),this.pb.textBox.selectRange(ib.length,this.pb.text.length);else return;this.raiseEvent("ACLBMatchedItem",new x.a(this.items.length,0,Pa));this.iua=!0};a.prototype.YIh=function(){this.Dp=null;var xa=new La.a(!1),Pa=this.activeCell;
this.$Aa=this.pb.text.replace(a.Nhf,String.fromCharCode(32));var ib=this.tableManager.zo(Pa),pb=Pa.$d(ib);if(a.fLe(this.$Aa)||!this.nWf(this.$Aa))return this.items;var xb=new da.Range(1,Pa.left,Pa.top-1,Pa.left,!1,!1),Ya=new da.Range(Pa.top+1,Pa.left,t.a.lh,Pa.left,!1,!1),ab=L.g(this.gf);Ya=ab.mm("CellAutoCompleteControl.GetSuggestedCells",Ya);try{var ea=ab.mm("CellAutoCompleteControl.GetSuggestedCells2",xb);try{for(var ta=Ol([ea,Ya]),Ka=ta.next();!Ka.done;Ka=ta.next())for(var mb=Ka.value;mb.$$mn();){var Ha=
mb.$$cu();this.aog(Pa,this.$Aa,Ha,xa,pb,ib,this.tableManager)}}finally{ea&&ea.dispose()}}finally{Ya&&Ya.dispose()}this.Dp=Array(xa.values.length);for(Pa=0;Pa<this.items.length;Pa++)this.items[Pa]=xa.values[Pa];this.items.sort(function(Ga,Fa){return Ga.sqa.localeCompare(Fa.sqa)});return this.items};a.prototype.wBe=function(){this.DX.tHa(this.items,this.$Aa);this.raiseEvent("ACLBUpdated",new x.a(this.items.length));this.show()};a.prototype.wlb=function(xa,Pa){xa&&Pa&&Array.add(this.QUc,new d(xa,Pa))};
a.fLe=function(xa){xa=0<xa.length?xa.charCodeAt(0):-1;return 35===xa||61===xa||43===xa||45===xa||64===xa};Ll.Object.defineProperties(a.prototype,{Ws:{configurable:!0,enumerable:!0,get:function(){return this.DX}},wob:{configurable:!0,enumerable:!0,get:function(){return this.$Aa}},je:{configurable:!0,enumerable:!0,get:function(){return this.DX.je}},items:{configurable:!0,enumerable:!0,get:function(){return this.Dp}},Z4a:{configurable:!0,enumerable:!0,get:function(){return this.v3d}},activeCell:{configurable:!0,
enumerable:!0,get:function(){return L.g(this.gf).ga.wa.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.ZXd||(this.ZXd=this.gf.ea.Ba(14))}}});Ll.Object.defineProperties(a,{Nhf:{configurable:!0,enumerable:!0,get:function(){return a.e5d||(a.e5d=new RegExp(String.fromCharCode(160),"g"))}}});a.e5d=null;Object(C.a)(a,"CellAutoCompleteControl",w.a,[688,689,690,6])},1240:function(C,F,b){function a(ab,ea,ta,Ka){ea=Ya.call(this,ab,"PopulateGridContextMenu",1247109494,
-2064931494,a.zMh,!0,!1,a.ZEb,ea,ta,!0,Ka)||this;ea.Oya=!1;ea.fua=!1;ea.hY=!1;ea.refresh=!1;ea.expandCollapse=!1;ea.vdc=!1;ea.Pve=!0;ea.grid=ib.g(ab);ea.bgc=!0;ea.Bhd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5558478_disableHideUnHideRowColumnForMobileWhenEntireGridSelected")&&ab.isMobileMode;return ea}function e(ab){this.ranges=null;this.ranges=ab}function d(ab,ea,ta,Ka,mb,Ha,Ga,Fa){this.$=ea;this.Sa=ta;this.Xl=Ka;this.selectedRanges=mb;this.grid=Ha;this.xA=Fa;this.J$=Ga;this.cqa=v.a.all(mb,
function(eb){return eb.isRow});this.bqa=v.a.all(mb,function(eb){return eb.Fh});this.lzb=v.a.all(mb,function(eb){return!eb.isRow&&!eb.Fh});ea=Ha.$b.Uad(mb);this.s0b=!!ea;this.HGf=!!ea&&ea.hasActiveFilter;this.menuSection=ta.Oc();Array.add(ab.Bc,this.menuSection);this.Oia=this.cqa||this.bqa?this.menuSection:ta.Oc();this.Mra=this.cqa||this.bqa?this.menuSection:ta.Oc()}b.r(F);C=b(0);var l=b(15),n=b(271),r=b(97),h=b(48),v=b(371),w=b(568),t=b(5),B=b(83),z=b(403),x=b(826),y=b(10),J=b(29),E=b(18),A=b(59),
H=b(4),S=b(903),Q=b(1156),L=b(961),aa=b(16);d.prototype.z7c=function(){this.vrh();this.arh();var ab=this.xA.a4a(this.selectedRanges,this.grid);Array.add(this.menuSection.buttons,this.Sa.Ab(ab?149:148))};d.prototype.Arh=function(){var ab=0;this.s0b?this.J$.Tn(942362098)?ab=this.xA.Tn(this.Xl,942362098,this.selectedRanges,this.grid)?161:169:this.HGf&&(ab=this.xA.Tn(this.Xl,-1113896058,this.selectedRanges,this.grid)?177:181):this.J$.Tn(-1113896058)&&(ab=this.cqa?this.xA.Tn(this.Xl,-1113896058,this.selectedRanges,
this.grid)?49:116:this.xA.Tn(this.Xl,-1113896058,this.selectedRanges,this.grid)?177:181);ab&&Array.add(this.Oia.buttons,this.Sa.Ab(ab))};d.prototype.wrh=function(){var ab=0;this.s0b?this.J$.Tn(622604322)&&(ab=this.grid.rtl?this.xA.Tn(this.Xl,622604322,this.selectedRanges,this.grid)?191:192:this.xA.Tn(this.Xl,622604322,this.selectedRanges,this.grid)?162:170):this.J$.Tn(1415868706)&&(ab=this.bqa?this.xA.Tn(this.Xl,1415868706,this.selectedRanges,this.grid)?50:117:this.xA.Tn(this.Xl,1415868706,this.selectedRanges,
this.grid)?178:182);ab&&Array.add(this.Oia.buttons,this.Sa.Ab(ab))};d.prototype.urh=function(){this.J$.Tn(1035996630)&&(this.xA.Tn(this.Xl,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Oia.buttons,this.Sa.Ab(this.grid.rtl?187:165)),Array.add(this.Oia.buttons,this.Sa.Ab(166))):(Array.add(this.Oia.buttons,this.Sa.Ab(this.grid.rtl?188:173)),Array.add(this.Oia.buttons,this.Sa.Ab(174))))};d.prototype.vrh=function(){var ab=b(1240).GridContextMenu,ea=null;this.lzb&&(ea=this.Sa.Kz("ContextMenu.InsertCells",
null,aa.a.instance.da(331),1896159024),Array.add(ea.menu.Bc,this.Oia));ab.xrh(this.Oia,this.Sa,this.$);this.Arh();this.wrh();this.urh();ea&&0<this.Oia.buttons.length&&Array.add(this.menuSection.buttons,ea)};d.prototype.crh=function(){var ab=0;this.s0b?this.J$.Tn(1405456548)?ab=this.xA.Tn(this.Xl,1405456548,this.selectedRanges,this.grid)?163:171:this.HGf&&(ab=this.xA.Tn(this.Xl,1554436520,this.selectedRanges,this.grid)?179:183):this.J$.Tn(1554436520)&&(ab=this.cqa?this.xA.Tn(this.Xl,1554436520,this.selectedRanges,
this.grid)?51:118:this.xA.Tn(this.Xl,1554436520,this.selectedRanges,this.grid)?179:183);ab&&Array.add(this.Mra.buttons,this.Sa.Ab(ab))};d.prototype.brh=function(){var ab=0;this.s0b?this.J$.Tn(284490184)&&(ab=this.xA.Tn(this.Xl,284490184,this.selectedRanges,this.grid)?164:172):this.J$.Tn(674605324)&&(ab=this.bqa?this.xA.Tn(this.Xl,674605324,this.selectedRanges,this.grid)?52:119:this.xA.Tn(this.Xl,674605324,this.selectedRanges,this.grid)?180:184);ab&&Array.add(this.Mra.buttons,this.Sa.Ab(ab))};d.prototype.$qh=
function(){this.J$.Tn(1035996630)&&(this.xA.Tn(this.Xl,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Mra.buttons,this.Sa.Ab(this.grid.rtl?189:167)),Array.add(this.Mra.buttons,this.Sa.Ab(168))):(Array.add(this.Mra.buttons,this.Sa.Ab(this.grid.rtl?190:175)),Array.add(this.Mra.buttons,this.Sa.Ab(176))))};d.prototype.arh=function(){var ab=null;this.lzb&&(ab=this.Sa.Kz("ContextMenu.DeleteCells",null,aa.a.instance.da(391),-1554384558),Array.add(ab.menu.Bc,this.Mra));this.crh();this.brh();this.$qh();
ab&&0<this.Mra.buttons.length&&Array.add(this.menuSection.buttons,ab)};Object(C.a)(d,"CellsContextMenuGenerator",null,[]);Object(C.a)(e,"MacroRecorderRangeHyperlinkRemovedPayload",null,[115]);var fa=b(548),W=b(25),G=b(96),N=b(79),Y=b(73),V=b(46),da=b(161),U=b(81),Z=b(640),ca=b(44),ra=b(141),La=b(35),na=b(571),ma=b(574),xa=b(1),Pa=b(173),ib=b(20),pb=b(366),xb=b(34);b.d(F,"GridContextMenu",function(){return a});var Ya=x.a;Em(a,Ya);a.prototype.dispose=function(){Ya.prototype.dispose.call(this);this.grid=
null};a.prototype.executeCommand=function(ab,ea,ta){var Ka=ea.command;ab=null;switch(Ka){case -1396319072:if(ea=this.grid.tc(null))n.a.instance.kUc(!0),r.EventHandlerManager.instance.O6c(),a.hCi(ea);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ga.wa.selectedRanges,ea);break;case 324156914:ab=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(ta);break;default:ab=Pa.a(Ka)}return ab||La.TaskExtensions.p3()};a.prototype.Ec=function(ab,ea,ta){ab=!1;switch(ea.command){case -1396319072:case -1253126584:case 324156914:ab=
!0;break;case 1441131127:ab=!!ta}return ab};a.prototype.OX=function(ab){ab=void 0===ab?!1:ab;var ea=!1,ta=!1,Ka=0;xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ka=h.a.Pe());var mb=this.Sa.$o(this.menuId),Ha=this.grid.ga.wa,Ga=Ha.xh,Fa=Ga&&Ha.Nd.Fh,eb=Ga&&Ha.Nd.isRow;Ha=Ha.selectedRanges;var db=v.a.all(Ha,function(ha){return ha.Fh}),Na=v.a.all(Ha,function(ha){return ha.isRow}),kb=V.O(Ha),Tb=V.P(Ha);this.d7e(Fa,eb)?(ea=!0,this.csh(mb)):this.$.isEditMode?
pb.a(this.$)?this.dsh(mb,Fa,eb):(this.drh(mb,!(eb||Fa||!this.vdc)),this.yrh(mb,Ha,ab),this.orh(mb,db,Na,kb,Tb),this.wNe(mb,Ga,Fa,eb),this.vsh(mb),this.YMe(mb,Fa,eb),this.Urh(mb,Ga,Fa,eb,Ha),this.grh(mb),this.erh(mb,Ha),this.Frh(mb),this.psh(mb,Ga),xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.srh(mb)):(ta=!0,pb.a(this.$)?this.pNe(mb):this.Lsh(mb,Ga,Fa,eb,Ha));xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(ab=
h.a.Pe()-Ka,l.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",ab,ea,ta,this.Pve));this.Pve=!1;return mb};a.prototype.gIa=function(ab){var ea=[];if(pb.a(this.$))return ea;if(3===ab){ab=this.grid.ga.wa;var ta=ab.xh,Ka=ta&&ab.Nd.Fh,mb=ta&&ab.Nd.isRow,Ha=!1,Ga=!1,Fa=!1;this.Bhd&&(Ga=ab.selectedRanges,Ha=V.O(Ga),Ga=V.P(Ga));if(ta){var eb=ib.e(this.grid);eb&&eb.range.contains(ab.Nd)&&this.mU(eb)&&(Fa=!0)}this.$.isEditMode?
this.d7e(Ka,mb)?Array.addRange(ea,[L.a.swf,L.a.uwf]):Ka||mb?(Array.add(ea,L.a.clipboard),mb?Array.add(ea,L.a.t0i):Ka&&Array.add(ea,L.a.$Mg)):(Array.addRange(ea,[L.a.edit,L.a.clipboard]),Fa?Array.add(ea,L.a.hyperlink):Array.add(ea,L.a.color),ta&&Array.add(ea,L.a.kAg)):(Array.add(ea,L.a.copy),Fa&&Array.add(ea,L.a.openHyperlink),!mb||this.Bhd&&Ga?!Ka||this.Bhd&&Ha||Array.add(ea,L.a.PBj):Array.add(ea,L.a.QBj));Array.add(ea,L.a.pMh)}else 2===ab&&Array.add(ea,L.a.Yoe);return ea};a.prototype.d7e=function(ab,
ea){return(this.Oya||this.fua||this.hY||this.refresh||this.expandCollapse)&&!(ab||ea)};a.prototype.showGridContextMenu=function(ab){this.expandCollapse=this.refresh=this.hY=this.fua=this.Oya=!1;var ea=this.$,ta=na.a(ea).zIa(),Ka=this.grid.ga.wa,mb=Ka.xh,Ha=mb&&Ka.Nd.Fh;Ka=mb&&Ka.Nd.isRow;!ta||Ha||Ka||((Ha=ma.a(ea))&&Ha.BJd&&(this.Oya=Ha=G.f(ea.kg),this.fua=!Ha),Ha=ea.ic,this.hY=ta.supportsBIExplore&&!!S.a(ea)&&Ha.r1(32768),Ha.allowInteractivity&&((ea=this.grid.tc(null))&&ea.cell&&(ea.cell.ZTc||ea.cell.iSf)&&
(this.expandCollapse=!0),Ha.allowManualDataRefresh&&(this.refresh=!0)));ea=null;ta=1;Ha=Object(B.a)(w.a,ab.eventArgs);ab=Object(B.a)(Q.a,ab.creationParams);Ka=this.Qwh();ab?(ea=ab.clientPoint,ta=ab.inputMethod):Ha&&1!==Ha.yb?(ea=new Sys.UI.Point(Ha.clientPoint.x,Ha.clientPoint.y),ta=Ha.yb):Ka&&(ea=new Sys.UI.Point(Ka.x+(this.$.isChromeRtl?0:Ka.width),Ka.y+Ka.height));N.a.Tb=ta;this.vdc=3===ta;ab=J.a.oqb;this.wn(ea,!Ha||Ha.Ea.target.className!==ab,ta)};a.prototype.removeHyperlinksFromRange=function(ab,
ea){var ta=this;if(!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Xs(ab,!0)){var Ka=V.r(ab,this.$),mb=this.$.ra.ua.Wb();this.$.userOperationManager.jc(new da.a(125,0,function(Ha,Ga,Fa){ta.$.Es();return U.c(ta.$.ra.ua,Ka,"","",!0,!1,127,Ha,Ga,Fa,null,mb)},void 0,function(){return new e(Ka)}),ea);this.grid.wi.PF(!1)}};a.prototype.Qwh=function(){var ab=this.grid.tc(null);if(ab&&ab.cell.jj&&this.r6e(ab))return this.grid.getCellBounds(ab.cell);
ab=this.grid.ga.wa.activeCell;return(ab=this.o5b(new W.Range(ab.top,ab.left,y.a.lh,ab.left,!1,!1),2,!0)||this.o5b(new W.Range(1,ab.left,ab.top,ab.left,!1,!1),2,!1)||this.o5b(new W.Range(ab.top,ab.right,ab.top,y.a.zh,!1,!1),1,!0)||this.o5b(new W.Range(ab.top,1,ab.top,ab.right,!1,!1),1,!1)||null)&&ab.jj?this.grid.getCellBounds(ab):Sys.UI.DomElement.getBounds(this.grid.Ktb.Ib)};a.prototype.r6e=function(ab){var ea=this.grid.rtl,ta=this.$.isChromeRtl;ab=ab.cell;var Ka=ib.g(this.$).cJ(ab);return Ka?(Ka=
Ka.topLeft,ea=Ka.x+=ea===ta?ab.offsetWidth:0,ta=Ka.y+=ab.offsetHeight,this.grid.view.visibleArea.contains(new A.a(ea,ta,0,0))):!1};a.prototype.o5b=function(ab,ea,ta){ab=this.grid.mm("GridContextMenu.FindFirstCellInViewportArea",ab,ea,ta);try{for(ab.$$rst();ab.$$mn();){var Ka=ab.$$cu();if(Ka&&this.r6e(Ka))return Ka.cell}}finally{ab&&ab.dispose()}return null};a.prototype.csh=function(ab){var ea=this.Sa,ta=ea.Oc();this.refresh&&Array.add(ta.buttons,ea.Ab(100));this.hY&&Array.add(ta.buttons,ea.Ab(99));
this.Oya?Array.add(ta.buttons,ea.Ab(59)):this.fua&&Array.add(ta.buttons,ea.Ab(58));if(this.expandCollapse){var Ka=ea.Kz("ContextMenu.PivotExpandCollapse",null,aa.a.instance.da(1098),589118293);var mb=ea.Oc();Array.add(mb.buttons,ea.Ab(240));Array.add(mb.buttons,ea.Ab(241));Array.add(mb.buttons,ea.Ab(242));Array.add(mb.buttons,ea.Ab(243));Array.add(Ka.menu.Bc,mb);Ka&&0<mb.buttons.length&&Array.add(ta.buttons,Ka)}Array.add(ab.Bc,ta)};a.prototype.wNe=function(ab,ea,ta,Ka){if(ea&&!ta&&!Ka){ea=this.Sa.Oc();
this.H7c(ea);this.zsh(ea);if(xa.EwaSettings.ka(506)&&ib.g(this.$).ga.wa.KP()&&ib.g(this.$).ga.wa.tU)switch(xa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Array.add(ea.buttons,this.Sa.Ab(234));break;case 2:Array.add(ea.buttons,this.Sa.Ab(235));break;default:Array.add(ea.buttons,this.Sa.Ab(233))}Array.add(ab.Bc,ea)}};a.prototype.H7c=function(ab){if(!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||
!this.$.isMobileMode||(new ra.a(this.$.va)).we(2048)){var ea=this.Sa.Oc();Array.add(ea.buttons,this.Sa.Ab(223));Array.add(ea.buttons,this.Sa.Ab(224));this.$.isMobileMode||Array.add(ea.buttons,this.Sa.Ab(225));var ta=this.Sa.Kz("ContextMenu.sort",null,aa.a.instance.da(216),-864298118);Array.add(ta.menu.Bc,ea);Array.add(ab.buttons,ta)}};a.prototype.zsh=function(ab){if(ib.g(this.$).ga.wa.KP()){var ea=this.Sa.Oc();Array.add(ea.buttons,this.Sa.Ab(232));var ta=this.Sa.Kz("ContextMenu.table",null,aa.a.instance.da(1878),
-697806646);Array.add(ta.menu.Bc,ea);Array.add(ab.buttons,ta)}};a.prototype.jNe=function(ab,ea,ta,Ka,mb){if(ea){var Ha=V.K(mb),Ga=ib.e(this.grid);if(Ga&&!ta&&!Ka){ta=new ra.a(this.$.va);if(Ga.range.contains(Ha)&&this.mU(Ga)){(ea=!Ga.kKa&&!ta.Pi)&&this.$.isEditMode&&Array.add(ab.buttons,this.Sa.Ab(45));Ga.v$&&Array.add(ab.buttons,this.Sa.Ab(53));ea&&this.$.isEditMode&&Array.add(ab.buttons,this.Sa.Ab(47));return}!Ga.kKa&&this.$.isEditMode&&(Ga=ta.we(128),Array.add(ab.buttons,this.Sa.Ab(Ga?46:121)))}}this.GMi(mb)&&
Array.add(ab.buttons,this.Sa.Ab(48));ea&&xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode&&(ea=V.K(mb),this.FMi(ea)?Array.add(ab.buttons,this.Sa.Ab(273)):ea.Fh||ea.isRow||Array.add(ab.buttons,this.Sa.Ab(272)))};a.prototype.GMi=function(ab){ab=Ol(ab);for(var ea=ab.next();!ea.done;ea=ab.next()){ea=this.grid.getRangeInformation(ea.value);for(var ta=0;ta<ea.length;ta++)if(Object(z.a)(fa.HyperlinkRange,ea[ta])){var Ka=this.grid.tc(ea[ta]);
if(Ka&&this.mU(Ka)&&!Ka.kKa)return!0}}return!1};a.prototype.FMi=function(ab){if(ib.g(this.$).ga.wa.KP()){var ea=ib.g(this.$).$b.Mk(ab);if(ea&&ea.usedRange.equals(ab))return!0}return!1};a.prototype.YMe=function(ab,ea,ta){if(1===ib.g(this.$).ga.Qe&&!ea&&!ta){ea=pb.a(this.$);ta=this.Sa;var Ka=ta.Oc(),mb=this.$.ea.Ba(65);mb&&mb.wl&&mb.wl.WD&&!ea&&Array.add(Ka.buttons,ta.Ab(227));mb&&mb.isCommentOperationEnabled(3)&&Array.add(Ka.buttons,ta.Ab(221));mb&&mb.wl&&mb.wl.gZe&&!ea&&Array.add(Ka.buttons,ta.Ab(228));
mb&&mb.hasCommentAtActiveCell?mb.uB.isResolved||Array.add(Ka.buttons,ta.Ab(159)):mb&&mb.hasCommentAtActiveCell||(mb&&mb.wl&&mb.wl.WD?ea||(Array.add(Ka.buttons,ta.Ab(229)),Array.add(Ka.buttons,ta.Ab(230))):(Array.add(Ka.buttons,ta.Ab(160)),ea||Array.add(Ka.buttons,ta.Ab(226))));Array.add(ab.Bc,Ka)}};a.prototype.vsh=function(ab){if(xa.EwaSettings.ka(135)){var ea=this.Sa,ta=ea.Oc();Array.add(ta.buttons,ea.Ab(247));Array.add(ab.Bc,ta)}};a.prototype.yrh=function(ab,ea,ta){if(!ta){ta=this.$.Ka.jG();var Ka=
new ra.a(this.$.va),mb=new Z.a(ta,ea,this.grid);(new d(ab,this.$,this.Sa,ta,ea,this.grid,mb,Ka)).z7c()}};a.prototype.orh=function(ab,ea,ta,Ka,mb){var Ha=(new ra.a(this.$.va)).we(8),Ga=this.Sa,Fa=Ga.Oc();ea&&Array.add(Fa.buttons,Ga.Ab(Ha?152:153));ta&&Array.add(Fa.buttons,Ga.Ab(Ha?150:151));ea&&(Ka||Array.add(Fa.buttons,Ga.Ab(Ha?109:155)),Array.add(Fa.buttons,Ga.Ab(Ha?111:157)));ta&&(mb||Array.add(Fa.buttons,Ga.Ab(Ha?108:154)),Array.add(Fa.buttons,Ga.Ab(Ha?110:156)));Array.add(ab.Bc,Fa)};a.prototype.drh=
function(ab,ea){var ta=this.Sa,Ka=ta.Oc();Array.add(ab.Bc,Ka);ea&&Array.add(Ka.buttons,ta.Ab(102));Array.add(Ka.buttons,ta.Ab(42));Array.add(Ka.buttons,ta.Ab(43));ea=this.$rh(ta);Array.add(ab.Bc,ea)};a.prototype.$rh=function(ab){var ea=ab.Oc();ea.title=aa.a.instance.da(1078);ea.dUf=!1;ea.cUf=!1;ea.fZf=!1;var ta=5,Ka=ca.a.Ykd(this.$);Ka&&(ta=6);ab=ab.Lz("PasteOptionsGallery",ta,"Size24by24",ea.title);Array.add(ea.buttons,ab);ab.Ts("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",
1079,void 0,"Paste_24",1,E.a.Veh);ab.Ts("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1080,void 0,"PasteValues_24",1,E.a.$eh);ab.Ts("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1081,void 0,"PasteFormulas_24",1,E.a.Xeh);ab.Ts("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1082,void 0,"PasteTranspose_24",1,E.a.Zeh);ab.Ts("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",
1083,void 0,"PasteFormatting_24",1,E.a.Weh);Ka&&ab.Ts("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1084,void 0,"PasteLink_24",1,E.a.Yeh);return ea};a.prototype.Lsh=function(ab,ea,ta,Ka,mb){var Ha=this.Sa,Ga=Ha.Oc();Array.add(Ga.buttons,Ha.Ab(43));Array.add(ab.Bc,Ga);xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.fa.ic.isMobileMode&&this.$.fa.ic.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(Ga=this.Sa.Oc(),
this.H7c(Ga),Array.add(ab.Bc,Ga),l.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));(Ga=this.$.ea.Ba(65))&&Ga.wl&&Ga.wl.WD&&(Ga=this.Sa.Oc(),Array.add(Ga.buttons,Ha.Ab(229)),Array.add(ab.Bc,Ga));Ga=this.Sa.Oc();this.jNe(Ga,ea,ta,Ka,mb);Array.add(ab.Bc,Ga);t.AFrameworkApplication.isMobileMode&&!Y.a(this.$.ya,30)&&(ea=Ha.Oc(),Array.add(ea.buttons,Ha.Ab(269)),Array.add(ab.Bc,
ea))};a.prototype.Urh=function(ab,ea,ta,Ka,mb){var Ha=this.Sa.Oc();this.Vrh(Ha);this.jNe(Ha,ea,ta,Ka,mb);0<Ha.buttons.length&&Array.add(ab.Bc,Ha)};a.prototype.Vrh=function(ab){Array.add(ab.buttons,this.Sa.Ab(135))};a.prototype.srh=function(ab){var ea=this.Sa.Oc();Array.add(ea.buttons,this.Sa.Ab(185));Array.add(ab.Bc,ea)};a.prototype.psh=function(ab,ea){xa.EwaSettings.ka(507)&&ea&&(ea=this.Sa.Oc(),Array.add(ea.buttons,this.Sa.Ab(259)),Array.add(ab.Bc,ea))};a.prototype.Frh=function(ab){var ea=this.grid.ga.wa.selectedRanges;
if(ea&&ea.length){for(var ta=!1,Ka=0;Ka<ea.length;Ka++)if(this.grid.$b.DKa(ea[Ka])){ta=!0;break}if(ta){var mb=this.Sa;ta=mb.Oc();Ka=mb.Oc();for(var Ha=1===ea.length&&(ea[0].isSingle||this.grid.$b.ywb(ea[0])),Ga=!1,Fa=!1,eb=!1,db=!1,Na=0;Na<ea.length&&!(Ga&&eb&&Fa&&db);Na++)!Ga&&this.grid.$b.Z3h(ea[Na])&&(Ga=!0),!eb&&this.grid.$b.j6e(ea[Na],!1)&&(eb=!0),!Fa&&this.grid.$b.vjd(ea[Na])&&(Fa=!0),!db&&this.grid.$b.O_h(ea[Na])&&(db=!0);xa.EwaSettings.ka(104)&&Ha&&!this.grid.$b.Uac(ea[0])&&(db?Array.add(ta.buttons,
mb.Ab(217)):Array.add(ta.buttons,mb.Ab(216)));db=Ga;db=!(new ra.a(this.$.va)).Pi&&db;eb&&(xa.EwaSettings.ka(130)&&G.l(this.$.kg)&&(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Array.add(Ka.buttons,mb.Ab(220)):Array.add(Ka.buttons,mb.Ab(db?220:268))),Fa&&Array.add(Ka.buttons,mb.Ab(db?218:266)),Ha&&(this.grid.$b.vjd(ea[0])||this.grid.$b.Uac(ea[0]))&&Array.add(Ka.buttons,
mb.Ab(db?219:267))),Array.add(Ka.buttons,mb.Ab(db?215:265)));0<Ka.buttons.length&&(ea=mb.Kz(Ga?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,aa.a.instance.da(1707),798637440),Array.add(ea.menu.Bc,Ka),Array.add(ta.buttons,ea));0<ta.buttons.length&&Array.add(ab.Bc,ta)}}};a.prototype.erh=function(ab,ea){this.grid.$b.D4e(ea)&&(ea=this.Sa.Oc(),this.grid.ga.wa.lva()?(Array.add(ea.buttons,this.Sa.Ab(238)),Array.add(ea.buttons,this.Sa.Ab(236))):
Array.add(ea.buttons,this.Sa.Ab(237)),Array.add(ab.Bc,ea))};a.prototype.mU=function(ab){return ab.cell.hasHyperlink};a.prototype.pNe=function(ab){this.esh(ab);var ea=this.Sa.Oc();this.H7c(ea);Array.add(ab.Bc,ea)};a.prototype.dsh=function(ab,ea,ta){this.pNe(ab);this.YMe(ab,ea,ta)};a.prototype.esh=function(ab){if(this.grid.ga.wa.xh&&!this.grid.Wa.Mi){var ea=this.Sa,ta=ea.Oc();xb.a(this.$).dKd()?Array.add(ta.buttons,ea.Ab(262)):Array.add(ta.buttons,ea.Ab(261));Array.add(ab.Bc,ta)}};a.hCi=function(ab){var ea=
ab.pIa(a.$dd);ea&&ea.Pfd&a.$dd&&ab.invoke(a.$dd,null)};a.xrh=function(ab,ea,ta){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(ta=ta.ea.Ba(254),!ta){l.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(ta=ta.ea.Ba(254,!0),!ta)return;ta.Zhd()&&ta.U$e()&&Array.add(ab.buttons,ea.Ab(212));ta.Zhd()&&ta.nec()&&Array.add(ab.buttons,ea.Ab(213))};
Ll.Object.defineProperties(a.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return H.a.kBf}}});a.ZEb="GridContextMenuRootName";a.zMh="gridMenuId";a.$dd=192;Object(C.a)(a,"GridContextMenu",x.a,[])},1358:function(C,F,b){function a(){this.Za=null;this.fw=!1}function e(c,k){var D=Dk.call(this)||this;D.koa=Wk.a.Osh;D.jJc=!!window.PointerEvent;D.Kae=window.hasOwnProperty("ontouchstart");D.nhb=null;D.qTa=null;
D.q7=!1;D.LR=new mk.a;D.Ihb=new mk.a;D.Vcg=new Tf.a;D.Ina=null;D.kjb=!1;D.CWd=!1;D.i8d=!1;D.cHc=!1;D.rAc=!1;D.wWd=!1;D.vDc=!1;D.uSa=!1;D.Pgb=-1;D.SLc=null;D.session=null;D.handlers=null;D.element=null;D.curRecognizer=null;D.Qd=Nf.EventHandlerManager.instance;D.jJc?(ed.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),D.nhb=Object(xd.a)(D,D.Vic,"onPointerEvent"),D.qTa=qf.a.Qsh):D.Kae?(ed.ULS.sendTraceTag(593893140,310,50,"Using touch events"),D.nhb=Object(xd.a)(D,D.Qwa,"onTouchEvent"),D.qTa=
qf.a.touchEvents):(ed.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),D.nhb=Object(xd.a)(D,D.Hic,"onMouseEvent"),D.qTa=qf.a.Psh);D.jh=k;D.Hda=c;Td.AFrameworkApplication.ha&&(D.kjb=Td.AFrameworkApplication.ha.sa("UsePointerCaptureIsEnabled"),D.CWd=Td.AFrameworkApplication.ha.sa("ClearCacheOnPrimaryPointerIsEnabled"),D.i8d=Td.AFrameworkApplication.ha.sa("ResetHandledBeforeInputHandlerIsEnabled"),D.cHc=Td.AFrameworkApplication.ha.sa("LogCoalescedEventsIsEnabled"),D.rAc=Td.AFrameworkApplication.ha.sa("CheckExistenceOfGetCoalescedEventsIsEnabled"),
D.wWd=Td.AFrameworkApplication.ha.sa("CheckIfHammerExistsAfterDownloadIsEnabled"),D.vDc=Td.AFrameworkApplication.ha.sa("HammerJsPerformanceTimersIsEnabled"),D.uSa=D.kjb&&Td.AFrameworkApplication.ha.sa("CancelDragFromGestureInputManagerIsEnabled")&&Td.AFrameworkApplication.ha.sa("UseGestureInputManagerPointerCacheIsEnabled"));return D}function d(){}function l(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=
this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function n(c,k,D,ba,Ba,nb,Rb,Ic,Wc){c=Jk.call(this,c,D,ba,nb)||this;c.beb=k;c.Kea=Rb;c.BW=Ic;c.BEj=Wc;c.Ucg=Ba;return c}function r(){this.HBc=null}function h(){this.Aba=this.DNe=null}function v(c){var k=ik.call(this)||this;k.$=c;k.Yb();return k}function w(c,
k,D,ba,Ba){var nb=Ck.call(this)||this;nb.yN=null;nb.a_=null;nb.wDa=null;nb.ipc=null;nb.cIc=null;nb.OUa=null;nb.Ryc=!1;nb.$=c;nb.tableManager=D;nb.contextMenuManager=ba;nb.og=new t(c,Object(xd.a)(nb,nb.Rc,"onClick"),k,Ba);nb.Pl=k.uve(c,D);nb.oTc=!1;nb.U4b=!1;nb.Tbd=ae.EwaSettings.ka(136);nb.SFc=!0;nb.gridView=ze.g(nb.$);nb.gridView.Gc.Jm(Object(xd.a)(nb,nb.Rj,"onEditStarted"));nb.gridView.uq(Object(xd.a)(nb,nb.oQ,"onGridContentReady"));nb.$.Jk(Object(xd.a)(nb,nb.jd,"onWorkbookOpened"));nb.$.dn(Object(xd.a)(nb,
nb.Pd,"onWorkbookClosing"));nb.$.hD(Object(xd.a)(nb,nb.fk,"onContentAreaResized"));nb.gridView.view.Us(Object(xd.a)(nb,nb.fq,"onGridScroll"));nb.gridView.ga.o1(Object(xd.a)(nb,nb.Bh,"onSelectionEnded"));nb.rlb=Cc.a.instance.create(Object(xd.a)(nb,nb.TV,"showOrHideButtonOnGrid"),250,cd.a.qKi);ed.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");nb.Pl.sPc(Object(xd.a)(nb,nb.kAb,"onFieldInfoListContextLoaded"));nb.TV();c.ea.Ia(261,nb);return nb}function t(c,k,D,ba){var Ba=vk.call(this)||
this;Ba.isMac=Qh.a.isMac;Ba.$=c;Ba.ariaLiveNotifier=ba;Ba.Zj=D.iob(c,null,k,ia.a.gfh,vh.a.ve(9),de.a.instance.da(1665),"PulloutPointerDown");return Ba}function B(c){var k=Pk.call(this)||this;k.EZc=null;k.$=c;k.Yb();return k}function z(c){var k=Vk.call(this)||this;k.$=c;return k}function x(){}function y(c,k,D,ba,Ba){D=void 0===D?null:D;ba=void 0===ba?null:ba;Ba=void 0===Ba?0:Ba;c=E.call(this,c,k)||this;c.tLa=null;c.Y$b=D||vh.a.current.mn(83);c.Kbf=Ba;c.v_c=ba;c.apg();return c}function J(c,k,D,ba){c=
E.call(this,c,k)||this;c.Xxb=null;c.wbg=D;c.gRh=ba;c.bpg();return c}function E(c,k){c=Ok.call(this,c)||this;c.Yxb=null;c.STh=Math.max(1,k);return c}function A(c,k,D,ba,Ba,nb,Rb,Ic){Ic=void 0===Ic?"":Ic;var Wc=uj.call(this)||this;Wc.tua=null;Wc.Q_e=!1;Wc.xgc=null;Wc.wgc=null;Wc.buttons={};Wc.iEe={};Wc.$=c;Wc.svgIconProvider=k;Wc.Hpi=D;Wc.sed=ba;Wc.qed=Ba;Wc.altText=nb;Wc.nCb=Rb;Wc.buttonText=Ic;return Wc}function H(c,k,D,ba,Ba,nb,Rb,Ic){function Wc(Ge){mg.g(Ge)}var Rd=hk.call(this,document.createElement("div"))||
this;Rd.T$e=null;Rd.iLd=!1;Rd.SPa=null;Rd.XIb=null;Rd.ZX=Rd.Hd.pra();Rd.set_visible(!1);Rd.kdc=Ba;Rd.nCb=nb;Rd.Zgc=c;Rd.rZb=k;Rd.kdc&&(Rd.SPa=Cc.a.instance.create(Object(xd.a)(Rd,Rd.vij,"shyTimerFired"),3E4,"OnObjectButton.ShyTimerFired",!1,!1));af.a.ma(c)||Rd.domElement.classList.add(c);Rd.rXa=document.createElement("div");Rd.domElement.appendChild(Rd.rXa);af.a.ma(D)||Rd.rXa.classList.add(D);af.a.ma(ba)||(Rd.rXa.innerHTML=ba);af.a.ma(Rb)||(Rd.XIb=document.createElement("div"),Rd.domElement.appendChild(Rd.XIb),
Rd.XIb.classList.add(Ic),Rd.XIb.innerText=Rb,Rd.domElement.style.padding="3px",Rj.a.instance.pa(qf.a.pointerDown,Rd.domElement,Object(xd.a)(Rd,Rd.yM,"onElementPointerDown")));Rd.jXa=new uk.a(Rd.domElement,7);$f.a.instance.pa(qf.a.click,Rd.domElement,Object(xd.a)(Rd,Rd.Rc,"onClick"));ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Rj.a.instance.pa(qf.a.pointerDown,Rd.domElement,Object(xd.a)(Rd,Rd.yM,"onElementPointerDown"));Rd.rc.ja("mouseup",Wc);Rd.rc.ja("click",
Wc);Rd.rc.ja("dblclick",Wc);return Rd}function S(){}function Q(c,k,D,ba){c=L.call(this,c,k)||this;c.LZa=null;c.d$f=D;c.contextMenuManager=ba;return c}function L(c,k){var D=hj.call(this)||this;D.x0=null;D.asb=null;D.PEb=null;D.XGc=!1;D.lPb=!1;D.ub=c;D.tableManager=k;return D}function aa(c){var k=kj.call(this)||this;k.firstElement=null;k.Un=null;k.eKa=!1;k.Nr=null;k.tcj=Qh.a.uf||Qh.a.aA;k.$=c;(c=k.$.fa.ic)&&ed.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",
c.g9,c.inWebPart?"Classic":"Non Classic",c.inEmbedView?"True (+Modern)":"False (not Modern)");c&&(c.inWebPart||c.inEmbedView)?ed.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",c.inWebPart?"Classic":"Non Classic",c.inEmbedView?"True (+Modern)":"False (not Modern)"):(k.bUg(),k.$Ug(),ek.KeyInputManager.instance.pa(qf.a.Qb,k.$.domElement,Object(xd.a)(k,
k.guf,"onWorkbookKeyDown")));k.$.ea.Ia(238,k);return k}function fa(c,k,D,ba,Ba){Ba=void 0===Ba?null:Ba;var nb=Ei.call(this)||this;nb.Mkb=null;nb.HMa=null;nb.sTc=0;nb.Gjc=null;nb.Smg=c;nb.Tmg=k;nb.documentVisibilityObserver=D;nb.Hja=ba;nb.pN=Ba;D&&nb.documentVisibilityObserver.okb(Object(xd.a)(nb,nb.wwa,"onDocumentUnhidden"));nb.rTc=!!D&&ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);nb.cne=ae.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",
3);k=ae.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);nb.dne=c.wrb(k);c=ae.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);nb.QFg=Math.max(nb.dne-k,0)+c;return nb}function W(){this.startTime=bh.a.Qa.Gb;this.xw=new jb.a}function G(c){var k=hi.call(this)||this;k.$=c;k.Yb();return k}function N(c,k,D,ba,Ba){this.k4=!1;this.CPa=!0;this.cLa=null;this.bLa=-1;this.$=c;this.functionInfoManager=
k;this.formulaAssistanceUIControl=Ba;this.pluginScheduler=ba;Jb.instance.$=c;this.O$=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.pzb=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.DBa=new da(this.$,this.formulaAssistanceUIControl);this.o7=new V(this.$,this.formulaAssistanceUIControl);this.functionInfoManager.skb(Object(xd.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded"));c.ea.Ia(464,this);this.calcManager=
D;Xg.a.aja()&&this.sfd();this.O$&&(ze.g(this.$).uc.Xr(Object(xd.a)(this,this.pj,"onEditEnded")),this.DBa.Wrg(Object(xd.a)(this,this.Njf,"onArgumentAssistanceDismissClick")));this.T2a=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache")}function Y(){this.argumentAssistance=this.functionSuggestion=null}function V(c,k){var D=pj.call(this,V.SHa())||this;D.pb=null;D.Aq=null;D.qGa=!1;D.rGa=!1;D.pGa=!1;D.nGa=!1;D.oGa=!1;D.tw=null;D.i_=0;D.Hr=null;D.visible=!1;D.Zda=
!1;D.xab=!1;D.aIb=!1;D.$Hb=!1;D.visible=D.get_visible;D.visible=D.set_visible;D.$=c;D.formulaAssistanceUIControl=k;D.Uia=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");D.Uia&&(D.Aq=new kb(D.$,D.formulaAssistanceUIControl,1,pe.a.X6c,Object(xd.a)(D,D.Ybd,"handleAutoCompleteFocusGained")));ze.g(D.$).view.Us(Object(xd.a)(D,D.fq,"onGridScroll"));ze.g(D.$).ga.HF(Object(xd.a)(D,D.$c,"onSelectionChanged"));D.$.va.Pf(Object(xd.a)(D,D.Ai,"onActiveSheetChanged"));D.ZL=
Xg.a.ZL(D.$);D.Hhd=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");D.mhd=D.ZL&&ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5543855_EnterCommitsSmartSuggestions");D.P$=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");D.fKa=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");return D}function da(c,k){var D=Uh.call(this,da.SHa())||this;D.vS=0;D.Aq=null;D.Hr=null;D.yja=
null;D.visible=!1;D.$=c;D.formulaAssistanceUIControl=k;D.en=Xg.a.ZL(c);D.O$=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);D.CHd();D.Aq=new kb(D.$,D.formulaAssistanceUIControl,0,pe.a.V6c);ze.g(D.$).view.Us(Object(xd.a)(D,D.fq,"onGridScroll"));ze.g(D.$).ga.HF(Object(xd.a)(D,D.$c,"onSelectionChanged"));return D}function U(c,k,D,ba,Ba,nb,Rb,Ic){var Wc=Si.call(this,c)||this;Wc.Y9b=!1;Wc.Aq=null;Wc.nEa=null;Wc.Ij=null;Wc.xU=null;Wc.dld=null;Wc.f4=null;Wc.c0a=
0;Wc.l6b=0;Wc.z2=0;Wc.TAe=0;Wc.ppb=0;Wc.Sab=0;Wc.W0b=0;Wc.Lrc=!1;Wc.nha=null;Wc.ikc=null;Wc.columnName="";Wc.z0c=!1;Wc.poe=!1;Wc.IHa=[];Wc.YO=null;Wc.$Pa=[];Wc.k4=!1;Wc.Hr=null;Wc.v7c=null;Wc.R6=null;Wc.Zda=!1;Wc.xab=!1;Wc.aIb=!1;Wc.$Hb=!1;Wc.cLa=null;Wc.bLa=0;Wc.hVd=null;Wc.gf=c;Wc.functionInfoManager=k;Wc.domElement.className=zd.a.sEe;Wc.Pl=nb.uve(c,D);Wc.zye=new Wa(c);Wc.Lkg=D;Wc.formulaAssistanceUIControl=Rb;Wc.pluginScheduler=Ic;Jb.instance.$=c;Wc.en=Xg.a.ZL(c);af.a.ma(U.Wdd)&&(U.Wdd=U.SHa());
Wc.domElement.innerHTML=U.Wdd;Wc.$rd=RegExp("\\d+");td.d(Wc.style,Wc.gf.isChromeRtl);Wc.Aha=new Ha(Wc.gf,Wc.domElement,Wc.functionInfoManager,Wc.formulaAssistanceUIControl,Wc.pluginScheduler);k=$get(jc.s7c,Wc.domElement);D=$get(jc.n7c,Wc.domElement);nb=$get(jc.u7c,Wc.domElement);Wc.Kcg=new pb(Wc.gf,k,nb,D,Wc);Wc.Pl.sPc(Object(xd.a)(Wc,Wc.kAb,"onFieldInfoListContextLoaded"));Wc.functionInfoManager.skb(Object(xd.a)(Wc,Wc.onFunctionInfoLoaded,"onFunctionInfoLoaded"));Wc.functionInfoManager.tsg(Object(xd.a)(Wc,
Wc.lnf,"onFunctionInfoReset"));Wc.en&&(Wc.gf.va.Pf(Object(xd.a)(Wc,Wc.Ai,"onActiveSheetChanged")),Wc.Vf.pge(Object(xd.a)(Wc,Wc.dsf,"onSelectedAutoCompleteItemChanged")));Wc.mQa(!0);Wc.OWf(!0);Wc.gf.domElement.appendChild(Wc.domElement);Wc.OKc=0;(D=Ci.a(c))&&Array.add(Wc.IHa,new Ka(c,D,Wc));Array.add(Wc.IHa,new Ka(c,ze.g(c).Gc,Wc));Wc.frb=Wc.IHa[0];Wc.Fmb=Wc.IHa[Wc.IHa.length-1];c.ea.Ia(221,Wc);Wc.calcManager=ba;Wc.instantaneousSupportInformationManager=Ba;Wc.instantaneousSupportInformationManager||
Wc.gf.ea.$a(268,function(Rd){Wc.instantaneousSupportInformationManager=Rd});Wc.vJe=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Wc.wab=Xg.a.Ihd();Wc.pzb=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");Xg.a.aja()&&Wc.sfd();Xg.a.dM(Wc.gf)&&k.classList.add("ewa-fb-refactor");Wc.en?ze.g(Wc.gf).ga.HF(Object(xd.a)(Wc,Wc.$c,"onSelectionChanged")):ze.g(Wc.gf).ga.o1(Object(xd.a)(Wc,Wc.$c,"onSelectionChanged"));Wc.Uia=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");
Wc.Uia&&(Wc.Aq=new kb(Wc.gf,Wc.formulaAssistanceUIControl,1,pe.a.X6c,Object(xd.a)(Wc,Wc.Ybd,"handleAutoCompleteFocusGained")));Wc.fKa=Wc.en&&ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");return Wc}function Z(){}function ca(){this.caretPosition=this.content=null}function ra(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function La(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function na(){this.onDismiss=
this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function ma(){this.a8=this._name=null}function xa(){this._name=null}function Pa(){this._name=null}function ib(){this.a8=this._name=null}function pb(c,k,D,ba,Ba){k=Sh.call(this,c,k)||this;k.qpa=null;k.vpc=0;k.ZHb=0;k.vXc=null;k.KMe=D;k.lrb=ba;k.formulaAssistanceControl=Ba;k.nr=[];k.fV=[];k.en=Xg.a.ZL(c);return k}function xb(){this.textEdit=this.label=null;this.kind=0;this.isPrefixed=this.detail=this.type=null}function Ya(c,
k){this.$=c;this.items=k}function ab(c,k){this.CIi=c;this.thf=k}function ea(){}function ta(c){this.index=c}function Ka(c,k,D){var ba=sh.call(this,c,k)||this;ba.quf=!1;ba.GPa=null;ba.Ded=0;ba.gAc=null;ba.VFa=null;ba.ZO=0;ba.formulaAssistanceControl=D;ba.KWa=k.textBox;ba.T2a=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache");ba.en=Xg.a.ZL(c);ba.vSi=ae.EwaSettings.GG();return ba}function mb(){this.qga=this.Wqa=this.Xqa=!1;this.Cuf=40;this.xre=41;this.cYa=
this.yvd=this.zvd=this.QBb=0;this.Glf=!0;this.jud=!1;this.gLe=this.VFd=-1}function Ha(c,k,D,ba,Ba){var nb=fh.call(this,Ha.SHa(Xg.a.ZL(c)))||this;nb.IZa=null;nb.vS=0;nb.Aq=null;nb.jRc=!1;nb.Hr=null;nb.yja=null;nb.CPa=!0;nb.$=c;nb.Gi=k;nb.functionInfoManager=D;nb.formulaAssistanceUIControl=ba;nb.pluginScheduler=Ba;nb.en=Xg.a.ZL(c);nb.O$=nb.en&&ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);nb.en?(nb.CHd(),nb.Aq=new kb(nb.$,nb.formulaAssistanceUIControl,0,
pe.a.V6c),nb.O$&&ze.g(nb.$).uc.Xr(Object(xd.a)(nb,nb.pj,"onEditEnded"))):(nb.IZa=new db(nb.domElement,nb.$.Fz,void 0,Xg.a.dM(nb.$)),nb.rc.ja("mousedown",Object(xd.a)(nb,nb.tsi,"onFunctionBoxMouseDown")),c=$get(jc.s7c,nb.Gi),nb.Gi.insertBefore(nb.domElement,c));ze.g(nb.$).view.Us(Object(xd.a)(nb,nb.fq,"onGridScroll"));return nb}function Ga(){this.content=null;this.caretPosition=0}function Fa(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function eb(){this.onDismissClick=this.onFeedback=
this.onHelpLink=this.onCardModeChange=null}function db(c,k,D,ba){ba=void 0===ba?!1:ba;k=Dh.call(this,c,k,!1,void 0===D?null:D)||this;k.nPa(ba);k.Vi=af.a.equals("rtl",c.dir,!0);return k}function Na(c,k){var D=bi.call(this)||this;D.Pcg=[];D.w7c={};D.NMe={};D.BR=null;D.p7=[];D.PHa={};D.nFc=!1;D.lFc=!1;D.ub=c;D.pluginScheduler=k;D.$.ea.Ia(19,D);return D}function kb(c,k,D,ba,Ba){this.bUc=!1;this.$=c;this.formulaAssistanceUIControl=k;this.oMe=D;this.o3i=ba;this.HXe=void 0===Ba?null:Ba}function Tb(c,k,D){var ba=
mh.call(this)||this;ba.t7c=c;ba.hGd=k;ba.QDi=D;return ba}function ha(c){var k=Cg.call(this)||this;k.hGd=c;return k}function lb(c,k){var D=Df.call(this)||this;D.functionName=c;D.t7c=k;return D}function Wa(c){this.Aye={};this.$=c}function Ra(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function Yb(){this.ER=0;this.f1d=!1;this.pTa=this.x2d=null;this.f2d=!1;this.textEdit=null}function oc(c){this.uob=this.Yfa=this.calcManager=this.pb=null;this.$=c;this.erb=new uc(c);this.a6b=
new lc(c);this.b6b=new zb(this);ze.g(c).Gc.Xr(Object(xd.a)(this,this.s6a,"onEditCellEnded"));this.$.ea.Ia(317,this)}function zb(c){this.q6=0;this.W6c=c}function uc(c){this.yoa=this.oQa=this.g_a=this.MO=this.j9=this.pb=null;this.Mcd=!1;this.Kc=c}function P(){}function lc(c){this.Pgi=30;this.calcManager=null;this.Bd=!1;this.IMa=this.bCb=this.z7a=null;this.$=c;this.$fa=new tc;this.JHf=-1;this.$.fa.jD(Object(xd.a)(this,this.mx,"onStateIdChanged"))}function Ec(c,k,D,ba,Ba,nb,Rb){Rb=c.Na(1,void 0===Rb?
null:Rb);Rb.getPartialCalcResultsParameters=k;return hg.i(c,"GetPartialCalcResults",Rb,D,ba,Ba,nb,4)}function tc(){this.lOa={}}function cc(c){var k=va.call(this)||this;k.$=c;k.Yb();return k}function Zb(c,k){this.OHa=this.GHa=this.Bha=null;this.$=k;this.ariaLiveNotifier=c;this.$.ea.Ia(219,this);this.R2a=Xg.a.ZL(k);this.fKa=Xg.a.ZL(k)&&ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout")}function Aa(c){return R.call(this,c)||this}function Ia(c,k,D){this.qqh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");
this.menuId=null;this.$=c;this.functionInfoManager=D;this.Sa=k;this.eL={};this.frame=this.$.frame;this.functionInfoManager.skb(Object(xd.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded"))}function qb(c,k){var D=Zj.call(this,c,de.a.instance.da(981),void 0,void 0,void 0,ae.EwaSettings.ka(410))||this;D.NHa=null;D.Fha=null;D.MHa=null;D.nrb=null;D.HMe=null;D.Eha=null;D.IMe=null;D.LMe=null;D.Mbf=null;D.mrb=null;D.Wcd=!1;D.EYb=null;D.E4=null;D.Qtb=null;D.functionInfoManager=c.ea.Ba(19);D.formulaAssistanceControl=
c.ea.Ba(221);D.JGa=k;D.JUc=k.textBox.caretPosition;return D}function wb(c){var k=wh.a.Haa,D=c.ea.Ba(368);D&&!ze.g(c).nj&&(k=D.zoom);return k}function ic(c,k,D){if(c)if(Jb.instance.Cha.argumentAssistanceLearnMoreCounter++,D){if(!af.a.ma(k)&&(!k||k.startsWith("http://")||k.startsWith("https://"))){if(c.ka(157)&&(c=c.ea.Ba(269))&&c.Aza(k))return;Gb.HelperMethods.lf(k,"_blank",gk.a)}}else{D=new Th.a(-859308420,Dg.a.Tb,c.dd,0,null);var ba={};k=(ba.MenuItemId=xe.a.AY,ba.CommandValueId="HelpID="+k,ba);c.Ka.Ub(D,
k)}}function Jb(){this.Cha=new Db;this.e6b=new Hb;this.t1=new Qb;this.Elb=new Sa;this.ub=null;this.Spc=new Ca;this.A7a=new mk.a}function Ua(){this.Gy=new ua;this.aY=[];this.$fc=-1;this.GGd=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5819461_separateFormulaTelemetryFirstAction");this.GGd||(this.Gy.includingFirstAction=new $a)}function $a(){this.P95=this.P75=this.median=this.max=this.average=0}function ua(){this.firstAction=this.failedCount=this.count=0;this.excludingFirstAction=this.includingFirstAction=
null}function Ca(){this.smartFormulaBarAutoCompleteFlight=this.autoCompleteUIFlight=this.argumentAssistanceFlight=null}function Sa(){this.formulaAssistanceRequestOptimizedCounter=this.formulaAssistanceRequestAttemptedCounter=0}function Qb(){this.commitByMouseClickCounter=this.commitByEnterKeyCounter=this.commitByTabKeyCounter=this.selectByMouseHoverCounter=this.selectByArrowKeyCounter=0}function Hb(){this.smartSuggestionCommittedCounter=this.smartSuggestionSelectedCounter=this.smartSuggestionShownCounter=
0}function Db(){this.argumentAssistanceCardInitialMode=null;this.argumentAssistanceDismissCounter=this.argumentAssistanceLearnMoreCounter=this.argumentAssistanceExpandCounter=this.argumentAssistanceCollapseCounter=0}function jc(){}function sb(c){var k=Ak.call(this)||this;k.$=c;k.Yb();return k}function fb(c){var k=rk.call(this,document.createElement("div"))||this;k.aQ=!1;k.GP=!1;k.SXb=!1;k.yh=null;k.Gh=null;k.L0h=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConditionalHideAll",
!1);k.M0h=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConstButtonWidth",!1);k.s3h=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5862418_LogDataValidationButtonWidth");k.c8h=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.VisibilityOptimizationOnTaggedElements",!1);k.nid=!1;k.mjd=!1;k.qgd=!1;k.p1b=[];k.$=c;k.gridView=ze.g(k.$);k.kF=k.gridView.Gc;var D="<div id='dv_reader_description' class='"+vj.a.kFe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+
Nc.ebh+" "+ia.a.gu+"'></div>\r\n<div id='dv_list_box' class='"+Nc.kah+" "+ia.a.lr+" "+ia.a.gu+"'></div>\r\n<div id='dv_prompt_box' class='"+Nc.cbh+" "+ia.a.gu+"'></div>";k.domElement.className=Nc.dbh;k.domElement.innerHTML=D;td.d(k.style,k.isGridRtl);k.Zf=$get("dv_list_box",k.domElement);k.hV=$get("dv_prompt_box",k.domElement);k.Vfa=$get("dv_list_button",k.domElement);k.$4a=$get("dv_reader_description",k.domElement);k.c8h&&(k.domElement.setAttribute(fk.a.TWa,"true"),k.Zf.setAttribute(fk.a.TWa,"true"),
k.hV.setAttribute(fk.a.TWa,"true"),k.Vfa.setAttribute(fk.a.TWa,"true"),k.$4a.setAttribute(fk.a.TWa,"true"));(D=Ci.a(c))&&Array.add(k.p1b,new Ab(c,D,k));Array.add(k.p1b,new Ab(c,k.gridView.Gc,k));k.gridView.ga.CF(Object(xd.a)(k,k.mh,"onActiveCellChanged"));k.gridView.uq(Object(xd.a)(k,k.onContentReady,"onContentReady"));k.gridView.uc.asg(Object(xd.a)(k,k.omf,"onEditBoxDimensionsChanged"));k.$.dn(Object(xd.a)(k,k.Pd,"onWorkbookClosing"));D=k.gridView.Gi;D.insertBefore(k.domElement,D.firstChild);k.onContentReady(null,
null);c.ea.Ia(14,k);return k}function Qa(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd){var Ge=Fk.call(this,document.createElement("a"))||this;Ge.gl=!1;Ge.m8g=Ic;Ge.l3g=Wc;Ge.fI=Qa.Ab(Ge.domElement,k,D,ba,Ba,nb,Rb,Rd);Ge.rc.ja("contextmenu",function(df){mg.g(df)});Ge.enable();Ge.hovered=!1;Ge.focused=!1;c.appendChild(Ge.domElement);return Ge}function cb(c,k,D){c=zk.call(this,c,k,new Gj.a(Nc.listItem,Nc.Oxb,Nc.Rxb,Nc.Sxb))||this;c.xib=null;c.je=null;c.aca=null;c.CU=null;c.$Fa=null;c.Fva=0;c.FBb=[];c.j2f=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateDvListHeightUsingItemHeight",
!1);c.tci=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5858877_logDvListBoxHeight");c.$4a=D;return c}function Ab(c,k,D){c=qk.call(this,c,k)||this;c.dataValidationControl=D;return c}function gc(c,k,D){var ba=ri.call(this,c)||this;ba.v9=null;ba.wT=null;ba.T7e=!1;ba.errorMessage=null;ba.PZe=null;ba.lm=null;ba.yca=null;ba.WDe=D;ba.sqmManager=jj.a(ba.$);ba.error=gc.xP(k,c,D);ba.zb.ap=ba;c=c.ea.Ba(14);ba.cu=c.z0a(ba.WDe);ba.VGa=ba.cu&&ba.cu.VGa?ba.cu.VGa:de.a.instance.da(1661);ba.j7i();ba.initializeAndShow(ba.VGa,
Object(xd.a)(ba,ba.Ixe,"dataValidationErrorDialogHandler"),ba.v9);return ba}function Lc(c,k,D){k=Sj.call(this,c,Lc.xP(k,c,D))||this;ze.g(k.$).ga.HF(Object(xd.a)(k,k.$c,"onSelectionChanged"));ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&(c=c.ea.Ba(14).z0a(D))&&c.options&1&&ed.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return k}function Nc(){}function yd(c){var k=
Zi.call(this)||this;k.$=c;k.Yb();return k}function Od(c,k){this.QWa=null;this.ariaLiveNotifier=c;k.Ia(213,this)}function sa(c){var k=Ri.call(this)||this;k.$=c;k.Yb();return k}function vb(c){var k=Cj.call(this)||this;k.$=c;k.Yb();return k}function Lb(c,k){var D=this;this.dLa=1;this.$ea=[];this.active=!1;this.tableManager=c;this.gridView=k;this.$=k.$;c.ege(Object(xd.a)(this,this.Kqf,"onRangeListUpdated"));k.ysg(Object(xd.a)(this,this.Znf,"onHeaderViewBlockCreated"));k.zsg(Object(xd.a)(this,this.$nf,
"onHeaderViewBlockDisposed"));this.$.va.Pf(Object(xd.a)(this,this.kf,"onActiveItemChanged"));this.$.wb.Pf(Object(xd.a)(this,this.kf,"onActiveItemChanged"));this.tje(function(ba){ba.eQc(Object(xd.a)(D,D.YIa,"headerBlockOnUpdatedBlockHtml"))});this.we()&&(this.activate(),this.Mv(this,null));this.$.ea.Ia(68,this)}function rc(c){return wk.call(this,c)||this}function Oc(c,k,D,ba,Ba,nb){this.nD=null;this.yXa=1461300262;this.fB=this.uXa=this.B5a=this.$5b=null;this.$=c;this.gridView=k;this.ji=D;this.oA=ba;
this.borderFormatManager=Ba;this.moreColorsHelper=nb;this.Ooh=new Vc(this.$);this.yg=ae.EwaSettings.yg();this.jgc=new Bb(this.$,D);this.SG=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}function Bb(c,k){this.$=c;this.ji=k;this.wX=new Rc(ze.g(this.$).Ca,this.$);this.x7e=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.qbc=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.xid=
ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL")}function hc(){this.scenario=0;this.xHa=null}function Pc(){this.qOa=this.vEa=this.lLa=this.OQa=0}function rd(c,k,D,ba){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=c;this.targetSheetRange=k;this.fillRangeType=D;this.fillRangeDirection=ba}function Id(c,k,D){c=Yi.call(this,c)||this;c.Kn=null;c.V0c=0;c.Mo=k;c.selectedRanges=D;k=Object(Og.a)(bg.a,
c.$.va.qa);c.isRtl=k.displayRtl;return c}function Vd(c,k,D,ba,Ba,nb){this.ETd=!1;this.FTd=null;this.Txc=0;this.Ui=null;this._state=0;this.sf=c;this.qAa=k;this.pAa=this.sTd=Ba;this.jLb=nb;this.Rt=this.xK;this.moveNext()}function He(c,k,D,ba,Ba,nb,Rb,Ic){this.Qxc=0;this.HTd=this.Uxc=!1;this.Ui=this.JTd=null;this._state=0;this.sf=c;this.qAa=k;this.A6f=Ba;this.pAa=this.sTd=nb;this.jLb=Rb;this.rTd=Ic;this.Rt=this.xK;this.moveNext()}function Nd(c,k,D,ba){this.Icg=c;this.Jcg=k;this.wkg=D;this.JSb=ba}function Vc(c){this.$=
c;this.B_h=!!String.fromCodePoint&&!Qh.a.jf&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.j7e=!1}function fe(c){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=c}function Ee(c){var k=ug.call(this)||this;k.$=c;k.Yb();return k}function lf(c){return Gf.call(this,c)||this}function Da(c,k){this.h6b=this.Cyd=null;this.$=c;this.gridView=ze.g(c);this.kE=k.LYa(this.$.domElement,500,null,null);this.QIa=this.PIa=-1}function fc(c){this.freezeOptions=
null;this.freezeOptions=c}function Ib(){}function Ta(c){var k=Mb.call(this)||this;k.A2i="formulaAssistance";k.$=c;k.Yb();return k}function kd(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function ce(c){var k=wa.call(this)||this;k.$=c;k.Yb();return k}function dc(c){var k=this;this.wX=this.calcManager=this.Sl=this.VPa=null;this.$=c;this.$.ea.$a(268,function(D){k.Sl=D});this.$oh=new hd(ze.g(this.$).Ca,this.$);this.D1=new Wd(this.$,ze.g(this.$),this);this.$.ea.$a(266,function(D){k.calcManager=D});this.ebc=
ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CSEPlainTextOptimization",!1);this.yg=ae.EwaSettings.shd();this.ckd=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5841057_SimplifyFormattedTextForPlainText_2")}function ub(c,k){this.success=c;this.tP=k}function pc(){this.N4f=this.ACj=!1;this.source=0;this.AJa=this.Rcc=!1}function xc(c,k,D,ba,Ba){D=void 0===D?null:D;ba=void 0===ba?null:ba;Ba=void 0===Ba?null:Ba;ed.ULS.shipAssertTag(537162128,0,!!(!!(null!=D^!(void 0===ba||null===ba))^!(void 0===
Ba||null===Ba))&&!(null!=D&&void 0!==ba&&null!==ba&&void 0!==Ba&&null!==Ba),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=D&&0>D&&(ed.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),D=null);this.Sl=c;this.aq=k;this.Hcg=D;this.b6a=ba;this.Ooa=Ba}function hd(c,k){this.wX=null;this.Ca=c;this.qHa=k}function Rc(c,k){this.Ca=c;this.qHa=k}function ld(c,k,D){this.success=c;this.khc=void 0===k?null:k;this.reason=void 0===
D?"":D}function Wd(c,k,D){var ba=this;this.yba=[];this.calcManager=this.Etc=this.lastSetCellInstantaneousOperation=null;this.$=c;this.grid=k;this.ji=D;this.rba=Wd.oye;this.$.ea.$a(268,function(Ba){ba.Etc=Ba});this.$.ea.$a(266,function(Ba){ba.calcManager=Ba})}function ee(c,k,D,ba){this.rangeDelta=c;this.stateId=k;this.isFinished=D;this.priorityGroup=ba}function ne(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd,Ge,df,Wf,Pg,Bg,qh,dj,vi,$i,jk,sk,Ek,Xk,Sk,Kk){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=
this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=
null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===c?0:c;this.numberOfNonUpdatedCells=void 0===k?0:k;this.numberOfUpdatedCells=void 0===D?0:D;this.numberOfCellsUpdatedAlreadyByServer=void 0===ba?0:ba;this.numberOfCellsSkippedDueToTimeout=
void 0===Ba?0:Ba;this.numberOfCellsWithNoFormattedCell=void 0===nb?0:nb;this.numberOfUnsupportedErrorCellTypes=void 0===Rb?0:Rb;this.numberOfUnsupportedBlankCellTypes=void 0===Ic?0:Ic;this.numberOfUnsupportedRichCellTypes=void 0===Wc?0:Wc;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===Rd?0:Rd;this.totalExecutionTime=void 0===Ge?0:Ge;this.originalProcessingTimeLimit=void 0===df?0:df;this.newProcessingTimeLimit=void 0===Wf?0:Wf;this.numberOfEditedRecalcedCellsInBatch=void 0===Pg?0:Pg;this.numberOfDependentRecalcedCellsInBatch=
void 0===Bg?0:Bg;this.isNewTask=void 0===qh?!1:qh;this.lastSetCellInstantaneousOperation=void 0===dj?"":dj;this.taskId=void 0===vi?0:vi;this.isNewNumberFormatter=void 0===$i?null:$i;this.numberOfRecalcedCellsWithFormattedValue=void 0===jk?null:jk;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===sk?null:sk;this.totalNumberFormatterTime=void 0===Ek?null:Ek;this.newNumberFormatterFinalizeFailures=void 0===Xk?null:Xk;this.numberOfMeasureTextWidthCalls=void 0===Sk?null:Sk;this.numberOfHashFormattedValues=
void 0===Kk?null:Kk}function Ad(c,k,D,ba,Ba,nb,Rb,Ic,Wc){this.Fkg=c;this.Xhb=void 0===Rb?"":Rb;this.Mx=void 0===k?"":k;this.Mfb=void 0===D?null:D;this.Gcg=void 0===ba?null:ba;this.Fgg=void 0===Ba?0:Ba;this.dmg=void 0===nb?0:nb;this.Hgg=void 0===Ic?0:Ic;this.Egg=void 0===Wc?null:Wc}function se(){}function Ve(c,k,D,ba,Ba){this.K1=void 0===c?0:c;this.cellValue=void 0===k?"":k;this.ifmt=void 0===D?0:D;this.priorityGroup=void 0===ba?"":ba;this.tP=void 0===Ba?"":Ba}function Zf(c){if(c.priorityGroup===ac.editCell)return 0;
if(c.priorityGroup===ac.dependentCell)return 1;ed.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function Pf(c,k){var D=Zf(k),ba=!(void 0===k.rangeDelta.data.format||null===k.rangeDelta.data.format);ed.ULS.shipAssertTag(537162187,0,!D||!ba,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",k.priorityGroup);c=Math.max(c.cell.numberFormatIndex,0);ba&&(ba=excelOnlineCalc.calc.getCellFormatKind(k.rangeDelta.data.format.format),
"number"===ba?c=k.rangeDelta.data.format.format:"string"===ba?ed.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===ba?ed.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):ed.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return c}function Fe(c){var k=c.value;switch(c.type){case 2:return void 0===k||null===k?"":k;case 1:return c=
parseFloat(k),isNaN(c)?null:c;case 3:return c=parseFloat(k),isNaN(c)?null:1===c;case 4:return c=parseFloat(k),isNaN(c)?null:excelOnlineCalc.calc.errorValue(c);default:return excelOnlineCalc.calc.blankValue}}function me(c){c=excelOnlineCalc.calc.getCellValueKind(c.rangeDelta.data.value);var k=0;switch(c){case "number":k=1;break;case "string":k=2;break;case "boolean":k=3;break;case "Error":k=4;break;case "Blank":k=0;break;default:ed.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",
c)}return k}function ng(c,k){c=excelOnlineCalc.calc.getCellValueKind(c.rangeDelta.data.value);switch(c){case "number":case "string":case "boolean":return!0;case "Blank":if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;k.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;k.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return k.numberOfUnsupportedRichCellTypes++,
!1;default:return ed.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",c),!1}}function Oe(c){if(c=c.color){if("String"===Object.getType(c).getName())return wi.a.jp(c);if("Number"===Object.getType(c).getName())return null}else return null;ed.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function bd(c){c=c.alignment;if(c===Fc.center)return 2;if(c===Fc.left)return 1;
if(c===Fc.right)return 3;ed.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!");return 0}function ac(){}function Fc(){}function Zc(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd,Ge,df,Wf){df=void 0===df?null:df;Wf=void 0===Wf?null:Wf;Ic=Yj.call(this,11,0,Ic,Ge)||this;Ic.Zoh=c;Ic.T6c=k;Ic.format=ba;Ic.activeCell=D;Ic.nje=Ba;Ic.ywf=nb;Ic.twf=Rb;Ic.mDa=Wc;Ic.clientCorrelationId=Rd;Ic.Sib=df;Ic.gfb=Wf;return Ic}function pd(){}function bf(c){var k=
qi.call(this)||this;k.oOb=null;k.$=c;k.Yb();return k}function Bd(c){var k=Kh.call(this)||this;k.fyf=0;k.ZF=null;k.$=c;return k}function Qe(c){var k=Lj.call(this,!1,!1,Qe.Cx)||this;k.Dod=!1;k.sef=!0;k.Ndf=0;k.hc=1;k.yc(1,CommonUIStrings.l_Send);k.yc(0,CommonUIStrings.l_NoThanks);k.tf=Ob.O7f;k.Idf=c;k.Ie=Qe.$Fg;return k}function Ob(){}function yc(c){return Wj.call(this,c)||this}function id(){}function Tc(c,k,D,ba){c=Oj.call(this,c)||this;c.Yyb=null;c.mgc=null;c.xac=null;c.b2=null;c.Wia=!1;c.disposed=
!1;c.TKa=!1;c.Kh=null;c.selectedRanges=k;c.NNb=D;c.command=ba;3===ba&&(c.Wia=!0);c.hc=2;c.Qt=!1;c.tf=Ub.tf;return c}function od(c,k){this.options=this.cellRange=null;this.cellRange=c;this.options=k}function mc(c,k){c=nj.call(this,c)||this;c.s8=null;c.Nfa=null;c.FRa=null;c.u8=null;c.t8=null;c.get_visible=c.pia;c.set_visible=c.Pla;c.nk=k;c.Jia();return c}function Le(c,k){c=lh.call(this,c)||this;c.F$=null;c.W1e=null;c.H$=null;c.G$=null;c.get_visible=c.pia;c.set_visible=c.Pla;c.nk=k;c.Jia();return c}
function we(){}function za(c,k,D,ba){c=Ch.call(this,c)||this;c.Hqb=null;c.XFd=null;c.Wia=!1;c.disposed=!1;c.TKa=!1;c.Kh=null;c.selectedRanges=k;c.NNb=D;c.command=ba;3===ba&&(c.Wia=!0);c.hc=2;c.Qt=!1;return c}function Nb(c,k,D,ba,Ba,nb,Rb,Ic){Ic=c.Na(9,void 0===Ic?null:Ic);Ic.selectedRanges=k;Ic.ruleOptions=D;return hg.i(c,"CreateOrEditDataValidation",Ic,ba,Ba,nb,Rb,0)}function bb(c,k,D){k=Ui.call(this,k)||this;k.oua=null;k.$$b=null;k.tS=null;k.PJ=null;k.Uwa=null;k.Vwa=null;k.y2a=null;k.pLa=null;k.f7a=
null;k.OMa=null;k.Jjc=null;k.uvd=null;k.rnh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];k.e3i=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];k.get_visible=k.pia;k.set_visible=k.Pla;k.$P=new Tf.a;k.$P.add(de.a.instance.da(1601));k.$P.add(de.a.instance.da(1602));k.$P.add(de.a.instance.da(1605));k.$P.add(de.a.instance.da(1603));k.$P.add(de.a.instance.da(1604));k.$P.add(de.a.instance.da(1606));
k.$P.add(de.a.instance.da(1607));k.$P.add(de.a.instance.da(1608));k.$P.add(de.a.instance.da(1609));k.$P.add(de.a.instance.da(1610));k.$P.add(de.a.instance.da(1611));k.$P.add(de.a.instance.da(1612));k.$P.add("");k.$=c;k.nk=D;k.Jia();return k}function Ub(){}function kc(c,k){this.MA=this.gZa=this.selectedRanges=null;this.DBe=!1;this.Kh=null;this.$=c;this.Q_c=k}function ad(c){this.R3=(c=void 0===c?null:c)?c.IsIgnoreBlank:!0;this.S3=c?c.IsInCellDropDown:!0;this.HM=c?c.LowerBoundary:"";this.IM=c?c.UpperBoundary:
"";this.tA=c?c.ConditionType:0;this.ruleType=c?c.RuleType:0;this.IY=c?c.IsAlertBlocking:!0;this.sS=c?c.AlertTitle:"";this.rS=c?c.AlertMessage:"";this.iU=c?c.InputMessage:"";this.$D=c?c.InputTitle:"";this.a4=c?c.IsShowErrorAlert:!0;this.b4=c?c.IsShowInputMessage:!0}function Qd(c){switch(c){case 0:c="AnyValue";break;case 1:c="WholeNumber";break;case 2:c="Decimal";break;case 3:c="List";break;case 4:c="Date";break;case 5:c="Time";break;case 6:c="TextLength";break;case 7:c="Custom";break;default:c="Unknown"}return c}
function We(c){switch(c){case 0:c="Between";break;case 1:c="NotBetween";break;case 2:c="Equal";break;case 3:c="NotEqual";break;case 4:c="GreaterThan";break;case 5:c="LessThan";break;case 6:c="GreaterThanOrEqual";break;case 7:c="LessThanOrEqual";break;default:c="Unknown"}return c}function Ke(c){var k=Li.call(this)||this;k.$=c;k.Yb();return k}function nf(c,k,D){this.Esc={};this.Bd=!1;this.$=c;this.contextMenuController=D;this.KZd=new Pe(this.$);c.ea.Ia(8,this);for(D=0;D<k.length;D++)this.Esc[nf.aQg[D]]=
k[D];this.ga=ze.g(c).ga;this.ga.dVb(Object(xd.a)(this,this.Uk,"onContextMenu"));this.$.Ka.NDa(Object(xd.a)(this,this.Clf,"onContextMenuClosed"));Je.a.instance.D$i();ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.mkb(Object(xd.a)(this,this.twa,"onCommandExecutionStarting"));ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.j1(Object(xd.a)(this,this.P4,"onApplicationModeChanged"))}
function Pe(c){this.pKe=null;this.$=c;this.Zva=new Sg;ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.pKe=new hf(this.$))}function hf(c){this.RWa=null;this.QJd=!1;this.Dxb=0;this.p3c=1;this.lEe=0;this.$=c;this.gridView=ze.g(this.$);this.jUh();this.f$g=this.$.ya.AutoFilterEventRegistrationTimeLimit}function Vf(){this.Rd=this.Uke=this.cell=null}function Sg(){this.U9b={}}function wg(){this.menuModel=
null;this.Ywe=0}function Ef(){this.dictionary=this.Zd=null}function Fg(c){var k=Md.call(this)||this;k.n1e=!1;k.$=c;k.Yb();return k}function xf(c,k){this.Mnb=k;this.$=c}function Uf(c){return vd.call(this,c)||this}function Gg(c,k,D,ba){c=qa.call(this,c,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Gg.Rpj,!0,!1,Gg.ZEb,k,D,!1,ba)||this;c.WYa=0;c.Mqa=null;c.rIa=null;c.UBe=null;return c}function Eg(c,k,D){this.type=c;this.$Pg=k;this.Mo=D}function ig(c,k,D,ba){return O.call(this,c,"PopulateSlicerContextMenu",
-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",k,D,!0,ba)||this}function sg(c,k,D,ba){c=xj.call(this,c,"PopulateSheetOpsContextMenu",274207288,-1497523576,"SheetOpsContextMenu",!0,!1,"SheetTabContextMenuRootName",k,D,!1,ba)||this;c.Tbc=!1;c.ldc=!1;return c}function yg(c,k,D,ba){k=Jh.call(this,c,"PopulateRichTextContextMenu",679816325,1151222423,"RichTextContextMenu",!0,!1,"RichTextContextMenu",k,D,!0,ba)||this;k.grid=ze.g(c);return k}function Yd(c,k,D,ba){k=ud.call(this,
c,"PopulateTableFieldListContextMenu",-751848458,-1085236154,"TableFieldListContextMenu",!0,!1,"TableFieldListContextMenuRoot",k,D,!1,ba)||this;k.U0b=null;k.Trd=0;k.jRb=null;k.grid=ze.g(c);return k}function Sc(c,k,D,ba){k=Fh.call(this,c,"PopulatePivotTableContextMenu",-1475408662,1114549926,"PivotTableContextMenu",!0,!1,"PivotTableContextMenuRootName",k,D,!0,ba)||this;k.Tc=null;k.activeCell=null;k.oxc=null;k.vdc=!1;k.xhd=!1;k.expandCollapse=!1;k.refresh=!1;k.hY=!1;k.Rf=null;k.Xy=null;k.zYa=null;k.xb=
null;k.S7a=null;k.V$=!1;k.h5g=new DOMParser;k.Lcj=!0;k.grid=ze.g(c);k.bgc=!0;return k}function Ag(c,k,D,ba){return Ue.call(this,c,"PopulatePivotContextMenu",2123758504,912277356,k,D,ba)||this}function Jg(c,k,D,ba){c=$e.call(this,c,"PopulateFieldWellContextMenu",1374696078,495005930,"FieldWellContextMenu",!0,!1,"FieldWellContextMenu",k,D,!1,ba)||this;c.cell=null;c.Nn=null;c.$n=null;c.externalSourceIndex=-1;c.hTd=-1;c.bQa=0;c.Usc=-1;c.tK=null;c.isOlap=!1;c.MG=!1;c.z_a=!1;return c}function je(c,k,D,
ba,Ba,nb,Rb,Ic,Wc){Ba=Ae.call(this,Ba,de.a.instance.Bb(60),!0,2,!0)||this;Ba.zSf=!0;Ba.vbe=null;Ba.RPa=null;Ba.hea=null;Ba.Hob=null;Ba.K_c=null;Ba.bMc=null;Ba.cell=c;Ba.$n=k;Ba.externalSourceIndex=D;Ba.J4f=ba;Ba.Zd=nb;Ba.Cga=Rb;Ba.isOlap=Ic;Ba.MG=Wc;return Ba}function dg(c,k,D){D=void 0===D?null:D;this.Vib=this.ejb=null;this.f0=-1;this.oi=c;this.fX=(void 0===k?null:k)||new Tf.a;this.Kkg=D||new og;this.dDa=new Tf.a;c=0;k=Ol(this.fX);for(D=k.next();!D.done;D=k.next()){D=D.value;this.Qkd(this.f0)||(this.f0=
c);var ba=c++;this.dDa.add(new ke(document.createElement("li"),D.title,this.RTg(ba)))}}function ke(c,k,D){this.oi=c;this.Uo=k;this.zAc=D;this.Xda=document.createElement("a");Fd.a.qqc(this.Xda,this.Uo);Sys.UI.DomElement.addCssClass(this.Xda,Qf.Wnj);Sys.UI.DomElement.addCssClass(this.oi,Qf.Vnj);this.oi.appendChild(this.Xda);this.Xda.tabIndex=0;this.Fvc();vc.a.addHandler(this.oi,"click",this.zAc);vc.a.addHandler(this.oi,"keyup",Object(xd.a)(this,this.V6a,"onTitleKeyUp"))}function Qf(){}function og(){}
function Cf(c){c=T.call(this,c)||this;c.P6d=null;c.get_visible=c.pia;c.set_visible=c.Pla;c.Jia();return c}function Ea(){}function ob(c,k,D,ba,Ba,nb,Rb,Ic){c=mj.call(this,c)||this;c.kE=null;c.n1b=null;c.kXb=null;c.uVd=null;c.vVd=null;c.WXd=null;c.get_visible=c.pia;c.set_visible=c.Pla;c.$=k;c.cell=D;c.$n=ba;c.externalSourceIndex=Ba;c.Zd=nb;c.Cga=Rb;c.U3h=Ic;c.byj=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");c.Jia();return c}function wc(){}function zc(c,
k,D,ba,Ba){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=c;this.activeCell=k;this.pivotFieldTitle=D;this.summarizeBy=ba;this.showAsValueParameters=Ba}function Hd(c,k,D){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=c;this.baseFieldIndex=k;this.baseItemIndex=D}function Kd(){}function he(){}function Se(c,k,D,ba){return Ue.call(this,c,"PopulateFieldListPivotMenu",-1793121409,
1378457149,k,D,ba,"FieldListPivotFilterContextMenu")||this}function Ue(c,k,D,ba,Ba,nb,Rb,Ic){c=dh.call(this,c,k,D,ba,void 0===Ic?"PivotFilterContextMenu":Ic,!0,!1,"PivotFilterMenuRootName",Ba,nb,!1,Rb)||this;c.P0b=null;c.D$e=null;c.rjb=null;c.pivotData=null;c.bsd=null;c.phc=null;c.XYa=null;c.xba=null;c.csd=c.qhc=-1;c.wpe=c.gVc=-1;c.Hhe=c.q1=0;c.ou=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Ue.oM||(Ue.oM=new Vg(c.$),ze.g(c.$).Ca.Pp(Object(xd.a)(c,c.Be,"onBlockCacheItemChanged")),
ze.g(c.$).Ca.DF(Object(xd.a)(c,c.Vl,"onBlockCacheItemEvicted")),ze.g(c.$).Ca.nfa(Object(xd.a)(c,c.Be,"onBlockCacheItemChanged")));return c}function mf(){this.cell=null;this.dataSourceIndex=0;this.$n=this.pivotName=null}function Vg(c){this.$=c;this.oM={}}function Hf(c,k,D,ba){c=Yf.call(this,c,"PopulateFieldListContextMenu",-1045020714,-170383950,"FieldListContextMenu",!0,!1,"FieldListContextMenu",k,D,!1,ba)||this;c.Nn=null;c.tK=null;c.JY=!1;c.MG=!1;c.isOlap=!1;c.aNd=!1;return c}function Rg(c,k,D,ba){c=
zf.call(this,c,k,D,ba,"PopulateChartContextMenu",-498523270,1640762262,"ChartContextMenu")||this;c.Oya=!1;c.fua=!1;c.hY=!1;c.refresh=!1;c.isPivotChart=!1;return c}function zf(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd){Ic=void 0===Ic?xe.a.XPg:Ic;c=fd.call(this,c,void 0===Ba?"PopulateFloatingObjectContextMenu":Ba,void 0===nb?-2017893763:nb,void 0===Rb?1350204367:Rb,Ic,void 0===Wc?!0:Wc,void 0===Rd?!1:Rd,Ic,k,D,!0,ba)||this;c.floatingObject=null;c.yb=0;c.bgc=!0;return c}function gg(c,k,D,ba){c=m.call(this,c,"PopulateAutoFilterFieldListContextMenu",
474690375,216058793,gg.Lkh,!0,!1,gg.ZEb,k,D,!1,ba)||this;c.Ql=null;return c}function Xe(){}function If(){}function yf(c,k){c=Bf.call(this,c,2,0,null)||this;c.Tke=k;return c}function Bf(c,k,D,ba){this.egg=c;this.Uag=k;this.Yag=D;this.Ckg=ba}function Vb(){}function Qc(c,k,D,ba){c=tg.call(this,c,"PopulateAutoFilterContextMenu",1675506831,1651433993,"AutoFilterContextMenu",!0,!1,"AutoFilterContextMenuRoot",k,D,!1,ba)||this;c.XYa=null;c.sheetName=null;c.PQa=null;c.YQc=null;c.Hbf=!1;c.C_a=!1;c.axd=null;
c.cIb=null;c.B4c=null;c.r8b=null;c.YMa=null;c.nxe=null;c.t7a=null;c.h_c=null;c.ewb=ec.a.j3e();c.ou=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return c}function md(){this.top=this.left=0}function Ce(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function le(){this.autoFilterMenu=this.targetPoint=null}function Zd(){this.filterByValueItems=null;this.hasMoreRecords=
!1;this.searchText=null}function fg(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function Kg(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function $g(){this.isSuccess=!1}function pa(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function tb(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=
this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function qc(){this.Sections=this.Id=null}function jd(){this.ActiveCell=this.SelectedRange=null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function Sd(){this.RowColOffset=0;this.IsAscending=!1;this.CustomOrder=null;this.SortColor=
this.SortConditionType=0;this.FillGradient=null;this.SortIcon=this.SortIconSet=0;this.RichProperty=null}function ye(){}function Ye(c,k,D,ba){var Ba=this;this.RVd=this.j0=this.Fi=this.WC=this.U6=null;this.HSb=c;this.Ijg=ba;this.HSb.OJa&&(this.Fi=new Of.a(3,2,5E3,Object(xd.a)(this,this.cAg,"authenticationCheckTask"),2),Td.AFrameworkApplication.sj.kh(this.Fi),this.Lg(k,D));this.HSb.gkb(function(){Ba.Ujf()});this.HSb.RVa(function(){Ba.Vjf()})}function wf(){}function Ma(c){return Pb.call(this,c)||this}
function gb(c,k,D){var ba=Xa.call(this)||this;ba.$=c;ba.tableManager=k;ba.ji=D;return ba}function Wb(c,k){this.command=0;this.selectedRanges=null;this.command=c;this.selectedRanges=k}function Kc(c){return Ih.call(this,c)||this}function Bc(c){var k=vg.call(this)||this;k.$=c;return k}function Fb(c,k){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=c;this.type=k}function bc(c,k,D,ba,Ba,nb){if(k){var Rb=c.textBox;c.isEditing||c.startEdit(k,!0);c.ljd=!0;c.text=D;Rb.caretPosition=Ba;Ba<nb&&
(ba&&c.Wya(),Rb.selectRange(0,nb+1),Rb.selectRange(Ba,nb))}}function ge(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd){Rd=c.Na(9,Rd);Rd.selectedRange=k;Rd.activeCell=D;Rd.autoSumType=ba;Rd.topLeftCell=Ba;return hg.i(c,"AutoSum",Rd,nb,Rb,Ic,Wc,0)}function Jd(c,k,D,ba,Ba){if(0===ba)return{success:!1,reason:M.UnsupportedZeroResize};if(0>ba||0===D.length)return{success:!1,reason:M.InvalidInput};if(c.rZe())return{success:!1,reason:M.UnsupportedSkeletonInView};var nb=c.pf;if(!nb)return{success:!1,reason:M.NullSPD};var Rb=
nb.T9c(D);if(Rb&&0<Rb.length)return{success:!1,reason:Rb.length.toString()+" "+M.UnsupportedHiddenInRange};a:{Rb=Ol(D);for(var Ic=Rb.next();!Ic.done;Ic=Rb.next())Ic=Ic.value,Ba?Ic.right=wh.a.zh:Ic.bottom=wh.a.lh;Rb=c.g2("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",D);try{for(Rb.$$rst();Rb.$$mn();)if(Rb.jn.YUf){var Wc=!0;break a}}finally{Rb&&Rb.dispose()}Wc=!1}if(Wc)return{success:!1,reason:M.UnsupportedMergeCell};if(ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!Ba&&"undefined"!==typeof gridRenderer)for(Wc=Ol(D),Rb=Wc.next();!Rb.done;Rb=Wc.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Rb.value.left);c=c.Ca;Wc=Zh.a.create().toString();nb.dRd(D,ba,Ba);ba=c.uQd(Ba);k.wCf(D,Ba);c.Yyd(ba,Wc);return{success:!0}}b.r(F);var ue=b(509),qd=b(0),Ud=b(800),ed=b(15),xd=b(37),Lg=b(189),hg=b(81),Dg=b(79);Fb.prototype.j1a=function(){return this.sharedSheetRange};Object(qd.a)(Fb,"MacroRecorderAutoSumPayload",null,[115]);var cf=b(46),Hg=b(514),uh=
b(364),te=b(161),Wg=b(58),Kf=b(35),nd=b(148),qe=b(334),Qg=b(27),ae=b(1),Nh=b(173),wd=b(275),ze=b(20),Ah=b(155),Xh=b(592),pg=b(51),vg=Lg.a;Em(Bc,vg);Bc.prototype.Wc=function(){return!1};Bc.prototype.executeCommand=function(c,k,D){c=k.command;switch(c){case 1220954656:k=this.AAe(0,k);break;case -1537138325:k=this.AAe(parseInt(D[Dg.a.Md].toString()),k);break;default:k=Nh.a(c)}return k};Bc.prototype.Ec=function(c,k){if(c=1===c)switch(k.command){case 1220954656:case -1537138325:break;default:c=!1}return c};
Bc.prototype.Yc=function(){return!1};Bc.prototype.AAe=function(c,k){function D(){return new Fb(Rb,c)}var ba=this,Ba=ze.g(this.$);Ba.wi.PF(!1);if(!ze.g(this.$).ga.wa.xh)return ed.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",c,ze.g(this.$).ga.wa.MJ),this.kxa(),pg.Task.Ra(!1);var nb=Ba.oG();if(!nb)return null;var Rb=cf.v(Ba.ga.wa.Nd,this.$),Ic=cf.o(Ba.ga.wa.activeCell,this.$),Wc=cf.o(nb,
this.$),Rd=this.$.ra.ua.Wb();return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5691267_AllowAutoSumOnProtectedSheet")&&!this.$.Xs(Ba.ga.wa.selectedRanges,!0)?pg.Task.Ra(!1):ae.EwaSettings.pc()?uh.a(this.$.userOperationManager,function(Ge,df,Wf){return ge(ba.$.ra.ua,Rb,Ic,c,Wc,wd.b(Ge,Object(xd.a)(ba,ba.Yjf,"onAutoSumSuccessCallback")),df,Wf,c,Rd)},function(Ge){return new te.a(502,0,Ge,64,D)},k):uh.a(this.$.userOperationManager,function(Ge,df,Wf){return ge(ba.$.ra.ua,Rb,Ic,c,Wc,wd.b(Ge,Object(xd.a)(ba,
ba.Yjf,"onAutoSumSuccessCallback")),df,Wf,c,Rd)},function(Ge){return new Hg.a(502,0,Ge,void 0,D)},k)};Bc.prototype.Yjf=function(c){var k=ze.g(this.$);if(c=c.Result){var D=cf.D(c.NewSelection),ba=cf.D(c.NewActiveCell);if(D&&ba)if(!c.Committed&&c.AutoSumFormula){var Ba=k.tc(ba);Ba&&(k.ga.updateSelection(D,ba,60),D=ba=cf.D(c.MarkedArea),k.OB=2,bc(k.uc,Ba,c.AutoSumFormula,!!D,c.FormulaMarkStart,c.FormulaMarkEnd),D&&ba&&k.ga.updateSelection(D,ba,0),k.uc.ljd=!1,Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.create(this.$.ea,
153,this.la,0,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager"),function(nb){nb.result.Spb(null)},this.la,3))}else k.ga.updateSelection(D,ba,60)}};Bc.prototype.kxa=function(){ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")&&Xh.a(Ah.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var c=Qg.a.gd(1,1,721,2093,0,371863010,"DiscontinuousSelectionBlocking");ae.EwaSettings.eA()?new qe.a(this.$,c):(c=new nd.ErrorDialog(this.$,
c),c.initialize(),c.mf())};Object(qd.a)(Bc,"AutoSumCommandHandler",Lg.a,[160]);var Ih=Ud.a;Em(Kc,Ih);Kc.prototype.Gd=function(){this.Ad([new Bc(this.$)])};Kc.ja=function(c){Ud.a.Yd(96,new Kc(c))};Object(qd.a)(Kc,"AutoSumCommandHandlerFactory",Ud.a,[]);var Eh=b(12),Zh=b(196),ih=b(371),eg=b(36),oh=b(315);Wb.prototype.jt=function(){return this.command};Object(qd.a)(Wb,"MacroRecorderRangeOperationAppliedPayload",null,[115]);var Hh=b(303),X=b(70),Xa=eg.a;Em(gb,Xa);gb.prototype.yrg=function(c){this.addHandler("ekcvc",
c)};gb.prototype.uTi=function(c){this.removeHandler("ekcvc",c)};gb.prototype.Wc=function(){return!1};gb.prototype.executeCommand=function(c,k){c=k.command;switch(c){case -730106152:k=this.acd(k,3);break;case -1228228458:k=this.acd(k,4);break;case -848953656:case 2045211913:if(this.H4h()){k=pg.Task.Ra(!0);break}k=this.acd(k,1);break;default:k=Nh.a(c)}return k};gb.prototype.Ec=function(c,k){if(c=1===c)switch(k.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:c=
!1}return c};gb.prototype.Yc=function(){return!1};gb.prototype.Api=function(c,k){if(!Hh.a(c)&&k){var D=!!c&&!!c.RequestTelemetryData;ze.g(this.$).vi.Kja(k.toString(),c.StateId,D?c.RequestTelemetryData.EcsOperationDuration:0,D?c.RequestTelemetryData.EcsRequestDuration:0,D?c.RequestTelemetryData.WfeRequestDuration:0)}};gb.prototype.acd=function(c,k){function D(){return new Wb(k,Rd)}function ba(df,Wf,Pg){Ba.$.Es();return hg.f(Ba.$.ra.ua,k,Rd,!1,wd.b(df,Object(xd.a)(Ba,Ba.Api,"onClearCellFormatOperationWebMethodSuccess")),
Wf,Pg,Wc,Ge)}var Ba=this,nb=ze.g(this.$),Rb=nb.ga.wa.selectedRanges,Ic=c.command,Wc=Zh.a.create().toString();if(!this.$.Xs(Rb,!0)&&-730106152!==Ic)return pg.Task.Ra(!0);var Rd=cf.r(Rb,this.$);this.Mgj(Ic,nb,Rb,Wc);ae.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.sLi();var Ge=this.$.ra.ua.Wb(!0);return ae.EwaSettings.pc()?uh.a(this.$.userOperationManager,ba,function(df){return new te.a(508,0,df,67,D)},c):uh.a(this.$.userOperationManager,ba,function(df){return new Hg.a(508,
0,df,3,D)},c)};gb.prototype.Mgj=function(c,k,D,ba){var Ba=this;if(-848953656!==c&&2045211913!==c&&-730106152!==c&&-1228228458!==c)ed.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",c);else if(!ih.a.any(D,function(Rb){return 0<k.getRangeInformation(Rb).length})){var nb=ih.a.any(D,function(Rb){return Ba.tableManager.ukd(Rb)});if(-730106152!==c&&-1228228458!==c||!nb)this.Pkj(k,c,ba,D),-730106152!==c&&-1228228458!==c||this.ji.bma(k,-730106152,{}),
-1228228458!==c&&2045211913!==c&&-848953656!==c||this.ji.zLg(D,ba),k.vi.u_(ba,X.BasicTelemetryCalculator.JP)}};gb.prototype.Pkj=function(c,k,D,ba){var Ba="";switch(k){case -1228228458:Ba="ClearAll";break;case 2045211913:case -848953656:Ba="ClearContent";break;case -730106152:Ba="ClearFormat";break;default:ed.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",k)}k=ba.length;ba=cf.b(ba);c.vi.g6(15,D,Ba+(", ranges to clear: "+k+", cells to clear: "+
ba))};gb.prototype.sLi=function(){this.raiseEvent("ekcvc",new oh.a)};gb.prototype.H4h=function(){if(ze.g(this.$).sy){var c=this.$.ea.Ba(296);return!!c&&c.qT.bA}return!1};Object(qd.a)(gb,"ClearCommandHandler",eg.a,[160,706]);var Pb=Ud.a;Em(Ma,Pb);Ma.prototype.Gd=function(){var c=this,k=Wg.GetServiceTaskFactory.create(this.$.ea,134,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),D=Wg.GetServiceTaskFactory.create(this.$.ea,18,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction");
Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([k,D],this.la),function(){var ba=new gb(c.$,k.result,D.result);c.Ad([ba]);c.$.ea.Ia(313,ba)},this.la,3)};Ma.ja=function(c){Ud.a.Yd(101,new Ma(c))};Object(qd.a)(Ma,"ClearCommandHandlerFactory",Ud.a,[]);var Gc=b(896),Hc=b(875),Ld=b(846),Ie=b(1132);wf.prototype.KWg=function(c,k){if(c&&!(1>c.length)&&k){var D=Object.assign(new Ld.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.fUg(c,D.ControlList);k.push(D)}};wf.prototype.fUg=function(c,k){var D=Object.assign(new Gc.a,
{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Hc.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(k,D);k=Object.assign(new Ld.a,{Title:"",ControlList:[]});Array.add(D.Menu.MenuSectionList,k);this.rWg(c,k.ControlList)};wf.prototype.rWg=function(c,k){for(var D=0;D<c.length;D++){var ba=Object.assign(new Ie.a,{ExternalId:String.format("CoauthorPersona_{0}",D),Command:"336231556",DisplayName:c[D].userName,
LabelText:c[D].userName,ImageBackColor:c[D].color,PersonaId:c[D].email,IsAnonymous:c[D].isAnonymous});Array.add(k,ba)}};Object(qd.a)(wf,"PresenceContextMenuSectionBuilder",null,[712]);var Td=b(5),Re=b(169),ff=b(577),Of=b(109),kg=b(128),Rf=b(86),Ig=b(88),ya=b(108),oa=b(28);Ye.prototype.Lg=function(c,k){var D=Td.AFrameworkApplication.Hb;D.Af(oa.a.authenticationLost,ya.a.frame,c,96);D.Af(oa.a.Oke,ya.a.frame,k,96);D.Xb(oa.a.zoe,ya.a.frame,Re.ActionManager.s1c);D.Xb(oa.a.Aoe,ya.a.frame,Re.ActionManager.s1c);
D.Xb(oa.a.rmd,ya.a.frame,Re.ActionManager.s1c)};Ye.prototype.Ujf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);Td.AFrameworkApplication.Hb.processAction(oa.a.authenticationLost,2)};Ye.prototype.Vjf=function(){this.Aoj();Td.AFrameworkApplication.Hb.processAction(oa.a.Oke,2)};Ye.prototype.cAg=function(){this.HSb.authenticationCheck()};Ye.prototype.Aoj=function(){this.WC&&(this.WC.hide(),this.WC.dispose(),this.WC=null);this.U6&&this.businessBar&&(Td.AFrameworkApplication.Fg||
this.businessBar.removeEntry(this.U6),this.U6.dispose(),this.U6=null)};Ye.prototype.showDialog=function(c){Rf.a.Fa(this.WC);this.WC=new kg.StandardDialog;this.Ijg||(this.WC.lu=!1,this.WC.hc=0);this.WC.yc(1,CommonUIStrings.l_SignIn);this.WC.WV(CommonUIStrings.l_DefaultDialogTitle,c,Object(xd.a)(this,this.sv,"dialogHandler"))};Ye.prototype.sv=function(c){1===c?(ff.a.j5(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),Td.AFrameworkApplication.Hb.processAction(oa.a.rmd,2)):
(this.uHb(),Td.AFrameworkApplication.Hb.processAction(oa.a.Aoe,2))};Ye.prototype.uHb=function(){this.businessBar&&this.Sme&&(this.U6=this.Sme.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.U6.closeable=!0,this.U6.addButton(CommonUIStrings.l_SignIn,Ye.uFg,""),this.U6.X8=Object(xd.a)(this,this.wFg,"businessBarEntryCloseHandler"),this.businessBar.fD(this.U6,!1))};Ye.prototype.wFg=function(){this.i3g();Td.AFrameworkApplication.Hb.processAction(oa.a.zoe,
2)};Ye.prototype.i3g=function(){this.Fi&&(Td.AFrameworkApplication.sj.cp(this.Fi),this.Fi=null)};Ye.prototype.dispose=function(){this.Fi=this.WC=this.U6=null};Ye.uFg=function(){ff.a.j5();Td.AFrameworkApplication.Hb.processAction(oa.a.rmd,2)};Ll.Object.defineProperties(Ye.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.j0||(this.j0=Ig.a.instance.Mh("CommonUI.IBusinessBar"))}},Sme:{configurable:!0,enumerable:!0,get:function(){return this.RVd||(this.RVd=Ig.a.instance.Mh("CommonUI.IBusinessBarEntryFactory"))}}});
Object(qd.a)(Ye,"SignOutResponseUI",null,[6]);var yb=b(276);ye.prototype.Qh=function(c){c.register(wf,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").wc()};ye.prototype.init=function(){};ye.prototype.dispose=function(){Rf.a.Fa(ye.N0);ye.N0=null};ye.main=function(){yb.a.instance.ej(new ye)};Ll.Object.defineProperties(ye.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});ye.N0=null;Object(qd.a)(ye,"CommonAppUIPackage",
null,[8,9]);var Dd=b(142);Object(qd.a)(Sd,"SharedSortCondition",null,[]);Object(qd.a)(jd,"SharedSortOptions",null,[]);var ie=b(826),xe=b(4),Lf=b(456),ph=b(583),Sf=b(55),Zg=b(1170),Bh=b(125),ti=b(859),ci=b(141),fi=b(126),$h=b(197),Th=b(92),mg=b(68),rg=b(32),af=b(7),de=b(16),Fi=b(63),f=b(127),hb=b(261),ec=b(910),$c=b(911),be=b(132),ve=b(49),De=b(34),Me=b(409);Object(qd.a)(qc,"AutoFilterMenu",null,[]);Object(qd.a)(tb,"MenuItem",null,[]);Object(qd.a)(pa,"MenuSection",null,[]);Object(qd.a)($g,"ApplyFilterByValueResponse",
null,[]);Object(qd.a)(Kg,"FilterByValueItem",null,[]);Object(qd.a)(fg,"GetColorsAndIconsResponse",null,[]);Object(qd.a)(Zd,"GetFilterByValueItemsResponse",null,[]);Object(qd.a)(le,"ShowSortFilterMenuParams",null,[]);Object(qd.a)(Ce,"SortFilterControllerFactoryParams",null,[]);Object(qd.a)(md,"TargetPoint",null,[]);var sf=b(332),tg=ie.a;Em(Qc,tg);Qc.prototype.executeCommand=function(c,k,D){var ba=this;c=k.command;switch(c){case 1701016594:ie.a.Zih(D);break;case 966232027:var Ba=D.domEvent;if(mg.e(Ba.rawEvent)&&
mg.e(Ba.rawEvent)&&(mg.g(Ba),Ba.target&&(c=new ci.a(this.$.va),c.we(4096)||c.we(2048)))){var nb=Sf.a.Xh(D[Dg.a.Hj]);this.XRf(nb)&&(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")?this.Hbf?(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5680883_trackInteractivityFilterMenuOnlySync")&&hb.a(this.$).Bma(Ba.rawEvent,"open_menu_auto_filter"),this.znc(Ba,Ba.target,nb,k)):(this.axd=function(){ba.XRf(nb)&&(ba.PWh(),ba.znc(Ba,Ba.target,nb,k),ba.C_a=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",
!1),ba.Hbf=!0)},this.Qsc()):this.lN(Ba,Ba.target,nb,k,!0))}break;default:return Nh.a(c)}return pg.Task.Ra(!0)};Qc.prototype.Ec=function(c,k,D){if(c=!!D)switch(k.command){case 1701016594:case 966232027:Lf.a(this.$)||(c=!1,ed.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",ve.b().$h(k.command)));break;default:c=!1}return c};Qc.prototype.lN=function(c,k,D){ed.ULS.shipAssertTag(537167136,0,!!D,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");
this.XYa=this.ruh(D);this.ou&&!D.IsHeaderSnapped?this.wn(ie.a.h7b(this.$,D.Cell,!0),!0):tg.prototype.lN.call(this,c,k,D,null,!0)};Qc.prototype.Mwd=function(c){Array.addRange(c.MenuSectionList,this.XYa)};Qc.prototype.PWh=function(){var c=this;Me.a(function(){c.cIb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object.assign(new Ce,{getFilterByValueItemsRequest:Object(xd.a)(c,c.$si,"onGetFilterByValueItems"),applyFilterByValueRequest:Object(xd.a)(c,c.loi,"onApplyFilterByValue"),
onMenuItemClick:Object(xd.a)(c,c.onMenuItemClick,"onMenuItemClick"),autoFilterMenuWidth:Qc.Ske,applySortByColorOrIconRequest:Object(xd.a)(c,c.ayg,"applySortByColorOrIcon")}))});this.B4c=Ig.a.instance.Mh("Common.IExternalUICommandDefinitionMapping")||new ph.a(this.$.Jb,this.$)};Qc.prototype.znc=function(c,k,D){f.b(this.$).ee(Bh.a.znc,this.ln(),void 0,!0);ed.ULS.shipAssertTag(537167135,0,!!D,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");c=this.quh(D);var ba=Sys.UI.DomElement.getBounds(k),
Ba=ba.x+ba.width;ba=ba.y;this.ou&&!D.IsHeaderSnapped&&(D=ie.a.h7b(this.$,D.Cell,!0),Ba=D.x,ba=D.y);D=ze.g(this.$).rtl?new Sys.UI.Point(Ba-De.a(this.$).VDa(Qc.Ske),ba):new Sys.UI.Point(Ba,ba);this.fRa(D,k);D=De.a(this.$).xIa(D);k=Object.assign(new le,{targetPoint:Object.assign(new md,{left:D.x,top:D.y}),autoFilterMenu:c});this.cIb.showSortFilterMenu(k);this.$.De(-544117314,-1,0,null)};Qc.prototype.XRf=function(c){return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")?
!c.Cell.SheetName||c.Cell.SheetName===this.$.qa.sheetName:!0};Qc.prototype.quh=function(c){return(c=this.jOe(c))?this.Qyf(c):null};Qc.prototype.Qyf=function(c){for(var k=[],D=Ol(c.Sections),ba=D.next();!ba.done;ba=D.next())ba=this.pJi(ba.value),Array.add(k,ba);return Object.assign(new qc,{Id:c.Id,Sections:k})};Qc.prototype.pJi=function(c){for(var k=[],D=Ol(c.MenuItems),ba=D.next();!ba.done;ba=D.next())if(ba=ba.value,2===ba.Identifier)this.YQc=ba.CommandData;else switch(ba.Type){case 3:case 2:Array.add(k,
this.nJi(ba,2===ba.Type));break;case 1:Array.add(k,this.oJi(ba))}return Object.assign(new pa,{MenuItems:k,DisplayType:c.DisplayType,Id:this.Prh(c)})};Qc.prototype.oJi=function(c){var k=this.qNe(c);var D=k.label;var ba=k.oJa;k=this.Qyf(c.SubMenu);var Ba=this.eNe(c);ba=this.B4c.getExternalIconIdByLegacyIconId(ba);D=D||c.Label;return Object.assign(new tb,{Disabled:c.Disabled,Type:c.Type,Identifier:c.Identifier,Id:Ba,CommandData:c.CommandData,Label:D,SubMenu:k,IsChecked:c.IsChecked,IconName:"MissingIcon_20"===
ba?null:ba})};Qc.prototype.nJi=function(c,k){var D=this.s6b(c,k&&c.IsChecked);k=D.label;var ba=D.oJa;D=D.Mo;var Ba=this.D7c(c,k);ba=this.B4c.getExternalIconIdByLegacyIconId(ba);return Object.assign(new tb,{Disabled:c.Disabled,Type:c.Type,Identifier:c.Identifier,Id:Ba,RibbonCommand:D,CommandData:c.CommandData,Label:k||c.Label,SubMenu:null,IsChecked:c.IsChecked,IconName:"MissingIcon_20"===ba?null:ba})};Qc.prototype.jOe=function(c){var k;this.PQa=k=cf.C(c.Cell);this.sheetName=this.$.qa.sheetName;if(c.IsHeaderSnapped)k=
Lf.a(this.$).e5b.gBh(k);else{var D=ze.g(this.$).Ca.g8b(k);if(!D)return this.ewb?ec.a.l9a($c.a.bBf,Ah.a.AMh,be.a.SWa,!0,!1):ed.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",k,ze.g(this.$).view.visibleArea),null;k=D.autoFilterMenu}if(!k)return this.ewb?ec.a.l9a($c.a.bBf,Ah.a.Ihi,be.a.SWa,!0,!1):ed.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.gpb=c.Cell.FirstRow+"_"+c.Cell.FirstColumn;return k};Qc.prototype.ruh=function(c){return(c=this.jOe(c))?this.Fpd(c.Sections):null};Qc.prototype.Qsc=function(){var c=this;if(this.$.fa.Wh){var k=Wg.GetServiceTaskFactory.Va(this.$.ea,283,284,1,"Common.IDynamicScriptLoaderProvider");Kf.TaskExtensions.Aa(k,function(){c.ewb?k.result.Cp.loadScript("sortFilter").then(function(){c.axd()},function(D){Fi.a.Yl(D,"AutoFilterContextMenu.SortFilterScriptLoad");ec.a.l9a($c.a.Qsc,Ah.a.Tjj,be.a.SWa,!1,!1)}):
Kf.TaskExtensions.Aa(sf.c(k.result.Cp.loadScript("sortFilter")),function(){c.axd()},c.$.la,3)},this.$.la,3)}else this.$.fa.oo(Object(xd.a)(this,this.vM,"onAppInteractive"))};Qc.prototype.vM=function(){this.Qsc();this.$.fa.Er(Object(xd.a)(this,this.vM,"onAppInteractive"))};Qc.prototype.$si=function(c){function k(Rd,Ge,df){D.h_c=hg.t(D.$.ra.ua,ba,wd.b(Rd,Rb),D.C_a?wd.a(Ge,Ic):Ge,df,null,Wc);return D.h_c}var D=this;this.C_a||f.b(this.$).ee(Bh.a.snf,this.ln(),void 0,!0);var ba=Sf.a.Xh(this.YQc);ba.SheetName=
this.sheetName;ba.NamedObjectView=this.$.fa.isNamedObjectViewMode;var Ba=!af.a.ma(c.searchText),nb=586;this.C_a&&(Ba&&(ba.ItemListOptions=this.zSg(c.searchText),nb=597),c={},f.b(this.$).ee(Bh.a.snf,(c.UserOperation=nb.toString(),c),void 0,!0));var Rb=this.ztd(Ba),Ic=this.ati(),Wc=this.$.ra.ua.Wb();this.nxe=Wc.RequestId;this.C_a&&this.r8b&&!this.r8b.dequeueUtcTime&&(this.$.userOperationManager.oZa(this.r8b),this.YHg());Ba=ae.EwaSettings.pc()?new te.a(nb,0,k,80):new Hg.a(nb,0,k,16);this.r8b=this.$.userOperationManager.jc(Ba,
null);this.t7a=this.h_c;this.YMa=this.nxe};Qc.prototype.zSg=function(c){var k={};k.SearchText=c;k.Page=1;k.DateNodeType=-1;return k};Qc.prototype.YHg=function(){this.YMa&&(ed.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",this.YMa),hg.j(this.$.ra.ua,this.YMa,null,null,null),this.YMa=null);this.t7a&&(Td.AFrameworkApplication.Cd.Ku(this.t7a.Tt),this.t7a=null)};Qc.prototype.onMenuItemClick=function(c,
k,D){f.b(this.$).ee(Bh.a.Jxi,this.ln(),void 0,!0);var ba={};k=(ba.CommandValueId=k,ba.MenuItemId=k,ba.InputMethod=D,ba.TopCellAddress=this.PQa,ba);ba=new Th.a(c,D,this.$.isEditMode?2:1,19,null);this.$.Ka.Ub(ba,k);ed.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",c,D)};Qc.prototype.loi=function(c){var k=this;if(c.checkedItems&&c.checkedItems.length){f.b(this.$).ee(Bh.a.moi,this.ln(),void 0,!0);var D=Sf.a.Xh(this.YQc),ba={};this.$.Mj(ba);ba.FirstRow=0;ba.FirstColumn=
D.Column;var Ba=this.$.fa.isNamedObjectViewMode;D.NamedObjectView=Ba;D.SheetName=Ba?ba.NamedObjectName:ba.SheetName;var nb=function(Wc){if(ec.a.SJd(Wc)){var Rd=ec.a.e8c(Wc);k.ewb?ec.a.l9a($c.a.applyItemFilter,Rd.MessageIdName,be.a.oEa,!0,ec.a.isSessionEndingError(Rd.MessageId)):ed.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Rd.MessageIdName)}Hh.a(Wc)||(ed.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),
f.b(k.$).ee(Bh.a.Csi,k.ln(),void 0,!0),Wc=Object.assign(new $g,{isSuccess:!0}),k.cIb.onApplyFilterByValueFinish(Wc),k.$Q(k.PQa))},Rb=this.ASg(D,ba),Ic=new te.a(208,0,function(Wc,Rd,Ge){return hg.a(k.$.ra.ua,Rb,c.checkedItems,wd.b(Wc,nb),Rd,Ge,null,null)},6,function(){return new Zg.a(c.checkedItems,Rb)});this.vTf(function(){k.$.userOperationManager.jc(Ic,null)})}else ed.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Qc.prototype.ztd=
function(c){var k=this;return function(D){k.YMa=null;k.t7a=null;if(ec.a.SJd(D)){var ba=ec.a.e8c(D);k.ewb?ec.a.l9a(c?$c.a.searchAutoFilterItemList:$c.a.getAutoFilterItemList,ba.MessageIdName,be.a.SWa,!0,!0):ed.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",ba.MessageIdName)}if(!Hh.a(D)){ed.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");D=D.Result;ba=new rg.a(!0);
var Ba=D.AutoFilterDateNodes?!0:!1;D.AutoFilterItems&&ba.add("AutoFilterItemsCount",D.AutoFilterItems.length);Ba&&ba.add("AutoFilterDateItemsCount",D.AutoFilterDateNodes.length);ba.add("Location","contextMenu");f.b(k.$).ee(Bh.a.ztd,ba.su,void 0,!0);ba=k.C_a?Object.assign(new Zd,{filterByValueItems:k.Tte(D),hasMoreRecords:D.ItemListMaxExceeded,searchText:D.SearchText}):Object.assign(new Zd,{filterByValueItems:k.Tte(D),hasMoreRecords:D.ItemListMaxExceeded});k.cIb.onGetFilterByValueItemsFinish(ba);!c&&
ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SortByColor",!1)&&(ed.ULS.shipAssertTag(529063959,0,null!==D.FontColors&&null!==D.CellColors&&null!==D.Icons&&null!==D.SelectedSortFontColors&&null!==D.SelectedSortCellColors&&null!==D.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),D=Object.assign(new fg,{fontColors:D.FontColors,cellColors:D.CellColors,icons:D.Icons,selectedSortFontColor:0<D.SelectedSortFontColors.length?
D.SelectedSortFontColors[0]:null,selectedSortCellColor:0<D.SelectedSortCellColors.length?D.SelectedSortCellColors[0]:null,selectedSortIcon:0<D.SelectedSortIcons.length?D.SelectedSortIcons[0]:null,getColorName:k.getColorName}),k.cIb.onGetColorsAndIconsFinish(D))}}};Qc.prototype.ati=function(){var c=this;return function(k){c.YMa=null;c.t7a=null;k=fi.a.xg(k.data);ed.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",Qg.a.Uc(k))}};Qc.prototype.Tte=
function(c){var k=this.pQg(c),D=this.wQg(c.AutoFilterItems),ba=[],Ba=0;c.HasBlanks&&(c=Qc.$Yc(de.a.instance.da(748),c.IsBlanksSelected?1:0,xe.a.Rke),ba[Ba++]=c);k=Ol(k);for(c=k.next();!c.done;c=k.next())c=c.value,ba[Ba++]=c;D=Ol(D);for(c=D.next();!c.done;c=D.next())k=c.value,ba[Ba++]=k;return ba};Qc.prototype.pQg=function(c){var k=[];if(!c.AutoFilterDateNodes||!c.AutoFilterDateNodes.length)return k;for(var D=[this.Q0a(c.YearKeys,c.YearValues),this.Q0a(c.MonthKeys,c.MonthValues),this.Q0a(c.DayKeys,
c.DayValues),this.Q0a(c.HourKeys,c.HourValues),this.Q0a(c.MinuteKeys,c.MinuteValues),this.Q0a(c.SecondKeys,c.SecondValues)],ba=!1,Ba=!1,nb=0,Rb=null,Ic=Array(6),Wc=null,Rd=Ol(c.AutoFilterDateNodes),Ge=Rd.next();!Ge.done;Ge=Rd.next()){Ge=Ge.value;Ic[0]&&(Wc.Year!==Ge.Year?(ba=!0,nb=0,Rb=null):Wc.Month!==Ge.Month?(Ba=!0,nb=1,Rb=Ic[0]):Wc.Day!==Ge.Day?(nb=2,Rb=Ic[1]):c.ShowTime&&(Wc.Hour!==Ge.Hour?(nb=3,Rb=Ic[2]):Wc.Minute!==Ge.Minute?(nb=4,Rb=Ic[3]):(nb=5,Rb=Ic[4])));for(;6>nb;){switch(nb){case 0:var df=
Ge.Year;Wc=D[0].getItem(df.toString());break;case 1:df=Ge.Month;Wc=D[1].getItem(df.toString());break;case 2:df=Ge.Day;Wc=D[2].getItem(df.toString());break;case 3:df=Ge.Hour;Wc=D[3].getItem(df.toString());break;case 4:df=Ge.Minute;Wc=D[4].getItem(df.toString());break;case 5:df=Ge.Second;Wc=D[5].getItem(df.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Wc=Qc.$Yc(Wc,-1!==Ge.NodeType&&nb>=Ge.NodeType?1:0,Rb?Rb.key+";"+df:xe.a.WRc+df,!1,[]);Rb=Rb?Rb.children:
k;Rb=Rb[Rb.length]=Wc;Ic[nb]=Wc;switch(nb){case 5:nb=6;break;case 2:nb=c.ShowTime?nb+1:6;break;default:nb++}}Wc=Ge}ba||(Ic[0].expanded=!0,Ba||(Ic[1].expanded=!0));return k};Qc.prototype.wQg=function(c){var k=[];if(!c)return k;var D=0;c=Ol(c);for(var ba=c.next();!ba.done;ba=c.next())ba=ba.value,k[D++]=Qc.$Yc(ba.DisplayString,ba.Selected?1:0,xe.a.XRc+ba.DisplayString);return k};Qc.prototype.Q0a=function(c,k){var D=new rg.a(!0);if(!c||!k)return D;for(var ba=c.length<k.length?c.length:k.length,Ba=0;Ba<
ba;Ba++)D.add(c[Ba].toString(),k[Ba]);return D};Qc.prototype.ASg=function(c,k){var D={};D.Location=k;D.FieldId=c.Id.toString();D.DataSourceIndex=-1;D.FilterType=c.AutoFilterType;D.AnchorType=0;D.ChartId=null;D.AnchorValue1=-1;D.AnchorValue2=-1;D.Property=c.RichProperty;return D};Qc.prototype.$Q=function(c){ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.Va(this.$.ea,430,431,1,"Microsoft.Office.Excel.WebUI.Client.PivotTableHandRaise.IPivotTableHandRaiseManager"),
function(k){k.result.Ema(c);ed.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)};Qc.prototype.ln=function(){var c={};return c.Location="contextMenu",c};Qc.prototype.getColorName=function(c){return ti.a.sIa($h.a.eG(c))};Qc.prototype.ayg=function(c){var k=this,D=cf.o(this.PQa,this.$),ba=cf.v(this.PQa,this.$),Ba=Object.assign(new Sd,{SortConditionType:c.type,RowColOffset:D.FirstColumn-ba.FirstColumn,SortColor:c.color,
SortIconSet:c.icon.IconSet,SortIcon:c.icon.Icon,IsAscending:!0}),nb={SortOptions:Object.assign(new jd,{OperationType:1,ActiveCell:D,SelectedRange:ba,SortConditions:[Ba],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:ba,OriginalActiveCell:D,ShouldRestoreSelection:!1};ed.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",c.type);this.vTf(function(){var Rb={};k.$.De(1659552324,Dg.a.Tb,19,(Rb.CustomSortCommandData=nb,Rb))})};Qc.prototype.vTf=
function(c){Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.Va(this.$.ea,309,310,3,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewPublic"),function(k){k.result.PPa().continueWith(function(D){D.result&&c()})},this.$.la,3)};Qc.$Yc=function(c,k,D,ba,Ba){c=void 0===c?null:c;k=void 0===k?0:k;D=void 0===D?null:D;ba=void 0===ba?!1:ba;Ba=void 0===Ba?null:Ba;return Object.assign(new Kg,{displayText:af.a.ma(c)?c:ie.a.yq(c),state:k,key:D,parent:null,children:Ba,indentationLevel:0,expanded:ba})};
Ll.Object.defineProperties(Qc.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.$Af}}});Qc.Ske=268;Object(qd.a)(Qc,"AutoFilterContextMenu",ie.a,[]);var uf=b(833),Og=b(83),Tf=b(211),Xf=b(67),ia=b(18);Vb.kKe=26;Vb.K5c=[217,218,0,96,0,92,91];Object(qd.a)(Vb,"Constants",null,[]);Ll.Object.defineProperties(Bf.prototype,{B3h:{configurable:!0,enumerable:!0,get:function(){return 3===this.D0b}},P6h:{configurable:!0,
enumerable:!0,get:function(){return 4===this.D0b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.Ckg}},Off:{configurable:!0,enumerable:!0,get:function(){return this.egg}},D0b:{configurable:!0,enumerable:!0,get:function(){return this.Uag}},w_c:{configurable:!0,enumerable:!0,get:function(){return this.Yag}}});Object(qd.a)(Bf,"FiltersMenuData",null,[]);Em(yf,Bf);Object(qd.a)(yf,"AutoFilterFiltersMenuData",Bf,[]);If.Roj=[new Bf(97,2,0,null),new Bf(98,2,1,null),new Bf(0,
3,0,null),new Bf(169,2,2,null),new Bf(171,2,4,null),new Bf(0,3,0,null),new Bf(173,2,6,null),new Bf(174,2,7,null),new Bf(0,3,0,null),new Bf(105,0,0,null)];If.Fmi=[new Bf(97,2,0,null),new Bf(98,2,1,null),new Bf(0,3,0,null),new Bf(99,2,8,null),new Bf(100,2,10,null),new Bf(101,2,12,null),new Bf(0,3,0,null),new Bf(102,1,0,null),new yf(103,1),new yf(104,2),new Bf(0,3,0,null),new Bf(105,0,0,null)];If.n_g=[new Bf(97,2,0,null),new Bf(0,3,0,null),new Bf(109,2,10,null),new Bf(110,2,8,null),new Bf(101,2,12,null),
new Bf(0,3,0,null),new yf(107,8),new yf(106,9),new yf(108,10),new Bf(0,3,0,null),new yf(112,11),new yf(111,12),new yf(113,13),new Bf(0,3,0,null),new yf(114,14),new yf(115,15),new yf(116,16),new Bf(0,3,0,null),new yf(117,17),new yf(118,18),new yf(119,19),new Bf(0,3,0,null),new yf(120,20),new yf(121,21),new yf(122,22),new Bf(0,3,0,null),new yf(123,23),new Bf(124,2,12,[new yf(125,24),new yf(126,25),new yf(127,26),new yf(128,27),new Bf(0,3,0,null),new yf(129,28),new yf(130,29),new yf(131,30),new yf(132,
31),new yf(133,32),new yf(134,33),new yf(135,34),new yf(136,35),new yf(137,36),new yf(138,37),new yf(139,38),new yf(140,39)]),new Bf(0,3,0,null),new Bf(105,0,0,null)];Object(qd.a)(If,"Constants",null,[]);Xe.prototype.compare=function(c,k){return af.a.compare(c,k,!0)};Object(qd.a)(Xe,"IgnoreCaseComparer",null,[719]);var u=b(72),m=ie.a;Em(gg,m);gg.prototype.executeCommand=function(c,k,D){c=k.command;switch(c){case -699941697:this.applyAutoFilterFieldList(k,D);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");
break;case -1494291901:break;default:return Nh.a(c)}return pg.Task.Ra(!0)};gg.prototype.z8c=function(c,k){return!c||c.length<=k?(ed.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(c[k])};gg.prototype.ryd=function(c,k,D,ba,Ba,nb){var Rb=this.z8c(Ba,nb);0>Rb&&ed.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Vb.K5c[Rb]){case 96:c=new Th.a(-2058042992,k.method,k.mode,k.Ze,
k.tabName);this.Ql.KF.sqb(this.$,ba,0,c);break;case 217:c=new Th.a(504133448,k.method,k.mode,k.Ze,k.tabName);this.Ql.KF.sqb(this.$,ba,0,c);break;case 218:c=new Th.a(-798968736,k.method,k.mode,k.Ze,k.tabName);this.Ql.KF.sqb(this.$,ba,0,c);break;case 219:c=new Th.a(-1677817820,k.method,k.mode,k.Ze,k.tabName);this.Ql.KF.sqb(this.$,ba,0,c);break;case 92:this.dzf(c,k,ba,D,Ba,nb+1);break;case 91:this.Ql.KF.t$h(this.$,ba)}};gg.prototype.dzf=function(c,k,D,ba,Ba,nb){var Rb=this.z8c(Ba,nb);0>Rb&&ed.ULS.sendTraceTag(537167115,
0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!ba||Rb>=ba.length)ed.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(ba=ba[Rb],ba.D0b){case 1:this.Ql.KF.L$h(this.$,D);break;case 2:(Ba=Object(Og.a)(yf,ba))?(c=new Th.a(-2058042992,k.method,k.mode,k.Ze,k.tabName),this.Ql.KF.sqb(this.$,D,Ba.Tke,c)):this.Ql.KF.waf(this.$,c,D,ba.w_c);break;case 0:this.Ql.KF.waf(this.$,c,D,ba.w_c);break;case 4:this.dzf(c,
k,D,ba.subMenu,Ba,nb+1)}};gg.prototype.applyAutoFilterFieldList=function(c,k){var D=k[uf.a.EH];if(D)if(D=D.split(Xf.a.pT),3>D.length)ed.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var ba=this.z8c(D,1),Ba=this.fIa(ba),nb=this.Iff(ba).returnValue;nb?this.ryd(k,c,nb,Ba,D,2):ed.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+ba.toString()+
Xf.a.pT)}else ed.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};gg.prototype.Ec=function(c,k){if(c=this.$.isEditMode)switch(k.command){case 216058793:break;case -699941697:break;case -1494291901:c=!0;break;default:c=!1}return c};gg.prototype.lN=function(c,k,D){this.$.isEditMode&&((this.Ql=Object(Og.a)(733,D))||ed.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),
this.OX(),m.prototype.lN.call(this,c,k,null,null,!0))};gg.prototype.TYc=function(){if(!this.Ql||!this.Ql.ol||1!==this.Ql.ol.length)return ed.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var c=this.Ql.ol[0],k=new Tf.a;k.add(de.a.instance.da(235));k=u.OBc(u.concat(k,u.select(u.asEnumerable(c.FieldInfoDataList),function(D){return D.Name})),function(D){return D},new Xe);return u.toArray(k)};gg.prototype.fieldIndex=function(c){if(!this.Ql||
!this.Ql.ol||1!==this.Ql.ol.length||!this.Ql.ol[0].FieldInfoDataList)return-1;for(var k=0;k<this.Ql.ol[0].FieldInfoDataList.length;++k)if(this.Ql.ol[0].FieldInfoDataList[k].Name===c)return k;return-1};gg.prototype.fIa=function(c){return 0>c||!this.Ql||!this.Ql.ol||1!==this.Ql.ol.length||!this.Ql.ol[0].FieldInfoDataList||this.Ql.ol[0].FieldInfoDataList.length<c?null:this.Ql.ol[0].FieldInfoDataList[c].Name};gg.prototype.OX=function(){var c=this,k=this.TYc();if(!k||!k.length)return null;for(var D=this.Sa,
ba=D.Oc(),Ba={},nb=0;nb<k.length;Ba={Wcb:Ba.Wcb},++nb){var Rb=k[nb];Ba.Wcb=0<nb?this.fieldIndex(Rb):-1;for(var Ic=gg.SUf+Ba.Wcb.toString()+Xf.a.pT,Wc=null,Rd=this.Ql.KF.dQh(0<nb?Rb:null),Ge=this.cZc(D,Rd,gg.SUf+Ba.Wcb.toString(),Rb),df={},Wf=0;Wf<Vb.K5c.length;df={sLb:df.sLb,Vcb:df.Vcb},++Wf){var Pg=Vb.K5c[Wf],Bg=Ic+Wf.toString();Wc||(Wc=D.Oc());switch(Pg){case 217:Array.add(Wc.buttons,D.rd(223,Bg,-699941697,this.Ql.KF.B6h(0<nb?Rb:null)?ia.a.ysa:ia.a.R2,8,217,!1,null));break;case 218:Array.add(Wc.buttons,
D.rd(224,Bg,-699941697,this.Ql.KF.C6h(0<nb?Rb:null)?ia.a.zsa:ia.a.S2,8,218,!1,null));break;case 219:Array.add(Wc.buttons,D.rd(225,Bg,-699941697,ia.a.f4b,1,219,!1,null));break;case 96:Pg=this.uEg(Rb);Bg=D.zFa(Bg+(Rd?".enabled":".disabled"),Pg,-699941697,null,"None",null,!Rd,void 0,!0);Bg.RQ("Image16by16",8,ia.a.o_a);Array.add(Wc.buttons,Bg);break;case 92:df.sLb=void 0;df.Vcb=void 0;var qh=function(dj,vi){return function(){var $i=c.Iff(dj.Wcb);vi.sLb=$i.tKe;vi.Vcb=$i.isChecked;return $i}}(Ba,df)().returnValue;
if(!qh)return null;Pg=this.cZc(D,df.Vcb&&Rd,Bg,df.sLb);Bg=this.xNe(Pg.menu,D,Bg+Xf.a.pT,qh,df.Vcb&&Rd);Array.add(Pg.menu.Bc,Bg);Array.add(Wc.buttons,Pg);break;case 0:Wc&&(Array.add(Ge.menu.Bc,Wc),Wc=null);break;default:Bg=D.zFa(Bg,de.a.instance.da(Pg),-699941697,null,"None",null,!1,void 0,!0),this.qNf(Bg,Rd&&91===Pg&&this.Ql.KF.filter(),de.a.instance.da(Pg)),Array.add(Wc.buttons,Bg)}}Array.add(Ge.menu.Bc,Wc);Array.add(ba.buttons,Ge)}k=D.$o(this.menuId);Array.add(k.Bc,ba);return k};gg.prototype.xNe=
function(c,k,D,ba,Ba){for(var nb=null,Rb=0;Rb<ba.length;++Rb){var Ic=ba[Rb],Wc=D+Rb.toString(),Rd=!1;switch(Ic.D0b){case 1:Rd=Ba&&this.Ql.KF.Dh.IsTop10;break;case 2:Rd=Object(Og.a)(yf,Ic);Rd=Ba&&this.Ql.KF.A0h(Rd?Rd.Tke:0,Ic.w_c);break;case 0:Rd=Ba&&this.Ql.KF.Dh.IsCustomSupportedAndNotPresent}nb||(nb=k.Oc());if(Ic.B3h)nb&&(Array.add(c.Bc,nb),nb=null);else if(Ic.P6h){var Ge=de.a.instance.da(Ic.Off);Ge=this.cZc(k,Rd,Wc,Ge);Array.add(Ge.menu.Bc,this.xNe(Ge.menu,k,Wc+Xf.a.pT,Ic.subMenu,Rd));Array.add(nb.buttons,
Ge)}else Ic=de.a.instance.da(Ic.Off),Wc=k.zFa(Wc,Ic,-699941697,null,"None",null,!1,void 0,!0),this.qNf(Wc,Rd,Ic),Array.add(nb.buttons,Wc)}return nb};gg.prototype.qNf=function(c,k,D){k?c.RQ("Image16by16",8,ia.a.fha):c.RQ("None",0,null);c.PQ(D);c.label=D};gg.prototype.cZc=function(c,k,D,ba){return k?c.VYc(D,this.menuId,ba,798637440,8,ia.a.fha):c.Kz(D,this.menuId,ba,798637440)};gg.prototype.ma=function(c){return!c||!c.length};gg.prototype.Iff=function(c){var k=0>c?0:this.Ql.ol[0].FieldInfoDataList[c].MajorityDataTypeForField;
var D=null;c=this.Ql.KF.cQh(k);switch(k){case 0:D=93;k=If.Roj;break;case 1:D=92;k=If.Fmi;break;case 2:D=94;k=If.n_g;break;default:return ed.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,tKe:D,isChecked:c}}D=de.a.instance.da(D);return{returnValue:k,tKe:D,isChecked:c}};gg.prototype.uEg=function(c){!c||this.ma(c.trim())?c=de.a.instance.da(95):c.length>Vb.kKe?(c=c.substring(0,Vb.kKe),c=String.format(de.a.instance.Bb(154),
c)):c=String.format(de.a.instance.Bb(155),c);return c};Ll.Object.defineProperties(gg.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.aBf}}});gg.Lkh="AutoFilterFieldsContextMenu";gg.ZEb="AutoFilterFieldListContextMenuRoot";gg.SUf="ApplyAutoFilterFieldList.";Object(qd.a)(gg,"AutoFilterFieldListContextMenu",ie.a,[]);var K=b(568),ka=b(573),ja=b(961),Gb=b(9),$b=b(115),Ac=b(366),fd=
ie.a;Em(zf,fd);zf.prototype.executeCommand=function(c,k,D){c=Object(Og.a)(K.a,D.eventArgs);switch(k.command){case -1372040782:D=ze.g(this.$).ga.Pa.kc;ed.ULS.shipAssertTag(537167048,0,!!D);D&&(this.floatingObject=D.floatingObject,this.yb=k.method,k=this.g7b(c),this.wn(k,!0,c.yb));break;case 848910589:c&&(k=[ja.a.AQf],c=new Sys.UI.Point(c.Ea.clientX,c.Ea.clientY),this.showFloatie(k,new Sys.UI.Bounds(c.x,c.y,0,0),2))}return pg.Task.Ra(!0)};zf.prototype.Ec=function(c,k,D){switch(k.command){case -1372040782:return!!D&&
this.M8e(c);case 848910589:return c=ze.g(this.$).ga.Pa.kc,!!D&&!!c&&c.isEditing;default:return!1}};zf.prototype.M8e=function(c){switch(c){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};zf.prototype.xOc=function(c,k,D){Ac.a(this.$)?ze.g(this.$).Wa.Mi||(De.a(this.$).dKd()?Array.add(D.buttons,c.Ab(262)):Array.add(D.buttons,c.Ab(261))):(this.$.isEditMode&&3===this.yb&&!this.I5b()&&Array.add(D.buttons,c.Ab(101)),!ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5579554_ShapeTextEditing")||
5!==this.floatingObject.type||$b.a.EG(this.floatingObject.Db)||this.floatingObject.Db.IsGroup||(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Njd()?Array.add(D.buttons,c.Ab(186)):Array.add(D.buttons,c.Ab(147))),this.I5b()||this.Njd()||Array.add(D.buttons,c.Ab(146)),ae.EwaSettings.ka(167)&&!this.floatingObject.type&&Array.add(D.buttons,c.Ab(246)),ae.EwaSettings.getBooleanFeatureGate(ka.a.pwa,!1)&&5===this.floatingObject.type&&ze.g(this.$).ga.Pa.kc.Y3()&&this.$.fja&&
this.$.kqa&&Array.add(D.buttons,c.Ab(270)))};zf.prototype.gIa=function(c){var k=[];if(Ac.a(this.$))return k;3===c?(c=!!this.$.Qf.get(5)&&this.floatingObject.ZMd(),this.I5b()||(this.$.isEditMode?(c&&Array.add(k,ja.a.Snh),5===ze.g(this.$).ga.Pa.EB.floatingObject.type&&Array.add(k,ja.a.ubj)):c&&Array.add(k,ja.a.copy)),Array.add(k,ja.a.Tnh)):2===c&&(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?ze.g(this.$).ga.Pa.kc&&this.jSe(ze.g(this.$).ga.Pa.kc,k):this.jSe(ze.g(this.$).ga.Pa.EB,
k));return k};zf.prototype.OX=function(){var c=this.Sa,k=c.$o(this.menuId),D=Ac.a(this.$);if(this.$.isEditMode){var ba=c.Oc();this.xOc(c,k,ba);Array.add(k.Bc,ba)}this.$.Qf.get(5)&&this.floatingObject.ZMd()&&!this.I5b()&&!D&&(ba=c.Oc(),this.pog(c,ba),Array.add(k.Bc,ba));!ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.floatingObject.type||this.$.fa.isNamedObjectViewMode||D||(D=c.Oc(),this.hqg(c,D),Array.add(k.Bc,D));return k};zf.prototype.g7b=function(c){var k=
ze.g(this.$).ga.Pa.kc;c=c&&1!==c.yb&&c.clientPoint?c.clientPoint:Sys.UI.DomElement.getLocation(k.domElement);var D=this.$.domElement,ba=ze.g(this.$).rtl;(k=Gb.HelperMethods.Uz(k.Ag.domElement,D,ba))?(c.y=Math.max(c.y,k.y),c.x=Math.max(c.x,k.x)):ed.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",Td.AFrameworkApplication.Fg);return c};zf.prototype.Njd=function(){var c=ze.g(this.$).ga.Pa.kc;
return!!c&&c.isEditing};zf.prototype.pog=function(c,k){if(this.$.isEditMode){Array.add(k.buttons,c.Ab(42));Array.add(k.buttons,c.Ab(43));var D=this.$.ea.Ba(254,!0);(D&&2===D.qxb()||ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Njd())&&Array.add(k.buttons,c.Ab(44))}else Array.add(k.buttons,c.Ab(43))};zf.prototype.hqg=function(c,k){Array.add(k.buttons,c.Ab(271))};zf.prototype.I5b=function(){return ae.EwaSettings.ka(491)&&!!ze.g(this.$).ga.Pa.Ap};zf.prototype.jSe=
function(c,k){5===c.floatingObject.type?ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&c.isEditing?Array.add(k,ja.a.AQf):Array.add(k,ja.a.qbj):Array.add(k,ie.a.wLe)};Ll.Object.defineProperties(zf.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.iBf}}});Object(qd.a)(zf,"FloatingObjectContextMenu",ie.a,[]);var Pd=b(903),Xd=b(96),Te=b(574),rf=b(516);Em(Rg,
zf);Rg.prototype.executeCommand=function(c,k,D){var ba=this.$;this.yb=k.method;k=D[Rg.iVc];if(!(c&68)){if(!k){if(8===c)k=rf.a(ba).Nc;else{var Ba=ze.g(ba).ga.Pa.kc;Ba&&Ba.floatingObject&&(k=Ba.floatingObject.Nc)}if(!k)return pg.Task.Ra(!0)}this.isPivotChart=!!(k.Attributes&4)}if(this.isPivotChart||ba.isEditMode)this.refresh=this.hY=this.fua=this.Oya=!1,Ba=ze.g(this.$).ga.Pa.kc,ed.ULS.shipAssertTag(537167107,0,!!Ba),Ba&&(this.floatingObject=Ba.floatingObject,(Ba=Te.a(ba))&&Ba.BJd&&(this.Oya=Ba=Xd.f(ba.kg),
this.fua=!Ba),Ba=ba.ic,this.hY=!!Pd.a(ba)&&!!k&&!!(k.Attributes&512)&&!(c&8)&&Ba.r1(32768),Ba.allowManualDataRefresh&&Ba.allowInteractivity&&(this.refresh=!0),c=this.g7b(Object(Og.a)(K.a,D.eventArgs)),this.wn(c,!0));return pg.Task.Ra(!0)};Rg.prototype.Ec=function(c,k,D){return-149612405===k.command&&!!D&&this.M8e(c)};Rg.prototype.xOc=function(c,k,D){this.isPivotChart&&(this.refresh&&Array.add(D.buttons,c.Ab(100)),this.hY&&Array.add(D.buttons,c.Ab(99)),this.Oya?Array.add(D.buttons,c.Ab(59)):this.fua&&
Array.add(D.buttons,c.Ab(58)));zf.prototype.xOc.call(this,c,k,D)};Ll.Object.defineProperties(Rg.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.cBf}}});Ll.Object.defineProperties(Rg,{iVc:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(qd.a)(Rg,"ChartContextMenu",zf,[]);var Ne=b(11),Yf=ie.a;Em(Hf,Yf);Hf.prototype.executeCommand=function(c,k,D){c=k.command;switch(c){case 330754562:k=
D.domElement;this.isOlap=D.isOlap;this.tK=D.versionkey;this.Nn=D.fieldItem;this.JY=D.isChart;this.MG=D.isPpm;this.aNd="supportsImplicitMeasures"in D?D.supportsImplicitMeasures:!1;ze.g(this.$).lq(!0);c=Ne.DOMElementExtensions.getBounds(k);c=new Sys.UI.Point(c.x+c.width,c.y+c.height/2);this.fRa(c,k);"isKeyboardInput"in D&&D.isKeyboardInput?this.wn(c,!1,1):this.wn(c,!1);break;case 926905850:this.aNd&&this.Nn&&5===this.Nn.TypeTag&&!this.Nn.IsCollapsible&&ed.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");
Te.a(this.$).WF(this.Nn,8,-1,this.tK,k);break;case -67292059:Te.a(this.$).WF(this.Nn,1,-1,this.tK,k);break;case 745182485:Te.a(this.$).WF(this.Nn,2,-1,this.tK,k);break;case 359279088:Te.a(this.$).WF(this.Nn,4,-1,this.tK,k);break;case 547535945:Te.a(this.$).aNi(this.Nn);break;default:return Nh.a(c)}return pg.Task.Ra(!0)};Hf.prototype.Ec=function(c,k,D){c=!1;switch(k.command){case 330754562:c=!!D;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:c=!0}return c};Hf.prototype.OX=
function(){var c=this.Sa.$o(this.menuId);this.RGi(c);this.JY||this.isOlap||this.QGi(c);return c};Hf.prototype.RGi=function(c){var k=this.Sa,D=k.Oc(),ba=!1;ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(ba=this.isOlap&&!this.MG&&this.aNd&&5===this.Nn.TypeTag&&!this.Nn.IsCollapsible);3!==this.Nn.TypeTag&&37!==this.Nn.TypeTag||this.Nn.IsSet?17===this.Nn.TypeTag||this.MG?(Array.add(D.buttons,k.Ab(79)),Array.add(D.buttons,k.Ab(this.JY?91:80)),Array.add(D.buttons,
k.Ab(this.JY?92:81)),Array.add(D.buttons,k.Ab(82))):13===this.Nn.TypeTag||this.Nn.IsSet?(Array.add(D.buttons,k.Ab(83)),Array.add(D.buttons,k.Ab(this.JY?91:80)),Array.add(D.buttons,k.Ab(this.JY?92:81)),Array.add(D.buttons,k.Ab(86))):(Array.add(D.buttons,k.Ab(79)),Array.add(D.buttons,k.Ab(this.JY?91:80)),Array.add(D.buttons,k.Ab(this.JY?92:81)),Array.add(D.buttons,k.Ab(ba?82:86))):(Array.add(D.buttons,k.Ab(83)),Array.add(D.buttons,k.Ab(this.JY?93:84)),Array.add(D.buttons,k.Ab(this.JY?94:85)),Array.add(D.buttons,
k.Ab(82)));Array.add(c.Bc,D)};Hf.prototype.QGi=function(c){var k=this.Sa.Oc();Array.add(k.buttons,this.Sa.Ab(78));Array.add(c.Bc,k)};Ll.Object.defineProperties(Hf.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.yzd}}});Object(qd.a)(Hf,"FieldListContextMenu",ie.a,[]);var Af=b(403),ch=b(60);Vg.prototype.get=function(c,k,D){var ba=this.N_f(c,"PivotFilterContextMenuCache.Get");return ba&&this.oM[ba]?
this.oM[ba][Vg.r$c(k,this.$,c,D)]:null};Vg.prototype.set=function(c,k,D,ba){var Ba=this.N_f(c,"PivotFilterContextMenuCache.Set");Ba&&(this.oM[Ba]||(this.oM[Ba]={}),this.oM[Ba][Vg.r$c(k,this.$,c,ba)]=D)};Vg.prototype.ypb=function(c){c in this.oM&&this.oM[c]&&(this.oM[c]=null)};Vg.prototype.N_f=function(c,k){return ch.f(this.$.qa)?this.$.activeItemName:(c=this.Usj(c,k))?c.Rd:null};Vg.prototype.Usj=function(c,k){c=cf.C(c);c=ze.g(this.$).Ca.nIa(c,this.$.activeItemName);ed.ULS.shipAssertTag(537167008,
0,!!c,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",k);return c};Vg.r$c=function(c,k,D,ba){return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&!ba?k.qa.index+"_"+c.id+"_"+D.FirstRow.toString()+"_"+D.FirstColumn.toString():k.qa.index+"_"+c.id};Object(qd.a)(Vg,"PivotFilterContextMenuCache",null,[]);Object(qd.a)(mf,"ShowPivotFilterData",null,[]);var lg=b(571),
jh=b(1260),vh=b(52),dh=ie.a;Em(Ue,dh);Ue.prototype.K4c=function(c,k){var D=this,ba=c.rawEvent,Ba=c.cell,nb=c.requiresConfirmation;lg.a(this.$).Zt(nb,function(Rb){if(Rb){Rb=ba?new Sys.UI.DomEvent(ba):null;D.pivotData=new mf;D.pivotData.pivotName=c.pivotName;D.pivotData.dataSourceIndex=c.dataSourceIndex;D.pivotData.cell=Ba;D.pivotData.$n=c.optionalPivotMenuAnchorParameter;if(D.pivotData.$n&&0<D.pivotData.$n.AnchorType){D.phc=c.objectId;D.qhc=c.objectVersion;var Ic=D.pivotData.$n.AnchorType;if(4===Ic||
5===Ic||6===Ic||11===Ic||9===Ic||10===Ic||8===Ic)D.rjb=c.location}else D.bsd=D.phc=null,D.csd=D.qhc=-1;ze.g(D.$).lq(!0);D.$.Mj(Ba);D.lN(Rb,Rb?Rb.target:c.domElement,D.pivotData,k,D.XJa())}});return!0};Ue.prototype.lN=function(c,k,D,ba){var Ba=this;if(Object(Af.a)(mf,D)){this.pivotData=D;this.P0b=k;this.D$e=c;this.gVc=this.pivotData.$n?this.pivotData.$n.AnchorValue1:-1;this.q1=this.pivotData.$n?this.pivotData.$n.AnchorType:0;var nb=!1,Rb=null;Rb=Ue.oM.get(this.pivotData.cell,k,this.q1);nb=!!Rb;var Ic=
!0;switch(this.q1){case 4:case 5:case 6:this.xba=new Sys.UI.Point(this.rjb.x,this.rjb.y);Ic=!1;break;case 7:var Wc=Sys.UI.DomElement.getBounds(k);Ic=Wc.x+(0<=Wc.x?0:Wc.width);Wc=Wc.y+(0<=Wc.y?0:Wc.height);this.xba=new Sys.UI.Point(0<=Ic?Ic:0,0<=Wc?Wc:0);Ic=!1;break;case 8:case 10:case 9:case 11:this.xba=new Sys.UI.Point(this.rjb.x,this.rjb.y);break;default:this.xba=null}nb&&this.phc===this.bsd&&this.qhc===this.csd&&this.gVc===this.wpe&&this.q1===this.Hhe?(ed.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),
this.XYa=Rb,this.xba?(this.fRa(this.xba,k),this.wn(this.xba,this.XJa())):this.ou?this.wn(ie.a.h7b(this.$,this.pivotData.cell,!1),this.XJa()):dh.prototype.lN.call(this,c,k,D,ba,this.XJa())):1!==Ue.wzh(k)&&(Ic&&(k.parentNode.menuFetchStates=1,this.U6i(k),this.$Mf(!0)),this.$.userOperationManager.jc(new te.a(126,0,function(Rd,Ge,df){var Wf=Ba.$;return hg.z(Wf.ra.ua,Ba.pivotData.cell,Ba.pivotData.dataSourceIndex,Ba.pivotData.pivotName,Wf.domElement.id,Wf.isChromeRtl,Wf.workbookContext.NovMode,wd.b(Rd,
Object(xd.a)(Ba,Ba.nti,"onGetMenuSucceeded")),wd.a(Ge,Object(xd.a)(Ba,Ba.mti,"onGetMenuFailed")),df,k,Ba.pivotData.$n)},16),ba))}};Ue.prototype.nti=function(c,k){if(k)if(Hh.a(c))this.cpd(k,!1);else if(c=c.Result){this.gpb=Vg.r$c(k,this.$,this.pivotData.cell,this.q1);var D=this.Fpd(c.MenuModel.Sections);this.XYa=D;Ue.oM.set(this.pivotData.cell,k,D,this.q1);jh.a(this.$).omj(c);this.cpd(k,!0)}};Ue.prototype.mti=function(c,k){this.cpd(k,!1)};Ue.prototype.Mwd=function(c){Array.addRange(c.MenuSectionList,
this.XYa)};Ue.prototype.cpd=function(c,k){c.parentNode.menuFetchStates=2;this.$Mf(!1);k&&(this.P0b!==c||this.Jhi()?(this.fRa(this.xba,c),this.wn(this.xba,this.XJa())):this.ou&&!this.xba?this.wn(ie.a.h7b(this.$,this.pivotData.cell,!1),this.XJa()):dh.prototype.lN.call(this,this.D$e,c,null,null,this.XJa()),this.bsd=this.phc,this.csd=this.qhc,this.Hhe=this.q1,this.wpe=this.gVc)};Ue.prototype.XJa=function(){return 8!==this.q1&&9!==this.q1&&10!==this.q1&&11!==this.q1};Ue.prototype.Be=function(c,k){Ue.oM.ypb(k.Ed.hash)};
Ue.prototype.Vl=function(c,k){Ue.oM.ypb(k.Ed.hash)};Ue.prototype.Jhi=function(){switch(this.pivotData.$n?this.pivotData.$n.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};Ue.prototype.$Mf=function(c){var k=this.P0b;if(k){if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var D=Ne.DOMElementExtensions.oY(k,"ewaprevsrc","");D=!af.a.ma(D)&&"null"!==D}else D=!af.a.ma(Ne.DOMElementExtensions.oY(k,"ewaprevsrc",""));c&&D||!c&&
!D||(c?(k.setAttribute("ewaprevsrc",k.src),k.src=vh.a.current.mn(78)):(c=Ne.DOMElementExtensions.oY(k,"ewaprevsrc",""),k.src=c,k.setAttribute("ewaprevsrc",null)))}};Ue.prototype.U6i=function(c){this.P0b=c};Ue.wzh=function(c){var k=c.parentNode.menuFetchStates;void 0===k&&(c.parentNode.menuFetchStates=0);return k};Ue.oM=null;Object(qd.a)(Ue,"PivotFilterContextMenuBase",ie.a,[]);Em(Se,Ue);Se.prototype.executeCommand=function(c,k,D){return this.K4c(D,k)?pg.Task.Ra(!0):Nh.a(k.command)};Se.prototype.Ec=
function(c,k,D){return-1065117584===k.command&&!!D};Ll.Object.defineProperties(Se.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.gBf}}});Object(qd.a)(Se,"FieldListPivotContextMenu",Ue,[]);var xg=b(30),Ff=b(835);Object(qd.a)(he,"PivotValueFieldSettingsApplyData",null,[]);Kd.TZg="dataFieldCustomLabel";Kd.Axe="dataFieldSourceLabel";Kd.qij="showValueAsSelect";Kd.oij="showValueAsBaseFieldSelect";
Kd.pij="showValueAsBaseItemSelect";Kd.bSd="valueFieldsSettingsFieldName";Kd.K4f="valueFieldSettingTabs";Object(qd.a)(Kd,"CssElementIds",null,[]);var Ai=b(114);Object(qd.a)(Hd,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);zc.prototype.getActiveCell=function(){return this.activeCell};Object(qd.a)(zc,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[115]);var Oh=b(230);Object(qd.a)(wc,"PivotValueFieldShowValueAsApplyData",null,[]);var zg=b(836),Bi=b(39),mj=Oh.a;Em(ob,mj);ob.prototype.pia=
function(){return this.isVisible};ob.prototype.Pla=function(c){return this.isVisible=c};ob.prototype.setFocus=function(){Ne.DOMElementExtensions.setFocus(this.p2.vn)};ob.prototype.render=function(c){c.appendChild(this.domElement)};ob.prototype.dispose=function(){Rf.a.mc([this.p2,this.yS,this.tO,this.n1b,this.kXb]);mj.prototype.dispose.call(this)};ob.prototype.x9i=function(c){Rf.a.mc([this.n1b,this.kXb]);this.p2.clear();for(var k=Ol(c.DataFormatTypes),D=k.next();!D.done;D=k.next())D=D.value,this.p2.YK(ob.Jxh(D),
D.toString(),D===c.SelectedDataFormat);this.n1b=this.Hd.yd(this.p2.domElement);this.n1b.ja("change",Object(xd.a)(this,this.Ilf,"onDataFormatChanged"));this.yS.clear();k=Ol(c.BaseFieldList);for(D=k.next();!D.done;D=k.next())D=D.value,this.yS.YK(D.DisplayString,D.Id.toString(),D.Id===c.SelectedBaseField);this.kXb=this.Hd.yd(this.p2.domElement);this.kXb.ja("change",Object(xd.a)(this,this.yoi,"onBaseFieldChanged"));this.kE=this.Cga.LYa(this.tO.vn.parentNode,1E3,null,"",708);this.Ilf(null)};ob.prototype.HP=
function(c){this.p2.HP(c);this.yS.HP(c);this.tO.HP(c)};ob.prototype.Ilf=function(){var c=parseInt(this.p2.je.value);this.NHg(c)?(this.yS.vn.disabled=!0,this.tO.vn.disabled=!0,this.tO.clear(),ob.m3e(c)?(this.yS.vn.disabled=!1,this.TJb(!0)):ob.n3e(c)?(this.yS.vn.disabled=!1,this.tO.vn.disabled=!1,this.TJb(!0),this.kbf()):this.TJb(!1)):(c=Qg.a.gd(1,0,0,1062,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Bi.a(this.$).Gs([c]),this.p2.f_i())};ob.prototype.Jia=function(){this.domElement.innerHTML=String.format("<div id='showValueAsControlBody'><label for='showValueAsSelect' class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='showValueAsSelect' class='ewa-dlg-body-fullLine'></select></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseFieldSelect'>{1}</label><div><select size=6 id='showValueAsBaseFieldSelect' class='ewa-dlg-body-fullLine'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseItemSelect'>{2}</label><div><select size=6 id='showValueAsBaseItemSelect' class='ewa-dlg-body-fullLine'></select></div></div></div>",
de.a.instance.da(1051),de.a.instance.da(1052),de.a.instance.da(1053));this.WXd=new zg.a(Ne.DOMElementExtensions.getElementById(this.domElement,Kd.qij),!1);this.uVd=new zg.a(Ne.DOMElementExtensions.getElementById(this.domElement,Kd.oij),!1);this.vVd=new zg.a(Ne.DOMElementExtensions.getElementById(this.domElement,Kd.pij),!1)};ob.prototype.NHg=function(c){return this.U3h||!ob.m3e(c)&&!ob.n3e(c)?!0:!!this.yS.count};ob.prototype.yoi=function(){0>this.yS.selectedIndex||this.tO.vn.disabled||(this.TJb(!0),
this.kbf())};ob.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var c=this;this.$.userOperationManager.jc(new te.a(108,0,function(k,D,ba){var Ba=c.$.ra.ua,nb=parseInt(c.yS.je.value);k=wd.b.call(null,k,Object(xd.a)(c,c.jui,"onGetValueFieldSettingsShowValueAsBaseItemsSuccess"));var Rb=hg.lb(Ba,c.cell,c.externalSourceIndex,c.$n);Rb.selectedBaseField=nb;return hg.i(Ba,"GetPivotValueFieldSettingsShowValueAsBaseItems",Rb,k,D,ba,null,4)},16),this.Zd)};ob.prototype.jui=function(c){this.kE.jQa();
this.tO.vn.style.overflowY="scroll";if(c&&!Hh.a(c)){c=c.Result;this.tO.clear();for(var k=Ol(c.BaseItems),D=k.next();!D.done;D=k.next())D=D.value,this.tO.YK(D.DisplayString,D.Id.toString(),D.Id===c.SelectedBaseItem);this.TJb(!1)}};ob.prototype.kbf=function(){this.tO.clear();this.yS.je&&(this.kE.Vya(),this.tO.vn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};ob.prototype.TJb=function(c){var k=document.getElementById("WACDialogActionButton");this.byj&&k&&(k.disabled=
c)};ob.Jxh=function(c){switch(c){case 0:return de.a.instance.da(1054);case 1:return de.a.instance.da(1055);case 2:return de.a.instance.da(1056);case 3:return de.a.instance.da(1057);case 4:return de.a.instance.da(1058);case 5:return de.a.instance.da(1059);case 6:return de.a.instance.da(1060);case 7:return de.a.instance.da(1061);case 8:return de.a.instance.da(1063);case 9:return de.a.instance.da(1064);case 10:return de.a.instance.da(1065);case 11:return de.a.instance.da(1066);case 12:return de.a.instance.da(1067);
case 13:return de.a.instance.da(1068);case 14:return de.a.instance.da(1069);default:return""}};ob.m3e=function(c){return 11===c||12===c||14===c||13===c||4===c};ob.n3e=function(c){return 1===c||3===c||2===c};Ll.Object.defineProperties(ob.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return de.a.instance.da(1050)}},Csb:{configurable:!0,enumerable:!0,get:function(){var c=this.p2.je?parseInt(this.p2.je.value):-1,k=this.yS.je?parseInt(this.yS.je.value):-1,D=this.tO.je?parseInt(this.tO.je.value):
-1;return Object.assign(new wc,{SelectedDataFormat:0<=c?c:-1,SelectedBaseField:k,SelectedBaseItem:D})}},yS:{configurable:!0,enumerable:!0,get:function(){return this.uVd}},tO:{configurable:!0,enumerable:!0,get:function(){return this.vVd}},p2:{configurable:!0,enumerable:!0,get:function(){return this.WXd}}});Object(qd.a)(ob,"ShowValueAsControl",Oh.a,[735,6]);Object(qd.a)(Ea,"PivotValueFieldSummarizeValueByApplyData",null,[]);var T=Oh.a;Em(Cf,T);Cf.prototype.pia=function(){return this.isVisible};Cf.prototype.Pla=
function(c){return this.isVisible=c};Cf.prototype.setFocus=function(){Ne.DOMElementExtensions.setFocus(this.Vk.vn)};Cf.prototype.render=function(c){c.appendChild(this.domElement)};Cf.prototype.dispose=function(){Rf.a.Fa(this.Vk);T.prototype.dispose.call(this)};Cf.prototype.focus=function(){Ne.DOMElementExtensions.setFocus(this.Vk.vn)};Cf.prototype.w9i=function(c){this.Vk.bMd();for(var k=Ol(c.AggregationTypes),D=k.next();!D.done;D=k.next()){D=D.value;var ba=D===c.SelectedAggregation;this.Vk.vOc(Cf.Cth(D),
D.toString(),ba,"")}this.Vk.v2c();this.Vk.vn.disabled=c.AggregationsDisabled};Cf.prototype.b_i=function(){this.Vk.c_i()};Cf.prototype.Jia=function(){this.domElement.innerHTML=String.format("<div id='summarizeValuesByControlBody'><label class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='ewa-dlg-body-sectionlabel summarizeValuesByControlDescription'>{1}</div><div><select class='ewa-dlg-body-fullLine' size=6 id='pivotDataFieldSelect' style='width: 100%' aria-describedby='pivotDataFieldSelectDescription'></select></div></div>",
de.a.instance.da(1034),de.a.instance.da(1035));this.P6d=new zg.a(Ne.DOMElementExtensions.getElementById(this.domElement,Cf.owf),!1)};Cf.Cth=function(c){switch(c){case 0:return de.a.instance.da(1037);case 1:return de.a.instance.da(1038);case 2:return de.a.instance.da(1039);case 3:return de.a.instance.da(1040);case 4:return de.a.instance.da(1041);case 5:return de.a.instance.da(1042);case 6:return de.a.instance.da(1043);case 7:return de.a.instance.da(1044);case 8:return de.a.instance.da(1045);case 9:return de.a.instance.da(1046);
case 10:return de.a.instance.da(1047);case 11:return de.a.instance.da(1048);default:return""}};Ll.Object.defineProperties(Cf.prototype,{Csb:{configurable:!0,enumerable:!0,get:function(){var c=this.Vk.je?parseInt(this.Vk.je.value):-1;return Object.assign(new Ea,{Aggregation:0<=c?c:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return de.a.instance.da(1049)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.Vk.vn.disabled},set:function(c){this.Vk.vn.disabled=!c}},Vk:{configurable:!0,
enumerable:!0,get:function(){return this.P6d}}});Cf.owf="pivotDataFieldSelect";Object(qd.a)(Cf,"SummarizeValuesByControl",Oh.a,[735,6]);var Oa=b(198),Eb=b(454);og.prototype.Bnj=function(c,k){c.set_visible(!1);k.set_visible(!0)};Object(qd.a)(og,"DefaultTabSwitchBehaviour",null,[749]);Qf.moj="TabsContainer";Qf.Xnj="TabTitlesContainer";Qf.Vnj="TabTitle";Qf.Wnj="TabTitleText";Qf.vNd="TabTitleActive";Object(qd.a)(Qf,"MultitabControlStyles",null,[]);var vc=b(40),gd=b(90),Cd=b(87),Fd=b(85);ke.prototype.dispose=
function(){vc.a.removeHandler(this.oi,"keyup",Object(xd.a)(this,this.V6a,"onTitleKeyUp"));vc.a.removeHandler(this.oi,"click",this.zAc);this.oi=this.Xda=null};ke.prototype.setActive=function(c){c?Sys.UI.DomElement.addCssClass(this.oi,Qf.vNd):Sys.UI.DomElement.removeCssClass(this.oi,Qf.vNd);this.Xda&&this.Xda.setAttribute(Cd.a.Cfa,c)};ke.prototype.V6a=function(c){c.keyCode!==gd.a.Ph&&c.keyCode!==gd.a.Vza||this.zAc(c)};ke.prototype.Fvc=function(){this.oi.setAttribute(Cd.a.Od,Cd.a.Zr);this.Xda.setAttribute(Cd.a.fv,
this.Uo);this.Xda.setAttribute(Cd.a.Od,Cd.a.klb)};Ll.Object.defineProperties(ke.prototype,{Ib:{configurable:!0,enumerable:!0,get:function(){return this.oi}},title:{configurable:!0,enumerable:!0,get:function(){return this.Uo}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.oi,Qf.vNd)},set:function(c){this.setActive(c)}}});Object(qd.a)(ke,"TabTitleControl",null,[6]);var $d=b(48);dg.prototype.fGf=function(){this.ejb=document.createElement("ul");
this.ejb.className=Qf.Xnj;this.Vib=document.createElement("div");this.Vib.className=Qf.moj;for(var c=0;c<this.Otc;++c){var k=this.fX.oa(c),D=this.dDa.oa(c);k.set_visible(!1);D.isActive=!1;var ba=document.createElement("div");k.render(ba);this.Vib.appendChild(ba);this.ejb.appendChild(D.Ib)}this.Ib.appendChild(this.ejb);this.Ib.appendChild(this.Vib);this.Qkd(this.f0)&&(this.dDa.oa(this.f0).isActive=!0,this.fX.oa(this.f0).set_visible(!0))};dg.prototype.dispose=function(){for(var c=0;c<this.Otc;++c)this.fX.oa(c).dispose(),
this.dDa.oa(c).dispose();this.dDa=this.fX=this.oi=this.Vib=this.ejb=null};dg.prototype.setFocus=function(){this.fX.oa(this.f0).setFocus()};dg.prototype.Qkd=function(c){return 0<=c&&c<this.Otc};dg.prototype.wXf=function(c){this.f0!==c&&this.Qkd(c)&&(this.Kkg.Bnj(this.fX.oa(this.f0),this.fX.oa(c)),this.dDa.oa(this.f0).isActive=!1,this.dDa.oa(c).isActive=!0,this.f0=c,this.setFocus())};dg.prototype.RTg=function(c){var k=this;return function(){k.wXf(c)}};Ll.Object.defineProperties(dg.prototype,{Otc:{configurable:!0,
enumerable:!0,get:function(){return this.fX.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.f0},set:function(c){this.wXf(c)}},Ib:{configurable:!0,enumerable:!0,get:function(){return this.oi}},visible:{configurable:!0,enumerable:!0,get:function(){return $d.a.isVisible(this.oi)},set:function(c){this.oi.style.visibility=c?"visible":"hidden"}}});Object(qd.a)(dg,"MultitabControl",null,[734,6]);var Ae=Ff.a;Em(je,Ae);je.prototype.dispose=function(){this.K_c=this.Hob=this.RPa=
this.bMc=null;Rf.a.Fa(this.hea);this.hea=null;Ae.prototype.dispose.call(this)};je.prototype.initialize=function(){var c="<div id='"+Kd.Axe+"' class='"+Ai.a.hy+"'></div><div id='"+Kd.TZg+"' class='"+Ai.a.hy+"'><label for='"+Kd.bSd+"'>{0}</label><input type='text' id='"+Kd.bSd+"' value='{1}' class='"+Ai.a.zT+" UIFont' /></div><div id='"+Kd.K4f+"'></div>";c=String.format(c,de.a.instance.da(1033),xg.a.Xf(this.J4f));this.Nb.innerHTML=c;this.Ee||(this.i1(),this.Ok());this.vbe=[-103190598];this.TKh();Ae.prototype.initialize.call(this)};
je.prototype.close=function(c){1===c&&(this.zSf=!1);Ae.prototype.close.call(this,c)};je.prototype.Hze=function(c){this.NP=c;this.domElement.disabled=c;for(var k=["input","option","select"],D=0,ba=k.length;D<ba;++D)for(var Ba=this.domElement.getElementsByTagName(k[D]),nb=0;nb<Ba.length;++nb)Ba[nb].disabled=c};je.prototype.Ok=function(){this.Hob=document.getElementById(Kd.bSd);this.K_c=Ne.DOMElementExtensions.getElementById(this.Nb,Kd.Axe);var c=Ne.DOMElementExtensions.getElementById(this.Nb,Kd.K4f);
this.bMc=new Cf(document.createElement("div"));this.RPa=new ob(document.createElement("div"),this.$,this.cell,this.$n,this.externalSourceIndex,this.Zd,this.Cga,!this.isOlap);var k;this.hea=new dg(c,(k=new Tf.a,k.add(this.qQa),k.add(this.RPa),k));this.hea.fGf()};je.prototype.Nkc=function(){var c=new je(this.cell,this.$n,this.externalSourceIndex,this.J4f,this.$,this.Zd,this.Cga,this.isOlap,this.MG);c.initialize();c.mf()};je.prototype.vRa=function(){var c=new Eb.a;if(!this.zSf)return c.isValid=!0,c;
this.Hob.value.length?c.isValid=!0:(this.Hze(!0),c.error=Qg.a.gd(1,0,721,736,0,1783218700,"PivotTableValueFieldNoBlank"),this.NP=!0,this.Ee||(this.Aw.disabled=!0),c.isValid=!1);return c};je.prototype.wXe=function(){this.NP=!1;this.Ee||(this.Aw.disabled=!1);this.Hze(!1)};je.prototype.uwa=function(c){var k=new Th.a(2105621672,0,this.$.dd,30,null);this.$.Ka.Ub(k);this.vV(5,c.yb,"Number Format");return!0};je.prototype.Zl=function(){this.pza=String.format(de.a.instance.Bb(60),null);Ae.prototype.Zl.call(this)};
je.prototype.setFocus=function(){if(this.Ee){var c=Ne.DOMElementExtensions.getElementById(this.Nb,Cf.owf);Oa.a.evc(c)}else this.hea.setFocus()};je.prototype.Ll=function(){var c=this,k=this.RPa.Csb,D=new Hd(k.SelectedDataFormat,k.SelectedBaseField,k.SelectedBaseItem);return function(){return new zc(c.externalSourceIndex,c.cell,c.Hob.value,c.qQa.Csb.Aggregation,D)}};je.prototype.vw=function(){var c=this,k=Object.assign(new he,{PivotValueFieldSummarizeValueByApplyData:this.qQa.Csb,PivotValueFieldShowValueAsApplyData:this.RPa.Csb,
PivotValueFieldTitle:this.Hob.value});return function(D,ba,Ba){var nb=c.$.ra.ua;D=wd.b(D,Object(xd.a)(c,c.qoi,"onApplyPivotValueFieldSettingsSuccess"));var Rb=hg.lb(nb,c.cell,c.externalSourceIndex,c.$n);Rb.pivotValueFieldSettingsApplyData=k;return hg.i(nb,"ApplyPivotValueFieldSettings",Rb,D,ba,Ba,null,0)}};je.prototype.HP=function(c){var k=this;this.$.ea.$a(40,function(){k.RPa.HP(c)})};je.prototype.TKh=function(){var c=this;this.$.userOperationManager.jc(new te.a(123,0,function(k,D,ba){var Ba=c.$.ra.ua;
k=wd.b.call(null,k,Object(xd.a)(c,c.iui,"onGetValueFieldSettingsInitialSuccess"));var nb=hg.lb(Ba,c.cell,c.externalSourceIndex,c.$n);return hg.i(Ba,"GetPivotValueFieldSettingsInitial",nb,k,D,ba,null,4)},16),this.Zd)};je.prototype.qoi=function(c){ih.a.any(c.Errors,function(k){return-103190598===k.MessageId})&&this.qQa.b_i()};je.prototype.iui=function(c){c&&!Hh.a(c)&&(c=c.Result,this.K_c.innerHTML=de.a.instance.da(1032)+xg.a.Xf(c.ValueFieldSourceName),this.isOlap&&!this.MG?(this.qQa.enabled=!1,this.hea.activeTab=
this.hea.Otc-1):(this.qQa.enabled=!0,this.hea.activeTab=0),this.qQa.w9i(c.PivotValueFieldSettingsSummarizeValueByInfo),this.RPa.x9i(c.PivotValueFieldShowValueAsInitialInfo),this.mf())};Ll.Object.defineProperties(je.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},Xca:{configurable:!0,enumerable:!0,get:function(){return this.vbe}},Yyb:{configurable:!0,enumerable:!0,get:function(){return this.hea}},qQa:{configurable:!0,enumerable:!0,get:function(){return this.bMc}},
$v:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(qd.a)(je,"ValueFieldSettingsDialog",Ff.a,[]);var $e=ie.a;Em(Jg,$e);Jg.prototype.executeCommand=function(c,k,D,ba){var Ba=this;c=k.command;switch(c){case -1453503574:ba=D.domElement;this.Nn=D.fieldItem;this.hTd=D.zoneCount;this.bQa=D.sourceAxis;this.Usc=D.sourceAxisPos;this.$n=D.optionalPivotMenuAnchorParameter;this.tK=D.versionkey;this.isOlap=D.isOlap;this.MG=D.isPpm;this.z_a="fieldItemsupportsImplicitMeasures"in D?D.fieldItemsupportsImplicitMeasures:
!1;this.cell=D.cell;this.externalSourceIndex=D.externalSourceIndex;ze.g(this.$).lq(!0);c=Ne.DOMElementExtensions.getBounds(ba);var nb=new Sys.UI.Point(c.x,c.y+c.height);this.$.isChromeRtl&&(nb.x+=c.width);this.fRa(nb,ba);"isKeyboardInput"in D&&D.isKeyboardInput?this.wn(nb,!1,1):this.wn(nb,!1);break;case 495005930:Te.a(this.$).Z2g();break;case -1170196828:Te.a(this.$).WF(this.Nn,this.bQa,this.Usc-1,this.tK,k);break;case -889576107:Te.a(this.$).WF(this.Nn,this.bQa,this.Usc+2,this.tK,k);break;case 2033235475:Te.a(this.$).WF(this.Nn,
this.bQa,this.hTd,this.tK,k);break;case 389774337:Te.a(this.$).WF(this.Nn,this.bQa,0,this.tK,k);break;case -96230454:Te.a(this.$).WF(this.Nn,4,-1,this.tK,k);break;case 74086617:Te.a(this.$).WF(this.Nn,1,-1,this.tK,k);break;case 1529312473:Te.a(this.$).WF(this.Nn,2,-1,this.tK,k);break;case 563292088:this.z_a&&ed.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Te.a(this.$).WF(this.Nn,8,-1,this.tK,k);break;case -1092351914:Te.a(this.$).WF(this.Nn,0,-1,this.tK,
k);break;case -2141589616:var Rb=Wg.GetServiceTaskFactory.Va(this.$.ea,12,477,ba.gia(),"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory");return Kf.TaskExtensions.Aa(Rb,function(){(new je(Ba.cell,Ba.$n,Ba.externalSourceIndex,Ba.Nn.Name,Ba.$,k,Rb.result,Ba.isOlap,Ba.MG)).initialize()},this.la);default:return Nh.a(c)}return pg.Task.Ra(!0)};Jg.prototype.Ec=function(c,k,D){c=!1;switch(k.command){case -1453503574:c=!!D;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:c=
!0}return c};Jg.prototype.OX=function(){var c=this.Sa.$o(this.menuId);this.WGi(c,this.Usc,this.hTd);this.XGi(c,this.bQa);this.YGi(c);8===this.bQa&&this.UGi(c);return c};Jg.prototype.WGi=function(c,k,D){var ba=this.Sa,Ba=ba.Oc();k||k!==D-1?!k&&k<D-1?(Array.add(Ba.buttons,ba.Ab(64)),Array.add(Ba.buttons,ba.Ab(61)),Array.add(Ba.buttons,ba.Ab(66)),Array.add(Ba.buttons,ba.Ab(63))):0<k&&k<D-1?(Array.add(Ba.buttons,ba.Ab(60)),Array.add(Ba.buttons,ba.Ab(61)),Array.add(Ba.buttons,ba.Ab(62)),Array.add(Ba.buttons,
ba.Ab(63))):0<k&&k===D-1&&(Array.add(Ba.buttons,ba.Ab(60)),Array.add(Ba.buttons,ba.Ab(65)),Array.add(Ba.buttons,ba.Ab(62)),Array.add(Ba.buttons,ba.Ab(67))):(Array.add(Ba.buttons,ba.Ab(64)),Array.add(Ba.buttons,ba.Ab(65)),Array.add(Ba.buttons,ba.Ab(66)),Array.add(Ba.buttons,ba.Ab(67)));Array.add(c.Bc,Ba)};Jg.prototype.XGi=function(c,k){var D=this.Sa,ba=D.Oc(),Ba=1!==k&&(!this.isOlap||this.MG||8!==k||this.z_a),nb=2!==k&&(!this.isOlap||this.MG||8!==k||this.z_a),Rb=8!==k&&-2!==this.Nn.PivotTableIndex&&
(!this.isOlap||this.MG||this.z_a);Array.add(ba.buttons,D.Ab(4===k||this.Nn.IsSet||-2===this.Nn.PivotTableIndex||this.isOlap&&!this.MG&&8===k&&!this.z_a?72:68));8===this.$n.AnchorType||10===this.$n.AnchorType?(Array.add(ba.buttons,D.Ab(Ba?95:97)),Array.add(ba.buttons,D.Ab(nb?96:98))):(Array.add(ba.buttons,D.Ab(Ba?69:73)),Array.add(ba.buttons,D.Ab(nb?70:74)));Array.add(ba.buttons,D.Ab(Rb?71:75));Array.add(c.Bc,ba)};Jg.prototype.YGi=function(c){var k=this.Sa.Oc();Array.add(k.buttons,this.Sa.Ab(76));
Array.add(c.Bc,k)};Jg.prototype.UGi=function(c){var k=this.Sa.Oc();Array.add(k.buttons,this.Sa.Ab(77));Array.add(c.Bc,k)};Ll.Object.defineProperties(Jg.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.zzd}}});Object(qd.a)(Jg,"FieldWellContextMenu",ie.a,[]);var qg=b(1240);Em(Ag,Ue);Ag.prototype.executeCommand=function(c,k,D){var ba=!1,Ba=k.command;switch(Ba){case 37023044:ba=this.K4c(D,k);
break;case 541421805:case -569786022:ba=this.ycd(c,k)}return ba?pg.Task.Ra(!0):Nh.a(Ba)};Ag.prototype.Ec=function(c,k,D){c=!1;switch(k.command){case 37023044:c=!!D;break;case 541421805:case -569786022:c=!0}return c};Ag.prototype.ycd=function(c,k){var D=8===c,ba=this.$,Ba=rf.a(ba),nb=ze.g(ba).ga.Pa.kc,Rb=c=null;D&&Ba?(c=Ba.chartId,Rb=Ba.Nc):!D&&nb&&(c=nb.floatingObject.id,Rb=nb.floatingObject.Nc);return Ag.Dje(Rb,260)?(D={},ba.Mj(D),D.FirstColumn=D.FirstRow=-1,ba={},Rb=(ba.rawEvent=null,ba.pivotName=
null,ba.cell=D,ba.requiresConfirmation=Ag.Dje(Rb,64),ba.dataSourceIndex=Rb.ExternalSourceIndex,ba),nb?(Ba=nb.floatingObject,Rb.domElement=nb.domElement,Rb.objectId=Ba.id,Rb.objectVersion=Ba.version):Ba&&(Rb.domElement=Ba.Oj,Rb.objectId=Ba.chartId,Rb.objectVersion=Ba.ype),nb={AnchorType:7},nb.ChartId=c,nb.AnchorValue1=-1,nb.AnchorValue2=-1,Rb.optionalPivotMenuAnchorParameter=nb,this.K4c(Rb,k)):!1};Ag.Dje=function(c,k){return(c.Attributes&k)===k};Ll.Object.defineProperties(Ag.prototype,{xt:{configurable:!0,
enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.mBf}}});Object(qd.a)(Ag,"PivotFilterContextMenu",Ue,[]);var Tg=b(1258),jg=b(960),vf=b(149),Xg=b(44),bh=b(26),Fh=ie.a;Em(Sc,Fh);Sc.prototype.executeCommand=function(c,k,D){k=k.command;c=null;this.grid=ze.g(this.$);this.activeCell=cf.o(this.grid.ga.wa.activeCell,this.$);if(this.$.isEditMode&&(this.Tc=this.grid.$b.Up(this.grid.ga.wa.activeCell),!this.Tc))return ed.ULS.sendTraceTag(537167007,
0,10,"No PivotTable range found."),Kf.TaskExtensions.p3();this.oxc=this.$.ra.ua;this.zYa=Object(Og.a)(K.a,D.eventArgs);switch(k){case 671488277:!this.$.isEditMode||this.Tc.Dbc||this.Tc.Pid()&&!this.wRf(!1)?(this.w9a(),this.showPivotTableContextMenu()):this.XEh();break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,
8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.qPa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.qPa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.qPa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.qPa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.qPa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.qPa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:D=Number.parseInvariant(D.MenuItemId.split(".")[2]);this.qPa(11,D);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.De(-1556797033,Dg.a.Tb,8,null);break;case 1514686611:this.z$h();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:D=Number.parseInvariant(D.MenuItemId);this.wLg(D);break;case 1778578888:D=Number.parseInvariant(D.MenuItemId);
this.Mxg(D);break;case 1771091375:break;default:c=Nh.a(k)}return c||Kf.TaskExtensions.p3()};Sc.prototype.Ec=function(c,k){c=!1;switch(k.command){case 671488277:c=jg.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:c=!0;break;case 1600778266:c=!0;break;case -556893687:c=!0;break;case -1966978671:c=!0;break;case -1951357930:c=!0;break;case -1390365353:case -1457478532:c=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:c=
!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:c=!0;break;case -1007663920:case 234234584:case 1194992911:c=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:c=!0;break;case 1771091375:c=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return c};Sc.prototype.Wc=function(c,k){var D=!1;switch(k){case -1007663920:case 234234584:D=
this.Zcj();break;case 1194992911:D=this.$cj();break;case 1217404289:D=!Tg.j(this.xb.LabelOrDateFilterType);break;case -743135194:D=!Tg.m(this.xb.ValueFilterType)&&!Tg.l(this.xb.ValueFilterType);break;case 771421327:D=!this.xb.LabelOrDateFilterType&&!this.xb.ValueFilterType&&!this.xb.HasManualFilter;break;case 1015867427:D=!Tg.i(this.xb.LabelOrDateFilterType);break;case 1105960559:D=!Tg.k(this.xb.LabelOrDateFilterType)}return D||Fh.prototype.Wc.call(this,c,k)};Sc.prototype.w9a=function(){this.S7a=
this.xb=this.Rf=null};Sc.prototype.KMd=function(){this.grid.oS(Object(xd.a)(this,this.vs,"onAfterAllBlocksUpdated"));this.$.Ka.NDa(Object(xd.a)(this,this.ut,"onMenuClosed"))};Sc.prototype.iQd=function(){this.grid.TM(Object(xd.a)(this,this.vs,"onAfterAllBlocksUpdated"));this.$.Ka.Z8a(Object(xd.a)(this,this.ut,"onMenuClosed"))};Sc.prototype.mGb=function(){if(this.Tc&&this.Tc.so){this.Rf=this.Tc.so;this.xb=this.Tc.m7b();if(this.lSf()){var c=this.Tc.gK[4===this.Rf.CellType?this.Tc.N_c-1:this.Rf.CurrentFieldIndex-
1];c&&(this.S7a=-2===c.Index?this.Tc.Fxe:c.Caption)}this.bVh();this.xb&&8===this.Rf.CellArea&&(this.Xy.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.xb.DataFieldAggregationType,this.Xy.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.xb.DataFieldFormatType,this.Xy.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.xb.BaseFieldIndex,this.Xy.PivotValueFieldTitle=this.xb.Caption)}};Sc.prototype.wRf=function(c){if(!this.Tc)return!1;c=this.Tc.isOlap&&!this.Tc.s4a(!c);return ae.EwaSettings.ka(614)&&
c};Sc.prototype.gdj=function(){var c=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?1!==this.xb.MeasureType&&(!this.Tc.wjd||c&&2===this.xb.MeasureType):!this.Tc.wjd||c&&this.xb.IsImplicitMeasure};Sc.prototype.OX=function(){var c=this.Sa.$o(this.menuId),k=this.Sa.Oc();if(this.Tc)this.Rf&&this.Tc.so&&this.Rf!==this.Tc.so&&ed.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),
this.xb&&this.xb!==this.Tc.m7b()&&ed.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return c;this.Uqh(c);if(this.$.isEditMode){this.refresh&&this.hsh(c);if(this.Rf&&this.xb){var D=this.Sa.Oc();this.wsh(D);this.irh(D);Array.add(c.Bc,D)}this.hY&&Array.add(k.buttons,this.Sa.Ab(99));this.Rf&&this.xb&&this.Erh(c);if(this.expandCollapse){D=this.Sa.Kz("ContextMenu.PivotExpandCollapse",null,de.a.instance.da(1098),589118293);var ba=this.Sa.Oc();Array.add(ba.buttons,
this.Sa.Ab(240));Array.add(ba.buttons,this.Sa.Ab(241));Array.add(ba.buttons,this.Sa.Ab(242));Array.add(ba.buttons,this.Sa.Ab(243));Array.add(D.menu.Bc,ba);D&&0<ba.buttons.length&&Array.add(k.buttons,D)}this.Rf&&!this.Rf.CellType&&ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.ssh(c);this.Rf&&this.ish(c);this.Rf&&this.xb&&8===this.Rf.CellArea&&8!==this.Rf.CellType&&(D=this.Sa.Oc(),this.gdj()&&this.ysh(D),3!==this.Rf.CellType&&this.tsh(D),Array.add(c.Bc,
D));ae.EwaSettings.ka(327)&&(this.C4h()?Array.add(k.buttons,this.Sa.Ab(254)):Array.add(k.buttons,this.Sa.Ab(255)));this.xhd?Array.add(k.buttons,this.Sa.Ab(59)):Array.add(k.buttons,this.Sa.Ab(58))}Array.add(c.Bc,k);return c};Sc.prototype.iKd=function(){return!this.xb||af.a.ma(this.xb.Caption)?!1:20<this.xb.Caption.length};Sc.prototype.p9c=function(c){return!this.xb||af.a.ma(this.xb.Caption)?"":c?this.xb.Caption.substring(0,20)+"...":this.xb.Caption};Sc.prototype.uta=function(c){return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?
af.a.hashCode(c).toString():c};Sc.prototype.wsh=function(c){if(this.Rf&&this.xb&&4!==this.Rf.CellArea){var k=this.$sa(this.hG("PivotTableContextMenu.Sort",this.uta(this.xb.Caption)),-1777747317,0,!!this.xb.SortInfo,de.a.instance.da(216)),D=this.Sa.Oc();Array.add(D.buttons,this.Wd("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.xb.SortInfo,de.a.instance.da(217)));Array.add(D.buttons,this.Wd("PivotTableContextMenu.SortDescending",234234584,0,2===this.xb.SortInfo,de.a.instance.da(218)));
1!==this.Rf.CellArea&&2!==this.Rf.CellArea||Array.add(D.buttons,this.Wd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.xb.SortInfo||4===this.xb.SortInfo,de.a.instance.da(153)));Array.add(k.menu.Bc,D);k&&0<D.buttons.length&&Array.add(c.buttons,k)}};Sc.prototype.irh=function(c){if(this.Rf&&this.xb&&(1===this.Rf.CellArea||2===this.Rf.CellArea)){var k=this.uej(),D=this.$sa(this.hG("PivotTableContextMenu.Filter",this.uta(this.xb.Caption)),-1777747317,0,k,de.a.instance.da(629)),ba=this.Sa.Oc(),
Ba="",nb=this.iKd(),Rb=String.format(de.a.instance.Bb(155),this.p9c(nb));nb&&(Ba=String.format(de.a.instance.Bb(155),this.xb.Caption));k=this.uta(this.xb.Caption)+"."+(k?"enabled":"disabled");Ba=this.Wd(this.hG("PivotTableContextMenu.ClearFilter",k),771421327,0,!1,Rb,"0",Ba,8,ia.a.o_a);k=this.uta(this.xb.Caption)+"."+this.xb.LabelOrDateFilterType.toString();this.xb.IsDateField?(Rb=this.$sa(this.hG("PivotTableContextMenu.DateFilter",k),-1777747317,0,!!this.xb.LabelOrDateFilterType,de.a.instance.da(94)),
this.Xqh(Rb.menu)):(Rb=this.$sa(this.hG("PivotTableContextMenu.LabelFilter",k),-1777747317,0,!!this.xb.LabelOrDateFilterType,de.a.instance.da(627)),this.Drh(Rb.menu));k=this.uta(this.xb.Caption)+"."+this.xb.ValueFilterType.toString();k=this.$sa(this.hG("PivotTableContextMenu.ValueFilter",k),-1777747317,0,!!this.xb.ValueFilterType,de.a.instance.da(628));this.Ksh(k.menu);nb=this.Sa.Oc();Array.add(nb.buttons,this.Wd("PivotTableContextMenu.ManualFilter",1514686611,0,this.xb.HasManualFilter,de.a.instance.da(91)));
Array.add(ba.buttons,Ba);Array.add(ba.buttons,Rb);Array.add(ba.buttons,k);Array.add(D.menu.Bc,ba);Array.add(D.menu.Bc,nb);D&&0<ba.buttons.length&&Array.add(c.buttons,D)}};Sc.prototype.Xqh=function(c){Array.add(c.Bc,this.I7b(!0,!1));Array.add(c.Bc,this.Nxh());Array.add(c.Bc,this.Mxh());Array.add(c.Bc,this.Bzh());Array.add(c.Bc,this.Ezh());Array.add(c.Bc,this.Czh());Array.add(c.Bc,this.Dzh());Array.add(c.Bc,this.Fzh());Array.add(c.Bc,this.Gzh());Array.add(c.Bc,this.Bxh())};Sc.prototype.Pqh=function(c){Array.add(c.Bc,
this.I7b(!0,!0));Array.add(c.Bc,this.QFh());Array.add(c.Bc,this.rDh())};Sc.prototype.Drh=function(c){Array.add(c.Bc,this.I7b(!0,!1));Array.add(c.Bc,this.jQe(!0));Array.add(c.Bc,this.xuh());Array.add(c.Bc,this.Mwh());Array.add(c.Bc,this.jPe(!0));Array.add(c.Bc,this.rOe(!0))};Sc.prototype.Ksh=function(c){Array.add(c.Bc,this.I7b(!1,!1));Array.add(c.Bc,this.jQe(!1));Array.add(c.Bc,this.jPe(!1));Array.add(c.Bc,this.rOe(!1));Array.add(c.Bc,this.VJh())};Sc.prototype.VJh=function(){var c=this.Sa.Oc();Array.add(c.buttons,
this.Wd("PivotTableContextMenu.Top10",-1611233597,0,Tg.l(this.xb.ValueFilterType),de.a.instance.da(102)));return c};Sc.prototype.Mwh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.Contains",786260386,0,10===this.xb.LabelOrDateFilterType,de.a.instance.da(630),"10")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.xb.LabelOrDateFilterType,de.a.instance.da(631),"11")));return c};Sc.prototype.xuh=function(){var c=this.Sa.Oc();
this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.xb.LabelOrDateFilterType,de.a.instance.da(632),"6")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.xb.LabelOrDateFilterType,de.a.instance.da(633),"7")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.EndsWith",786260386,0,8===this.xb.LabelOrDateFilterType,de.a.instance.da(634),"8")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.DoesNotEndWith",786260386,
0,9===this.xb.LabelOrDateFilterType,de.a.instance.da(635),"9")));return c};Sc.prototype.jQe=function(c){var k=this.Sa.Oc();if(this.xb){var D=c?Tg.c:Tg.f;Array.add(k.buttons,this.Wd(this.hG("PivotTableContextMenu.Equals",D),786260386,0,c?4===this.xb.LabelOrDateFilterType:18===this.xb.ValueFilterType,de.a.instance.da(97),c?"4":"18"));Array.add(k.buttons,this.Wd(this.hG("PivotTableContextMenu.DoesNotEqual",D),786260386,0,c?5===this.xb.LabelOrDateFilterType:19===this.xb.ValueFilterType,de.a.instance.da(98),
c?"5":"19"))}return k};Sc.prototype.jPe=function(c){var k=this.Sa.Oc();if(this.xb){var D=c?Tg.c:Tg.f;Array.add(k.buttons,this.Wd(this.hG("PivotTableContextMenu.GreaterThan",D),786260386,0,c?12===this.xb.LabelOrDateFilterType:20===this.xb.ValueFilterType,de.a.instance.da(99),c?"12":"20"));Array.add(k.buttons,this.Wd(this.hG("PivotTableContextMenu.GreaterThanOrEqualTo",D),786260386,0,c?13===this.xb.LabelOrDateFilterType:21===this.xb.ValueFilterType,de.a.instance.da(636),c?"13":"21"));Array.add(k.buttons,
this.Wd(this.hG("PivotTableContextMenu.LessThan",D),786260386,0,c?14===this.xb.LabelOrDateFilterType:22===this.xb.ValueFilterType,de.a.instance.da(100),c?"14":"22"));Array.add(k.buttons,this.Wd(this.hG("PivotTableContextMenu.LessThanOrEqualTo",D),786260386,0,c?15===this.xb.LabelOrDateFilterType:23===this.xb.ValueFilterType,de.a.instance.da(637),c?"15":"23"))}return k};Sc.prototype.rOe=function(c){var k=this.Sa.Oc();if(this.xb){var D=c?Tg.c:Tg.f;Array.add(k.buttons,this.Wd(this.hG("PivotTableContextMenu.Between",
D),786260386,0,c?16===this.xb.LabelOrDateFilterType:24===this.xb.ValueFilterType,de.a.instance.da(101),c?"16":"24"));Array.add(k.buttons,this.Wd(this.hG("PivotTableContextMenu.NotBetween",D),786260386,0,c?17===this.xb.LabelOrDateFilterType:25===this.xb.ValueFilterType,de.a.instance.da(638),c?"17":"25"))}return k};Sc.prototype.I7b=function(c,k){var D=this.Sa.Oc();if(this.xb){var ba=de.a.instance.da(95),Ba=c?this.xb.LabelOrDateFilterType.toString():this.xb.ValueFilterType.toString(),nb=["PivotTableContextMenu.ClearFilter",
this.uta(this.xb.Caption),Ba];c=c?this.xb.IsDateField?k?1015867427:1105960559:1217404289:-743135194;nb.push(c.toString());ba=this.Wd(nb.join("."),c,0,!1,ba,Ba,ba,8,ia.a.o_a);Array.add(D.buttons,ba)}return D};Sc.prototype.Nxh=function(){var c=this.Sa.Oc();this.xb&&Array.add(c.buttons,this.Wd(this.hG("PivotTableContextMenu.Equals",Tg.d),786260386,0,26===this.xb.LabelOrDateFilterType,de.a.instance.da(97),"26"));return c};Sc.prototype.Mxh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.Before",
786260386,0,27===this.xb.LabelOrDateFilterType,de.a.instance.da(109),"27")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.After",786260386,0,28===this.xb.LabelOrDateFilterType,de.a.instance.da(110),"28")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.Between",786260386,0,29===this.xb.LabelOrDateFilterType,de.a.instance.da(101),"29")));return c};Sc.prototype.Bzh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.xb.LabelOrDateFilterType,
de.a.instance.da(107),"30")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.Today",1778578888,0,31===this.xb.LabelOrDateFilterType,de.a.instance.da(106),"31")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.xb.LabelOrDateFilterType,de.a.instance.da(108),"32")));return c};Sc.prototype.Ezh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.xb.LabelOrDateFilterType,de.a.instance.da(112),
"33")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.xb.LabelOrDateFilterType,de.a.instance.da(111),"34")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.xb.LabelOrDateFilterType,de.a.instance.da(113),"35")));return c};Sc.prototype.Czh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.xb.LabelOrDateFilterType,de.a.instance.da(114),"36")),Array.add(c.buttons,
this.Wd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.xb.LabelOrDateFilterType,de.a.instance.da(115),"37")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.xb.LabelOrDateFilterType,de.a.instance.da(116),"38")));return c};Sc.prototype.Dzh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.xb.LabelOrDateFilterType,de.a.instance.da(117),"39")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.ThisQuarter",
1778578888,0,40===this.xb.LabelOrDateFilterType,de.a.instance.da(118),"40")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.xb.LabelOrDateFilterType,de.a.instance.da(119),"41")));return c};Sc.prototype.Fzh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.NextYear",1778578888,0,42===this.xb.LabelOrDateFilterType,de.a.instance.da(120),"42")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.ThisYear",1778578888,0,43===
this.xb.LabelOrDateFilterType,de.a.instance.da(121),"43")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.LastYear",1778578888,0,44===this.xb.LabelOrDateFilterType,de.a.instance.da(122),"44")));return c};Sc.prototype.Gzh=function(){var c=this.Sa.Oc();if(this.xb){Array.add(c.buttons,this.Wd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.xb.LabelOrDateFilterType,de.a.instance.da(123),"45"));var k=this.$sa("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Tg.i(this.xb.LabelOrDateFilterType),
de.a.instance.da(124));this.Pqh(k.menu);Array.add(c.buttons,k)}return c};Sc.prototype.Bxh=function(){var c=this.Sa.Oc();this.xb&&Array.add(c.buttons,this.Wd("PivotTableContextMenu.CustomFilter",786260386,0,this.rej(this.xb.LabelOrDateFilterType),de.a.instance.da(105),"26"));return c};Sc.prototype.QFh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.xb.LabelOrDateFilterType,de.a.instance.da(125),"46")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.xb.LabelOrDateFilterType,de.a.instance.da(126),"47")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.xb.LabelOrDateFilterType,de.a.instance.da(127),"48")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.xb.LabelOrDateFilterType,de.a.instance.da(128),"49")));return c};Sc.prototype.rDh=function(){var c=this.Sa.Oc();this.xb&&(Array.add(c.buttons,this.Wd("PivotTableContextMenu.January",1778578888,0,50===this.xb.LabelOrDateFilterType,
de.a.instance.da(129),"50")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.February",1778578888,0,51===this.xb.LabelOrDateFilterType,de.a.instance.da(130),"51")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.March",1778578888,0,52===this.xb.LabelOrDateFilterType,de.a.instance.da(131),"52")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.April",1778578888,0,53===this.xb.LabelOrDateFilterType,de.a.instance.da(132),"53")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.May",1778578888,
0,54===this.xb.LabelOrDateFilterType,de.a.instance.da(133),"54")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.June",1778578888,0,55===this.xb.LabelOrDateFilterType,de.a.instance.da(134),"55")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.July",1778578888,0,56===this.xb.LabelOrDateFilterType,de.a.instance.da(135),"56")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.August",1778578888,0,57===this.xb.LabelOrDateFilterType,de.a.instance.da(136),"57")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.September",
1778578888,0,58===this.xb.LabelOrDateFilterType,de.a.instance.da(137),"58")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.October",1778578888,0,59===this.xb.LabelOrDateFilterType,de.a.instance.da(138),"59")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.November",1778578888,0,60===this.xb.LabelOrDateFilterType,de.a.instance.da(139),"60")),Array.add(c.buttons,this.Wd("PivotTableContextMenu.December",1778578888,0,61===this.xb.LabelOrDateFilterType,de.a.instance.da(140),"61")));return c};
Sc.prototype.Erh=function(c){var k=this.Sa.Oc();if(this.lSf()){var D=this.Tc.gK[4===this.Rf.CellType?this.Tc.N_c-1:this.Rf.CurrentFieldIndex-1];if(D&&!af.a.ma(this.S7a)){var ba=this.Sa.Kz("ContextMenu.PivotTableLayout",null,de.a.instance.da(625),-1777747317);var Ba=this.Sa.Oc(),nb=String.format(de.a.instance.Bb(159),this.S7a),Rb=String.format(de.a.instance.Bb(160),this.S7a);Array.add(Ba.buttons,this.Wd("PivotTableContextMenu.LayoutNextColumn",-1457478532,0,!D.IsCompactLayout,nb));Array.add(Ba.buttons,
this.Wd("PivotTableContextMenu.LayoutSameColumn",-1390365353,0,D.IsCompactLayout,Rb));Array.add(ba.menu.Bc,Ba);ba&&Array.add(k.buttons,ba)}}if(1===this.Rf.CellArea||2===this.Rf.CellArea)af.a.ma(this.xb.Caption)||(D="",Ba=this.iKd(),ba=String.format(de.a.instance.Bb(157),this.p9c(Ba)),Ba&&(D=String.format(de.a.instance.Bb(157),this.xb.Caption)),1===this.Rf.CellArea?(D=this.$sa("ContextMenu.PivotTableSubtotal",1801458190,0,this.xb.ShowSubtotal,ba),ba=this.Sa.Oc(),Array.add(ba.buttons,this.Sa.Ab(256)),
Array.add(ba.buttons,this.Wd("ContextMenu.PivotTableSubtotalOnTop",671485366,617,this.xb.ShowSubtotal&&this.xb.ShowSubtotalAtTop)),Array.add(ba.buttons,this.Wd("ContextMenu.PivotTableSubtotalOnBottom",772221736,618,this.xb.ShowSubtotal&&!this.xb.ShowSubtotalAtTop)),Array.add(D.menu.Bc,ba),D&&0<ba.buttons.length&&Array.add(k.buttons,D)):(Ba=Ba?this.hG("PivotTableContextMenu.Subtotal",this.uta(ba)):"PivotTableContextMenu.Subtotal",Array.add(k.buttons,this.Wd(Ba,1801458190,0,this.xb.ShowSubtotal,ba,
null,D)))),Array.add(k.buttons,this.Wd("ContextMenu.RepeatItemLabels",-556893687,620,this.xb.RepeatItemLabels));1===this.Rf.CellArea&&Array.add(k.buttons,this.Wd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,619,this.xb.ShowBlankLineAfterEachItem));Array.add(c.Bc,k)};Sc.prototype.ssh=function(c){var k=this.Sa.Oc();Array.add(k.buttons,this.Sa.Ab(244));Array.add(c.Bc,k)};Sc.prototype.ish=function(c){var k="",D="",ba=!1;3===this.Rf.CellType?k=de.a.instance.da(622):8===this.Rf.CellType?this.Tc&&
(k=String.format(de.a.instance.Bb(158),this.Tc.Fxe)):this.xb&&((ba=this.iKd())&&(D=String.format(de.a.instance.Bb(158),this.xb.Caption)),k=String.format(de.a.instance.Bb(158),this.p9c(ba)));if(!af.a.ma(k)){var Ba=this.Sa.Oc();ba=ba?this.hG("PivotTableContextMenu.RemoveField",this.uta(k)):"PivotTableContextMenu.RemoveField";k=this.Wd(ba,-1951357930,0,!1,k,null,D,8,ia.a.f4c);Array.add(Ba.buttons,k);Array.add(c.Bc,Ba)}};Sc.prototype.Uqh=function(c){var k=this.Sa.Oc();ae.EwaSettings.ka(488)&&Array.add(k.buttons,
this.Sa.Ab(43));this.xb&&this.Rf&&this.$.isEditMode&&(!this.Rf.CellType||4===this.Rf.CellType)&&Array.add(k.buttons,this.Sa.Ab(136));Array.add(c.Bc,k)};Sc.prototype.hsh=function(c){var k=this.Sa.Oc();Array.add(k.buttons,this.Sa.Ab(100));Array.add(c.Bc,k)};Sc.prototype.ysh=function(c){var k=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?2===this.xb.MeasureType&&!this.xb.IsNumeric:this.xb.IsImplicitMeasure&&!this.xb.IsNumeric,D=this.Sa.Kz("ContextMenu.SummarizeValuesBy",
null,de.a.instance.da(623),-249874296),ba=this.Sa.Oc();Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesBySum",-1255320719,1037,!this.xb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,k));Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByCount",1746132849,1038,1===this.xb.DataFieldAggregationType));Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByAverage",-771066011,1039,2===this.xb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,k));Array.add(ba.buttons,
this.Wd("ContextMenu.SummarizeValuesByMax",835007294,1040,3===this.xb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,k));Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByMin",929115636,1041,4===this.xb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,k));Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByProduct",1935475057,1042,5===this.xb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.wRf(!0)||k));(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?
2===this.xb.MeasureType:this.xb.IsImplicitMeasure)||(Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1043,6===this.xb.DataFieldAggregationType)),Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1044,7===this.xb.DataFieldAggregationType)),Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1045,8===this.xb.DataFieldAggregationType)),Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByVariant",
1668427539,1046,9===this.xb.DataFieldAggregationType)),Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1047,10===this.xb.DataFieldAggregationType)));this.Tc&&this.Tc.Pid()&&Array.add(ba.buttons,this.Wd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1048,11===this.xb.DataFieldAggregationType));Array.add(D.menu.Bc,ba);Array.add(c.buttons,D)};Sc.prototype.tsh=function(c){var k=this.Sa.Kz("ContextMenu.ShowValuesAs",null,de.a.instance.da(624),-1128612833),
D=this.Sa.Oc();Array.add(D.buttons,this.Wd("ContextMenu.ShowValuesAsNoCalculation",-841863025,1054,!this.xb.DataFieldFormatType));Array.add(D.buttons,this.Wd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1061,7===this.xb.DataFieldFormatType));Array.add(D.buttons,this.Wd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1060,6===this.xb.DataFieldFormatType));Array.add(D.buttons,this.Wd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1059,5===this.xb.DataFieldFormatType));Array.add(D.buttons,
this.Wd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1064,9===this.xb.DataFieldFormatType));Array.add(D.buttons,this.Wd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1065,10===this.xb.DataFieldFormatType));if(this.Tc&&this.Tc.gK&&0<this.Tc.gK.length||this.Tc.b9&&0<this.Tc.b9.length){for(var ba=this.$sa("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1066,11===this.xb.DataFieldFormatType),Ba=this.Sa.Oc(),nb=this.xsh(),Rb=0;Rb<nb.length;Rb++){var Ic=nb[Rb];Array.add(Ba.buttons,
this.Wd("ContextMenu.ShowValuesAsPercentOfParentTotal."+Ic.Caption,-2031744961,1066,11===this.xb.DataFieldFormatType&&this.xb.BaseFieldIndex===Ic.Index,Ic.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Ic.Index))}Array.add(ba.menu.Bc,Ba);Array.add(D.buttons,ba)}Array.add(k.menu.Bc,D);Array.add(c.buttons,k)};Sc.prototype.showPivotTableContextMenu=function(){this.xhd=!0;this.expandCollapse=this.hY=this.refresh=!1;var c=this.$,k=ze.g(c),D=lg.a(c).zIa();if(D){var ba=Te.a(c);ba&&ba.BJd&&(this.xhd=
Xd.f(c.kg));ba=c.ic;this.hY=D.supportsBIExplore&&!!Pd.a(c)&&ba.r1(32768);ba.allowInteractivity&&((c=k.tc(null))&&c.cell&&(c.cell.ZTc||c.cell.iSf)&&(this.expandCollapse=!0),ba.allowManualDataRefresh&&(this.refresh=!0))}c=null;D=1;this.zYa&&1!==this.zYa.yb?(c=new Sys.UI.Point(this.zYa.clientPoint.x,this.zYa.clientPoint.y),D=this.zYa.yb):(k=jg.e(k,this.$))&&(c=new Sys.UI.Point(k.x+(this.$.isChromeRtl?0:k.width),k.y+k.height));Dg.a.Tb=D;this.vdc=3===D;this.wn(c,!0,D);this.V$=!0;this.KMd()};Sc.prototype.xRh=
function(){var c=new Th.a(1114549926,0,this.$.dd,19,null);this.$.Ka.Ub(c)};Sc.prototype.XEh=function(){var c=this;if(this.Tc&&this.Tc.so){var k=this.Tc.so.CurrentCol;if(this.Tc.so.CurrentRow===this.activeCell.FirstRow&&k===this.activeCell.FirstColumn){this.mGb();this.showPivotTableContextMenu();return}}k=new te.a(228,0,function(D,ba,Ba){return hg.B(c.$.ra.ua,c.activeCell,wd.b(D,Object(xd.a)(c,c.zti,"onGetPivotTableCellInfoSuccessCallback")),wd.a(ba,Object(xd.a)(c,c.yti,"onGetPivotTableCellInfoFailedCallback")),
Ba,null)},16);this.$.userOperationManager.jc(k,null)};Sc.prototype.zti=function(c){c&&!Qg.a.Zg(c.Errors)&&this.Tc&&(this.Tc.so=c.Result,this.mGb());this.showPivotTableContextMenu()};Sc.prototype.yti=function(){};Sc.prototype.C4h=function(){if(Xg.a.Jd(this.$)){var c=this.$.ea.Ba(441);if(c)return c.kr}else if(c=this.$.ea.Ba(346))return c.kr;return!1};Sc.prototype.hG=function(c,k){return c+"."+k};Sc.prototype.performPivotTableOperation=function(c,k){var D=this,ba=bh.a.Qa.Gb;if(!this.Tc||!this.xb&&this.Rf&&
3!==this.Rf.CellType)this.ai();else{var Ba=this.Tc.isOlap;lg.a(this.$).Zt(Ba,function(nb){nb&&D.$.jc(c,function(Rb,Ic,Wc){if(ae.EwaSettings.ka(530)){var Rd=D.oxc,Ge=D.activeCell,df=D.xb?D.xb.Caption:null,Wf=D.S7a;Rb=wd.b(Rb,Object(xd.a)(D,D.ixi,"onPerformPivotTableOperationSuccessCallback"));Ic=wd.a(Ic,Object(xd.a)(D,D.hxi,"onPerformPivotTableOperationFailedCallback"));var Pg=D.$.ra.ua.Wb();Pg=Rd.Na(41,void 0===Pg?null:Pg);Pg.activeCell=Ge;Pg.operationType=k;Pg.fieldCaption=df;Pg.prevFieldCaption=
Wf;Wc=hg.i(Rd,"ExecutePivotTableOperation",Pg,Rb,Ic,Wc,null,0)}else Rd=D.oxc,Ge=D.activeCell,df=D.$.ra.ua.Wb(),df=Rd.Na(41,void 0===df?null:df),df.activeCell=Ge,df.operationType=k,Wc=hg.i(Rd,"PerformPivotTableOperation",df,Rb,Ic,Wc,null,0);return Wc},ba,0,4,229)})}};Sc.prototype.ixi=function(){this.w9a()};Sc.prototype.hxi=function(){this.w9a()};Sc.prototype.applyValueFieldSettingsToPivotTable=function(c,k){var D=this;k=void 0===k?!1:k;var ba=bh.a.Qa.Gb;this.Tc&&this.xb?(k&&(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?
2===this.xb.MeasureType:this.xb.IsImplicitMeasure)&&ed.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),k=this.Tc.isOlap,lg.a(this.$).Zt(k,function(Ba){Ba&&D.$.jc(c,function(nb,Rb,Ic){var Wc=D.oxc,Rd=D.activeCell,Ge=D.Xy;nb=wd.b(nb,Object(xd.a)(D,D.woi,"onApplyValueFieldSettingsToPivotTableSuccessCallback"));Rb=wd.a(Rb,Object(xd.a)(D,D.voi,"onApplyValueFieldSettingsToPivotTableFailedCallback"));var df=D.$.ra.ua.Wb();df=Wc.Na(41,void 0===
df?null:df);df.activeCell=Rd;df.pivotValueFieldSettingsApplyData=Ge;return hg.i(Wc,"ApplyValueFieldSettingsToPivotTable",df,nb,Rb,Ic,null,0)},ba,0,4,231)})):this.ai()};Sc.prototype.woi=function(){this.w9a()};Sc.prototype.voi=function(){this.w9a()};Sc.prototype.Wd=function(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd){Ba=void 0===Ba?null:Ba;nb=void 0===nb?null:nb;Rb=void 0===Rb?null:Rb;Ic=void 0===Ic?8:Ic;Wc=void 0===Wc?null:Wc;Rd=void 0===Rd?!1:Rd;ba&&(c+=".Checked");Rd&&(c+=".Disabled");this.Sa.pgd(c)&&this.Sa.rBd(c);
D=af.a.ma(Ba)?de.a.instance.da(D):Ba;c=this.Sa.zFa(c,D,k,null,"None",nb,Rd,null);c.lqc(null);af.a.ma(Rb)||c.PQ(Rb);ba?c.RQ("Image16by16",3,ia.a.H9):Wc?c.RQ("Image16by16",Ic,Wc):c.lZb();return c};Sc.prototype.$sa=function(c,k,D,ba,Ba){Ba=void 0===Ba?null:Ba;D=af.a.ma(Ba)?de.a.instance.da(D):Ba;this.Sa.pgd(c)?this.Sa.rBd(c):this.Sa.rBd(c+".Checked");ba&&(c+=".Checked");this.Lcj&&(D=this.h5g.parseFromString(D,"text/html").body.innerText);c=this.Sa.VYc(c,null,D,k,3,ia.a.H9);c.B0e=ba;!ba&&ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&
c.lZb();return c};Sc.prototype.bVh=function(){this.Xy=Object.assign(new he,{PivotValueFieldSummarizeValueByApplyData:Object.assign(new Ea,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object.assign(new wc,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};Sc.prototype.qPa=function(c,k){this.Xy.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=c;this.Xy.PivotValueFieldShowValueAsApplyData.SelectedBaseField=k;this.Xy.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=
-1};Sc.prototype.xsh=function(){var c=[];if(this.Tc&&this.Tc.b9&&0<this.Tc.b9.length)for(var k=Ol(this.Tc.b9),D=k.next();!D.done;D=k.next())(D=D.value)&&Array.add(c,D);if(this.Tc&&this.Tc.gK&&0<this.Tc.gK.length)for(k=Ol(this.Tc.gK),D=k.next();!D.done;D=k.next())(D=D.value)&&Array.add(c,D);c.sort(function(ba,Ba){return ba.Index-Ba.Index});return c};Sc.prototype.lSf=function(){if(!this.Rf||!this.Tc||!this.Tc.gK)return!1;var c=1===this.Rf.CellArea||4===this.Rf.CellType&&this.Rf.IsRowAxis,k=4===this.Rf.CellType?
0<this.Tc.N_c:0<this.Rf.CurrentFieldIndex;return 1<this.Tc.gK.length&&c&&k};Sc.prototype.gIa=function(c){var k=[];3===c?this.$.isEditMode?Array.addRange(k,[ja.a.swf,ja.a.uwf,ja.a.KFi]):Array.addRange(k,[ja.a.copy]):2===c&&Array.add(k,ja.a.Yoe);return k};Sc.prototype.ai=function(){var c=Qg.a.gd(1,0,0,626,0,104573951,"PivotTableContextMenuOperationFailure");Bi.a(this.$).ai(c)};Sc.prototype.ut=function(){this.iQd();this.V$=!1};Sc.prototype.vs=function(){if(this.V$){ed.ULS.sendTraceTag(537167E3,0,50,
"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");var c=this.Tc;this.grid.$b.Up(this.grid.ga.wa.activeCell)!==c&&(this.w9a(),this.xRh())}};Sc.prototype.uej=function(){return this.xb?!!this.xb.LabelOrDateFilterType||!!this.xb.ValueFilterType||this.xb.HasManualFilter:!1};Sc.prototype.rej=function(c){return 62<=c&&65>=c};Sc.prototype.z$h=function(){if(this.activeCell&&this.xb&&this.Tc){var c={};c.cell=this.activeCell;c.dataSourceIndex=this.Tc.externalSourceIndex;
c.fieldId=this.xb.Index.toString();c.isOlap=this.Tc.isOlap;c.confirmationRequired=this.Tc.confirmationRequiredForDataOps;this.$.De(492140419,Dg.a.Tb,19,{showPivotFilterDialogCommandData:c})}};Sc.prototype.wLg=function(c){var k=this;this.activeCell&&this.xb&&this.Tc&&this.$.userOperationManager.jc(new te.a(153,0,function(D,ba,Ba){return hg.W(k.$.ra.ua,k.activeCell,k.Tc.externalSourceIndex,k.xb.Index.toString(),c,D,ba,Ba,null,null)}),null)};Sc.prototype.Mxg=function(c){var k=this;!(30>c||61<c)&&this.activeCell&&
this.xb&&this.Tc&&this.$.userOperationManager.jc(new te.a(152,0,function(D,ba,Ba){return hg.g(k.$.ra.ua,k.activeCell,k.Tc.externalSourceIndex,k.xb.Index.toString(),c,D,ba,Ba,null,null)}),null)};Sc.prototype.applyPivotSort=function(c){var k=this;if(this.Tc&&this.xb&&this.activeCell&&this.Rf){var D=1===this.Rf.CellArea||2===this.Rf.CellArea;8===this.Rf.CellArea?uh.a(this.$.userOperationManager,function(ba,Ba,nb){return hg.e(k.$.ra.ua,k.activeCell,c,k.xb.Caption,ba,Ba,nb,null)},function(ba){return new te.a(1015,
0,ba,void 0,null)},null):D&&(D=1===this.Rf.CellArea?1:2,this.$.ka(739)?vf.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,this.xb.Index.toString(),this.xb.Caption,this.Tc.isOlap?"":this.xb.Caption,D,1===c):vf.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,this.xb.Index.toString(),1===c))}};Sc.prototype.Zcj=function(){return(this.Rf||this.Tc)&&4!==this.Rf.CellType&&(this.Rf.CellType||
8!==this.Rf.CellArea||this.Tc.b9&&this.Tc.b9.length||this.Tc.gK&&this.Tc.gK.length)?!1:!0};Sc.prototype.$cj=function(){return this.Rf&&this.Tc&&(1===this.Rf.CellArea||2===this.Rf.CellArea)&&this.Tc.LKb&&this.Tc.LKb.length?!1:!0};Ll.Object.defineProperties(Sc.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.nBf}}});Object(qd.a)(Sc,"PivotTableContextMenu",ie.a,[]);var gh=b(258),ud=ie.a;Em(Yd,
ud);Yd.prototype.executeCommand=function(c,k,D){c=k.command;switch(c){case 639960842:this.applyTableFieldList(D);this.iV.Tba();break;case -1085236154:D=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.Trd);ed.ULS.sendTraceTag(537166999,0,50,D);this.iV.Tba();break;case 1833782813:this.iV.showCallout();break;default:return Nh.a(c)}return pg.Task.Ra(!0)};Yd.prototype.applyTableFieldList=function(c){var k=c.MenuItemId.toString();ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(k=k.replace("'","''"),k=k.replace("[","'["),k=k.replace("]","']"));var D=Object(Og.a)(String,c.SourceControlId),ba={};ba.PulloutField=k;ba.PulloutCardPath=c.SourceCardKeyPath;ba.PulloutCardSourceRow=c.SourceCardRow;ba.PulloutCardSourceColumn=c.SourceCardColumn;if(this.iV.gM){ed.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");ba.ParameterType=2;c=c.ColumnIndex;if(void 0===c||null===c){if(void 0===D||null===D){ed.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}c=parseInt(D.substring(20+k.length+1,D.length));if(isNaN(c)){k=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",D);ed.ULS.shipAssertTag(537166997,0,!1,k);return}}ba.PulloutRichColumnSourceIndex=c;if(this.jRb.svg){this.iwg(k,ba);return}}else ed.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),ba.ParameterType=4,D=this.iV.selectedRange.right,void 0!==ba.PulloutCardSourceColumn&&null!==ba.PulloutCardSourceColumn&&(D=ba.PulloutCardSourceColumn+
1),ba.PulloutRichColumnSourceIndex=D;this.sHd(k,ba)};Yd.prototype.sHd=function(c,k,D){D=void 0===D?0:D;var ba=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.Trd,k.PulloutRichColumnSourceIndex);ed.ULS.sendTraceTag(537166996,0,50,ba);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",k.ParameterType,k.PulloutRichColumnSourceIndex);c=Object.assign(new gh.a,{Text:c});
this.grid.setCell(c,this.iV.jwa,0,127,k,D);this.grid.focus();this.U0b=null;this.iV.Tba();this.iV.kZi()};Yd.prototype.Ec=function(c,k,D){if(c=this.$.isEditMode&&ae.EwaSettings.ka(136)&&!!this.iV)switch(k.command){case -1085236154:break;case 639960842:c=!!D;break;case 1833782813:c=this.iV.Cua&&this.iV.Cxb;break;default:c=!1}return c};Yd.prototype.lN=function(c,k,D){this.$.isEditMode&&(this.U0b=this.Nrh(Object(Og.a)(703,D)),ud.prototype.lN.call(this,c,k,null,null,!1))};Yd.prototype.OX=function(){return this.U0b};
Yd.prototype.TYc=function(c){if(!this.iV||!c||!c.ol)return ed.ULS.shipAssertTag(537166994,0,!!this.iV,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),ed.ULS.shipAssertTag(537166993,0,!!c,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),c&&ed.ULS.shipAssertTag(537166992,0,!!c.ol,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var k=new Tf.a;c=Ol(c.ol);for(var D=c.next();!D.done;D=c.next()){var ba=
D.value;D=new Tf.a;D.add(ba.ColumnName);D.add(ba.ColumnIndex.toString());var Ba=new Tf.a;Ba=u.OBc(u.concat(Ba,u.select(u.asEnumerable(ba.FieldInfoDataList),function(nb){return nb.Name})),function(nb){return nb},new Xe);ba=new Tf.a;ba.add(u.toArray(u.concat(D,Ba)));k=u.toList(u.concat(k,ba))}return u.toArray(k)};Yd.prototype.Nrh=function(c){var k=this.TYc(c);if(!k||!k.length)return this.U0b=null;var D=this.Sa;c=D.Oc();var ba=1<k.length;this.Trd=k.length;k=Ol(k);for(var Ba=k.next();!Ba.done;Ba=k.next()){var nb=
Ba.value;ba||(c.title=nb[0]);Ba=D.Oc();for(var Rb=2,Ic=nb.length;Rb<Ic;++Rb)Array.add(ba?Ba.buttons:c.buttons,D.zFa("ApplyTableFieldList."+nb[Rb]+"."+nb[1],nb[Rb],639960842,null,"None",nb[Rb],!1,void 0,!0));ba&&(nb=D.Kz("ApplyTableFieldList."+nb[0],this.menuId,nb[0],798637440),Array.add(nb.menu.Bc,Ba),Array.add(c.buttons,nb))}D=D.$o(this.menuId);Array.add(D.Bc,c);return D};Yd.prototype.iwg=function(c,k){var D=this,ba=Qg.a.gd(12,1,0,859,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(ae.EwaSettings.eA()){var Ba=
new qe.a(this.$,ba);Ba.mO(function(){2===Ba.returnValue&&D.sHd(c,k,8)})}else{var nb=new nd.ErrorDialog(this.$,ba);nb.mO(function(){2===nb.returnValue&&D.sHd(c,k,8)});nb.mf()}};Ll.Object.defineProperties(Yd.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.pBf}},iV:{configurable:!0,enumerable:!0,get:function(){this.jRb||(this.jRb=this.$.ea.Ba(261));return this.jRb}}});Object(qd.a)(Yd,
"PulloutFieldListContextMenu",ie.a,[]);var Jh=ie.a;Em(yg,Jh);yg.prototype.Ec=function(c,k,D){return-1687037502===k.command&&!!D&&this.grid.isEditing};yg.prototype.executeCommand=function(c,k,D){this.showRichTextFloatie(D);return pg.Task.Ra(!0)};yg.prototype.gIa=function(){return[ja.a.bJg]};yg.prototype.showRichTextFloatie=function(c){var k=Object(Og.a)(K.a,c.eventArgs);k&&(c=this.gIa(k.yb),k=new Sys.UI.Point(k.Ea.clientX,k.Ea.clientY),this.showFloatie(c,new Sys.UI.Bounds(k.x,k.y,0,0),2))};Ll.Object.defineProperties(yg.prototype,
{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.ANi}}});Object(qd.a)(yg,"RichTextContextMenu",ie.a,[]);var bg=b(95),xj=ie.a;Em(sg,xj);sg.prototype.executeCommand=function(c,k,D){if(Ac.a(this.$))return pg.Task.Ra(!0);this.$.isEditMode&&(c=D[xe.a.Zbj],c=c.x&&c.y?new Sys.UI.Point(c.x+(this.$.isChromeRtl?10:-10),c.y):Ne.DOMElementExtensions.getLocation(D[xe.a.$bj]),this.wn(c,!1));return pg.Task.Ra(!0)};
sg.prototype.Ec=function(c,k,D){return-1075099431===k.command&&!!D};sg.prototype.OX=function(){var c=this.Sa.$o(this.menuId),k=this.$.isEditMode;this.Xyj();this.zrh(c,k);this.prh(c);this.qsh(c);return c};sg.prototype.NUb=function(c,k,D,ba){Array.add(c,this.Sa.Ab(k?D:ba))};sg.prototype.zrh=function(c,k){var D=this.Sa,ba=D.Oc();Array.add(ba.buttons,D.Ab(54));this.NUb(ba.buttons,this.ldc,127,56);Array.add(ba.buttons,D.Ab(55));k&&this.NUb(ba.buttons,this.ldc,126,125);Array.add(ba.buttons,D.Ab(158));this.$.fa.ZGb&&
(k=Object(Og.a)(bg.a,this.$.qa))&&ch.q(k)&&(Array.add(ba.buttons,D.Ab(274)),k.isLockPausedInSession?Array.add(ba.buttons,D.Ab(276)):k.Pi&&Array.add(ba.buttons,D.Ab(275)));k=D.Kz("ContextMenu.TabColor",null,de.a.instance.da(496),1841703919);D=D.PYc(467002767,1549407384,519,-221093529,this.rA);Array.add(k.menu.Bc,D);Array.add(ba.buttons,k);Array.add(c.Bc,ba)};sg.prototype.prh=function(c){var k=this.Sa.Oc();this.NUb(k.buttons,this.ldc,114,112);this.NUb(k.buttons,!this.Tbc,115,113);Array.add(c.Bc,k)};
sg.prototype.qsh=function(c){if(ae.EwaSettings.ka(507)&&!ch.e(this.$.va.qa)){var k=this.Sa,D=k.Oc();Array.add(D.buttons,k.Ab(260));Array.add(c.Bc,D)}};sg.prototype.Xyj=function(){var c=this.$.wYc();var k=c.xYc;c=c.Aue;this.ldc=1===k;this.Tbc=0<c};Ll.Object.defineProperties(sg.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.rBf}}});Object(qd.a)(sg,"SheetOpsContextMenu",ie.a,[]);var xi=b(518),
O=ie.a;Em(ig,O);ig.prototype.Wc=function(c,k){var D=!0;switch(k){case -231711729:D=!1;break;case -1909381757:D=this.F8b();D=!!D&&D.K1h;break;case 1312363469:D=ae.EwaSettings.ka(471)}return!D||O.prototype.Wc.call(this,c,k)};ig.prototype.executeCommand=function(c,k,D){if(!this.$.isEditMode)return Kf.TaskExtensions.p3();c=k.command;k=this.F8b();var ba=null;switch(c){case 2108047455:k&&k.Yqe();break;case -231711729:ed.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;
case -1909381757:k&&k.sZb();break;case 1312363469:this.showSlicerContextMenu(D);break;default:ba=Nh.a(c)}return ba||Kf.TaskExtensions.p3()};ig.prototype.Ec=function(c,k,D){c=!1;switch(k.command){case -231711729:case 2108047455:case -1909381757:c=!0;break;case 1312363469:c=ae.EwaSettings.ka(471)&&!!D}return c};ig.prototype.OX=function(){var c=this.Sa.$o(this.menuId),k=this.Sa.Oc();Array.add(k.buttons,this.Sa.Ab(249));ae.EwaSettings.ka(510)&&Array.add(k.buttons,this.Sa.Ab(250));Array.add(k.buttons,
this.Sa.Ab(251));Array.add(c.Bc,k);k=this.Sa.Oc();this.z6h()?Array.add(k.buttons,this.Sa.Ab(263)):Array.add(k.buttons,this.Sa.Ab(264));Array.add(c.Bc,k);return c};ig.prototype.z6h=function(){if(Xg.a.Jd(this.$)){var c=this.$.ea.Ba(439);if(c)return c.kr}else if(c=this.$.ea.Ba(371))return c.kr;return!1};ig.prototype.showSlicerContextMenu=function(c){var k=Object(Og.a)(K.a,c.eventArgs);c=this.g7b(Object(Og.a)(K.a,c.eventArgs));k=k.yb;Dg.a.Tb=k;this.wn(c,!1,k)};ig.prototype.wNe=function(c){var k=this.Sa.Oc(),
D=this.Sa.Oc();Array.add(D.buttons,this.Sa.Ab(252));Array.add(D.buttons,this.Sa.Ab(253));var ba=this.Sa.VYc("ContextMenu.SlicerSort",null,de.a.instance.da(2080),-814639094,0,ia.a.EGe);Array.add(ba.menu.Bc,D);Array.add(k.buttons,ba);Array.add(c.Bc,k)};ig.prototype.Kej=function(c){return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&c.Sb.className===ia.a.eGe||ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&
1===c.yb};ig.prototype.g7b=function(c){var k=ze.g(this.$).ga.Pa.kc,D=c&&1!==c.yb&&c.clientPoint?c.clientPoint:Sys.UI.DomElement.getLocation(k.domElement);if(this.Kej(c)){var ba=this.F8b();ba&&(c.Sb.className===ia.a.eGe&&(D=Gb.HelperMethods.Lrb(c.Ea)),1===c.yb&&(D=De.a(this.$).xIa(Ne.DOMElementExtensions.getLocation(ba.frame))))}else if(c=this.F8b())c=this.yAh(c.frame),(ba=Gb.HelperMethods.Uz(this.$.Re,this.$.domElement,ze.g(this.$).rtl,!1))?(c.x=De.a(this.$).ri(c.x-ba.x)+ba.x,c.y=De.a(this.$).ri(c.y-
ba.y)+ba.y):ed.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),D.y+=c.y,D.x+=c.x;c=this.$.domElement;ba=ze.g(this.$).rtl;k=Gb.HelperMethods.Uz(k.Ag.domElement,c,ba);D.y=Math.max(D.y,k.y);D.x=Math.max(D.x,k.x);return D};ig.prototype.F8b=function(){var c=ze.g(this.$).ga.Pa.kc;ed.ULS.shipAssertTag(537166988,0,!!c);return xi.a(this.$).SB(c.floatingObject.id)};ig.prototype.yAh=function(c){var k=new Sys.UI.Point(c.offsetParent.offsetLeft,c.offsetParent.offsetTop),D=ze.g(this.$);if(!D)return k;
var ba=ze.g(this.$).rtl;k=Gb.HelperMethods.Uz(c,this.$.Yq.ownerDocument.body,ba);D.rue(k);k.x=ba?this.$.Yq.clientWidth-k.x-c.clientWidth:k.x;c=D.view.Tlb;D=ba?-D.$M.Iaa(c.x):c.x;k.x-=D;k.y-=c.y;return k};Ll.Object.defineProperties(ig.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.sBf}}});Object(qd.a)(ig,"SlicerContextMenu",ie.a,[]);Object(qd.a)(Eg,"TimeSlicerRibbonButtonParameter",null,[]);
var qa=ie.a;Em(Gg,qa);Gg.prototype.executeCommand=function(c,k,D){c=k.command;switch(c){case 2000085697:c=D.DOMElement;this.Mqa=D.ChangeLevelCallback;this.rIa=D.GetLevelLabelCallback;this.WYa=D.CurrentLevel;var ba=D.DomEvent;mg.g(ba);var Ba=D.location;D=D.levelLabelText;this.UBe=Ne.DOMElementExtensions.ty(document.activeElement,"iframe")&&D?D.parentNode:null;D=Sys.UI.DomElement.getBounds(D);D.x=Ba.x;D.y=Ba.y;this.lN(ba,c,D,k,!0);break;case -649826274:this.Mqa(0);break;case 149600865:this.Mqa(1);break;
case -2012435159:this.Mqa(2);break;case -1979934975:this.Mqa(3);break;case 1634477200:Ne.DOMElementExtensions.setFocus(this.UBe);break;default:return Nh.a(c)}return pg.Task.Ra(!0)};Gg.prototype.Ec=function(c,k,D){c=!1;switch(k.command){case 2000085697:c=!!D;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:c=!0}return c};Gg.prototype.lN=function(c,k,D){c=Sys.UI.DomElement.getBounds(k);D.x=De.a(this.$).ri(D.x);D.y=De.a(this.$).ri(D.y);c.x=De.a(this.$).ri(c.x);c.y=
De.a(this.$).ri(c.y);c=new Sys.UI.Point(c.x+D.x,c.y+D.y);this.fRa(c,k);this.showContextMenu(new Sys.UI.Bounds(c.x,c.y-D.height,D.width,D.height))};Gg.prototype.OX=function(){for(var c=this.Sa,k=c.$o(this.menuId),D=c.Oc(),ba=0;3>=ba;ba++){var Ba=this.rIa(ba),nb=Gg.bvh(ba);nb=c.WRg(nb.$Pg,nb.Mo,this.WYa===ba,Gg.bqe);nb.label=Ba;nb.PQ(Ba);this.WYa===ba?nb.RQ("Image16by16",8,Gg.bqe):nb.lZb();Array.add(D.buttons,nb)}Array.add(k.Bc,D);return k};Gg.bvh=function(c){var k=null;switch(c){case 0:k=new Eg(87,
"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:k=new Eg(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:k=new Eg(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:k=new Eg(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return k};Ll.Object.defineProperties(Gg.prototype,{xt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},rA:{configurable:!0,enumerable:!0,get:function(){return xe.a.vBf}}});Gg.Rpj="TimeSlicerLevelMenu";Gg.ZEb=
"TimeSlicerLevelMenuRootName";Gg.bqe="ewamenu_CheckmarkApplied";Object(qd.a)(Gg,"TimeSlicerLevelMenu",ie.a,[]);var rb=b(307),Sb=b(220),Uc=b(3),vd=Ud.a;Em(Uf,vd);Uf.prototype.Gd=function(){var c=this,k=this.$,D=Sb.a.OYa(ve.b(),this.la,"Task","IRootUser"),ba=Dd.a(k),Ba=null;Ba=function(Ic,Wc){ba.CFf(Ba);D.setResult(Wc.E_b)};ba.Ufe(Ba);ba.WSe();var nb=Wg.GetServiceTaskFactory.create(k.ea,102,k.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),Rb=Wg.GetServiceTaskFactory.Va(k.ea,
342,338,this.rb,"Microsoft.Office.Excel.WebUI.Client.ContextMenu.IContextMenuController");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([D.task,nb,Rb],this.la),function(){var Ic=nb.result,Wc=D.task.result,Rd=Rb.result;c.Ad([new Qc(k,Wc,Ic,Rd),new Rg(k,Wc,Ic,Rd),new Hf(k,Wc,Ic,Rd),new Se(k,Wc,Ic,Rd),new Jg(k,Wc,Ic,Rd),new zf(k,Wc,Ic,Rd),new qg.GridContextMenu(k,Wc,Ic,Rd),new Ag(k,Wc,Ic,Rd),new sg(k,Wc,Ic,Rd),new Gg(k,Wc,Ic,Rd),new Yd(k,Wc,Ic,Rd),new gg(k,Wc,Ic,Rd),new Sc(k,Wc,Ic,Rd),new ig(k,Wc,Ic,Rd),
new yg(k,Wc,Ic,Rd)])},k.la,3)};Uf.initData=function(){var c=rb.a.e1;c(2000085697,20479,0,0);c(-227942804,Uc.a.Ic|24576,0,0);c(1634477200,Uc.a.Ic|131072,0,0);c(-649826274,4095,0,0);c(149600865,4095,0,0);c(-2012435159,4095,0,0);c(-1979934975,4095,0,0);c(1247109494,Uc.a.Ic|24576,0,0);c(-2064931494,Uc.a.Ic|131072,0,0);c(-1396319072,Uc.a.Ja,128,0);c(-425234874,Uc.a.Ja,128,0);c(-1253126584,Uc.a.Ja,0,0);c(274207288,Uc.a.Ic|24576,0,0);c(-1497523576,Uc.a.Ic|131072,0,0);c(-498523270,Uc.a.Ic|24576,64,0);c(1640762262,
Uc.a.Ic|131072,64,0);c(-2017893763,Uc.a.Ic|24576,0,0);c(1350204367,Uc.a.Ic|131072,0,0);c(-889576107,Uc.a.lv,128,0);c(-1170196828,Uc.a.lv,128,0);c(389774337,Uc.a.lv,128,0);c(1529312473,Uc.a.lv,128,0);c(2033235475,Uc.a.lv,128,0);c(-96230454,Uc.a.lv,128,0);c(74086617,Uc.a.lv,128,0);c(563292088,Uc.a.lv,128,0);c(-1092351914,Uc.a.lv,128,0);c(-2141589616,Uc.a.lv|16384,128,0);c(745182485,Uc.a.lv,0,0);c(359279088,Uc.a.lv,128,0);c(-67292059,Uc.a.lv,128,0);c(926905850,Uc.a.lv,128,0);c(547535945,Uc.a.lv,128,
0);c(1374696078,Uc.a.Ic|24576,0,0);c(495005930,Uc.a.Ic|212992,0,0);c(-1045020714,Uc.a.Ic|24576,0,0);c(-170383950,Uc.a.Ic|212992,0,0);c(324156914,Uc.a.Ja,0,0);c(-1085236154,Uc.a.Wt,0,0);c(-751848458,Uc.a.al|16384,0,0);c(216058793,Uc.a.Wt,0,0);c(474690375,Uc.a.al|16384,0,0);c(-1920954846,Uc.a.Ic|24576,0,0);c(723126814,Uc.a.Ic|131072,0,0);c(2108047455,128,128,0);c(-231711729,128,128,0);c(-1909381757,128,128,0);c(-814639094,128,128,0);c(1701016594,Uc.a.Ic|3072,128,0);c(-1475408662,Uc.a.Ic|24576,0,0);
c(1114549926,Uc.a.Ic|131072,32,0)};Uf.ja=function(c){Ud.a.Yd(10,new Uf(c))};Object(qd.a)(Uf,"ContextMenuCommandHandlerFactory",Ud.a,[]);var oe=b(212),ef=b(1353),Nf=b(97),kh=b(251);xf.prototype.dispose=function(){};xf.prototype.w9=function(){this.Mnb.t2()};xf.prototype.IB=function(){this.Mnb.IB()};xf.prototype.wKd=function(c,k,D){jg.h(this.$,jg.b);this.Mnb.showContextMenu(Object.assign(new ef.a,{x:k.x,y:k.y}),D,c);Nf.EventHandlerManager.instance.O6c()};xf.prototype.isc=function(c,k,D){jg.h(this.$,
jg.b);this.Mnb.showFloatie(Object.assign(new ef.a,{x:k.x,y:k.y}),c,D);kh.a(function(){Nf.EventHandlerManager.instance.O6c()},this.$.la)};xf.prototype.vKd=function(c,k,D,ba){jg.h(this.$,jg.b);this.Mnb.vKd(Object.assign(new ef.a,{x:k.x,y:k.y}),c,D,ba)};Object(qd.a)(xf,"ReactContextMenuController",null,[705,6]);var Md=oe.a;Em(Fg,Md);Fg.prototype.dispose=function(){this.n1e&&this.$&&this.$.fa.Er(Object(xd.a)(this,this.Yed,"initReactControllerAndInfrastructure"));Md.prototype.dispose.call(this)};Fg.prototype.create=
function(){this.$.fa.Wh?(ed.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.fa.Wh),this.Yed(null,null)):(this.n1e=!0,this.$.fa.oo(Object(xd.a)(this,this.Yed,"initReactControllerAndInfrastructure")))};Fg.prototype.Yed=function(){var c=this,k;(k=this.$.ea.Ba(342))?this.Eb(k):this.$.RD(function(D){D.Xed().then(function(ba){(k=c.$.ea.Ba(342))?c.Eb(k):(k=new xf(c.$,ba),c.Eb(c.$.ea.Ia(342,k)))})})};Fg.ja=function(c){c.ea.Ia(338,
new Fg(c))};Object(qd.a)(Fg,"ContextMenuControllerFactory",oe.a,[]);var Je=b(156);Object(qd.a)(Ef,"RibbonCommandParams",null,[]);Object(qd.a)(wg,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);Sg.prototype.mvh=function(c){return(c=this.U9b[c.toString()])?c.menuModel:null};Sg.prototype.jne=function(c,k){this.U9b[k.toString()]=Object.assign(new wg,{menuModel:c,Ywe:Gb.HelperMethods.Ac()})};Sg.prototype.ypb=function(c){this.U9b[c.toString()]=null};Sg.prototype.KJh=function(c){return(c=this.U9b[c.toString()])?
c.Ywe:-1};Object(qd.a)(Sg,"FilterMenuCache",null,[]);var qf=b(13),ej=b(203),$f=b(278);Object(qd.a)(Vf,"AutoFilterEventRegistrationArgs",null,[]);var mi=b(25);hf.prototype.dispose=function(){window.cancelAnimationFrame(this.Dxb);this.gridView&&this.gridView.cnc(Object(xd.a)(this,this.pAb,"onGridViewBlockRendered"));this.gridView=null};hf.prototype.jUh=function(){if(this.QJd=Gb.HelperMethods.L3a)this.RWa=[];this.Ipg();this.gridView.gVb(Object(xd.a)(this,this.pAb,"onGridViewBlockRendered"))};hf.prototype.Ipg=
function(){for(var c=Ol(this.gridView.ao),k=c.next();!k.done;k=c.next()){k=k.value.$za;for(var D in k){var ba=k[D];this.Rzf(ba.domElement,ba.hashCode)}}};hf.prototype.pAb=function(c){this.Rzf(c.domElement,c.hashCode)};hf.prototype.Rzf=function(c,k){if(ze.g(this.$).Ca.zl.BZa(k))if(c){c=c.querySelectorAll('[id^="'+xe.a.J5c+'"]');for(var D=0;D<c.length;D++){var ba=c[D],Ba=ba.getAttribute(xe.a.Plh),nb=ba.getAttribute(xe.a.Ilh);ed.ULS.shipAssertTag(537167053,0,!af.a.ma(Ba)&&!af.a.ma(nb),"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",
ba.id,k);Ba=mi.Range.ld(parseInt(Ba),parseInt(nb));ba=Object.assign(new Vf,{cell:Ba,Uke:ba,Rd:k});this.QJd?(this.RWa.push(ba),this.Dxb||(this.lEe=window.performance.now(),this.Dxb=window.requestAnimationFrame(Object(xd.a)(this,this.mDf,"registerQueuedAutoFilterEventHandler")))):this.nee(ba)}}else ed.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",k);else ed.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",
k)};hf.prototype.mDf=function(c){for(var k=0;window.performance.now()-c<this.f$g&&0<this.RWa.length;)this.nee(this.RWa.shift()),k++;ed.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",this.p3c,k,this.RWa.length);0<this.RWa.length?this.Dxb=window.requestAnimationFrame(Object(xd.a)(this,this.mDf,"registerQueuedAutoFilterEventHandler")):(ed.ULS.sendTraceTag(537167051,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",
this.p3c,window.performance.now()-this.lEe),this.p3c++,this.Dxb=0)};hf.prototype.nee=function(c){var k=this.gridView.Ca.g8b(c.cell,c.Rd);k?this.Hpg(c.Uke,k):ed.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",c.Rd,c.cell)};hf.prototype.Hpg=function(c,k){k.hasAutoFilter?this.Lng(c,k.I5c):k.u3?this.Fpg(c,k.I5c,k.c7e):ed.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
Je.a.instance.pa(qf.a.yf,c,Object(xd.a)(this,this.onPointerDown,"onPointerDown"));ej.a.instance.pa(qf.a.dwa,c,Object(xd.a)(this,this.onPointerDown,"onPointerDown"))};hf.prototype.Lng=function(c,k){$f.a.instance.pa(qf.a.click,c,function(D){af.a.ma(k)||vf.a.hrc(D.Ea.rawEvent,966232027,k,null);return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5465680_FixForAutoFilterClickHandlers")?!0:!1})};hf.prototype.Fpg=function(c,k,D){var ba=Sf.a.Xh(k);$f.a.instance.pa(qf.a.click,c,function(Ba){D?vf.a.spf(document.getElementById(ba.EwaElementId),
ba.Cell,ba.DataSourceIndex,ba.FieldId,ba.IsOlap,ba.RequiresConfirmation,Ba.Ea.rawEvent,ba.OptionalPivotMenuAnchor):vf.a.spfm(Ba.Ea.rawEvent,ba.RequiresConfirmation,ba.Cell,ba.DataSourceIndex,ba.PivotName,ba.OptionalPivotMenuAnchor);return!1})};hf.prototype.onPointerDown=function(c){vf.a.slim(c.Ea.rawEvent);return!1};Object(qd.a)(hf,"FilterMenuPointerEventsManager",null,[6]);Pe.prototype.dispose=function(){ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
this.pKe.dispose();this.$=null};Pe.prototype.gBh=function(c){var k=ze.g(this.$).Ca.xqa(c,this.$.activeItemName);return k&&k.blockPresentInViewportTimeStamp>this.Zva.KJh(c.left)?k.hs(c).autoFilterMenu:this.Zva.mvh(c.left)};Pe.prototype.qui=function(c,k,D){this.Zva&&(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.Zva.jne(c.menuModel[k],D):this.Zva.jne(c.menuModel[k],c.left+k))};Pe.prototype.rui=function(c,k,D){this.Zva&&
(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.Zva.ypb(D):this.Zva.ypb(c.left+k))};Object(qd.a)(Pe,"FilterMenuManager",null,[704,6]);var qj=b(222),yh=b(171);nf.prototype.J8c=function(c){return rg.a.zc(this.Esc,c)};nf.prototype.dispose=function(){this.Bd?ed.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Bd=!0,this.$&&(this.$.dl(nf.jd),this.$.ea.cP(8),
this.ga&&this.ga.Xmc(Object(xd.a)(this,this.Uk,"onContextMenu")),this.$.Ka.Z8a(Object(xd.a)(this,this.Clf,"onContextMenuClosed")),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.U8a(Object(xd.a)(this,this.twa,"onCommandExecutionStarting")),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.J5(Object(xd.a)(this,this.P4,"onApplicationModeChanged"))),this.$=this.ga=null,this.e5b.dispose(),
this.Esc=this.KZd=null)};nf.prototype.showContextMenu=function(c,k,D){k=void 0===k?null:k;D=void 0===D?null:D;this.qej(c)&&(jg.h(this.$,jg.i),c=this.gTg(c,k,D),this.$.Ka.Ub(c.Zd,c.dictionary))};nf.prototype.t2=function(){this.contextMenuController?this.contextMenuController.w9():ed.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};nf.prototype.Uk=function(c,k){this.showContextMenu(void 0===k?null:k)};nf.prototype.Clf=function(c,k){k.Nhi===
nf.qMh&&ze.g(this.$).focus()};nf.prototype.twa=function(c,k){(c=this.$.Ka.g$(k.Zd.command))&&c.dismissesContextualUI&&this.t2()};nf.prototype.qej=function(c){return Bi.a(this.$).Eq()?(ed.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Bi.a(this.$).OZ(yh.a.grid,qj.a.showContextMenu),!1):!this.$.Ka.njh&&(!c||c.Sb!==ze.g(this.$).domElement&&!af.a.equals(c.Sb.tagName,"INPUT",!0))};nf.prototype.gTg=
function(c,k,D){k=void 0===k?null:k;var ba={};D=(ba.eventArgs=c,ba.creationParams=void 0===D?null:D,ba);c=c?c.yb:-1;ba=this.ga.Pa.kc;var Ba=1441131127;ba?(k=ba.floatingObject,ed.ULS.shipAssertTag(537167059,0,!!k,"floatingObj shouldn't be null."),nf.ikd(k)?Ba=1312363469:nf.isPivotChart(k)?(D[Rg.iVc]=k?k.Nc:null,Ba=-149612405):Ba=-1372040782):nf.b7e(k)?(D[Rg.iVc]=k,Ba=-149612405):!jg.g(this.$)&&jg.f(ze.g(this.$))&&(Ba=671488277);k=new Th.a(Ba,c,this.$.dd,30,null);return Object.assign(new Ef,{Zd:k,dictionary:D})};
nf.prototype.P4=function(){var c=this;this.$.ea.cP(342);Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.create(this.$.ea,338,this.$.la,3,"Microsoft.Office.Excel.WebUI.Client.ContextMenu.IContextMenuController"),function(k){k=k.result;for(var D=Ol(c.Esc),ba=D.next();!ba.done;ba=D.next())ba.value.$Cf(k)},this.$.la)};nf.ja=function(c){c.Jk(nf.jd)};nf.jd=function(c){(c=Object(Og.a)(10,c))&&Wg.GetServiceTaskFactory.create(c.ea,9,c.la,0,"Microsoft.Office.Excel.WebUI.Client.IContextMenuManager")};nf.isPivotChart=
function(c){return!!c&&!c.type&&nf.b7e(c.Nc)};nf.ikd=function(c){return!!c&&2===c.type};nf.b7e=function(c){return!!c&&!!(c.Attributes&4)};Ll.Object.defineProperties(nf.prototype,{e5b:{configurable:!0,enumerable:!0,get:function(){return this.KZd}}});nf.aQg="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");nf.qMh="GridContextMenu";Object(qd.a)(nf,"ContextMenuManager",
null,[675,6]);var Li=oe.a;Em(Ke,Li);Ke.prototype.create=function(){var c=this,k=this.$,D=k.ic;if(D.allowSelection||D.allowEdits||D.allowFiltering||D.allowSorting||D.allowPivotSpecificOperations){var ba=Wg.GetServiceTaskFactory.create(k.ea,10,k.la,this.rb,"System.SpecificArray<Microsoft.Office.Excel.WebUI.Client.ICommandHandler>"),Ba=Wg.GetServiceTaskFactory.Va(k.ea,342,338,this.rb,"Microsoft.Office.Excel.WebUI.Client.ContextMenu.IContextMenuController");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([ba,
Ba],this.la),function(){c.Eb(Lf.a(k)||new nf(k,ba.result,Ba.result))},this.$.la,3)}else ed.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),k.ea.cP(8),this.Eb(null)};Ke.ja=function(c){c.ea.Ia(9,new Ke(c))};Object(qd.a)(Ke,"ContextMenuManagerFactory",oe.a,[]);ad.prototype.isEqual=function(c){return c?this.R3===c.R3&&this.S3===c.S3&&this.HM===c.HM&&this.IM===c.IM&&this.tA===c.tA&&this.ruleType===c.ruleType&&
this.IY===c.IY&&this.sS===c.sS&&this.rS===c.rS&&this.iU===c.iU&&this.$D===c.$D&&this.a4===c.a4&&this.b4===c.b4:(ed.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(qd.a)(ad,"DataValidationEditDialogState",null,[]);kc.prototype.Wc=function(){return!1};kc.prototype.executeCommand=function(c,k){-1728432249!==k.command&&Nh.a(k.command);this.selectedRanges=cf.r(ze.g(this.$).ga.wa.selectedRanges,this.$);ze.g(this.$).r_(!0);this.getDataValidationInitialState();
this.Kh=this.$.Vb.Dc("UserAction","DataValidationEditTimeToDialogOpen");this.DBe?ed.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(ed.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.DBe=!0);return pg.Task.Ra(!0)};kc.prototype.Ec=function(c,k){return-1728432249===k.command};kc.prototype.Yc=function(){return!1};kc.prototype.getDataValidationInitialState=function(){var c=this,k=this.$.ra.ua.Wb();uh.a(this.$.userOperationManager,
function(D,ba,Ba){return hg.u(c.$.ra.ua,c.selectedRanges,wd.b(D,Object(xd.a)(c,c.Msi,"onGetDataValidationInitialStateSuccessCallback")),wd.a(ba),Ba,k)},function(D){return new te.a(120,0,D,16)},null)};kc.prototype.Msi=function(c){ed.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!c||Hh.a(c)?ed.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(this.gZa=c.Result,this.oIi())};kc.prototype.oIi=function(){var c=this.MA={};switch(this.gZa.Command){case 0:var k="CreateNew";break;case 1:k="CreateNewFromRule";break;case 2:k="ExpandExisitng";break;case 3:k="OverrideExisitng";break;default:k="Unknown"}c.a=k;this.Kh&&(this.Kh.stop(),this.MA.r=this.Kh.id);switch(this.gZa.Command){case 0:this.MA.b=!1;this.MA.c="None";this.AFa(new ad);break;case 1:this.MA.b=!1;this.MA.c="None";this.AFa(new ad(this.gZa));break;case 2:this.MA.b=!0;this.Q_c.eSg(this.$,
Object(xd.a)(this,this.vjh,"expandExisitngDialogHandler"));break;case 3:this.MA.b=!0;this.Q_c.gSg(this.$,Object(xd.a)(this,this.wDi,"overrideExisitngDialogHandler"));break;default:ed.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};kc.prototype.AFa=function(c){this.Q_c.AFa(this.$,this.selectedRanges,c,this.gZa.Command);this.vei(c)};kc.prototype.vei=function(c){kc.Zob(c,this.MA);this.MA.d=!0;ve.b().Je(48,this.MA,!0)};kc.prototype.Zcf=
function(){this.MA.d=!1;ve.b().Je(48,this.MA,!0)};kc.prototype.vjh=function(c){this.vV("DataValidationEdit.ExpandExisitngDialog",c);this.MA.c=kc.Pga(c);1===c?this.AFa(new ad(this.gZa)):2===c?this.AFa(new ad):this.Zcf()};kc.prototype.wDi=function(c){this.vV("DataValidationEdit.OverrideExisitngDialog",c);this.MA.c=kc.Pga(c);1===c?this.AFa(new ad):this.Zcf()};kc.prototype.vV=function(c,k){var D={};c=(D.ButtonType=kc.Pga(k),D.DialogName=c,D.Location="dialog",D.NumberOfSelectedRanges=ze.g(this.$).ga.wa.MJ,
D);f.b(this.$).ee(Bh.a.T1b,c)};kc.Zob=function(c,k){k.e=Qd(c.ruleType);k.f=We(c.tA);k.g=!af.a.ma(c.HM);k.h=!af.a.ma(c.IM);k.i=c.R3;k.j=c.S3;k.k=c.b4;k.l=!af.a.ma(c.$D);k.m=!af.a.ma(c.iU);k.n=c.a4;k.o=c.IY;k.p=!af.a.ma(c.sS);k.q=!af.a.ma(c.rS)};kc.Pga=function(c){switch(c){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return ed.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(qd.a)(kc,"DataValidationEditCommandHandler",
null,[160]);var aj=b(956),gi=b(140),ii=b(154);Ll.Object.defineProperties(Ub,{tf:{configurable:!0,enumerable:!0,get:function(){return gi.a.$i(Ub.Jj,"")}},n2g:{configurable:!0,enumerable:!0,get:function(){return gi.a.$i(Ub.r2g,ii.a.da(1599),ii.a.da(1614),ii.a.da(1615),ii.a.da(1616),ii.a.da(1617),ii.a.da(1618),ii.a.da(1619),ii.a.da(1620),ii.a.da(1621),ii.a.da(1600),ii.a.da(1624),ii.a.da(1625),ii.a.da(1626),ii.a.da(1627),ii.a.da(1628),ii.a.da(1629),ii.a.da(1630),ii.a.da(1631),ii.a.da(1601),ii.a.da(1602),
ii.a.da(1622),ii.a.da(1623),ii.a.da(1613),"255")}},u2g:{configurable:!0,enumerable:!0,get:function(){return gi.a.$i(Ub.s2g,ii.a.da(1636),ii.a.da(1640),ii.a.da(1641),"255","32")}},y2g:{configurable:!0,enumerable:!0,get:function(){return gi.a.$i(Ub.t2g,ii.a.da(1635),ii.a.da(1638),ii.a.da(1637),ii.a.da(1639),ii.a.da(1640),ii.a.da(1641),"255","32")}}});Ub.rYf=255;Ub.Jj="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";
Ub.r2g="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
Ub.s2g="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
Ub.t2g="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(qd.a)(Ub,"DataValidationEditDialogHtml",null,[]);var of=b(572),Ui=Oh.a;Em(bb,Ui);bb.prototype.Aya=function(c){this.tS.selectedIndex=c.ruleType;this.PJ.selectedIndex=c.tA;this.$$b.checked=c.S3;this.oua.checked=c.R3;this.Uwa.value=c.HM;this.Vwa.value=c.IM;this.Saa(null)};bb.prototype.lmb=function(c){c.R3=this.oua.checked;c.S3=this.$$b.checked;c.tA=this.PJ.selectedIndex;c.ruleType=this.tS.selectedIndex;c.HM=this.Uwa.value;c.IM=this.Vwa.value};bb.prototype.dispose=function(){this.$l();this.nk=
this.uvd=this.Jjc=this.OMa=this.f7a=this.pLa=this.y2a=this.$$b=this.Vwa=this.Uwa=this.PJ=this.tS=this.oua=null;Ui.prototype.dispose.call(this)};bb.prototype.render=function(c){c.appendChild(this.domElement)};bb.prototype.pia=function(){return this.isVisible};bb.prototype.Pla=function(c){return this.isVisible=c};bb.prototype.setFocus=function(){};bb.prototype.bsb=function(c,k){return this.SSe(c,k,this.rnh)};bb.prototype.uad=function(c,k){return k&&1!==k?"":this.SSe(c,k,this.e3i)};bb.prototype.Jia=
function(){this.domElement.innerHTML=Ub.n2g;this.oua=Ne.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.tS=Ne.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.PJ=Ne.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Uwa=Ne.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Vwa=Ne.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Jjc=Ne.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.uvd=Ne.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.y2a=Ne.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.pLa=Ne.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.f7a=Ne.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.OMa=Ne.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.$$b=Ne.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.Uj()};bb.prototype.SSe=function(c,k,D){return D.length<c||D[c].length<k?(ed.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",c,k),""):this.$P.oa(D[c][k])};bb.prototype.oic=function(c){var k=!1;c&&c.Ea&&(c.Ea.keyCode===gd.a.Vza||c.Ea.keyCode===gd.a.Ph)&&(k=this.Saa(c),this.tS.blur(),this.PJ.blur());return k};bb.prototype.Saa=function(){var c=this.tS.selectedIndex,
k=this.PJ.selectedIndex;this.Jjc.innerText=this.bsb(c,k);this.uvd.innerText=this.uad(c,k);switch(c){case 0:return this.PJ.disabled=!0,Ne.DOMElementExtensions.setVisible(this.f7a,!1),Ne.DOMElementExtensions.setVisible(this.OMa,!1),Ne.DOMElementExtensions.setVisible(this.y2a,!1),Ne.DOMElementExtensions.setVisible(this.pLa,!1),this.oua.disabled=!0,!1;case 3:return this.PJ.disabled=!0,Ne.DOMElementExtensions.setVisible(this.f7a,!0),Ne.DOMElementExtensions.setVisible(this.OMa,!1),Ne.DOMElementExtensions.setVisible(this.y2a,
!0),Ne.DOMElementExtensions.setVisible(this.pLa,!0),this.oua.disabled=!1;case 7:return this.PJ.disabled=!0,Ne.DOMElementExtensions.setVisible(this.f7a,!0),Ne.DOMElementExtensions.setVisible(this.OMa,!1),Ne.DOMElementExtensions.setVisible(this.y2a,!1),Ne.DOMElementExtensions.setVisible(this.pLa,!1),this.oua.disabled=!1;default:this.oua.disabled=!1,Ne.DOMElementExtensions.setVisible(this.f7a,!0),Ne.DOMElementExtensions.setVisible(this.pLa,!1)}switch(k){case 0:case 1:Ne.DOMElementExtensions.setVisible(this.OMa,
!0);break;default:Ne.DOMElementExtensions.setVisible(this.OMa,!1)}this.PJ.disabled=!1;this.Jjc.disabled=!1;Ne.DOMElementExtensions.setVisible(this.y2a,!1);Ne.DOMElementExtensions.setVisible(this.pLa,!1);return!1};bb.prototype.Uj=function(){of.a.instance.pa(qf.a.Qb,this.tS,Object(xd.a)(this,this.oic,"onInteractWithControlElementsKeyDown"));of.a.instance.pa(qf.a.Qb,this.PJ,Object(xd.a)(this,this.oic,"onInteractWithControlElementsKeyDown"));of.a.instance.pa(qf.a.change,this.tS,Object(xd.a)(this,this.Saa,
"onInteractWithControlElements"));of.a.instance.pa(qf.a.change,this.PJ,Object(xd.a)(this,this.Saa,"onInteractWithControlElements"));of.a.instance.pa(qf.a.change,this.PJ,this.nk);of.a.instance.pa(qf.a.change,this.tS,this.nk);of.a.instance.pa(qf.a.change,this.Uwa,this.nk);of.a.instance.pa(qf.a.Qb,this.Uwa,this.nk);of.a.instance.pa(qf.a.change,this.Vwa,this.nk);of.a.instance.pa(qf.a.Qb,this.Vwa,this.nk)};bb.prototype.$l=function(){of.a.instance.za(qf.a.Qb,this.tS,Object(xd.a)(this,this.oic,"onInteractWithControlElementsKeyDown"));
of.a.instance.za(qf.a.Qb,this.PJ,Object(xd.a)(this,this.oic,"onInteractWithControlElementsKeyDown"));of.a.instance.za(qf.a.change,this.tS,Object(xd.a)(this,this.Saa,"onInteractWithControlElements"));of.a.instance.za(qf.a.change,this.PJ,Object(xd.a)(this,this.Saa,"onInteractWithControlElements"));of.a.instance.za(qf.a.change,this.PJ,this.nk);of.a.instance.za(qf.a.change,this.tS,this.nk);of.a.instance.za(qf.a.change,this.Uwa,this.nk);of.a.instance.za(qf.a.Qb,this.Uwa,this.nk);of.a.instance.za(qf.a.change,
this.Vwa,this.nk);of.a.instance.za(qf.a.Qb,this.Vwa,this.nk)};bb.pY=function(){var c;return c=new Tf.a,c.add("operatorInputId1"),c.add("operatorInputId2"),c};Ll.Object.defineProperties(bb.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return de.a.instance.da(1632)}},LOg:{configurable:!0,enumerable:!0,get:function(){return this.tS.selectedIndex}}});Object(qd.a)(bb,"DataValidationEditConditionsControl",Oh.a,[735,6,736]);var fj=b(187),Ch=aj.a;Em(za,Ch);za.prototype.gLd=function(){var c=
{};c=(c.RuleType=this.vd.ruleType,c.RuleOperatorType=this.vd.tA,c.OperatorInput1=this.vd.HM,c.OperatorInput2=this.vd.IM,c.IsIgnoreBlank=this.vd.R3,c.IsInCellDropDown=this.vd.S3,c.IsAlertBlocking=this.vd.IY,c.AlertTitle=this.vd.sS,c.AlertMessage=this.vd.rS,c.InputTitle=this.vd.$D,c.InputMessage=this.vd.iU,c.IsShowErrorAlert=this.vd.a4,c.IsShowInputMessage=this.vd.b4,c);this.yc(2,de.a.instance.da(1598));var k={};c=(k.id=this.sc,k.validateDialogValues=Object(xd.a)(this,this.WAj,"validateDialogValues"),
k.RangePickerController=ze.g(this.$).wi.w8b(),k.isModal=!1,k.bodyProps=c,k);this.initializeAndShow(de.a.instance.da(1597),Object(xd.a)(this,this.P_c,"dataValidationDialogHandler"),c);ed.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};za.prototype.dispose=function(){this.disposed||(Ch.prototype.dispose.call(this),this.disposed=!0)};za.prototype.WAj=function(c,k){this.r7b(c);var D=this.$Rd();c=D.errorString;var ba=D.Rp;if(D.returnValue)return this.N2a(121,this.Kxh(this.$,
k),0,this.W$,!1),"";this.Eja("OkInvalidByClient",ba);return c};za.prototype.pY=function(){return bb.pY()};za.prototype.Kxh=function(c,k){var D=this;return function(ba,Ba,nb){var Rb=c.ra.ua.Wb();return Nb(D.$.ra.ua,D.selectedRanges,D.mEg(),D.OXa(ba,D.btd(k)),wd.a(Ba),nb,Rb)}};za.prototype.btd=function(c){var k=this;return function(D){ed.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var ba;Hh.a(D)?(ed.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",
D?Qg.a.Uc(D.Errors):null),D.Errors&&1===D.Errors.length&&((ba=k.V8c(D.Errors[0].MessageId))?k.Eja("OkInvalidByServer",D.Errors[0].MessageIdName):(k.Eja("OkValid","None"),k.hide()),c(ba)),ed.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",Qg.a.Uc(D.Errors))):k.hide()}};za.prototype.mEg=function(){var c={};c.Command=this.command;c.RuleType=this.vd.ruleType;c.ConditionType=this.vd.tA;c.IsIgnoreBlank=this.vd.R3;c.IsInCellDropDown=
this.vd.S3;c.LowerBoundary=this.vd.HM;c.UpperBoundary=this.vd.IM;c.IsAlertBlocking=this.vd.IY;c.IsShowErrorAlert=this.vd.a4;c.IsShowInputMessage=this.vd.b4;c.AlertTitle=this.vd.sS;c.AlertMessage=this.vd.rS;c.InputTitle=this.vd.$D;c.InputMessage=this.vd.iU;c.ShouldIgnoreFormulaError=this.TKa;return c};za.prototype.V8c=function(c){switch(c){case 1173235830:return de.a.instance.da(1647);case 43935303:return de.a.instance.da(1648);case -1323438439:return de.a.instance.da(1650);case 2112020473:return de.a.instance.da(1644);
case -219503282:return de.a.instance.da(1645);case 1689335445:return de.a.instance.da(1646);case 2146493810:return de.a.instance.da(1649);case -2104909922:return String.format(de.a.instance.Bb(104),this.Hqb,this.XFd);case -869372599:return String.format(de.a.instance.Bb(103),this.Hqb);case -1181828368:return de.a.instance.da(1652);case -758480861:return de.a.instance.da(1653);case -13729088:return de.a.instance.da(1654);case -846654055:return de.a.instance.da(1655);case 751854001:return de.a.instance.da(1656);
case -453846397:return de.a.instance.da(1657);case 1102013489:return de.a.instance.da(1658);case 835813260:return de.a.instance.da(1659);case 1577787509:return de.a.instance.da(1660);case 2083564019:return de.a.instance.da(1651);default:ed.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",c.toString())}return null};za.prototype.P_c=function(c){this.vV(c);this.Kh=this.$.Vb.Dc("UserAction","DataValidationEditTimeToDialogTryClose");
c||this.gka()};za.prototype.gka=function(){this.Eja("Cancel","None")};za.prototype.vV=function(c){ed.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===c?"Ok":"Cancel");var k={};c=(k.ButtonType=za.Pga(c),k.DialogName=this.sc,k.Location="dialog",k.NumberOfSelectedRanges=ze.g(this.$).ga.wa.MJ,k);f.b(this.$).ee(Bh.a.T1b,c)};za.prototype.Eja=function(c,k){var D={};za.Zob(this.vd,D);D.o=c;D.p=k;D.n=this.Wia;this.Kh&&(this.Kh.stop(),D.q=this.Kh.id);ve.b().Je(49,D,!0)};za.prototype.r7b=
function(c){this.vd.ruleType=c.RuleType;this.vd.tA=c.RuleOperatorType;this.vd.HM=c.OperatorInput1;this.vd.IM=c.OperatorInput2;this.vd.IY=c.IsAlertBlocking;this.vd.a4=c.IsShowErrorAlert;this.vd.sS=c.AlertTitle;this.vd.rS=c.AlertMessage;this.vd.b4=c.IsShowInputMessage;this.vd.$D=c.InputTitle;this.vd.iU=c.InputMessage;this.vd.R3=c.IsIgnoreBlank;this.vd.S3=c.IsInCellDropDown;this.Hqb=c.firstOperatorLabel;this.XFd=c.secondOperatorLabel};za.prototype.IKb=function(c,k,D){var ba;var Ba=ba=null;if(af.a.ma(c))return D?
(ba=String.format(de.a.instance.Bb(104),this.Hqb,this.XFd),Ba="DataValidationEditNoMinMaxError"):(ba=String.format(de.a.instance.Bb(103),this.Hqb),Ba="DataValidationEditNoValueError"),{returnValue:!1,errorString:ba,Rp:Ba};if(c.length>Ub.rYf)return ba=de.a.instance.da(1651),{returnValue:!1,errorString:ba,Rp:Ba};if(fj.d(c))return{returnValue:!0,errorString:ba,Rp:Ba};if(1===k||2===k||6===k){if(!af.a.pU(c))return ba=de.a.instance.da(1644),{returnValue:!1,errorString:ba,Rp:Ba};if(1===k&&!af.a.isInteger(c))return ba=
de.a.instance.da(1645),{returnValue:!1,errorString:ba,Rp:Ba};if(6===k){if(!af.a.isInteger(c))return ba=de.a.instance.da(1645),{returnValue:!1,errorString:ba,Rp:Ba};if(0>parseInt(c))return ba=de.a.instance.da(1646),{returnValue:!1,errorString:ba,Rp:Ba}}}return{returnValue:!0,errorString:ba,Rp:Ba}};za.prototype.$Rd=function(){var c=this,k;var D=k=null;var ba=this.vd.HM,Ba=this.vd.IM,nb=this.vd.ruleType,Rb=this.vd.tA;if(!nb)return{returnValue:!0,errorString:k,Rp:D};var Ic=(!Rb||1===Rb)&&3!==nb&&7!==
nb;return!function(){var Wc=c.IKb(ba,nb,Ic);k=Wc.errorString;D=Wc.Rp;return Wc}().returnValue||Ic&&!function(){var Wc=c.IKb(Ba,nb,Ic);k=Wc.errorString;D=Wc.Rp;return Wc}().returnValue?{returnValue:!1,errorString:k,Rp:D}:Ic&&(1===nb||2===nb||6===nb)&&!fj.d(ba)&&!fj.d(Ba)&&parseFloat(ba)>parseFloat(Ba)?(k=de.a.instance.da(1649),D="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:k,Rp:D}):{returnValue:!0,errorString:k,Rp:D}};za.Pga=function(c){switch(c){case 0:return"Cancel";case 1:return"Ok";
case 2:return"ClearAll";default:return ed.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};za.Zob=function(c,k){k.a=Qd(c.ruleType);k.b=We(c.tA);k.c=!af.a.ma(c.HM);k.d=!af.a.ma(c.IM);k.e=c.R3;k.f=c.S3;k.g=c.b4;k.h=!af.a.ma(c.$D);k.i=!af.a.ma(c.iU);k.j=c.a4;k.k=c.IY;k.l=!af.a.ma(c.sS);k.m=!af.a.ma(c.rS)};Ll.Object.defineProperties(za.prototype,{vd:{configurable:!0,enumerable:!0,get:function(){return this.NNb}},sc:{configurable:!0,enumerable:!0,
get:function(){return"DataValidationEditDialog"}},IYb:{configurable:!0,enumerable:!0,get:function(){return 3===this.vd.ruleType}}});Object(qd.a)(za,"DataValidationEditDialog",aj.a,[]);var Ji=b(367);we.h_g="DataValidationDialogPanel";we.g_g="DataValidationButtonPanel";we.f_g="DataValidationButtonClearAll";Object(qd.a)(we,"CssClassNames",null,[]);var lh=Oh.a;Em(Le,lh);Le.prototype.render=function(c){c.appendChild(this.domElement)};Le.prototype.pia=function(){return this.isVisible};Le.prototype.Pla=
function(c){return this.isVisible=c};Le.prototype.setFocus=function(){};Le.prototype.dispose=function(){this.$l();this.nk=this.H$=this.G$=this.W1e=this.F$=null;lh.prototype.dispose.call(this)};Le.prototype.Jia=function(){this.domElement.innerHTML=Ub.u2g;this.F$=Ne.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.W1e=Ne.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.H$=Ne.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");
this.G$=Ne.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.F$.checked=!0;this.Uj();this.qic(null)};Le.prototype.Aya=function(c){this.H$.value=void 0===c.$D||null===c.$D?"":c.$D;this.G$.value=void 0===c.iU||null===c.iU?"":c.iU;this.F$.checked=c.b4;this.qic(null)};Le.prototype.lmb=function(c){c.$D=this.H$.value;c.iU=this.G$.value;c.b4=this.F$.checked};Le.prototype.Uj=function(){of.a.instance.pa(qf.a.change,this.F$,Object(xd.a)(this,this.qic,"onInteractWithShowInputCheckbox"));
of.a.instance.pa(qf.a.change,this.F$,this.nk);of.a.instance.pa(qf.a.change,this.H$,this.nk);of.a.instance.pa(qf.a.Qb,this.H$,this.nk);of.a.instance.pa(qf.a.change,this.G$,this.nk);of.a.instance.pa(qf.a.Qb,this.G$,this.nk)};Le.prototype.$l=function(){of.a.instance.za(qf.a.change,this.F$,Object(xd.a)(this,this.qic,"onInteractWithShowInputCheckbox"));of.a.instance.za(qf.a.change,this.F$,this.nk);of.a.instance.za(qf.a.change,this.H$,this.nk);of.a.instance.za(qf.a.Qb,this.H$,this.nk);of.a.instance.za(qf.a.change,
this.G$,this.nk);of.a.instance.za(qf.a.Qb,this.G$,this.nk)};Le.prototype.qic=function(){this.F$.checked?(this.H$.disabled=!1,this.G$.disabled=!1):(this.H$.disabled=!0,this.G$.disabled=!0);return!1};Ll.Object.defineProperties(Le.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return de.a.instance.da(1634)}}});Object(qd.a)(Le,"DataValidationEditInputControl",Oh.a,[735,6,745]);var nj=Oh.a;Em(mc,nj);mc.prototype.render=function(c){c.appendChild(this.domElement)};mc.prototype.pia=function(){return this.isVisible};
mc.prototype.Pla=function(c){return this.isVisible=c};mc.prototype.setFocus=function(){};mc.prototype.dispose=function(){this.$l();this.nk=this.u8=this.t8=this.FRa=this.Nfa=this.s8=null;nj.prototype.dispose.call(this)};mc.prototype.Jia=function(){this.domElement.innerHTML=Ub.y2g;this.s8=Ne.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.Nfa=Ne.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.FRa=Ne.DOMElementExtensions.getElementById(this.domElement,
"warningId");this.u8=Ne.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.t8=Ne.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.s8.checked=!0;this.Nfa.checked=!0;this.Uj();this.pic(null)};mc.prototype.Aya=function(c){this.Nfa.checked=c.IY;this.FRa.checked=!c.IY;this.u8.value=void 0===c.sS||null===c.sS?"":c.sS;this.t8.value=void 0===c.rS||null===c.rS?"":c.rS;this.s8.checked=c.a4;this.pic(null)};mc.prototype.lmb=function(c){c.sS=this.u8.value;
c.rS=this.t8.value;c.IY=this.Nfa.checked;c.a4=this.s8.checked};mc.prototype.Uj=function(){of.a.instance.pa(qf.a.change,this.s8,Object(xd.a)(this,this.pic,"onInteractWithShowAlertCheckbox"));of.a.instance.pa(qf.a.change,this.s8,this.nk);of.a.instance.pa(qf.a.change,this.Nfa,this.nk);of.a.instance.pa(qf.a.change,this.FRa,this.nk);of.a.instance.pa(qf.a.change,this.u8,this.nk);of.a.instance.pa(qf.a.Qb,this.u8,this.nk);of.a.instance.pa(qf.a.change,this.t8,this.nk);of.a.instance.pa(qf.a.Qb,this.t8,this.nk)};
mc.prototype.$l=function(){of.a.instance.za(qf.a.change,this.s8,Object(xd.a)(this,this.pic,"onInteractWithShowAlertCheckbox"));of.a.instance.za(qf.a.change,this.s8,this.nk);of.a.instance.pa(qf.a.change,this.Nfa,this.nk);of.a.instance.pa(qf.a.change,this.FRa,this.nk);of.a.instance.za(qf.a.change,this.u8,this.nk);of.a.instance.za(qf.a.Qb,this.u8,this.nk);of.a.instance.za(qf.a.change,this.t8,this.nk);of.a.instance.za(qf.a.Qb,this.t8,this.nk)};mc.prototype.pic=function(){this.s8.checked?(this.Nfa.disabled=
!1,this.FRa.disabled=!1,this.u8.disabled=!1,this.t8.disabled=!1):(this.Nfa.disabled=!0,this.FRa.disabled=!0,this.u8.disabled=!0,this.t8.disabled=!0);return!1};Ll.Object.defineProperties(mc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return de.a.instance.da(1633)}}});Object(qd.a)(mc,"DataValidationEditMessagesControl",Oh.a,[735,6,744]);od.prototype.u0a=function(){return this.cellRange};Object(qd.a)(od,"MacroRecorderRangeDataValidationChangedPayload",null,[115]);var Gi=b(65),Oj=Ji.a;
Em(Tc,Oj);Tc.prototype.gLd=function(){var c={};c=(c.key=this.vd,c);this.initializeAndShow(de.a.instance.da(1597),Object(xd.a)(this,this.P_c,"dataValidationDialogHandler"),c);ed.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};Tc.prototype.dispose=function(){this.disposed||(this.xac=this.mgc=this.b2=null,Rf.a.Fa(this.Yyb),this.Yyb=null,f.b(this.$)&&f.b(this.$).xMd("DataValidationDialogCorellation"),Oj.prototype.dispose.call(this),this.disposed=!0)};Tc.prototype.Eu=
function(c){Oj.prototype.Eu.call(this,c);this.yc(2,de.a.instance.da(1598));c=this.NT(2);var k=this.NT(1),D=this.NT(0),ba=k.parentNode;ba.appendChild(c);ba.appendChild(k);ba.appendChild(D);c.parentNode.classList.add(we.g_g);c.classList.add(we.f_g);c=document.getElementById("dataValidationTabsId");k=new bb(this.$,document.createElement("div"),Object(xd.a)(this,this.Saa,"onInteractWithControlElements"));D=new Le(document.createElement("div"),Object(xd.a)(this,this.Saa,"onInteractWithControlElements"));
ba=new mc(document.createElement("div"),Object(xd.a)(this,this.Saa,"onInteractWithControlElements"));this.WWh(k,D,ba);var Ba;this.Yyb=new dg(c,(Ba=new Tf.a,Ba.add(k),Ba.add(D),Ba.add(ba),Ba));this.Yyb.fGf();this.xT=document.getElementById("validationErrorMessageId");this.Aya();f.b(this.$)&&f.b(this.$).kMd("DataValidationDialogCorellation")};Tc.prototype.mN=function(){Oj.prototype.mN.call(this);document.getElementById(this.Yh("WACDialogPanel")).classList.add(we.h_g)};Tc.prototype.pY=function(){return bb.pY()};
Tc.prototype.y7b=function(){return"validationErrorMessageId"};Tc.prototype.WWh=function(c,k,D){this.b2=c;this.xac=k;this.mgc=D};Tc.prototype.m4i=function(){function c(){return new od(k.selectedRanges,D)}var k=this,D={};D.IsClearAll=this.Wia;D.Command=this.command;D.RuleType=this.vd.ruleType;D.ConditionType=this.vd.tA;D.IsIgnoreBlank=this.vd.R3;D.IsInCellDropDown=this.vd.S3;D.LowerBoundary=this.vd.HM;D.UpperBoundary=this.vd.IM;D.IsAlertBlocking=this.vd.IY;D.IsShowErrorAlert=this.vd.a4;D.IsShowInputMessage=
this.vd.b4;D.AlertTitle=this.vd.sS;D.AlertMessage=this.vd.rS;D.InputTitle=this.vd.$D;D.InputMessage=this.vd.iU;D.ShouldIgnoreFormulaError=this.TKa;var ba=this.$.ra.ua.Wb();uh.a(this.$.userOperationManager,function(Ba,nb,Rb){return Nb(k.$.ra.ua,k.selectedRanges,D,wd.b(Ba,Object(xd.a)(k,k.btd,"onDataValidationEditSuccessCallback")),wd.a(nb),Rb,ba)},function(Ba){return new te.a(121,0,Ba,void 0,c)},null)};Tc.prototype.btd=function(c){ed.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(this.disposed)ed.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(Hh.a(c)){ed.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",c?Qg.a.Uc(c.Errors):null);if(c.Errors&&1===c.Errors.length){var k=c.Errors[0].MessageId,D=this.V8c(k);if(D){this.Wej(k)?this.naj(D):this.Gs(D);this.Eja("OkInvalidByServer",
c.Errors[0].MessageIdName);return}}ed.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",Qg.a.Uc(c.Errors))}this.Eja("OkValid","None");this.hide()}};Tc.prototype.Wej=function(c){return 1577787509===c};Tc.prototype.naj=function(c){this.xT.innerText=c;this.Ny(this.NT(0));this.TKa=!0};Tc.prototype.Rqe=function(){this.TKa=!1;this.xT.innerText=""};Tc.prototype.V8c=function(c){switch(c){case 1173235830:return de.a.instance.da(1647);
case 43935303:return de.a.instance.da(1648);case -1323438439:return de.a.instance.da(1650);case 2112020473:return de.a.instance.da(1644);case -219503282:return de.a.instance.da(1645);case 1689335445:return de.a.instance.da(1646);case 2146493810:return de.a.instance.da(1649);case -2104909922:return String.format(de.a.instance.Bb(104),this.b2.bsb(this.vd.ruleType,this.vd.tA),this.b2.uad(this.vd.ruleType,this.vd.tA));case -869372599:return String.format(de.a.instance.Bb(103),this.b2.bsb(this.vd.ruleType,
this.vd.tA));case -1181828368:return de.a.instance.da(1652);case -758480861:return de.a.instance.da(1653);case -13729088:return de.a.instance.da(1654);case -846654055:return de.a.instance.da(1655);case 751854001:return de.a.instance.da(1656);case -453846397:return de.a.instance.da(1657);case 1102013489:return de.a.instance.da(1658);case 835813260:return de.a.instance.da(1659);case 1577787509:return de.a.instance.da(1660);case 2083564019:return de.a.instance.da(1651);default:ed.ULS.sendTraceTag(537163265,
0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",c.toString())}return null};Tc.prototype.Y4=function(){ed.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.r7b();var c=this.$Rd();var k=c.errorString;var D=c.Rp;if(!c.returnValue)return this.Gs(k),this.Eja("OkInvalidByClient",D),!1;this.m4i();return!0};Tc.prototype.gka=function(){this.r7b();this.Eja("Cancel","None");this.hide()};Tc.prototype.uwa=function(){ed.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.TKa?this.Rqe():this.KVc();this.UYi();this.Wia=!0};Tc.prototype.P_c=function(c){this.vV(c);2!==c&&(this.Kh=this.$.Vb.Dc("UserAction","DataValidationEditTimeToDialogTryClose"));1===c?this.Y4():2===c?this.uwa():this.gka()};Tc.prototype.vV=function(c){var k={};c=(k.ButtonType=Tc.Pga(c),k.DialogName=this.sc,k.Location="dialog",k.NumberOfSelectedRanges=ze.g(this.$).ga.wa.MJ,k);f.b(this.$).ee(Bh.a.T1b,c)};Tc.prototype.Saa=function(){this.owj();
this.TKa?this.Rqe():this.KVc();return this.Wia=!1};Tc.prototype.UYi=function(){this.NNb=new ad;this.Aya()};Tc.prototype.Aya=function(){this.mgc.Aya(this.vd);this.xac.Aya(this.vd);this.b2.Aya(this.vd)};Tc.prototype.r7b=function(){this.b2.lmb(this.vd);this.mgc.lmb(this.vd);this.xac.lmb(this.vd)};Tc.prototype.Eja=function(c,k){var D={};Tc.Zob(this.vd,D);D.o=c;D.p=k;D.n=this.Wia;this.Kh&&(this.Kh.stop(),D.q=this.Kh.id);ve.b().Je(49,D,!0)};Tc.prototype.IKb=function(c,k){var D;var ba=D=null;if(af.a.ma(c))return k?
(D=String.format(de.a.instance.Bb(104),this.b2.bsb(this.vd.ruleType,this.vd.tA),this.b2.uad(this.vd.ruleType,this.vd.tA)),ba="DataValidationEditNoMinMaxError"):(D=String.format(de.a.instance.Bb(103),this.b2.bsb(this.vd.ruleType,this.vd.tA)),ba="DataValidationEditNoValueError"),{returnValue:!1,errorString:D,Rp:ba};if(c.length>Ub.rYf)return D=de.a.instance.da(1651),{returnValue:!1,errorString:D,Rp:ba};if(fj.d(c))return{returnValue:!0,errorString:D,Rp:ba};if(1===this.vd.ruleType||2===this.vd.ruleType||
6===this.vd.ruleType){if(!af.a.pU(c))return D=de.a.instance.da(1644),{returnValue:!1,errorString:D,Rp:ba};if(1===this.vd.ruleType&&!af.a.isInteger(c))return D=de.a.instance.da(1645),{returnValue:!1,errorString:D,Rp:ba};if(6===this.vd.ruleType){if(!af.a.isInteger(c))return D=de.a.instance.da(1645),{returnValue:!1,errorString:D,Rp:ba};if(0>parseInt(c))return D=de.a.instance.da(1646),{returnValue:!1,errorString:D,Rp:ba}}}return{returnValue:!0,errorString:D,Rp:ba}};Tc.prototype.$Rd=function(){var c=this,
k;var D=k=null;if(this.Wia||!this.vd.ruleType)return{returnValue:!0,errorString:k,Rp:D};var ba=(!this.vd.tA||1===this.vd.tA)&&3!==this.vd.ruleType&&7!==this.vd.ruleType;return!function(){var Ba=c.IKb(c.vd.HM,ba);k=Ba.errorString;D=Ba.Rp;return Ba}().returnValue||ba&&!function(){var Ba=c.IKb(c.vd.IM,ba);k=Ba.errorString;D=Ba.Rp;return Ba}().returnValue?{returnValue:!1,errorString:k,Rp:D}:ba&&(1===this.vd.ruleType||2===this.vd.ruleType||6===this.vd.ruleType)&&!fj.d(this.vd.HM)&&!fj.d(this.vd.IM)&&parseFloat(this.vd.HM)>
parseFloat(this.vd.IM)?(k=de.a.instance.da(1649),D="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:k,Rp:D}):{returnValue:!0,errorString:k,Rp:D}};Tc.Pga=function(c){switch(c){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return ed.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Tc.Zob=function(c,k){k.a=Qd(c.ruleType);k.b=We(c.tA);k.c=!af.a.ma(c.HM);k.d=!af.a.ma(c.IM);k.e=
c.R3;k.f=c.S3;k.g=c.b4;k.h=!af.a.ma(c.$D);k.i=!af.a.ma(c.iU);k.j=c.a4;k.k=c.IY;k.l=!af.a.ma(c.sS);k.m=!af.a.ma(c.rS)};Ll.Object.defineProperties(Tc.prototype,{vd:{configurable:!0,enumerable:!0,get:function(){return this.NNb}},sc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var c=this;return function(){c.vV(1);c.Y4()}},set:function(c){Object(Gi.b)(Tc.prototype,this,"onCommitDialogHandler",c)}},canBePreempted:{configurable:!0,
enumerable:!0,get:function(){return!1}},IYb:{configurable:!0,enumerable:!0,get:function(){return 3===this.b2.LOg}}});Object(qd.a)(Tc,"DataValidationEditDialogDeprecated",Ji.a,[]);id.prototype.AFa=function(c,k,D,ba){ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new za(c,k,D,ba)).gLd():(new Tc(c,k,D,ba)).gLd()};id.prototype.eSg=function(c,k){var D=new kg.StandardDialog;D.hc=3;D.Pya(c.zb.Iha,de.a.instance.da(1642),k)};id.prototype.gSg=function(c,k){var D=
new kg.StandardDialog;D.hc=1;D.WV(c.zb.Iha,de.a.instance.da(1643),k)};Object(qd.a)(id,"DataValidationEditDialogFactory",null,[709]);var Wj=Ud.a;Em(yc,Wj);yc.prototype.Gd=function(){this.Ad([new kc(this.$,new id)])};yc.ja=function(c){Ud.a.Yd(245,new yc(c))};Object(qd.a)(yc,"DataValidationEditCommandHandlerFactory",Ud.a,[]);Ob.O7f='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(qd.a)(Ob,"FileUploadDialogHTML",null,[]);var ag=b(365),Lj=gi.a;Em(Qe,Lj);Qe.prototype.ai=function(c,k,D,ba,Ba){Ba=void 0===Ba?!0:Ba;this.Dod=void 0===ba?!1:ba;this.Xfj(k);this.Ndf=c;Ba&&Td.AFrameworkApplication.FE(c)};Qe.prototype.Xfj=function(c){if(Qe.Cx)this.Khj(c);else{var k={};k[Qe.WFg]=c;k[Qe.bGg]=CommonUIStrings.l_SendFileErrorReportMessage;k[Qe.cGg]=CommonUIStrings.l_SendFileErrorReportTextCaption;k[Qe.BTc]="";k[Qe.ZFg]=CommonUIStrings.l_UserReportLinkText;k[Qe.YXb]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(xd.a)(this,this.$$h,"legacyDialogHandler"),k);this.OV(Qe.hGg)}};Qe.prototype.Khj=function(c){var k={},D={},ba={},Ba={},nb={};c=(nb.id=this.Ie,nb.bodyControls=(Ba.reportErrorCheckboxProps=this.Dod?(k.label=CommonUIStrings.l_UserReportLinkText,k):null,Ba.textAreaProps=this.sef?{}:null,Ba.privacyStatementLinkProps=(ba.text=CommonUIStrings.l_PrivacyStatement,ba.handler=(D.href=Td.AFrameworkApplication.Mka,D.target="_blank",D),ba),Ba),nb.errorMessage=c,nb.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
nb.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,nb);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(xd.a)(this,this.xzd,"reactDialogHandler"),c)};Qe.prototype.x6a=function(){if(!Qe.Cx){var c=document.getElementById(Qe.eGg);c&&(c.className=Qe.dGg,c.appendChild(ag.createClusteredImage(32,32,Qe.aGg,null,!0,CommonUIStrings.l_DialogError)));if(c=document.getElementById(Qe.fGg))c.innerText=CommonUIStrings.l_PrivacyStatement,c.href=Td.AFrameworkApplication.Mka,vc.a.addHandler(c,
"click",Object(xd.a)(this,this.xxi,"onPrivacyClickHandler"));this.sef||(c=document.getElementById(Qe.BTc))&&c.parentNode&&c.parentNode.removeChild(c);this.Dod||(c=document.getElementById(Qe.YFg))&&c.parentNode&&c.parentNode.removeChild(c)}};Qe.prototype.mN=function(){Qe.Cx||(Lj.prototype.mN.call(this),document.getElementById(this.Yh("WACDialogPanel")).style.width=String.format("{0}px",400))};Qe.prototype.$$h=function(c,k){var D=k[Qe.BTc]||"",ba=!0;void 0!==k[Qe.YXb]&&null!==k[Qe.YXb]&&(ba=k[Qe.YXb]);
this.sv(c,D,ba)};Qe.prototype.xzd=function(c,k){this.sv(c,k.text||"",k.reportErrorChecked)};Qe.prototype.sv=function(c,k,D){this.Idf&&(D&&ed.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Ndf),this.Idf(c,k,D))};Qe.prototype.xxi=function(c){Td.AFrameworkApplication.Hb.Ge(oa.a.sxa,2,c)};Ll.Object.defineProperties(Qe.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Ll.Object.defineProperties(Qe,{Cx:{configurable:!0,enumerable:!0,get:function(){return Td.AFrameworkApplication.xa.Xa.qu&&
Td.AFrameworkApplication.xa.Xa.f5h}}});Qe.WFg="WACDialogErrorMessage";Qe.bGg="WACDialogErrorReportMessage";Qe.cGg="WACDialogErrorTextPrompt";Qe.BTc="WACDialogInput";Qe.fGg="WACDialogPrivacyText";Qe.eGg="WACDialogIconPanel";Qe.aGg="CancelRequest_32x32x32";Qe.dGg="WACDialogIcon";Qe.hGg="WACDialogTextPanel";Qe.YXb="WACDialogSendFileCheckbox";Qe.YFg="WACDialogSendFileCheckboxContainer";Qe.ZFg="WACDialogSendFileCheckboxText";Qe.$Fg="FileUploadErrorDialog";Object(qd.a)(Qe,"FileUploadErrorDialog",gi.a,[]);
var Kh=eg.a;Em(Bd,Kh);Bd.prototype.Jrg=function(c){this.addHandler("fileCollectionComplete",c)};Bd.prototype.DTi=function(c){this.removeHandler("fileCollectionComplete",c)};Bd.prototype.QMg=function(c,k,D){this.fyf=k;this.ZF=c;this.Jrg(D);Td.AFrameworkApplication.Mka=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;c=new Qe(Object(xd.a)(this,this.RMg,"collectFileInternal"));Td.AFrameworkApplication.Hb.Xb(oa.a.sxa,ya.a.frame,Bd.kJi);c.ai(0,"",null,!1,!1)};Bd.prototype.rSi=function(c){this.DTi(c)};
Bd.prototype.RMg=function(c,k){if(1===c&&!af.a.ma(this.ZF.FileCollectionErrorStateId)){c=this.$.ra.ua;var D=this.ZF.MessageId,ba=this.ZF.OriginalEcsServerId,Ba=this.ZF.FileCollectionErrorStateId,nb=c.Na(0);nb.errorMessageId=D;nb.ecsServerId=ba;nb.fileCollectionErrorStateId=Ba;nb.userComment=k;c.TTc("CollectFile",nb,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};Bd.kJi=function(c,k,D,ba,Ba){vc.a.Ys(Ba);Td.AFrameworkApplication.Mka&&Gb.HelperMethods.lf(Td.AFrameworkApplication.Mka,
void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(qd.a)(Bd,"FileCollectionOperation",eg.a,[708,6]);var qi=oe.a;Em(bf,qi);bf.prototype.create=function(){var c=this;Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.create(this.$.ea,155,this.la,this.rb,"System.Dictionary"),function(){c.Eb(c.Vkh)},this.la,3)};bf.prototype.dispose=function(){Rf.a.Fa(this.oOb);this.oOb=null;qi.prototype.dispose.call(this)};bf.ja=function(c){c.ea.Ia(125,new bf(c))};Ll.Object.defineProperties(bf.prototype,
{Vkh:{configurable:!0,enumerable:!0,get:function(){return this.oOb||(this.oOb=new Bd(this.$))}}});Object(qd.a)(bf,"FileCollectionCommandHandlerFactory",oe.a,[]);var th=b(912),Aj=b(176),ok=b(263),Mj=b(1007);pd.Eqh="GalleryGeneral";pd.Gqh="GalleryNumber";pd.Cqh="GalleryCurrency";pd.Aqh="GalleryAccounting";pd.Jqh="GalleryShortDate";pd.Fqh="GalleryLongDate";pd.Lqh="GalleryTime";pd.Hqh="GalleryPercentage";pd.Dqh="GalleryFraction";pd.Iqh="GalleryScientific";pd.Kqh="GalleryText";pd.AFg="ButtonComma";pd.buttonPercentage=
"ButtonPercentage";pd.keyboardNumber="KeyboardNumber";pd.keyboardCurrency="KeyboardCurrency";pd.keyboardDate="KeyboardDate";pd.keyboardTime="KeyboardTime";pd.keyboardPercentage="KeyboardPercentage";Object(qd.a)(pd,"RibbonFormatKind",null,[]);var Xj=b(289),gj=b(654),bj=b(653),yj=b(652),Yj=Xj.a;Em(Zc,Yj);Zc.prototype.y1=function(c){return Yj.prototype.y1.call(this,c)||this.Zoh.y1(this.T6c,this.activeCell,this.format,this.nje,this.ywf,this.twf,this.UVb,this.mDa,this.clientCorrelationId,this.Sib,this.gfb)};
Zc.prototype.Ll=function(){var c=[];if(this.l9b)for(var k=Ol(this.l9b),D=k.next();!D.done;D=k.next())c.push(yj.a(D.value));else c.push(new bj.a(this.format,this.T6c,this.activeCell));return function(){return new gj.a(c)}};Zc.prototype.kbb=function(){var c={OperationType:0};c.FormatCellsMultiRange=this.T6c;c.ActiveCell=this.activeCell;c.Format=this.format;c.ApplyFormatOnPivotTableValueField=this.nje;c.PivotTableXluid=this.ywf;c.PivotTableFieldCaption=this.twf;return c};Ll.Object.defineProperties(Zc.prototype,
{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ae.EwaSettings.pc()?Object(Gi.a)(Zc.prototype,this,"operationWorkingState"):0}},Oq:{configurable:!0,enumerable:!0,get:function(){return this.Sib}},V2:{configurable:!0,enumerable:!0,get:function(){return this.gfb}},Ewc:{configurable:!0,enumerable:!0,get:function(){return this.mDa}}});Object(qd.a)(Zc,"FormatCellsBatchOperation",Xj.a,[]);var cj=b(195);Fc.left="Left";Fc.center="Center";Fc.right="Right";Object(qd.a)(Fc,"AlignmentType",
null,[]);ac.editCell="Edited";ac.dependentCell="Dependents";Object(qd.a)(ac,"RecalcPriorityGroupType",null,[]);var wi=b(214),wh=b(10);Object(qd.a)(Ve,"RecalcAccuracyObject",null,[]);se.string="String";se.blank="Blank";se.general="General";se.Jnh="Flexible";Object(qd.a)(se,"FormattedUnitKind",null,[]);Ll.Object.defineProperties(Ad.prototype,{success:{configurable:!0,enumerable:!0,get:function(){return this.Fkg}},reason:{configurable:!0,enumerable:!0,get:function(){return this.Xhb}},text:{configurable:!0,
enumerable:!0,get:function(){return this.Mx}},valueType:{configurable:!0,enumerable:!0,get:function(){return this.dmg}},horizontalAlignment:{configurable:!0,enumerable:!0,get:function(){return this.Mfb}},fontColor:{configurable:!0,enumerable:!0,get:function(){return this.Gcg}},numberFormatIndex:{configurable:!0,enumerable:!0,get:function(){return this.Fgg}},Urd:{configurable:!0,enumerable:!0,get:function(){return this.Egg}},numberOfMeasureTextWidthCalls:{configurable:!0,enumerable:!0,get:function(){return this.Hgg}}});
Object(qd.a)(Ad,"ProcessedFormattedValue",null,[722]);Object(qd.a)(ne,"RecalcResultProcessingStatistics",null,[]);Object(qd.a)(ee,"RecalcedCellInfo",null,[]);var Nj=b(107),sd=b(61);Wd.prototype.dispose=function(){this.calcManager=this.Etc=this.ji=this.grid=this.$=null};Wd.prototype.bzf=function(c){if(c&&c.rangeDeltas){for(var k=this.yba.length,D=0;D<c.rangeDeltas.length;D++)c.rangeDeltas[D]&&c.rangeDeltas[D].data&&void 0!==c.rangeDeltas[D].data.value&&null!==c.rangeDeltas[D].data.value&&void 0!==
c.rangeDeltas[D].range&&null!==c.rangeDeltas[D].range&&Array.add(this.yba,new ee(c.rangeDeltas[D],c.stateId,c.isFinished,c.priorityGroup));ed.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",c.stateId,c.priorityGroup,c.isFinished,c.rangeDeltas.length,k,this.yba.length,this.lastSetCellInstantaneousOperation);!k&&this.yba.length&&
this.Yqf(!1,0)}};Wd.prototype.syd=function(c,k,D,ba,Ba,nb){if(!k)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"Null");var Rb=0,Ic=excelOnlineCalc.numfmt.renderCallback(ba,function(Rd){Rb++;return gridRenderer.CanvasRendererGlobals.measureTextWidth(Rd,Ba,!0,ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))}),Wc=c.renderValue(k,Ic);if(!excelOnlineCalc.util.isSuccess(Wc))return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"Finalize",Rb);ba=null;if(excelOnlineCalc.numfmt.isHashesValue(Wc.value)){if(Wc=
c.renderHashesValue(Wc.value,Ic),!excelOnlineCalc.util.isSuccess(Wc))return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"Hashes",Rb)}else ba=Wd.kph(k,Wc.value);Ic=Wc.value;c=excelOnlineCalc.numfmt.renderedValueToString(Ic);k=bd(Ic);Ic=Oe(Ic);return new Ad(!0,c,k,Ic,nb,D,void 0,Rb,ba)};Wd.prototype.Yqf=function(c,k){var D=this;this.$&&this.grid&&this.calcManager&&this.Etc&&this.calcManager.aq?(c&&(this.rba=this.Etc.i2e),this.NJi(this.grid,this.calcManager.aq,c,k),!this.rba&&this.yba.length?pg.Task.delay(0).CWRCT(function(ba){D.Yqf(!0,
ba.id);return!0},null,0,sd.a.current):pg.Task.Ra(!0)):(ed.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),pg.Task.Ra(!1))};Wd.prototype.NJi=function(c,k,D,ba){var Ba=Gb.HelperMethods.Ac();for(D=new ne(this.yba.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.rba,void 0,void 0,void 0,D,void 0,ba,!0,0,0,0,0,0,0);0<this.yba.length;){ba=Gb.HelperMethods.Ac()-Ba;if(!this.rba||ba>
this.rba){D.numberOfCellsSkippedDueToTimeout=this.yba.length;break}ba=Array.dequeue(this.yba);if(ng(ba,D)){var nb=mi.Range.ld(ba.rangeDelta.range.row+1,ba.rangeDelta.range.column+1);(nb=c.tc(nb))?Wd.wHg(ba.stateId,nb.cell)?(Wd.fhc(c,nb,ba,D),this.Yxg(k,nb,ba,D)):D.numberOfCellsUpdatedAlreadyByServer++:D.numberOfCellsWithNoFormattedCell++}}ba=Math.round(Gb.HelperMethods.Ac()-Ba);this.uzj(ba);this.cnj(D,ba);this.cYi(D)};Wd.prototype.Yxg=function(c,k,D,ba){var Ba=Pf(k,D),nb=D.rangeDelta.data.formatted,
Rb=me(D);c=this.syd(c,nb,Rb,k.cell.bbb,k.cell.SYa,Ba);if(c.success)k.text!==c.text&&(this.ji.clb(k,c),(Ba=Zf(D))?1===Ba?Ba=2:(ed.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!"),Ba=0):Ba=1,this.ji.PCe(k,this.lastSetCellInstantaneousOperation,2,Ba,!0,!0),ba.numberOfUpdatedCells++);else switch(c.reason){case "Null":ba.numberOfRecalcedCellsWithoutFormattedValue=null==ba.numberOfRecalcedCellsWithoutFormattedValue?0:ba.numberOfRecalcedCellsWithoutFormattedValue+
1;break;case "Hashes":ba.numberOfHashFormattedValues=null==ba.numberOfHashFormattedValues?0:ba.numberOfHashFormattedValues+1;break;case "Finalize":ba.newNumberFormatterFinalizeFailures=null==ba.newNumberFormatterFinalizeFailures?0:ba.newNumberFormatterFinalizeFailures+1}"Null"!==c.reason&&(ba.numberOfRecalcedCellsWithFormattedValue=null==ba.numberOfRecalcedCellsWithFormattedValue?0:ba.numberOfRecalcedCellsWithFormattedValue+1);ba.numberOfMeasureTextWidthCalls=null==ba.numberOfMeasureTextWidthCalls?
0:ba.numberOfMeasureTextWidthCalls+c.numberOfMeasureTextWidthCalls;ba=(D=Zf(D))?k.formulaBarText:k.cell.userInput;Ba=c.text;ed.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",k.range.top,k.range.left,c.success,c.reason,D,k.cell.numberFormatIndex,ba?af.a.wI(ba):"null",Ba?af.a.wI(Ba):"null")};Wd.prototype.uzj=function(c){this.rba=Math.max(this.rba-Math.max(c,
1),0)};Wd.prototype.cnj=function(c,k){c.numberOfNonUpdatedCells=this.yba.length;c.totalExecutionTime=k;c.newProcessingTimeLimit=this.rba;c.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};Wd.prototype.cYi=function(c){c=Sys.Serialization.JavaScriptSerializer.serialize(c);ed.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",c)};Wd.kph=function(c,k){c=c.units;var D=k.units;if(c.length!==D.length)return ed.ULS.sendTraceTag(537162179,0,
15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;k=[];for(var ba=-1,Ba=0;Ba<c.length;Ba++)switch(c[Ba].kind){case se.blank:k.push.apply(k,Nj.h(" ",D[Ba].str.length));break;case se.string:k.push(c[Ba].str);break;case se.Jnh:k.push("");ba=Ba;break;case se.general:k.push(D[Ba].str);break;default:ed.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=
ba||""===D[ba].str)return null;D={};D.Start=k.slice(0,ba).join("");D.Separator=c[ba].str;D.End=k.slice(ba+1,k.length).join("");return D};Wd.Bvh=function(c){return c&&c&&c.yv?c.yv.LF:wh.a.Oe};Wd.wHg=function(c,k){if(!k)return!1;k=Wd.Bvh(k);return k===wh.a.Oe||k===c};Wd.fhc=function(c,k,D,ba){var Ba=D.rangeDelta.data.value.toString(),nb=me(D),Rb=Pf(k,D);Ba=new Ve(nb,Ba,Rb,D.priorityGroup);k.cell.fhc(Ba,c.Ca.hE);1===Zf(D)?ba.numberOfDependentRecalcedCellsInBatch++:ba.numberOfEditedRecalcedCellsInBatch++};
Wd.oye=20;Object(qd.a)(Wd,"CalcResultProcessor",null,[725,6]);Object(qd.a)(ld,"GetRibbonNumberFormatResult",null,[]);Rc.prototype.kGb=function(c,k,D){var ba=k.Border;k=k.BorderFormat;var Ba=0,nb=!1;if(ba){for(var Rb=0;3>=Rb;Rb++)Rc.Ccj(c,D,Rb,ba)&&(Ba|=Gb.HelperMethods.Drb(Rb),this.vQd(c.cell.getRange(),Rb,k),nb=!0);Gb.HelperMethods.PP(ba,16)&&!fj.c(c,0,D)&&(Ba|=2,this.vQd(c.cell.getRange(),0,k),nb=!0);Gb.HelperMethods.PP(ba,32)&&!fj.c(c,2,D)&&(Ba|=4,this.vQd(c.cell.getRange(),2,k),nb=!0);nb&&(D=
c.cell.yv.fg,Gb.HelperMethods.PP(Ba,2)&&this.WRf(c,D,0)&&(Ba&=-3),Gb.HelperMethods.PP(Ba,1)&&this.VRf(c,D,1)&&(Ba&=-2),Gb.HelperMethods.PP(Ba,4)&&this.WRf(c,D,2)&&(Ba&=-5),Gb.HelperMethods.PP(Ba,8)&&this.VRf(c,D,3)&&(Ba&=-9),c.cell.setBorders(k,Ba,!1))}else c.cell.ODf(),this.VRi(c.cell.getRange())};Rc.prototype.eta=function(c,k){c=Rc.PNe(c,k);return c.isValidRange?(c=this.Ca.m0a(c))&&c.length?c:null:null};Rc.prototype.VRi=function(c){for(var k=0;3>=k;k++){var D=Rc.PNe(c,k);if(D.isValidRange&&(D=this.Ca.m0a(D))&&
D.length)for(var ba=Rc.TSe(k),Ba=0;Ba<D.length;Ba++)D[Ba].mBd(ba)}};Rc.prototype.vQd=function(c,k,D){if(c=this.eta(c,k))for(var ba=Rc.TSe(k),Ba=Gb.HelperMethods.Drb(ba),nb=0;nb<c.length;nb++){var Rb=c[nb];this.y_h(Rb,ba)&&Rc.setBorders(Rb,D,Ba,k,ba)}};Rc.prototype.y_h=function(c,k){var D=c.yv.fg,ba=c.getRange();ba=this.eta(ba,k);var Ba=!1,nb=!1,Rb=!1,Ic=!1;ba&&(Ba=Rc.A3a(ba,!0),nb=Rc.A3a(ba,!1),Ic=Rc.yid(ba),Rb=1===ba.length?!0:!1);switch(k){case 0:return Rc.RZh(c,D,Ic,nb,Rb);case 1:return Rc.OZh(c,
D,Ic,Ba,Rb);case 2:return Rc.PZh(c,D,Ic,Ba,Rb);case 3:return Rc.QZh(c,D,Ic,nb,Rb)}return!1};Rc.prototype.WRf=function(c,k,D){if(!c.cell.UY)return!1;var ba=c.range,Ba=this.eta(ba,D),nb=fj.c(c,D,k),Rb=!1;k=D?ba.left<k.left:ba.top<k.top;!Rc.Wvb(c.cell)&&Ba&&1!==Ba.length&&(Rb=(D?Rc.A3a(Ba,!1):Rc.A3a(Ba,!0))?!1:!0);return!nb&&Rb||k?!0:!1};Rc.prototype.VRf=function(c,k,D){var ba=c.cell,Ba=this.eta(ba.getRange(),D);c=fj.c(c,D,k);k=!1;if(Ba){var nb=Rc.A3a(Ba,!0),Rb=Rc.A3a(Ba,!1),Ic=nb&&!Rb;Rb=Rb&&!nb;1!==
D||Rc.Kwb(ba)?3!==D||Rc.Lvb(ba)||Rc.Jcj(ba,Ba,Rb,Ic)&&(k=!0):Rc.Icj(ba,Ba,nb,Rb)&&(k=!0)}return!c&&k||Rc.Wvb(ba)?!0:!1};Rc.aDg=function(c,k,D){var ba={};ba.LineStyle=Array(4);ba.LineStyle[D]=c.LineStyle[k];ba.Color=Array(4);ba.Color[D]=c.Color[k];return ba};Rc.q3e=function(c,k,D,ba,Ba){return Gb.HelperMethods.PP(c,Ba)&&fj.c(k,D,ba)};Rc.Ccj=function(c,k,D,ba){return Rc.q3e(ba,c,D,k,Gb.HelperMethods.Drb(D))||Rc.q3e(ba,c,D,k,64)||112===ba};Rc.setBorders=function(c,k,D,ba,Ba){k=Rc.aDg(k,ba,Ba);c.setBorders(k,
D,!1)};Rc.PNe=function(c,k){switch(k){case 0:return new mi.Range(c.top-1,c.left,c.top-1,c.right,!1,!1);case 2:return new mi.Range(c.top,c.left-1,c.bottom,c.left-1,!1,!1);case 1:return new mi.Range(c.bottom+1,c.left,c.bottom+1,c.right,!1,!1);case 3:return new mi.Range(c.top,c.right+1,c.bottom,c.right+1,!1,!1)}return c};Rc.TSe=function(c){switch(c){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};Rc.A3a=function(c,k){for(var D=0;D<c.length;D++){var ba=c[D];if(ba.UY)return k?Rc.Lvb(ba):
Rc.Kwb(ba)}return!1};Rc.Wvb=function(c){var k=c.yv.fg,D=c.getRange();return c.UY&&(D.top<k.top||D.bottom>k.bottom||D.left<k.left||D.right>k.right)?!0:!1};Rc.yid=function(c){for(var k=0;k<c.length;k++)if(Rc.Wvb(c[k]))return!0;return!1};Rc.Icj=function(c,k,D,ba){if(!c.UY){if(!D||Rc.yid(k))return!0}else if(Rc.Lvb(c)&&(1===k.length&&Rc.ryg(c,k[0])||!D))return!0;return ba};Rc.Jcj=function(c,k,D,ba){if(!c.UY){if(!D||Rc.yid(k))return!0}else if(Rc.Kwb(c)&&(1===k.length&&Rc.syg(c,k[0])||!D))return!0;return c.mja||
ba};Rc.RZh=function(c,k,D,ba,Ba){var nb=c.getRange();return Rc.Lvb(c)?Rc.Wvb(c)||Ba:k.top===nb.top||!ba||D};Rc.OZh=function(c,k,D,ba,Ba){var nb=c.getRange();return Rc.Lvb(c)?k.bottom===nb.bottom&&Ba:ba&&!D||k.bottom===nb.bottom};Rc.PZh=function(c,k,D,ba,Ba){var nb=c.getRange();return Rc.Kwb(c)?Rc.Wvb(c)||Ba:k.left===nb.left||!ba||D};Rc.QZh=function(c,k,D,ba,Ba){var nb=c.getRange();return c.mja?!1:Rc.Kwb(c)?k.right===nb.right&&Ba:ba&&!D||k.right===nb.right};Rc.Lvb=function(c){return 0<c.getRange().right-
c.getRange().left};Rc.Kwb=function(c){return 0<c.getRange().bottom-c.getRange().top};Rc.syg=function(c,k){c=c.getRange();k=k.getRange();return c.top===k.top&&c.bottom===k.bottom};Rc.ryg=function(c,k){c=c.getRange();k=k.getRange();return c.left===k.left&&c.right===k.right};Object(qd.a)(Rc,"BorderModelAccessorHelper",null,[]);hd.prototype.s$a=function(c,k,D,ba,Ba,nb){c&&(c.Cya(k,D,void 0===Ba?!1:Ba,void 0===nb?!1:nb),c.verticalAlignment=ba)};hd.prototype.kGb=function(c,k,D){this.wX||(this.wX=new Rc(this.Ca,
this.qHa));this.wX.kGb(c,k,D)};Object(qd.a)(hd,"FormatCellsActionModelAccessor",null,[724]);xc.prototype.isValid=function(){return this.Sl&&this.aq?!(void 0===this.formatString||null===this.formatString):!1};xc.prototype.uBh=function(){return null!=this.MD?this.MD:this.formatString};Ll.Object.defineProperties(xc.prototype,{MD:{configurable:!0,enumerable:!0,get:function(){return this.Hcg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.b6a)return this.b6a;if(this.Ooa)return this.Ooa.formatString;
if(!this.Sl)return null;if(null!=this.MD){var c=this.MD;return 0>c?(ed.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(c=this.Sl.Maa[c])?this.b6a=c.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.Ooa?this.Ooa:this.aq&&this.formatString?this.Ooa=this.aq.createFormat(this.formatString,this.tFg).value:null}},tFg:{configurable:!0,enumerable:!0,get:function(){if(!this.Sl||null==this.MD||0>this.MD)return!1;
var c=this.Sl.Maa[this.MD];return c?c.Builtin:!1}}});Object(qd.a)(xc,"NumberFormatHolder",null,[723]);var td=b(247);Object(qd.a)(pc,"FormatCellInstantaneousResult",null,[]);Object(qd.a)(ub,"FormatStringResult",null,[]);var ni=b(1171),Ph=b(521),Gh=b(186),M;(function(c){c.InvalidInput="invalid input";c.UnsupportedZeroResize="resizing to 0 - ignore";c.UnsupportedSkeletonInView="skeleton in view - ignore";c.NullSPD="ActiveSheetProcessedData is null";c.UnsupportedHiddenInRange="hiddens in resizeRanges";
c.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(M||(M={}));Object(qd.b)("InstantaneousRowColumnResizeFailureReason",M);dc.prototype.dispose=function(){Rf.a.mc([this.VPa,this.D1]);this.$=this.D1=this.VPa=null};dc.prototype.NPa=function(c,k,D,ba,Ba,nb,Rb,Ic,Wc){return this.Ngj(c,k,D,void 0===Ba?!1:Ba,void 0===Ic?0:Ic,void 0===nb?"":nb,void 0===Wc?null:Wc)};dc.prototype.PCe=function(c,k,D,ba,Ba,nb){var Rb;(Rb=c.cell.yv).VO=Rb.VO|ba;dc.AOg(ze.g(this.$),c,D,Ba);this.D1.lastSetCellInstantaneousOperation=
k;nb&&ze.g(this.$).vi.u_(k,X.BasicTelemetryCalculator.JP)};dc.prototype.bma=function(c,k,D,ba,Ba,nb){ba=void 0===ba?!1:ba;Ba=void 0===Ba?null:Ba;nb=void 0===nb?null:nb;var Rb=void 0===Rb?null:Rb;nb=nb?nb:c.ga.wa.selectedRanges;if(!(-1690267012===k&&1<nb.length)){-1690267012===k&&ed.ULS.shipAssertTag(537162176,0,1===nb.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",nb.length);var Ic=c.g2("FormatCellsAction.ShowInstantaneousFormatting",nb);try{Ic.$$rst();for(var Wc=
!1;Ic.$$mn();){var Rd=void 0,Ge=Ic.$$cu().cM?c.ppc(Ic.$$cu().range):(Rd=new Tf.a,Rd.add(Ic.$$cu()),Rd);Rd={};for(var df=Ol(Ge),Wf=df.next();!Wf.done;Rd={Pcb:Rd.Pcb},Wf=df.next()){var Pg=Wf.value;if(ze.g(this.$).sy&&Pg&&Rb&&-1690267012===k&&(Rd.Pcb=Pg.range,Rd.Pcb&&Rb.contains(Rd.Pcb)&&ih.a.all(nb,function(Bg){return function(qh){return!cf.c(qh,Bg.Pcb)}}(Rd))))continue;if(!Pg||Ic.Zc.contains(Pg.range))if(this.Ogj(k,Pg,D,ba,Ba,Ic.$$cu().cM),Wc||(c.Ca.lU(),Wc=!0),Ba)break}}}finally{Ic&&Ic.dispose()}}};
dc.prototype.clb=function(c,k,D){if(D=void 0===D?null:D)D.AJa=!0;D=af.a.ma(k.text);var ba=af.a.N6e(k.text),Ba,nb=c.cM?ze.g(this.$).ppc(c.range):(Ba=new Tf.a,Ba.add(c),Ba);Ba=Ol(nb);for(nb=Ba.next();!nb.done;nb=Ba.next())this.Wxg(this.$,nb.value,k.text,k.horizontalAlignment,k.fontColor,k.numberFormatIndex,c.cell.numberFormatIndex,D,ba,k.valueType,k.Urd);c.cell.lRd()};dc.prototype.REi=function(c,k,D,ba,Ba){Ba=void 0===Ba?null:Ba;try{var nb=cf.D(k),Rb=cf.D(D);if(c.$b.B3a(nb)||c.$b.B3a(Rb))return 8;if(-185374993!==
ba&&this.D6h(c,nb,Rb))return 9;if(-185374993!==ba&&(c.$b.ava(Rb)||c.$b.iwb(nb)))return 10;if(1804571062!==ba&&c.$b.baa(Rb))return 11;if(this.d5g(Rb))return 12;if(this.p7h(nb,Rb))return 13;var Ic=this.$.Vb.Dc("UserAction","PasteInstantaneous");Ic.start();Ph.a(Ic);Ba&&ve.b().iB(Ic.id,Ba.id,"actions","actions");!nb.isSingle&&Rb.isSingle&&(Rb=dc.wjh(nb,Rb),c.ga.updateSelection(Rb,Rb,0));switch(ba){case 237279923:case 808159687:if(!this.kFi(nb,Rb))return 14;this.lYc(c,nb,Rb,!0,!1);break;case 1804571062:this.lYc(c,
nb,Rb,!0,!1);break;case -185374993:this.lYc(c,nb,Rb,!1,!0);break;default:return 2}ed.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Wc){return ed.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Wc)),15}};dc.prototype.zLg=function(c,k){c=Ol(c);for(var D=c.next();!D.done;D=c.next())this.TVc(D.value,!0,k)};dc.prototype.TVc=function(c,k,D){D=void 0===D?"":D;if(c){var ba=
ze.g(this.$);if(k){if(k=ba.mm("FormatCellsAction.ClearRangeInstantaneous",c),c=c.isSingle?null:c,k.$$mn()&&void 0!==k.$$cu()&&null!==k.$$cu())for(ba=Object.assign(new gh.a,{Text:""}),this.NPa(k.$$cu(),ba,!1,void 0,Xg.a.bid(this.$),D,void 0,void 0,c);k.$$mn();)void 0!==k.$$cu()&&null!==k.$$cu()&&this.NPa(k.$$cu(),ba,!1,void 0,!1,D)}else this.bma(ba,-1228228458,{},void 0,void 0,[c])}else ed.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};
dc.prototype.wCf=function(c,k){if(!k){k=Gb.HelperMethods.Ac();var D=ze.g(this.$),ba=D.g2("FormatCellsAction.ReformatCells",c);try{ba.$$rst();for(var Ba=!1;ba.$$mn();){var nb=ba.$$cu().cell;nb.K1&&2!==nb.K1||(this.ezj(nb,c),Ba||(D.Ca.lU(),Ba=!0))}}finally{ba&&ba.dispose()}ed.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",Gb.HelperMethods.Ac()-k)}};dc.prototype.IYe=function(c,k){if(this.yg){if(c.formulaBarText)return!af.a.equals(k.Text,
c.formulaBarText,!1);var D=c.cell.formattedText;this.ckd&&(D=td.a(D,c.cell.getCellFont()));return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(D,k).isEqual}return!af.a.equals(k.Text,c.text,!1)};dc.prototype.Qxg=function(c){if(void 0===c||null===c)return new ub(!1,"1234.56");c=new xc(this.Sl,this.aq,void 0,c);if(!c.isValid())return new ub(!1,"1234.56");c=this.brb({value:"1234.56",type:1},c,244,"12px sans-serif");return c.success?new ub(!0,c.text):new ub(!1,"1234.56")};dc.prototype.Qgj=
function(c,k,D,ba){return Jd(c,this,k,D,ba)};dc.prototype.ezj=function(c,k){var D=c.getRange(),ba=!1;k=Ol(k);for(var Ba=k.next();!Ba.done;Ba=k.next())if(D.left===Ba.value.left){ba=!0;break}c.nwj(ba)};dc.prototype.Ngj=function(c,k,D,ba,Ba,nb,Rb){var Ic=void 0;nb=void 0===nb?"":nb;Ic=void 0===Ic?1:Ic;Rb=void 0===Rb?null:Rb;var Wc=new pc;Wc.source=0;Wc.AJa=!1;c.cell.originalIfmt=c.cell.numberFormatIndex;var Rd=k.Text,Ge=af.a.ma(Rd),df=af.a.N6e(Rd);af.a.nn(Rd)&&(ed.ULS.shipAssertTag(537162142,0,!((void 0===
Rd||null===Rd)&&void 0!==k.TextRuns&&null!==k.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),k=Object.assign(new gh.a,{Text:""}),Rd="");c.cell.userInput=Rd;if(!this.IYe(c,k))return this.dJg(c,Ba,Ge,df,Wc);D?this.XIg(c,Rd,this.$.workbookContext.DefaultHyperlinkStyle,Wc):this.RIg(c,k,Rd,Ge,df,ba,Wc,Rb);this.PCe(c,nb,Ba,Ic,Wc.Rcc,Wc.AJa);return Wc};dc.prototype.dJg=function(c,k,D,ba,Ba){Ba.N4f=!0;Ba.Rcc=!0;Ba.AJa=!1;k||ze.g(this.$).Ca.lU();c.cell.Xwa||
(D?c.cell.Cya(0,!1):ba&&c.cell.Cya(1,!1));return Ba};dc.prototype.XIg=function(c,k,D,ba){ba.AJa=!0;c.insertHyperlink(k,cj.a.m6c(k),D)};dc.prototype.RIg=function(c,k,D,ba,Ba,nb,Rb,Ic){Ic=void 0===Ic?null:Ic;Rb.AJa=!1;this.Sl||(this.Sl=this.$.ea.Ba(268));this.tsj(this.Sl,c.cell.numberFormatIndex);ba||Ba?this.TIg(c,ba,Ba,Rb):(ba=new xc(this.Sl,this.aq,c.cell.numberFormatIndex),ba=this.hph(D,ba,c.cell.bbb,c.cell.SYa),ba.success?(this.Ndj(k.TextRuns,k.Fonts)&&this.VIg(c,k,ba),this.clb(c,ba,Rb)):this.aJg(c,
k.Text),ed.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",c.range.top,c.range.left,ba.success,ba.reason,c.cell.numberFormatIndex,af.a.Ukb(c.cell.userInput),af.a.Ukb(ba.text)));c.cell.formulaBarText=D;nb&&this.$rj(this.Sl,c,D,Ic);Rb.Rcc=!0};dc.prototype.TIg=function(c,k,D,ba){ba.AJa=!0;c.text="";c.formulaBarText="";c.cell.userInput="";this.PUc(c,null,null,k,D)};dc.prototype.VIg=
function(c,k,D){this.ebc&&1===k.TextRuns.length&&c.cell.Ixg(k.Fonts[k.TextRuns[0].FontID]);k.Text===D.text&&2===D.valueType&&(this.ebc&&1===k.TextRuns.length?c.cell.text=k.Text:c.cell.formattedText=k)};dc.prototype.aJg=function(c,k){c.text=k;c.formulaBarText=k;this.PUc(c,1)};dc.prototype.PUc=function(c,k,D,ba,Ba,nb){D=void 0===D?null:D;ba=void 0===ba?!1:ba;Ba=void 0===Ba?!1:Ba;nb=void 0===nb?!1:nb;var Rb=c.horizontalAlignment;D=null!=D?D:c.verticalAlignment;!c.cell.Xwa&&(null!=k||ba||Ba||nb)&&(ba?
Rb=0:Ba||nb?Rb=1:null!=k&&(Rb=k),this.Usa.s$a(c,Rb,!1,D,!0))};dc.prototype.tsj=function(c,k){c&&c.Maa&&k>=dc.onh&&k>c.Maa.length-1&&(ed.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",k),c.dMe())};dc.prototype.$rj=function(c,k,D,ba){ba=void 0===ba?null:ba;if(void 0!==c&&null!==c)if(this.Sl.Mfd)ed.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var Ba=
this.$.ea.Ba(266);Ba&&(this.D1.rba=Wd.oye,c&&(this.D1.rba=c.i2e),Ba.KGg(k,D,Object(xd.a)(this.D1,this.D1.bzf,"processResults"),ba))}};dc.prototype.brb=function(c,k,D,ba){var Ba=this.$.ea.Ba(266);if(void 0===Ba||null===Ba)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"calcManager is null");if(void 0===Ba.aq||null===Ba.aq)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"calcManager.NumberFormatter is null");if(void 0===this.Sl||null===this.Sl)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,
"instantaneousManager is null");if(void 0===k||null===k||!k.isValid())return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"numberFormatHolder is invalid or null");var nb=Ba.A$c(k);if(void 0===nb||null===nb)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"cellFormat is null");var Rb=Ba.aq,Ic=Fe(c);if(void 0===Ic||null===Ic)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"cellValue is null");Ba=excelOnlineCalc.calc.cellValueToReadOper(Ba.config.mathpack,Ic);if(void 0===Ba||null===Ba)return new Ad(!1,
void 0,void 0,void 0,void 0,void 0,"readOper is null");nb=Rb.applyFormat(nb,Ba);return excelOnlineCalc.util.isSuccess(nb)?this.D1.syd(Rb,nb.value,c.type,D,ba,null!=k.MD?k.MD:-1):new Ad(!1,void 0,void 0,void 0,void 0,void 0,"NumberFormatter.ApplyFormat: "+JSON.stringify(nb.reason.kind))};dc.prototype.hph=function(c,k,D,ba){var Ba=this.$.ea.Ba(266);if(void 0===Ba||null===Ba)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"calcManager is null");if(void 0===Ba.aq||null===Ba.aq)return new Ad(!1,void 0,
void 0,void 0,void 0,void 0,"calcManager.NumberFormatter is null");if(void 0===this.Sl||null===this.Sl)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"instantaneousManager is null");if(void 0===k||null===k||!k.isValid())return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"numberFormatHolder is invalid or null");var nb=Ba.A$c(k);if(void 0===nb||null===nb)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"cellFormat is null");var Rb=Ba.aq;c=Rb.parseEdit(c,nb);if(!excelOnlineCalc.util.isSuccess(c))return new Ad(!1,
void 0,void 0,void 0,void 0,void 0,"ParseEdit failure: "+JSON.stringify(c.reason.kind));if(c.value.kind===Mj.a.formula)return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"Main thread - skipping formula edit");Ba=excelOnlineCalc.numfmt.applyValueEdit(Rb,Ba.localeInfo,nb,c.value);if(!excelOnlineCalc.util.isSuccess(Ba))return new Ad(!1,void 0,void 0,void 0,void 0,void 0,"NumberFormatter.FormatValueEdit: "+JSON.stringify(Ba.reason.kind));nb=c.value;ed.ULS.shipAssertTag(537162190,0,nb.kind!==Mj.a.formula,
"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");nb=excelOnlineCalc.numfmt.getValueEditOperKind(nb);c=0;switch(nb){case 0:case 128:c=0;break;case 1:c=1;break;case 2:c=2;break;case 4:c=3;break;case 8:c=4;break;case 16:case 32:case 64:case 256:ed.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",nb);break;default:ed.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",
nb)}return this.D1.syd(Rb,Ba.value,c,D,ba,null!=k.MD?k.MD:-1)};dc.prototype.D6h=function(c,k,D){if(k.width<D.width)for(var ba=c.mm("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new mi.Range(k.top,k.left,k.bottom,k.left,!0,!0));ba.$$mn();){var Ba=ba.$$cu();if(Ba&&Ba.R1a())return ed.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}if(k.height<D.height)for(c=c.mm("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new mi.Range(k.top,
k.left,k.top,k.right,!0,!0));c.$$mn();)if((k=c.$$cu())&&k.X1a())return ed.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};dc.prototype.lYc=function(c,k,D,ba,Ba){for(var nb=k.eW().FirstRow,Rb=k.eW().LastRow,Ic=D.eW().LastRow,Wc=nb,Rd=D.eW().FirstRow;Rd<=Ic;Rd++,Wc++){Wc>Rb&&(Wc=nb);var Ge=k.eW();Ge.FirstRow=Ge.LastRow=Wc;var df=D.eW();df.FirstRow=df.LastRow=Rd;this.hRg(c,Aj.a.uP(Ge),Aj.a.uP(df),ba,Ba)}};dc.prototype.kFi=function(c,
k){var D=this.$.ea.Ba(266);return void 0!==D&&null!==D?(D.EGg(c,k.topLeft,Object(xd.a)(this.D1,this.D1.bzf,"processResults")),!0):!1};dc.prototype.p7h=function(c,k){var D=c.right-c.left+1;c=c.bottom-c.top+1;var ba=k.right-k.left+1;k=k.bottom-k.top+1;if(ba>D&&k>c){if(!(ba%D&&k%c))return!0}else if(ba===D&&k>c){if(!(k%c))return!0}else if(ba>D&&k===c&&!(ba%D))return!0;return!1};dc.prototype.d5g=function(c){if(ae.EwaSettings.ka(102)){c=ze.g(this.$).Y_(c).gridView.getRangeInformation(c);c=Ol(c);for(var k=
c.next();!k.done;k=c.next())if(k=k.value,Object(Af.a)(ok.DynamicArrayRange,k)&&!Object(Og.a)(ok.DynamicArrayRange,k).Xgc)return!0}return!1};dc.prototype.hRg=function(c,k,D,ba,Ba){if(D){this.VPa&&D.equals(this.VPa.range)||(Rf.a.Fa(this.VPa),this.VPa=c.mm("FormatCellsAction.CopyBetweenRows",D));k=c.mm("FormatCellsAction.CopyBetweenRows2",k);D=this.VPa;D.$$rst();for(var nb=!1;D.$$mn();){k.$$mn()||(k.$$rst(),k.$$mn());var Rb=k.$$cu(),Ic=void 0,Wc=D.$$cu().cM?c.ppc(D.$$cu().range):(Ic=new Tf.a,Ic.add(D.$$cu()),
Ic);Ic=Ol(Wc);for(var Rd=Ic.next();!Rd.done;Rd=Ic.next())Rd=Rd.value,Rb&&(ba&&(this.lRg(Rd,Rb),Rd.setCell(!0)),Ba&&(nb=this.yOh(Rb,Rd)),nb||(c.Ca.lU(),nb=!0));u.lastOrDefault(Wc)}}else ed.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};dc.prototype.FTf=function(){var c=Qg.a.gd(1,0,0,626,0,104573951,"PivotTableContextMenuOperationFailure");Bi.a(this.$).ai(c)};dc.prototype.egi=function(c,k){var D={ValidMembers:32},ba=k.NumberFormat;switch(c){case 1890566896:if(1001===
ba||1002===ba||1003===ba){D.NumberFormat=14;D.NumberFormatOptions={};switch(ba){case 1001:D.NumberFormatOptions.TimeType=2;break;case 1002:D.NumberFormatOptions.DateType=7;break;case 1003:D.NumberFormatOptions.DecimalPlaces=0}D.NumberFormatOptions.NumberFormatCategory=this.Kxg(ba)}else D.NumberFormat=ba;break;case 1886928607:D.NumberFormat=13;break;case -992833457:D.NumberFormat=11;break;case 218524921:D.NumberFormat=12;break;case 996232352:D.NumberFormat=14;D.NumberFormatOptions=Object.assign(new th.a,
{DecimalPlaces:0});D.NumberFormatOptions.NumberFormatCategory=6;break;default:return k}return D};dc.prototype.formatCells=function(c,k,D,ba,Ba,nb,Rb){ba=void 0===ba?null:ba;Ba=void 0===Ba?null:Ba;nb=void 0===nb?null:nb;Rb=void 0===Rb?null:Rb;var Ic=this.$.Vb.Dc("UserAction","FormatCellsInstantaneous, command = "+ve.b().$h(c)),Wc=this.$.Vb.yi("UserAction","FormatCellsInstantaneousFrame");Wc.start();Ph.a(Wc);var Rd=ve.b().$h(c),Ge=this.$,df=ze.g(Ge),Wf=df.ga.wa,Pg=Ba?Ba:Wf.selectedRanges,Bg=Nj.g(Pg,
function(jk){return jk.BO});Rd=String.format("{0}, cellCount={1}",Rd,Bg);ze.g(this.$).vi.g6(1,Ic.id,Rd);Pg=cf.r(Pg,this.$);Wf=Wf.activeCell;Rd=-168056295===D.command;var qh=Bg=null;if(Rd){qh=df.$b.Up(Wf);if(!qh){this.FTf();return}Bg=qh.hba.substring(1,qh.hba.length-1);qh=qh.m7b();if(!qh){this.FTf();return}qh=qh.Caption}df.wi.PF(!1,!0);var dj=cf.o(Wf,Ge),vi=Ge.ra.ua.Wb(!0),$i=this.egi(D.command,k);Rd||this.bma(df,c,k,!1,ba,Ba);Ic.stop();ze.g(this.$).vi.u_(Ic.id,X.BasicTelemetryCalculator.JP);D.WXh=
bh.a.Qa.Gb;ba=this.$.Vb.Dc("UserAction","FormatCellsUserAction");this.Nci(c,D.taskId,k,Pg,Wf,ba.id);ve.b().iB(Ic.id,ba.id,"actions","actions");ve.b().iB(Wc.id,ba.id,"actions","actions");ae.EwaSettings.pc()?Ge.userOperationManager.jc(new Zc(this,Pg,dj,$i,Rd,Bg,qh,vi,ba,Ic.id,64,nb,Rb),D):Ge.userOperationManager.jc(new Zc(this,Pg,dj,$i,Rd,Bg,qh,vi,ba,Ic.id,0,nb,Rb),D)};dc.prototype.nsi=function(c,k){if(c&&!Hh.a(c)&&k){var D=!!c&&!!c.RequestTelemetryData;ze.g(this.$).vi.Kja(k.toString(),c.StateId,D?
c.RequestTelemetryData.EcsOperationDuration:0,D?c.RequestTelemetryData.EcsRequestDuration:0,D?c.RequestTelemetryData.WfeRequestDuration:0)}};dc.prototype.y1=function(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd,Ge){var df=this,Wf=this.$;return function(Pg,Bg,qh){Wf.Es();Pg=[Pg,Object(xd.a)(df,df.nsi,"onFormatCellOperationWebMethodSuccess")];Bg=[Bg];Rd&&Pg.push(Rd);Ge&&Bg.push(Ge);return hg.q(Wf.ra.ua,c,k,D,ba,Ba,nb,wd.b.apply(null,Pg),wd.a.apply(null,Bg),qh,Wc,Rb,Ic)}};dc.prototype.Ogj=function(c,k,D,ba,Ba,nb){if(k&&
D){var Rb=D.Font,Ic=D.HorizontalAlignment,Wc=D.VerticalAlignment;D.ValidMembers&2||(Ic=k.horizontalAlignment);D.ValidMembers&1||(Wc=k.verticalAlignment);var Rd=!!Ic;dc.WZh(c)&&!Ic&&(Ic=this.jRe(k));var Ge=!1;switch(c){case -394785302:this.Usa.s$a(k,Ic,Rd,0);break;case 1041132226:this.Usa.s$a(k,Ic,Rd,1);break;case -571165336:this.Usa.s$a(k,Ic,Rd,2);break;case -1150205178:case -1142465846:case -286432209:this.Usa.s$a(k,Ic,Rd,Wc,!1,!1);break;case 1650812936:this.setFillColor(k,D,nb);break;case -287251124:k.bold=
Rb.Bold;break;case -1690267012:ze.g(this.$).ga.wa.xh&&(Rb=ze.g(this.$).ga.wa.Nd,this.Usa.kGb(k,D,Rb));break;case 1970784898:D=wi.a.jp(k.color,k.backgroundColor);if($h.a.compare(D,$h.a.red)&&(af.a.pU(k.text)||af.a.OYe(k.text)))break;Rb=$h.a.eG(Rb.FontColor);k.color=Gh.c(wi.a.$E(Rb));break;case -1925065947:k.italic=Rb.Italic;break;case -1293291468:D=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");k.xHd(Rb.FontName,D,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:k.fontSize=
Rb.FontSize;this.$.zf();break;case -1077965542:k.fontSize=Rb.FontSize;break;case 1764140053:k.underline=Rb.Underline;break;case -1685033574:k.doubleUnderline=Rb.DoubleUnderline;break;case -1590502662:k.fontStrikethrough=Rb.Strikethrough;break;case -848953656:case 2045211913:Ge=k.Vmb();break;case 2105621672:Rb=Object(Og.a)(ni.a,Ba);if(!Rb)break;D=$h.a.fqh(Rb.color);k.color=Gh.c(wi.a.$E(D));this.uje(k,Rb.b6a);break;case -1409276245:this.uje(k,D.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.Vxg(k,
D);break;case -1228228458:k.Vmb();k.clearFormat();this.$Qc(k,0);Ge=!0;break;case -730106152:k.clearFormat();this.$Qc(k,0);break;case 932244020:this.B6i(k,D,nb);break;case -1942512156:case -1920201820:this.t8i(k,D)}ba||(Ge?k.N8a(!0):k.setCell(!0))}else ed.ULS.shipAssertTag(537162135,0,!k,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),ed.ULS.shipAssertTag(537162134,0,!D,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};dc.prototype.lRg=function(c,k){c&&
k?(c.xZb(k),c.mWc(k),this.$Qc(c,k.cell.numberFormatIndex)):ed.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};dc.prototype.$Qc=function(c,k){if(0>k)this.kZ("ApplyNumberFormatIndexOnCell",c,!1,"ApplyNumberFormatIndexOnCell: negative format index was supplied");else if(k=new xc(this.Sl,this.aq,k),k.isValid()){var D=this.brb(c.X_,k,c.cell.bbb,c.cell.SYa);D.success?(this.clb(c,D),this.kZ("ApplyNumberFormatIndexOnCell",c,!0,
void 0,D,k)):this.kZ("ApplyNumberFormatIndexOnCell",c,!1,D.reason)}else this.kZ("ApplyNumberFormatIndexOnCell",c,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};dc.prototype.uje=function(c,k){if(void 0===k||null===k)this.kZ("ApplyNumberFormatStringOnCell",c,!1,"ApplyNumberFormatStringOnCell: no format string was supplied");else if(k=new xc(this.Sl,this.aq,void 0,k),k.isValid()){var D=this.brb(c.X_,k,c.cell.bbb,c.cell.SYa);D.success?(this.clb(c,D),this.kZ("ApplyNumberFormatStringOnCell",
c,!0,void 0,D,k)):this.kZ("ApplyNumberFormatStringOnCell",c,!1,D.reason)}else this.kZ("ApplyNumberFormatStringOnCell",c,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};dc.prototype.Vxg=function(c,k){if(k=void 0===k?null:k)if(k=this.aHh(c,k),k.success){var D=this.brb(c.X_,k.khc,c.cell.bbb,c.cell.SYa);D.success?(this.clb(c,D),this.kZ("ApplyNumberFormatCategoryOnCell",c,!0,void 0,D,k.khc)):this.kZ("ApplyNumberFormatCategoryOnCell",c,!1,D.reason,void 0,k.khc)}else this.kZ("ApplyNumberFormatCategoryOnCell",
c,!1,k.reason,void 0,k.khc);else this.kZ("ApplyNumberFormatCategoryOnCell",c,!1,"ApplyNumberFormatCategoryOnCell: no format was supplied")};dc.prototype.Kxg=function(c){switch(c){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<c?-1:c};dc.prototype.aHh=function(c,k){if(!this.Sl||!this.localeInfo||!k)return c=this.Sl?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",
new ld(!1,void 0,"GetRibbonNumberFormat: "+c);k=k.NumberFormat;switch(k){case 0:c=pd.Eqh;break;case 1:c=pd.Gqh;break;case 2:c=pd.Cqh;break;case 3:c=pd.Aqh;break;case 4:c=pd.Jqh;break;case 5:c=pd.Fqh;break;case 6:c=pd.Lqh;break;case 7:c=pd.Hqh;break;case 8:c=pd.Dqh;break;case 9:c=pd.Iqh;break;case 10:c=pd.Kqh;break;case 11:case 12:return this.Sl.dMe(),this.Qxh(c,k);case 13:c=pd.AFg;break;case 1006:c=pd.buttonPercentage;break;case 1004:c=pd.keyboardNumber;break;case 1005:c=pd.keyboardCurrency;break;
case 1002:c=pd.keyboardDate;break;case 1001:c=pd.keyboardTime;break;case 1003:c=pd.keyboardPercentage;break;case 14:return c="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",ed.ULS.shipAssertTag(537162132,0,!1,c),new ld(!1,void 0,c);default:return c="GetRibbonNumberFormat: unknown NumberFormatType!",ed.ULS.shipAssertTag(537162131,0,!1,c),new ld(!1,void 0,c)}if(!c)return new ld(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");c=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,
c);if(!c)return new ld(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");c=new xc(this.Sl,this.aq,void 0,c);return new ld(!0,c)};dc.prototype.Qxh=function(c,k){if(!this.calcManager||!this.aq)return k=this.calcManager?"numberFormatter is null":"calcManager is null",new ld(!1,void 0,"GetDecimalChangeNumberFormat: "+k);c=this.calcManager.A$c(new xc(this.Sl,this.aq,c.cell.numberFormatIndex));if(!c)return new ld(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");
k=this.aq.changeFormatDecimals(c,11===k?1:-1);if(!excelOnlineCalc.util.isSuccess(k))return new ld(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");if(void 0===k.value||null===k.value)return new ld(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");k=new xc(this.Sl,this.aq,void 0,void 0,k.value);return new ld(!0,k)};dc.prototype.kZ=function(c,k,D,ba,Ba,nb){ba=void 0===ba?"":ba;Ba=void 0===Ba?null:Ba;nb=(nb=void 0===nb?null:nb)?nb.MD?nb.MD.toString():
af.a.Ukb(nb.formatString):"null";var Rb=af.a.Ukb(k.X_.value)||"null";Ba=Ba?af.a.Ukb(Ba.text)||"null":"null";c=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",c,k.range.top,k.range.left,D,ba,Rb,k.X_.type,nb,Ba);ed.ULS.sendTraceTag(537162130,0,50,c)};dc.prototype.Wxg=function(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd,Ge){Ic=void 0===Ic?!1:Ic;Wc=void 0===Wc?!1:Wc;var df=k.cell;
df.K1=void 0===Rd?0:Rd;Rd=k.text;Rd!==D&&(df.text=D);df.Urd=void 0===Ge?null:Ge;fj.e(Rd)?k.formulaBarText=Rd:k.formulaBarText="";c=ze.g(c).$b.W4h(k.range);this.PUc(k,ba,null,Ic,Wc,c);Ba&&(k.color=Gh.c(wi.a.$E(Ba)));k.cell.numberFormatIndex=nb;k.cell.originalIfmt=Rb;k.cell.iVf=nb};dc.prototype.Nci=function(c,k,D,ba,Ba,nb){var Rb={};Rb.a=this.$.ya.UserSessionId;Rb.b=k;Rb.c=ba.Ranges.length;Rb.d=this.kVg(ba.Ranges);Rb.e=Ba.toString();Rb.f=c;Rb.h=nb;1890566896===c?Rb.g=D.NumberFormat.toString():2105621672===
c&&(Rb.g=D.NumberFormatOptions.NumberFormatCategory.toString());ve.b().Je(3,Rb,!0)};dc.prototype.kVg=function(c){if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5656060_logRangesAccomulativeDataForFormatCellInvestigation")){for(var k=0,D=0,ba=0,Ba=0;Ba<c.length;Ba++){var nb=cf.B(c[Ba]).BO;k+=nb;nb>ba&&(ba=nb,D=Ba)}c=cf.B(c[D]).toString();return"TotalCellCount:"+k+"; Max range:"+c+"; MaxRangeSize:"+ba+";"}k=Math.min(dc.cff,c.length);ba="";for(D=0;D<k;D++)ba+=cf.B(c[D]).toString()+" ; ";c.length>dc.cff&&
(ba+="and more");return ba};dc.prototype.B6i=function(c,k,D){64===(k.ValidMembers&64)&&this.setFillColor(c,k,D);16===(k.ValidMembers&16)&&dc.Z7i(c,k);128===(k.ValidMembers&128)&&this.Usa.kGb(c,k,c.range);if(2===(k.ValidMembers&2)||1===(k.ValidMembers&1)){D=k.VerticalAlignment;k=k.HorizontalAlignment;var ba=!!k;ae.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!ba&&this.jRe(c);this.Usa.s$a(c,k,ba,D)}};dc.prototype.setFillColor=function(c,k,D){(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
c.u$:c.u$&&c.I9b&&!c.ttb&&!c.M9b)||(k=-1===k.FillColor?D?wi.a.$E($h.a.white):null:wi.a.$E($h.a.eG(k.FillColor)),c.backgroundColor=k?Gh.c(k):null)};dc.prototype.t8i=function(c,k){c.horizontalAlignment&&2!==c.horizontalAlignment||c.Cya(1,!1);0<=c.indentation+k.IndentationIncrease&&(c.indentation+=k.IndentationIncrease)};dc.prototype.jRe=function(c){var k=new xc(this.Sl,this.aq,c.cell.numberFormatIndex);if(!k.isValid())return 0;c=this.brb(c.X_,k,c.cell.bbb,c.cell.SYa);return c.success?null!=c.horizontalAlignment?
c.horizontalAlignment:0:0};dc.prototype.C9i=function(c,k,D){this.wX||(this.wX=new Rc(ze.g(this.$).Ca,this.$));this.wX.kGb(c,k,D)};dc.prototype.yOh=function(c,k){var D=new gh.a;if(c.cell.formulaBarText&&c.cell.formulaBarText.startsWith("'"))D.Text=c.cell.formulaBarText;else{var ba=c.cellValue;ba&&4!==c.cell.K1||(ba=c.text);D.Text=ba}this.NPa(k,D,!1,void 0,Xg.a.bid(this.$));return!0};dc.prototype.Ndj=function(c,k){return this.yg&&!!c&&!!k};dc.AOg=function(c,k,D,ba){ba&&k.setCell(!0);D||c.Ca.lU()};dc.wjh=
function(c,k){k=k.clone();k.height<c.height&&(k.bottom=k.top+c.height-1);k.width<c.width&&(k.right=k.left+c.width-1);return k};dc.WZh=function(c){switch(c){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};dc.Z7i=function(c,k){k=k.Font;var D=!!(k.ValidMembers&16),ba=!!(k.ValidMembers&16),Ba=!!(k.ValidMembers&16);c.bold=!!(k.ValidMembers&4);c.italic=!!(k.ValidMembers&8);D&&(c.underline=D);ba&&(c.doubleUnderline=ba);Ba&&(c.fontStrikethrough=
Ba);D=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");c.xHd(k.FontName,D,"SetFont");c.fontSize=k.FontSize;D=wi.a.jp(c.color,c.backgroundColor);$h.a.compare(D,$h.a.red)&&(af.a.pU(c.text)||af.a.OYe(c.text))||(k=$h.a.eG(k.FontColor),c.color=Gh.c(wi.a.$E(k)))};Ll.Object.defineProperties(dc.prototype,{Usa:{configurable:!0,enumerable:!0,get:function(){return this.$oh}},aq:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?
null:this.calcManager.aq}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});dc.cff=10;dc.onh=36;Object(qd.a)(dc,"FormatCellsAction",null,[695,6]);var wa=oe.a;Em(ce,wa);ce.prototype.create=function(){this.Eb(new dc(this.$))};ce.ja=function(c){c.ea.Ia(18,new ce(c))};Object(qd.a)(ce,"FormatCellsActionFactory",oe.a,[]);Object(qd.a)(kd,"FormulaAssistanceUIContext",null,[]);var Mb=oe.a;Em(Ta,Mb);Ta.prototype.create=
function(){var c=this,k=this.$.ea.Ba(448);if(k)this.Eb(k);else{var D=Wg.GetServiceTaskFactory.Va(this.$.ea,283,284,this.rb,"Common.IDynamicScriptLoaderProvider");Kf.TaskExtensions.Aa(D,function(){Kf.TaskExtensions.Aa(sf.c(D.result.Cp.loadScript(c.A2i)),function(){k=c.$.ea.Ba(448);if(!k){var ba=Object.assign(new kd,{isFeedbackAllowed:c.$.isFeedbackEnabled});k=c.$.ea.Ia(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(ba));c.$.Ppe(function(){var Ba={};Ba.isFeedbackAllowed=c.$.isFeedbackEnabled;
k.updateContext(Ba)})}c.Eb(k)},c.$.la,3)},this.$.la,3)}};Ta.ja=function(c){c.ea.Ia(449,new Ta(c))};Object(qd.a)(Ta,"FormulaAssistanceUIControlFactory",oe.a,[]);var sc=b(679);Object(qd.a)(Ib,"FreezePanesCommandParameters",null,[]);var dd=b(172),Be=b(383),jf=b(265),gf=b(286),Jf=b(118);fc.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(qd.a)(fc,"MacroRecorderSheetPaneFrozenPayload",null,[115]);Da.prototype.Wc=function(c,k){var D=!1;switch(k){case 1844679312:D=1!==c&&!this.gridView.Wa.t3}return D};
Da.prototype.executeCommand=function(c,k){c=this.gridView.Wa;var D=this.gridView.ybd();Td.AFrameworkApplication.xa.Xa.aC&&this.$.IKa&&(1844679312===k.command||340334732===k.command||-806625837===k.command)&&sc.ShyRibbon.PS(1,2);switch(k.command){case 1844679312:return this.setFreezePanes(k,D,c.Mi);case 340334732:return c.x5b?pg.Task.Ra(!1):this.c8i(k,D);case -806625837:return c.uza?pg.Task.Ra(!1):this.d8i(k,D)}return pg.Task.Ra(!1)};Da.prototype.Ec=function(c,k){c=!1;switch(k.command){case 1844679312:case 340334732:case -806625837:case 1745254833:c=
!0}return c};Da.prototype.Yc=function(){return!1};Da.prototype.setFreezePanes=function(c,k,D){if(D)return this.Gpc(c,!1,0,0,0,0,k,null);var ba=this.gridView.ga.wa;D=ba.activeCell.clone();ba=ba.activeRange;ba.Fh&&(ed.ULS.sendTraceTag(537159585,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",D.top,D.bottom,k.top),D.top=D.bottom=k.top);ba.isRow&&(ed.ULS.sendTraceTag(537159584,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",D.left,D.right,k.left),D.left=D.right=k.left);D.top===k.top&&D.left===k.left&&(D=mi.Range.ld(D.top+1,D.left));ba=D.top-1;var Ba=D.left-1,nb=ba-(k.top-1),Rb=Ba-(k.left-1);return this.YAj(D,nb,Rb)?this.Gpc(c,!0,ba,Ba,nb,Rb,k,D):(this.$.zf(),this.Guf(),pg.Task.Ra(!0))};Da.prototype.c8i=function(c,k){return this.Gpc(c,!0,0,k.left,
0,1,k,null)};Da.prototype.d8i=function(c,k){return this.Gpc(c,!0,k.top,0,1,0,k,null)};Da.prototype.YAj=function(c,k,D){var ba=this.gridView.Eg(c),Ba=this.gridView.view.visibleArea;return!ba||Ba.topLeft.y>ba.bottomRight.y||Ba.topLeft.x>ba.bottomRight.x||Ba.bottomRight.y<ba.bottomRight.y||Ba.bottomRight.x<ba.bottomRight.x?(ed.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",
c,ba?ba.toString():"null",Ba.toString()),c=Qg.a.gd(1,0,26,1420,0,2105967339,"FreezePaneSelectionNotInViewErr"),ae.EwaSettings.eA()?new qe.a(this.$,c):(c=new nd.ErrorDialog(this.$,c),c.initialize(),c.mf()),!1):0>=k&&0>=D?(ed.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),c=ze.g(this.$).rtl?1422:1421,k=ze.g(this.$).rtl?-2131054257:-1953454131,c=Qg.a.gd(1,0,26,c,0,k,"FreezePaneA1SelectedErr"),ae.EwaSettings.eA()?new qe.a(this.$,
c):(c=new nd.ErrorDialog(this.$,c),c.initialize(),c.mf()),!1):!0};Da.prototype.Gpc=function(c,k,D,ba,Ba,nb,Rb,Ic){function Wc(){return new fc(Ge)}var Rd=this;this.Cyd=Bi.a(this.$).m8(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.oS(Object(xd.a)(this,this.gnf,"onFreezePanesUpdateCompleted"));this.kE.Vya();this.gridView.qlj(k?"":"UnsetFreezePane");this.u$i(c,k,this.gridView.Wa);var Ge=Object.assign(new Ib,{SheetName:this.$.qa.name,Freeze:k,FrozenRows:Ba,FrozenColumns:nb,FirstRow:D,
FirstColumn:ba});ed.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",k,Ba,nb,D,ba);this.h6b=bh.a.Qa.oe;return uh.a(this.$.userOperationManager,function(df,Wf,Pg){if(ae.EwaSettings.ka(60)){var Bg=window.performance;Bg.clearMarks();Bg.mark("FreezePanes request sent")}Bg=Rd.gridView.Ur;Rd.$.ka(733)&&Bg?(Bg=Rd.T9g(Ge,Bg,Rb,Ic),Rd.asj(Bg)):Rd.$.Es();Bg=Rd.$.ra.ua;var qh=Bg.Na(9,null);qh.freezeSettings=
Ge;return hg.i(Bg,"FreezeOrUnfreezePanes",qh,df,Wf,Pg,k,0)},function(df){return new te.a(151,0,df,void 0,Wc)},c)};Da.prototype.T9g=function(c,k,D,ba){ed.ULS.shipAssertTag(537159580,1,!!k,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!c.Freeze)return null;var Ba=gf.a();Ba.State=1;Ba.IsEstimated=!0;var nb=!1,Rb=!1,Ic=k.OT(mi.Range.ld(D.top,D.left)),Wc=c.FrozenRows,Rd=c.FrozenColumns;1!==c.FrozenRows||c.FrozenColumns?c.FrozenRows||1!==c.FrozenColumns?
(Rd=k.OT(mi.Range.ld(c.FirstRow+1,c.FirstColumn+1)),k=k.OT(mi.Range.ld(D.top,D.left)),Ba.Width=Rd.Ml-Ic.Ml,Ba.Height=Rd.zm-Ic.zm,0<c.FrozenRows&&(Ba.AbsoluteTop=Rd.zm,Rb=!0),0<c.FrozenColumns&&(Ba.AbsoluteLeft=Rd.Ml,nb=!0),Wc=Rd.YM-k.YM,Rd=Rd.lL-k.lL):(Ba.Width=k.gGh(dd.a.ld(D.top,D.left)),ba=mi.Range.ld(D.top,D.left+1),Ba.AbsoluteLeft=Ic.Ml+Ba.Width,nb=!0):(Ba.Height=k.eGh(dd.a.ld(D.top,D.left)),ba=mi.Range.ld(D.top+1,D.left),Ba.AbsoluteTop=Ic.zm+Ba.Height,Rb=!0);Rb&&(Ba.FirstFrozenRow=D.top,Ba.FirstScrollableRow=
ba.top);nb&&(Ba.FirstFrozenColumn=D.left,Ba.FirstScrollableColumn=ba.left);Ba.VisibleRows=Wc;Ba.VisibleColumns=Rd;return Ba};Da.prototype.asj=function(c){var k=this;pg.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){k.$.qa&&k.$.fa&&(k.$.fa.kW(wh.a.Oe,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Be.b(k.$.qa,c,-1,void 0,!0))})};Da.prototype.u$i=function(c,k,D){if(!ae.EwaSettings.ka(704))switch(c.command){case 1844679312:if(k||-1===this.PIa&&-1===this.QIa)this.PIa=
D.qw-D.width+this.gridView.scrollLeft,this.QIa=D.rw-D.height+this.gridView.scrollTop;break;case 340334732:if(k||-1===this.PIa)this.PIa=D.qw-D.width+this.gridView.scrollLeft;break;case -806625837:if(k||-1===this.QIa)this.QIa=D.rw-D.height+this.gridView.scrollTop}};Da.prototype.coc=function(){var c=this.gridView.Wa;0<c.width?this.gridView.scrollLeft=Jf.a.HXb(this.gridView.domElement,ze.g(this.$).rtl,0):-1!==this.PIa&&(this.gridView.scrollLeft=this.PIa,this.PIa=-1);0<c.height?this.gridView.scrollTop=
0:-1!==this.QIa&&(this.gridView.scrollTop=this.QIa,this.QIa=-1)};Da.prototype.Guf=function(){this.kE.jQa();Rf.a.Fa(this.Cyd);this.Cyd=null;this.gridView.TM(Object(xd.a)(this,this.gnf,"onFreezePanesUpdateCompleted"))};Da.prototype.gnf=function(){ae.EwaSettings.ka(704)||this.coc();if(this.h6b){var c=jf.a(bh.a.Qa.oe,this.h6b);ed.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",c);this.h6b=null}this.Guf()};
Object(qd.a)(Da,"FreezePanesCommandHandler",null,[160]);var Gf=Ud.a;Em(lf,Gf);lf.prototype.Gd=function(){var c=this;Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.Va(this.$.ea,12,477,this.rb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),function(k){c.Ad([new Da(c.$,k.result)])},this.$.la)};lf.ja=function(c){c.ea.Ia(116,new lf(c))};Object(qd.a)(lf,"FreezePanesCommandHandlerFactory",Ud.a,[]);var eh=b(921),ug=oe.a;Em(Ee,ug);Ee.prototype.create=function(){var c=
this,k=Wg.GetServiceTaskFactory.create(this.$.ea,18,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction"),D=Wg.GetServiceTaskFactory.create(this.$.ea,102,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([k,D],this.la),function(){c.Eb(c.$.ea.Ba(296)||c.$.ea.Ia(296,new eh.BorderFormatManager(c.$,k.result,D.result)))},this.la,3)};Ee.ja=function(c){ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&
c.ea.Ia(468,new Ee(c))};Object(qd.a)(Ee,"BorderFormatManagerFactory",oe.a,[]);var xh=b(942),Qh=b(23),Vi=b(100),oi=b(277),Yg=b(349),rj=b(346),ah=b(93),Qi;(function(c){c[c.insert=1]="insert";c[c.delete=2]="delete";c[c.rows=4]="rows";c[c.columns=8]="columns";c[c.cellsShiftHorizontal=16]="cellsShiftHorizontal";c[c.cellsShiftVertical=32]="cellsShiftVertical";c[c.insertRows=5]="insertRows";c[c.insertColumns=9]="insertColumns";c[c.insertCellsShiftRight=17]="insertCellsShiftRight";c[c.insertCellsShiftDown=
33]="insertCellsShiftDown";c[c.deleteRows=6]="deleteRows";c[c.deleteColumns=10]="deleteColumns";c[c.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";c[c.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(Qi||(Qi={}));Object(qd.b)("InsertDeleteCellFlags",Qi);var sj=b(410);Object(qd.a)(fe,"MacroRecorderRangeInsertedOrDeletedPayload",null,[115]);var Ci=b(119),tj=b(254),oj=b(1128);b(806);Vc.prototype.fNe=function(c,k,D){var ba=Object.assign(new Hc.a,{Id:"FontDropdownMenu"});ba.MenuSectionList=[];var Ba=Object.assign(new Ld.a,
{ControlsId:"FontsMenuSectionControl"});Ba.ControlList=this.jAh(c,k,D);Array.add(ba.MenuSectionList,Ba);return ba};Vc.prototype.jAh=function(c,k,D){var ba=[],Ba=this.B_h&&!this.j7e;Vc.I6c||Vc.RVh();var nb=Vc.I6c,Rb;for(Rb in nb){var Ic=Rb,Wc=nb[Rb],Rd=xg.a.If(Ic),Ge=xg.a.If(Gb.HelperMethods.YMd[Ic]);Ic=xg.a.If(Ic);Ba||(Wc=0);Rd=Object.assign(new oj.a,{MenuItemId:Rd,CommandValueId:Rd,LabelText:Ba&&0<Wc?xg.a.If(String.fromCodePoint(Wc)):Ge,LabelCss:String.format("font-size:12pt;font-family:{0};",Ba&&
0<Wc?"msofp":Ic),Styles:Vc.p8b(Ba&&0<Wc?"msofp":Ic),AriaLabel:Ge,Alt:Ge,Command:c.toString(),CommandPreviewId:k.toString(),CommandRevertId:D.toString()});Array.add(ba,Rd)}Ba&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(Object(xd.a)(this,this.vxi,"onPreviewFontLoadFailed"));return ba};Vc.prototype.vxi=function(c){this.j7e=!0;this.$.RD(function(k){k.gNa("FontName_New")});ed.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",c))};Vc.RVh=function(){var c={};Vc.I6c=(c["Angsana New"]=
983046,c["Arial Black"]=983051,c.Arial=983050,c.Batang=983061,c["Book Antiqua"]=983077,c["Browallia New"]=983082,c.Calibri=983085,c.Cambria=983089,c.Candara=983091,c.Century=983095,c["Comic Sans MS"]=983100,c.Consolas=983101,c.Constantia=983102,c.Corbel=983106,c["Cordia New"]=983107,c["Courier New"]=983109,c.DilleniaUPC=983121,c.Dotum=983123,c.FangSong=983138,c.Garamond=983154,c.Georgia=983156,c.Gulim=983182,c.GungSuh=983186,c.KaiTi=983222,c.JasmineUPC=983218,c["Malgun Gothic"]=983258,c.Mangal=983262,
c.Meiryo=983264,c["Microsoft JhengHei"]=983272,c["Microsoft YaHei"]=983284,c.MingLiU=983292,c.MingLiU_HKSCS=983296,c["MS Gothic"]=983245,c["MS Mincho"]=983247,c["MS PGothic"]=983249,c["MS PMincho"]=983251,c.PMingliU=983322,c["PMingLiU-ExtB"]=983324,c.SimHei=983382,c.SimSun=983384,c["SimSun-ExtB"]=983386,c["Source Sans Pro"]=983396,c.Tahoma=983405,c.THSarabunPSK=983404,c["Times New Roman"]=983415,c["Trebuchet MS"]=983419,c.Verdana=983443,c["Yu Gothic"]=983464,c["Yu Mincho"]=983474,c)};Vc.p8b=function(c){var k=
{};k["font-family"]=c;k["font-size"]="12pt";return{optionText:k}};Vc.I6c=null;Object(qd.a)(Vc,"FontDropdownHelper",null,[]);Nd.rEg=function(c,k){return new Nd(c,k,null,null)};Nd.jTc=function(c,k){return new Nd(c,null,k,null)};Nd.sEg=function(c,k){return new Nd(c,null,null,k)};Ll.Object.defineProperties(Nd.prototype,{T_a:{configurable:!0,enumerable:!0,get:function(){return this.Icg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.Jcg}},style:{configurable:!0,enumerable:!0,
get:function(){return this.wkg}},size:{configurable:!0,enumerable:!0,get:function(){return this.JSb}}});Object(qd.a)(Nd,"CachedPreviewCellGroup",null,[]);var Pj=b(64);He.prototype.xK=function(){var c=this;this.Uxc=!1;if(Hh.b(this.qAa,514846606)){this.Uxc=!0;ed.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");Pj.a(this.sf.$).fd.lO(514846606);if(this.jLb&&this.rTd)window.setTimeout(function(){c.sf.D9(c.sf.gridView,c.pAa,!0,!0)},0);else return this.HTd=ze.g(this.sf.$).rtl,this.JTd=
Qg.a.gd(3,2,0,this.HTd?613:612,0,514846606,"MergeCellsLoseData"),this.Ui=Bi.a(this.sf.$).ai(this.JTd).G(),this.Ui.isCompleted||(this._state=2,this.Ui.xM(Object(xd.a)(this,this.moveNext,"moveNext"))),this.Nxc;return this.Icb}return this.c0};He.prototype.c0=function(){this.sf.fcf(this.Uxc,this.rTd,this.A6f.scenario,this.jLb);this._state=3};He.prototype.Icb=function(){return this.c0};He.prototype.Nxc=function(){if(this.Qxc=this.Ui.oy())1===this.Qxc&&ed.ULS.sendTraceTag(537159428,0,50,"MergeCellsLoseData Dialog: Cancel pressed");
else return ed.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.Ui=this.sf.D9(this.sf.gridView,this.pAa,!0,!1).g(),this.Ui.isCompleted||(this._state=2,this.Ui.xM(Object(xd.a)(this,this.moveNext,"moveNext"))),this.Oxc;return this.Kcb};He.prototype.Kcb=function(){return this.Icb};He.prototype.Oxc=function(){this.Ui.oy();return this.Kcb};He.prototype.dispose=function(){};He.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.Rt=this.Rt()}catch(c){this.dispose(),
this._state=3}};Object(qd.a)(He,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[6]);Vd.prototype.xK=function(){return Hh.b(this.qAa,514846606)?(ed.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),Pj.a(this.sf.$).fd.lO(514846606),this.ETd=ze.g(this.sf.$).rtl,this.FTd=Qg.a.gd(3,2,0,this.ETd?613:612,0,514846606,"MergeCellsLoseData"),this.Ui=Bi.a(this.sf.$).ai(this.FTd).G(),this.Ui.isCompleted||(this._state=2,this.Ui.xM(Object(xd.a)(this,
this.moveNext,"moveNext"))),this.Hcb):this.c0};Vd.prototype.c0=function(){this._state=3};Vd.prototype.Hcb=function(){if(this.Txc=this.Ui.oy())1===this.Txc&&ed.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");else return ed.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.Ui=this.sf.D9(this.sf.gridView,this.pAa,!0,this.jLb).g(),this.Ui.isCompleted||(this._state=2,this.Ui.xM(Object(xd.a)(this,this.moveNext,"moveNext"))),this.L6f;return this.Jcb};
Vd.prototype.Jcb=function(){return this.c0};Vd.prototype.L6f=function(){this.Ui.oy();return this.Jcb};Vd.prototype.dispose=function(){};Vd.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.Rt=this.Rt()}catch(c){this.dispose(),this._state=3}};Object(qd.a)(Vd,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[6]);var Kj=b(517),Yi=Kj.a;Em(Id,Yi);Id.prototype.Eh=function(){1896159024===this.Mo?(this.Kn=de.a.instance.da(23),
this.V0c=0):(this.Kn=de.a.instance.da(22),this.V0c=1);var c=this.selectedRanges[0].c4&&!this.selectedRanges[0].faa?0:1;this.hc=1;var k={};c=(k.id=this.sc,k.dialogToDisplay=this.V0c,k.defaultSelectedKey=c,k.isRtl=this.isRtl,k);this.initializeAndShow(this.Kn,Object(xd.a)(this,this.BXh,"insertDeleteCellsDialogHandler"),c)};Id.prototype.BXh=function(c,k){if(c){c={};var D="";switch(k.selectedKey){case 0:D=1896159024===this.Mo?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:D=1896159024===this.Mo?
"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:D=1896159024===this.Mo?"InsertRows":"DeleteRows";break;case 3:D=1896159024===this.Mo?"InsertColumns":"DeleteColumns"}ed.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",D);k=new Th.a(1035996630,1,2,8,null);c[Dg.a.Md]=D;this.$.Ka.Ub(k,c)}else ed.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel")};
Ll.Object.defineProperties(Id.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(qd.a)(Id,"InsertDeleteCellsDialog",Kj.a,[]);Object(qd.a)(rd,"MacroRecorderRangeFilledPayload",null,[115]);Object(qd.a)(Pc,"RangeBorders",null,[]);Object(qd.a)(hc,"ScenarioInfo",null,[]);Bb.prototype.dispose=function(){this.$=null};Bb.prototype.I0h=function(c,k){return!(void 0===k||null===k)&&!!(k.scenario&16384)&&this.s3e(k,c)};Bb.prototype.aSe=function(){var c=$d.a.Pe(),
k=ze.g(this.$),D=k.ga.wa.selectedRanges,ba=0,Ba=0,nb=D.length,Rb=new hc;if(1<nb)return Rb.scenario=4,Rb;this.xid&&ze.g(this.$).rtl&&(ba|=65536);if(!k.gja(D[0]))if(this.qbc)ba|=32;else return Rb.scenario=32,Rb;if(k=k.Ca.L0a(D[0],this.$.activeItemName))for(k=Ol(k),nb=k.next();!nb.done;nb=k.next())if(Ba+=1,1<Ba)return this.qbc?(ba|=256,Rb.scenario=ba):Rb.scenario=256,Rb;Ba=ze.g(this.$).Ca.m0a(D[0]);if(!Ba)return Rb.scenario=32768,Rb;k=Ba.length;D=D[0];nb=D.bottom-D.top+1;for(var Ic=D.right-D.left+1,
Wc=new Pc,Rd=0;Rd<k;Rd++)if(this.x7e&&this.YFh(Ba[Rd],D,Wc),ba=ba|(void 0!==Ba[Rd].text&&null!==Ba[Rd].text&&""!==Ba[Rd].text?1:0)|(Ba[Rd].UY?2:0)|(Ba[Rd].UIa?8:0)|(Ba[Rd].qtb?16:0)|(Ba[Rd].mJ?64:0)|(Ba[Rd].u$?128:0),void 0!==Ba[Rd].text&&null!==Ba[Rd].text&&""!==Ba[Rd].text||Ba[Rd].UIa)void 0===Rb.xHa||null===Rb.xHa?Rb.xHa=ze.g(this.$).tc(Ba[Rd].getRange()):ba|=16384;this.x7e&&(Wc.OQa===Ic&&(ba|=512),Wc.vEa===Ic&&(ba|=2048),Wc.lLa===nb&&(ba|=4096),Wc.qOa===nb&&(ba|=1024),0<Wc.OQa&&Wc.OQa<Ic||0<Wc.vEa&&
Wc.vEa<Ic||0<Wc.lLa&&Wc.lLa<nb||0<Wc.qOa&&Wc.qOa<nb)&&(ba|=8192);c=$d.a.Pe()-c;ed.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenrio is : {0}",c);Rb.scenario=ba;return Rb};Bb.prototype.Qff=function(c,k){c=c.command;if(void 0===k||null===k)k=this.aSe();if(!this.s3e(k,c))return!1;var D=ze.g(this.$).ga.wa.selectedRanges;if(!ze.g(this.$).Ca.m0a(D[0]))return!1;var ba=ze.g(this.$).Ca.xqa(D[0],this.$.activeItemName),Ba=ze.g(this.$).ga.wa.Yz,nb=this.$.qa.sheetName;switch(c){case -167499203:this.Phi(k,
D);break;case 1097660126:this.Rff(k,D);break;default:return!1}ba.Txj(D[0],c);ze.g(this.$).YT(D,Ba,nb,null,D[0],null,null,0,"MergeCellCommandAction");return!0};Bb.prototype.s3e=function(c,k){if(-167499203!==k&&1097660126!==k||this.xid&&65536===(c.scenario&65536))return!1;this.qbc&&32===(c.scenario&32)&&(c.scenario&=-33);return 32768===c.scenario||16===(c.scenario&16)||4===c.scenario||256===c.scenario||2===(c.scenario&2)||128===(c.scenario&128)||!this.qbc&&32===c.scenario||void 0!==c.xHa&&null!==c.xHa&&
c.xHa.$ca?!1:c.scenario?16384===(c.scenario&16384)?ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(c.scenario&1)&&8!==(c.scenario&8)||!ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:!0};Bb.prototype.YFh=function(c,k,D){var ba=c.getRange();if(ba.top===k.top)if(c.X1a)D.OQa+=ba.right-ba.left+1;else{var Ba=this.wX.eta(ba,0);if(Ba){var nb=Ol(Ba);for(Ba=nb.next();!Ba.done;Ba=nb.next())Ba=Ba.value,Ba.rtb&&
(D.OQa+=Ba.getRange().right-Ba.getRange().left+1)}}if(ba.left===k.left)if(c.R1a)D.lLa+=ba.bottom-ba.top+1;else if(Ba=this.wX.eta(ba,2))for(nb=Ol(Ba),Ba=nb.next();!Ba.done;Ba=nb.next())Ba=Ba.value,Ba.ztb&&(D.lLa+=Ba.getRange().bottom-Ba.getRange().top+1);if(ba.bottom===k.bottom)if(c.rtb)D.vEa+=ba.right-ba.left+1;else if(Ba=this.wX.eta(ba,1))for(nb=Ol(Ba),Ba=nb.next();!Ba.done;Ba=nb.next())Ba=Ba.value,Ba.X1a&&(D.vEa+=Ba.getRange().right-Ba.getRange().left+1);if(ba.right===k.right)if(c.ztb)D.qOa+=ba.bottom-
ba.top+1;else if(c=this.wX.eta(ba,3))for(c=Ol(c),Ba=c.next();!Ba.done;Ba=c.next())k=Ba.value,k.R1a&&(D.qOa+=k.getRange().bottom-k.getRange().top+1)};Bb.prototype.$Ri=function(c){c=ze.g(this.$).Ca.m0a(c);for(var k=c.length,D=1;D<k;D++){var ba=ze.g(this.$).tc(c[D].getRange());ba.Vmb();ba.clearFormat();ba.cell.bSi();ba.N8a(!0)}};Bb.prototype.szj=function(c,k){c.backgroundColor=k.backgroundColor;c.color=k.color};Bb.prototype.TGh=function(c,k,D){k.cell.S8i(D.bottom-D.top,D.right-D.left);if(void 0!==c&&
null!==c){var ba=c.cell.formattedText,Ba=Object.assign(new gh.a,{TextRuns:ba.TextRuns,Fonts:ba.Fonts});Ba.Text=void 0!==c.cell.originalText&&null!==c.cell.originalText?c.cell.originalText:void 0!==c.cell.userInput&&null!==c.cell.userInput?c.cell.userInput:ba.Text;this.ji.NPa(k,Ba,!1,null,!0,"MergeCells",void 0,2);this.xid?k.xZb(c):this.szj(k,c);k.cell.jRg(c.cell)}this.$Ri(D);k.cell.lRd(!1);return k};Bb.prototype.Phi=function(c,k){this.Rff(c,k).Cya(2,!0)};Bb.prototype.Rff=function(c,k){c=c.xHa;var D=
ze.g(this.$).tc(k[0]);return D=this.TGh(c,D,k[0])};Object(qd.a)(Bb,"MergeCellCommandAction",null,[]);var di=b(105),Qj=b(452),bk=b(372),Nk=b(801);Oc.prototype.U2h=function(c){return 1896159024===c||-1554384558===c||-1113896058===c||1554436520===c||1415868706===c||674605324===c||1035996630===c};Oc.prototype.Wc=function(c,k){return 2054778433===k&&c&1?!lg.a(this.$).Ucc:600686207===k?!1:this.U2h(k)&&ih.a.any(this.gridView.ga.wa.selectedRanges,function(D){return D.Fh||D.isRow})&&!this.m8e&&!this.j8e?!0:
this.jdc(c,k)};Oc.prototype.executeCommand=function(c,k,D){return this.Ub(k,D)};Oc.prototype.Ec=function(c,k,D){if(c=1===c)switch(k.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:c=
!!D;break;case 862825906:case 1532790410:case 46555851:case -1522760979:c=!0;break;default:c=!1}return c};Oc.prototype.Yc=function(c,k,D){switch(k){case "PopulateFontColor":D.MenuItems=this.oA.a7b(1970784898,-803000997,520,null,null,-128950598,2036397036,1688184685,862825906,D.MenuId);break;case "PopulateFillColor":D.MenuItems=this.oA.a7b(1650812936,null,null,87208751,518,673562736,1457172838,-446735083,1532790410,D.MenuId);break;case "PopulateBorderColor":D.MenuItems=this.oA.a7b(-236759591,-1803452024,
520,void 0,void 0,void 0,void 0,void 0,46555851,D.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.COh(D);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":D.MenuItems=this.Ooh.fNe(-1293291468,324978188,-1428968098);break;default:return!1}return!0};Oc.prototype.jdc=function(c,k){var D=ze.g(this.$).ga.wa.selectedRanges;return!(new ci.a(this.$.va)).Tn(c,k,D,this.gridView)};Oc.prototype.Ub=function(c,k){var D=this,ba=this.gridView,Ba=c.command,nb=Kf.TaskExtensions.dm(),
Rb=!0;switch(Ba){case -1077965542:Rb=this.JXe(k,c,!1);break;case 909774670:this.mmb(Ba);Rb=this.JXe(k,c,!0);break;case -1293291468:Rb=this.IXe(k,c,!1);break;case 324978188:ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&ed.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.mmb(Ba);Rb=this.IXe(k,c,!0);break;case 862890474:case 963349338:Rb=this.YNh(c);break;case -1832800737:Rb=this.t9b(Ba,k,!1,c);break;case 1970784898:Rb=
this.t9b(Ba,k,!1,c);break;case -803000997:Rb=this.t9b(Ba,k,!1,c);break;case -128950598:case 1688184685:this.mmb(Ba);Rb=this.t9b(Ba,k,!0,c);break;case 1597684571:Rb=this.dtb(Ba,k,!1,c);break;case 87208751:k.Color="-1";k.IntColor=!0;Rb=this.dtb(Ba,k,!1,c);break;case -446735083:this.mmb(Ba);k.Color="-1";k.IntColor=!0;Rb=this.dtb(Ba,k,!0,c);break;case 1650812936:Rb=this.dtb(Ba,k,!1,c);break;case 673562736:this.mmb(Ba);Rb=this.dtb(Ba,k,!0,c);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(c=ve.b().$h(Ba),ed.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",c));this.GIf(Ba);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Rb=this.INh(Ba,c);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Rb=this.XMh(Ba,c);break;case -1803452024:case -236759591:Rb=this.Zbd(Ba,k,c);break;case -2118943501:Rb=this.borderFormatManager.dNh(k,c);break;case 1012765228:Rb=
this.borderFormatManager.POh(k,c);break;case 1256700402:Rb=this.borderFormatManager.dcd(c);break;case -1756763834:Rb=this.borderFormatManager.ecd(c);break;case -1418159950:Rb=this.borderFormatManager.vXe(c);break;case -1920201820:case -1942512156:Rb=this.ZNh(Ba,c);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Rb=this.borderFormatManager.hXe(k,c);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Rb=this.uOh(Ba,k,c);break;case -693675336:case 322710748:break;
case 1696566924:Rb=this.JNh(c);break;case -167499203:case -255094134:case 1097660126:case 155820588:nb=this.handleMergeCellsCommand(this.gridView,c);break;case 1896159024:case -1554384558:k=this.gridView.ga.wa.selectedRanges;if(this.wej(c,k))ed.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new Id(this.$,Ba,k)).Eh(),Rb=!0;else if(ih.a.any(k,function(Wc){return D.gridView.$b.zKa(Wc)})){ba="";nb=1461300262;var Ic=-1554384558===Ba&&this.gridView.$b.R4h(k[0]);
k=k[0].height>k[0].width&&!Ic;switch(Ba){case 1896159024:ba=k?"InsertColumnsTable":"InsertRowsTable";nb=k?622604322:942362098;break;case -1554384558:ba=k?"DeleteColumnsTable":"DeleteRowsTable",nb=k?284490184:1405456548}k=rg.a.yn(Oc.Dfd,ba,1);new Th.a(nb,1,2,6,null);nb=this.insertOrDeleteCells(k,c,!0)}else nb=this.insertOrDeleteCells(1896159024===Ba?1:2,c,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:nb=this.insertOrDeleteCells(rg.a.yn(Oc.Dfd,k[Dg.a.Md],1),c,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:nb=
this.insertOrDeleteCells(rg.a.yn(Oc.Dfd,k[Dg.a.Md],1),c,!1);break;case 504848446:nb=ba.startEdit(!1,1,k[xe.a.event],void 0,void 0,!0);break;case 1504715724:if(ze.g(this.$).sy&&this.borderFormatManager.qT.bA)break;nb=ba.startEdit(!0,0,k[xe.a.event],void 0,void 0,!0);break;case 1872288872:this.$mb();break;case 41465729:nb=this.fill(ba.ga.wa.Nd,null,0,1,c);break;case -1451655532:case 1972143101:nb=this.fillDownAbsoluteValueAndStartEdit(ba,k[xe.a.event],-1451655532===Ba);break;case -475861485:nb=this.fill(ba.ga.wa.Nd,
null,ba.rtl?1:2,1,c);break;case -978843926:nb=this.fill(ba.ga.wa.Nd,null,3,1,c);break;case 2098035706:nb=this.fill(ba.ga.wa.Nd,null,ba.rtl?2:1,1,c);break;case -2142700828:nb=this.fill(ba.ga.sourceRange,ba.ga.wa.Nd,Oc.uQe(ba.ga.wa.Nd,ba.ga.sourceRange),2,c);break;case 1405660955:nb=this.fill(ba.ga.sourceRange,ba.ga.wa.Nd,Oc.uQe(ba.ga.wa.Nd,ba.ga.sourceRange),4,c);break;case 1983983164:nb=this.fill(ba.ga.wa.Nd,null,0,0,c);break;case 478842689:(c=this.$.ea.Ba(376))?(c.ELi(),Rb=!0):ed.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Rb=ba.ga.Ub(null,Ba);break;case -208772570:this.pOh();Rb=!0;break;case -987339782:this.mNh();Rb=!0;break;case -1770246794:ba.ga.nNh();Rb=!0;break;case 748067091:case -381232414:this.pNh(Ba);Rb=!0;break;case -1522760979:this.gridView.toggleFormulaView();Rb=!0;break;case 886009118:nb=this.WNh();break;case 894341014:this.aOh();
Rb=!0;break;case 862825906:nb=this.VXe(1970784898,c);break;case 1532790410:nb=this.VXe(1650812936,c);break;case 46555851:nb=this.lOh(c);break;default:Rb=!1}Rb||(nb=Nh.a(Ba));return nb};Oc.prototype.wej=function(c,k){var D=this,ba=ih.a.all(k,function(Rb){return!D.gridView.$b.zKa(Rb)}),Ba=1<k.length&&!!this.gridView.$b.Uad(k),nb=ih.a.all(k,function(Rb){return!D.gridView.$b.baa(Rb)});k=!ih.a.any(k,function(Rb){return Rb.isRow||Rb.Fh});return 1===c.method&&6===c.Ze&&(ba||Ba)&&nb&&k};Oc.prototype.fillDownAbsoluteValueAndStartEdit=
function(c,k,D){var ba=this,Ba=c.ga.wa.activeCell,nb=cf.E(Ba,this.gridView.Ur);return c.startEdit(!0,0,k).CWR(function(){var Rb=c.tc(nb),Ic=c.tc(Ba);if(!Rb||!Ic)return ed.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",Ba.toString(),nb.toString()),pg.Task.Ra(!1);ba.gridView.Gc.text=D?Rb.N_:Rb.text;ba.gridView.Gc.textBox.setCaretPositionToEnd();return pg.Task.Ra(!0)})};Oc.prototype.insertOrDeleteCells=
function(c,k,D){function ba(){return new fe(Rd)}var Ba=this,nb=Zh.a.create().toString(),Rb=Enum.toString(Qi,c);this.gridView.vi.g6(17,nb,Rb);Rb=this.gridView.ga.wa.selectedRanges;var Ic=this.m8e,Wc=this.j8e;if(!this.$.Xs(null,!1,void 0,k.Ze)&&!Wc&&!Ic&&5!==c&&9!==c)return pg.Task.Ra(!0);2===c?c=Wc?10:Ic?6:Rb[0].height>Rb[0].width?18:34:1===c?c=Wc?9:Ic?5:Rb[0].height>Rb[0].width?17:33:18===c&&Ic?c=34:34===c&&Wc&&(c=18);Rb=this.Kvg(Rb,c);if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5670217_PromptPasswordDialogForDeleteRowCol")&&
(10===c||6===c)&&!this.$.Xs(Rb,!0))return pg.Task.Ra(!0);var Rd={};Rd.InsertDeleteRangeItems=Array(Rb.length);Rd.SheetName=this.$.qa.sheetName;Rd.IsTableCommand=D;for(D=0;D<Rb.length;D++){Ic=Rb[D];var Ge={},df=Wc=void 0;c&4?(Ge.FirstRow=Ic.top-1,Ge.LastRow=wh.a.zy,Ge.FirstColumn=0,Ge.LastColumn=wh.a.Iv,Wc=Ic.bottom-Ic.top+1,df=0,6===c&&(Ic.Fh||(Ge.FirstRow=Ic.bottom),Wc=-Wc)):c&8?(Ge.FirstRow=0,Ge.LastRow=wh.a.zy,Ge.FirstColumn=Ic.left-1,Ge.LastColumn=wh.a.Iv,Wc=0,df=Ic.right-Ic.left+1,10===c&&(Ic.isRow||
(Ge.FirstColumn=Ic.right),df=-df)):c&16?(Ge.FirstRow=Ic.top-1,Ge.LastRow=Ic.bottom-1,Ge.FirstColumn=Ic.left-1,Ge.LastColumn=wh.a.Iv,Wc=0,df=Ic.right-Ic.left+1,18===c&&(Ge.FirstColumn=Ic.right,df=-df)):(Ge.FirstRow=Ic.top-1,Ge.LastRow=wh.a.zy,Ge.FirstColumn=Ic.left-1,Ge.LastColumn=Ic.right-1,Wc=Ic.bottom-Ic.top+1,df=0,34===c&&(Ge.FirstRow=Ic.bottom,Wc=-Wc));Ge={InsertDeleteRange:Ge};Ge.DeltaRow=Wc;Ge.DeltaColumn=df;Ge.AdjustedSelectedRange=cf.j(Ic);Rd.InsertDeleteRangeItems[D]=Ge}this.gridView.wi.PF(!1);
var Wf=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");Rd.IsDecoupleRecalc=Wf;var Pg=this.$.ra.ua.Wb();return uh.a(this.$.userOperationManager,function(Bg,qh,dj){Wf&&!ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Ba.$.Es();var vi=Ba.$.ra.ua;Bg=wd.b(Bg,Object(xd.a)(Ba,Ba.Rui,"onInsertOrDeleteOperationWebMethodSuccess"));var $i=vi.Na(41,void 0===Pg?null:Pg);$i.insertDeleteMultiRangeParameters=Rd;return hg.i(vi,"InsertDeleteCells",$i,Bg,
qh,dj,nb,0)},function(Bg){return new te.a(237,0,Bg,void 0,ba)},k)};Oc.prototype.Rui=function(c,k){if(!Hh.a(c)&&k){var D=!!c&&!!c.RequestTelemetryData;ze.g(this.$).vi.Kja(k,c.StateId,D?c.RequestTelemetryData.EcsOperationDuration:0,D?c.RequestTelemetryData.EcsRequestDuration:0,D?c.RequestTelemetryData.WfeRequestDuration:0)}};Oc.prototype.Kvg=function(c,k){return k&32?this.jWa(c,function(D){return D.bottom},function(D){return D.top},function(D,ba){D.bottom=ba},!1,!0):k&16?this.gridView.rtl?this.jWa(c,
function(D){return D.left},function(D){return D.right},function(D,ba){D.left=ba},!1,!1):this.jWa(c,function(D){return D.right},function(D){return D.left},function(D,ba){D.right=ba},!1,!1):k&4?this.jWa(c,function(D){return D.bottom},function(D){return D.top},function(D,ba){D.bottom=ba},!0,!0):k&8?this.gridView.rtl?this.jWa(c,function(D){return D.left},function(D){return D.right},function(D,ba){D.left=ba},!0,!1):this.jWa(c,function(D){return D.right},function(D){return D.left},function(D,ba){D.right=
ba},!0,!1):c};Oc.prototype.jWa=function(c,k,D,ba,Ba,nb){c=cf.d(c);c.sort(function(Wc,Rd){return k(Rd)-k(Wc)});if(Ba){Ba=[];nb=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?nb?wh.a.lh+1:wh.a.zh+1:nb?wh.a.zy:wh.a.Iv;for(var Rb=0;Rb<c.length;Rb++){var Ic=c[Rb];D(Ic)<nb&&(ba(Ic,Math.min(k(Ic),nb-1)),Array.add(Ba,Ic),nb=D(Ic))}c=Ba}return c};Oc.prototype.fill=function(c,k,D,ba,Ba){function nb(){return new rd(Wc,Rd,ba,D)}var Rb=this,Ic=this.$;if(!Ic.Xs([k],!0))return pg.Task.Ra(!0);
var Wc=cf.v(c,Ic),Rd=k?cf.v(k,Ic):Wc,Ge=this.$.ra.ua.Wb();return uh.a(this.$.userOperationManager,function(df,Wf,Pg){Rb.$.Es();var Bg=Rb.$.ra.ua,qh=Bg.Na(9,Ge);qh.sourceRange=Wc;qh.targetRange=Rd;qh.fillDirection=D;qh.fillType=ba;return hg.i(Bg,"FillRange",qh,df,Wf,Pg,null,0)},function(df){return new te.a(155,0,df,void 0,nb)},Ba)};Oc.prototype.uOh=function(c,k,D){var ba={ValidMembers:32};switch(c){case 1890566896:c=parseInt(k[Dg.a.Md].toString());if(14===c)return D=new Th.a(2105621672,D.method,D.mode,
D.Ze,D.tabName),k[Dg.a.Md]=null,this.$.Ka.Ub(D,k),ed.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;ba.NumberFormat=c;break;case 1886928607:ba.NumberFormat=13;break;case -992833457:ba.NumberFormat=11;break;case 218524921:ba.NumberFormat=12;break;case 996232352:ba.NumberFormat=1006;break;default:return ed.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+ve.b().$h(D.command)),!1}ed.ULS.sendTraceTag(537159504,
0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",ve.b().$h(D.command),k[Dg.a.Md]);this.ji.formatCells(1890566896,ba,D);this.$.zf();return!0};Oc.prototype.YNh=function(c){var k=this.gridView.tc(this.gridView.ga.wa.activeCell);if(this.yg&&this.gridView.isEditing){k=this.gridView.Yi.J0a(k?fj.a(k).Font:null);if(!k)return ed.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",
this.gridView.ga.wa.activeCell.toString()),!1;var D=k.FontSize}else if(k)D=k.fontSize;else return!1;k=c.command;var ba=0;if(862890474===k)for(;ba<Oc.FHa.length-1&&Oc.FHa[ba]<=D;)ba++;else if(963349338===k)for(ba=Oc.FHa.length-1;0<ba&&Oc.FHa[ba]>=D;)ba--;ed.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",D,Oc.FHa[ba]);if(D===Oc.FHa[ba])return!0;D=Oc.dqc(2);D.Font.FontSize=Oc.FHa[ba];this.yg&&this.gridView.isEditing?
(this.alb(c,!1,D),this.$.zf()):this.ji.formatCells(k,D,c);return!0};Oc.prototype.JXe=function(c,k,D){c=c[c[xh.a.IsFreeForm]?xh.a.Value:Dg.a.Hj].toString();if(!Oc.jHi.test(c))return ed.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) is not a number.",c),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;c=parseFloat(c);if(8>c||72<c)return ed.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) not within expected limits ({1} - {2}).",
c,8,72),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var ba=Math.round(2*c)/2,Ba=Oc.dqc(2);Ba.Font.FontSize=ba;this.yg&&this.gridView.isEditing?(this.alb(k,D,Ba,!0),ba===c||D||this.$.zf()):D?this.ji.bma(this.gridView,-1077965542,Ba,D):(this.ji.formatCells(-1077965542,Ba,k),this.YXa());return!0};Oc.prototype.IXe=function(c,k,D){c=Gb.HelperMethods.YMd[c[Dg.a.Hj]];if(!c)return!0;var ba=Oc.dqc(1);ba.Font.FontName=c;this.yg&&this.gridView.isEditing?
(this.alb(k,D,ba),this.$.zf()):D?this.ji.bma(this.gridView,-1293291468,ba,D):(this.ji.formatCells(-1293291468,ba,k),this.YXa());return!0};Oc.prototype.t9b=function(c,k,D,ba){var Ba=-803000997===c||1688184685===c?"black":k.Color;this.moreColorsHelper&&(-1832800737===c?Ba=af.a.compare(Ba,"WindowText",!0)?this.moreColorsHelper.pDb:"black":D||(this.moreColorsHelper.pDb=Ba,this.moreColorsHelper.zba(k,Ba,ba)));c=Oc.dqc(32);c.Font.FontColor=wi.a.fG(Ba,rg.a.rg(k,"IntColor"));this.yg&&this.gridView.isEditing?
this.alb(ba,D,c,17===ba.Ze):D?this.ji.bma(this.gridView,1970784898,c,D):(this.SG&&(D=this.getThemeColor(k),k=D.themeColor,D.returnValue&&(c.Font.ThemeFontColor=k,c.Font.ColorTypeOption=1)),this.ji.formatCells(1970784898,c,ba),this.YXa());return!0};Oc.prototype.pNh=function(c){var k=(new Date).format(748067091===c?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),D=this.gridView.nj?Ci.a(this.gridView.$):this.gridView.Gc;c=D.textBox;this.gridView.isEditing?D.insertText(k):(this.gridView.startEdit(!0,
1),D.text=k,k=k.length,c.WOa(k),c.caretPosition=k)};Oc.prototype.pOh=function(){this.gridView.gja(this.gridView.ga.wa.activeCell)||this.gridView.zpc||this.gridView.vKa()||this.gridView.kt(this.gridView.ga.wa.activeCell,3,di.a.RWe)};Oc.prototype.mNh=function(){if(!(this.gridView.zpc||this.gridView.vKa()||this.gridView.isEditing&&Qh.a.isMac)){var c=this.gridView.ga.wa.c3;this.gridView.ki(cf.v(c,this.$),c,null,null,60,di.a.RWe)}};Oc.prototype.JNh=function(c){var k=this;this.$5b=ch.d(this.$.va.qa);var D=
this.$.ea.Ba(254,!0);if(this.gridView.n3a)return this.gridView.wi.PF(!1),!!D;if(!D)return ed.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ga.n1(Object(xd.a)(this,this.U6c,"formatPainterOnSelectionChanged"));var ba=String.format(xe.a.Era,vh.a.current.mn(85));this.gridView.wi.wA(ba);c=new Th.a(-911352779,c.method,c.mode,c.Ze,c.tabName);ba={};this.$.Ka.Ub(c,(ba.SilentClipboardAccessFailures=!0,ba.IsFormatPainter=!0,ba)).continueWith(function(Ba){(6>
Ba.status||6===Ba.status&&!Ba.result)&&k.$mb()});this.gridView.n3a=!0;D.Gtg(Object(xd.a)(this,this.$mb,"clearFormatPainter"));return!0};Oc.prototype.$mb=function(){if(this.gridView.n3a){var c=this.$.ea.Ba(254,!0);c&&c.eVi(Object(xd.a)(this,this.$mb,"clearFormatPainter"));this.gridView.n3a=!1;this.gridView.wi.wA(xe.a.Ota);this.gridView.ga.WZ(Object(xd.a)(this,this.U6c,"formatPainterOnSelectionChanged"));ze.g(this.$).$.zf()}};Oc.prototype.U6c=function(){var c=this,k=this.$5b;this.$5b=ch.d(this.$.va.qa);
if(k===this.$5b)if(this.gridView.ga.WZ(Object(xd.a)(this,this.U6c,"formatPainterOnSelectionChanged")),(k=this.$.ea.Ba(254,!0))&&k.aUc(36,ze.g(this.$).ga.wa.selectedRanges)){k=new Th.a(1804571062,2,2,0,null);var D={};this.$.Ka.Ub(k,(D.SkipClipboardAccess=!0,D.ClearCopyStateOnFinish=!0,D.IsFormatPainter=!0,D)).continueWith(function(){c.$mb()})}else this.gridView.wi.PF(!1)};Oc.prototype.dtb=function(c,k,D,ba){var Ba=87208751===c?"-1":k.Color;this.moreColorsHelper&&(1597684571===c?Ba=this.moreColorsHelper.w8a:
D||(this.moreColorsHelper.w8a=Ba===Oc.notSet?Oc.ePd:Ba,this.moreColorsHelper.zba(k,Ba,ba)));c={ValidMembers:64};c.FillColor=wi.a.fG(Ba,rg.a.rg(k,"IntColor"));D?this.ji.bma(this.gridView,1650812936,c,!0):(this.SG&&(D=this.getThemeColor(k),k=D.themeColor,D.returnValue&&(c.ThemeFillColor=k,c.ColorTypeOption=1)),this.ji.formatCells(1650812936,c,ba),this.YXa());return!0};Oc.prototype.aOh=function(){ed.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");
var c=this.$.ea.Ba(221);if(c){var k=this.gridView.Yi;if(k){var D=c.DXh(k.text,k.textBox.caretPosition);var ba=D.phf;var Ba=D.hLe;(D=D.returnValue)?(c.isListVisible=!1,k.text=D,k.textBox.selectRange(ba,ba+Ba),ed.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):ed.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else ed.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else ed.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};Oc.prototype.INh=function(c,k){var D=0,ba=this.gridView,Ba=fj.a(ba.tc(null));this.yg&&ba.isEditing&&(Ba.Font=ba.Yi.J0a(Ba.Font));var nb=Ba.Font;nb||(nb={ValidMembers:0});switch(c){case -287251124:D|=4;tj.e(nb,4)?nb.Bold=!nb.Bold:nb.Bold=!0;break;case -1925065947:D|=8;tj.e(nb,8)?nb.Italic=
!nb.Italic:nb.Italic=!0;break;case 1764140053:D|=16;tj.e(nb,16)?nb.Underline=!nb.Underline:nb.Underline=!0;break;case -1685033574:D|=64;tj.e(nb,64)?nb.DoubleUnderline=!nb.DoubleUnderline:nb.DoubleUnderline=!0;break;case -1590502662:D|=128,tj.e(nb,128)?nb.Strikethrough=!nb.Strikethrough:nb.Strikethrough=!0}if(!D)return!1;nb.ValidMembers=D;Ba.Font=nb;Ba.ValidMembers=16;this.yg&&this.gridView.isEditing?this.alb(k,!1,Ba):(ae.EwaSettings.ka(699)||ba.wi.PF(!1),this.ji.formatCells(c,Ba,k));this.$.zf();return!0};
Oc.prototype.XMh=function(c,k){var D=0,ba=this.gridView,Ba=fj.a(ba.tc(null));-571165336===c||1041132226===c||-394785302===c?(D|=1,Ba.VerticalAlignment=rg.a.yn(Oc.oWa,c.toString(),2)):Oc.F2h(c)?(D|=2,this.TNh(Ba,c)):-1116189897===c&&(D|=8,Ba.Wrap=Ba.ValidMembers&8?!Ba.Wrap:!0);if(!D)return!1;Ba.ValidMembers=D;ae.EwaSettings.ka(699)||ba.wi.PF(!1);this.ji.formatCells(c,Ba,k);this.$.zf();return!0};Oc.prototype.TNh=function(c,k){!ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==k&&(k=-1150205178===k?-286432209:-1150205178);k=rg.a.yn(Oc.oWa,k.toString(),0);c.HorizontalAlignment=k===c.HorizontalAlignment?0:k};Oc.prototype.Zyf=function(c,k,D,ba){var Ba=this,nb=!1;ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(nb=this.jgc.Qff(k,D))&&ze.g(this.$).vi.u_(this.B5a,X.BasicTelemetryCalculator.JP);return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?
this.D9(c,k,!1,nb,function(Rb){Ba.$vi(Rb,D,k,nb,ba)}):this.D9(c,k,!1,nb,function(Rb,Ic,Wc){Ba.bwi(Rb,Ic,Wc,D,k,nb,ba)})};Oc.prototype.handleMergeCellsCommand=function(c,k){var D=this;this.B5a=Zh.a.create().toString();var ba=null;ba=this.jgc.aSe();var Ba=sj.a(k.command),nb=this.jgc.I0h(k.command,ba),Rb=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),Ic=0;Rb&&nb?Ic=$d.a.Pe():ze.g(this.$).vi.g6(4,this.B5a,Ba+", Scenario = "+ba.scenario.toString());Ba=
c.ga.wa.selectedRanges;ed.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",ve.b().$h(k.command),Ba.length,cf.i(Ba,",",this.$,!1));Ba=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);c.wi.PF(!1,Ba);if(10===rg.a.yn(Oc.Sff,k.command.toString(),10))return pg.Task.Ra(!1);var Wc=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Ba&&
Wc)return nb?(Rb?this.AKd(ba,k,!0,!0,Ic):this.AKd(ba,k,!0),pg.Task.Ra(!0)):this.Zyf(c,k,ba,!1);var Rd=!1;Ba&&(Rd=this.jgc.Qff(k,ba))&&ze.g(this.$).vi.u_(this.B5a,X.BasicTelemetryCalculator.JP);return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.D9(c,k,!1,Rd,function(Ge){D.awi(Ge,k,Rd)}):this.D9(c,k,!1,Rd,function(Ge,df,Wf){D.cwi(Ge,df,Wf,k,Rd)})};Oc.prototype.D9=function(c,k,D,ba,Ba){function nb(Wf,Pg,Bg){Wc.$.Es();
Wf=Ba?wd.b(Wf,Ba):Wf;Wf=wd.b(Wf,Rb);return hg.f(Wc.$.ra.ua,Ge,df,D,Wf,Pg,Bg,null,Rd)}function Rb(Wf){var Pg=!!Wf&&!!Wf.RequestTelemetryData;ze.g(Wc.$).vi.Kja(Wc.B5a,Wf.StateId,Pg?Wf.RequestTelemetryData.EcsOperationDuration:0,Pg?Wf.RequestTelemetryData.EcsRequestDuration:0,Pg?Wf.RequestTelemetryData.WfeRequestDuration:0)}function Ic(){return new Wb(Ge,df)}var Wc=this;Ba=void 0===Ba?null:Ba;var Rd=this.$.ra.ua.Wb(),Ge=rg.a.yn(Oc.Sff,k.command.toString(),10),df=cf.r(c.ga.wa.selectedRanges,c.$);return ba?
ae.EwaSettings.pc()?uh.a(this.$.userOperationManager,nb,function(Wf){return new te.a(156,0,Wf,64,Ic)},k):uh.a(this.$.userOperationManager,nb,function(Wf){return new Hg.a(156,0,Wf,void 0,Ic)},k):uh.a(this.$.userOperationManager,nb,function(Wf){return new te.a(156,0,Wf,void 0,Ic)},k)};Oc.prototype.AKd=function(c,k,D,ba,Ba){var nb=this;ba=void 0===ba?!1:ba;Ba=void 0===Ba?0:Ba;ed.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",D);var Rb=ze.g(this.$).rtl,Ic=
ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Rb=Qg.a.gd(3,2,0,Rb?613:612,0,514846606,"MergeCellsLoseData");Kf.TaskExtensions.Aa(Bi.a(this.$).ai(Rb),function(Wc){Wc=Wc.result;if(ba){var Rd=$d.a.Pe()-Ba;ed.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",Rd,Wc)}Wc?1===Wc&&ed.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(ed.ULS.sendTraceTag(537159456,
0,50,"MergeCellsLoseData Dialog: Ok pressed"),D?(ba&&Ic&&(Wc=sj.a(k.command),ze.g(nb.$).vi.g6(4,nb.B5a,Wc+", Scenario = "+c.scenario.toString())),nb.Zyf(ze.g(nb.$),k,c,!0)):nb.D9(nb.gridView,k,!0,!1))},this.$.la,11)};Oc.prototype.fcf=function(c,k,D,ba){k!==c&&ed.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",k,c,D,ba)};Oc.prototype.awi=
function(c,k,D){var ba=this;Hh.b(c,514846606)&&(ed.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Pj.a(this.$).fd.lO(514846606),c=ze.g(this.$).rtl,c=Qg.a.gd(3,2,0,c?613:612,0,514846606,"MergeCellsLoseData"),Kf.TaskExtensions.Aa(Bi.a(this.$).ai(c),function(Ba){(Ba=Ba.result)?1===Ba&&ed.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(ed.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),ba.D9(ba.gridView,k,!0,D))},this.$.la,11))};
Oc.prototype.cwi=function(c,k,D,ba,Ba){new Vd(this,c,k,D,ba,Ba)};Oc.prototype.$vi=function(c,k,D,ba,Ba){var nb=this,Rb=!1;Hh.b(c,514846606)&&(Rb=!0,Pj.a(this.$).fd.lO(514846606),ba&&Ba?window.setTimeout(function(){nb.D9(nb.gridView,D,!0,!0)},0):this.AKd(k,D,!1));this.fcf(Rb,Ba,k.scenario,ba)};Oc.prototype.bwi=function(c,k,D,ba,Ba,nb,Rb){new He(this,c,k,D,ba,Ba,nb,Rb)};Oc.prototype.mmb=function(c){var k=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(k&&this.yXa!==
c&&1461300262!==this.yXa){this.GIf(this.yXa);var D=ve.b().$h(c),ba=ve.b().$h(this.yXa);ed.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",ba,D)}k&&(this.yXa=c);if(this.yg&&this.gridView.isEditing)this.uXa||(this.uXa=this.gridView.Yi.formattedText);else if(!this.nD){this.nD=[];k=this.gridView.g2("GridCommandHandler.CacheFontStyles",this.gridView.ga.wa.selectedRanges);try{for(k.$$rst();k.$$mn();){var Ba=
k.$$cu(),nb=Ba.cell.hasRichText;if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Rb=ve.b().$h(c);ed.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",Rb,nb,this.nD.length)}if(nb)Array.add(this.nD,Nd.rEg(Ba,Ba.cell.formattedText));else switch(c){case 673562736:case -446735083:Array.add(this.nD,Nd.jTc(Ba,Ba.backgroundColor));ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
af.a.ma(Ba.backgroundColor)&&ed.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!Ba.backgroundColor);break;case -128950598:case 1688184685:Array.add(this.nD,Nd.jTc(Ba,Ba.color));ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&af.a.ma(Ba.color)&&ed.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Ba.color);break;case 909774670:Array.add(this.nD,
Nd.sEg(Ba,Ba.fontSize));if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Ic=Nk.c(Ba.fontSize)?"null or undefined":Ba.fontSize.toString();ed.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",Ic)}break;case 324978188:Array.add(this.nD,Nd.jTc(Ba,Ba.fontName)),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(af.a.ma(Ba.fontName)?ed.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",
!Ba.fontName):ed.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Ba.fontName),Ba.fontName.length))}}}finally{k&&k.dispose()}}};Oc.prototype.Oij=function(){return this.yg&&this.gridView.isEditing?!this.uXa:!this.nD};Oc.prototype.J_h=function(c){return!!this.nD&&this.nD.length>c&&!!this.nD[c].formattedText};Oc.prototype.m8c=function(c){return this.nD[c].style};Oc.prototype.ovh=function(c){return this.nD[c].size};
Oc.prototype.GIf=function(c){if(this.Oij())ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&ed.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",c);else{if(this.yg&&this.gridView.isEditing)ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(c=ve.b().$h(c),ed.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",
c)),this.uXa&&(this.gridView.Gc.formattedText=this.uXa);else for(var k=this.nD.length,D=0;D<k;D++){var ba,Ba=this.nD[D].T_a.cell.getRange();if(ba=this.gridView.tc(Ba)){Ba=void 0;var nb=ba.cM?this.gridView.ppc(ba.range):(Ba=new Tf.a,Ba.add(ba),Ba);Ba=Ol(nb);for(nb=Ba.next();!nb.done;nb=Ba.next()){nb=nb.value;if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Rb=ve.b().$h(c);ed.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
Rb,nb.cell.hasRichText,D,ba.cM,k)}if(nb.cell.hasRichText&&1457172838!==c)this.J_h(D)&&(nb.cell.formattedText=this.nD[D].formattedText,ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!nb.cell.formattedText&&ed.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(c){case 1457172838:nb.backgroundColor=this.m8c(D);ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
af.a.ma(nb.backgroundColor)&&ed.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!nb.backgroundColor);break;case 2036397036:nb.color=this.m8c(D);ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&af.a.ma(nb.color)&&ed.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!nb.color);break;case -1904244080:nb.fontSize=
this.ovh(D);ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(nb=Nk.c(nb.fontSize)?"null or undefined":nb.fontSize.toString(),ed.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",nb));break;case -1428968098:Rb=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),nb.xHd(this.m8c(D),Rb,"RestoreCachedStyles")}}}else ed.ULS.sendTraceTag(537159441,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",
Ba.nG(!1))}ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.yXa=1461300262);this.YXa()}};Oc.prototype.YXa=function(){this.yg&&this.gridView.isEditing?this.uXa=null:this.nD=null;ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&ed.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};Oc.prototype.ZNh=function(c,k){var D={IndentationIncrease:0};if(-1942512156===c)D.IndentationIncrease=1;
else if(-1920201820===c)D.IndentationIncrease=-1;else return!0;D.ValidMembers=256;this.ji.formatCells(c,D,k);return!0};Oc.prototype.WNh=function(){var c=this,k=ze.g(this.$),D=cf.r(k.ga.wa.selectedRanges,this.$),ba=cf.o(k.ga.wa.activeCell,this.$);ed.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return uh.a(this.$.userOperationManager,function(Ba,nb,Rb){return hg.K(c.$.ra.ua,ba,D,Ba,nb,Rb,null)},function(Ba){return new te.a(201,0,Ba)},null)};Oc.prototype.VXe=
function(c,k){var D=null,ba=ze.g(this.$).ga.wa.selectedRanges;ba=this.gridView.g2("MoreColors",ba,1,!0);try{for(ba.$$rst();ba.$$mn();){var Ba=ba.$$cu().cell;if(Ba){var nb=Oc.black;if(1970784898===c)nb=Ba.color;else if(1650812936===c){var Rb=Ba.backgroundColor;nb=af.a.compare(Rb,Oc.ePd,!0)&&af.a.compare(Rb,Oc.empty,!0)?Ba.backgroundColor:Oc.white}if(!D)D=nb;else if(D!==nb){D=Oc.black;break}}}}finally{ba&&ba.dispose()}this.yg&&this.gridView.isEditing&&1970784898===c&&this.gridView.Yi.textBox.Kle();
return this.moreColorsHelper.Bva(c,k,D)};Oc.prototype.lOh=function(c){var k=xg.a.c1a(this.borderFormatManager.i2);return this.moreColorsHelper.Bva(-236759591,c,k)};Oc.prototype.alb=function(c,k,D,ba){var Ba=this;ba=void 0===ba?!1:ba;k?this.gridView.Yi.$xf(D.Font):(this.lei(c),ba?window.requestAnimationFrame(function(){Vi.FocusManager.instance().Wj(oi.AFrame.Uga);Ba.gridView.Yi.kMe(D.Font)}):(Vi.FocusManager.instance().Wj(oi.AFrame.Uga),this.gridView.Yi.kMe(D.Font)),this.YXa())};Oc.prototype.lei=function(c){var k=
sj.a(c.command);c=Yg.a[c.Ze]+"_"+rj.a[c.method];var D=this.gridView.uc.gpe.toString(),ba=new Map;ba.set("Command",k);ba.set("Source",c);ba.set("Ribbon","React");ba.set("CellTextRuns",D);ah.Health.instance.recordKpiUsage(bk.a.bph,0,Qj.a.cJf,ba)};Oc.prototype.Zbd=function(c,k,D){c=this.borderFormatManager.Zbd(c,k,D);this.moreColorsHelper&&this.moreColorsHelper.zba(k,this.borderFormatManager.i2,D);return c};Oc.prototype.getThemeColor=function(c){var k={};var D=!1;if(af.a.contains(c.SqmControlId,"ThemeColorPicker",
!1)){if(!this.themesManager)return ed.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:k};D=this.themesManager.getThemeColor(c.Color);c=D.themeIndex;var ba=D.kza;if(D=D.returnValue)k.ThemeColorIndex=c,k.ThemeColorRow=ba}return{returnValue:D,themeColor:k}};Oc.F2h=function(c){return-1150205178===c||-1142465846===c||-286432209===c};Oc.dqc=function(c){var k={},D={};k.ValidMembers=16;k.Font=D;D.ValidMembers=c;return k};Oc.uQe=function(c,
k){var D=c.top<k.top?3:c.bottom>k.bottom?0:-1;return D=c.left<k.left?1:c.right>k.right?2:D};Ll.Object.defineProperties(Oc.prototype,{m8e:{configurable:!0,enumerable:!0,get:function(){return ih.a.all(this.gridView.ga.wa.selectedRanges,function(c){return c.isRow})}},j8e:{configurable:!0,enumerable:!0,get:function(){return ih.a.all(this.gridView.ga.wa.selectedRanges,function(c){return c.Fh})}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.fB||(this.fB=this.$.ea.Ba(422));return this.fB}}});
Ll.Object.defineProperties(Oc,{jHi:{configurable:!0,enumerable:!0,get:function(){return Oc.Y6d||(Oc.Y6d=RegExp("^[0-9]+[.]?[0-9]*$"))}},Dfd:{configurable:!0,enumerable:!0,get:function(){var c={};return Oc.H0d||(Oc.H0d=(c.InsertRows=5,c.InsertColumns=9,c.InsertCellsShiftRight=17,c.InsertCellsShiftDown=33,c.DeleteRows=6,c.DeleteColumns=10,c.DeleteCellsShiftLeft=18,c.DeleteCellsShiftUp=34,c.DeleteRowsTable=6,c.DeleteColumnsTable=10,c.InsertRowsTable=5,c.InsertColumnsTable=9,c))}},oWa:{configurable:!0,
enumerable:!0,get:function(){var c={};return Oc.wdb||(Oc.wdb=(c["-394785302"]=0,c["-571165336"]=2,c["1041132226"]=1,c["-1150205178"]=1,c["-1142465846"]=2,c["-286432209"]=3,c))}},Sff:{configurable:!0,enumerable:!0,get:function(){var c={};return Oc.o4d||(Oc.o4d=(c["-167499203"]=2,c["-255094134"]=5,c["1097660126"]=6,c["155820588"]=7,c))}}});Oc.ePd="transparent";Oc.notSet="-1";Oc.black="#000000";Oc.empty="";Oc.white="#FFFFFF";Oc.H0d=null;Oc.wdb=null;Oc.o4d=null;Oc.Y6d=null;Oc.FHa=[8,9,10,11,12,14,16,
18,20,24,26,28,36,48,72];Object(qd.a)(Oc,"GridCommandHandler",null,[160]);var wk=Ud.a;Em(rc,wk);rc.prototype.Gd=function(){var c=this;if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var k=Wg.GetServiceTaskFactory.create(this.$.ea,111,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.PopulateDynamicHelper.IPopulateDynamicHelper"),D=Wg.GetServiceTaskFactory.create(this.$.ea,18,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction"),ba=Wg.GetServiceTaskFactory.create(this.$.ea,
397,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.MoreColors.IMoreColorsHelper"),Ba=Wg.GetServiceTaskFactory.Va(this.$.ea,296,468,this.rb,"Microsoft.Office.Excel.WebUI.Client.IBorderFormatManager");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([k,D,ba,Ba],this.la),function(){c.Ad([new Oc(c.$,ze.g(c.$),D.result,k.result,Ba.result,ba.result)])},this.la,3)}else{var nb=Wg.GetServiceTaskFactory.create(this.$.ea,111,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.PopulateDynamicHelper.IPopulateDynamicHelper"),
Rb=Wg.GetServiceTaskFactory.create(this.$.ea,18,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction"),Ic=Wg.GetServiceTaskFactory.create(this.$.ea,102,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),Wc=Wg.GetServiceTaskFactory.create(this.$.ea,397,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.MoreColors.IMoreColorsHelper");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([nb,Rb,Ic,Wc],this.la),function(){c.Ad([new Oc(c.$,ze.g(c.$),Rb.result,
nb.result,new eh.BorderFormatManager(c.$,Rb.result,Ic.result),Wc.result)])},this.la,3)}};rc.ja=function(c){Ud.a.Yd(80,new rc(c))};Object(qd.a)(rc,"GridCommandHandlerFactory",Ud.a,[]);var vj=b(29),xk=b(199),Bj=b(1172);Lb.prototype.dispose=function(){var c=this;this.deactivate();this.gridView&&(this.tableManager.FFf(Object(xd.a)(this,this.Kqf,"onRangeListUpdated")),this.gridView.lUi(Object(xd.a)(this,this.Znf,"onHeaderViewBlockCreated")),this.gridView.mUi(Object(xd.a)(this,this.$nf,"onHeaderViewBlockDisposed")),
this.$.va.zg(Object(xd.a)(this,this.kf,"onActiveItemChanged")),this.$.wb.zg(Object(xd.a)(this,this.kf,"onActiveItemChanged")),this.tje(function(k){k.KCd(Object(xd.a)(c,c.YIa,"headerBlockOnUpdatedBlockHtml"))}));this.gridView=this.tableManager=this.$ea=null};Lb.prototype.Euc=function(c,k,D,ba){if(!ch.b(this.$.qa)||this.$.fa.isNamedObjectViewMode||this.gridView.Wa.uza)return!0;if(!D.length)return!1;var Ba=ba.length;if(ba[Ba-1]<c.left)return!1;var nb=Gb.HelperMethods.uw(new xk.a(ba),0,Ba,c.left,Gb.HelperMethods.eC);
if(0>nb)return!1;var Rb=c.hZf,Ic=!!c.TXb&&0<c.TXb.length,Wc=!!c.menuModel&&0<c.menuModel.length,Rd=nb,Ge=0;for(Ba=Math.min(Rb.length+nb,Ba);Rd<Ba;Rd++,Ge++)if(nb=D[Rd],!ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||nb){var df=null,Wf=nb.getElementsByClassName(vj.a.s4c);Wf&&(df=Wf[0]);if(df&&df.innerText){if(Wf=nb.getElementsByClassName(vj.a.ghe))for(var Pg=Wf.length-1;0<=Pg;Pg--)nb.removeChild(Wf[Pg]);Wf=ba[Rd];k?(df.innerText=Rb[Ge],nb.classList.add(vj.a.YHe),
Ic&&c.TXb[Ge]&&(df=document.createElement("div"),df.innerHTML=c.TXb[Ge],Wc&&c.menuModel[Ge]&&this.kpg(c,Ge,Wf),nb.appendChild(df.firstChild))):(nb.classList.remove(vj.a.YHe),df.textContent=mi.Range.U1(Wf),this.Q5g(c,Ge,Wf))}}c.aQa=k;return!0};Lb.prototype.kpg=function(c,k,D){this.$.ea.$a(8,function(ba){ba.e5b.qui(c,k,D)})};Lb.prototype.Q5g=function(c,k,D){this.$.ea.$a(8,function(ba){ba.e5b.rui(c,k,D)})};Lb.prototype.Mv=function(){var c=this.gridView.hbd();if(!(0>=c||c===this.dLa||this.gridView.Mq)){for(var k=
!1,D=[],ba=[],Ba=this.$ea.length-1;0<=Ba;Ba--){var nb=this.$ea[Ba];if(this.gbd(nb)>c||nb.bottom<c)Array.add(D,nb),Array.removeAt(this.$ea,Ba),k=!0}for(Ba=this.tableManager.rangeList.length-1;0<=Ba;Ba--){nb=this.tableManager.rangeList[Ba];var Rb=this.gbd(nb);Rb<=c&&nb.bottom>=c&&!(Rb<=this.dLa&&nb.bottom>=this.dLa)&&nb.bua&&(Array.add(ba,nb),k=!0)}if(k)for(Ba=Ol(this.gridView.T1),nb=Ba.next();!nb.done;nb=Ba.next())for(Rb=Ol(nb.value),nb=Rb.next();!nb.done;nb=Rb.next()){for(var Ic=nb.value,Wc=Ic.Rn,
Rd=Bj.a(Ic.w3),Ge=D.length-1;0<=Ge;Ge--)nb=D[Ge],this.Euc(nb,!1,Rd,Wc)&&Array.removeAt(D,Ge);for(Ge=ba.length-1;0<=Ge;Ge--)nb=ba[Ge],this.Euc(nb,!0,Rd,Wc)&&Array.add(this.$ea,nb);k&&Ic.BHd(Rd)}else ed.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.dLa=c}};Lb.prototype.NUf=function(c,k,D,ba){for(var Ba=!1,nb=this.sKh(c,k),Rb=this.$ea.length-1;0<=Rb;Rb--){var Ic=this.$ea[Rb];k>=Ic.left&&c<=Ic.right&&(this.Euc(Ic,!1,D,ba),Array.removeAt(this.$ea,
Rb),Ba=!0)}c=0;for(k=nb.length;c<k;c++)this.Euc(nb[c],!0,D,ba)&&(Array.add(this.$ea,nb[c]),Ba=!0);return Ba};Lb.prototype.activate=function(){this.we()&&!this.active&&(this.gridView.view.Us(Object(xd.a)(this,this.Mv,"onVisibleAreaChanged")),this.active=!0)};Lb.prototype.deactivate=function(){this.active&&(this.gridView.view.Gr(Object(xd.a)(this,this.Mv,"onVisibleAreaChanged")),this.active=!1)};Lb.prototype.we=function(){return ch.b(this.$.qa)&&!this.$.fa.isNamedObjectViewMode&&0>=this.gridView.Wa.DN&&
0<this.tableManager.rangeList.length};Lb.prototype.tje=function(c){for(var k=Ol(this.gridView.T1),D=k.next();!D.done;D=k.next()){D=Ol(D.value);for(var ba=D.next();!ba.done;ba=D.next())c(ba.value)}};Lb.prototype.sKh=function(c,k){var D=[];if(!this.active)return D;this.dLa=this.gridView.hbd();for(var ba=this.tableManager.rangeList.length-1;0<=ba;ba--){var Ba=this.tableManager.rangeList[ba];Ba.bottom>=this.dLa&&this.gbd(Ba)<=this.dLa&&Ba.left>=c&&Ba.right<=k&&Ba.bua&&Array.add(D,Ba)}return D};Lb.prototype.Znf=
function(c,k){k.isRow||k.eQc(Object(xd.a)(this,this.YIa,"headerBlockOnUpdatedBlockHtml"))};Lb.prototype.$nf=function(c,k){k.isRow||(this.tableManager.rangeList.length||this.deactivate(),k.KCd(Object(xd.a)(this,this.YIa,"headerBlockOnUpdatedBlockHtml")))};Lb.prototype.YIa=function(c,k){if(this.we())this.activate();else if(c=this.active,this.deactivate(),!c){ed.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(k=k.aJa)&&
this.NUf(k.Rn[0],k.Rn[k.Rn.length-1],k.w3,k.Rn)};Lb.prototype.Kqf=function(c,k){!this.gridView.Mq&&(this.we()?this.activate():(c=this.active,this.deactivate(),c||ed.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),k=k.aJa)&&(c=Bj.a(k.w3),this.NUf(k.Rn[0],k.Rn[k.Rn.length-1],c,k.Rn)&&k.BHd(c))};Lb.prototype.kf=function(){this.gridView.Wa.t3?this.deactivate():this.activate()};Lb.prototype.gbd=function(c){var k=this.gridView.$b.Mk(c);
return k&&this.tableManager.r5e(c,k.usedRange.topLeft)?c.top+1:c.top};Object(qd.a)(Lb,"HeaderSnappingFeature",null,[6]);var Cj=oe.a;Em(vb,Cj);vb.prototype.create=function(){var c=this,k=Wg.GetServiceTaskFactory.create(this.$.ea,134,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([k],this.la),function(){c.Eb(c.$.ea.Ba(68)||new Lb(k.result,ze.g(c.$)))},this.la,11)};vb.ja=function(c){c.ea.Ia(67,new vb(c))};Object(qd.a)(vb,"HeaderSnappingFactory",
oe.a,[]);var yk=b(1227),Ri=oe.a;Em(sa,Ri);sa.prototype.create=function(){var c=this,k=this.$.ea,D=Wg.GetServiceTaskFactory.create(k,134,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),ba=Wg.GetServiceTaskFactory.Va(k,213,214,this.rb,"Microsoft.Office.Excel.WebUI.Client.CellAutoComplete.ICellAutoCompleteReadoutHandler");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([D,ba],this.la),function(){var Ba=k.Ba(1);Ba||(Ba=new yk.CellAutoCompleteControl(c.$,D.result),ba.result.ja(Ba));c.Eb(Ba)},
this.la,3)};sa.ja=function(c){c.ea.Ia(151,new sa(c))};Object(qd.a)(sa,"CellAutoCompleteControlFactory",oe.a,[]);Od.prototype.dispose=function(){this.$Pd();this.QWa=null};Od.prototype.ja=function(c){c&&(this.QWa=c,c.EPc(Object(xd.a)(this,this.Qqf,"onReadCellAutoCompleteListBoxDescription")),c.m1(Object(xd.a)(this,this.Rqf,"onReadCellAutoCompleteListBoxItem")),c.Qsg(Object(xd.a)(this,this.Sqf,"onReadCellAutoCompleteMatchItem")))};Od.prototype.$Pd=function(){this.QWa&&(this.QWa.oCd(Object(xd.a)(this,
this.Qqf,"onReadCellAutoCompleteListBoxDescription")),this.QWa.Mba(Object(xd.a)(this,this.Rqf,"onReadCellAutoCompleteListBoxItem")),this.QWa.xUi(Object(xd.a)(this,this.Sqf,"onReadCellAutoCompleteMatchItem")))};Od.prototype.Qqf=function(c,k){1<k.length&&(c=de.a.instance.da(819),this.ariaLiveNotifier.ABf(c,k.length))};Od.prototype.Rqf=function(c,k){ed.ULS.shipAssertTag(537167961,0,0<=k.selectedIndex&&0<=k.length&&k.selectedIndex<k.length,"Invalid ListEventArgs: SelectedIndex/Length");ed.ULS.shipAssertTag(537167960,
0,!af.a.ma(k.xH),"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.NNi(k.xH,k.selectedIndex+1,k.length)};Od.prototype.Sqf=function(c,k){this.ariaLiveNotifier.CNa(k.xH)};Object(qd.a)(Od,"CellAutoCompleteReadoutHandler",null,[796,6]);var Zi=oe.a;Em(yd,Zi);yd.prototype.create=function(){var c=this,k=this.$.ea;Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.Va(k,211,212,this.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),function(D){D=k.Ba(213)||new Od(D.result,
k);c.Eb(D)},this.la,3)};yd.ja=function(c){c.ea.Ia(214,new yd(c))};Object(qd.a)(yd,"CellAutoCompleteReadoutHandlerFactory",oe.a,[]);Nc.dbh="ewa-dv";Nc.ebh="ewa-dv-buttonarea";Nc.kah="ewa-dlb";Nc.Rxb="list-table";Nc.listItem="list-item";Nc.Oxb="list-item-selected";Nc.Sxb="list-table-touch";Nc.cbh="ewa-dpb";Object(qd.a)(Nc,"CssClassNames",null,[]);var ck=b(515),Hi=b(45),pk=b(421),lk=b(944),Sj=nd.ErrorDialog;Em(Lc,Sj);Lc.prototype.dispose=function(){ze.g(this.$).ga.CE(Object(xd.a)(this,this.$c,"onSelectionChanged"));
Sj.prototype.dispose.call(this)};Lc.prototype.setFocus=function(){switch(this.error.Severity){case 0:var c=4;break;case 1:c=3;break;case 2:c=0;break;default:c=this.closeAction}(c=this.getButton(c))?c.get_element().focus():Sj.prototype.setFocus.call(this)};Lc.prototype.unb=function(){var c=ze.g(this.$);c.isEditing&&c.Gc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.fMd(1);if(2===this.returnValue||!this.returnValue){var k=c.tc(null);if(k){c.Ca.lU();
var D=Object.assign(new gh.a,{Text:k.originalText});c.setCell(D,k.range,0,63,null)}this.$.De(-798660877,Dg.a.Tb,8,null)}Sj.prototype.unb.call(this)};Lc.prototype.HEa=function(){var c=ze.g(this.$);c.isEditing&&c.Gc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.fMd(0);Sj.prototype.HEa.call(this)};Lc.prototype.$c=function(){this.setFocus()};Lc.prototype.fMd=function(c){var k=ze.g(this.$);Kf.TaskExtensions.Aa(k.startEdit(!1,c),function(){var D=k.Gc.textBox;
D.text&&D.selectRange(0,D.text.length)},this.la,11,sd.a.current)};Lc.xP=function(c,k,D){D=k.ea.Ba(14).z0a(D);c.MessageId=-1083021405;c.MessageIdName="DataValidationError";c.MessageIdHash=xg.a.jv(c.MessageIdName);c.Severity=D?D.f3c:1;k=D&&D.VGa?xg.a.Xf(D.VGa):null;D=D&&D.error?xg.a.Xf(D.error):String.format("<p>{0}</p><p>{1}</p>",de.a.instance.da(855),de.a.instance.da(856));switch(c.Severity){case 0:c.Appearance=18;break;case 1:c.Appearance=12;D+=String.format("<p>{0}</p>",de.a.instance.da(857));break;
default:c.Appearance=3}c.Caption=k;c.Description=D;c.HelpDescription=de.a.instance.da(1254);c.HelpTopicId=lk.a.Hxe;return c};Object(qd.a)(Lc,"DataValidationErrorDeprecatedDialog",nd.ErrorDialog,[]);var Ik=b(179),jj=b(165),ri=Kj.a;Em(gc,ri);gc.prototype.dispose=function(){this===this.zb.ap&&(this.zb.ap=null);Rf.a.Fa(this.lm);this.lm=null;ri.prototype.dispose.call(this)};gc.prototype.j7i=function(){this.cu&&this.cu.error?this.errorMessage=this.cu.error:this.cu&&this.cu.options&1?(ed.ULS.sendTraceTag(537163289,
0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=de.a.instance.da(1663),this.PZe=vh.a.current.mn(97)):(this.errorMessage=de.a.instance.da(1662),this.Lxh(this.WDe));var c=this.cu?this.cu.f3c:1,k={};this.v9=(k.id=this.sc,k.errorDescription=this.errorMessage,k.helpImageUri=this.PZe,k);switch(c){case 0:this.hc=1;this.yc(1,"Retry");this.v9.dialogIcon=2;this.T7e=!0;break;case 1:this.hc=4;this.v9.dialogIcon=1;this.v9.additionalInformation=de.a.instance.da(857);
break;default:this.hc=1,this.v9.dialogIcon=3}c={};this.v9.helpLink=(c.type="AppLinkProps",c.id=this.error.HelpTopicId,c.text=de.a.instance.da(1254),c.handler=Object(xd.a)(this,this.u6a,"onHelpClicked"),c);c=Qg.a.fRc([this.error]);k={};this.wT=(k.fbError=!0,k.fbCrash=c,k.fbErrorId=jj.a(this.$).Xpb(this.error.MessageIdHash),k.fbOrigin=this.sc,k.DismissHandler=Object(xd.a)(this,this.ptd,"onFeedbackUIClosed"),k);c={};this.v9.giveFeedbackLink=(c.type="AppLinkProps",c.id=xe.a.Hbd,c.text=de.a.instance.da(1699),
c.handler=Object(xd.a)(this,this.kui,"onGiveFeedbackClicked"),c)};gc.prototype.Ixe=function(c){var k=this.$,D=this.T7e;this.hide();var ba=ze.g(k);ba.isEditing&&ba.Gc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===c&&D&&Kf.TaskExtensions.Aa(ba.startEdit(!1,1),function(){var nb=ba.Gc.textBox;nb.text&&nb.selectRange(0,nb.text.length)},this.la,11,sd.a.current);if(1===c&&!D){if(D=ba.tc(null)){ba.Ca.lU();var Ba=Object.assign(new gh.a,{Text:ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5785565_FixDataValidationErrorDialogHandlerBug")?
D.cell.userInput:D.originalText});ba.setCell(Ba,D.range,0,63,null)}k.De(-798660877,Dg.a.Tb,8,null)}2===c&&Kf.TaskExtensions.Aa(ba.startEdit(!1,0),function(){var nb=ba.Gc.textBox;nb.text&&nb.selectRange(0,nb.text.length)},this.la,11,sd.a.current)};gc.prototype.Lxh=function(c){var k=this.$.ra.ua.Wb();hg.u(this.$.ra.ua,cf.q(c,this.$),wd.b(Object(xd.a)(this,this.Osi,"onGetDataValidationRuleInformationSuccessCallback")),wd.a(Object(xd.a)(this,this.Nsi,"onGetDataValidationRuleInformationFailureCallback")),
null,k)};gc.prototype.u6a=function(){Gb.HelperMethods.$aa(this.$.QH,this.error.HelpTopicId,this.$.nW)};gc.prototype.kui=function(){this.Ztb();this.$.De(802602464,2,8,this.wT)};gc.prototype.Nsi=function(){ed.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};gc.prototype.Osi=function(c){!c||Hh.a(c)?ed.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(c=this.kHh(c.Result),this.v9.errorInformation=c,this.Svc(this.VGa,this.pad(Object(xd.a)(this,this.Ixe,"dataValidationErrorDialogHandler")),this.v9))};gc.prototype.kHh=function(c){switch(c.RuleType){case 1:switch(c.ConditionType){case 0:var k=de.a.instance.Bb(107);return String.format(k,c.LowerBoundary,c.UpperBoundary);case 1:return k=de.a.instance.Bb(108),String.format(k,c.LowerBoundary,c.UpperBoundary);case 2:return k=de.a.instance.Bb(109),String.format(k,c.LowerBoundary);case 3:return k=de.a.instance.Bb(110),
String.format(k,c.LowerBoundary);case 4:return k=de.a.instance.Bb(111),String.format(k,c.LowerBoundary);case 5:return k=de.a.instance.Bb(112),String.format(k,c.UpperBoundary);case 6:return k=de.a.instance.Bb(113),String.format(k,c.LowerBoundary);case 7:return k=de.a.instance.Bb(114),String.format(k,c.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(c.ConditionType){case 0:return k=de.a.instance.Bb(115),String.format(k,c.LowerBoundary,c.UpperBoundary);case 1:return k=de.a.instance.Bb(116),
String.format(k,c.LowerBoundary,c.UpperBoundary);case 2:return k=de.a.instance.Bb(117),String.format(k,c.LowerBoundary);case 3:return k=de.a.instance.Bb(118),String.format(k,c.LowerBoundary);case 4:return k=de.a.instance.Bb(119),String.format(k,c.LowerBoundary);case 5:return k=de.a.instance.Bb(120),String.format(k,c.UpperBoundary);case 6:return k=de.a.instance.Bb(121),String.format(k,c.LowerBoundary);case 7:return k=de.a.instance.Bb(122),String.format(k,c.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(c.ConditionType){case 0:return k=
de.a.instance.Bb(123),String.format(k,c.LowerBoundary,c.UpperBoundary);case 1:return k=de.a.instance.Bb(124),String.format(k,c.LowerBoundary,c.UpperBoundary);case 2:return k=de.a.instance.Bb(125),String.format(k,c.LowerBoundary);case 3:return k=de.a.instance.Bb(126),String.format(k,c.LowerBoundary);case 4:return k=de.a.instance.Bb(127),String.format(k,c.LowerBoundary);case 5:return k=de.a.instance.Bb(128),String.format(k,c.UpperBoundary);case 6:return k=de.a.instance.Bb(129),String.format(k,c.LowerBoundary);
case 7:return k=de.a.instance.Bb(130),String.format(k,c.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(c.ConditionType){case 0:return k=de.a.instance.Bb(131),String.format(k,c.LowerBoundary,c.UpperBoundary);case 1:return k=de.a.instance.Bb(132),String.format(k,c.LowerBoundary,c.UpperBoundary);case 2:return k=de.a.instance.Bb(133),String.format(k,c.LowerBoundary);case 3:return k=de.a.instance.Bb(134),String.format(k,c.LowerBoundary);case 4:return k=de.a.instance.Bb(135),String.format(k,
c.LowerBoundary);case 5:return k=de.a.instance.Bb(136),String.format(k,c.UpperBoundary);case 6:return k=de.a.instance.Bb(137),String.format(k,c.LowerBoundary);case 7:return k=de.a.instance.Bb(138),String.format(k,c.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(c.ConditionType){case 0:return k=de.a.instance.Bb(139),String.format(k,c.LowerBoundary,c.UpperBoundary);case 1:return k=de.a.instance.Bb(140),String.format(k,c.LowerBoundary,c.UpperBoundary);case 2:return k=de.a.instance.Bb(141),
String.format(k,c.LowerBoundary);case 3:return k=de.a.instance.Bb(142),String.format(k,c.LowerBoundary);case 4:return k=de.a.instance.Bb(143),String.format(k,c.LowerBoundary);case 5:return k=de.a.instance.Bb(144),String.format(k,c.UpperBoundary);case 6:return k=de.a.instance.Bb(145),String.format(k,c.LowerBoundary);case 7:return k=de.a.instance.Bb(146),String.format(k,c.UpperBoundary);default:return"we couldn't get the details"}case 3:return k=de.a.instance.Bb(105),String.format(k,c.LowerBoundary);
case 7:return k=de.a.instance.Bb(106),String.format(k,c.LowerBoundary);default:return"we couldn't get the details"}};gc.prototype.fMd=function(c){var k=ze.g(this.$);Kf.TaskExtensions.Aa(k.startEdit(!1,c),function(){var D=k.Gc.textBox;D.text&&D.selectRange(0,D.text.length)},this.la,11,sd.a.current)};gc.prototype.ptd=function(){this.show(this.ONb)};gc.xP=function(c,k,D){k=k.ea.Ba(14).z0a(D);c.MessageId=-1083021405;c.MessageIdName="DataValidationError";c.MessageIdHash=xg.a.jv(c.MessageIdName);c.Severity=
k?k.f3c:1;c.HelpDescription=de.a.instance.da(1254);c.HelpTopicId=lk.a.Hxe;return c};Ll.Object.defineProperties(gc.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},la:{configurable:!0,enumerable:!0,get:function(){this.lm=this.lm||new Ik.a;return this.lm.token}}});Object(qd.a)(gc,"DataValidationErrorDialog",Kj.a,[109,110,6,111]);var Tj=b(1030),Fj=b(378),qk=Tj.a;Em(Ab,qk);Ab.prototype.dispose=function(){this.dataValidationControl=null;qk.prototype.dispose.call(this)};
Ab.prototype.Vh=function(c,k){this.dataValidationControl.pb=this.pb;var D=c.keyCode;return 1461300262!==k||16!==D&&17!==D&&18!==D?qk.prototype.Vh.call(this,c,k):!1};Ab.prototype.zsd=function(){this.rU&&(this.dataValidationControl.pb=this.pb,this.dataValidationControl.show(this.dataValidationControl.RP,!0,!0,Qh.a.tr||3===Dg.a.Tb))};Ab.prototype.pj=function(){};Ab.prototype.Rj=function(){this.dataValidationControl.show(this.dataValidationControl.RP,!0,!0,Qh.a.tr||3===Dg.a.Tb)};Ab.prototype.Fyd=function(c,
k){return this.dataValidationControl.Vh(k)};Ll.Object.defineProperties(Ab.prototype,{qvb:{configurable:!0,enumerable:!0,get:function(){return Object(Af.a)(gc,this.$.zb.hh)}},rU:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(c){this.dataValidationControl.isListVisible=c}},uub:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return Fj.a.R_c}}});Object(qd.a)(Ab,"DataValidationListAutoCompleteBehavior",
Tj.a,[]);var dk=b(962),Gj=b(1029),zk=dk.a;Em(cb,zk);cb.prototype.dispose=function(){zk.prototype.dispose.call(this);this.$4a=this.xib=null};cb.prototype.Oca=function(c,k,D,ba){if(c&&(!c||c.length)){this.l6(!1);this.$Fa=c;this.CU=[];for(var Ba=0;Ba<c.length;Ba++)this.CU[Ba]=c[Ba]?c[Ba].Name:null;Ba=String.format("<table class='{0}' aria-live='polite'><tbody>",this.vaa);var nb="",Rb="";c=0;var Ic=ze.g(this.$).tc(null);ba=this.isEditing?ba?ba.text:this.editText:Ic?Ic.originalText:null;Ic=af.a.ma(ba);
var Wc=0;Array.clear(this.FBb);var Rd=[],Ge=[],df=[],Wf=af.a.ma(ba)?[""]:ba.split(" ");ba=ba.trim();for(var Pg={},Bg=0;Bg<this.CU.length;Pg={cyc:Pg.cyc},Bg++){var qh=this.CU[Bg],dj=void 0;Pg.cyc=qh.split(" ");dj=ih.a.all(Wf,function(jk){return function(sk){return ih.a.any(jk.cyc,function(Ek){return af.a.HH(Ek,sk)})}}(Pg));var vi=af.a.ma(qh),$i=Array.contains(df,qh);vi||$i||this.isEditing&&!dj||(dj=qh?xg.a.Xf(xg.a.u3b(qh)):"",dj=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.fZ,dj),
Array.add(df,qh),this.isEditing&&af.a.HH(qh,ba)?(nb+=dj,Array.add(Rd,Bg)):(Rb+=dj,Array.add(Ge,Bg)),!Ic&&af.a.equals(ba,qh,!0)&&(c=this.isEditing?Rd.length-1:Wc,Ic=!0),Wc++)}this.Fva=Wc;Array.addRange(this.FBb,Rd);Array.addRange(this.FBb,Ge);this.Zf.innerHTML=Ba+(nb+Rb+"</tbody></table>");Ba=this.sn=Ne.DOMElementExtensions.lj(this.domElement,this.vaa);this.ckb(Ba,k);this.l6(!0);this.Ypa(k,D);this.Dk=0<this.Fva?Ba.rows[c]:null}};cb.prototype.XOa=function(c){var k=!1;this.isEditing&&c&&(k=!this.Fva,
c.endEdit(k,"DataValidationListBox.SetCellContent",0));if(!k&&(c=ze.g(this.$),k=c.tc(null))){var D=null;this.aca&&-1!==this.aca.SheetId&&-1!==this.aca.Row&&-1!==this.aca.Column&&(D={},D.SheetName=this.aca.SheetId.toString(),D.FirstRow=this.aca.Row,D.FirstColumn=this.aca.Column,D={ParameterType:6,SourceRange:D});var ba=Object.assign(new gh.a,{Text:this.je});c.setCell(ba,k.range,0,63,D)}return!0};cb.prototype.Ypa=function(c,k){var D=c?this.zyb:this.$G;c=c?this.Iec:this.Jec;if(0>=this.Fva)this.Zf.style.height=
Gb.HelperMethods.Pb(c);else if(this.Zf.style.height="auto",this.Fva>D){var ba=this.j2f?Math.floor(c*D):Math.floor(this.Zf.offsetHeight*D/this.Fva);!this.j2f&&this.tci&&ed.ULS.sendTraceTag(529056667,0,50,"DataValidationListBox.adjustHeightAndWidth:\n            old height: "+ba+",\n            new height: "+Math.floor(c*D)+",\n            maxItems: "+D+", listItemHeight: "+c+", listItemCount: "+this.Fva);Ne.DOMElementExtensions.eF(this.Zf,ba);this.Zf.style.overflowY="auto"}else this.Zf.style.height=
"auto",this.Zf.style.overflowY="hidden";Ne.DOMElementExtensions.nq(this.Zf,k);Ne.DOMElementExtensions.nq(this.sn,k-(this.Fva>D?Jf.a.yp:0))};Ll.Object.defineProperties(cb.prototype,{Dk:{configurable:!0,enumerable:!0,get:function(){return this.xib},set:function(c){this.qza(this.xib);if(c){this.xib=c;this.$4a.innerText="";this.qza(this.xib);var k=this.FBb[c.rowIndex];this.je=this.CU[k];this.$Fa&&(this.aca=this.$Fa[k],ed.ULS.shipAssertTag(537163286,0,!this.FBb.length||!!this.aca,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));
this.$4a.innerText=this.je;this.cpc(c)}else this.aca=this.je=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return ze.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return ze.g(this.$).Gc.text}}});Object(qd.a)(cb,"DataValidationListBox",dk.a,[]);var Mg=b(239),ek=b(117),Rj=b(167),Fk=Oh.a;Em(Qa,Fk);Qa.prototype.mPc=function(c){this.get_events().addHandler("ClickButton",c)};Qa.prototype.$Bd=function(c){this.get_events().removeHandler("ClickButton",c)};Qa.prototype.CPc=
function(c){this.get_events().addHandler("KeyDown",c)};Qa.prototype.nCd=function(c){this.get_events().removeHandler("KeyDown",c)};Qa.prototype.qVb=function(c){this.get_events().addHandler("PointerOver",c)};Qa.prototype.zCd=function(c){this.get_events().removeHandler("PointerOver",c)};Qa.prototype.pVb=function(c){this.get_events().addHandler("PointerOut",c)};Qa.prototype.yCd=function(c){this.get_events().removeHandler("PointerOut",c)};Qa.prototype.ikb=function(c){this.get_events().addHandler("Blur",
c)};Qa.prototype.aEb=function(c){this.get_events().removeHandler("Blur",c)};Qa.prototype.n8=function(c){this.get_events().addHandler("Focus",c)};Qa.prototype.Kba=function(c){this.get_events().removeHandler("Focus",c)};Qa.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(ck.a.QX),this.domElement.style.cursor="",$f.a.instance.pa(qf.a.click,this.domElement,Object(xd.a)(this,this.Rc,"onClick")),ek.KeyInputManager.instance.pa(qf.a.Qb,this.domElement,Object(xd.a)(this,this.onKeyDown,
"onKeyDown")),Rj.a.instance.pa(qf.a.pointerOver,this.domElement,Object(xd.a)(this,this.Lv,"onPointerOver")),Rj.a.instance.pa(qf.a.pointerOut,this.domElement,Object(xd.a)(this,this.EM,"onPointerOut")),this.rc.Zz("blur")||this.rc.ja("blur",Object(xd.a)(this,this.onBlur,"onBlur")),this.rc.Zz("focus")||this.rc.ja("focus",Object(xd.a)(this,this.onFocus,"onFocus")),this.domElement.title=this.m8g,this.gl=!0)};Qa.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(ck.a.QX),this.domElement.style.cursor=
"",this.isEnabled&&($f.a.instance.za(qf.a.click,this.domElement,Object(xd.a)(this,this.Rc,"onClick")),ek.KeyInputManager.instance.za(qf.a.Qb,this.domElement,Object(xd.a)(this,this.onKeyDown,"onKeyDown")),Rj.a.instance.za(qf.a.pointerOver,this.domElement,Object(xd.a)(this,this.Lv,"onPointerOver")),Rj.a.instance.za(qf.a.pointerOut,this.domElement,Object(xd.a)(this,this.EM,"onPointerOut"))),this.domElement.title=this.l3g,this.gl=!1)};Qa.prototype.dispose=function(){this.isEnabled&&($f.a.instance.za(qf.a.click,
this.domElement,Object(xd.a)(this,this.Rc,"onClick")),ek.KeyInputManager.instance.za(qf.a.Qb,this.domElement,Object(xd.a)(this,this.onKeyDown,"onKeyDown")),Rj.a.instance.za(qf.a.pointerOver,this.domElement,Object(xd.a)(this,this.Lv,"onPointerOver")),Rj.a.instance.za(qf.a.pointerOut,this.domElement,Object(xd.a)(this,this.EM,"onPointerOut")),this.gl=!1);Ne.DOMElementExtensions.setVisible(this.domElement,!1);Fk.prototype.dispose.call(this)};Qa.prototype.Rc=function(c){this.raiseEvent("ClickButton",c);
return!0};Qa.prototype.onKeyDown=function(c){this.raiseEvent("KeyDown",c);return!1};Qa.prototype.Lv=function(){this.hovered=!0;this.raiseEvent("PointerOver");return!1};Qa.prototype.EM=function(){this.hovered=!1;this.raiseEvent("PointerOut");return!1};Qa.prototype.onBlur=function(c){mg.g(c);this.focused=!1;this.raiseEvent("Blur")};Qa.prototype.onFocus=function(c){mg.g(c);this.focused=!0;this.raiseEvent("Focus")};Qa.Ab=function(c,k,D,ba,Ba,nb,Rb,Ic){c.removeAttribute("Href");c.setAttribute(xe.a.Od,
xe.a.Zq);c.className=k;c.tabIndex=Ic;k=document.createElement("span");k.className=Rb;k.classList.add(D);k.tabIndex=-1;c.appendChild(k);c=document.createElement("img");c.src=vh.a.ve(ba);c.className=Ba;c.alt=nb;c.tabIndex=-1;k.appendChild(c);return c};Ll.Object.defineProperties(Qa.prototype,{Oj:{configurable:!0,enumerable:!0,get:function(){return this.fI}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.gl}}});Object(qd.a)(Qa,"ListButton",Oh.a,[731,6]);var fk=b(123),Ng=ia.a.XLg,
rk=Oh.a;Em(fb,rk);fb.prototype.dispose=function(){this.$&&(this.uIb(!1),this.gridView.ga.SM(Object(xd.a)(this,this.mh,"onActiveCellChanged")),this.gridView.Cs(Object(xd.a)(this,this.onContentReady,"onContentReady")),this.gridView.uc.UTi(Object(xd.a)(this,this.omf,"onEditBoxDimensionsChanged")),this.$.Lo(Object(xd.a)(this,this.Pd,"onWorkbookClosing")));this.fwe(!1);this.gwe(!1);Rf.a.mc(this.p1b);this.p1b=this.Vfa=this.Zf=this.hV=this.kF=this.gridView=this.$=null;rk.prototype.dispose.call(this)};fb.prototype.A1c=
function(c){return!!this.z0a(c)};fb.prototype.aob=function(c,k){return ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new gc(this.$,c,k):new Lc(this.$,c,k)};fb.prototype.z0a=function(c){c=this.gridView.getRangeInformation(c);for(var k=0;k<c.length;k++){var D=c[k];if(Object(Af.a)(pk.DataValidationRange,D))return D}return null};fb.prototype.cuh=function(){if(!this.L1a)return"";var c=this.jZe?String.format("{0} {1}",this.cu.nzf,this.cu.prompt):"",k=this.xtb?de.a.instance.da(804):
"";return String.format(de.a.instance.Bb(17),c,k)};fb.prototype.Vh=function(c){var k=!1;if(this.isListVisible||(-569786022===c||541421805===c)&&this.xtb||1872288872===c&&this.RP)switch(c){case -569786022:case 541421805:this.show(this.RP,!this.isListVisible,!0,Qh.a.tr||3===Dg.a.Tb);k=!0;break;case 1872288872:this.isListVisible?(this.show(this.RP,!1,!0,!1),k=!0):this.RP?(this.show(!1,!1,!0,!1),k=!0):this.pb&&(this.pb.endEdit(!1,"DataValidationControl.HandleKeyDown",0),k=!0);break;case -798660877:this.Gh.jA(1);
k=!0;break;case 137938150:this.Gh.jA(-1);k=!0;break;case 2091832999:this.Gh.jA(this.Gh.$G-1);k=!0;break;case 742457698:this.Gh.jA(-(this.Gh.$G-1));k=!0;break;case 125627505:case 267796030:k=this.XOa()}return k};fb.prototype.show=function(c,k,D,ba){this.zv();if(this.Iwb&&this.L1a){var Ba=this.hMa;if(Ba){if(c||k||D)this.isVisible=!0;td.d(this.style,this.isGridRtl);D&&this.xtb&&(this.gwe(!0),this.M2f(Ba,!1));k&&this.xtb&&this.OPa(ba,Ba);c&&this.jZe&&this.Ihj(Ba);this.A7h||(this.isVisible=!1)}}};fb.prototype.yta=
function(c,k){if(!k||!k.cell.jj)return null;var D=this.gridView.uc.textBox.domElement;var ba=0<Ne.DOMElementExtensions.getHeight(D)&&0<Ne.DOMElementExtensions.getWidth(D)&&0<=D.offsetTop&&0<=D.offsetLeft;if(ba)D=Ne.DOMElementExtensions.yta(D,c.Gi);else{D=c.getCellBounds(k.cell);var Ba=Ne.DOMElementExtensions.getBoundingClientRect(c.Gi);D=new Sys.UI.Bounds(D.x-Ba.x,D.y-Ba.y,D.width,D.height)}if(D)if(ba)2<D.height&&2<D.height&&(D.x+=1,D.y+=1,D.height-=2,D.width-=2);else if(ba=ze.g(this.$).cJ(k.cell))ba=
ba.width+1,Ba=af.a.equals(Mg.a.y0a(k.cell,c.rtl),"right",!0),c.rtl&&Ba&&(D.x=D.x+D.width-ba),k.mja&&c.rtl===Ba&&(D.width=ba);else return null;return D};fb.prototype.USf=function(c){var k=this.L1a;this.uIb(k);k?this.show(!0,c,!0,!1):this.zv()};fb.prototype.XOa=function(){var c=!1;this.isListVisible&&(c=this.Gh.XOa(this.pb),this.show(this.RP,!1,!0,!1));return c};fb.prototype.zv=function(){this.L0h?(this.isListVisible&&(this.isListVisible=!1),this.QJa&&(this.QJa=!1),this.RP&&(this.RP=!1),this.isVisible&&
(this.isVisible=!1)):this.isListVisible=this.QJa=this.RP=this.isVisible=!1;this.nid=this.qgd=this.mjd=!1};fb.prototype.OPa=function(c,k){this.xtb&&!this.cu.$Fa?this.QJa&&this.yh.disable():(this.fwe(!0),this.Gh.Oca(this.cu.$Fa,c,this.FCh(k),this.pb),this.Jza(k,!1))};fb.prototype.Ihj=function(c){this.cu.prompt&&(this.RP=!0,this.Fyj(this.cu.nzf,this.cu.prompt),this.c3f(c,!1))};fb.prototype.M2f=function(c,k){var D=c.y;this.Vfa.style.top=Gb.HelperMethods.Pb(D);c=this.isGridRtl?c.x-this.Vfa.offsetWidth+
1:c.x+c.width+1;this.Vfa.style.left=Gb.HelperMethods.Pb(c);k?this.QJa=this.gridView.Jdc(new Hi.a(c,D))&&this.qgd:this.qgd=!0};fb.prototype.Jza=function(c,k){var D=c.y+c.height;c=this.isGridRtl?c.x+c.width-this.Zf.offsetWidth:c.x;this.Zf.style.top=Gb.HelperMethods.Pb(D);this.Zf.style.left=Gb.HelperMethods.Pb(c);k?this.isListVisible=this.gridView.Jdc(new Hi.a(c,D))&&this.nid:this.nid=!0};fb.prototype.c3f=function(c,k){var D=c.y+c.height+5,ba=this.activeCell;ba=ba?ba.width/2:32;c=this.isGridRtl?c.x-
this.hV.offsetWidth+ba:c.x+c.width-ba;this.hV.style.top=Gb.HelperMethods.Pb(D);this.hV.style.left=Gb.HelperMethods.Pb(c);k?this.RP=this.gridView.Jdc(new Hi.a(c,D))&&this.mjd:this.mjd=!0};fb.prototype.Fyj=function(c,k){if(k){var D="";c&&(D+=String.format("<p class='dv-prompt-title'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",xg.a.Xf(c)));D+=String.format("<p class='dv-prompt-message'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",xg.a.Xf(k));this.hV.innerHTML=D;c=Ne.DOMElementExtensions.lj(this.hV,
"dv-prompt-titletext");if(k=Ne.DOMElementExtensions.lj(this.hV,"dv-prompt-messagetext"))for(c=c?parseInt(String(Math.max(c.offsetWidth,k.offsetWidth))):k.offsetWidth,c+=6,Ne.DOMElementExtensions.nq(this.hV,c),k=0,D=this.hV.children.length;k<D;k++)Ne.DOMElementExtensions.nq(this.hV.children[k],c)}};fb.prototype.FCh=function(c){if(this.M0h)return c.width+17-2+1;var k=this.Vfa.clientWidth;this.s3h&&17!==k&&ed.ULS.sendTraceTag(528855200,0,15,"DataValidationControl.getListBoxWidth: buttonWidth is "+k);
return c.width+k-2+1};fb.prototype.gwe=function(c){this.$&&!this.Iwb||!c?(this.NWf(!1),Rf.a.Fa(this.yh),this.yh=null):(this.yh||(this.yh=new Qa(this.Vfa,"ewa-dv-listbutton",ck.a.Iga,1,"ewa-dv-listbutton",de.a.instance.da(854),Ng,de.a.instance.da(853),"",-1),this.NWf(!0)),this.QJa=!0,this.cu.$Fa?this.yh.isEnabled||this.yh.enable():this.yh.disable())};fb.prototype.fwe=function(c){this.$&&!this.Iwb||!c?(this.mQa(!1),Rf.a.Fa(this.Gh),this.Gh=null):(this.Gh||(this.Gh=new cb(this.$,this.Zf,this.$4a),this.mQa(!0)),
this.isListVisible=!0)};fb.prototype.mQa=function(c){this.Gh&&(c&&!this.aQ?(this.Gh.n8(Object(xd.a)(this,this.ctd,"onDataValidationListBoxGotFocus")),this.Gh.hVb(Object(xd.a)(this,this.qJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.Gh.Bkb(Object(xd.a)(this,this.Mwa,"onSetCell")),this.aQ=!0):!c&&this.aQ&&(this.Gh.Kba(Object(xd.a)(this,this.ctd,"onDataValidationListBoxGotFocus")),this.Gh.dnc(Object(xd.a)(this,this.qJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.Gh.pEb(Object(xd.a)(this,this.Mwa,"onSetCell")),
this.aQ=!1))};fb.prototype.uIb=function(c){c&&!this.GP?(this.gridView.view.Us(Object(xd.a)(this,this.fq,"onGridScroll")),this.GP=!0):!c&&this.GP&&(this.gridView.view.Gr(Object(xd.a)(this,this.fq,"onGridScroll")),this.GP=!1)};fb.prototype.NWf=function(c){this.yh&&(c&&!this.SXb?(this.yh.mPc(Object(xd.a)(this,this.wMa,"onListButtonClicked")),this.yh.CPc(Object(xd.a)(this,this.wMa,"onListButtonClicked")),this.yh.ikb(Object(xd.a)(this,this.qJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.SXb=!0):!c&&this.SXb&&
(this.yh.$Bd(Object(xd.a)(this,this.wMa,"onListButtonClicked")),this.yh.nCd(Object(xd.a)(this,this.wMa,"onListButtonClicked")),this.yh.aEb(Object(xd.a)(this,this.qJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.SXb=!1))};fb.prototype.T2f=function(){if(this.L1a){var c=this.hMa;c&&(this.M2f(c,!0),this.Jza(c,!0),this.c3f(c,!0))}};fb.prototype.mh=function(){this.USf(!1)};fb.prototype.wMa=function(c,k){this.show(this.RP,!this.isListVisible,!0,Qh.a.tr||3===k.yb||3===Dg.a.Tb);this.ctd(null,null)};fb.prototype.ctd=
function(){this.gridView.setFocus()};fb.prototype.qJa=function(){this.pb.textBox.pJ=!0};fb.prototype.fq=function(){this.T2f()};fb.prototype.onContentReady=function(){this.USf(this.isListVisible)};fb.prototype.Pd=function(){this.zv()};fb.prototype.Mwa=function(){this.XOa()};fb.prototype.omf=function(){this.T2f()};Ll.Object.defineProperties(fb.prototype,{Iwb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.zd&16)}},A7h:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||
this.RP||this.QJa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Ne.DOMElementExtensions.isVisible(this.Zf)},set:function(c){Ne.DOMElementExtensions.setVisible(this.Zf,c)}},RP:{configurable:!0,enumerable:!0,get:function(){return Ne.DOMElementExtensions.isVisible(this.hV)},set:function(c){Ne.DOMElementExtensions.setVisible(this.hV,c)}},QJa:{configurable:!0,enumerable:!0,get:function(){return Ne.DOMElementExtensions.isVisible(this.Vfa)&&!!this.yh&&Ne.DOMElementExtensions.isVisible(this.yh.domElement)},
set:function(c){Ne.DOMElementExtensions.setVisible(this.Vfa,c);this.yh&&Ne.DOMElementExtensions.setVisible(this.yh.domElement,c)}},pb:{configurable:!0,enumerable:!0,get:function(){return this.kF},set:function(c){this.kF=c}},L1a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.A1c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.tc(null)}},jZe:{configurable:!0,enumerable:!0,get:function(){return this.L1a&&!!this.cu&&!!(this.cu.options&
2)&&!!this.cu.prompt}},xtb:{configurable:!0,enumerable:!0,get:function(){return this.L1a&&!!this.cu&&!!(this.cu.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},cu:{configurable:!0,enumerable:!0,get:function(){return this.z0a(this.activeCell.range)}},hMa:{configurable:!0,enumerable:!0,get:function(){var c=this.activeCell;return c?this.yta(this.gridView,c):null}}});Object(qd.a)(fb,"DataValidationControl",Oh.a,[687,6]);var Ak=oe.a;Em(sb,Ak);sb.prototype.create=
function(){this.Eb(this.$.ea.Ba(14)||new fb(this.$))};Object(qd.a)(sb,"DataValidationControlFactory",oe.a,[]);jc.E4c="!";jc.Muf="[";jc.Luf="]";jc.openParen="(";jc.closeParen=")";jc.a6f=" /.(*\\".split("");jc.l3b="...";jc.PBb="param_help_link";jc.Rvd="param_help_udf";jc.s7c="function_list_box";jc.vqh="function_param_box";jc.u7c="function_reader_description";jc.n7c="function_description_box";jc.JMe="function_param_table";jc.PDi="param_row_";jc.Svd="param_set";jc.tvf="param_row_0";jc.uvf="param_row_1";
jc.wqh="<div id='{0}' class='{1}'></div>";jc.uqh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";jc.vvf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";jc.rqh="<div id='{0}' class='{1} {2} {3}'></div>";jc.oqh="<div id='{0}' class='{1} {2} {3} {4}'></div>";jc.Haf="[@";jc.yRg=1;jc.xRg=3;jc.E0g=500;jc.wff=50;Object(qd.a)(jc,
"FormulaAssistanceConstants",null,[]);var Ii=b(76),Uj=b(216);Object(qd.a)(Db,"FormulaAuthoringUsageDetails",null,[]);Object(qd.a)(Hb,"FormulaSuggestionsUsageDetails",null,[]);Object(qd.a)(Qb,"AutocompleteCardInteractionUsageDetails",null,[]);Object(qd.a)(Sa,"AutocompleteRenderOptimizationDetails",null,[]);Object(qd.a)(Ca,"SessionDetails",null,[]);Object(qd.a)(ua,"PerfMetrics",null,[]);Object(qd.a)($a,"AggregatedPerfMetrics",null,[]);Ua.prototype.WE=function(){this.$fc=bh.a.Qa.oe.m};Ua.prototype.Pz=
function(c){-1!==this.$fc&&(c?(this.akb(bh.a.Qa.oe.m-this.$fc),this.$fc=-1):this.Gy.failedCount++)};Ua.prototype.Vlh=function(){this.GGd?(this.Gy.excludingFirstAction=Ua.uKe(this.aY),Array.add(this.aY,this.Gy.firstAction),this.Gy.includingFirstAction=Ua.uKe(this.aY)):(Nj.i(this.aY),this.Gy.includingFirstAction.median=this.aY[Math.floor(.5*this.aY.length)],this.Gy.includingFirstAction.P75=this.aY[Math.floor(.75*this.aY.length)],this.Gy.includingFirstAction.P95=this.aY[Math.floor(.95*this.aY.length)])};
Ua.prototype.akb=function(c){this.GGd?(this.Gy.count?1E3>this.Gy.count&&Array.add(this.aY,c):this.Gy.firstAction=c,this.Gy.count++):(1E3>this.Gy.count&&Array.add(this.aY,c),this.Gy.count++,this.Gy.includingFirstAction.average=Math.round((this.Gy.includingFirstAction.average*(this.Gy.count-1)+c)/this.Gy.count),this.Gy.includingFirstAction.max=Math.max(this.Gy.includingFirstAction.max,c))};Ua.uKe=function(c){var k=new $a;0<c.length&&(Nj.i(c),k.median=c[Math.floor(.5*c.length)],k.P75=c[Math.floor(.75*
c.length)],k.P95=c[Math.floor(.95*c.length)],k.max=c[c.length-1],k.average=Nj.g(c,function(D){return D})/c.length);return k};Object(qd.a)(Ua,"PerformanceMeasurement",null,[]);var Bk=b(41),mk=b(106);Jb.prototype.WE=function(c){this.A7a.qb(c)||this.A7a.ia(c,new Ua);this.A7a.oa(c).WE()};Jb.prototype.Pz=function(c,k){k=void 0===k?!0:k;this.A7a.qb(c)&&this.A7a.oa(c).Pz(k)};Jb.prototype.YMf=function(c){var k="Undefined";switch(c){case 1:k="Collapsed";break;case 0:k="Expanded";break;case 2:k="Hidden"}this.Cha.argumentAssistanceCardInitialMode=
k};Jb.prototype.Pd=function(){this.y$i();this.ub.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging())};Jb.prototype.getJsonForLogging=function(){return"{"+this.c2("SessionDetails",this.Spc)+","+this.c2("FormulaAuthoringUsage",this.Cha)+","+this.c2("FormulaSuggestionsUsage",this.e6b)+","+this.c2("AutocompleteCardInteraction",this.t1)+","+this.c2("AutocompleteRenderOptimization",this.Elb)+","+this.LHh()+"}"};Jb.prototype.y$i=function(){this.Spc.argumentAssistanceFlight=this.x9c("Microsoft.Office.ExcelOnline.",
"ArgumentAssistancePlugin");this.Spc.autoCompleteUIFlight=this.x9c("Microsoft.Office.Excel.","AutoCompleteNewUI");this.Spc.smartFormulaBarAutoCompleteFlight=this.x9c("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled")};Jb.prototype.LHh=function(){for(var c=new Tf.a,k=Ol(this.A7a),D=k.next();!D.done;D=k.next())D=D.value,D.value.Vlh(),c.add(String.format('"{0}":{1}',D.key,Sf.a.Hc(D.value.Gy)));return String.format('"PerfMeasurements": {{{0}}}',c.toArray().join(","))};Jb.prototype.x9c=
function(c,k){return af.a.contains(this.ub.ya.FlightHolder.FlightId,k,!0)?ae.EwaSettings.getBooleanFeatureGate(c+k,!1)?"T":"C":"None"};Jb.prototype.c2=function(c,k){return String.format('"{0}":{1}',c.toString(),Bk.c(k))};Ll.Object.defineProperties(Jb.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.ub},set:function(c){this.ub||(this.ub=c,this.ub.dn(Object(xd.a)(this,this.Pd,"onWorkbookClosing")))}}});Ll.Object.defineProperties(Jb,{instance:{configurable:!0,enumerable:!0,get:function(){Jb.Ma||
(Jb.Ma=new Jb);return Jb.Ma}}});Jb.Ma=null;Object(qd.a)(Jb,"FormulaAssistanceTelemetryManager",null,[]);var gk=b(347),Zj=Oa.a;Em(qb,Zj);qb.prototype.initialize=function(){this.Nb.classList.add(Ii.a.Nah);this.Nb.innerHTML=qb.SF();this.Ee||(this.Ok(),this.i1());Zj.prototype.initialize.call(this);var c=Ne.DOMElementExtensions.lj(this.Nb,"ewa-dlg-function-link-container");this.rtl&&(c.align="right",this.mrb.style.marginLeft="5px");this.Ee&&(c.style.padding="1px");this.functionInfoManager.Spb({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};qb.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.bnc(Object(xd.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded")),this.functionInfoManager.$.fa.qk(Object(xd.a)(this,this.Vc,"onSessionIdChanged")));Rf.a.mc([this.EYb,this.E4,this.Qtb,this.MHa,this.nrb]);Zj.prototype.dispose.call(this)};qb.prototype.Ok=function(){this.NHa=Ne.DOMElementExtensions.lj(this.Nb,"ewa-dlg-function-category-select");this.Fha=Ne.DOMElementExtensions.lj(this.Nb,
"ewa-dlg-select");this.NHa.setAttribute(xe.a.Od,xe.a.jEa);this.MHa=new zg.a(this.NHa,!0);this.nrb=new zg.a(this.Fha,!0);this.HMe=Ne.DOMElementExtensions.lj(this.Nb,"ewa-dlg-function-loading");this.mrb=Ne.DOMElementExtensions.lj(this.Nb,"ewa-dlg-function-help-link");this.LMe=Ne.DOMElementExtensions.lj(this.Nb,"ewa-dlg-udf-name");this.Mbf=Ne.DOMElementExtensions.lj(this.Nb,"ewa-dlg-function-icon");this.IMe=$get(qb.o7c,this.Nb);this.Eha=Ne.DOMElementExtensions.lj(this.Nb,"ewa-dlg-function-help-string");
this.Ee&&(this.Eha.style.paddingLeft="1px");this.functionInfoManager.skb(Object(xd.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded"));this.functionInfoManager.$.fa.Yj(Object(xd.a)(this,this.Vc,"onSessionIdChanged"))};qb.prototype.HP=function(c){var k=this;this.$.ea.$a(40,function(){k.MHa.HP(c)})};qb.prototype.Zl=function(){this.formulaAssistanceControl.set_visible(!1);Zj.prototype.Zl.call(this);this.Wcd||(this.getButton(0).get_element().disabled=!0)};qb.prototype.setFocus=function(){!this.NHa.disabled&&
this.Wcd&&Ne.DOMElementExtensions.setFocus(this.NHa)};qb.prototype.commit=function(){return!0};qb.prototype.unb=function(){var c=this,k=this.p9.NameDataStrings;if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var D=new Th.a(-433697611,0,this.$.dd,8,null),ba={};ba=(ba.MenuItemId=k,ba);this.$.Ka.Ub(D,ba)}else{k+=jc.openParen;D=ze.g(this.$);D.view.visibleArea.contains(D.Eg(null))||D.kt(D.ga.wa.activeCell,3,di.a.pqh);var Ba=this.JGa.textBox;if(this.JGa.isEditing&&!af.a.ma(this.JGa.text)){ba=
this.JGa.text;var nb=this.JUc?ba.substring(0,this.JUc):"=";this.JGa.text=nb+k+ba.substring(this.JUc+(Ba.Du?Ba.Du.length:0),ba.length);Ba.caretPosition=nb.length+k.length}else Kf.TaskExtensions.Aa(D.startEdit(!0,1),function(){c.JGa.text="="+k;var Rb=k.length+1;Ba.WOa(Rb);Ba.caretPosition=Rb},this.la,11,sd.a.current);D.nj&&(D=D.Gc,D.text=Ba.text,D.setCaretPosition(Ba.caretPosition));(D=this.JGa.sO.get(Fj.a.Zsa))&&D.US(!1)}};qb.prototype.HEa=function(){this.formulaAssistanceControl.plb()};qb.prototype.ata=
function(c){this.nrb.clear();for(var k=qb.o7c+" "+qb.DMe,D=0,ba=c.length;D<ba;++D){var Ba=this.nrb.YK(c[D].NameUI,c[D].FunctionIndex.toString(),!1);Qh.a.pu&&Ba.classList.add("ewa-dlg-select-option-explorer-edge");Ba.setAttribute(xe.a.lD,qb.EMe);Ba.setAttribute(xe.a.bL,k)}this.nrb.selectedIndex=0};qb.prototype.onFunctionInfoLoaded=function(){if(!this.MHa.count){for(var c=this.functionInfoManager.CMe,k=0,D=c.length;k<D;++k)this.MHa.YK(c[k],c[k],!1).className=Ii.a.Pah;this.MHa.selectedIndex=0;Rf.a.mc([this.EYb,
this.E4,this.Qtb]);this.EYb=this.Hd.yd(this.NHa);this.E4=this.Hd.yd(this.Fha);this.Qtb=this.Hd.yd(this.mrb);this.EYb.ja("change",Object(xd.a)(this,this.knf,"onFunctionCategorySelectionChanged"));this.E4.ja("change",Object(xd.a)(this,this.usi,"onFunctionListSelectionChanged"));this.E4.ja("dblclick",Object(xd.a)(this,this.vsi,"onFunctionListSelectionDblClick"));this.Qtb.ja("click",Object(xd.a)(this,this.Raa,"onHelpLinkClick"));this.Qtb.ja("keyup",Object(xd.a)(this,this.sui,"onHelpLinkKeyUp"));Ne.DOMElementExtensions.setVisible(this.Fha,
!0);Ne.DOMElementExtensions.setVisible(this.HMe,!1);this.$.O_c&&Ne.DOMElementExtensions.setVisible(this.Mbf,!0)}this.knf(null);this.getButton(0).get_element().disabled=!1;this.NHa.disabled=!1;this.yGb();this.Wcd=!0};qb.prototype.Raa=function(){this.p9&&ic(this.$,this.p9.HelpId,this.p9.IsDynamicUdf)};qb.prototype.sui=function(c){13!==c.keyCode&&32!==c.keyCode||this.Raa(c)};qb.prototype.knf=function(){var c=this.functionInfoManager.QQe(this.MHa.je.value);this.ata(c);this.Fha.scrollTop=0;this.FNf()};
qb.prototype.FNf=function(){if(this.p9){this.mrb.parentNode.className=Ii.a.Tah+(this.functionInfoManager.Lhd(this.p9)?"-udf":"");var c=this.p9.NameDataStrings;this.LMe.innerText=c;this.mrb.innerText=c;this.Eha.innerText=this.p9.Help;c=this.p9.Params.split(jc.E4c);this.IMe.innerText=jc.openParen+(1<c.length?jc.l3b:c[0])+jc.closeParen}};qb.prototype.usi=function(){this.FNf()};qb.prototype.vsi=function(c){this.p9&&(mg.g(c),this.close(0))};qb.prototype.Vc=function(c,k){Uj.b(k)&&this.Yt()};qb.SF=function(){return String.format("<div class='"+
Ii.a.Oah+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Ai.a.hy+"'>{1}</div>\r\n<div class='"+Ii.a.LEe+"'>\r\n\t<select id='{16}' class='{17} "+ia.a.gu+" "+ia.a.lr+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Ii.a.Rah+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+ia.a.gu+"'>\r\n\t\t\t<span class='"+ia.a.sB+" "+Ii.a.Sah+"'>\r\n\t\t\t\t<img title='{3}' class='"+
ia.a.Lfh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",de.a.instance.da(983),de.a.instance.da(984),de.a.instance.da(708),de.a.instance.Bb(3),vh.a.ve(13),de.a.instance.da(985),qb.nqh,qb.o7c,7,"ewa-dlg-function-category-select","ewa-dlg-function-help-link","ewa-dlg-function-loading","ewa-dlg-function-help-string",
"ewa-dlg-udf-name","ewa-dlg-function-icon","ewa-dlg-function-link-container",qb.sqh,"ewa-dlg-select"+(Qh.a.pu?" ewa-dlg-select-explorer-edge":""),qb.DMe,qb.EMe)};Ll.Object.defineProperties(qb.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}},p9:{configurable:!0,enumerable:!0,get:function(){if(!this.Fha||!this.Fha.firstChild)return null;var c=Number.parseInvariant(this.Fha.children[this.Fha.selectedIndex].value);return this.functionInfoManager.FAh(c)}}});qb.o7c="function_dialog_param_string";
qb.DMe="function_dialog_function_description";qb.EMe="function_dialog_function_name";qb.sqh="function_list";qb.nqh="function_category";Object(qd.a)(qb,"FunctionDialog",Oa.a,[]);Ia.prototype.onFunctionInfoLoaded=function(){!af.a.ma(this.menuId)&&Array.contains(this.qqh,this.menuId)&&this.frame.Yv(this.menuId)};Ia.prototype.Wc=function(c,k){if(!ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(k){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return c=
ze.g(this.$).Yi,(k=c.sO.get(Fj.a.Zsa))&&(k.uub||!c.isEditing||0>=c.text.length)?!1:!0;default:return!1}};Ia.prototype.executeCommand=function(c,k,D){k=k.command;c=ze.g(this.$);switch(k){case 753860909:case -2060563418:ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")?(D=c.Yi,c.inRangePicker&&D.oD(!1),this.create(D)):c.tc(null)&&(D=c.Yi,(k=D.sO.get(Fj.a.Zsa))&&(k.uub||!D.isEditing||0>=D.text.length)&&(c.inRangePicker&&D.oD(!1),this.create(D)));break;case -433697611:var ba=
D[Dg.a.Md]+jc.openParen;D.UILocation&&this.$.De(-1075437823,-1,0,null);c.view.visibleArea.contains(c.Eg(null))||c.kt(c.ga.wa.activeCell,3,di.a.pph);var Ba=c.Yi,nb=Ba.textBox;D=Ba.textBox.caretPosition;if(Ba.isEditing&&!af.a.ma(Ba.text)){k=Ba.text;var Rb=D?k.substring(0,D):"=";Ba.text=Rb+ba+k.substring(D+(nb.Du?nb.Du.length:0),k.length);nb.caretPosition=Rb.length+ba.length}else Kf.TaskExtensions.Aa(c.startEdit(!0,1),function(){Ba.text="="+ba;var Ic=ba.length+1;nb.WOa(Ic);nb.caretPosition=Ic},this.$.la,
11,sd.a.current);c.nj&&(c=c.Gc,c.text=nb.text,c.setCaretPosition(nb.caretPosition));(c=Ba.sO.get(Fj.a.Zsa))&&c.US(!1)}return pg.Task.Ra(!0)};Ia.prototype.Ec=function(c,k){switch(k.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};Ia.prototype.krh=function(c,k){k=this.Sa.$o(k);var D=this.Sa.Oc(),ba=this.functionInfoManager.QQe(c);if(!ba)return ed.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),k.pB();for(var Ba=
0;Ba<ba.length;++Ba){var nb=ba[Ba].NameUI,Rb=this.Sa.OO(277,"Formulas."+c+"MenuItem_"+ba[Ba].FunctionIndex.toString(),-433697611,null,1,"None",0,0,nb,!1,0);Rb.label=nb;var Ic=ba[Ba].Params.split(jc.E4c);Rb.PQ(nb+" "+(jc.openParen+(1<Ic.length?jc.l3b:Ic[0])+jc.closeParen)+"\n"+ba[Ba].Help);Array.add(D.buttons,Rb)}c=this.Sa.Oc();ba=this.Sa.OO(277,"Formulas.MoreFunctionsMenuItem",-2060563418,ia.a.WHe,3,"Image16by16",982,0,"Formulas.MoreFunctionsMenuItem",!1,0);Array.add(c.buttons,ba);Array.add(k.Bc,
D);Array.add(k.Bc,c);return k.pB()};Ia.prototype.Yc=function(c,k,D){c=this.EAh(k);if(-1===c)return!1;this.menuId=D.MenuId;if(!this.functionInfoManager.O3)return this.functionInfoManager.Spb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;c=this.functionInfoManager.CMe[c];this.eL[c]=this.eL[c]||this.krh(c,D.MenuId);D.MenuItems=this.eL[c];return!0};Ia.prototype.create=function(c){(new qb(this.$,c)).mf()};Ia.prototype.EAh=function(c){switch(c){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;
case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(qd.a)(Ia,"FormulaAssistanceCommandHandler",null,[160]);var R=Ud.a;Em(Aa,R);Aa.prototype.Gd=function(){var c=this,k=Wg.GetServiceTaskFactory.create(this.$.ea,
102,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),D=Wg.GetServiceTaskFactory.create(this.$.ea,153,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([k,D],this.la),function(){c.Ad([new Ia(c.$,k.result,D.result)])},this.la,3)};Aa.ja=function(c){Ud.a.Yd(92,new Aa(c))};Object(qd.a)(Aa,"FormulaAssistanceCommandHandlerFactory",Ud.a,[]);Zb.prototype.dispose=function(){this.$Pd();
this.OHa=this.GHa=this.Bha=null};Zb.prototype.IRc=function(c){c&&(this.Bha=c,this.Bha.wfe(Object(xd.a)(this,this.Tqf,"onReadFormulaAssistanceFunctionName")),this.Bha.oge(Object(xd.a)(this,this.Vqf,"onReadFormulaAssistanceParameterOld")),this.R2a&&this.Bha.nge(Object(xd.a)(this,this.Uqf,"onReadFormulaAssistanceParameter")))};Zb.prototype.JRc=function(c){this.fKa&&c&&(this.GHa=c,this.GHa.ufe(Object(xd.a)(this,this.fnf,"onFormulaSuggestionsCardOpened")),this.GHa.tfe(Object(xd.a)(this,this.$mf,"onFocusSetOnFormulaSuggestionsCard")))};
Zb.prototype.wke=function(c){c&&(this.OHa=c,this.OHa.pge(Object(xd.a)(this,this.Wqf,"onReadListItemWithDescription")),this.OHa.EPc(Object(xd.a)(this,this.Pqf,"onReadAutoCompleteListBoxDescription")))};Zb.prototype.$Pd=function(){this.Bha&&(this.Bha.jFf(Object(xd.a)(this,this.Tqf,"onReadFormulaAssistanceFunctionName")),this.Bha.LFf(Object(xd.a)(this,this.Vqf,"onReadFormulaAssistanceParameterOld")),this.R2a&&this.Bha.KFf(Object(xd.a)(this,this.Uqf,"onReadFormulaAssistanceParameter")));this.OHa&&(this.OHa.MFf(Object(xd.a)(this,
this.Wqf,"onReadListItemWithDescription")),this.OHa.oCd(Object(xd.a)(this,this.Pqf,"onReadAutoCompleteListBoxDescription")));this.fKa&&this.GHa&&(this.GHa.iFf(Object(xd.a)(this,this.fnf,"onFormulaSuggestionsCardOpened")),this.GHa.hFf(Object(xd.a)(this,this.$mf,"onFocusSetOnFormulaSuggestionsCard")))};Zb.prototype.Tqf=function(c,k){this.MNi(k.functionName,k.t7c)};Zb.prototype.Vqf=function(c,k){this.LNi(k.t7c,k.hGd,k.QDi)};Zb.prototype.Uqf=function(c,k){c=[];k=Ol(k.hGd);for(var D=k.next();!D.done;D=
k.next())if(D=D.value,!this.R2a||void 0!==D&&null!==D)D=D.trim(),af.a.ma(D)||Array.add(c,D);if(!this.R2a||c.length){k="";for(D=0;D<c.length;D++){var ba=this.iTc(c[D]),Ba=Zb.Wwd(D,c.length);k+=ba+Ba;af.a.ma(Ba)||(k+=this.ariaLiveNotifier.Kva)}this.ariaLiveNotifier.readText(k)}};Zb.prototype.Wqf=function(c,k){this.ariaLiveNotifier.ONi(k.xH,k.description,k.selectedIndex.toString(),k.length.toString())};Zb.prototype.Pqf=function(c,k){this.ariaLiveNotifier.ABf(k.description,k.length)};Zb.prototype.fnf=
function(){this.ariaLiveNotifier.kDb(de.a.instance.da(844),xe.a.DWa)};Zb.prototype.$mf=function(){this.ariaLiveNotifier.readText(de.a.instance.da(845))};Zb.prototype.MNi=function(c,k){if(k){var D="";this.R2a||(D+=de.a.instance.Bb(56)+this.ariaLiveNotifier.Kva);for(var ba=0;ba<k.length;ba++)D+=c+this.ariaLiveNotifier.Kva+this.iTc(k[ba])+Zb.Wwd(ba,k.length);this.R2a&&(D+=de.a.instance.da(843)+this.ariaLiveNotifier.Kva);this.ariaLiveNotifier.readText(D)}};Zb.prototype.LNi=function(c,k,D){if(c){var ba=
"",Ba=0;if(k){for(var nb=0;nb<k.length;nb++)if(D>=c[nb].split(this.$.listSeparator).length)Ba++;else{var Rb=k[nb].trim();if(af.a.ma(Rb))return;Rb=this.iTc(Rb);var Ic=Zb.Wwd(nb-Ba,k.length-Ba);ba+=Rb+Ic;af.a.ma(Ic)||(ba+=this.ariaLiveNotifier.Kva)}this.ariaLiveNotifier.readText(ba)}}};Zb.prototype.iTc=function(c){if(af.a.ma(c))return"";var k=c.split(this.$.listSeparator);c="";k=Ol(k);for(var D=k.next();!D.done;D=k.next()){var ba=D.value;Zb.jhd(ba)?c+=ba:(ba=(D=Zb.j4h(ba))?ba.replace("[","").replace("]",
""):ba,c+=String.format(D?de.a.instance.Bb(58):de.a.instance.Bb(57),ba));c+=this.ariaLiveNotifier.Kva}return c};Zb.Wwd=function(c,k){if(c>=k||1===k)return ed.ULS.shipAssertTag(537161997,0,c<k,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""};Zb.jhd=function(c){return af.a.contains(c,jc.l3b,!0)};Zb.j4h=function(c){return c.trimStart().startsWith(jc.Muf)||c.trimEnd().endsWith(jc.Luf)};Object(qd.a)(Zb,"FormulaAssistanceReadoutHandler",null,[797,6]);var va=oe.a;Em(cc,
va);cc.prototype.create=function(){var c=this,k=this.$.ea;Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.Va(k,211,212,this.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),function(D){D=k.Ba(219)||new Zb(D.result,c.$);c.Eb(D)},this.la,3)};cc.ja=function(c){c.ea.Ia(220,new cc(c))};Object(qd.a)(cc,"FormulaAssistanceReadoutHandlerFactory",oe.a,[]);var jb=b(676),Xb=b(110),Jc=b(1116);tc.prototype.Pad=function(c){return this.lOa&&c in this.lOa?this.lOa[c]:null};tc.prototype.lWf=function(c,
k){this.lOa||(this.lOa={});this.lOa[c]=k};tc.prototype.FY=function(){this.lOa=null};Object(qd.a)(tc,"FormulaAssistanceContextualPreviewCache",null,[]);lc.prototype.dispose=function(){this.Bd||(this.$&&(this.$.fa.yC(Object(xd.a)(this,this.mx,"onStateIdChanged")),this.$=null),this.$fa=this.bCb=null,this.Bd=!0)};lc.prototype.K8c=function(c,k,D,ba){var Ba=this;if(k&&0>=k.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!c)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");
this.calcManager=this.$.ea.Ba(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");var nb="="+k.substring(D.start,D.end);ae.EwaSettings.ka(629)&&(nb=this.calcManager.UIh(ze.g(this.$).ga.wa.activeCell,c,D));var Rb=this.Swh(nb,D);if(ae.EwaSettings.ka(629)){if(Rb&&!this.calcManager.isFormulaSubExpressionVolatile(c))return Promise.resolve(Rb)}else if(Rb)return Promise.resolve(Rb);return this.Uwh(nb,D).then(function(Ic){if(Ba.uVc(ba))throw Error.create("OperationCanceledException");
if(!Ic||Ic.k_i||Ic.jla.startsWith("##UNSUPPORTED:"))return Ba.oPe(k,nb,D,ba);Ba.$fa.lWf(nb,Ic.jla);return Promise.resolve(Ic)})};lc.prototype.Swh=function(c,k){return(c=this.$fa.Pad(c))?new Jc.a(c,k.start,k.end,0):null};lc.prototype.Uwh=function(c,k){if(!c||0>=c.length||!k)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.zGg(ze.g(this.$).ga.wa.activeCell,c,this.Pgi,k)};lc.prototype.oPe=function(c,
k,D,ba){var Ba=this;if(!c||0>=c.length||!k||0>=k.length||!D)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.IMa)return this.Twh(c,k,D,ba);var nb={};nb.PartialFormula=k;nb.Formula=c;nb.SourceRange=cf.v(ze.g(this.$).ga.wa.activeCell,this.$);return this.IMa=new Promise(function(Rb,Ic){Ba.bCb=new jb.a;Ba.JHf=Ba.$.fa.vf;Ba.z7a=Ec(Ba.$.ra.ua,nb,function(Wc){Ba.HBi(k,D,ba,Wc,Rb,Ic)},function(Wc){Ba.IMa=null;Ba.z7a=null;
Ic(Wc)},null,null,null);Ba.bCb.token.R(function(){Ba.cIg(Ic)})})};lc.prototype.HBi=function(c,k,D,ba,Ba,nb){this.z7a=this.IMa=null;if(this.JHf!==this.$.fa.vf)nb(Error.create("OperationCanceledException"));else if(ba.Result)if(ba=Sf.a.Xh(ba.Result),!ba||Xb.a.isEmpty(ba))Ba(null);else{for(var Rb in ba)this.$fa.lWf(Rb,ba[Rb]);this.uVc(D)?nb(Error.create("OperationCanceledException")):(c=this.$fa.Pad(c))?(""===c&&(c=" "),Ba(new Jc.a(c,k.start,k.end,0))):nb(Error.create("SubexpressionNotFoundException"))}else Ba(null)};
lc.prototype.Twh=function(c,k,D,ba){var Ba=this;return new Promise(function(nb,Rb){Ba.IMa.then(function(){Ba.tIf(c,k,D,ba,nb,Rb)}).catch(function(){Ba.tIf(c,k,D,ba,nb,Rb)})})};lc.prototype.tIf=function(c,k,D,ba,Ba,nb){if(this.uVc(ba))nb(Error.create("OperationCanceledException"));else{var Rb=this.$fa.Pad(k);Rb?Ba(new Jc.a(Rb,D.start,D.end,0)):this.oPe(c,k,D,ba).then(function(Ic){Ba(Ic)}).catch(function(Ic){nb(Ic)})}};lc.prototype.cIg=function(c){this.z7a&&(fi.a.Ku(this.z7a.Tt)?(this.IMa=this.z7a=
null,c(Error.create("PendingWebReqeuestCancelled"))):ed.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};lc.prototype.FY=function(){this.dIg();this.$fa&&this.$fa.FY()};lc.prototype.dIg=function(){this.bCb&&this.bCb.C()};lc.prototype.uVc=function(c){return this.Bd||c.tJ};lc.prototype.mx=function(){this.$fa.FY()};Object(qd.a)(lc,"FormulaAssistanceContextualPreviewCalculator",null,[6]);var Xc=b(139),Dc=b(205);P.ybh="ewa-facp-text-box";Object(qd.a)(P,"CssClassNames",null,
[]);uc.prototype.dispose=function(){(this.j9||this.MO)&&this.YZe();this.pb=this.yoa=null};uc.prototype.zwj=function(c,k,D,ba){c&&k&&ba&&k.jla&&!(1>k.jla.length)&&(this.pb=c,this.oEf(),this.g_a=k,this.oQa=ba,this.Qfj(k,D,ba))};uc.prototype.YZe=function(){this.mRh();this.oEf();this.oQa=this.g_a=null};uc.prototype.Qfj=function(c,k,D){var ba=this;if(c.jla&&!(1>c.jla.length)){var Ba=this.Kc.ea.Ba(266);if(Ba){var nb=Ba.GCh();nb&&Kf.TaskExtensions.Aa(this.Wxb,function(){if(k)if(ae.EwaSettings.ka(629)&&ba.pb.isEditing&&
0<D.length){ba.$tb(c.KHa,D[0].start,null);var Rb=ba.bVe(D[0],nb),Ic=ba.pb.text.substring(D[0].start,D[0].end).trim();Ic=ba.pb.text.indexOf(Ic);Ic=ba.pb.text.substring(0,Ic).lastIndexOf("\n");ba.$tb(0>Ic||1>=D.length?D[0].start:Ic+1,D[0].end,Rb?String.format(Rb,.3):null);for(var Wc=1;Wc<D.length;Wc++)Rb=ba.bVe(D[Wc],nb),Ic=ba.pb.text.substring(D[Wc].start,D[Wc].end).trim(),Ic=ba.pb.text.indexOf(Ic),Ic=ba.pb.text.substring(D[Wc-1].end,Ic).lastIndexOf("\n"),ba.$tb(0>Ic?D[Wc-1].end:Ic+1+D[Wc-1].end,D[Wc].end,
Rb?String.format(Rb,.3):null);Ic=ba.pb.text.substring(D[D.length-1].end,c.Wsa).indexOf("\n");ba.$tb(0>Ic?D[D.length-1].end:Ic+1+D[D.length-1].end,c.Wsa,null);ed.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else ba.$tb(c.KHa,c.Wsa,null),ed.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");
ba.j9||(ba.j9=document.createElement(Dc.a.div),ba.pb.textBox.domElement.appendChild(ba.j9));ba.MO||(ba.MO=document.createElement(Dc.a.div),ba.MO.className=P.ybh,ba.Kc.domElement.appendChild(ba.MO));Rb=c.Wsa;ae.EwaSettings.ka(629)&&ba.pb.isEditing&&D&&0<D.length&&D[0].start<Rb&&D[0].start!==c.KHa&&!ba.pb.textBox.Du.length&&(Rb=D[0].start);Wc=af.a.contains(ba.pb.textBox.ef.id,"FormulaBar",!0)&&af.a.contains(ba.pb.text.substring(c.KHa,c.Wsa),"\n",!0);Ic=ba.pb.isEditing?ba.pb.textBox.caretPosition:0;
Rb=excelOnline.utils.getBoundingRectForText(ba.pb.textBox.ef,Wc?Ic:c.KHa,Wc?Ic:Rb,ae.EwaSettings.ka(629));ba.MO.style.left=Gb.HelperMethods.Pb(Rb.left);ba.MO.style.top=Gb.HelperMethods.Pb(Rb.top);ba.MO.style.width=Gb.HelperMethods.Pb(Rb.width);ba.MO.style.height=Gb.HelperMethods.Pb(Rb.height);Rb=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",c.Wsa,c.Wsa);dialogControls.renderToolTip(ba.j9,Rb,c.jla,ba.MO,0,!1,!1,1)},this.Kc.la,3)}}};uc.prototype.bVe=function(c,k){var D=this.pb.text,ba=D.substring(c.start,
c.end);ba=ba.trim();c=D.indexOf(ba,c.start);k=D.indexOf(k,c);ba=D.substring(c,k);ba=ba.trim();return this.pb.colors.getItem(c+"-"+(c+ba.length))};uc.prototype.mRh=function(){var c=this;this.pb&&this.j9&&this.MO&&Kf.TaskExtensions.Aa(this.Wxb,function(){c.pb.textBox.domElement.contains(c.j9)&&(dialogControls.clearToolTip(c.j9),c.pb.textBox.domElement.removeChild(c.j9),c.j9=null);c.Kc.domElement.contains(c.MO)&&(c.Kc.domElement.removeChild(c.MO),c.MO=null)},this.Kc.la,3)};uc.prototype.$tb=function(c,
k,D){if(this.pb&&!(c>=k)){var ba={};this.pb.textBox.formatText(c,k-c,(ba.background=D||"#E3DDCC",ba));this.Mcd=!0}};uc.prototype.oEf=function(){if(this.pb&&this.g_a&&this.Mcd){var c=this.g_a.Wsa;ae.EwaSettings.ka(629)&&0<this.oQa.length&&this.oQa[this.oQa.length-1].end>c&&(c=this.oQa[this.oQa.length-1].end);var k={};this.pb.textBox.formatText(this.g_a.KHa,c-this.g_a.KHa,(k.background=!1,k));this.Mcd=!1}};Ll.Object.defineProperties(uc.prototype,{Wxb:{configurable:!0,enumerable:!0,get:function(){var c=
this;if(this.yoa)return this.yoa;var k=new Xc.a;this.Kc.RD(function(D){Kf.TaskExtensions.Aa(D.Xmd(),function(){k.setResult(!0)},c.Kc.la,3)});return this.yoa=k.task}}});Object(qd.a)(uc,"FormulaAssistanceContextualPreviewControl",null,[6]);var Cc=b(43),cd=b(42);zb.prototype.RSf=function(c,k,D){D?this.vTg(c,k,D):this.nXe(c,k,D,!0)};zb.prototype.aZi=function(){this.q6=0};zb.prototype.vTg=function(c,k,D){var ba=this;this.q6++;var Ba=this.q6;Cc.a.instance.create(function(){ba.nXe(c,k,D,Ba===ba.q6)},500,
cd.a.qph,!0,!0)};zb.prototype.nXe=function(c,k,D,ba){var Ba=this,nb=this.W6c.K8c(c,k);nb&&nb.then(function(Rb){ba&&Ba.W6c.Vhd(k)&&Ba.W6c.ywj(c,Rb,D)}).catch(function(Rb){Rb=Object(Og.a)(Error,Rb);"OperationCanceledException"===Rb.message?ed.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",Rb):ed.ULS.sendTraceTag(537162058,0,10,"GetContextualFormulaPreviewResults - caught exception: {0}",Rb)})};Object(qd.a)(zb,"FormulaAssistanceContextualPreviewHoverManager",
null,[]);oc.prototype.dispose=function(){this.qUc();Rf.a.mc([this.erb,this.a6b]);this.b6b=this.a6b=this.erb=null;this.$&&ze.g(this.$).Gc.Fr(Object(xd.a)(this,this.s6a,"onEditCellEnded"));this.Yfa=this.pb=this.$=null};oc.prototype.Rfj=function(c,k){k&&fj.e(k.text)&&!k.Kua&&af.a.ma(k.textBox.Du)&&(!this.pb||af.a.ma(this.pb.textBox.Du))&&(this.pb=k,this.calcManager=this.$.ea.Ba(266))&&(ed.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),
c=Gb.HelperMethods.Lrb(c),c=this.calcManager.RIh(ze.g(this.$).ga.wa.activeCell,this.pb.text,c.x,c.y),k=this.calcManager.getSubExpressionSpan(c),!k||k.end<=k.start||this.Vhd(k)||(this.Yfa=k,this.b6b.RSf(c,k,!0)))};oc.prototype.yKd=function(c){if(c&&fj.e(c.text))if(af.a.ma(c.textBox.Du)||af.a.ma(c.textBox.Du.trim()))this.d2a(!1,!0);else if(this.pb=c,this.calcManager=this.$.ea.Ba(266)){ed.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");
c={};var k=this.pb.textBox.Du.trim();c.start=this.pb.text.indexOf(k,this.pb.textBox.caretPosition);c.end=c.start+k.length;(k=this.calcManager.getFormulaSubExpressionObject(ze.g(this.$).ga.wa.activeCell,this.pb.text,this.pb.textBox.Du))&&!this.Vhd(c)&&(this.Yfa=c,this.b6b.RSf(k,c,!1))}};oc.prototype.d2a=function(c,k){!this.pb||k&&!af.a.ma(this.pb.textBox.Du)||(this.Yfa=null,c&&(this.qUc(),this.a6b.FY(),this.b6b.aZi()),this.erb&&this.erb.YZe(),this.pb.Kua||(this.pb.Kua=!1,this.pb=null))};oc.prototype.K8c=
function(c,k){if(!this.pb||this.pb.Kua)return null;this.qUc();this.uob=new jb.a;return this.a6b.K8c(c,this.pb.text,k,this.uob.token)};oc.prototype.ywj=function(c,k,D){this.uob=null;!c||!k||!k.jla||0>=k.jla.length?this.d2a(!1,!1):(c=this.calcManager.SIh(ze.g(this.$).ga.wa.activeCell,c,this.pb.text),this.erb.zwj(this.pb,k,D,c))};oc.prototype.Vhd=function(c){return this.Yfa?c.start===this.Yfa.start&&c.end===this.Yfa.end&&c.pre===this.Yfa.pre&&c.post===this.Yfa.post:!1};oc.prototype.qUc=function(){this.uob&&
this.uob.C()};oc.prototype.s6a=function(){this.d2a(!1,!1)};Object(qd.a)(oc,"FormulaAssistanceContextualPreviewManager",null,[767,6,768]);var Gd=b(1173),zd=b(913),pe=b(245),kf=b(153);Yb.prototype.nOf=function(c){this.ER=0;this.f1d=c.IsCompatibility;this.set_name(c.NameDataStrings);this.pTa=c.Help};Yb.prototype.G7i=function(c){this.ER=1;this.set_name(c.Name)};Yb.prototype.f7i=function(c){this.ER=2;this.set_name(c.name);this.pTa=c.tooltip};Yb.prototype.E8i=function(c){this.ER=3;this.set_name(c.name);
this.pTa=c.toolTip};Yb.prototype.JPf=function(c){this.ER=4;this.set_name(c.name)};Yb.prototype.U$i=function(c){this.ER=5;this.set_name(c.name);this.pTa=c.toolTip};Yb.prototype.T$i=function(c){this.ER=7;this.set_name(c.name)};Yb.prototype.s9i=function(){this.ER=6;this.set_name(de.a.instance.Bb(181));this.pTa=de.a.instance.Bb(182)};Yb.prototype.set_name=function(c){return this.x2d=c};Yb.TXg=function(){return Object.assign(new Yb,{f2d:!0})};Ll.Object.defineProperties(Yb.prototype,{itemType:{configurable:!0,
enumerable:!0,get:function(){return this.ER}},o0h:{configurable:!0,enumerable:!0,get:function(){return this.f1d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.x2d}},Eha:{configurable:!0,enumerable:!0,get:function(){return this.pTa}},Bwb:{configurable:!0,enumerable:!0,get:function(){return this.f2d}}});Object(qd.a)(Yb,"AutoCompleteItem",null,[728]);Object(qd.a)(Ra,"DefinedNameInfo",null,[]);Wa.prototype.etj=function(c){var k=
this.Aye[c.toUpperCase()];if(!k)return{returnValue:!1,sheetName:"",range:null};c=k.sheetName;k=this.tQg(k.namedRange);return{returnValue:!0,sheetName:c,range:k}};Wa.prototype.KQg=function(c){if(null!=c&&void 0!=c)return{top:c.top,left:c.left,bottom:c.bottom,right:c.right,maxRows:c.maxRows,maxColumns:c.maxColumns,sheetName:void 0}};Wa.prototype.tQg=function(c){if(null!=c&&void 0!=c)return new Aj.a(c.top,c.left,c.bottom,c.right,c.maxRows,c.maxColumns)};Wa.prototype.DQg=function(c){switch(c){case 2:return 0;
case 3:return 1;default:return-1}};Ll.Object.defineProperties(Wa.prototype,{A0g:{configurable:!0,enumerable:!0,get:function(){var c=[];if(!this.$.wb||!this.$.wb.items)return c;for(var k=0,D=Ol(this.$.wb.items),ba=D.next();!ba.done;ba=D.next())if((ba=ba.value)&&3===ba.type&&ba.usedRange){var Ba=new Ra;Ba.tooltip=ba.sheetName+Xf.a.exclamation+ba.usedRange.toString();Ba.name=ba.name;Ba.namedRange=this.KQg(ba.usedRange);Ba.sheetName=ba.sheetName;Ba.type=this.DQg(ba.type);Array.add(c,Ba);this.Aye[ba.name.toUpperCase()]=
Ba;++k;if(k===jc.wff){ed.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",jc.wff);break}}return c}}});Object(qd.a)(Wa,"DefinedNameInfoManager",null,[]);var tf=b(135),Df=Sys.EventArgs;Em(lb,Df);Object(qd.a)(lb,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Cg=Sys.EventArgs;Em(ha,Cg);Object(qd.a)(ha,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var mh=Sys.EventArgs;Em(Tb,mh);Object(qd.a)(Tb,"FormulaAssitanceSelectedParameterChangedEventArgs",
Sys.EventArgs,[]);var ji=b(257);kb.prototype.Le=function(c,k){c=!1;k||(ze.g(this.$).Yi.textBox.pJ=!0,c=this.formulaAssistanceUIControl.focus(this.oMe));return c};kb.prototype.rh=function(c){var k=this.Ib;return!(void 0===k||null===k)&&Ne.DOMElementExtensions.Ue(k,c)};kb.prototype.Uh=function(){this.HXe&&this.HXe()};kb.prototype.Nh=function(){};kb.prototype.dispose=function(){ji.a(this.$).sA(this)};Ll.Object.defineProperties(kb.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.bUc},
set:function(c){this.bUc!==c&&(c?ji.a(this.$).Og(this):ji.a(this.$).sA(this),this.bUc=c)}},Vd:{configurable:!0,enumerable:!0,get:function(){return this.o3i}},Ib:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.oMe)}}});Object(qd.a)(kb,"FormulaAssistanceFocusManager",null,[120,6]);var ki=b(1031),bi=eg.a;Em(Na,bi);Na.prototype.skb=function(c){this.addHandler("FunctionInfoLoaded",c)};Na.prototype.bnc=function(c){this.removeHandler("FunctionInfoLoaded",
c)};Na.prototype.tsg=function(c){this.addHandler("FunctionInfoReset",c)};Na.prototype.iUi=function(c){this.removeHandler("FunctionInfoReset",c)};Na.prototype.dispose=function(){var c=this.$.ea.Ba(268);c&&c.hCd(Object(xd.a)(this,this.jnf,"onFullFunctionListLoaded"));this.ub=null;bi.prototype.dispose.call(this)};Na.prototype.$Hf=function(){this.raiseEvent("FunctionInfoReset")};Na.prototype.HDd=function(){this.$Hf();this.nFc=!1;this.BR=null;this.lFc=!0};Na.prototype.Spb=function(c,k){var D=this;k=void 0===
k?!1:k;if(this.O3)this.iAf();else{ed.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var ba=null;(ba=this.$.ea.Ba(268))||ed.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if(ba&&ba.Gha&&0<ba.Gha.length)ae.EwaSettings.ka(121)?ba.Soh(Object(xd.a)(this,this.wnf,"onGetFunctionListFullSucceeded")):this.sAd(ba.Gha,!0,!1);else{var Ba=this.$.ra.ua.Wb();c&&(this.$.fa.lc||k)&&!this.c2h&&(k?
uh.a(this.$.userOperationManager,function(nb,Rb,Ic){return hg.w(D.$.ra.ua,c,wd.b(nb,Object(xd.a)(D,D.ynf,"onGetFunctionListPartialSucceeded")),wd.a(Rb,Object(xd.a)(D,D.xnf,"onGetFunctionListPartialFailed")),Ic,c,Ba)},function(nb){return new te.a(130,0,nb,16)},null):hg.w(this.$.ra.ua,c,Object(xd.a)(this,this.ynf,"onGetFunctionListPartialSucceeded"),Object(xd.a)(this,this.xnf,"onGetFunctionListPartialFailed"),null,c,Ba));!this.O3&&this.$.fa.lc&&(ba?(ed.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.O3,this.$.fa.lc),ba.vfe(Object(xd.a)(this,this.jnf,"onFullFunctionListLoaded"))):(ed.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),hg.w(this.$.ra.ua,{FilterType:0},Object(xd.a)(this,this.wnf,"onGetFunctionListFullSucceeded"),null,null,null,Ba),this.lFc=!1))}}};Na.prototype.FAh=function(c){return 0>c||c>=this.BR.length?null:this.BR[c]};Na.prototype.L9c=function(c){return rg.a.zc(this.w7c,c.toUpperCase())};Na.prototype.QQe=
function(c){return rg.a.zc(this.PHa,c)};Na.prototype.Lhd=function(c){return!c.GroupUI};Na.prototype.ynf=function(c,k){ed.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.mnf(c,!!k&&1!==k.FilterType,!0)};Na.prototype.xnf=function(){ed.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.BR=null};Na.prototype.jnf=function(c){ed.ULS.sendTraceTag(537161985,
0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.sAd(c.Gha,!0,!1)};Na.prototype.wnf=function(c){ed.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.mnf(c,!0,!1)};Na.prototype.mnf=function(c,k,D){var ba=Hh.a(c);ed.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",ba);ba?(ze.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.fa.Jo(c.Errors)):
(this.sAd(c.Result,k,D),Xg.a.aja()&&!Xg.a.RY(this.$)&&this.Myj())};Na.prototype.sAd=function(c,k,D){ed.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",c.length,k,D,this.O3);this.O3||(this.BR=c,this.lDg(k),this.nFc=!D,this.iAf())};Na.prototype.iAf=function(){this.raiseEvent("FunctionInfoLoaded")};Na.prototype.Myj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.r7c)};Na.prototype.lDg=
function(c){function k(df,Wf){return df.NameUI.localeCompare(Wf.NameUI)}var D=de.a.instance.da(979),ba=[];this.PHa={};this.p7=[];this.PHa[D]=ba;var Ba=de.a.instance.da(980),nb=[];Array.add(this.p7,D);Array.add(this.p7,Ba);D=0;for(var Rb=this.BR.length;D<Rb;D++){var Ic=this.BR[D];Ic.IsCompatibility||Array.add(nb,Ic);var Wc=Ic.NameUI,Rd=Ic.NameDataStrings;this.w7c[Rd.toUpperCase()]||(this.w7c[Rd.toUpperCase()]=Ic);this.NMe[Wc.toUpperCase()]||(this.NMe[Wc.toUpperCase()]=Ic);if(!this.Lhd(Ic)){if(c){Wc=
Ic.GroupUI;var Ge=rg.a.zc(this.PHa,Wc);Ge||(Ge=[],this.PHa[Wc]=Ge,Array.add(this.p7,Wc));Array.add(Ge,Ic)}Ic.IsCommonlyUsed&&Array.add(ba,Ic);Ic.IsCompatibility||Array.add(this.Pcg,Rd)}}this.PHa[Ba]=nb;c&&(Na.GDf(ba,[2,3,0,5,4,9,1,7,8,6]),ba=Array(14),ba[0]=0,ba[1]=1,ba[2]=7,ba[3]=11,ba[4]=5,ba[5]=2,ba[6]=6,ba[7]=10,ba[8]=9,ba[9]=3,ba[10]=4,ba[11]=13,ba[12]=12,ba[13]=8,Na.GDf(this.p7,ba),ba=[],Array.addRange(ba,this.p7),Array.removeAt(ba,13),this.p7=ba);this.BR=Array.clone(this.BR);this.BR.sort(function(df,
Wf){return df.NameDataStrings.localeCompare(Wf.NameDataStrings)});ba=1;for(Ba=this.p7.length;ba<Ba&&c;ba++)this.PHa[this.p7[ba]].sort(k);c=0;for(ba=this.BR.length;c<ba;c++)this.BR[c].FunctionIndex=c};Na.GDf=function(c,k){for(var D=Array.clone(c),ba=0;ba<D.length&&ba<k.length;ba++)c[ba]=D[k[ba]]};Ll.Object.defineProperties(Na.prototype,{O3:{configurable:!0,enumerable:!0,get:function(){return this.nFc}},c2h:{configurable:!0,enumerable:!0,get:function(){return this.lFc}},r7c:{configurable:!0,enumerable:!0,
get:function(){var c=this.BR,k=ki.a(this.$);if(!k)return c;k=k.Vzh();var D=k.length;if(0>=D)return c;var ba=[];Array.addRange(ba,c);for(c=0;c<D;c++){var Ba=k[c],nb={};nb.FunctionIndex=ba.length;nb.HelpId=nb.GroupUI=null;nb.Help=Ba.description;nb.IsCommonlyUsed=nb.IsCompatibility=!1;nb.NameDataStrings=Ba.name;nb.NameUI=Ba.name;nb.Params=null;nb.ParamsHelp=null;Array.add(ba,nb)}return ba}},CMe:{configurable:!0,enumerable:!0,get:function(){return this.p7}},$:{configurable:!0,enumerable:!0,get:function(){return this.ub}}});
Object(qd.a)(Na,"FunctionInfoManager",eg.a,[685,686,6]);var ai=b(1113),Dh=ai.a;Em(db,Dh);db.prototype.setVisible=function(c){Ne.DOMElementExtensions.setVisible(this.domElement,c);c||(this.domElement.style.top="auto",this.domElement.style.left="auto")};db.prototype.isRtl=function(){return this.Vi};db.prototype.gTe=function(){return this.domElement.parentNode};db.prototype.nPa=function(c){var k=this.domElement.style;k.cursor="move";k.position=c?"relative":"absolute"};Object(qd.a)(db,"FunctionParamBoxDraggableItem",
ai.a,[]);Object(qd.a)(eb,"FormulaArgumentAssistanceCallbacks",null,[]);Object(qd.a)(Fa,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(qd.a)(Ga,"ArgumentAssistanceRequest",null,[]);var fh=Oh.a;Em(Ha,fh);Ha.prototype.wfe=function(c){this.addHandler("FAFunctionNameUpdated",c)};Ha.prototype.jFf=function(c){this.removeHandler("FAFunctionNameUpdated",c)};Ha.prototype.oge=function(c){this.addHandler("FAParameterSelectionChangedOld",c)};Ha.prototype.LFf=function(c){this.removeHandler("FAParameterSelectionChangedOld",
c)};Ha.prototype.nge=function(c){this.addHandler("FAParameterSelectionChanged",c)};Ha.prototype.KFf=function(c){this.removeHandler("FAParameterSelectionChanged",c)};Ha.prototype.set_visible=function(c){this.en?c||this.cpb():Sys.UI.Control.prototype.set_visible.call(this,c);return c};Ha.prototype.cpb=function(){this.formulaAssistanceUIControl&&(this.Hr=null,this.formulaAssistanceUIControl.dismiss(this.domElement),this.yja=null,this.Aq.canReceiveFocus=!1)};Ha.prototype.show=function(c){this.en||(Jb.instance.WE("argumentAssistanceRender"),
this.IZa.setVisible(!!c),Jb.instance.Pz("argumentAssistanceRender"),this.jRc&&(this.jRc=!1,this.UCe()))};Ha.prototype.sYi=function(){var c=this;if(!this.O$||this.CPa){Jb.instance.WE("argumentAssistanceComputation");Jb.instance.WE("argumentAssistanceOverall");var k=ze.g(this.$).Yi;this.pluginScheduler.requester().argumentAssistance(Object.assign(new Ga,{content:k.text,caretPosition:k.textBox.caretPosition})).then(function(D){D.kind?Jb.instance.Pz("argumentAssistanceComputation",!1):D.payload?(Jb.instance.Pz("argumentAssistanceComputation"),
c.wfj(c.pxd(D.payload),k.textBox.domElement)):c.cpb();return null})}};Ha.prototype.update=function(c,k,D,ba){if(!this.en&&c){Jb.instance.WE("argumentAssistanceComputation");Jb.instance.WE("argumentAssistanceOverall");this.jRc=!0;var Ba=this.$.listSeparator;try{var nb=$get(jc.u7c,this.Gi),Rb=$get(jc.n7c,this.Gi);nb.innerText="";Rb.innerText="";var Ic=$get(jc.JMe,this.Gi),Wc=c.Params.split(jc.E4c);nb=[];Rb=0;for(var Rd=Ic.rows.length;Rb<Rd;Rb++){var Ge=Ic.rows[Rb];Ne.DOMElementExtensions.setVisible(Ge,
Rb<Wc.length);var df=Wc[Rb],Wf=jc.PDi+Rb+"_",Pg=c.NameDataStrings;$get(Wf+jc.PBb,Ge).innerText=Pg;$get(Wf+jc.Rvd,Ge).innerText=Pg;if(!af.a.ma(df)){var Bg=Wc[Rb].split(Ba),qh=Ha.jhd(Bg[Bg.length-1]),dj=Ha.m4h(c);qh&&(dj&&(2<Bg.length?(Bg[Bg.length-2]+="1",Bg[Bg.length-3]+="1"):ed.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Pg,Bg.length.toString(),k)),Ha.uxg(Bg,dj,k,c));df=
Bg.join(Ba.toString()+" ");Wc[Rb]=df;D<Bg.length?(nb[Rb]=Bg[D],ed.ULS.shipAssertTag(537162072,0,!!Bg[D]&&1<=Bg[D].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",D,Bg.length,Pg,Rb),Bg[D]=String.format("{0}{1}{2}","<b>",Bg[D],"</b>"),df=Bg.join(Ba.toString()+" ")):ed.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+D+"currRowParamsArray.Length = "+
Bg.length+", current row = "+Rb);ba&&ed.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Pg,Bg.length,qh,dj,k)}$get(Wf+jc.Svd,Ge).innerHTML="("+(df||"")+")"}ba?this.raiseEvent("FAFunctionNameUpdated",new lb(c.NameDataStrings,Wc)):this.raiseEvent("FAParameterSelectionChangedOld",new Tb(Wc,nb,D));Ic.className=zd.a.gch+(this.functionInfoManager.Lhd(c)?"-udf":"")}catch(vi){throw ed.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",
c.NameDataStrings,k,vi),vi;}Jb.instance.Pz("argumentAssistanceComputation")}};Ha.prototype.dispose=function(){this.en||(this.rc.GB(),Rf.a.Fa(this.rc),ze.g(this.$).view.Gr(Object(xd.a)(this,this.fq,"onGridScroll")),Rf.a.Fa(this.IZa),this.IZa=null);this.en&&Rf.a.Fa(this.Aq);this.O$&&ze.g(this.$).uc.Fr(Object(xd.a)(this,this.pj,"onEditEnded"));this.functionInfoManager=this.$=null;fh.prototype.dispose.call(this)};Ha.prototype.pxd=function(c){var k=new Fa;k.functionRenderingInfo=c;k.cardMode=this.vS;this.ZAd(k);
return k};Ha.prototype.ZAd=function(c){c.callbacks=new eb;c.callbacks.onHelpLink=this.S9c(c.functionRenderingInfo);c.callbacks.onCardModeChange=Object(xd.a)(this,this.onCardModeChange,"onCardModeChange");c.callbacks.onFeedback=Object(xd.a)(this,this.NOa,"sendCardFeedback");this.O$&&(c.callbacks.onDismissClick=Object(xd.a)(this,this.onDismissClick,"onDismissClick"))};Ha.prototype.wfj=function(c,k){var D=this;if(this.formulaAssistanceUIControl){Jb.instance.WE("argumentAssistanceRender");var ba={};ba.zoomLevel=
wb(this.$);this.formulaAssistanceUIControl.updateContext(ba);this.Hr=function(){D.formulaAssistanceUIControl.renderArgumentAssistanceCard(D.domElement,k,c)};this.Hr();this.rwd(c);this.Aq.canReceiveFocus=!0;Jb.instance.Pz("argumentAssistanceRender");this.UCe()}};Ha.prototype.S9c=function(c){var k=this;return function(){ic(k.$,c.helpID,c.isUDF)}};Ha.prototype.onCardModeChange=function(c){this.VJb(c);1===c?Jb.instance.Cha.argumentAssistanceCollapseCounter++:Jb.instance.Cha.argumentAssistanceExpandCounter++};
Ha.prototype.NOa=function(c){var k={};k[xe.a.lha]="ArgumentAssistanceCard";var D={};D.FunctionName=c.functionName;k[xe.a.i5c]=D;this.$.De(802602464,0,8,k)};Ha.prototype.onDismissClick=function(){Jb.instance.Cha.argumentAssistanceDismissCounter++;this.CPa=!1;this.cpb();ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!this.vS&&this.VJb(1)};Ha.prototype.pj=function(){this.CPa=!0};Ha.prototype.CHd=function(){var c=tf.a.get(xe.a.CWb);af.a.ma(c)?
this.vS=Ha.p0c:this.vS=parseInt(c);Jb.instance.YMf(this.vS)};Ha.prototype.tsi=function(c){!c.button&&c.target&&(mg.g(c),this.IZa&&this.IZa.ima(c))};Ha.prototype.fq=function(){void 0!==this.Hr&&null!==this.Hr&&this.Hr()};Ha.prototype.rwd=function(c){var k=c.functionRenderingInfo.functionName;af.a.ma(this.yja)||!af.a.equals(this.yja,k,!0)?(this.yja=k,c=ih.a.map(c.functionRenderingInfo.signatures,function(D){return D.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new lb(k,
c))):(k=ih.a.map(c.functionRenderingInfo.signatures,function(D){var ba="";0<=D.signatureParams.activeParam&&D.signatureParams.activeParam<D.signatureParams.params.length&&(ba=D.signatureParams.params[D.signatureParams.activeParam]);return ba}),this.raiseEvent("FAParameterSelectionChanged",new ha(k)))};Ha.prototype.UCe=function(){window.requestAnimationFrame(function(){Jb.instance.Pz("argumentAssistanceOverall")})};Ha.prototype.VJb=function(c){this.vS=c;try{tf.a.Uv(xe.a.CWb,c.toString(),oi.AFrame.Mca)}catch(k){ed.ULS.sendTraceTag(537162070,
0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",k.message)}};Ha.jhd=function(c){return af.a.contains(c,jc.l3b,!0)};Ha.m4h=function(c){return!!c&&af.a.SZa(c.NameDataStrings,"IFS")};Ha.uxg=function(c,k,D,ba){try{if(!c||2>c.length)ed.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",ba.NameDataStrings,c?c.length.toString():"currRowParamsArray == null",k,D);
else{for(var Ba=c.pop().toString(),nb=c.length-1;nb<D;nb++){var Rb=c[nb].trim();if(k){var Ic=c[nb-1].trim();c.push(Ha.Zrh(Ic,Rb))}else{var Wc=Ha.O0e(Rb);c.push(Ha.nNe(Wc))}}c.push(Ba)}}catch(Rd){throw ed.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",ba.NameDataStrings,c?c.length.toString():"currRowParamsArray == null",k,D,Rd),Rd;}};Ha.Zrh=function(c,k){c=Ha.O0e(c);var D=
Ha.fTe(c);k=Ha.fTe(k);return Ha.nNe(c,!0,!!D&&!!k&&D!==k)};Ha.O0e=function(c){var k=c.match(Ha.$rd);c=af.a.trimEnd(af.a.trimStart(c,jc.Muf),jc.Luf);if(k&&k.length){k=k[k.length-1];var D=Number.parseLocale(k)+1;c=c.replace(k,D.toString())}else c=String.format("{0}{1}",c,1);return c};Ha.nNe=function(c,k,D){var ba="[{0}]";(void 0===k?0:k)&&(ba=(void 0===D?0:D)?"[{0}":"{0}]");return String.format(ba,c)};Ha.fTe=function(c){return(c=c.match(Ha.$rd))&&c.length?c[0]:null};Ha.SHa=function(c){if(c)return document.createElement("div");
c=String.format(jc.vvf,jc.tvf,jc.Rvd,zd.a.gFe,jc.PBb,zd.a.fFe,jc.Svd);var k=String.format(jc.vvf,jc.uvf,jc.Rvd,zd.a.gFe,jc.PBb,zd.a.fFe,jc.Svd);c=String.format(jc.uqh,jc.vqh,zd.a.XFe,zd.a.k$g,ia.a.gu,jc.JMe,c,k);k=document.createElement("div");k.innerHTML=c;return k.firstChild};Ha.$rd=RegExp("\\d+");Ha.p0c=0;Object(qd.a)(Ha,"FormulaArgumentAssistanceControlDeprecated",Oh.a,[727]);Object(qd.a)(mb,"ParseContext",null,[]);var li=b(311),sh=Tj.a;Em(Ka,sh);Ka.prototype.Vh=function(c,k){this.formulaAssistanceControl.pb=
this.pb;-1470715894!==k&&-1231471547!==k||this.T2a&&!this.xze()||(this.rU=!1);return sh.prototype.Vh.call(this,c,k)};Ka.prototype.zsd=function(){var c=this.uub;if(c||this.aKd){this.formulaAssistanceControl.pb=this.pb;if(this.T2a&&(Jb.instance.Elb.formulaAssistanceRequestAttemptedCounter++,!this.xze())){Jb.instance.Elb.formulaAssistanceRequestOptimizedCounter++;return}if(!c&&this.aKd)this.formulaAssistanceControl.eke();else if(ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",
!1)&&this.wTh){if(c=this.$.Vb.Dc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.gke(),c.stop(),this.KWa.text.endsWith("[")&&"["!==this.KWa.text.charAt(this.KWa.text.length-2)){var k=""===this.VFa?this.formulaAssistanceControl.tableManager.Ij:Object(Og.a)(li.a,this.$.wb.getItemByName(this.VFa));ed.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
k.gj,c.Cc,this.Ded,this.rU)}}else this.formulaAssistanceControl.plb(),this.quf&&(this.quf=this.rU=!1)}else this.rU=!1};Ka.prototype.Rj=function(){this.vSi||(this.GPa=null,this.aKd&&this.formulaAssistanceControl.f3())};Ka.prototype.pj=function(){this.rU=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Znc();this.en&&this.Oci()};Ka.prototype.Fyd=function(c,k){return this.formulaAssistanceControl.Vh(c,k)};Ka.prototype.Oci=function(){this.formulaAssistanceControl.xab&&(Jb.instance.e6b.smartSuggestionShownCounter++,
this.formulaAssistanceControl.xab=!1);this.formulaAssistanceControl.aIb&&(Jb.instance.e6b.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.aIb=!1);this.formulaAssistanceControl.$Hb&&(Jb.instance.e6b.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.$Hb=!1)};Ka.prototype.yIg=function(c,k){for(var D=0,ba;-1!==D;)if(D=c.indexOf("[",D+1),-1!==D&&D<k&&(ba=c.indexOf("]",D+1),-1===ba||ba>=k))return D;return-1};Ka.prototype.xze=function(){var c=this.pb.text,k=this.pb.textBox.caretPosition,
D=this.formulaAssistanceControl.cLa,ba=this.formulaAssistanceControl.bLa;if(this.rU&&af.a.equals(c,D,!0)&&k===ba)return!1;this.formulaAssistanceControl.cLa=c;this.formulaAssistanceControl.bLa=k;return!0};Ll.Object.defineProperties(Ka.prototype,{qvb:{configurable:!0,enumerable:!0,get:function(){return Object(Af.a)(qb,this.$.zb.hh)}},rU:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(c){this.formulaAssistanceControl.isListVisible=c}},uub:{configurable:!0,
enumerable:!0,get:function(){var c=this.KWa.text;c=0<c.length?c.charCodeAt(0):-1;return 61===c||43===c||45===c||64===c}},wTh:{configurable:!0,enumerable:!0,get:function(){var c=this.KWa.text,k=!1;if(0>=c.length)return k;var D=this.$.Vb.Dc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),ba=ze.g(this.$).ga.wa.activeCell.clone(),Ba=c.charCodeAt(0);this.VFa="";this.ZO=this.yIg(c,this.KWa.caretPosition);Ba=61===Ba&&-1!==this.ZO;if(!ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Ba&&
(k=!0);else if(Ba){if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Ba=0;for(var nb=this.ZO-1;1<=nb&&!(this.ZO-nb>Ka.sff);nb--)if(Array.contains(Ka.ame,c.charAt(nb))){Ba=nb;break}Ba=c.substring(Ba+1,this.ZO);c=""!==Ba?this.$.wb.getItemByName(Ba):null;nb=this.ZO;for(var Rb=this.ZO+1;Rb<=this.pb.textBox.caretPosition;Rb++)if("["===this.pb.text.charAt(Rb))nb=Rb;else break;this.ZO=nb}else{Ba=c.lastIndexOf("[");nb=0;for(Rb=Ba-1;1<=Rb&&!(Ba-Rb>Ka.sff);Rb--)if(Array.contains(Ka.ame,
c.charAt(Rb))){nb=Rb;break}Ba=c.substring(nb+1,Ba);c=""!==Ba?this.$.wb.getItemByName(Ba):null}c&&2===c.type?(k=!0,this.VFa=Ba):ze.g(this.$).$b.Mk(ba)&&(k=!0,this.VFa="")}D.stop();this.Ded=D.Cc;ed.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.Ded);return k}},key:{configurable:!0,enumerable:!0,get:function(){return Fj.a.Zsa}},calcManager:{configurable:!0,enumerable:!0,
get:function(){this.gAc||(this.gAc=this.$.ea.Ba(266,!1));return this.gAc}},aKd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.GPa)return this.GPa;if(!ae.EwaSettings.ka(136))return this.GPa=!1;var c=ze.g(this.$).ga.wa.activeCell.clone();if(1!==c.Zef||!c.left||ze.g(this.$).ga.wa.occ())return!1;var k=this.formulaAssistanceControl.tableManager.zo(c);if(k)return this.GPa=!1;--c.left;--c.right;if(!c.isValidRange)return!1;k=this.formulaAssistanceControl.tableManager.zo(c);return this.GPa=!!k&&
c.top===k.top&&this.formulaAssistanceControl.tableManager.vRg(k,ze.g(this.$))}}});Ka.ame=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Ka.sff=255;Object(qd.a)(Ka,"FormulaAutoCompleteListAutoCompleteBehavior",Tj.a,[]);var Rh;(function(c){c[c.function=0]="function";c[c.field=1]="field";c[c.definedName=2]="definedName";c[c.letVariable=3]="letVariable";c[c.tableColHeaderName=4]="tableColHeaderName";c[c.tableSpecialStructRef=5]="tableSpecialStructRef";c[c.pendingData=6]="pendingData";c[c.tableNamedObject=7]="tableNamedObject"})(Rh||
(Rh={}));Object(qd.b)("ItemType",Rh);var Di=b(1174),Oi=b(1175);ta.prototype.execute=function(c){Array.add(c,this.index)};Object(qd.a)(ta,"AppendIndexOperation",null,[760]);ea.prototype.execute=function(){};Object(qd.a)(ea,"NopIndexOperation",null,[760]);ab.prototype.execute=function(c){for(var k=0;k<c.length;k++)c[k]===this.CIi&&(c[k]=this.thf)};Object(qd.a)(ab,"ReplaceIndexOperation",null,[760]);Ya.prototype.cwe=function(c,k){var D=new ta(k);if(!Xg.a.Ihd())return D;c=this.B8h(c,k);return null!=c?
this.items[c].Bwb?new ab(c,k):new ea:D};Ya.prototype.B8h=function(c,k){var D=this,ba=this.items[k];ed.ULS.shipAssertTag(537162075,0,!!ba,"Internal error: invalid item index");c=u.where(u.asEnumerable(c),function(Ba){return D.items[Ba].name===ba.name});return u.Ct(c)?u.first(c):null};Object(qd.a)(Ya,"FilterItemOperationFactory",null,[]);Object(qd.a)(xb,"CompletionItem",null,[]);var Sh=Di.a;Em(pb,Sh);pb.prototype.pge=function(c){this.addHandler("FLBSelectedRowChanged",c)};pb.prototype.MFf=function(c){this.removeHandler("FLBSelectedRowChanged",
c)};pb.prototype.EPc=function(c){this.addHandler("ACLBUpdated",c)};pb.prototype.oCd=function(c){this.removeHandler("ACLBUpdated",c)};pb.prototype.dispose=function(){Sh.prototype.dispose.call(this);this.qpa=this.KMe=this.lrb=null};pb.prototype.Ltc=function(c,k,D,ba){ba=void 0===ba?0:ba;this.l6(!1);var Ba="";af.a.ma(D)||(Ba+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",zd.a.ZMg,D));Ba+=String.format("<table class='{0}' aria-live='off'><tbody>",
this.vaa);for(var nb=new Tf.a,Rb=0,Ic=this.fV.length;Rb<Ic;Rb++)Ba+=this.hVe(c[this.fV[Rb]],Rb+1,k,ba),this.en&&nb.add(this.kPe(c[this.fV[Rb]]));Rb=this.fV.length;Ic=0;for(var Wc=this.nr.length;Ic<Wc;Ic++)Array.contains(this.fV,this.nr[Ic])||(Rb++,Ba+=this.hVe(c[this.nr[Ic]],Rb,k,ba),this.en&&nb.add(this.kPe(c[this.nr[Ic]])));this.Zf.innerHTML=Ba+"</tbody></table>";this.sn=Ne.DOMElementExtensions.lj(this.domElement,this.vaa);this.en&&(this.vXc=nb.toArray());this.l6(!0);this.Bvg(!af.a.ma(D))};pb.prototype.tHa=
function(c,k,D,ba,Ba,nb){ba=void 0===ba?"":ba;Ba=void 0===Ba?0:Ba;nb=void 0===nb?!1:nb;if(c){var Rb=[],Ic=[];this.ZHb=0;var Wc=new Ya(this.$,c);if(af.a.ma(k))for(D=0;D<c.length;++D){if(c[D].Bwb||nb){var Rd=Wc.cwe(Rb,D);Rd.execute(Rb);Rd.execute(Ic);c[D].Bwb&&this.ZHb++}}else{var Ge=!!k&&0<Ba,df=Ge&&91===k.charCodeAt(Ba+1)?Ba+2:Ba+1;nb=Ge?k.length===df:!1;Ge&&k.length===Ba&&ae.EwaSettings.ka(136)&&(nb=!0);Rd=null;!nb&&Ge&&k.length>Ba+1&&(Rd=k.substring(df,k.length));if(!af.a.ma(k))for(Ge=0,df=c.length;Ge<
df;Ge++){var Wf=c[Ge].name;if(!c[Ge].o0h){var Pg=Wc.cwe(Rb,Ge);c[Ge].Bwb&&this.ZHb++;(Rd||nb)&&c[Ge].itemType||(Ic=this.oKe(k,Wf,D,Pg,Rb,Ic),Rb=Ic.W0e,Ic=Ic.yxf);Rd&&1===c[Ge].itemType&&(Ic=this.oKe(Rd,Wf,!0,Pg,Rb,Ic),Rb=Ic.W0e,Ic=Ic.yxf);nb&&1===c[Ge].itemType&&Pg.execute(Rb)}}}this.fV=Ic;this.nr=Rb;this.Ltc(c,k,ba,Ba)}};pb.prototype.Oxj=function(c){if(c&&!(1<c.length)){var k=[],D=[];k.push(0);D.push(0);this.fV=k;this.nr=D;this.Ltc(c,"","",0)}};pb.prototype.bwa=function(){this.Dk&&Sh.prototype.bwa.call(this)};
pb.prototype.QLi=function(c,k){this.raiseEvent("ACLBUpdated",new Oi.a(c,void 0,void 0,k))};pb.prototype.k3f=function(c){var k=this.sn.rows[c];return(!this.Dk||this.Dk!==k)&&c<this.sn.rows.length?(this.Dk=k,!0):!1};pb.prototype.uAb=function(c){mg.g(c.Ea);this.Sv&&2!==this.Sv&&3!==this.Sv&&4!==this.Sv&&5!==this.Sv&&7!==this.Sv?1===this.Sv?this.rqa.Rx(!1):(this.rqa.Rx(!1),c=ze.g(this.$),c.lq(!1),c.focus()):(this.raiseEvent(dk.a.u1a),this.bwa());return!0};pb.prototype.Bvg=function(c){this.Ypa();if(c){var k=
this.sn.offsetWidth+(this.nr.length>this.$G?Jf.a.yp:0);c=$get("list_column_header");c.offsetWidth>k&&Ne.DOMElementExtensions.nq(this.Zf,c.offsetWidth);k=this.Zf.getElementsByClassName(this.fZ);for(var D=0;D<k.length;D++)k[D].style.width=Gb.HelperMethods.Pb(c.offsetWidth)}};pb.prototype.hVe=function(c,k,D,ba){if(1===c.itemType){var Ba=xg.a.Xf(c.name),nb=xg.a.Xf(ba?D.substring(ba+1,D.length):D),Rb=0;Ba.substring(0,nb.length).toLowerCase()!==nb.toLowerCase()&&(Rb=pb.olj(Ba,jc.a6f,nb));D="";D=0<=Rb?D+
(Ba.substring(0,Rb)+"<b>"+Ba.substring(Rb,Rb+nb.length)+"</b>"+Ba.substring(Rb+nb.length,Ba.length)):D+Ba;ba=ba?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",ia.a.CGe,xg.a.eU(vh.a.ve(0)),de.a.instance.da(684)):"";return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'></td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",ba,k,Rh[c.itemType],
this.fZ,D)}if(5===c.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>","",k,Rh[c.itemType],this.fZ,xg.a.Xf(c.name),xg.a.Xf(c.Eha));if(4===c.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",
"(...)",k,Rh[c.itemType],this.fZ,xg.a.Xf(c.name));if(6===c.itemType)return ba=ba?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",ia.a.CGe,xg.a.eU(vh.a.ve(0)),de.a.instance.da(684)):"",String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",ba,this.fZ,xg.a.Xf(c.name),xg.a.Xf(c.Eha),
k,Rh[c.itemType]);ba=String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",2===c.itemType||3===c.itemType?ia.a.Ueh:ia.a.Seh,xg.a.eU(vh.a.ve(0)),de.a.instance.da(681));return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",ba,this.fZ,xg.a.Xf(c.name),xg.a.Xf(c.Eha),k,Rh[c.itemType])};
pb.prototype.kPe=function(c){var k=new xb;k.label=c.label;k.textEdit=c.textEdit;k.kind=pb.Dwh(c.itemType);k.type=c.Bwb?1:0;if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===k.kind){var D=this.formulaAssistanceControl.GAh(c.label);k.detail=D?D:c.Eha}else k.detail=c.Eha;return k};pb.prototype.oKe=function(c,k,D,ba,Ba,nb){af.a.equals(k,"Pretend this is the line.",!1)&&0<Ba.length||af.a.HH(k,c)?(ba.execute(Ba),ba.execute(nb)):D&&c.length>=jc.yRg&&pb.i1g(k,jc.a6f,
c)?ba.execute(Ba):!D&&c.length>=jc.xRg&&af.a.contains(k,c,!0)&&ba.execute(Ba);return{W0e:Ba,yxf:nb}};pb.Dwh=function(c){switch(c){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};pb.i1g=function(c,k,D){k=Ol(k);for(var ba=k.next();!ba.done;ba=k.next())if(ba=c.split(ba.value),!(2>ba.length)){ba=Ol(ba);for(var Ba=ba.next();!Ba.done;Ba=ba.next())if(af.a.HH(Ba.value,D))return!0}return!1};pb.olj=function(c,
k,D){k=Ol(k);for(var ba=k.next();!ba.done;ba=k.next())if(ba=c.toLowerCase().indexOf((ba.value+D).toLowerCase()),0<ba)return ba+1;return-1};Ll.Object.defineProperties(pb.prototype,{y8e:{configurable:!0,enumerable:!0,get:function(){return 0<this.ZHb&&this.ZHb===this.nr.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Gi.a)(pb.prototype,this,"isListVisible")},set:function(c){Object(Gi.b)(pb.prototype,this,"isListVisible",c);c||(this.vpc=0,this.je=null);this.vpc?Ne.DOMElementExtensions.setVisible(this.lrb,
!1):Ne.DOMElementExtensions.setVisible(this.lrb,c&&!this.en)}},Dk:{configurable:!0,enumerable:!0,get:function(){return this.qpa},set:function(c){this.qza(this.Dk);if(c){this.KMe.innerText="";this.qpa=c;var k=this.qza(this.Dk),D=c.rowIndex+1,ba=$get("description_cell"+D,c);this.lrb.innerText=ba.innerText;var Ba=$get("item_type_cell",c);this.je=k=k.innerText;this.vpc="field"===Ba.innerText?1:"definedName"===Ba.innerText?2:"letVariable"===Ba.innerText?3:"tableColHeaderName"===Ba.innerText?4:"tableSpecialStructRef"===
Ba.innerText?5:"pendingData"===Ba.innerText?6:"tableNamedObject"===Ba.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Oi.a(this.nr.length,D,k,ba.innerText));this.cpc(c)}}},MQa:{configurable:!0,enumerable:!0,get:function(){return this.lrb}},rqa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},Sv:{configurable:!0,enumerable:!0,get:function(){return this.vpc}}});Object(qd.a)(pb,"FormulaAutoCompleteListBox",Di.a,[726]);Ll.Object.defineProperties(ib.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.a8}}});Object(qd.a)(ib,"LETVariableInfo",null,[]);Ll.Object.defineProperties(Pa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(qd.a)(Pa,"TableColHeaderNameInfo",null,[]);Ll.Object.defineProperties(xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(qd.a)(xa,"TableNamedObjectInfo",
null,[]);Ll.Object.defineProperties(ma.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.a8}}});Object(qd.a)(ma,"TableSpecialStructRefInfo",null,[]);var ei=b(175),yi=b(174);Object(qd.a)(na,"FormulaAutoCompleteCallbacks",null,[]);Object(qd.a)(La,"FormulaAutoCompleteRenderingInfo",null,[]);Object(qd.a)(ra,"CellMessage",null,[]);Object(qd.a)(ca,"FunctionSuggestionRequest",null,[]);Object(qd.a)(Z,"RunExperimentRequest",
null,[]);var Si=Gd.a;Em(U,Si);U.prototype.ufe=function(c){this.addHandler(U.d7c,c)};U.prototype.iFf=function(c){this.removeHandler(U.d7c,c)};U.prototype.tfe=function(c){this.addHandler(U.F6c,c)};U.prototype.hFf=function(c){this.removeHandler(U.F6c,c)};U.prototype.set_visible=function(c){this.Aha.set_visible(c);this.en&&!c&&this.xZa();Sys.UI.Control.prototype.set_visible.call(this,c);return c};U.prototype.FHg=function(c,k){this.isListVisible&&(c+=jc.openParen,k++,this.Wvd(c,k));var D=0<k&&c.charAt(k-
1)===jc.openParen,ba=k===c.length||c.charAt(k)===jc.closeParen;if(!D||!ba)return ed.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",k,!c.length,!!this.YO),!1;D=c.substring(0,k).lastIndexOf(this.gf.listSeparator);ba=c.substring(0,k-1).lastIndexOf(jc.openParen);c=c.substring(-1===D&&-1===ba?1:Math.max(D,ba)+1,k-1).trim();return this.functionInfoManager.L9c(c)?!0:(ed.ULS.sendTraceTag(537162052,
0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.YO),!1)};U.prototype.DXh=function(c,k){var D=this.FHg(c,k);if(!D||!this.YO)return ed.ULS.shipAssertTag(537162051,0,!D||D&&!!this.YO,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,phf:0,hLe:0};D=this.YO.Params;D=D.replace(RegExp("[\\[\\]]","g"),"");var ba=c.charAt(k-1)===jc.openParen,Ba=ba?"":"(",nb=k===
c.length?")":"";var Rb=this.gf.listSeparator;Rb=-1===D.indexOf(Rb)?D.length:D.indexOf(Rb);return{returnValue:c.substring(0,k)+Ba+D+nb+c.substring(k,c.length),phf:ba?k:k+1,hLe:Rb}};U.prototype.fq=function(c,k){this.en&&void 0!==this.Hr&&null!==this.Hr&&this.Hr();this.en||Si.prototype.fq.call(this,c,k)};U.prototype.dispose=function(){if(this.gf){this.mQa(!1);var c=ze.g(this.gf);c&&(c.ga&&(this.en?c.ga.CE(Object(xd.a)(this,this.$c,"onSelectionChanged")):c.ga.Nba(Object(xd.a)(this,this.$c,"onSelectionChanged")),
ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")&&c.ga.Nxa(Object(xd.a)(this,this.psd,"onActiveCellChanged$4"))),c.view.Gr(Object(xd.a)(this,this.fq,"onGridScroll")));this.en&&this.gf.va&&this.gf.va.zg(Object(xd.a)(this,this.Ai,"onActiveSheetChanged"))}this.functionInfoManager&&(this.functionInfoManager.bnc(Object(xd.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded")),this.functionInfoManager.iUi(Object(xd.a)(this,this.lnf,"onFunctionInfoReset")));this.Pl&&this.Pl.eCd(Object(xd.a)(this,
this.kAb,"onFieldInfoListContextLoaded"));this.en&&this.Vf&&this.Vf.MFf(Object(xd.a)(this,this.dsf,"onSelectedAutoCompleteItemChanged"));this.OWf(!1);Rf.a.Fa(this.Vf);Rf.a.Fa(this.MWb);Rf.a.Fa(this.Aha);this.Uia&&Rf.a.Fa(this.Aq);this.pb=this.functionInfoManager=this.Pl=this.gf=null;Rf.a.mc(this.IHa);this.Ij=this.R6=this.Aha=this.IHa=null;Si.prototype.dispose.call(this)};U.prototype.pKa=function(){return!this.tw};U.prototype.b3h=function(){return!this.nEa};U.prototype.Vh=function(c,k){if(!this.pKa()){if(this.en&&
this.aM){if(125627505===k||267796030===k)return this.P$&&this.Gvc(k),this.Cse(),!1;if(1872288872===k)return this.Hba(),this.isListVisible=!1,!0;if(this.Vf.y8e&&(-798660877===k||137938150===k))return!1}if(1!==this.Vf.Sv||125627505!==k&&267796030!==k)if(6===this.Vf.Sv){var D=c.keyCode;13!==D&&9!==D||this.Rx(!1)}else{if(4===this.Vf.Sv||5===this.Vf.Sv)return Si.prototype.Vh.call(this,c,k,!0);1===this.Vf.fV.length&&(D=c.keyCode,this.poe=8===D||127===D||46===D?!0:!1)}else{if(this.Rx(!1)&&!this.Gia)return ze.g(this.gf).ga.Vh(c,
k);if(125627505===k&&this.Gia)return!0}}return Si.prototype.Vh.call(this,c,k)};U.prototype.Znc=function(){this.Pl.$nc();this.R6=null;null==this.nha||this.nha||this.Xec("NoFieldChosen",1,2,1);this.nha=null;this.y2=0;this.f4=this.dld=this.ikc=null};U.prototype.plb=function(){var c=this,k=!!this.pb&&!ch.f(this.gf.qa);this.wab&&k?this.pluginScheduler.requester().functionSuggestion(Object.assign(new ca,{content:this.pb.text})).then(function(D){D.kind||(ed.ULS.shipAssertTag(537162050,0,!!D&&!!D.payload.items,
"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),c.$Pa=u.toArray(u.select(u.asEnumerable(D.payload.items),function(ba){return U.qQg(ba)})),Td.AFrameworkApplication.Fg||c.fke(k,!0));return null}):this.fke(k,!1)};U.prototype.gVe=function(){if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var c=ze.g(this.gf).nj?this.frb.ZO:this.Fmb.ZO;"@"===this.pb.text.charAt(c+1)&&this.pb.textBox.caretPosition>c+1?this.Sab=c+2:this.Sab=
c+1}else{c=this.pb.text.lastIndexOf(jc.Haf);var k=this.pb.text.lastIndexOf("[");this.Sab=c+1>=k?c+2:k+1}return this.pb.text.substring(this.Sab,this.pb.textBox.caretPosition)};U.prototype.gke=function(){this.XTf()&&(this.jYg(),this.tw&&(this.nha=!1,this.xU=this.gVe(),this.Vf.tHa(this.tw,this.xU,!0,void 0,void 0,!0),this.show(),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Aha.cpb()))};U.prototype.eke=function(){this.XTf()&&(this.MWb&&this.MWb.cancel(),
this.Pl.Gbc?(this.pKa()&&this.Tue(!0),this.get_visible()?this.jKe():this.hVd=ei.AsyncMethodContext.Hw(Object(xd.a)(this,this.jKe,"filterAndShowListBox"),jc.E0g,cd.a.rph,this.MWb)):this.f3())};U.prototype.XTf=function(){return this.pb?0<this.gf.zb.tQ||af.a.ma(this.pb.text)||!this.pb.isEditing?(this.set_visible(!1),!1):ch.f(this.gf.qa)?!1:!0:!1};U.prototype.qYa=function(c){this.pb&&this.isListVisible&&(this.Hfd(this.pb.text,c),this.pb.textBox.caretPosition=c.range.start.character+c.newText.length,this.set_visible(!1))};
U.prototype.Rx=function(){if(!this.pb||!this.isListVisible)return!1;var c="",k=0,D=ze.g(this.gf),ba=this.pb.text,Ba=0,nb=this.Vf.je,Rb=!1;if(this.Vf.Sv&&2!==this.Vf.Sv&&3!==this.Vf.Sv&&7!==this.Vf.Sv)if(1===this.Vf.Sv)if(this.nha=!0,this.Gia){c+=ba.substr(0,this.y2+2);!c.toString().endsWith(Xf.a.pT)&&ae.EwaSettings.ka(136)&&(c+=Xf.a.pT);Ba=this.Vf.je;Ba=Ba.replace("'","''");Ba=Ba.replace("[","'[");Ba=Ba.replace("]","']");if(this.z0c||this.Tkh(Ba))Ba=Xf.a.W$h+Ba+Xf.a.h0i,Rb=!0;c+=Ba;k=c.length;Ba=
3;yi.a("PulloutFieldAccepted")}else return this.pb.text=this.Vf.je,this.set_visible(!1),D.lq(!1),D.focus(),this.Xec("FieldName",1,1,1),yi.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Vf.Sv)ed.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),c+=ba.substr(0,this.Sab),af.a.equals(this.Vf.je,"@ - "+this.instantaneousSupportInformationManager.Fe.ThisRowStructRefString,!1)?c+="@":(c+=this.Vf.je,Rb=!0,this.set_visible(!1)),
k=c.length;else if(4===this.Vf.Sv){ed.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");c+=ba.substr(0,this.Sab);Rb="";k=!1;for(var Ic=[39,91,93,64,35],Wc=0;Wc<this.Vf.je.length;Wc++){var Rd=this.Vf.je.charCodeAt(Wc);Array.contains(Ic,Rd)&&(Rb+="'");Rb+=this.Vf.je.charAt(Wc).toString();k||af.a.isNumeral(Rd)||af.a.c6e(Rd)||(k=!0)}Ic=ze.g(this.gf).nj?this.frb.ZO:this.Fmb.ZO;ba=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
"@"===ba.charAt(Ic+1)&&k:ba.lastIndexOf(jc.Haf)+1>=ba.lastIndexOf("[")&&k;c+=ba?"["+Rb+"]":Rb;Rb=!0;this.set_visible(!1);k=c.toString().length}else if(6===this.Vf.Sv)c+=ba.substr(0,this.ppb);else return ed.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;else c+=ba.substr(0,this.c0a)+this.Vf.je,this.Vf.Sv||this.Vf.je.endsWith(")")||(c+="("),k=c.toString().length,c+=ba.substr(this.l6b),2===this.Vf.Sv&&(Ba=4,nb="DefinedName",Rb=!0,this.set_visible(!1));
this.pb.text=c;this.pb.textBox.caretPosition=k;this.pb.MKa()&&D.pv&&D.pv.Vsa&&D.pv.UFb(this.pb.text,this.pb.textBox.caretPosition,this.pb.textBox.caretPosition,this.pb.textBox.Du.length);D.nj&&(c=D.Gc,c.text=this.pb.text,c.setCaretPosition(this.pb.textBox.caretPosition));nb=(null==this.nha?0:this.nha)?"FieldName":nb;this.Vf.Dk.sectionRowIndex>=this.Vf.fV.length?this.Xec(nb,4,Ba,0):this.Xec(nb,1,Ba,0);Rb||(5===this.Vf.Sv||4===this.Vf.Sv?this.gke():this.plb());return!0};U.prototype.f3=function(c,k){c=
void 0===c?null:c;k=void 0===k?null:k;c?(this.Pl.$nc(),this.Pl.f3(c,!1,!1,k)):(c=ze.g(this.gf),c.ga.wa.xh&&(c=cf.v(c.ga.wa.Nd,this.gf),this.Pl.f3(c,!0,!0,k)))};U.prototype.Hba=function(){this.Zda=!1;this.pb.aAe()};U.prototype.GAh=function(c){c=this.calcManager.getWorksheetFuncId(c);return this.OMe?this.OMe.descriptionsMap.get(c):null};U.prototype.Tue=function(c){if(this.b3h()){if(this.Pl.Gbc&&this.Pl.ol&&(!this.Pl.ol.length||!this.Pl.ol[0].FieldInfoDataList))return;this.Vvj(c)}c=u.asEnumerable(this.nEa);
c=u.concat(c,this.xCh(this.pb.text));ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.en&&(c=u.concat(c,this.EDh()));u.OBc(c,function(k){return k.name},new Xe);this.wab&&(c=u.concat(u.asEnumerable(this.$Pa),c),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.$Pa.length&&(this.xab=!0),this.$Pa=[]));this.R6=u.toArray(c)};U.prototype.jYg=function(){var c=this.pb.text;if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var k=
ze.g(this.gf).nj?this.frb.VFa:this.Fmb.VFa;this.Ij=Object(Og.a)(li.a,this.gf.wb.getItemByName(k));k=!0;this.Ij||(this.Ij=this.tableManager.Ij,k=!1);this.Ij.z_&&this.Ij.z_.IsFullTableHeaders?this.Xwf(k):kf.d(this.Ij)?(ed.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Ij.gj),hg.H(this.gf.ra.ua,this.Ij.gj,Object(xd.a)(this,this.Zti,"onGetTableColHeadersSuccess"),Object(xd.a)(this,this.Yti,"onGetTableColHeadersFailure"),
null,null)):ed.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",this.Ij.gj)}else if(this.calcManager&&this.tableManager.Ij)if(k=this.calcManager.Tsb(this.tableManager.Ij))if(this.calcManager.nwg(this.tableManager.Ij,k)){c=u.empty();if(91===this.pb.text.charCodeAt(this.pb.text.length-1)){var D=this.NYa("@ - "+this.instantaneousSupportInformationManager.Fe.ThisRowStructRefString),ba;c=u.concat(c,(ba=new Tf.a,
ba.add(D),ba))}c=u.concat(c,u.select(u.asEnumerable(k.toArray()),function(Ba){var nb=new Yb,Rb=new Pa;Rb._name=Ba.toString();nb.JPf(Rb);return nb}));this.R6=u.toArray(c)}else c.endsWith("[")&&"["!==c.charAt(c.length-2)&&ed.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",k.count,this.tableManager.Ij.gj,this.tableManager.Ij.usedRange.right-
this.tableManager.Ij.usedRange.left+1);else c.endsWith("[")&&"["!==c.charAt(c.length-2)&&ed.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};U.prototype.Tkh=function(c){if(!c)return!1;var k=c.charCodeAt(0);if(46===k||48<=k&&57>=k||63===k)return!0;for(var D=0;D<c.length;D++,k=c.charCodeAt(D))if(!((ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
af.a.isLetter(k):af.a.kid(k))||92===k||95===k||63===k||48<=k&&57>=k))return!0;return!1};U.prototype.Wvd=function(c,k){var D=!1,ba=!1,Ba=!1,nb=0,Rb=0;this.c0a=0;this.l6b=k;this.W0b=1;for(var Ic=k-1;0<=Ic;--Ic)switch(c.charCodeAt(Ic)){case 39:ba=!ba;break;case 34:D=!D;break;case 91:++nb;Ba=nb>Rb;break;case 93:++Rb}Ba=Object.assign(new mb,{Wqa:!D,Xqa:!ba,qga:!Ba,QBb:1});nb=this.kEi(c,k,Ba);k=this.lEi(c,k,Ba.Wqa,Ba.Xqa,Ba.qga);this.W0b=nb+k;if(this.OKc=nb-1)this.Lrc=!1;this.Glh(c,D,ba,Ba.yvd,Ba.zvd)};
U.prototype.sfd=function(){ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")?ze.g(this.gf).ga.Tpa(Object(xd.a)(this,this.psd,"onActiveCellChanged$4")):ze.g(this.gf).ga.CF(Object(xd.a)(this,this.psd,"onActiveCellChanged$4"));this.ozb();U.dFd(this.pluginScheduler);this.wab&&this.WJg()};U.prototype.Ybd=function(){this.fKa&&this.raiseEvent(U.F6c,null)};U.prototype.gkh=function(){return this.wab||this.vJe};U.prototype.jKe=function(){this.nha=!1;this.xU=this.pb.text;this.Vf.tHa(this.tw,
this.xU,!0,this.columnName,void 0,!1);1===this.Vf.nr.length&&1===this.Vf.fV.length?(this.set_visible(!1),this.poe||this.Z$b()):this.show()};U.prototype.mEi=function(){var c=this.f4;if(!this.Kdj||af.a.ma(c))return this.y2=0,this.nEa=this.R6=null,!1;c=c.endsWith(Xf.a.pT);var k;if(k=ae.EwaSettings.ka(136)){k=this.utj(this.f4.substring(0,this.z2));var D=k.sheetRange;k=k.returnValue}return k&&(k=this.f4.substring(0,this.y2),c&&k!==this.dld)?(this.dld=k,this.y2=this.f4.length-(c?1:0),this.f3(D,this.f4),
this.nha=!1,ed.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0):!1};U.prototype.xCh=function(c){var k=new Tf.a;this.calcManager&&ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&ed.ULS.shipAssertTag(537162014,0,!!this.calcManager.ira(mi.Range.ld(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.vJe&&(c=this.calcManager.extractLetVariables(c,this.pb.textBox.caretPosition))){c=Ol(c);
for(var D=c.next();!D.done;D=c.next()){var ba=D.value;D=new ib;D._name=ba;D.a8=de.a.instance.da(2114);ba=new Yb;ba.E8i(D);k.add(ba)}}return k};U.prototype.EDh=function(){for(var c=new Tf.a,k=this.gf.wb.items,D=0,ba=k.length;D<ba;D++){var Ba=k[D];if(ch.o(Ba)){var nb=new xa;nb._name=Ba.name;Ba=new Yb;Ba.T$i(nb);c.add(Ba)}}return c};U.prototype.NYa=function(c){var k=new Yb,D=new ma;D._name=c;k.U$i(D);return k};U.prototype.Zti=function(c){if(Hh.a(c))-315732528!==c.Errors[0].MessageId&&ed.ULS.sendTraceTag(537162013,
0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",Qg.a.Uc(c.Errors));else if((c=c.Result)&&c.length){this.Ij.z_||(this.Ij.z_={},this.Ij.z_.HeadersList=[]);this.Ij.z_.IsFullTableHeaders=!0;for(var k=0;k<c.length;++k)this.Ij.z_.HeadersList[k]={},this.Ij.z_.HeadersList[k].Index=k,this.Ij.z_.HeadersList[k].Name=c[k];this.Xwf(!0);this.xU=this.gVe();this.Vf.tHa(this.tw,this.xU,!0,void 0,void 0,!0);this.show()}else ed.ULS.sendTraceTag(537162012,
0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};U.prototype.Yti=function(c){c=fi.a.xg(c.data);ed.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",Qg.a.Uc(c))};U.prototype.Xwf=function(c){var k=new Tf.a,D=this.pb.text.charCodeAt(this.pb.text.length-1),ba=this.pb.textBox.caretPosition-1;if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
91===this.pb.text.charCodeAt(ba):91===D){var Ba=this.NYa("@ - "+this.instantaneousSupportInformationManager.Fe.ThisRowStructRefString);k.add(Ba)}Ba=Ol(this.Ij.z_.HeadersList);for(var nb=Ba.next();!nb.done;nb=Ba.next()){nb=nb.value;var Rb=new Yb,Ic=new Pa;Ic._name=nb.Name;Rb.JPf(Ic);k.add(Rb)}Ba=ze.g(this.gf).nj?this.frb.ZO:this.Fmb.ZO;nb=this.pb.text.charCodeAt(Ba+1);(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!c||ba!==Ba&&35!==nb:!c||91!==D&&
35!==D)||(c=this.NYa("#"+this.instantaneousSupportInformationManager.Fe.AllStructRefString),k.add(c),c=this.NYa("#"+this.instantaneousSupportInformationManager.Fe.DataStructRefString),k.add(c),c=this.NYa("#"+this.instantaneousSupportInformationManager.Fe.HeadersStructRefString),k.add(c),c=this.NYa("#"+this.instantaneousSupportInformationManager.Fe.TotalsStructRefString),k.add(c));k&&(this.R6=k.toArray())};U.prototype.Vvj=function(c){var k=u.empty();!c&&this.functionInfoManager.O3&&(k=u.concat(k,u.select(u.asEnumerable(this.functionInfoManager.r7c),
function(D){var ba=new Yb;ba.nOf(D);return ba})),c=this.zye.A0g,0<c.length&&(k=u.OBc(u.concat(k,u.select(u.asEnumerable(c),function(D){var ba=new Yb;ba.f7i(D);return ba})),function(D){return D.name},new Xe)));if(this.Pl.Gbc&&this.Pl.ol){if(!this.Pl.ol.length||!this.Pl.ol[0].FieldInfoDataList)return;k=u.OBc(u.concat(k,u.select(u.asEnumerable(this.Pl.ol[0].FieldInfoDataList),function(D){var ba=new Yb;ba.G7i(D);return ba})),function(D){return D.name},new Xe);this.columnName=this.Pl.ol[0].ColumnName}this.nEa=
u.toArray(k)};U.prototype.ozb=function(){var c=ze.g(this.gf).ga.wa.activeCell;if(c){var k=this.calcManager.ira(c);if(k){var D=this.gf.va,ba=k.sheet.index;ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5726798_FixNotifyActiveCellChangedSheetIDAccess")&&(0>=D.count||0>ba||ba>=D.count)?(ed.ULS.sendTraceTag(537162008,0,15,"FormulaAssistanceControl.NotifyActiveCellChanged InvalidSheetIndex. sheetCount: {0} sheetIndex: {1}.",D.count,ba),this.k4=!0):(this.k4=!1,ba=D=null,this.pzb&&void 0!==this.calcManager&&
null!==this.calcManager&&(c=ze.g(this.gf).Ca.qr(c))&&(c=this.calcManager.B$c(c.numberFormatIndex),void 0!==c&&null!==c&&(D=c.FormatString,ba=c.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new ra,{colIndex:k.range.col,rowIndex:k.range.row,sheetIndex:this.gf.va.getItem(k.sheet.index).sheetId,docName:k.sheet.document.name,docPath:k.sheet.document.path,formatString:D,builtIn:ba})))}else ed.ULS.sendTraceTag(537162009,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null"),
this.k4=!0}else ed.ULS.sendTraceTag(537162010,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged active cell range is null"),this.k4=!0};U.prototype.psd=function(){ze.g(this.gf).isEditing||ze.g(this.gf).li||this.ozb()};U.prototype.$c=function(){(ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||this.en)&&this.set_visible(!1)};U.prototype.WJg=function(){ze.g(this.gf).nj?this.frb.US(!1):this.Fmb.US(!1)};U.prototype.u9e=function(c){var k=ae.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
af.a.isLetter(c):af.a.kid(c);return 48<=c&&57>=c||46===c||95===c||k};U.prototype.show=function(){if(this.tw){var c=this.Vf.k3f(0);this.en?0<this.Vf.nr.length?c||this.LTf():this.xZa():((c=0<this.Vf.nr.length)&&Jb.instance.WE("autoCompleteRender"),this.isListVisible||af.a.ma(this.columnName)||!c||this.Vf.QLi(this.Vf.nr.length,this.columnName),this.isListVisible=c,this.Aha.show(this.YO),this.Jza(!0),this.Vf.bwa(),c&&Jb.instance.Pz("autoCompleteRender"))}};U.prototype.lEi=function(c,k,D,ba,Ba){for(D=
Object.assign(new mb,{Cuf:41,xre:40,Wqa:D,Xqa:ba,qga:Ba});k<c.length&&!this.zvf(c,k,D);++k);return D.QBb};U.prototype.kEi=function(c,k,D){for(--k;0<=k&&!this.zvf(c,k,D);--k);return D.QBb};U.prototype.zvf=function(c,k,D){var ba=c.charCodeAt(k);0>=this.z2&&(this.z2=c.substring(0,k).lastIndexOf(Xf.a.pT));46===ba&&(k<this.z2?this.z2=k:k>this.ppb&&(this.y2=this.ppb=k));if(!this.u9e(ba)&&!U.X7h(ba)&&(!this.Gia||k<=this.z2||!U.ZSh(ba,D))){D.Glf&&(D.Glf=!1,this.c0a=k+1);if(D.jud){D.zvd=k+1;if(this.functionInfoManager.L9c(c.substring(D.zvd,
D.yvd)))return!0;D.jud=!1}switch(ba){case 39:D.Xqa=!D.Xqa;break;case 34:D.Wqa=!D.Wqa;break;case 91:D.qga=!1;break;case 93:D.qga=!0}ba===this.gf.listSeparator.toString().charCodeAt(0)&&D.Xqa&&D.Wqa&&!D.cYa&&(!this.Gia||D.qga)&&(k<D.VFd||-1===D.VFd)&&(D.QBb+=1,this.W0b++);ba===D.xre&&D.Wqa&&D.Xqa&&(!this.Gia||D.qga)?D.cYa+=1:ba===D.Cuf&&D.Wqa&&D.Xqa&&(!this.Gia||D.qga)?0<D.cYa?--D.cYa:(D.VFd=D.gLe,D.gLe=k,0<k&&this.u9e(c.charCodeAt(k-1))&&(D.jud=!0,D.yvd=k)):this.Gia&&46===ba&&k>this.z2&&(k<this.z2?
this.z2=k:k>this.ppb&&(this.y2=this.ppb=k))}return!1};U.prototype.Glh=function(c,k,D,ba,Ba){this.l6b>this.c0a&&0<=this.c0a?k||D||(this.xU=c.substring(this.c0a,this.l6b)):this.xU=null;ba!==Ba?(c=c.substring(Ba,ba),this.YO&&af.a.equals(this.YO.NameDataStrings,c,!0)||(this.Lrc=!0),this.YO=this.functionInfoManager.L9c(c)):(this.Lrc=!1,this.YO=null)};U.prototype.OWf=function(c){var k=$get(jc.tvf+"_"+jc.PBb,this.domElement),D=$get(jc.uvf+"_"+jc.PBb,this.domElement);c&&!this.Y9b?(k&&$f.a.instance.pa(qf.a.click,
k,Object(xd.a)(this,this.Raa,"onHelpLinkClick")),D&&$f.a.instance.pa(qf.a.click,D,Object(xd.a)(this,this.Raa,"onHelpLinkClick")),this.Y9b=!0):this.Y9b&&(k&&$f.a.instance.za(qf.a.click,k,Object(xd.a)(this,this.Raa,"onHelpLinkClick")),D&&$f.a.instance.za(qf.a.click,D,Object(xd.a)(this,this.Raa,"onHelpLinkClick")),this.Y9b=!1)};U.prototype.lnf=function(){this.R6=this.nEa=null};U.prototype.Ai=function(){this.en&&this.xZa()};U.prototype.utj=function(c){var k=this;var D=null;var ba;if(function(){var Ic=
cf.Y(c,k.gf.fa.va);nb=Ic.sheetName;ba=Ic.range;return Ic}().returnValue&&ba){if(!nb){var Ba=Object(Og.a)(bg.a,this.gf.qa);if(!Ba)return{returnValue:!1,sheetRange:D};var nb=Ba.name}D=cf.v(ba,this.gf);D.SheetName=nb;this.z0c=!1;return{returnValue:!0,sheetRange:D}}var Rb=null;return function(){var Ic=k.zye.etj(c);nb=Ic.sheetName;Rb=Ic.range;return Ic}().returnValue?(D=cf.v(Rb,this.gf),D.SheetName=nb,this.z0c=!0,{returnValue:!0,sheetRange:D}):{returnValue:!1,sheetRange:D}};U.prototype.Z$b=function(){if(1===
this.Vf.fV.length&&this.tw.length){var c=this.tw[this.Vf.fV[0]];if(1===c.itemType){var k=c.name;c=this.pb.text;k=k.substring(c.length,k.length);k.length&&(this.pb.text=c+k,this.pb.textBox.selectRange(c.length,this.pb.text.length))}}else ed.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Vf.fV.length)};U.prototype.onFunctionInfoLoaded=function(){this.plb()};U.prototype.kAb=function(){this.Gia?(this.nEa=this.R6=null,this.plb()):
this.Pl.ol&&this.eke()};U.prototype.Raa=function(){this.YO&&ic(this.gf,this.YO.HelpId,this.YO.IsDynamicUdf);return!0};U.prototype.Xec=function(c,k,D,ba){var Ba={};Ba.a=c;Ba.b=k;Ba.c=D;Ba.d=ba;ve.b().Je(38,Ba,!0)};U.prototype.fke=function(c,k){if(!this.functionInfoManager.O3){if(c)if(this.Wvd(this.pb.text,this.pb.textBox.caretPosition),this.wab||!af.a.ma(this.xU)){var D={};D.Filter=this.xU?this.xU.charAt(0).toString():"";D.FilterType=1;D.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.Spb(D)}else ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",
!1)&&this.get_visible()&&this.set_visible(!1);if(!k)return}0<this.gf.zb.tQ||this.pb&&!this.pb.isEditing?this.set_visible(!1):c&&(this.Wvd(this.pb.text,this.pb.textBox.caretPosition),this.Aha.update(this.YO,this.W0b,this.OKc,this.Lrc),this.f4=this.pb.text.substring(1,this.pb.textBox.caretPosition),this.z2=this.f4.indexOf(Xf.a.pT),this.y2=this.f4.lastIndexOf(Xf.a.pT),this.mEi()?(c=new Yb,c.s9i(),this.nEa=this.R6=c=[c],this.Vf.Oxj(c),this.show()):((this.gkh()||this.pKa())&&this.Tue(!1),0<this.y2?this.Vf.tHa(this.tw,
this.f4,!1,void 0,this.f4.lastIndexOf(Xf.a.pT),!1):this.Vf.tHa(this.tw,this.xU,!1,void 0,this.y2,!1),this.show(),this.en&&(this.Vf.nr.length||ze.g(this.gf).Yi.QM?this.Aha.cpb():(this.pzb&&this.k4&&ed.ULS.sendTraceTag(537162005,0,15,"FormulaAssistanceControl.AssistFormulaDraw RequestArgumentAssistance called after lastNotifyActiveCellChangedFailed"),this.Aha.sYi(),this.en&&this.xZa()))))};U.prototype.LTf=function(){var c=this;if(0<this.Vf.nr.length){Jb.instance.WE("autoCompleteRender");if(this.formulaAssistanceUIControl){var k=
{};k.zoomLevel=wb(this.gf);this.formulaAssistanceUIControl.updateContext(k);this.Hr=function(){c.formulaAssistanceUIControl.renderAutoCompleteMenu(c.domElement,ze.g(c.gf).Yi.textBox.domElement,c.I9c())};this.Hr();this.fKa&&this.Vf.y8e&&this.raiseEvent(U.d7c,null);this.Uia&&(this.Aq.canReceiveFocus=!0)}Jb.instance.Pz("autoCompleteRender");!ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.$Pa&&null!==this.$Pa&&0<this.$Pa.length&&(this.xab=!0)}};U.prototype.xZa=
function(){this.P$&&this.ond();this.aM&&this.pb.isEditing&&this.Hba();this.Hr=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Uia&&(this.Aq.canReceiveFocus=!1))};U.prototype.ond=function(){this.qGa&&(Jb.instance.t1.selectByArrowKeyCounter++,this.qGa=!1);this.rGa&&(Jb.instance.t1.selectByMouseHoverCounter++,this.rGa=!1);this.pGa&&(Jb.instance.t1.commitByTabKeyCounter++,this.pGa=!1);this.nGa&&(Jb.instance.t1.commitByEnterKeyCounter++,this.nGa=!1);
this.oGa&&(Jb.instance.t1.commitByMouseClickCounter++,this.oGa=!1)};U.prototype.dsf=function(){this.aM&&this.Hba();this.LTf();1===this.MLf.type&&ae.EwaSettings.Zcc()&&!af.a.contains(this.pb.text,"\n",!1)&&(this.Gxd(this.MLf),this.aIb=!0)};U.prototype.I9c=function(){var c=new La;c.completionItems=this.Vf.vXc;c.activeItemIndex=this.Vf.Dk?this.Vf.Dk.rowIndex:-1;this.XAd(c);return c};U.prototype.XAd=function(c){c.callbacks=new na;c.callbacks.onCompletionItemSelected=Object(xd.a)(this,this.Zsd,"onCompletionItemHovered");
c.callbacks.onCompletionItemCommitted=Object(xd.a)(this,this.Ysd,"onCompletionItemClicked");c.callbacks.onFeedback=Object(xd.a)(this,this.NOa,"sendCardFeedback");ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(c.callbacks.onDismiss=Object(xd.a)(this,this.xZa,"dismissReactAutoCompleteUI"))};U.prototype.NOa=function(){var c={};c[xe.a.lha]="FunctionSuggestions";this.gf.De(802602464,0,8,c)};U.prototype.Zsd=function(c,k){this.Vf.k3f(k);this.P$&&(this.rGa=
!0)};U.prototype.Ysd=function(c){this.P$&&(this.oGa=!0);this.aM?(this.Cse(),ze.g(this.gf).Yi.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):c.textEdit?this.qYa(c.textEdit):this.Rx(!0)};U.prototype.Gxd=function(c){this.Zda=!0;var k=c.textEdit.newText;this.pb.jab(k.substring(this.pb.text.length-c.textEdit.range.start.character,k.length))};U.prototype.Cse=function(){this.Rx(!0);this.Zda=this.isListVisible=!1;this.$Hb=!0};U.prototype.Hfd=function(c,k){this.pb.text=c.substring(0,k.range.start.character)+
k.newText+c.substring(k.range.end.character,c.length);ze.g(this.gf).nj&&(ze.g(this.gf).Gc.text=this.pb.text)};U.dFd=function(c){c.requester().runExperiment(new Z)};U.qQg=function(c){var k=Yb.TXg(),D={IsCompatibility:!1};D.NameDataStrings=c.label;D.Help=c.detail;k.nOf(D);k.textEdit=c.textEdit;return k};U.SHa=function(){var c=String.format(jc.wqh,jc.u7c,vj.a.kFe),k=String.format(jc.rqh,jc.s7c,zd.a.jFe,ia.a.lr,ia.a.gu),D=String.format(jc.oqh,jc.n7c,zd.a.jFe,ia.a.lr,zd.a.XFe,ia.a.gu);return String.format("{0}\r\n{1}\r\n{2}",
c,k,D)};U.X7h=function(c){return 36===c||58===c||33===c||39===c||32===c};U.ZSh=function(c,k){return 32===c||91===c||!k.qga};Ll.Object.defineProperties(U.prototype,{Ws:{configurable:!0,enumerable:!0,get:function(){return this.Vf}},tw:{configurable:!0,enumerable:!0,get:function(){return this.R6}},NFb:{configurable:!0,enumerable:!0,get:function(){return this.Vf.je}},GMe:{configurable:!0,enumerable:!0,get:function(){return this.Vf}},nMe:{configurable:!0,enumerable:!0,get:function(){return this.Aha}},
Vf:{configurable:!0,enumerable:!0,get:function(){return this.Kcg}},wob:{configurable:!0,enumerable:!0,get:function(){return this.wab?this.pb?this.pb.text:null:this.xU}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Ws.isListVisible},set:function(c){this.en&&!c&&this.xZa();this.Ws.isListVisible=c}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Lkg}},Gia:{configurable:!0,enumerable:!0,get:function(){return 0<this.y2}},aM:{configurable:!0,enumerable:!0,
get:function(){return this.Zda}},MWb:{configurable:!0,enumerable:!0,get:function(){return this.hVd}},y2:{configurable:!0,enumerable:!0,get:function(){return this.TAe},set:function(c){this.TAe=c;c||(this.z2=0)}},Kdj:{configurable:!0,enumerable:!0,get:function(){if(null==this.ikc){var c=this.gf.ic;this.ikc=!!c&&!c.inEmbedView}return this.ikc}},MLf:{configurable:!0,enumerable:!0,get:function(){return this.Vf.vXc[this.Vf.Dk.rowIndex]}},OMe:{configurable:!0,enumerable:!0,get:function(){!this.v7c&&this.pluginScheduler&&
(this.v7c=this.pluginScheduler.getFunctionsShortDescriptions());return this.v7c}}});U.d7c="FACardOpened";U.F6c="FAFocusOnSmartSuggestionsCard";U.Wdd=null;Object(qd.a)(U,"FormulaAssistanceControl",Gd.a,[692,689,6,693,694]);var Uh=Oh.a;Em(da,Uh);da.prototype.wfe=function(c){this.addHandler("FAFunctionNameUpdated",c)};da.prototype.jFf=function(c){this.removeHandler("FAFunctionNameUpdated",c)};da.prototype.oge=function(c){this.addHandler("FAParameterSelectionChangedOld",c)};da.prototype.LFf=function(c){this.removeHandler("FAParameterSelectionChangedOld",
c)};da.prototype.nge=function(c){this.addHandler("FAParameterSelectionChanged",c)};da.prototype.KFf=function(c){this.removeHandler("FAParameterSelectionChanged",c)};da.prototype.Wrg=function(c){this.addHandler("DC",c)};da.prototype.QTi=function(c){this.removeHandler("DC",c)};da.prototype.get_visible=function(){return this.visible};da.prototype.set_visible=function(c){c||this.dismiss();return this.visible=c};da.prototype.dismiss=function(){this.visible=!1;this.formulaAssistanceUIControl&&(this.Hr=
null,this.formulaAssistanceUIControl.dismiss(this.domElement),this.yja=null,this.Aq.canReceiveFocus=!1)};da.prototype.show=function(c,k){var D=this;this.visible=!0;this.cPc();var ba=this.pxd(c);this.formulaAssistanceUIControl&&(Jb.instance.WE("argumentAssistanceRender"),c={},c.zoomLevel=wb(this.$),this.formulaAssistanceUIControl.updateContext(c),ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Hr=function(){D.formulaAssistanceUIControl.renderArgumentAssistanceCard(D.domElement,
k,ba)},this.Hr()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,k,ba),this.rwd(ba),this.Aq.canReceiveFocus=!0,Jb.instance.Pz("argumentAssistanceRender"))};da.prototype.dispose=function(){if(this.$){var c=ze.g(this.$);c&&(c.ga&&c.ga.CE(Object(xd.a)(this,this.$c,"onSelectionChanged")),c.view.Gr(Object(xd.a)(this,this.fq,"onGridScroll")))}Rf.a.Fa(this.Aq);this.$=null};da.prototype.cPc=function(){var c=ze.g(this.$).Yi;c.dAa.contains(this)||c.dAa.add(this)};da.prototype.$c=
function(){this.set_visible(!1)};da.prototype.pxd=function(c){var k=new Fa;k.functionRenderingInfo=c;k.cardMode=this.vS;this.ZAd(k);return k};da.prototype.ZAd=function(c){c.callbacks=new eb;c.callbacks.onHelpLink=this.S9c(c.functionRenderingInfo);c.callbacks.onCardModeChange=Object(xd.a)(this,this.onCardModeChange,"onCardModeChange");c.callbacks.onFeedback=Object(xd.a)(this,this.NOa,"sendCardFeedback");this.O$&&(c.callbacks.onDismissClick=Object(xd.a)(this,this.onDismissClick,"onDismissClick"))};
da.prototype.S9c=function(c){var k=this;return function(){ic(k.$,c.helpID,c.isUDF)}};da.prototype.onCardModeChange=function(c){this.VJb(c);1===c?Jb.instance.Cha.argumentAssistanceCollapseCounter++:Jb.instance.Cha.argumentAssistanceExpandCounter++};da.prototype.NOa=function(c){var k={};k[xe.a.lha]="ArgumentAssistanceCard";var D={};D.FunctionName=c.functionName;k[xe.a.i5c]=D;this.$.De(802602464,0,8,k)};da.prototype.CHd=function(){var c=tf.a.get(xe.a.CWb);af.a.ma(c)?this.vS=da.p0c:this.vS=parseInt(c);
Jb.instance.YMf(this.vS)};da.prototype.fq=function(){void 0!==this.Hr&&null!==this.Hr&&this.Hr()};da.prototype.rwd=function(c){var k=c.functionRenderingInfo.functionName;af.a.ma(this.yja)||!af.a.equals(this.yja,k,!0)?(this.yja=k,c=ih.a.map(c.functionRenderingInfo.signatures,function(D){return D.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new lb(k,c))):(k=ih.a.map(c.functionRenderingInfo.signatures,function(D){var ba="";0<=D.signatureParams.activeParam&&D.signatureParams.activeParam<
D.signatureParams.params.length&&(ba=D.signatureParams.params[D.signatureParams.activeParam]);return ba}),this.raiseEvent("FAParameterSelectionChanged",new ha(k)))};da.prototype.onDismissClick=function(){Jb.instance.Cha.argumentAssistanceDismissCounter++;this.dismiss();this.raiseEvent("DC");ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!this.vS&&this.VJb(1)};da.prototype.VJb=function(c){this.vS=c;try{tf.a.Uv(xe.a.CWb,c.toString(),
oi.AFrame.Mca)}catch(k){ed.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",k.message)}};da.SHa=function(){return document.createElement("div")};da.p0c=0;Object(qd.a)(da,"FormulaArgumentAssistanceControl",Oh.a,[727]);var pj=Oh.a;Em(V,pj);V.prototype.ufe=function(c){this.addHandler("FACardOpened",c)};V.prototype.iFf=function(c){this.removeHandler("FACardOpened",c)};V.prototype.tfe=function(c){this.addHandler("FAFocusOnSmartSuggestionsCard",
c)};V.prototype.hFf=function(c){this.removeHandler("FAFocusOnSmartSuggestionsCard",c)};V.prototype.dispose=function(){if(this.$){var c=ze.g(this.$);c&&(c.ga&&c.ga.CE(Object(xd.a)(this,this.$c,"onSelectionChanged")),c.view.Gr(Object(xd.a)(this,this.fq,"onGridScroll")));this.$.va&&this.$.va.zg(Object(xd.a)(this,this.Ai,"onActiveSheetChanged"))}this.Uia&&Rf.a.Fa(this.Aq);this.$=null};V.prototype.Irg=function(c){this.addHandler("CVIC",c)};V.prototype.CTi=function(c){this.removeHandler("CVIC",c)};V.prototype.get_visible=
function(){return this.visible};V.prototype.set_visible=function(c){c||this.dismiss();return this.visible=c};V.prototype.Vh=function(c,k){if(!this.get_visible())return!1;this.P$&&this.Gvc(k);if(this.aM){if(125627505===k||this.mhd&&267796030===k)return this.qYa(this.tw.items[this.i_].textEdit),!this.mhd;if(1872288872===k)return this.Hba(),this.set_visible(!1),!0;if(!this.mhd&&267796030===k)this.Hba();else if(this.eCi&&(-798660877===k||137938150===k))return!1}c=!1;switch(k){case 1872288872:this.set_visible(!1);
c=!0;break;case -798660877:this.bcb(this.Nsb(this.i_+1));c=!0;break;case 137938150:this.bcb(this.Nsb(this.i_-1));c=!0;break;case 2091832999:this.bcb(this.Nsb(this.i_+8));c=!0;break;case 742457698:this.bcb(this.Nsb(this.i_-8));c=!0;break;case 125627505:this.qYa(this.tw.items[this.i_].textEdit);c=!0;break;case 267796030:ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.qYa(this.tw.items[this.i_].textEdit),c=!0)}return c};V.prototype.show=function(c){this.pb=
ze.g(this.$).Yi;this.visible=!0;this.cPc();this.i_=0;this.tw=c;0<this.tw.items.length&&(this.render(),this.bcb(this.Nsb(this.i_)),1===this.tw.items[0].type&&this.Hhd&&(this.xab=!0))};V.prototype.dismiss=function(){this.visible=!1;this.P$&&this.ond();this.aM&&this.pb.isEditing&&this.Hba();this.Hr=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Uia&&(this.Aq.canReceiveFocus=!1))};V.prototype.Hba=function(){this.Zda=!1;this.pb.aAe()};V.prototype.render=
function(){var c=this;Jb.instance.WE("autoCompleteRender");if(this.formulaAssistanceUIControl){var k={};k.zoomLevel=wb(this.$);this.formulaAssistanceUIControl.updateContext(k);this.Hr=function(){c.formulaAssistanceUIControl.renderAutoCompleteMenu(c.domElement,c.pb.textBox.domElement,c.I9c())};this.Hr();this.Uia&&(this.Aq.canReceiveFocus=!0);Jb.instance.Pz("autoCompleteRender")}};V.prototype.Ybd=function(){this.fKa&&this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};V.prototype.cPc=function(){this.pb.dAa.contains(this)||
this.pb.dAa.add(this)};V.prototype.qYa=function(c){this.pb&&this.get_visible()&&(this.Hfd(this.pb.text,c),this.pb.textBox.caretPosition=c.range.start.character+c.newText.length,this.aM&&(this.Zda=!1,this.Hhd&&(this.$Hb=!0),this.pb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0)),this.set_visible(!1),this.raiseEvent("CVIC"))};V.prototype.I9c=function(){var c=new La;c.completionItems=this.tw.items;c.activeItemIndex=this.i_;this.XAd(c);return c};V.prototype.XAd=function(c){c.callbacks=
new na;c.callbacks.onCompletionItemSelected=Object(xd.a)(this,this.Zsd,"onCompletionItemHovered");c.callbacks.onCompletionItemCommitted=Object(xd.a)(this,this.Ysd,"onCompletionItemClicked");c.callbacks.onFeedback=Object(xd.a)(this,this.NOa,"sendCardFeedback");ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(c.callbacks.onDismiss=Object(xd.a)(this,this.dismiss,"dismiss"))};V.prototype.NOa=function(){var c={};c[xe.a.lha]="FunctionSuggestions";this.$.De(802602464,
0,8,c)};V.prototype.Gxd=function(c){this.Zda=!0;var k=c.textEdit.newText;this.pb.jab(k.substring(this.pb.text.length-c.textEdit.range.start.character,k.length))};V.prototype.bcb=function(c){var k=this.i_;this.i_=c;var D=this.tw.items[c];this.aM&&this.Hba();k!==c&&this.render();1===D.type&&ae.EwaSettings.Zcc()&&!af.a.contains(ze.g(this.$).Yi.text,"\n",!1)&&(this.Gxd(D),this.Hhd&&(this.aIb=!0))};V.prototype.Zsd=function(c,k){this.bcb(k);this.P$&&(this.rGa=!0)};V.prototype.Nsb=function(c){return 0>c?
0:Math.min(c,this.tw.items.length-1)};V.prototype.$c=function(){this.set_visible(!1)};V.prototype.Ysd=function(c){this.P$&&(this.oGa=!0);this.qYa(c.textEdit)};V.prototype.Hfd=function(c,k){this.pb.text=c.substring(0,k.range.start.character)+k.newText+c.substring(k.range.end.character,c.length);ze.g(this.$).nj&&(ze.g(this.$).Gc.text=this.pb.text)};V.prototype.Ai=function(){this.dismiss()};V.prototype.fq=function(){void 0!==this.Hr&&null!==this.Hr&&this.Hr()};V.prototype.ond=function(){this.qGa&&(Jb.instance.t1.selectByArrowKeyCounter++,
this.qGa=!1);this.rGa&&(Jb.instance.t1.selectByMouseHoverCounter++,this.rGa=!1);this.pGa&&(Jb.instance.t1.commitByTabKeyCounter++,this.pGa=!1);this.nGa&&(Jb.instance.t1.commitByEnterKeyCounter++,this.nGa=!1);this.oGa&&(Jb.instance.t1.commitByMouseClickCounter++,this.oGa=!1)};V.prototype.Gvc=function(c){switch(c){case -798660877:case 137938150:case 2091832999:case 742457698:this.qGa=!0;break;case 125627505:this.pGa=!0;break;case 267796030:ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",
!1)&&(this.nGa=!0)}};V.SHa=function(){return document.createElement("div")};Ll.Object.defineProperties(V.prototype,{aM:{configurable:!0,enumerable:!0,get:function(){return this.Zda}},eCi:{configurable:!0,enumerable:!0,get:function(){return 1===this.tw.items.length&&1===this.tw.items[0].type}}});Object(qd.a)(V,"FormulaAutoCompleteControl",Oh.a,[729,6,693]);Object(qd.a)(Y,"FunctionSuggestionAndArgumentAssistanceRequest",null,[]);N.prototype.dispose=function(){if(this.$){var c=ze.g(this.$);c&&c.ga&&
Xg.a.aja()&&c.ga.Nxa(Object(xd.a)(this,this.mh,"onActiveCellChanged"))}this.O$&&(ze.g(this.$).uc.Fr(Object(xd.a)(this,this.pj,"onEditEnded")),this.DBa.QTi(Object(xd.a)(this,this.Njf,"onArgumentAssistanceDismissClick")));this.o7.CTi(Object(xd.a)(this,this.Wjf,"onAutoCompleteCommitValueIntoCell"));this.functionInfoManager&&this.functionInfoManager.bnc(Object(xd.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded"));Rf.a.Fa(this.DBa);Rf.a.Fa(this.o7);this.o7=this.DBa=this.functionInfoManager=this.$=
null};N.prototype.NYi=function(){this.bLa=-1;this.cLa=null};N.prototype.cla=function(c){var k=this;if(27!==(void 0===c?0:c)){if(this.T2a&&(Jb.instance.Elb.formulaAssistanceRequestAttemptedCounter++,!this.bej())){Jb.instance.Elb.formulaAssistanceRequestOptimizedCounter++;return}this.functionInfoManager.O3||this.functionInfoManager.Spb({});var D=ze.g(this.$).Yi;c=D.text;D=D.textBox.caretPosition;!this.O$||this.CPa?this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance(Object.assign(new Y,
{functionSuggestion:Object.assign(new ca,{content:c,caretPosition:D}),argumentAssistance:Object.assign(new Ga,{content:c,caretPosition:D})})).then(function(ba){ba.kind||(ba.payload.argumentAssistance&&ze.g(k.$).Yi.isEditing?(k.pzb&&k.k4&&ed.ULS.sendTraceTag(537162004,0,15,"FormulaAssistanceControl.AssistFormulaDraw RequestArgumentAssistance called after lastNotifyActiveCellChangedFailed"),k.DBa.show(ba.payload.argumentAssistance,ze.g(k.$).Yi.textBox.domElement)):k.DBa.dismiss(),ba.payload.functionSuggestion&&
ze.g(k.$).Yi.isEditing?k.o7.show(ba.payload.functionSuggestion):k.o7.dismiss());return null}):this.pluginScheduler.requester().functionSuggestion(Object.assign(new ca,{content:c,caretPosition:D})).then(function(ba){ba.kind||(ba.payload&&0<ba.payload.items.length?k.o7.show(ba.payload):k.o7.dismiss());return null})}};N.prototype.Vh=function(){this.cla();return!1};N.prototype.bej=function(){var c=ze.g(this.$).Yi,k=c.text;c=c.textBox.caretPosition;if(this.o7.get_visible()&&af.a.equals(k,this.cLa,!0)&&
c===this.bLa)return!1;this.cLa=k;this.bLa=c;return!0};N.prototype.dFd=function(){this.pluginScheduler.requester().runExperiment(new Z)};N.prototype.mh=function(){ze.g(this.$).isEditing||ze.g(this.$).li||this.ozb()};N.prototype.ozb=function(){var c=ze.g(this.$).ga.wa.activeCell;if(c){var k=this.calcManager.ira(c);if(k){var D=this.$.va,ba=k.sheet.index;ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5726798_FixNotifyActiveCellChangedSheetIDAccess")&&(0>=D.count||0>ba||ba>=D.count)?(ed.ULS.sendTraceTag(537162001,
0,15,"FormulaAssistanceManager.NotifyActiveCellChanged InvalidSheetIndex. sheetCount: {0} sheetIndex: {1}.",D.count,ba),this.k4=!0):(this.k4=!1,ba=D=null,this.pzb&&void 0!==this.calcManager&&null!==this.calcManager&&(c=ze.g(this.$).Ca.qr(c))&&(c=this.calcManager.B$c(c.numberFormatIndex),void 0!==c&&null!==c&&(D=c.FormatString,ba=c.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new ra,{colIndex:k.range.col,rowIndex:k.range.row,sheetIndex:this.$.va.getItem(k.sheet.index).sheetId,
docName:k.sheet.document.name,docPath:k.sheet.document.path,formatString:D,builtIn:ba})))}else ed.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null"),this.k4=!0}else ed.ULS.sendTraceTag(537162003,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged active cell range is null"),this.k4=!0};N.prototype.onFunctionInfoLoaded=function(){this.Nyj();this.cla()};N.prototype.Nyj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.r7c)};
N.prototype.sfd=function(){ze.g(this.$).ga.Tpa(Object(xd.a)(this,this.mh,"onActiveCellChanged"));this.ozb();this.dFd();this.o7.Irg(Object(xd.a)(this,this.Wjf,"onAutoCompleteCommitValueIntoCell"));this.cla()};N.prototype.Njf=function(){this.CPa=!1};N.prototype.Wjf=function(){this.cla()};N.prototype.pj=function(){this.CPa=!0};Ll.Object.defineProperties(N.prototype,{HHa:{configurable:!0,enumerable:!0,get:function(){return this.o7}},mMe:{configurable:!0,enumerable:!0,get:function(){return this.DBa}}});
Object(qd.a)(N,"FormulaAssistanceManager",null,[691,6]);var hi=oe.a;Em(G,hi);G.prototype.create=function(){var c=this,k=Xg.a.aja(),D=ae.EwaSettings.ka(386),ba=ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),Ba=Xg.a.RY(this.$),nb=this.$.ea,Rb=Ba?pg.Task.Ra(null):Wg.GetServiceTaskFactory.create(nb,134,this.la,this.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),Ic=Ba?pg.Task.Ra(null):Wg.GetServiceTaskFactory.Va(this.$.ea,12,477,this.rb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory");
var Wc=Xg.a.ZL(this.$)?Wg.GetServiceTaskFactory.create(this.$.ea,449,this.$.la,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFormulaAssistanceUIControl"):pg.Task.Ra(null);var Rd=Xg.a.aja()?Wg.GetServiceTaskFactory.create(this.$.ea,414,this.$.la,1,"Microsoft.Office.Excel.WebUI.Client.IPluginScheduler"):pg.Task.Ra(null);if(ba||k){var Ge=Wg.GetServiceTaskFactory.Va(nb,266,265,this.rb,"Microsoft.Office.Excel.WebUI.Client.Calc.ICalcManager"),df=Wg.GetServiceTaskFactory.Va(nb,219,220,this.rb,
"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFormulaAssistanceReadoutHandler");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([Ge,Rd,Wc,df],this.la),function(){var Pg=nb.Ba(19)||new Na(c.$,Rd.result),Bg=df.result;if(Ba){var qh=nb.Ba(464);qh||(qh=new N(c.$,Pg,Ge.result,Rd.result,Wc.result),Bg.IRc(qh.mMe),Bg.JRc(qh.HHa))}else qh=nb.Ba(221),qh||(qh=new U(c.$,Pg,Rb.result,Ge.result,null,Ic.result,Wc.result,Rd.result),Bg.IRc(qh.nMe),Bg.wke(qh.GMe),Bg.JRc(qh)),D&&(nb.Ba(317)||new oc(c.$));c.Eb(Pg)},
this.la,3)}else{var Wf=Wg.GetServiceTaskFactory.Va(nb,219,220,this.rb,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFormulaAssistanceReadoutHandler");Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([Wf,Wc,Rd],this.la),function(){var Pg=nb.Ba(19)||new Na(c.$,Rd.result),Bg=Wf.result,qh=nb.Ba(221);qh||(qh=new U(c.$,Pg,Rb.result,null,null,Ic.result,Wc.result,Rd.result),Bg.IRc(qh.nMe),Bg.wke(qh.GMe),Bg.JRc(qh));D&&(nb.Ba(317)||new oc(c.$));c.Eb(Pg)},this.la,3)}};G.ja=function(c){c.ea.Ia(153,new G(c))};
Object(qd.a)(G,"FunctionInfoManagerFactory",oe.a,[]);var Vh=b(194),zh=b(74),pi=b(113);W.prototype.dQe=function(){return pi.a(bh.a.Qa,this.startTime)};Object(qd.a)(W,"OngoingAction",null,[]);var Ei=zh.a;Em(fa,Ei);fa.prototype.fCb=function(c){ed.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Hja,this.GJa,this.O2a);this.Mkb=this.Tmg.Kkb(c,this.Mkb);this.Sfd()};fa.prototype.dispose=function(){this.documentVisibilityObserver&&
this.documentVisibilityObserver.dEb(Object(xd.a)(this,this.wwa,"onDocumentUnhidden"));this.Boe();Ei.prototype.dispose.call(this)};fa.prototype.$Of=function(c){this.rTc?(this.HMa=c?new W:null,c?this.startTimer():this.Boe()):this.HMa=c?{}:null};fa.prototype.XKe=function(c){c=void 0===c?null:c;this.rTc&&c&&c.tJ?ed.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.Hja):(ed.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
this.Hja,this.GJa,this.O2a),this.$Of(!1),this.Sfd())};fa.prototype.Ayi=function(){var c=this.HMa.dQe();ed.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",this.Hja,c);c=Math.max(this.dne-c,0);this.Gjc=Cc.a.instance.create(Object(xd.a)(this,this.rka,"onTimeout"),c,cd.a.ice)};fa.prototype.rka=function(){ed.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",
this.Hja,this.HMa.dQe(),this.O2a);this.sTc++;this.sTc>this.cne&&ed.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",this.Hja);this.HMa.xw.C();this.XKe()};fa.prototype.wwa=function(){this.O2a&&ed.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Hja,this.GJa,this.O2a);this.Sfd()};fa.prototype.Sfd=function(){var c=this;if(!this.IPa()){var k=this.Mkb;this.Mkb=
null;this.$Of(!0);ed.ULS.sendTraceTag(537153857,0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.Hja);var D=this.rTc?this.HMa.xw.token:Vh.a.none;Kf.TaskExtensions.Aa(this.Smg.eCb(k),function(){c.XKe(D)},D,0,this.pN)}};fa.prototype.IPa=function(){return!this.O2a||this.GJa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.aj?(ed.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.Hja),
!0):!1};fa.prototype.Boe=function(){this.Gjc&&this.Gjc.cancel()};fa.prototype.startTimer=function(){this.sTc<=this.cne&&(this.Gjc=Cc.a.instance.create(Object(xd.a)(this,this.Ayi,"onRunningLong"),this.QFg,cd.a.ice))};Ll.Object.defineProperties(fa.prototype,{GJa:{configurable:!0,enumerable:!0,get:function(){return!!this.HMa}},O2a:{configurable:!0,enumerable:!0,get:function(){return!!this.Mkb}}});Object(qd.a)(fa,"ActionAggregator",zh.a,[748,6]);var Wi=b(121),kj=eg.a;Em(aa,kj);aa.prototype.Usg=function(c){this.addHandler("KBIS",
c)};aa.prototype.BUi=function(c){this.removeHandler("KBIS",c)};aa.prototype.dispose=function(){this.firstElement&&vc.a.removeHandler(this.firstElement,qf.a.focus,Object(xd.a)(this,this.Rmf,"onFirstElementFocused"));this.Nr&&this.Nr.detach("focus");this.Un&&(vc.a.removeHandler(this.Un,qf.a.focus,Object(xd.a)(this,this.Gof,"onLastElementFocused")),vc.a.removeHandler(this.Un,qf.a.blur,aa.onBlur),ek.KeyInputManager.instance.za(qf.a.Qb,this.Un,Object(xd.a)(this,this.Hof,"onLastElementKeyDown")));ek.KeyInputManager.instance.za(qf.a.Qb,
this.$.domElement,Object(xd.a)(this,this.guf,"onWorkbookKeyDown"));this.Nr=this.Un=this.firstElement=this.$=null;kj.prototype.dispose.call(this)};aa.prototype.bUg=function(){this.tcj?(this.firstElement=document.documentElement,this.Nr=Wi.a.instance.BB(document.parentWindow),this.Nr.ja("focus",Object(xd.a)(this,this.OBi,"onWindowFocused"))):(this.firstElement=aa.wve(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),vc.a.addHandler(this.firstElement,qf.a.focus,Object(xd.a)(this,
this.Rmf,"onFirstElementFocused")))};aa.prototype.$Ug=function(){this.Un=aa.wve();this.Un.id=xe.a.vCe;this.Un.setAttribute(xe.a.fv,de.a.instance.da(824));document.body.appendChild(this.Un);vc.a.addHandler(this.Un,qf.a.focus,Object(xd.a)(this,this.Gof,"onLastElementFocused"));vc.a.addHandler(this.Un,qf.a.blur,aa.onBlur);ek.KeyInputManager.instance.pa(qf.a.Qb,this.Un,Object(xd.a)(this,this.Hof,"onLastElementKeyDown"))};aa.prototype.Hof=function(c){var k=c.Ea.keyCode;return k===gd.a.Ph?this.Ari():k===
gd.a.PC&&c.Ea.shiftKey?this.rjh(this.firstElement):!1};aa.prototype.rjh=function(c){this.UZf(c);return!1};aa.prototype.Ari=function(){this.eKa=!0;ze.g(this.$).focus();ze.g(this.$).ga.EXe();this.raiseEvent("KBIS");return!0};aa.prototype.guf=function(c){var k=this;if(!this.eKa||c.Ea.keyCode!==gd.a.AN)return!1;aa.p_e();pg.Task.delay(1).CWRCC(function(){k.Un.focus();return!0},this.la);return!0};aa.prototype.OBi=function(){var c=this;document.activeElement&&document.activeElement.id===this.Un.id||(aa.p_e(),
pg.Task.delay(1).CWRCC(function(){c.Un.focus();return!0},this.la))};aa.prototype.Rmf=function(){this.UZf(this.Un)};aa.prototype.Gof=function(c){c.stopPropagation();c.preventDefault();this.eKa&&(this.eKa=!1)};aa.prototype.UZf=function(c){this.eKa?this.eKa=!1:(this.eKa=!0,c&&c.focus())};aa.wve=function(){var c=document.createElement("div");c.tabIndex=0;return c};aa.p_e=function(){document.body.classList.add(ia.a.SEe)};aa.onBlur=function(){document.body.classList.remove(ia.a.SEe)};Object(qd.a)(aa,"EmbedViewFocusControl",
eg.a,[746,6]);var zj=b(59),Hj=b(523),hj=eg.a;Em(L,hj);L.prototype.sPc=function(c){this.addHandler("FieldInfoListContextLoaded",c)};L.prototype.eCd=function(c){this.removeHandler("FieldInfoListContextLoaded",c)};L.prototype.dispose=function(){this.ub=null;this.$nc();hj.prototype.dispose.call(this)};L.prototype.f3=function(c,k,D,ba){ba=void 0===ba?null:ba;if(c){this.nUc();var Ba=null,nb=!1,Rb;if(Rb=!ba)Rb=this.Xsj(c,k,D),nb=Rb.VBb,Ba=Rb.ol,Rb=Rb.returnValue;if(Rb&&(Ba&&ed.ULS.sendTraceTag(25264348,
0,50,"Retrieved {0} rich value field contexts from block cache",Ba.length),this.XGc=!0,(this.x0=Ba)&&0<this.x0.length&&(this.lPb=!0,this.gAf()),!nb))return;this.G2f(c,ba,k,D,!1)}};L.prototype.G2f=function(c,k,D,ba,Ba){if(this.$.fa.lc){this.$.Vb&&(this.PEb=this.$.Vb.Dc("WebServiceCall","GetRichValueFieldInfoListContext"));this.asb=null;var nb=this.$.ra.ua.Wb(),Rb=this.$.ra.ua,Ic=Object(xd.a)(this,this.Usi,"onGetFieldListContextListSucceeded"),Wc=Object(xd.a)(this,this.Tsi,"onGetFieldListContextListFailed"),
Rd=Rb.Na(1,null);Rd.selectedRange=c;Rd.richValueKeyPath=k;Rd.singleColumn=D;Rd.searchForRange=ba;Rd.calculateMajorityDataType=Ba;this.asb=hg.i(Rb,"GetRichValueFieldListContextList",Rd,Ic,Wc,null,nb,4)}else this.x0=null};L.prototype.$nc=function(){this.x0=null;this.lPb=!1;this.nUc();this.asb=null};L.prototype.nUc=function(){L.zYb(this.asb)};L.prototype.gAf=function(){this.raiseEvent("FieldInfoListContextLoaded")};L.prototype.zo=function(c){c=cf.D(c);--c.left;--c.right;return this.tableManager.zo(c)};
L.prototype.Xsj=function(c,k,D){var ba=null;var Ba=!1;if(c.SheetName!==this.$.fa.qa.sheetName)return{returnValue:!1,VBb:Ba,ol:ba};if(D){var nb=this.zo(c);if(!nb||!nb.bua)return{returnValue:!1,VBb:Ba,ol:ba};nb.top+=1;nb.right=cf.D(c).right-1}else nb=new Hj.AutofilterRange(c.FirstRow+1,c.FirstColumn+1,c.LastRow+1,c.LastColumn+1,null,null,null,0,!1);if(nb.top>nb.bottom||nb.left>nb.right)return{returnValue:!0,VBb:Ba,ol:ba};c=ze.g(this.$);var Rb=c.Wa.width,Ic=c.Wa.height,Wc=c.view.visibleArea;Rb=new zj.a(Wc.x-
Rb,Wc.y-Ic,Wc.width+Rb,Wc.height+Ic);Ic=c.Eg(nb);if(!Wc||!Ic||!c.Tcc(nb))return{returnValue:!1,VBb:Ba,ol:ba};Rb.contains(Ic)||(Ba=!0);c=nb.clone();if(D)for(D=nb.right,Wc=0;D>=nb.left;--D){if(c.left=D,c.right=D,Rb=this.rQe(c,!0,nb.left)){ba||(ba=[]);ba[Wc]=Rb;if(k)break;++Wc}}else if(k=this.rQe(c,!1))ba=[],ba[0]=k;return{returnValue:!0,VBb:Ba,ol:ba}};L.prototype.rQe=function(c,k,D){D=void 0===D?0:D;var ba=ze.g(this.$).$b.cHh(c),Ba=null;if(ba&&0<ba.count){var nb=Array(ba.count);Ba=0;ba=Ol(ba);for(var Rb=
ba.next();!Rb.done;Rb=ba.next()){var Ic={};Ic.Name=Rb.value;nb[Ba]=Ic;++Ba}ba="";Rb=-1;0<c.top&&k&&(c=new mi.Range(c.top-1,c.left,c.top-1,c.left,!1,!1),ba=ze.g(this.$).tc(c).originalText,Rb=c.left-D);Ba={};Ba.ColumnName=ba;Ba.ColumnIndex=Rb;Ba.FieldInfoDataList=nb}return Ba};L.prototype.Tsi=function(c,k,D){ed.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+D);this.PEb&&this.PEb.stop();this.x0=null};L.prototype.Usi=function(c){Hh.a(c)||(this.PEb&&this.PEb.stop(),
this.XGc=!1,(this.x0=c.Result)&&0<this.x0.length&&ed.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",this.x0.length),this.lPb=!0,this.gAf())};L.zYb=function(c){c&&Td.AFrameworkApplication.Cd.Ku(c.Tt)};Ll.Object.defineProperties(L.prototype,{Gbc:{configurable:!0,enumerable:!0,get:function(){return this.lPb}},wbi:{configurable:!0,enumerable:!0,get:function(){return this.XGc}},$:{configurable:!0,enumerable:!0,get:function(){return this.ub}},ol:{configurable:!0,
enumerable:!0,get:function(){return this.x0}},xzh:{configurable:!0,enumerable:!0,get:function(){return!!this.asb}}});Object(qd.a)(L,"FieldInfoManager",eg.a,[703,6]);Em(Q,L);Q.prototype.Hzh=function(c,k){this.LZa=k;ed.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",c.FirstRow,c.FirstColumn,c.LastRow,c.LastColumn);this.G2f(c,null,!0,!1,!0)};Q.prototype.Kmf=function(){this.eCd(Object(xd.a)(this,
this.Kmf,"onFilterFieldInfoListContextLoaded"));if(this.ol&&this.ol.length&&this.contextMenuManager){var c=this.contextMenuManager.J8c("autoFilterRichFieldList"),k=window.document.getElementById(this.LZa);c.lN(null,k,this,null,!0)}};Ll.Object.defineProperties(Q.prototype,{KF:{configurable:!0,enumerable:!0,get:function(){return this.d$f}}});Object(qd.a)(Q,"FilterInfoManager",L,[733,703,6]);S.Edh="ewa-sharedUi-launchButton";S.Gdh="ewa-sharedUi-launchButtonWithText";S.Fdh="ewa-sharedUi-launchButtonClick";
S.Hdh="ewa-sharedUi-launchButtonWithTextClick";Object(qd.a)(S,"CssClassNames",null,[]);var uk=b(281),hk=Oh.a;Em(H,hk);H.prototype.k1=function(c){this.addHandler(this.nCb,c)};H.prototype.Jba=function(c){this.get_events().removeHandler(this.nCb,c)};H.prototype.ktg=function(c){this.addHandler("OnObjectButtonMouseOver",c)};H.prototype.RUi=function(c){this.get_events().removeHandler("OnObjectButtonMouseOver",c)};H.prototype.jtg=function(c){this.addHandler("OnObjectButtonMouseOut",c)};H.prototype.QUi=function(c){this.get_events().removeHandler("OnObjectButtonMouseOut",
c)};H.prototype.M1f=function(c){af.a.ma(c)||(this.rXa.innerHTML=c)};H.prototype.dwj=function(c,k,D){this.rXa.innerHTML="";c?c.I$(k,16,16,this.rXa,16,16,void 0,D):ed.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};H.prototype.ewj=function(c,k){af.a.ma(c)||(this.XIb.innerText=c);this.domElement.title=k};H.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.rc.GB(),Rf.a.mc([this.ZX,this.jXa]),$f.a.instance.za(qf.a.click,this.domElement,
Object(xd.a)(this,this.Rc,"onClick")),Rj.a.instance.za(qf.a.pointerDown,this.domElement,Object(xd.a)(this,this.yM,"onElementPointerDown")),this.SPa&&this.SPa.dispose(),hk.prototype.dispose.call(this))};H.prototype.v9a=function(){af.a.ma(this.rZb)||this.domElement.classList.remove(this.rZb);af.a.ma(this.Zgc)||this.domElement.classList.add(this.Zgc)};H.prototype.mCb=function(){af.a.ma(this.Zgc)||this.domElement.classList.remove(this.Zgc);af.a.ma(this.rZb)||this.domElement.classList.add(this.rZb);this.$Za()};
H.prototype.$Za=function(){this.kdc&&(this.SPa.cancel(),this.aWf(),this.setOpacity(1));this.set_visible(!0)};H.prototype.wn=function(c,k,D,ba,Ba){Ba=void 0===Ba?!1:Ba;c=De.a(ba).ri(c);k=De.a(ba).ri(k);De.a(ba).Jqc(this.domElement);this.domElement.style.top=Gb.HelperMethods.Pb(k);this.domElement.style.left=this.domElement.style.right="";k=c;Ba&&(k=c-this.domElement.offsetWidth);td.c(this.domElement.style,D,Gb.HelperMethods.Pb(k));this.set_visible(!0);this.setOpacity(1);this.kdc&&(this.iLd=!1,this.mlj(),
this.SPa.kq())};H.prototype.hide=function(){this.v9a();this.set_visible(!1);this.kdc&&(this.aWf(),this.SPa.cancel())};H.prototype.Ppb=function(){this.rc.ja("mouseover",Object(xd.a)(this,this.pE,"onMouseOver"),!0);this.rc.ja("mouseout",Object(xd.a)(this,this.iH,"onMouseOut"),!0)};H.prototype.mlj=function(){this.ZX.Zz("mousemove")||this.ZX.ja("mousemove",Object(xd.a)(this,this.vwa,"onDocumentMouseMove"))};H.prototype.aWf=function(){this.ZX.Zz("mousemove")&&this.ZX.detach("mousemove")};H.prototype.pcd=
function(c){if(this.domElement.parentNode){var k=Sys.UI.DomElement.getBounds(this.domElement),D=new Sys.UI.Point(Math.round(k.x+k.width),Math.round(k.y+k.height));k=Math.abs(D.x-c.x);c=Math.abs(D.y-c.y);c=k>c?k:c;this.iLd?this.setOpacity(H.QGg(c)):100>=c&&this.vce()}};H.prototype.vce=function(){this.iLd=!0;this.SPa.cancel()};H.prototype.pE=function(){this.raiseEvent("OnObjectButtonMouseOver")};H.prototype.iH=function(){this.raiseEvent("OnObjectButtonMouseOut")};H.prototype.setOpacity=function(c){Qh.a.setOpacity(this.domElement,
c);this.T$e=bh.a.Qa.Gb};H.prototype.vij=function(){this.vce()};H.prototype.Rc=function(c){this.raiseEvent(this.nCb,c);this.mCb();return!0};H.prototype.vwa=function(c){100<pi.a(bh.a.Qa,this.T$e)&&this.pcd(new Sys.UI.Point(Math.round(c.clientX),Math.round(c.clientY)))};H.prototype.yM=function(c){mg.g(c.Ea,!1);return!1};H.QGg=function(c){return 100>=c?1:250<=c?0:.01*(100-(c-100)/150*100)};Object(qd.a)(H,"OnObjectButton",Oh.a,[747,622,6]);var ij=b(906),uj=zh.a;Em(A,uj);A.prototype.dispose=function(){this.X3g();
this.$=null;uj.prototype.dispose.call(this)};A.prototype.getButton=function(c,k){return this.ita(c,void 0===k?!0:k)};A.prototype.ita=function(c,k){var D=c.toString();D in this.buttons||this.bVg(c,void 0===k?!0:k);return this.buttons[D]};A.prototype.wn=function(c,k,D,ba,Ba,nb){Ba=void 0===Ba?!0:Ba;nb=void 0===nb?!1:nb;this.hide();if(this.$.fa.isNamedObjectViewMode&&ch.i(this.$.qa)){var Rb=ze.g(this.$).$M.domElement,Ic=c+this.buttonWidth-Rb.scrollWidth;Rb=k+this.buttonWidth-Rb.scrollHeight;c=0<Ic?c-
Ic:c;k=0<Rb?k-Rb:k}this.ita(ba,Ba).wn(c,k,D,this.$,nb)};A.prototype.hide=function(){var c=this.buttons,k;for(k in c)c[k].hide()};A.prototype.Ppb=function(c,k){!this.Q_e&&(k=this.buttons[k.toString()])&&(this.xgc=function(D,ba){c(ba,!0)},k.ktg(this.xgc),this.wgc=function(D,ba){c(ba,!1)},k.jtg(this.wgc),this.Q_e=!0,k.Ppb())};A.prototype.bVg=function(c,k){function D(nb,Rb){ba.Hpi(Rb,c)}var ba=this;this.tua=String.format(this.sed===ia.a.a4b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':
'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',xg.a.Xf(this.sed),xg.a.Xf(this.qed),"{0}");var Ba=String.format(this.tua,xg.a.Xf(this.altText));k=new H(""===this.buttonText?S.Edh:S.Gdh,""===this.buttonText?S.Fdh:S.Hdh,ia.a.sB,Ba,k,this.nCb,this.buttonText,"ewa-sharedUi-launchButtonText");k.k1(D);this.buttons[c.toString()]=k;this.iEe[c.toString()]=D;Ba=ze.g(this.$).Mf(c);Ba.domElement.insertBefore(k.domElement,Ba.domElement.firstChild)};A.prototype.X3g=function(){for(var c=Ol(ij.a(this.buttons)),
k=c.next();!k.done;k=c.next()){k=k.value;var D=this.buttons[k];D.Jba(this.iEe[k]);Rf.a.Fa(D);delete this.buttons[k];this.xgc&&D.RUi(this.xgc);this.wgc&&D.QUi(this.wgc)}};A.prototype.domElement=function(c){return this.ita(c).domElement};A.prototype.$Za=function(c){this.ita(c).$Za()};A.prototype.rKb=function(c,k,D){D=void 0===D?!0:D;this.tua=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',xg.a.Xf(this.sed),xg.a.Xf(this.qed),"{0}");c=String.format(this.tua,
xg.a.Xf(c));this.ita(k,D).M1f(c)};A.prototype.iRa=function(c,k,D){this.ita(D,!1).ewj(c,k)};A.prototype.E2f=function(){var c=void 0===c?!1:c;this.tua=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",xg.a.Xf(this.qed),"{1}");var k=String.format(this.tua,void 0,xg.a.Xf(void 0));this.ita(void 0,c).M1f(k)};A.prototype.LQd=function(c,k,D){this.ita(D,!1).dwj(this.svgIconProvider,c,k)};Ll.Object.defineProperties(A.prototype,{ps:{configurable:!0,
enumerable:!0,get:function(){return De.a(this.$).VDa(wh.a.Qwi)}},WYb:{configurable:!0,enumerable:!0,get:function(){return wh.a.Pwi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return De.a(this.$).VDa(wh.a.Rwi)}}});Object(qd.a)(A,"OnObjectLaunchButton",zh.a,[732,6]);var ui=b(82),Ok=ui.a;Em(E,Ok);E.prototype.dispose=function(){Rf.a.Fa(this.Yxb);this.Yxb=null;Ok.prototype.dispose.call(this)};E.prototype.Vya=function(){Rf.a.Fa(this.Yxb);this.Yxb=Cc.a.instance.create(Object(xd.a)(this,this.display,
"display"),this.STh,cd.a.Abi)};E.prototype.jQa=function(){Rf.a.Fa(this.Yxb);this.hide()};Object(qd.a)(E,"LoadingIndicatorBehavior",ui.a,[720,6]);Em(J,E);J.prototype.dispose=function(){this.Xxb=null;E.prototype.dispose.call(this)};J.prototype.display=function(){this.wbg(this.Xxb)};J.prototype.hide=function(){this.gRh(this.Xxb)};J.prototype.bpg=function(){this.Xxb=document.createElement("div");this.domElement.appendChild(this.Xxb)};Object(qd.a)(J,"ShimmerLoadingIndicatorBehavior",E,[]);Em(y,E);y.prototype.dispose=
function(){this.tLa=null;E.prototype.dispose.call(this)};y.prototype.display=function(){Ne.DOMElementExtensions.setVisible(this.tLa,!0)};y.prototype.hide=function(){Ne.DOMElementExtensions.setVisible(this.tLa,!1)};y.prototype.apg=function(){this.tLa=document.createElement("div");this.tLa.classList.add(Ii.a.Ach);var c=document.createElement("div");c.classList.add(Ii.a.Bch);this.v_c&&""!=this.v_c&&c.classList.add(this.v_c);var k=this.Kbf?de.a.instance.da(this.Kbf):"",D=String.format('<div class="'+
Ii.a.Cch+'">{0}</div>',k);this.Y$b?(k=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.Y$b,k),c.innerHTML=k+D):c.innerHTML=D;this.tLa.appendChild(c);this.domElement.appendChild(this.tLa)};Object(qd.a)(y,"SpinnerLoadingIndicatorBehavior",E,[]);x.prototype.wZc=function(c,k,D){return new dk.a(c,k,D)};x.prototype.r0b=function(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd){return new Qa(c,k,D,ba,Ba,nb,Rb,Ic,Wc,Rd)};x.prototype.LYa=function(c,k,D,ba,Ba){return new y(c,k,D,ba,void 0===Ba?0:Ba)};x.prototype.L$c=
function(c){return c.ea.Ba(238)||new aa(c)};x.prototype.iob=function(c,k,D,ba,Ba,nb,Rb,Ic){return new A(c,k,D,ba,Ba,nb,Rb,void 0===Ic?"":Ic)};x.prototype.uve=function(c,k){return new L(c,k)};x.prototype.YTg=function(c,k,D,ba){return new Q(c,k,D,ba)};x.prototype.Unb=function(c,k,D,ba){return new fa(c,k,D,ba)};Object(qd.a)(x,"SharedUIControlsFactory",null,[682]);var Vk=oe.a;Em(z,Vk);z.prototype.create=function(){ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1)?this.Eb(this.$.ea.Ba(12)||
new x):this.Eb(new x)};z.ja=function(c){c.ea.Ia(477,new z(c))};Object(qd.a)(z,"SharedUIControlsFactoryServiceFactory",oe.a,[]);var Zk=b(1008),Pk=oe.a;Em(B,Pk);B.prototype.create=function(){var c=this;ed.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");Zk.a.then(this.zWg(),function(k){c.Eb(k);return!0})};B.prototype.zWg=function(){var c=this;if(this.EZc)return this.EZc;var k=Sb.a.OYa(ve.b(),Vh.a.none,"LoadResource","x10Scheduler loading");ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&
Qh.a.pu?k.setResult(excelOnlineCalc.PluginSchedulerSingletonGlobal.instance()):this.$.ea.$a(266,function(){c.$.ea.$a(283,function(D){var ba=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();D=sf.b(pg.Task.Ra(D.Cp));var Ba=excelOnlineCalc.x10.ensurePluginAttached(1,D),nb=excelOnlineCalc.x10.ensurePluginAttached(5,D),Rb=excelOnlineCalc.x10.ensurePluginAttached(1E3,D),Ic=excelOnlineCalc.x10.ensurePluginAttached(1002,D),Wc=excelOnlineCalc.x10.ensurePluginAttached(10,D),Rd=excelOnlineCalc.x10.ensurePluginAttached(11,
D),Ge=excelOnlineCalc.x10.ensurePluginAttached(1004,D);Ba=[Ba,nb,Rb,Ic,Wc,Rd,Ge];ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5818445_AttachDataTypesExperiment")&&(D=excelOnlineCalc.x10.ensurePluginAttached(1003,D),Ba.push(D));Promise.all(Ba).then(function(){c.$.ea.Ia(413,ba);k.setResult(ba)})})});return this.EZc=k.task};B.ja=function(c){c.ea.Ia(414,new B(c))};Object(qd.a)(B,"PluginSchedulerFactory",oe.a,[]);var vk=zh.a;Em(t,vk);t.prototype.dispose=function(){this.Zj.dispose();this.$=null;vk.prototype.dispose.call(this)};
t.prototype.domElement=function(c){return this.Zj.domElement(c)};t.prototype.getButton=function(c){return this.Zj.getButton(c,!1)};t.prototype.rKb=function(c,k){this.Zj.rKb(c,k,!1)};t.prototype.p_=function(c,k){var D=ze.g(this.$),ba=D.Wa.Bj(c);this.Zj.rKb(k?de.a.instance.da(1665):de.a.instance.da(1666),ba);k=this.isMac?k?de.a.instance.da(1669):de.a.instance.da(1670):k?de.a.instance.da(1667):de.a.instance.da(1668);var Ba=D.Eg(c,ba);c=D.Mf(ba).Wm;if(Ba&&0<=Ba.x&&0<=Ba.y){var nb=Ba.bottomRight.x+this.ps;
Ba=Ba.topLeft.y-this.ps-this.buttonWidth;if(Ba<c.topLeft.y+this.ps){if(D.Wa.uza){this.hide();return}Ba=c.topLeft.y+this.ps}this.wn(nb,Ba,D.rtl,ba);this.ariaLiveNotifier.CNa(k)}else this.hide()};t.prototype.wn=function(c,k,D,ba){this.Zj.wn(c,k,D,ba,!1)};t.prototype.hide=function(){this.Zj.hide()};Ll.Object.defineProperties(t.prototype,{ps:{configurable:!0,enumerable:!0,get:function(){return this.Zj.ps}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Zj.buttonWidth}}});Object(qd.a)(t,
"PulloutLaunchButton",zh.a,[]);var Ck=zh.a;Em(w,Ck);w.prototype.dispose=function(){this.gridView&&(this.gridView.ga.Nba(Object(xd.a)(this,this.Bh,"onSelectionEnded")),this.gridView.view.Gr(Object(xd.a)(this,this.fq,"onGridScroll")),this.gridView.Gc&&this.gridView.Gc.ym(Object(xd.a)(this,this.Rj,"onEditStarted")));if(this.$){var c=this.$;c.dl(Object(xd.a)(this,this.jd,"onWorkbookOpened"));c.Lo(Object(xd.a)(this,this.Pd,"onWorkbookClosing"));c.oH(Object(xd.a)(this,this.fk,"onContentAreaResized"));ze.g(c).Cs(Object(xd.a)(this,
this.oQ,"onGridContentReady"))}this.Pl&&this.Pl.eCd(Object(xd.a)(this,this.kAb,"onFieldInfoListContextLoaded"));Rf.a.Fa(this.og);this.Pl=this.$=this.gridView=this.rlb=this.og=null;Ck.prototype.dispose.call(this)};w.prototype.zv=function(){this.og.hide()};w.prototype.Tba=function(){this.og?this.og.getButton(this.Uca).v9a():ed.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};w.prototype.kZi=function(){this.a_=null};w.prototype.Ryf=function(){this.og&&this.og.hide()};
w.prototype.RKh=function(){if(!this.Tbd||1!==this.selectedRange.width)return null;for(var c=this.selectedRange.clone();this.gridView.XY(c);){c.left+=1;c.right+=1;if(!this.gridView.Mf(this.gridView.Wa.Bj(c)).Hh.Ef(c))break;if(this.gridView.Ca.qr(c)){var k=this.gridView.mm("PulloutManager.GetValidatedRangeToFill",c,2);try{if(w.MAj(k))return c}finally{k&&k.dispose()}}}return null};w.prototype.Bh=function(){this.Cua&&(this.gridView?1===this.gridView.ga.Qe?(this.gridView.ga.wa.activeCell.equals(this.wDa)||
this.gM||this.zv(),this.rlb.kq()):this.zv():ed.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};w.prototype.Rj=function(){this.zv()};w.prototype.jd=function(){this.TV()};w.prototype.Pd=function(){this.zv()};w.prototype.Rc=function(){this.showCallout()};w.prototype.kAb=function(){if(this.Pl.ol&&this.Pl.ol.length)if(this.oTc)this.Pl.wbi||(this.Ryc=this.Pl.ol[0].BlockingDataForExpand),this.Pl.xzh&&ed.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),
this.showCallout();else if(this.gridView.ga.wa.xh){var c=this.gridView.ga.wa.activeCell;if(c&&this.a_){var k=this.tableManager.zo(c);this.SFc=!!k;var D=this.gridView.ga.wa.Nd;k=this.gM&&this.a_.$d(k);var ba=this.Tbd&&!this.gM&&D.equals(this.selectedRange);k||ba?(ed.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.U4b=!0,ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.gM&&this.tableManager.wIa(c)?ed.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gM?this.og.p_(this.a_,this.gM):this.og.p_(D,this.gM):this.og.p_(this.a_,this.gM),this.Znc())):ed.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};w.prototype.Znc=function(){this.Pl.$nc()};w.prototype.showCallout=function(){var c=this;this.Cua&&(this.Pl.Gbc?(this.og.getButton(this.Uca).mCb(),ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1)?Kf.TaskExtensions.Aa(Wg.GetServiceTaskFactory.Va(this.$.ea,8,9,0,"Microsoft.Office.Excel.WebUI.Client.IContextMenuManager"),function(k){c.ISf(k.result)},this.$.la,3):this.ISf(this.contextMenuManager)):(this.oTc=!0,this.f3()))};w.prototype.ISf=function(c){c.J8c("tableFieldList").lN(null,this.og.domElement(this.Uca),this.Pl,null,!0);this.Znc()};w.prototype.fk=function(){this.F3a()&&this.og.hide();1===this.gridView.ga.Qe&&this.TV()};w.prototype.oQ=function(){var c=this.gridView.ga.Qe;this.gridView.ga.wa.activeCell&&
1===c&&this.TV()};w.prototype.fq=function(){if(ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.gM){if(this.a_&&this.wDa){var c=this.tableManager.zo(this.wDa);c&&1<c.bottom-c.top&&(--c.bottom,this.gridView.XY(c)&&this.rlb.kq())}}else this.gridView.ga.wa.xh&&this.gridView.XY(this.gridView.ga.wa.Nd)&&this.rlb.kq();else this.a_&&this.wDa&&this.gM&&(c=this.tableManager.zo(this.wDa))&&1<c.bottom-c.top&&(--c.bottom,this.gridView.XY(c)&&
this.rlb.kq())};w.prototype.TV=function(){if(this.$&&this.gridView){if(this.U4b&&this.gM){var c=this.gridView.ga.wa.activeCell;this.a_=this.NKe();var k=!!this.ipc&&this.ipc.contains(c);if(this.a_&&(c.equals(this.wDa)||k)){this.og.p_(this.a_,this.gM);return}}this.U4b=!1;(this.a_=this.NKe())&&this.jwa&&this.gridView&&this.gridView.Ca.qr(this.jwa)?(this.oTc=!1,this.f3()):this.Pl.nUc();this.U4b||this.og.hide()}};w.prototype.NKe=function(){if(!this.Cua||!this.gridView||this.gridView.ga.Pa.kc||!this.gridView.ga.wa.xh)return null;
var c=this.gridView.ga.wa.activeCell,k=ze.g(this.$).Wa.Bj(c);if(!c)return null;this.wDa=c.clone();var D=this.tableManager.zo(c);this.SFc=!!D;if(this.gM){this.og.rKb(de.a.instance.da(1665),k);this.yN=w.H4f(D);if(!this.yN)return null;k=this.tableManager.wue(D,this.gridView);c=k.vX;k=k.returnValue||c;this.Ryc=c;if(k)return this.ipc=new mi.Range(D.top,D.left,D.bottom,D.right,!1,!1),this.cIc=new mi.Range(this.yN.top,this.yN.right+1,this.yN.top,this.yN.right+1,!1,!1),this.yN}else if(this.Tbd){this.og.rKb(de.a.instance.da(1666),
k);this.OUa=this.gridView.ga.wa.Nd.clone();D=ze.g(this.$).$b.DKa(this.selectedRange);this.yN=w.H4f(this.selectedRange);if(!D||!this.yN||!this.selectedRange||ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.wIa(this.selectedRange))return null;this.cIc=this.RKh();if((ae.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.XY(this.selectedRange):this.gridView.XY(this.yN))&&this.jwa)return this.ipc=
this.yN,D=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.jwa?this.jwa.toString():"null",this.yN?this.yN.toString():"null",c?c.toString():"null"),ed.ULS.sendTraceTag(537154137,0,50,D),this.yN}return null};w.prototype.f3=function(){this.gM?this.Pl.f3(cf.v(this.jwa,this.$),!1,!0):ae.EwaSettings.ka(136)&&this.Pl.f3(cf.v(this.selectedRange,this.$),!0,!1)};w.prototype.F3a=function(){return this.$.fa.isNamedObjectViewMode&&ch.f(this.$.qa)};w.MAj=
function(c){for(;c.$$mn();)if(!af.a.ma(c.$$cu().text)||c.$$cu().cM||c.$$cu().aj||c.jn.bZe)return!1;return!0};w.H4f=function(c){return c.right===wh.a.zh?null:new mi.Range(c.top,c.right,c.top,c.right,!1,!1)};Ll.Object.defineProperties(w.prototype,{Ib:{configurable:!0,enumerable:!0,get:function(){return this.og.domElement(1)}},jwa:{configurable:!0,enumerable:!0,get:function(){return this.cIc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.OUa}},gM:{configurable:!0,enumerable:!0,
get:function(){return this.SFc}},Cxb:{configurable:!0,enumerable:!0,get:function(){var c=this.og.domElement(this.Uca);return c?Ne.DOMElementExtensions.isVisible(c):!1}},Cua:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&ae.EwaSettings.ka(136)?!(new ci.a(this.$.va)).Pi:!1}},svg:{configurable:!0,enumerable:!0,get:function(){return this.Ryc}},Uca:{configurable:!0,enumerable:!0,get:function(){return this.jwa?this.gridView.Wa.Bj(this.yN):1}}});Object(qd.a)(w,"PulloutManager",zh.a,
[684,6]);var ik=oe.a;Em(v,ik);v.prototype.create=function(){var c=this;Eh.a.Ga(function(k){var D=Wg.GetServiceTaskFactory.Va(k.ea,12,477,c.rb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),ba=Wg.GetServiceTaskFactory.Va(k.ea,66,134,c.rb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),Ba=Wg.GetServiceTaskFactory.Va(k.ea,211,212,c.rb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),nb=null,Rb=!ae.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1);Rb&&(nb=Wg.GetServiceTaskFactory.Va(k.ea,8,9,c.rb,"Microsoft.Office.Excel.WebUI.Client.IContextMenuManager"));Kf.TaskExtensions.Aa(Kf.TaskExtensions.xe([D,ba,nb,Ba],k.la),function(){Rb?c.Eb(c.$.ea.Ba(261)||new w(c.$,D.result,ba.result,nb.result,Ba.result)):c.Eb(c.$.ea.Ba(261)||new w(c.$,D.result,ba.result,null,Ba.result))},k.la)})};v.ja=function(c){c.ea.Ia(262,new v(c))};Object(qd.a)(v,"PulloutManagerFactory",oe.a,[]);var Wk=b(380);Object(qd.a)(h,"GestureAdapterInfo",null,[]);var $k=b(369),Pi=
b(219);r.prototype.Uai=function(){if(!this.HBc){var c=Td.AFrameworkApplication.O5(String.format("{0}","hammer.min.js"),5);c=Pi.a.create(c,null,null);$k.a.Zga(c);this.HBc=c.a5a}return this.HBc};Ll.Object.defineProperties(r,{instance:{configurable:!0,enumerable:!0,get:function(){r.Ma||(r.Ma=new r);return r.Ma}}});r.Ma=null;Object(qd.a)(r,"HammerJsDependencyLoader",null,[787]);var wj;(function(c){c[c.none=-1]="none";c[c.pinch=0]="pinch";c[c.pan=1]="pan";c[c.swipe=2]="swipe"})(wj||(wj={}));Object(qd.b)("GestureEvent",
wj);var Qk=b(71),Jk=Qk.a;Em(n,Jk);n.create=function(c,k,D,ba,Ba,nb){if(D.rawEvent)if(nb){var Rb=D.rawEvent;Rb=new Sys.UI.Point(Rb.clientX,Rb.clientY)}else Rb=Qk.a.Mrb(D);else Rb=new Sys.UI.Point(D.clientX,D.clientY);return new n(c,Rb,k,D,ba,Ba,D.shiftKey,D.ctrlKey,nb)};Ll.Object.defineProperties(n.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.Kea}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.BW}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.beb}},
cta:{configurable:!0,enumerable:!0,get:function(){return this.Ucg}}});Object(qd.a)(n,"GestureEventArgs",Qk.a,[]);Object(qd.a)(l,"GestureManagerData",null,[]);d.r8f=2;d.s8f=4;d.t8f=8;d.u8f=8;Object(qd.a)(d,"HammerConstants",null,[]);var Rk=b(192),Dk=vc.a;Em(e,Dk);e.prototype.MAh=function(){return this.jJc?0:this.Kae?1:2};e.prototype.Sm=function(c){Dk.prototype.Sm.call(this,c);this.Qd.Kia(this.qTa,c,0,this.nhb)};e.prototype.Nl=function(c){Dk.prototype.Nl.call(this,c);this.Qd.gGa(c,this.qTa)};e.prototype.nQi=
function(c,k,D){var ba=this;D=void 0===D?null:D;var Ba=void 0===Ba?null:Ba;Td.AFrameworkApplication.rcc()?r.instance.Uai().continueWith(function(nb){ba.xlj();if(nb.gg||nb.wh)ed.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",nb.status);else{ed.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",nb.status);if(ba.wWd){nb=window.Hammer;if("undefined"===typeof nb){ed.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");ba.otc();return}if("undefined"===typeof nb.inputHandler){ed.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");ba.otc();return}}if(!c)throw ba.otc(),Error.argumentNull("source element can not be null");nb=Rk.a.xta(c,ba.koa);if(void 0===nb||null===nb)nb=new mk.a,Rk.a.A$a(c,ba.koa,nb),ba.oQi(c);var Rb=null;if(!nb.qb(wj[0])){Rb=Object;var Ic=Rb.assign,Wc=new h,Rd=wj[0],Ge=Ba;Ge=void 0===Ge?null:Ge;if(void 0===ba||null===ba)throw ed.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var df=null;switch(Rd){case qf.a.pinch:df=
new Hammer.Pinch(Ge);break;case qf.a.pan:df=new Hammer.Pan(Ge)}df&&(df.manager=ba);Rb=Ic.call(Rb,Wc,{Aba:df,DNe:k});nb.add(wj[0],Rb)}if(void 0!==D&&null!==D)for(Ic=0;Ic<D.length;Ic++)nb.qb(wj[D[Ic]])&&(Wc=nb.oa(wj[D[Ic]]),Rb.Aba.recognizeWith(Wc.Aba))}ba.otc()}):ed.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};e.prototype.xlj=function(){this.vDc&&(this.jh?this.SLc=this.jh.Dc("Task","RegisterGestureAdapterAfterLoad"):ed.ULS.sendTraceTag(590387074,
310,10,"_stopwatchBuilder is null"))};e.prototype.otc=function(){this.vDc&&(this.SLc?this.SLc.stop():ed.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};e.prototype.oQi=function(c){this.Vcg.add(c);this.Qd.Kia(this.qTa,c,0,this.nhb)};e.prototype.recognize=function(c){for(var k=Array(c.pointers.length),D=0;D<c.pointers.length;D++)k[D]=c.pointers[D].target;D=null;for(this.Ina=this.VCh(k);void 0!==this.Ina&&null!==this.Ina&&(D=Rk.a.xta(this.Ina,this.koa),void 0===
D||null===D);this.Ina=this.Ina.parentNode);if(void 0!==D&&null!==D){this.curRecognizer&&this.curRecognizer.state===d.u8f&&(this.curRecognizer=null);k=Ol(D.keys);for(var ba=k.next();!ba.done;ba=k.next()){ba=D.oa(ba.value);void 0!==ba&&null!==ba&&void 0!==ba.Aba&&null!==ba.Aba&&(void 0===this.curRecognizer||null===this.curRecognizer||ba.Aba===this.curRecognizer||ba.Aba.canRecognizeWith(this.curRecognizer))&&ba.Aba.recognize(c);var Ba=ba.Aba.state;this.curRecognizer||d.r8f!==Ba&&d.s8f!==Ba&&d.t8f!==
Ba||(this.curRecognizer=ba.Aba)}}};e.prototype.emit=function(c,k){if("hammer.input"!==c){this.q7=!1;k=n.create(c,this.Ina,k.srcEvent,k,3,this.jJc);var D=Rk.a.xta(this.Ina,this.koa);if(this.z4h(c))var ba=0;else if(this.o4h(c))ba=1;else if(this.X6h(c))ba=2;else{ed.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}D=D.zc(wj[ba]).value;void 0!==D&&null!==D&&((D=D.DNe,D.o2h())?c.endsWith("start")?this.q7=D.Asi(k):c.endsWith("end")?(D.ysi(k),this.q7=!0):c.endsWith("cancel")?
(D.xsi(k),this.q7=!0):c.endsWith("move")&&(this.q7=D.zsi(k)):ed.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",c))}};e.prototype.get=function(c){return Object(Og.a)(Hammer.Recognizer,c)};e.prototype.VCh=function(c){if(1>c.length)return null;if(1===c.length)return c[0];for(var k=c[0],D=!0,ba=1;ba<c.length;ba++){if(!c[ba])return null;if(k!==c[ba]){D=!1;break}}if(D)return k;k=this.UNe(c[0]);D=0;c=Ol(c);for(ba=c.next();!ba.done;ba=c.next()){ba=this.UNe(ba.value);if(k.oa(k.count-
1)!==ba.oa(ba.count-1))return null;for(var Ba=k.count-2,nb=ba.count-2;Ba>=D&&0<=nb;Ba--,nb--)if(k.oa(Ba)!==ba.oa(nb)){D=Ba+1;break}}return k.oa(D)};e.prototype.UNe=function(c){for(var k=new Tf.a;void 0!==c&&null!==c;c=c.parentNode)k.add(c);return k};e.prototype.wRe=function(c){switch(c){case qf.a.yf:case qf.a.zqa:return 1;case qf.a.Gg:case qf.a.GXb:return 2;case qf.a.ye:case qf.a.Slb:return 4;case qf.a.Quc:case qf.a.SSc:return 8}return 0};e.prototype.Qwa=function(c,k,D){c=this.wRe(c);k=this.HBh(D);
Hammer.inputHandler(this,c,k);this.q7&&D.preventDefault();return this.q7};e.prototype.AYe=function(){return 1<this.LR.count};e.prototype.wYb=function(){ed.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.kjb)for(var c=Ol(this.LR),k=c.next();!k.done;k=c.next())this.qEf(k.value.key);else this.LR=new mk.a;this.session=null};e.prototype.spg=function(c,k,D){ed.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",c);if(!this.Ihb.qb(c)){try{k.setPointerCapture(c)}catch(ba){ed.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",ba)}this.Ihb.add(c,k)}this.LR.ia(c,D);this.uSa&&1<this.LR.count&&this.Hda&&!this.Hda.zmb&&(this.Hda.zmb=!0)};e.prototype.qEf=function(c){ed.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",c);if(this.Ihb.qb(c)){try{this.Ihb.oa(c).releasePointerCapture(c)}catch(k){ed.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",k)}this.Ihb.remove(c)}else ed.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",c);this.LR.remove(c);
this.uSa&&1>=this.LR.count&&this.Hda&&this.Hda.zmb&&(this.Hda.zmb=!1)};e.prototype.Vic=function(c,k,D){var ba=D.rawEvent.pointerType.toString(),Ba=D.rawEvent.pointerId.toString();if("touch"!==ba)return!1;c=this.wRe(c);if(1!==c&&!this.LR.qb(Ba))return!1;this.CWd&&1===c&&D.rawEvent.isPrimary&&this.LR.count&&(ed.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.wYb());this.kjb?this.spg(Ba,k,D):this.LR.ia(Ba,D);this.cHc&&2===c&&(!this.rAc||this.rAc&&"function"===typeof D.rawEvent.getCoalescedEvents)&&
(k=D.rawEvent.getCoalescedEvents())&&this.AYe()&&(this.Pgb=Math.max(this.Pgb,k.length));this.i8d&&(this.q7=!1);ba=this.GBh(this.LR,D,ba);Hammer.inputHandler(this,c,ba);if(4===c||8===c)this.kjb?this.qEf(Ba):this.LR.remove(Ba),this.LR.count||(this.session=null,this.cHc&&-1!==this.Pgb&&(ed.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Pgb),this.Pgb=-1));this.q7&&D.preventDefault();return this.q7};e.prototype.Hic=function(){return!1};e.prototype.HBh=function(c){var k=new l,
D=c.rawEvent,ba=D.touches;D=D.changedTouches;k.pointers=Array.clone(ba);k.pointers=Array.clone(0<ba.length?ba:D);k.changedPointers=Array.clone(D);k.srcEvent=c;k.pointerType="touch";return k};e.prototype.GBh=function(c,k,D){var ba=new l;ba.pointers=u.toArray(c.values);ba.changedPointers=[k];ba.pointerType=D;ba.srcEvent=k;return ba};e.prototype.z4h=function(c){return xg.a.startsWith(c,qf.a.pinch)};e.prototype.o4h=function(c){return xg.a.startsWith(c,qf.a.pan)};e.prototype.X6h=function(c){return xg.a.startsWith(c,
qf.a.swipe)};Object(qd.a)(e,"GestureInputManager",vc.a,[769,770]);var al=b(271);a.prototype.Qh=function(c){c.register(e,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").wc().Fc(function(){return new e(al.a.instance,Td.AFrameworkApplication.xa.MC)});this.Za=c};a.prototype.init=function(){this.fw||(this.Za.resolve("Common.App.GestureManager.GestureInputManager"),this.fw=!0)};a.prototype.dispose=function(){};a.main=function(){yb.a.instance.ej(new a)};Ll.Object.defineProperties(a.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(qd.a)(a,"GestureInputManagerPackage",null,[8,9]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");ue.a.Li('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
Eh.a.Ga(Kc.ja);Eh.a.Ga(Ma.ja);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");ye.main();ue.a.Li(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){Uf.initData();Eh.a.Ga(function(c){Fg.ja(c);Ke.ja(c);Uf.ja(c);nf.ja(c)})})();ue.a.Li(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
ue.a.Li(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
Eh.a.Ga(yc.ja);Eh.a.Ga(bf.ja);Eh.a.Ga(ce.ja);ue.a.Li(".ewa-facp-text-box{position:absolute}");(function(){Eh.a.Ga(function(c){Ta.ja(c)})})();(function(){Eh.a.Ga(function(c){lf.ja(c)})})();Eh.a.Ga(rc.ja);Eh.a.Ga(Ee.ja);Eh.a.Ga(vb.ja);ue.a.Li('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Eh.a.Ga(sa.ja);Eh.a.Ga(yd.ja);(function(){Eh.a.Ga(function(c){c.ea.Ia(150,new sb(c))})})();(function(){Eh.a.Ga(function(c){Aa.ja(c);cc.ja(c);G.ja(c)})})();Eh.a.Ga(z.ja);(function(){Eh.a.Ga(function(c){B.ja(c)})})();(function(){Eh.a.Ga(function(c){c.ka(136)&&v.ja(c)})})();Type.registerNamespace("Common.App.GestureManager");a.main()},826:function(C,F,b){function a(Z,ca,ra,La,na,ma,xa,Pa,ib,pb,xb,Ya){Pa=U.call(this)||this;Pa.bgc=!1;Pa.contextMenuController=null;Pa.aDc=null;Pa.mAc=null;Pa.Chd=!1;Pa.KFj=
0;Pa.JFj=0;Pa.gpb=null;Pa.yoc=null;Pa.ub=Z;Pa.Nff=na;Pa.iKc=pb;Pa.dFj=ra;Pa.cFj=La;Pa.JEj=ca;Pa.Pwf=ma;Pa.populateOnlyOnce=xa;Pa.eQh=xb;Pa.$Cf(Ya);return Pa}b.d(F,"a",function(){return a});C=b(0);var e=b(15),d=b(875),l=b(86),n=b(23),r=b(846),h=b(828),v=b(982),w=b(896),t=b(110),B=b(371),z=b(88),x=b(403),y=b(37),J=b(798);F=b(74);var E=b(18),A=b(4),H=b(960),S=b(79),Q=b(46),L=b(57),aa=b(141),fa=b(119),W=b(1),G=b(9),N=b(7),Y=b(16),V=b(20),da=b(34),U=F.a;Em(a,U);a.prototype.Wc=function(Z,ca){Z=!0;switch(ca){case 1651433993:case 1675506831:case 966232027:Z=
this.we(4096)||this.we(2048);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:Z=this.we(8192)}return!Z};a.prototype.Yc=function(Z,ca,ra){ra.IsShadowMenuOpen||H.h(this.$,H.d);Z=!1;ca===this.xt&&(ra.IsShadowMenuOpen||H.h(this.$,H.a),ca=Object.assign(new d.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.Mwd(ca,ra.IsShadowMenuOpen),ra.MenuItems=ca,ra.IsShadowMenuOpen||H.h(this.$,H.c),Z=!0);Z&&this.bgc&&G.HelperMethods.IXb&&!ra.IsShadowMenuOpen&&H.j(this.$);
return Z};a.prototype.Mwd=function(Z,ca){(ca=this.OX(ca))?(this.X_e(ca),Array.addRange(Z.MenuSectionList,ca.pB().MenuSectionList),this.Lpg(Z)):e.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.OX=function(){e.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.lN=function(Z,ca,ra,La,
na){Z=Sys.UI.DomElement.getBounds(ca);ra=new Sys.UI.Point(Z.x,Z.y+Z.height);this.fRa(ra,ca);this.$.isChromeRtl&&(ra.x+=Z.width);this.wn(ra,na)};a.prototype.wn=function(Z,ca,ra){ra=void 0===ra?0:ra;ca&&(Z=da.a(this.$).xIa(Z));ca=!0;if(this.eQh){var La;3===ra?(La=this.gIa(3))&&0<La.length?(ca=!1,this.showFloatie(La,new Sys.UI.Bounds(Z.x,Z.y,0,0),ra)):e.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",
this.menuId):2===ra&&this.$.isEditMode&&((La=this.gIa(2))&&0<La.length?La[0]!==a.wLe?(ca=!1,this.xKd(La,new Sys.UI.Bounds(Z.x,Z.y,0,0),ra)):e.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):e.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ca&&this.showContextMenu(new Sys.UI.Bounds(Z.x,
Z.y,0,0),ra)};a.prototype.gIa=function(){return null};a.prototype.cad=function(Z,ca){var ra="";3===Z?ra="touch":2===Z&&(ra="mouse");Z={};return Z.ContextMenuId=this.menuId,Z.IsEditMode=this.$.isEditMode,Z.IsSLR=!!L.a.Df&&L.a.Df.fA,Z.IsReactMLR=!!L.a.Df&&L.a.Df.sU,Z.IsNov=this.$.fa.isNamedObjectViewMode,Z.InputType=ra,Z.FloatieGroups=JSON.stringify(void 0===ca?null:ca),Z};a.prototype.showContextMenu=function(Z,ca){ca=void 0===ca?0:ca;var ra=this.cad(ca);e.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",
JSON.stringify(ra));this.contextMenuController?this.rA!==A.a.yzd&&this.rA!==A.a.zzd||!ca?this.contextMenuController.wKd(this.rA,Z,S.a.Tb):this.contextMenuController.wKd(this.rA,Z,ca):e.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(Z,ca,ra){var La=this.cad(ra,Z);e.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(La));this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.fDf(),this.contextMenuController.isc(Z,ca,ra)):e.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(Z))};a.prototype.xKd=function(Z,ca,ra){var La=this.cad(ra,Z);e.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(La));this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.fDf(),this.contextMenuController.vKd(Z,ca,ra,this.rA)):e.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.$Cf=function(Z){this.contextMenuController=Z};a.prototype.dispose=function(){this.$&&this.$.Ka.O8a(this);this.ub=null;W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.$0f();this.yoc&&(l.a.Fa(this.yoc),this.yoc=null);U.prototype.dispose.call(this)};a.prototype.grh=function(Z){var ca=this.$.ea.Ba(204);ca&&(ca=ca.Orh(this.Nff))&&Array.add(Z.Bc,ca)};a.prototype.fRa=function(Z,ca){Z&&ca&&this.$.fa.ic.isDivSyndicated&&n.a.jf&&(ca=ca.ownerDocument.documentElement,Z.x-=ca.scrollLeft,Z.y-=ca.scrollTop)};a.prototype.we=function(Z){return(new aa.a(this.$.va)).we(Z)};a.prototype.X_e=function(Z){Z=Ol(Z.Bc);for(var ca=Z.next();!ca.done;ca=Z.next())if(ca=ca.value,Object(x.a)(571,
ca)){ca.title&&(ca.title=a.yq(ca.title));ca=Ol(ca.buttons);for(var ra=ca.next();!ra.done;ra=ca.next())ra=ra.value,Object(x.a)(500,ra)?(ra.label=a.yq(ra.label),ra.PQ(a.yq(ra.alt))):Object(x.a)(574,ra)&&this.X_e(ra.menu)}};a.prototype.Fpd=function(Z,ca){ca=void 0===ca?!1:ca;var ra=[];Z=Ol(Z);for(var La=Z.next();!La.done;La=Z.next())ra.push(this.bT(La.value,ca));return ra};a.prototype.bT=function(Z){for(var ca=[],ra=Ol(Z.MenuItems),La=ra.next();!La.done;La=ra.next())switch(La=La.value,La.Type){case 3:Array.add(ca,
this.Yue(La,!1));break;case 2:W.EwaSettings.isChangeGateEnabled("OfficeVSO:5775701_ContextMenuToggleButtonFix")?Array.add(ca,this.tYg(La)):Array.add(ca,this.Yue(La,!0));break;case 1:Array.add(ca,this.gUg(La))}return Object.assign(new r.a,{ControlList:ca,Title:Z.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.D7c=function(Z,ca){ca=[this.gpb,Z.RibbonCommand.toString(),ca||Z.Label,Z.Disabled?Z.Disabled.toString():"False"];
var ra=Z.CommandData;ra=N.a.hashCode(ra).toString();ca.push(ra,Z.Identifier.toString());ca=ca.join("_");Z.IsChecked&&(ca+="_Checked");return ca};a.prototype.Prh=function(Z){var ca=[this.gpb,N.a.hashCode(Z.Title).toString()];Z=Ol(Z.MenuItems);for(var ra=Z.next();!ra.done;ra=Z.next())ca.push(ra.value.RibbonCommand.toString());return ca.join("_")};a.prototype.eNe=function(Z){var ca=Z.Label;ca=N.a.hashCode(ca).toString();ca=[this.gpb,ca];W.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&
Z.Id&&ca.push(N.a.hashCode(Z.Id).toString());ca=ca.join("_");Z.IsChecked&&(ca+="_Checked");return ca};a.prototype.Yue=function(Z,ca){var ra=this.s6b(Z,ca&&Z.IsChecked);ca=ra.label;var La=ra.oJa;ra=ra.Mo;var na=this.D7c(Z,ca);return Object.assign(new h.a,{Command:Z.Disabled?(-251203935).toString():ra.toString(),ExternalId:na,Id:na,Image16by16Class:La,LabelText:ca||Z.Label,MenuItemId:Z.CommandData,CommandValueId:Z.CommandData})};a.prototype.tYg=function(Z){var ca=this.s6b(Z,Z.IsChecked);var ra=ca.label;
var La=ca.oJa;ca=ca.Mo;var na=this.D7c(Z,ra);return Object.assign(new v.a,{Command:Z.Disabled?(-251203935).toString():ca.toString(),ExternalId:na,Id:na,Image16by16Class:La,LabelText:ra||Z.Label,MenuItemId:Z.CommandData,CommandValueId:Z.CommandData,IsChecked:Z.IsChecked})};a.prototype.gUg=function(Z){var ca=this.qNe(Z);var ra=ca.label;ca=ca.oJa;var La=Object.assign(new d.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(La.MenuSectionList,this.Fpd(Z.SubMenu.Sections,!0));var na=this.eNe(Z);
Z=ra?ra:Z.Label;return Object.assign(new w.a,{ExternalId:na,Id:na,LabelText:Z,PopulateOnlyOnce:!1,Menu:La,Image16by16Class:ca,ImageIsVisible:!!ca})};a.prototype.qNe=function(Z){Z=this.s6b(Z,!0);return{label:Z.label,oJa:Z.oJa,Mo:Z.Mo}};a.prototype.s6b=function(Z,ca){var ra=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled");switch(Z.Identifier){case 26:var La=912804500;ca=E.a.KHe;Z=Y.a.instance.da(1868);break;case 3:La=-1902148570;ca=ca?E.a.H9:null;Z=Y.a.instance.da(1828);
break;case 4:La=-1902148570;ca=ca?E.a.H9:null;Z=Y.a.instance.da(1829);break;case 5:La=-1902148570;ca=ca?E.a.H9:null;Z=null;break;case 1:La=-1677817820;ca=E.a.f4b;Z=Y.a.instance.da(219);break;case 2:La=-1649376918;ca=Z.IsChecked?E.a.fha:null;Z=Y.a.instance.da(2030);break;case 23:La=1701016594;ca=Z.IsChecked?E.a.fha:null;Z=Y.a.instance.da(2030);break;case 6:La=-87741481;ca=null;Z=Y.a.instance.da(2031);break;case 7:La=1948650742;ca=E.a.zGe;Z=Y.a.instance.da(1866);break;case 8:La=1933713114;ca=E.a.yGe;
Z=Y.a.instance.da(1867);break;case 14:La=504133448;ca=ra?E.a.R2:ca?E.a.ysa:E.a.R2;Z=Y.a.instance.da(142);break;case 30:La=504133448;ca=ra?E.a.R2:ca?E.a.ysa:E.a.R2;Z=Y.a.instance.da(146);break;case 32:La=504133448;ca=ra?E.a.R2:ca?E.a.ysa:E.a.R2;Z=Y.a.instance.da(148);break;case 34:La=504133448;ca=ra?E.a.R2:ca?E.a.ysa:E.a.R2;Z=Y.a.instance.da(150);break;case 27:La=1701016594;ca=ca?E.a.ysa:E.a.R2;Z=Y.a.instance.da(142);break;case 15:La=-798968736;ca=ra?E.a.S2:ca?E.a.zsa:E.a.S2;Z=Y.a.instance.da(144);
break;case 31:La=-798968736;ca=ra?E.a.S2:ca?E.a.zsa:E.a.S2;Z=Y.a.instance.da(147);break;case 33:La=-798968736;ca=ra?E.a.S2:ca?E.a.zsa:E.a.S2;Z=Y.a.instance.da(149);break;case 35:La=-798968736;ca=ra?E.a.S2:ca?E.a.zsa:E.a.S2;Z=Y.a.instance.da(151);break;case 28:La=1701016594;ca=ca?E.a.zsa:E.a.S2;Z=Y.a.instance.da(144);break;case 21:La=-2058042992;ca=E.a.o_a;Z=null;break;case 29:La=1701016594;ca=E.a.o_a;Z=null;break;case 9:La=1701016594;Z=ca=null;break;case 11:La=-1494291901;Z=ca=null;break;case 25:La=
-1045020714;ca=Z.IsChecked?E.a.fha:null;Z=null;break;case 13:La=1701016594;ca=Z.IsChecked?E.a.fha:null;Z=Y.a.instance.da(153);break;case 16:La=1701016594;ca=E.a.aHa;Z=Y.a.instance.da(1013);break;case 17:La=1701016594;ca=E.a.wsa;Z=null;break;case 18:La=1701016594;ca=E.a.vsa;Z=null;break;case 19:La=1701016594;ca=E.a.n_a;Z=Y.a.instance.da(1018);break;case 20:La=1701016594;ca=E.a.O3c;Z=Y.a.instance.da(1019);break;case 24:La=1675506831;ca=ra?null:Z.IsChecked?E.a.fha:null;Z=null;break;case 22:La=Z.RibbonCommand;
ca=Z.IsChecked?ra?E.a.H9:E.a.fha:null;Z=null;break;case 36:La=1461300262;ca=null;Z=Y.a.instance.da(152);break;default:e.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",JSON.stringify(Z)),La=1461300262,Z=ca=null}return{label:Z,oJa:ca,Mo:La}};a.prototype.Lpg=function(Z){if(!this.$.fa.amIAlone){var ca=this.$.ea.Ba(25);if((void 0!==ca&&null!==ca||!W.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!t.a.isEmpty(ca.Qza)&&(ca=ca.eLh(),!B.a.ma(ca))){var ra=[];z.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").KWg(ca,
ra);Array.addRange(Z.MenuSectionList,ra)}}};a.prototype.fDf=function(){this.Chd||(this.grb&&this.grb.jVb(Object(y.a)(this,this.IB,"dismissFloatie")),this.Gmb&&this.Gmb.jVb(Object(y.a)(this,this.IB,"dismissFloatie")),this.Chd=!!this.grb||!!this.Gmb)};a.prototype.IB=function(){this.contextMenuController?this.contextMenuController.IB():e.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.$0f()};a.prototype.$0f=
function(){this.grb&&this.grb.fnc(Object(y.a)(this,this.IB,"dismissFloatie"));this.Gmb&&this.Gmb.fnc(Object(y.a)(this,this.IB,"dismissFloatie"));this.Chd=!1};a.h7b=function(Z,ca,ra){ca=Q.C(ca);var La=V.g(Z).Ca.g8b(ca);ca=V.g(Z).getCellBounds(La);var na=La.nAg;La=La.mAg;var ma=ca.x+na.x;ca=ca.y+na.y;ra&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(V.g(Z).rtl||(ma+=La),ca-=La);return new Sys.UI.Point(ma,ca)};a.Zih=function(Z){try{Object(J.a)(Z.CommandValueId)}catch(ca){}};
a.yq=function(Z){var ca=a.Wra.parseFromString(Z,"text/html");return ca?ca.body.innerText:(e.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),Z)};Ll.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.yoc}},$:{configurable:!0,enumerable:!0,get:function(){return this.ub}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.iKc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Jb+this.Nff}},
grb:{configurable:!0,enumerable:!0,get:function(){this.aDc||(this.aDc=fa.a(this.$));return this.aDc}},Gmb:{configurable:!0,enumerable:!0,get:function(){this.mAc||(this.mAc=V.g(this.$).Gc);return this.mAc}}});a.Wra=new DOMParser;a.wLe="Unsupported";Object(C.a)(a,"ContextMenuBase",F.a,[160,718,6])},913:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);a.sEe="ewa-ac";a.k$g="ewa-ac-param";a.fFe="ewa-function-help-link";a.jFe="ewa-lb";a.ZEe="ewa-fb-refactor";a.listItem="list-item";a.Oxb=
"list-item-selected";a.Sxb="list-table-touch";a.Rxb="list-table";a.ZMg="columnName-header";a.XFe="ewa-tt";a.gch="ewa-function-link-container";a.gFe="ewa-function-udf-name";a.rtl="rtl";Object(C.a)(a,"CssClassNames",null,[])},921:function(C,F,b){function a(Z,ca,ra){this.EMb=null;this.vE={};this.sNb=this.fB=null;r.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=Z;this.GXd=a.h0c;this.HXd=a.borderStyleSolidLine;this.ji=ca;this.Sa=ra;y.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||
this.$.ea.Ia(296,this);this.qT=new e(this.$,this.ji);this.SG=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);r.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function e(Z,ca){this.ECb=this.ribbonCommandInfo=this.cellFormat=this.$q=this.Kb=this.ga=null;this.omc=!1;this.cyf=this.yJa=this.myf=this.m0d=this.pxa=this.Ika=null;this.BXb=this.asa=this.kyf=0;this.borderStyle=this.gXa=this.borderColor=null;this.bA=
!1;this.a1b=this.V7a=null;this.$=Z;this.ji=ca}function d(Z){Z.nDf()}function l(){this.iconName=this.title=this.key=null}function n(Z,ca,ra,La,na,ma,xa,Pa){this.s$f=Z;this.t$f=ca;this.r$f=ra;this.iO=La;this.tkg=na;this.Ggg=ma;this.Bgb=xa;this.Bfg=Pa}b.r(F);C=b(0);var r=b(15),h=b(931),v=b(833),w=b(4),t=b(79),B=b(52),z=b(214),x=b(32),y=b(1),J=b(7),E=b(16);n.fDg=function(){return new n("BorderStyleSolidLine",1872,1,"1","",1,8,0)};n.bDg=function(){return new n("BorderStyleDashedLine",1873,3,"1","5,3",
1,8,0)};n.cDg=function(){return new n("BorderStyleDottedLine",1874,4,"1","1,1",1,8,0)};n.eDg=function(){return new n("BorderStyleMediumLine",1875,2,"2","",1,8,0)};n.gDg=function(){return new n("BorderStyleThickLine",1876,5,"3","",1,8,0)};n.dDg=function(){return new n("BorderStyleDoubleLine",1877,6,"1","",2,8,3)};Ll.Object.defineProperties(n.prototype,{Wle:{configurable:!0,enumerable:!0,get:function(){return this.s$f}},zXb:{configurable:!0,enumerable:!0,get:function(){return this.t$f}},Vle:{configurable:!0,
enumerable:!0,get:function(){return this.r$f}},width:{configurable:!0,enumerable:!0,get:function(){return this.iO}},Cmj:{configurable:!0,enumerable:!0,get:function(){return this.tkg}},Vmi:{configurable:!0,enumerable:!0,get:function(){return this.Ggg}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.Bgb}},vai:{configurable:!0,enumerable:!0,get:function(){return this.Bfg}}});Object(C.a)(n,"BorderLineStyleProperties",null,[]);Object(C.a)(l,"BorderLineStyleProps",null,[]);d.prototype.getBorderLineStyleProps=
function(){var Z=b(921).BorderFormatManager.fXa,ca=Array(Object.keys(Z).length),ra=0,La;for(La in Z){var na=La,ma=Z[La];ca[ra]=new l;ca[ra].key=na;na=ma;ca[ra].title=E.a.instance.da(na.zXb);ca[ra].iconName=na.Wle;ra++}return ca};Object(C.a)(d,"BorderMenuController",null,[717]);var A=b(371),H=b(90),S=b(167),Q=b(13),L=b(117),aa=b(37),fa=b(25),W=b(43),G=b(42),N=b(197),Y=b(9),V=b(105),da=b(20),U=b(34);e.prototype.$mg=function(Z){r.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");
this.ga=da.g(this.$).ga;this.Kb=da.g(this.$).Kb;this.ribbonCommandInfo=Z;this.myf=A.a.clone(this.ga.wa.selectedRanges);this.kyf=this.ga.wa.Yz;this.cyf=this.ga.wa.activeCell.clone();this.Kb&&this.Kb.rdd();this.tx();this.Uj()};e.prototype.ZZ=function(){if(!this.bA||da.g(this.$).sy)this.bA=!1,da.g(this.$).sy=!1,this.asa=0,da.g(this.$).wi.wA(w.a.Ota),1===this.$.Ka.jG()&&(da.g(this.$).YT(A.a.clone(this.myf),this.kyf,this.$.qa?this.$.qa.sheetName:null,null,this.cyf.clone(),null,null,0,V.a.I5g,!0),da.g(this.$).r_(!0)),
this.Ou(),this.XPd(),this.$l(),this.omc=!1,this.pxa=this.Ika=null,this.$q&&(this.$q.cancel(),this.$q.dispose()),r.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};e.prototype.dispose=function(){this.ZZ();this.ECb=this.ribbonCommandInfo=this.cellFormat=null};e.prototype.onPointerDown=function(Z){try{if(Z=this.He(Z),da.g(this.$).sy=!0,this.Ika={},this.pxa={},this.V7a=null,this.Xlb(this.BXb),2===Z.yb){var ca=da.g(this.$).ga.Br(Z.clientPoint,Z.Sb,5,void 0,void 0,
!1);ca&&(this.a1b=this.yJa=ca,this.cQi())}}catch(ra){da.g(this.$).sy=!1}return!0};e.prototype.pk=function(Z){try{Z=this.He(Z);var ca=da.g(this.$).ga.Br(Z.clientPoint,Z.Sb,5,void 0,void 0,!1),ra=da.g(this.$).Ca.qr(ca);if(!this.ECb||ra&&(ra.rJ!==this.ECb.rJ||ra.qJ!==this.ECb.qJ))if(this.bA=!0,this.ECb=ra,ca){var La=new fa.Range(this.yJa.top,this.yJa.left,this.yJa.top,this.yJa.left,!0,!1);La.union(ca);La=da.g(this.$).ga.XFh(La);this.FXb(ca);this.EIf(this.V7a,La);if(this.bottomRightCorner(La.bottom,La.right))return r.ULS.sendTraceTag(537159515,
0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var na=new fa.Range(La.top,La.left,La.bottom+1,La.right+1,!0,!1),ma=da.g(this.$).g2("DrawBorderBehavior.OnPointerMove",[na]);if(this.Ika&&this.pxa)for(;ma.$$mn();){var xa=ma.$$cu(),Pa=xa.cell.getRange().toString();Pa in this.Ika&&1!==this.asa||(this.Ika[Pa]=xa,this.pxa[Pa]=xa.cell.FOe())}this.V7a=na;this.a1b=La;da.g(this.$).YT([La],0,this.$.qa.sheetName,null,La.topLeft,null,null,0,V.a.F5g,!0);
this.ji.bma(da.g(this.$),-1690267012,this.cellFormat,!0,null,[La])}return!0}catch(ib){return da.g(this.$).sy=!1}};e.prototype.Ah=function(Z){Z=this.He(Z);(Z=da.g(this.$).ga.Br(Z.clientPoint,Z.Sb,5,void 0,void 0,!1))?this.bA&&(this.FXb(Z),this.yJa.union(Z),3===this.asa?this.Xlb(0):this.Xlb(this.BXb),da.g(this.$).YT([this.yJa],0,this.$.qa.sheetName,null,null,null,null,0,V.a.G5g,!0),this.ji.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.asa?this.Xlb(0):this.Xlb(this.BXb),
da.g(this.$).YT([this.a1b],0,this.$.qa.sheetName,null,null,null,null,0,V.a.H5g,!0),this.ji.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.bA=!1;this.XPd();this.pxa=this.Ika=null;return!0};e.prototype.onKeyDown=function(Z){Z=this.He(Z);if(this.bA||Array.contains([17,16,18,20],Z.Ea.keyCode))return!0;this.ZZ();return!1};e.prototype.onKeyUp=function(Z){Z=this.He(Z);if(Z.Ea.keyCode===H.a.AN&&this.bA)return this.bA=!1,this.EIf(this.V7a,this.a1b,!0),this.XPd(),!0;if(this.bA||Z.Ea.keyCode===
H.a.Rza||Z.Ea.keyCode===H.a.jUd||Z.Ea.keyCode===H.a.iUd||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],Z.Ea.keyCode)||Z.Ea.keyCode===H.a.W8f||Z.Ea.keyCode===H.a.S8f||Z.Ea.keyCode===H.a.P8f)return!0;this.ZZ();return!1};e.prototype.Xlb=function(Z){var ca=b(921).BorderFormatManager;this.cellFormat={};var ra={};this.borderColor=this.borderColor||ca.h0c;var La=z.a.fG(this.borderColor,!1);ra.Color=[La,La,La,La];y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.gXa&&
(ra.ThemeBorderColor=[this.gXa,this.gXa,this.gXa,this.gXa],ra.ColorTypeOption=1);La=b(921).BorderFormatManager.fXa;this.borderStyle=this.borderStyle||ca.borderStyleSolidLine;ca=La[this.borderStyle].Vle;ra.LineStyle=[ca,ca,ca,ca];this.cellFormat.BorderFormat=ra;this.cellFormat.ValidMembers=128;this.cellFormat.Border=Z};e.prototype.tx=function(){for(var Z=Ol(da.g(this.$).ao),ca=Z.next();!ca.done;ca=Z.next())S.a.instance.pa(Q.a.pointerDown,ca.value.domElement,Object(aa.a)(this,this.onPointerDown,"onPointerDown"));
L.KeyInputManager.instance.pa(Q.a.Qb,document.documentElement,Object(aa.a)(this,this.onKeyDown,"onKeyDown"));L.KeyInputManager.instance.pa(Q.a.Xd,document.documentElement,Object(aa.a)(this,this.onKeyUp,"onKeyUp"))};e.prototype.cQi=function(){for(var Z=Ol(da.g(this.$).ao),ca=Z.next();!ca.done;ca=Z.next())ca=ca.value,S.a.instance.pa(Q.a.Ch,ca.domElement,Object(aa.a)(this,this.pk,"onPointerMove")),S.a.instance.pa(Q.a.Ud,ca.domElement,Object(aa.a)(this,this.Ah,"onPointerUp"));S.a.instance.pa(Q.a.Ud,document.documentElement,
Object(aa.a)(this,this.Ah,"onPointerUp"));S.a.instance.pa(Q.a.Hy,document.documentElement,Object(aa.a)(this,this.Ah,"onPointerUp"));this.omc=!0};e.prototype.Ou=function(){try{for(var Z=Ol(da.g(this.$).ao),ca=Z.next();!ca.done;ca=Z.next())S.a.instance.za(Q.a.pointerDown,ca.value.domElement,Object(aa.a)(this,this.onPointerDown,"onPointerDown"));L.KeyInputManager.instance.za(Q.a.Qb,document.documentElement,Object(aa.a)(this,this.onKeyDown,"onKeyDown"));L.KeyInputManager.instance.za(Q.a.Xd,document.documentElement,
Object(aa.a)(this,this.onKeyUp,"onKeyUp"))}catch(ra){da.g(this.$).sy=!1,r.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",ra)}};e.prototype.XPd=function(){if(this.omc)try{this.omc=!1;for(var Z=Ol(da.g(this.$).ao),ca=Z.next();!ca.done;ca=Z.next()){var ra=ca.value;S.a.instance.za(Q.a.Ch,ra.domElement,Object(aa.a)(this,this.pk,"onPointerMove"));S.a.instance.za(Q.a.Ud,ra.domElement,Object(aa.a)(this,this.Ah,"onPointerUp"))}S.a.instance.za(Q.a.Ud,
document.documentElement,Object(aa.a)(this,this.Ah,"onPointerUp"));S.a.instance.za(Q.a.Hy,document.documentElement,Object(aa.a)(this,this.Ah,"onPointerUp"))}catch(La){da.g(this.$).sy=!1,r.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",La)}};e.prototype.Uj=function(){this.$.va.Pf(Object(aa.a)(this,this.ZZ,"resetBehavior"));da.g(this.$).Gc.Jm(Object(aa.a)(this,this.ZZ,"resetBehavior"));da.g(this.$).iD(Object(aa.a)(this,
this.ZZ,"resetBehavior"));this.$.Ka.mkb(Object(aa.a)(this,this.twa,"onCommandExecutionStarting"))};e.prototype.$l=function(){this.$.va.zg(Object(aa.a)(this,this.ZZ,"resetBehavior"));da.g(this.$).Gc.ym(Object(aa.a)(this,this.ZZ,"resetBehavior"));da.g(this.$).AE(Object(aa.a)(this,this.ZZ,"resetBehavior"));this.$.Ka.U8a(Object(aa.a)(this,this.twa,"onCommandExecutionStarting"))};e.prototype.EIf=function(Z,ca,ra){ra=void 0===ra?!1:ra;if(Z&&this.Ika&&this.pxa)for(Z=da.g(this.$).g2("DrawBorderBehavior.ApplyBordersOnPreviewCells",
[Z]);Z.$$mn();){var La=Z.$$cu().cell.getRange();if(ra||!ca.contains(La)||1===this.asa){La=La.toString();var na=x.a.zc(this.Ika,La);if(na){var ma=x.a.zc(this.pxa,La);this.setBorders(na,ma);delete this.Ika[La];delete this.pxa[La]}}}};e.prototype.setBorders=function(Z,ca){var ra=Z.cell,La=ra.getRange();ra.ODf();La.right!==this.V7a.right&&(ra=new fa.Range(La.top,La.left-1,La.bottom,La.left-1,!0,!1),da.g(this.$).Ca.qr(ra).mBd(3));La.bottom!==this.V7a.bottom&&(ra=new fa.Range(La.top-1,La.left,La.top-1,
La.right,!0,!1),da.g(this.$).Ca.qr(ra).mBd(1));if(ca&&ca.Borders.length){var na={};ra=0;for(var ma=Array(4),xa=Array(4),Pa=0;4>Pa;Pa++)ma[Pa]=1,xa[Pa]=0;ca=Ol(ca.Borders);for(Pa=ca.next();!Pa.done;Pa=ca.next()){Pa=Pa.value;var ib=Pa.BorderPosition;ma[ib]=Pa.BorderLineStyle;var pb=new N.a(Pa.Color.Red,Pa.Color.Green,Pa.Color.Blue);xa[ib]=pb.J_();ra|=Y.HelperMethods.Drb(Pa.BorderPosition)}na.LineStyle=ma;na.Color=xa;na={BorderFormat:na};na.Border=ra;this.ji.C9i(Z,na,La)}};e.prototype.FXb=function(Z){var ca=
this,ra=new fa.Range(Math.max(1,Z.top-1),Math.max(1,Z.left-1),Z.bottom+1,Z.right+1,!1,!1);da.g(this.$).gja(ra)||this.$q&&this.$q.Do||(this.$q=W.a.instance.create(function(){da.g(ca.$).kt(ra,60,V.a.D5g)},40,G.a.E5g))};e.prototype.bottomRightCorner=function(Z,ca){return 1048576<=Z||16384<=ca?!0:!1};e.prototype.He=function(Z){return U.a(this.$).He(Z)};e.prototype.twa=function(Z,ca){da.g(this.$).sy&&!Array.contains(this.YSh,ca.Zd.command)&&(r.ULS.sendTraceTag(537159512,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",
ca.Zd),this.ZZ())};Ll.Object.defineProperties(e.prototype,{YSh:{configurable:!0,enumerable:!0,get:function(){return this.m0d||(this.m0d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(C.a)(e,"DrawBorderBehavior",null,[6]);b.d(F,"BorderFormatManager",function(){return a});a.prototype.hXe=function(Z,ca){r.ULS.sendTraceTag(537159564,0,50,
"HandleBorderCommand : Begin handling, Command being executed: {0}",ca.command.toString());var ra={},La={};var na=z.a.fG(this.i2,!1);La.Color=[na,na,na,na];this.SG&&this.zra&&(La.ThemeBorderColor=[this.zra,this.zra,this.zra,this.zra],La.ColorTypeOption=1);Z=-600086683===ca.command?"OutsideBorders":Z[t.a.Md];La.LineStyle=x.a.zc(a.rxf,Z);La.LineStyle?r.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",Z):(na=a.fXa[this.JFa].Vle,
La.LineStyle=[na,na,na,na],r.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.JFa));na=x.a.yn(a.hCg,Z,0);r.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",Z,this.i2);ra.BorderFormat=La;4!==na&&8!==na||!this.$.qa.displayRtl||(na=4===na?8:4);ra.ValidMembers=128;ra.Border=na;this.ji.formatCells(-1690267012,
ra,ca);r.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",ca.command.toString());return!0};a.prototype.Zbd=function(Z,ca,ra){r.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",Z.toString(),this.i2);if(this.SG){if(J.a.contains(ca.SqmControlId,"ThemeColorPicker",!1)){var La=this.themesManager.getThemeColor(ca.Color);var na=La.themeIndex;var ma=La.kza;La.returnValue?(this.sNb={},this.zra.ThemeColorIndex=
na,this.zra.ThemeColorRow=ma):this.sNb=null}else this.sNb=null;this.qT.gXa=this.zra}this.GXd=-1803452024===Z?a.h0c:ca.Color;this.qT.borderColor=this.i2;this.ICe(ra);this.$.zf();r.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",Z.toString(),this.i2);return!0};a.prototype.COh=function(Z){r.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var ca=this.Sa.$o(),ra=this.Sa.Oc();ca.Bc.push(ra);var La=this.Sa.Lz("StyleDashGallery",
1,"Size120by20");ra.buttons.push(La);ra=a.fXa;for(var na in ra){var ma=na,xa=ra[na],Pa=E.a.instance.da(xa.zXb);La.Ts(ma,-2118943501,"QueryBorderStyle",xa.zXb,ma,ma,void 0,void 0,Pa)}r.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");Z.MenuItems=ca.pB();r.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.dNh=function(Z,ca){r.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.JFa);Z=
Z[t.a.Md];if(a.M7h(Z))this.HXd=Z,r.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.JFa);else return r.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",Z),!0;this.qT.borderStyle=this.JFa;this.ICe(ca);this.$.zf();r.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.JFa);return!0};a.prototype.dcd=function(Z){r.ULS.sendTraceTag(537159552,
0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",Z.command.toString());this.RNc(Z,64,this.i2,87,1);return!0};a.prototype.ecd=function(Z){r.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",Z.command.toString());this.RNc(Z,112,this.i2,88,2);return!0};a.prototype.vXe=function(Z){r.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",Z.command.toString());this.RNc(Z,
112,"white",89,3);return!0};a.prototype.FOh=function(Z){this.m8i(this.iCg,Z,Z.MenuItemId?Z.MenuItemId:a.borderStyleSolidLine)};a.prototype.m8i=function(Z,ca,ra){ra in Z?(Z=Z[ra],r.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",ra),this.o8i(ca,Z)):r.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",ra)};a.prototype.POh=function(Z,ca){var ra=Z[t.a.Md];return"DrawBorder"===ra?this.dcd(ca):
"DrawBorderGrid"===ra?this.ecd(ca):"EraseBorder"===ra?this.vXe(ca):this.hXe(Z,ca)};a.prototype.nDf=function(){this.EMb||this.hDg()};a.prototype.Puh=function(){return new d(this)};a.prototype.hDg=function(){this.EMb={};var Z=0,ca=a.fXa,ra={},La;for(La in ca){ra.cda=ca[La];var na=ra.cda.Wle;E.a.instance.da(ra.cda.zXb);var ma=function(xa){return function(){return appChrome.buildBorderStyleIconNew(xa.cda.Cmj,xa.cda.width,xa.cda.Vmi,xa.cda.lineHeight,xa.cda.vai)}}(ra);this.EMb[na]=na;this.G8a(na,ma);Z++;
ra={cda:ra.cda}}};a.prototype.G8a=function(Z,ca){if(!(Z in this.vE)){var ra={};ca=ca();ra[Z]=ca;appChrome.api.registerIconProvider(function(){return ra});this.vE[Z]=!0}return Z};a.prototype.o8i=function(Z,ca){Z.MenuItemId&&(Z[h.a.On]=Z.MenuItemId===this.JFa,Z[v.a.Icon]=ca)};a.prototype.RNc=function(Z,ca,ra,La,na){r.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.TJg(Z,na)?(r.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.qT.ZZ()):(da.g(this.$).sy&&this.qT.ZZ(),B.a.current&&(La=String.format(w.a.Era,B.a.current.mn(La)),da.g(this.$).wi.wA(La)),this.qT.BXb=ca,this.qT.borderColor=ra,da.g(this.$).sy=!0,this.qT.$mg(Z),this.qT.asa=na)};a.prototype.ICe=function(Z){if(Z)switch(this.qT.asa){case 2:this.ecd(Z);break;default:this.dcd(Z)}};a.prototype.TJg=function(Z,ca){return this.qT.asa===ca&&-236759591!==Z.command&&-2118943501!==Z.command?!0:!1};a.M7h=function(Z){return Z?Z in a.rxf||Z in a.fXa:!1};Ll.Object.defineProperties(a.prototype,
{JFa:{configurable:!0,enumerable:!0,get:function(){return this.HXd}},i2:{configurable:!0,enumerable:!0,get:function(){return this.GXd}},zra:{configurable:!0,enumerable:!0,get:function(){return this.sNb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.fB||(this.fB=this.$.ea.Ba(422));return this.fB}},iCg:{configurable:!0,enumerable:!0,get:function(){this.nDf();return this.EMb}}});Ll.Object.defineProperties(a,{fXa:{configurable:!0,enumerable:!0,get:function(){var Z={};return a.IVd||
(a.IVd=(Z.BorderStyleSolidLine=n.fDg(),Z.BorderStyleDashedLine=n.bDg(),Z.BorderStyleDottedLine=n.cDg(),Z.BorderStyleMediumLine=n.eDg(),Z.BorderStyleThickLine=n.gDg(),Z.BorderStyleDoubleLine=n.dDg(),Z))}},hCg:{configurable:!0,enumerable:!0,get:function(){var Z={};return a.HVd||(a.HVd=(Z.NoBorder=0,Z.BottomBorder=1,Z.TopBorder=2,Z.LeftBorder=4,Z.RightBorder=8,Z.OutsideBorders=64,Z.AllBorders=112,Z.ThickOutsideBorders=64,Z.InsideBorders=48,Z.InsideHorizontalBorders=16,Z.InsideVerticalBorders=32,Z.BottomDoubleBorder=
1,Z.ThickBottomBorder=1,Z.TopBottomBorder=3,Z.TopThickBottomBorder=3,Z.TopDoubleBottomBorder=3,Z))}},rxf:{configurable:!0,enumerable:!0,get:function(){var Z={};return a.a7d||(a.a7d=(Z.ThickOutsideBorders=[2,2,2,2],Z.BottomDoubleBorder=[1,6,1,1],Z.ThickBottomBorder=[1,2,1,1],Z.TopBottomBorder=a.i0g,Z.TopThickBottomBorder=[1,2,1,1],Z.TopDoubleBottomBorder=[1,6,1,1],Z))}}});a.HVd=null;a.IVd=null;a.a7d=null;a.h0c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.i0g=[1,1,1,1];Object(C.a)(a,"BorderFormatManager",
null,[699])},960:function(C,F,b){function a(E,A,H){window.performance.measure(E,A,H);A=window.performance.getEntriesByName(E);A.length||w.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",E);return A[A.length-1]?A[A.length-1].duration:-1}function e(){if(t.a.Ulb){var E=a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),A=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),H=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");
w.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",E,A,H)}}function d(E,A){y.HelperMethods.VSc&&window.performance.mark(A)}function l(E){E=J.g(E).ga.wa;return E.xh&&(E.Nd.isRow||E.Nd.Fh)}function n(E){return E.$b.baa(E.ga.wa.activeCell)}function r(E,A,H,S,Q){E=S.mm("ContextMenuHelper.FindFirstCellInViewportArea",E,A,H);try{for(E.$$rst();E.$$mn();){var L=E.$$cu();if(L&&h(L,S,Q))return L.cell}}finally{E&&
E.dispose()}return null}function h(E,A,H){var S=A.rtl,Q=H.isChromeRtl;E=E.cell;return(H=J.g(H).cJ(E))?(H=H.topLeft,S=H.x+=S===Q?E.offsetWidth:0,Q=H.y+=E.offsetHeight,A.view.visibleArea.contains(new z.a(S,Q,0,0))):!1}function v(E,A){var H=E.tc(null);if(H&&H.cell.jj&&h(H,E,A))return E.getCellBounds(H.cell);H=E.ga.wa.activeCell;return(A=r(new x.Range(H.top,H.left,B.a.lh,H.left,!1,!1),2,!0,E,A)||r(new x.Range(1,H.left,H.top,H.left,!1,!1),2,!1,E,A)||r(new x.Range(H.top,H.right,H.top,B.a.zh,!1,!1),1,!0,
E,A)||r(new x.Range(H.top,1,H.top,H.right,!1,!1),1,!1,E,A)||null)&&A.jj?E.getCellBounds(A):Sys.UI.DomElement.getBounds(E.Ktb.Ib)}b.d(F,"i",function(){return"ContextMenuPerf.A"});b.d(F,"b",function(){return"ContextMenuPerf.B"});b.d(F,"d",function(){return"ContextMenuPerf.C1"});b.d(F,"a",function(){return"ContextMenuPerf.C2"});b.d(F,"c",function(){return"ContextMenuPerf.D"});b.d(F,"e",function(){return v});b.d(F,"f",function(){return n});b.d(F,"g",function(){return l});b.d(F,"h",function(){return d});
b.d(F,"j",function(){return e});var w=b(15),t=b(316),B=b(10),z=b(59),x=b(25),y=b(9),J=b(20)},961:function(C,F,b){function a(){}b.d(F,"a",function(){return a});C=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.kAg="AutoFill";a.t0i="RowOperations";a.$Mg="ColumnOperations";a.QBj="ViewModeRowOperations";a.PBj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.ubj="ShapeStyle";a.Snh="FloatingObjectClipboard";a.swf="PivotTableCopyDelete";a.uwf=
"PivotTableFieldListActions";a.Yoe="CellFloatie";a.qbj="ShapeFloatie";a.contextMenu="ContextMenu";a.pMh="GridContextMenu";a.KFi="PivotTableContextMenu";a.Tnh="FloatingObjectContextMenu";a.bJg="CellRTEFloatie";a.AQf="ShapeRTEFloatie";Object(C.a)(a,"FloatieGroupIdentifiers",null,[])},962:function(C,F,b){function a(B,z,x){z=t.call(this,z)||this;z.aQ=!1;z.Lec=!1;z.oLa=null;z._selectedRowListBox=null;z.sn=null;z.ub=B;z.Nxb=x;z.bza(!0);return z}b.d(F,"a",function(){return a});C=b(0);var e=b(86),d=b(278),
l=b(13),n=b(167),r=b(37);F=b(230);var h=b(11),v=b(68),w=b(20),t=F.a;Em(a,t);a.prototype.n8=function(B){this.get_events().addHandler(a.u1a,B)};a.prototype.Kba=function(B){this.get_events().removeHandler(a.u1a,B)};a.prototype.hVb=function(B){this.get_events().addHandler(a.eed,B)};a.prototype.dnc=function(B){this.get_events().removeHandler(a.eed,B)};a.prototype.Bkb=function(B){this.get_events().addHandler(a.dHd,B)};a.prototype.pEb=function(B){this.get_events().removeHandler(a.dHd,B)};a.prototype.XVa=
function(B){this.get_events().addHandler(a.dNa,B)};a.prototype.a9a=function(B){this.get_events().removeHandler(a.dNa,B)};a.prototype.APc=function(B){this.get_events().addHandler(a.eld,B)};a.prototype.mCd=function(B){this.get_events().removeHandler(a.eld,B)};a.prototype.dispose=function(){this.l6(!1);this.bza(!1);e.a.mc([this.oLa]);this.oLa=null;t.prototype.dispose.call(this)};a.prototype.X6b=function(B){return h.DOMElementExtensions.u9c(B.target,"tr",!0)};a.prototype.jA=function(B){if(B){if(!this.Dk){var z=
this.sn;if(!z||!z.rows.length)return;this.Dk=z.rows[0];0<B?B--:B++}z=this.Dk;for(var x=0,y=Math.abs(B);x<y;x++)if(0>B){if(!z.previousSibling)break;z=z.previousSibling}else{if(!z.nextSibling)break;z=z.nextSibling}z&&(this.Dk=z)}};a.prototype.ckb=function(B,z){h.DOMElementExtensions.toggleCssClass(B,this.Nxb.ListTableClassInTouch,z)};a.prototype.l6=function(B){var z=this.sn;z&&(B&&!this.Lec?(d.a.instance.pa(l.a.click,z,Object(r.a)(this,this.uAb,"onItemClick")),d.a.instance.pa(l.a.zj,z,Object(r.a)(this,
this.Qtd,"onItemDoubleClick")),n.a.instance.pa(l.a.pointerDown,z,Object(r.a)(this,this.vAb,"onItemPointerDown")),this.Lec=!0):this.Lec&&(d.a.instance.za(l.a.click,z,Object(r.a)(this,this.uAb,"onItemClick")),d.a.instance.za(l.a.zj,z,Object(r.a)(this,this.Qtd,"onItemDoubleClick")),n.a.instance.za(l.a.pointerDown,z,Object(r.a)(this,this.vAb,"onItemPointerDown")),this.Lec=!1))};a.prototype.qza=function(B){var z=null;B&&(z=h.DOMElementExtensions.lj(B,this.Nxb.ListCellClass))&&z.classList.toggle(this.Nxb.ListCellSelectedClass);
return z};a.prototype.bza=function(B){this.Zf&&(B&&!this.aQ?(this.oLa=this.Hd.yd(this.Zf),this.oLa.ja("scroll",Object(r.a)(this,this.onScroll,"onScroll")),this.oLa.ja("blur",Object(r.a)(this,this.onBlur,"onBlur")),n.a.instance.pa(l.a.pointerDown,this.domElement,Object(r.a)(this,this.onPointerDown,"onPointerDown")),this.aQ=!0):this.aQ&&(e.a.Fa(this.oLa),this.oLa=null,n.a.instance.za(l.a.pointerDown,this.domElement,Object(r.a)(this,this.onPointerDown,"onPointerDown")),this.aQ=!1))};a.prototype.uAb=
function(B){return this.Qtd(B)};a.prototype.Qtd=function(B){v.g(B.Ea);this.raiseEvent(a.u1a);this.raiseEvent(a.dHd);return!0};a.prototype.cpc=function(B){if(B){var z=B.offsetTop,x=this.Zf.scrollTop;z<x?this.nLf(!0):z+B.offsetHeight>x+this.Zf.clientHeight&&this.nLf(!1)}};a.prototype.nLf=function(B){this.Zf.scrollTop=B?this.Dk.offsetTop:this.Dk.offsetTop+this.Dk.offsetHeight-this.Zf.clientHeight};a.prototype.onScroll=function(B){v.g(B);this.bzd();this.raiseEvent(a.u1a)};a.prototype.onBlur=function(B){v.g(B);
this.bzd()};a.prototype.onPointerDown=function(){this.bzd();this.raiseEvent(a.u1a);this.raiseEvent(a.dNa);return!1};a.prototype.bzd=function(){w.g(this.$).isEditing&&this.raiseEvent(a.eed)};a.prototype.vAb=function(B){var z=B.Ea;z.button&&z.button!==Sys.UI.MouseButton.rightButton||(this.Dk=this.X6b(z),this.onPointerDown(B));this.raiseEvent(a.eld);return!1};Ll.Object.defineProperties(a.prototype,{Dk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(B){this.qza(this._selectedRowListBox);
B?(this._selectedRowListBox=B,this.qza(this._selectedRowListBox),this.cpc(B)):this._selectedRowListBox=null}},fZ:{configurable:!0,enumerable:!0,get:function(){return this.Nxb.ListCellClass}},vaa:{configurable:!0,enumerable:!0,get:function(){return this.Nxb.ListTableClass}},$G:{configurable:!0,enumerable:!0,get:function(){return 8}},zyb:{configurable:!0,enumerable:!0,get:function(){return 5}},Jec:{configurable:!0,enumerable:!0,get:function(){return 24}},Iec:{configurable:!0,enumerable:!0,get:function(){return 35}},
Zf:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.ub}}});a.u1a="GotFocus";a.eed="IgnoreBlur";a.dHd="SetCell";a.dNa="PointerDown";a.eld="ItemPointerDown";Object(C.a)(a,"ListBox",F.a,[446,6])}}]);

//# sourceMappingURL=EwaDS.kpae.js.map